1873F "Money Trees" "binary search,greedy,math,two pointers" "Luca is in front of a row of n trees. The i-th tree has ai fruit and height hi.He wants to choose a contiguous subarray of the array [hl,hl+1,\xe2\x80\xa6,hr] such that for each i (l\xe2\x89\xa4i<r), hi is divisible\xe2\x80\xa0 by hi+1. He will collect all the fruit from each of the trees in the subarray (that is, he will collect al+al+1+\xe2\x8b\xaf+ar fruits). However, if he collects more than k fruits in total, he will get caught. What is the maximum length of a subarray Luca can choose so he doesn\'t get caught?\xe2\x80\xa0 x is divisible by y if the ratio xy is an integer." 1300
1873E "Building an Aquarium" "binary search,sortings" "You love fish, that\'s why you have decided to build an aquarium. You have a piece of coral made of nn columns, the ii-th of which is aiai units tall. Afterwards, you will build a tank around the coral as follows:   Pick an integer h\xe2\x89\xa51h\xe2\x89\xa51 \xe2\x80\x94 the height of the tank. Build walls of height hh on either side of the tank.  Then, fill the tank up with water so that the height of each column is hh, unless the coral is taller than hh; then no water should be added to this column.  For example, with a=[3,1,2,4,6,2,5]a=[3,1,2,4,6,2,5] and a height of h=4h=4, you will end up using a total of w=8w=8 units of water, as shown.    You can use at most xx units of water to fill up the tank, but you want to build the biggest tank possible. What is the largest value of hh you can select?" 1100
1873D "1D Eraser" "greedy,implementation,two pointers" "You are given a strip of paper s that is n cells long. Each cell is either black or white. In an operation you can take any k consecutive cells and make them all white.Find the minimum number of operations needed to remove all black cells." 800
1873C "Target Practice" implementation,math "A 10\xc3\x9710 target is made out of five ""rings"" as shown. Each ring has a different point value: the outermost ring \xe2\x80\x94 1 point, the next ring \xe2\x80\x94 2 points, ..., the center ring \xe2\x80\x94 5 points.  Vlad fired several arrows at the target. Help him determine how many points he got." 800
1873B "Good Kid" "brute force,greedy,math" "Slavic is preparing a present for a friend\'s birthday. He has an array a of n digits and the present will be the product of all these digits. Because Slavic is a good kid who wants to make the biggest product possible, he wants to add 1 to exactly one of his digits. What is the maximum product Slavic can make?" 800
1873A "Short Sort" "brute force,implementation" "There are three cards with letters a, b, c placed in a row in some order. You can do the following operation at most once:   Pick two cards, and swap them.  Is it possible that the row becomes abc after the operation? Output ""YES"" if it is possible, and ""NO"" otherwise." 800
1872G "Replace With Product" "brute force,greedy,math" "Given an array a of n positive integers. You need to perform the following operation exactly once: Choose 2 integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and replace the subarray a[l\xe2\x80\xa6r] with the single element: the product of all elements in the subarray (al\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85ar).For example, if an operation with parameters l=2,r=4 is applied to the array [5,4,3,2,1], the array will turn into [5,24,1].Your task is to maximize the sum of the array after applying this operation. Find the optimal subarray to apply this operation." 2000
1872F "Selling a Menagerie" "dfs and similar,dsu,graphs,implementation,math" "You are the owner of a menagerie consisting of n animals numbered from 1 to n. However, maintaining the menagerie is quite expensive, so you have decided to sell it!It is known that each animal is afraid of exactly one other animal. More precisely, animal i is afraid of animal ai (ai\xe2\x89\xa0i). Also, the cost of each animal is known, for animal i it is equal to ci.You will sell all your animals in some fixed order. Formally, you will need to choose some permutation\xe2\x80\xa0 p1,p2,\xe2\x80\xa6,pn, and sell animal p1 first, then animal p2, and so on, selling animal pn last.When you sell animal i, there are two possible outcomes: If animal ai was sold before animal i, you receive ci money for selling animal i. If animal ai was not sold before animal i, you receive 2\xe2\x8b\x85ci money for selling animal i. (Surprisingly, animals that are currently afraid are more valuable). Your task is to choose the order of selling the animals in order to maximize the total profit. For example, if a=[3,4,4,1,3], c=[3,4,5,6,7], and the permutation you choose is [4,2,5,1,3], then: The first animal to be sold is animal 4. Animal a4=1 was not sold before, so you receive 2\xe2\x8b\x85c4=12 money for selling it. The second animal to be sold is animal 2. Animal a2=4 was sold before, so you receive c2=4 money for selling it. The third animal to be sold is animal 5. Animal a5=3 was not sold before, so you receive 2\xe2\x8b\x85c5=14 money for selling it. The fourth animal to be sold is animal 1. Animal a1=3 was not sold before, so you receive 2\xe2\x8b\x85c1=6 money for selling it. The fifth animal to be sold is animal 3. Animal a3=4 was sold before, so you receive c3=5 money for selling it.Your total profit, with this choice of permutation, is 12+4+14+6+5=41. Note that 41 is not the maximum possible profit in this example.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3, but 4 is present in the array)." 1800
1872E "Data Structures Fan" "binary search,bitmasks,data structures,dp" "You are given an array of integers a1,a2,\xe2\x80\xa6,an, as well as a binary string\xe2\x80\xa0 s consisting of n characters.Augustin is a big fan of data structures. Therefore, he asked you to implement a data structure that can answer q queries. There are two types of queries: ""1 l r"" (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) \xe2\x80\x94 replace each character si for l\xe2\x89\xa4i\xe2\x89\xa4r with its opposite. That is, replace all 0 with 1 and all 1 with 0. ""2 g"" (g\xe2\x88\x88{0,1}) \xe2\x80\x94 calculate the value of the bitwise XOR of the numbers ai for all indices i such that si=g. Note that the XOR of an empty set of numbers is considered to be equal to 0.Please help Augustin to answer all the queries!For example, if n=4, a=[1,2,3,6], s=1001, consider the following series of queries: ""2 0"" \xe2\x80\x94 we are interested in the indices i for which si=0, since s=1001, these are the indices 2 and 3, so the answer to the query will be a2\xe2\x8a\x95a3=2\xe2\x8a\x953=1. ""1 1 3"" \xe2\x80\x94 we need to replace the characters s1,s2,s3 with their opposites, so before the query s=1001, and after the query: s=0111. ""2 1"" \xe2\x80\x94 we are interested in the indices i for which si=1, since s=0111, these are the indices 2, 3, and 4, so the answer to the query will be a2\xe2\x8a\x95a3\xe2\x8a\x95a4=2\xe2\x8a\x953\xe2\x8a\x956=7. ""1 2 4"" \xe2\x80\x94 s=0111 \xe2\x86\x92 s=0000. ""2 1"" \xe2\x80\x94 s=0000, there are no indices with si=1, so since the XOR of an empty set of numbers is considered to be equal to 0, the answer to this query is 0.\xe2\x80\xa0 A binary string is a string containing only characters 0 or 1." 1500
1872D "Plus Minus Permutation" math "You are given 3 integers \xe2\x80\x94 n, x, y. Let\'s call the score of a permutation\xe2\x80\xa0 p1,\xe2\x80\xa6,pn the following value:(p1\xe2\x8b\x85x+p2\xe2\x8b\x85x+\xe2\x80\xa6+p\xe2\x8c\x8anx\xe2\x8c\x8b\xe2\x8b\x85x)\xe2\x88\x92(p1\xe2\x8b\x85y+p2\xe2\x8b\x85y+\xe2\x80\xa6+p\xe2\x8c\x8any\xe2\x8c\x8b\xe2\x8b\x85y)In other words, the score of a permutation is the sum of pi for all indices i divisible by x, minus the sum of pi for all indices i divisible by y.You need to find the maximum possible score among all permutations of length n.For example, if n=7, x=2, y=3, the maximum score is achieved by the permutation [2,6_,1_,7_,5,4__,3] and is equal to (6+7+4)\xe2\x88\x92(1+4)=17\xe2\x88\x925=12.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (the number 2 appears twice in the array) and [1,3,4] is also not a permutation (n=3, but the array contains 4)." 1200
1872C "Non-coprime Split" "math,number theory" "You are given two integers l\xe2\x89\xa4r. You need to find positive integers a and b such that the following conditions are simultaneously satisfied: l\xe2\x89\xa4a+b\xe2\x89\xa4r gcd(a,b)\xe2\x89\xa01or report that they do not exist.gcd(a,b) denotes the greatest common divisor of numbers a and b. For example, gcd(6,9)=3, gcd(8,9)=1, gcd(4,2)=2." 1100
1872B "The Corridor or There and Back Again" greedy,implementation "You are in a corridor that extends infinitely to the right, divided into square rooms. You start in room 1, proceed to room k, and then return to room 1. You can choose the value of k. Moving to an adjacent room takes 1 second.Additionally, there are n traps in the corridor: the i-th trap is located in room di and will be activated si seconds after you enter the room di. Once a trap is activated, you cannot enter or exit a room with that trap.  A schematic representation of a possible corridor and your path to room k and back. Determine the maximum value of k that allows you to travel from room 1 to room k and then return to room 1 safely.For instance, if n=1 and d1=2,s1=2, you can proceed to room k=2 and return safely (the trap will activate at the moment 1+s1=1+2=3, it can\'t prevent you to return back). But if you attempt to reach room k=3, the trap will activate at the moment 1+s1=1+2=3, preventing your return (you would attempt to enter room 2 on your way back at second 3, but the activated trap would block you). Any larger value for k is also not feasible. Thus, the answer is k=2." 900
1872A "Two Vessels" "brute force,greedy,math" "You have two vessels with water. The first vessel contains a grams of water, and the second vessel contains b grams of water. Both vessels are very large and can hold any amount of water.You also have an empty cup that can hold up to c grams of water.In one move, you can scoop up to c grams of water from any vessel and pour it into the other vessel. Note that the mass of water poured in one move does not have to be an integer.What is the minimum number of moves required to make the masses of water in the vessels equal? Note that you cannot perform any actions other than the described moves." 800
1870H "Standard Graph Problem" "data structures,graphs,greedy,trees" "You are given a weighted directed graph with n vertices and m edges. Each vertex in the graph can be either highlighted or normal. Initially, all vertices are normal. The cost of the graph is defined as the minimum sum of edge weights that need to be selected so that from each normal vertex one can reach at least one highlighted vertex using the selected edges only. If it is not possible to select the edges, the cost is \xe2\x88\x921 instead.Your task is to compute the cost of the graph after each of the q queries. The queries can be of two types:   +vi makes vertex vi highlighted; it is guaranteed that the vertex is normal before the query.  \xe2\x88\x92vi makes vertex vi normal; it is guaranteed that the vertex is highlighted before the query. Output the cost of the graph after each of the q queries." 3500
1870G MEXanization "data structures" "Let\'s define f(S). Let S be a multiset (i.e., it can contain repeated elements) of non-negative integers. In one operation, you can choose any non-empty subset of S (which can also contain repeated elements), remove this subset (all elements in it) from S, and add the MEX of the removed subset to S. You can perform any number of such operations. After all the operations, S should contain exactly 1 number. f(S) is the largest number that could remain in S after any sequence of operations.You are given an array of non-negative integers a of length n. For each of its n prefixes, calculate f(S) if S is the corresponding prefix (for the i-th prefix, S consists of the first i elements of array a).The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." 3300
1870F "Lazy Numbers" "binary search,math" "You are given positive integers n and k. For each number from 1 to n, we write its representation in the number system with base k (without leading zeros) and then sort the resulting array in lexicographic order as strings. In the sorted array, we number the elements from 1 to n (i.e., indexing starts from 1). Find the number of values i such that the representation of number i is at the i-th position in the sorted array of representations.Examples of representations: 1 in any number system is equal to 1, 7 with k=3 is written as 21, and 81 with k=9 is written as 100." 2900
1870E "Another MEX Problem" "bitmasks,brute force,dp,shortest paths" "You are given an array of integers a of size n. You can choose a set of non-overlapping subarrays of the given array (note that some elements may be not included in any subarray, this is allowed). For each selected subarray, calculate the MEX of its elements, and then calculate the bitwise XOR of all the obtained MEX values. What is the maximum bitwise XOR that can be obtained?The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:   The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." 2300
1870D "Prefix Purchase" greedy,implementation,sortings "You have an array a of size n, initially filled with zeros (a1=a2=\xe2\x80\xa6=an=0). You also have an array of integers c of size n.Initially, you have k coins. By paying ci coins, you can add 1 to all elements of the array a from the first to the i-th element (aj+=1 for all 1\xe2\x89\xa4j\xe2\x89\xa4i). You can buy any ci any number of times. A purchase is only possible if k\xe2\x89\xa5ci, meaning that at any moment k\xe2\x89\xa50 must hold true.Find the lexicographically largest array a that can be obtained.An array a is lexicographically smaller than an array b of the same length if and only if in the first position where a and b differ, the element in array a is smaller than the corresponding element in b." 1800
1870C "Colorful Table" "binary search,data structures,dp,implementation,math,two pointers" "You are given two integers n and k. You are also given an array of integers a1,a2,\xe2\x80\xa6,an of size n. It is known that for all 1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4ai\xe2\x89\xa4k.Define a two-dimensional array b of size n\xc3\x97n as follows: bi,j=min(ai,aj). Represent array b as a square, where the upper left cell is b1,1, rows are numbered from top to bottom from 1 to n, and columns are numbered from left to right from 1 to n. Let the color of a cell be the number written in it (for a cell with coordinates (i,j), this is bi,j).For each color from 1 to k, find the smallest rectangle in the array b containing all cells of this color. Output the sum of width and height of this rectangle." 1300
1870B "Friendly Arrays" bitmasks,greedy,math "You are given two arrays of integers \xe2\x80\x94 a1,\xe2\x80\xa6,an of length n, and b1,\xe2\x80\xa6,bm of length m. You can choose any element bj from array b (1\xe2\x89\xa4j\xe2\x89\xa4m), and for all 1\xe2\x89\xa4i\xe2\x89\xa4n perform ai=ai|bj. You can perform any number of such operations.After all the operations, the value of x=a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an will be calculated. Find the minimum and maximum values of x that could be obtained after performing any set of operations.Above, | is the bitwise OR operation, and \xe2\x8a\x95 is the bitwise XOR operation." 1200
1870A "MEXanized Array" "constructive algorithms,greedy,math" "You are given three non-negative integers n, k, and x. Find the maximum possible sum of elements in an array consisting of non-negative integers, which has n elements, its MEX is equal to k, and all its elements do not exceed x. If such an array does not exist, output \xe2\x88\x921.The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:  The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4, because 0, 1, 2 and 3 belong to the array, but 4 does not." 800
1869B "2D Traveling" "geometry,math,shortest paths,sortings" "Piggy lives on an infinite plane with the Cartesian coordinate system on it.There are n cities on the plane, numbered from 1 to n, and the first k cities are defined as major cities. The coordinates of the i-th city are (xi,yi).Piggy, as a well-experienced traveller, wants to have a relaxing trip after Zhongkao examination. Currently, he is in city a, and he wants to travel to city b by air. You can fly between any two cities, and you can visit several cities in any order while travelling, but the final destination must be city b.Because of active trade between major cities, it\'s possible to travel by plane between them for free. Formally, the price of an air ticket f(i,j) between two cities i and j is defined as follows:f(i,j)={0,if cities i and j are both major cities|xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|,otherwisePiggy doesn\'t want to save time, but he wants to save money. So you need to tell him the minimum value of the total cost of all air tickets if he can take any number of flights." 1100
1869A "Make It Zero" "constructive algorithms" "During Zhongkao examination, Reycloer met an interesting problem, but he cannot come up with a solution immediately. Time is running out! Please help him.Initially, you are given an array a consisting of n\xe2\x89\xa52 integers, and you want to change all elements in it to 0.In one operation, you select two indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and do the following:  Let s=al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar, where \xe2\x8a\x95 denotes the bitwise XOR operation;  Then, for all l\xe2\x89\xa4i\xe2\x89\xa4r, replace ai with s. You can use the operation above in any order at most 8 times in total.Find a sequence of operations, such that after performing the operations in order, all elements in a are equal to 0. It can be proven that the solution always exists." 900
1868F LIS? "data structures,greedy,implementation" "Entering senior high school life, Tom is attracted by LIS problems, not only the Longest Increasing Subsequence problem, but also the Largest Interval Sum problem. Now he gets a really interesting problem from his friend Daniel. However, it seems too hard for him to solve it, so he asks you for help.Given an array a consisting of n integers.In one operation, you do the following:   Select an interval [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), such that the sum of the interval is the largest among all intervals in the array a. More formally, r\xe2\x88\x91i=lai=max1\xe2\x89\xa4l\xe2\x80\xb2\xe2\x89\xa4r\xe2\x80\xb2\xe2\x89\xa4nr\xe2\x80\xb2\xe2\x88\x91i=l\xe2\x80\xb2ai. Then subtract 1 from all elements al,al+1,\xe2\x80\xa6,ar. Find the minimum number of operations you need to perform to make ai<0 for every 1\xe2\x89\xa4i\xe2\x89\xa4n." 3500
1868E Min-Sum-Max "constructive algorithms,dp,greedy" "Tom is waiting for his results of Zhongkao examination. To ease the tense atmosphere, his friend, Daniel, decided to play a game with him. This game is called ""Divide the Array"".The game is about the array a consisting of n integers. Denote [l,r] as the subsegment consisting of integers al,al+1,\xe2\x80\xa6,ar.Tom will divide the array into contiguous subsegments [l1,r1],[l2,r2],\xe2\x80\xa6,[lm,rm], such that each integer is in exactly one subsegment. More formally:  For all 1\xe2\x89\xa4i\xe2\x89\xa4m, 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n;  l1=1, rm=n;  For all 1<i\xe2\x89\xa4m, li=ri\xe2\x88\x921+1. Denote si=\xe2\x88\x91rik=liak, that is, si is the sum of integers in the i-th subsegment. For all 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4m, the following condition must hold:mini\xe2\x89\xa4k\xe2\x89\xa4jsk\xe2\x89\xa4j\xe2\x88\x91k=isk\xe2\x89\xa4maxi\xe2\x89\xa4k\xe2\x89\xa4jsk.Tom believes that the more subsegments the array a is divided into, the better results he will get. So he asks Daniel to find the maximum number of subsegments among all possible ways to divide the array a. You have to help him find it." 3500
1868D "Flower-like Pseudotree" "constructive algorithms,graphs,greedy,implementation,trees" "A pseudotree is a connected graph which has exactly one cycle and no self-loops. Note that a pseudotree may contain multiple-edges. It can be shown that a pseudotree with n vertices always contains n edges.After deleting all edges on the cycle in the pseudotree, a forest\xe2\x80\xa0 will be formed. It can be shown that each tree in the forest will contain exactly one vertex which is on cycle before removing the edges. If all trees in the forest have the same depth\xe2\x80\xa1 when picking the vertex on cycle as root, we call the original pseudotree flower-like.Our friend sszcdjr, had a flower-like pseudotree with n vertices and n edges. However, he forgot all the edges in the pseudotree. Fortunately, he still remembers the degrees of vertices. Specifically, the degree of the i-th vertex is di.You have to help sszcdjr construct a possible flower-like pseudotree with n vertices, where the degree of the i-th vertex is exactly di, or tell him that it is impossible.\xe2\x80\xa0 A forest is a graph in which all connectivity components are trees. A connected graph without cycles and self-loops is called a tree.\xe2\x80\xa1 The depth of a tree with a root is the maximum distance from the root to the vertex of this tree." 3000
1868C "Travel Plan" combinatorics,dp,implementation,math,trees "During the summer vacation after Zhongkao examination, Tom and Daniel are planning to go traveling.There are n cities in their country, numbered from 1 to n. And the traffic system in the country is very special. For each city i (1\xe2\x89\xa4i\xe2\x89\xa4n), there is  a road between city i and 2i, if 2i\xe2\x89\xa4n;  a road between city i and 2i+1, if 2i+1\xe2\x89\xa4n. Making a travel plan, Daniel chooses some integer value between 1 and m for each city, for the i-th city we denote it by ai.Let si,j be the maximum value of cities in the simple\xe2\x80\xa0 path between cities i and j. The score of the travel plan is \xe2\x88\x91ni=1\xe2\x88\x91nj=isi,j. Tom wants to know the sum of scores of all possible travel plans. Daniel asks you to help him find it. You just need to tell him the answer modulo 998244353.\xe2\x80\xa0 A simple path between cities x and y is a path between them that passes through each city at most once." 2400
1868B2 "Candy Party (Hard Version)" "bitmasks,constructive algorithms,dp,greedy,implementation,math" "This is the hard version of the problem. The only difference is that in this version everyone must give candies to no more than one person and receive candies from no more than one person. Note that a submission cannot pass both versions of the problem at the same time. You can make hacks only if both versions of the problem are solved.After Zhongkao examination, Daniel and his friends are going to have a party. Everyone will come with some candies.There will be n people at the party. Initially, the i-th person has ai candies. During the party, they will swap their candies. To do this, they will line up in an arbitrary order and everyone will do the following no more than once:  Choose an integer p (1\xe2\x89\xa4p\xe2\x89\xa4n) and a non-negative integer x, then give his 2x candies to the p-th person. Note that one cannot give more candies than currently he has (he might receive candies from someone else before) and he cannot give candies to himself. Daniel likes fairness, so he will be happy if and only if everyone receives candies from no more than one person. Meanwhile, his friend Tom likes average, so he will be happy if and only if all the people have the same number of candies after all swaps.Determine whether there exists a way to swap candies, so that both Daniel and Tom will be happy after the swaps." 2100
1868B1 "Candy Party (Easy Version)" "bitmasks,constructive algorithms,graphs,greedy,implementation,math" "This is the easy version of the problem. The only difference is that in this version everyone must give candies to exactly one person and receive candies from exactly one person. Note that a submission cannot pass both versions of the problem at the same time. You can make hacks only if both versions of the problem are solved.After Zhongkao examination, Daniel and his friends are going to have a party. Everyone will come with some candies.There will be n people at the party. Initially, the i-th person has ai candies. During the party, they will swap their candies. To do this, they will line up in an arbitrary order and everyone will do the following exactly once:  Choose an integer p (1\xe2\x89\xa4p\xe2\x89\xa4n) and a non-negative integer x, then give his 2x candies to the p-th person. Note that one cannot give more candies than currently he has (he might receive candies from someone else before) and he cannot give candies to himself. Daniel likes fairness, so he will be happy if and only if everyone receives candies from exactly one person. Meanwhile, his friend Tom likes average, so he will be happy if and only if all the people have the same number of candies after all swaps.Determine whether there exists a way to swap candies, so that both Daniel and Tom will be happy after the swaps." 1700
1868A "Fill in the Matrix" "constructive algorithms,implementation" "There is an empty matrix M of size n\xc3\x97m.Zhongkao examination is over, and Daniel would like to do some puzzle games. He is going to fill in the matrix M using permutations of length m. That is, each row of M must be a permutation of length m\xe2\x80\xa0.Define the value of the i-th column in M as vi=MEX(M1,i,M2,i,\xe2\x80\xa6,Mn,i)\xe2\x80\xa1. Since Daniel likes diversity, the beauty of M is s=MEX(v1,v2,\xe2\x8b\xaf,vm).You have to help Daniel fill in the matrix M and maximize its beauty.\xe2\x80\xa0 A permutation of length m is an array consisting of m distinct integers from 0 to m\xe2\x88\x921 in arbitrary order. For example, [1,2,0,4,3] is a permutation, but [0,1,1] is not a permutation (1 appears twice in the array), and [0,1,3] is also not a permutation (m\xe2\x88\x921=2 but there is 3 in the array).\xe2\x80\xa1 The MEX of an array is the smallest non-negative integer that does not belong to the array. For example, MEX(2,2,1)=0 because 0 does not belong to the array, and MEX(0,3,1,2)=4 because 0, 1, 2 and 3 appear in the array, but 4 does not." 1300
1867F "Most Different Tree" "brute force,constructive algorithms,dfs and similar,greedy,hashing" "Given a tree with n vertices rooted at vertex 1, denote it as G. Also denote P(G) as the multiset of subtrees of all vertices in tree G. You need to find a tree G\xe2\x80\xb2 of size n rooted at vertex 1 such that the number of subtrees in P(G\xe2\x80\xb2) that are isomorphic to any subtree in P(G) is minimized.A subtree of vertex v is a graph that contains all vertices for which vertex v lies on the path from the root of the tree to itself, as well as all edges between these vertices.Two rooted trees are considered isomorphic if it is possible to relabel the vertices of one of them so that it becomes equal to the other, with the root of the first tree receiving the number of the root of the second tree." 2700
1867E2 "Salyg1n and Array (hard version)" "constructive algorithms,interactive" "This is the hard version of the problem. The only difference between the versions is the limit on the number of queries. In this version, you can make no more than 57 queries. You can make hacks only if both versions of the problem are solved.This is an interactive problem!salyg1n has given you a positive integer k and wants to play a game with you. He has chosen an array of n integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4109). You must print a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an, where \xe2\x8a\x95 denotes the bitwise XOR operation. You can make queries of the following type:  ? i: in response to this query, you will receive ai\xe2\x8a\x95ai+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ai+k\xe2\x88\x921. Also, after this query, the subarray ai,ai+1,\xe2\x80\xa6,ai+k\xe2\x88\x921 will be reversed, i.e., the chosen array a will become: a1,a2,\xe2\x80\xa6ai\xe2\x88\x921,ai+k\xe2\x88\x921,ai+k\xe2\x88\x922,\xe2\x80\xa6,ai+1,ai,ai+k,\xe2\x80\xa6,an. You can make no more than 57 queries to answer the problem." 2200
1867E1 "Salyg1n and Array (simple version)" "constructive algorithms,interactive,math" "This is the simple version of the problem. The only difference between the versions is the limit on the number of queries. In this version, you can make no more than 100 queries. You can make hacks only if both versions of the problem are solved.This is an interactive problem!salyg1n has given you a positive integer k and wants to play a game with you. He has chosen an array of n integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4109). You must print a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an, where \xe2\x8a\x95 denotes the bitwise XOR operation. You can make queries of the following type:  ? i: in response to this query, you will receive ai\xe2\x8a\x95ai+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ai+k\xe2\x88\x921. Also, after this query, the subarray ai,ai+1,\xe2\x80\xa6,ai+k\xe2\x88\x921 will be reversed, i.e., the chosen array a will become: a1,a2,\xe2\x80\xa6ai\xe2\x88\x921,ai+k\xe2\x88\x921,ai+k\xe2\x88\x922,\xe2\x80\xa6,ai+1,ai,ai+k,\xe2\x80\xa6,an. You can make no more than 100 queries to answer the problem." 2000
1867D "Cyclic Operations" "brute force,constructive algorithms,dfs and similar,graphs,greedy,implementation" "Egor has an array a of length n, initially consisting of zeros. However, he wanted to turn it into another array b of length n.Since Egor doesn\'t take easy paths, only the following operation can be used (possibly zero or several times):  choose an array l of length k (1\xe2\x89\xa4li\xe2\x89\xa4n, all li are distinct) and change each element ali to l(i%k)+1 (1\xe2\x89\xa4i\xe2\x89\xa4k). He became interested in whether it is possible to get the array b using only these operations. Since Egor is still a beginner programmer, he asked you to help him solve this problem.The operation % means taking the remainder, that is, a%b is equal to the remainder of dividing the number a by the number b." 1800
1867C "Salyg1n and the MEX Game" "constructive algorithms,data structures,games,greedy,interactive" "This is an interactive problem!salyg1n gave Alice a set S of n distinct integers s1,s2,\xe2\x80\xa6,sn (0\xe2\x89\xa4si\xe2\x89\xa4109). Alice decided to play a game with this set against Bob. The rules of the game are as follows:  Players take turns, with Alice going first.  In one move, Alice adds one number x (0\xe2\x89\xa4x\xe2\x89\xa4109) to the set S. The set S must not contain the number x at the time of the move. In one move, Bob removes one number y from the set S. The set S must contain the number y at the time of the move. Additionally, the number y must be strictly smaller than the last number added by Alice. The game ends when Bob cannot make a move or after 2\xe2\x8b\x85n+1 moves (in which case Alice\'s move will be the last one). The result of the game is MEX\xe2\x80\xa0(S) (S at the end of the game). Alice aims to maximize the result, while Bob aims to minimize it. Let R be the result when both players play optimally. In this problem, you play as Alice against the jury program playing as Bob. Your task is to implement a strategy for Alice such that the result of the game is always at least R.\xe2\x80\xa0 MEX of a set of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest non-negative integer x which does not occur in the set c. For example, MEX({0,1,2,4}) = 3." 1300
1867B "XOR Palindromes" "bitmasks,constructive algorithms,strings" "You are given a binary string s of length n (a string that consists only of 0 and 1). A number x is good if there exists a binary string l of length n, containing x ones, such that if each symbol si is replaced by si\xe2\x8a\x95li (where \xe2\x8a\x95 denotes the bitwise XOR operation), then the string s becomes a palindrome.You need to output a binary string t of length n+1, where ti (0\xe2\x89\xa4i\xe2\x89\xa4n) is equal to 1 if number i is good, and 0 otherwise.A palindrome is a string that reads the same from left to right as from right to left. For example, 01010, 1111, 0110 are palindromes." 1100
1867A "green_gold_dog, array and permutation" "constructive algorithms,sortings" "green_gold_dog has an array a of length n, and he wants to find a permutation b of length n such that the number of distinct numbers in the element-wise difference between array a and permutation b is maximized.A permutation of length n is an array consisting of n distinct integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (as 2 appears twice in the array) and [1,3,4] is also not a permutation (as n=3, but 4 appears in the array).The element-wise difference between two arrays a and b of length n is an array c of length n, where ci = ai\xe2\x88\x92bi (1\xe2\x89\xa4i\xe2\x89\xa4n)." 800
1866M "Mighty Rock Tower" "brute force,combinatorics,dp,math,probabilities" "Pak Chanek comes up with an idea in the midst of boredom to play a game. The game is a rock tower game. There is a big rock that is used as a base. There are also N small identical rocks that Pak Chanek will use to build a rock tower with a height of N above the base rock.Initially, there are no small rocks that are located above the base rock. In other words, the height of the tower above the base rock is initially 0. In one move, Pak Chanek can place one small rock onto the top of the tower which makes the height of the tower above the base rock increase by 1. Each time Pak Chanek place one small rock, the following will happen after the small rock is placed:   Let\'s say x is the height of the tower above the base rock right after the small rock is placed.  There is a probability of Px percent that the topmost rock falls.  If x\xe2\x89\xa52 and the topmost rock falls, then there is another probability of Px percent that the 2-nd topmost rock also falls.  If x\xe2\x89\xa53 and the 2-nd topmost rock falls, then there is another probability of Px percent that the 3-rd topmost rock also falls.  If x\xe2\x89\xa54 and the 3-rd topmost rock falls, then there is another probability of Px percent that the 4-th topmost rock also falls.  And so on. If the tower successfully reaches a height of N without any rocks falling after that, then the game is ended.If given an integer array [P1,P2,\xe2\x80\xa6,PN], what is the expected value of the number of moves that Pak Chanek needs to do to end the game? It can be proven that the expected value can be represented as an simple fraction PQ where Q is coprime to 998244353. Output the value of P\xc3\x97Q\xe2\x88\x921 modulo 998244353." 2400
1866L "Lihmuf Balling" "binary search,brute force,math" "After working at a factory (Lihmuf Sorting), Lihmuf wants to play a game with his good friend, Pak Chanek. There are N boxes numbered from 1 to N. The i-th box contains i balls. Pak Chanek and Lihmuf will play a game using those boxes.There will be N turns numbered from 1 to N. On each turn, Pak Chanek chooses one box and takes all balls from that box, then Lihmuf does the same thing for one box he chooses (it is possible that the two chosen boxes are the same).Given an integer M. Before the game begins, Lihmuf must choose an integer K satisfying 1\xe2\x89\xa4K\xe2\x89\xa4M. It is known that on the j-th turn, Pak Chanek will choose the j-th box, while Lihmuf will choose the y-th box, with y=((j\xc3\x97K\xe2\x88\x921)modN)+1. Help Lihmuf choose the correct value of K so that he will get as many balls as possible! If there are more than one possible values of K that result in the maximum total balls, find the minimum such value of K.Keep in mind that each box can be chosen more than once, but after a box is chosen for the first time, the box becomes empty." 2400
1866K "Keen Tree Calculation" "binary search,data structures,dp,geometry,graphs,implementation,trees" "There is a tree of N vertices and N\xe2\x88\x921 edges. The i-th edge connects vertices Ui and Vi and has a length of Wi.Chaneka, the owner of the tree, asks you Q times. For the j-th question, the following is the question format:   Xj Kj \xe2\x80\x93 If each edge that contains vertex Xj has its length multiplied by Kj, what is the diameter of the tree? Notes:   Each of Chaneka\'s question is independent, which means the changes in edge length do not influence the next questions.  The diameter of a tree is the maximum possible distance between two different vertices in the tree." 2500
1866J "Jackets and Packets" dp "Pak Chanek has N jackets that are stored in a wardrobe. Pak Chanek\'s wardrobe has enough room for two stacks of jackets, namely the left stack and the right stack. Initially, all N jackets are in the left stack, while the right stack is empty. Initially, the i-th jacket from the top of the left stack has colour Ci.Pak Chanek wants to pack all of those jackets into some packets, such that the jackets in the same packet has the same colour. However, it is possible for two jackets with the same colour to be in different packets.Pak Chanek can do two kinds of operations:   Pak Chanek can pick any number of jackets from the top from one stack as long as the colour is the same, then take those jackets out of the stack and pack them into a packet. This packing operation takes X minutes, no matter how many jackets are packed.  Pak Chanek can move one topmost jacket from one stack to the top of the other stack (possibly right to left or left to right). This moving operation takes Y minutes. Determine the minimum time to pack all jackets!" 2800
1866I "Imagination Castle" "dp,games,two pointers" "Given a chessboard of size N\xc3\x97M (N rows and M columns). Each row is numbered from 1 to N from top to bottom and each column is numbered from 1 to M from left to right. The tile in row r and column c is denoted as (r,c). There exists K distinct special tiles on the chessboard with the i-th special tile being tile (Xi,Yi). It is guaranteed that tile (1,1) is not a special tile.A new chess piece has been invented, which is the castle. The castle moves similarly to a rook in regular chess, but slightly differently. In one move, a castle that is on some tile can only move to another tile in the same row or in the same column, but only in the right direction or the down direction. Formally, in one move, the castle on tile (r,c) can only move to tile (r\xe2\x80\xb2,c\xe2\x80\xb2) if and only if one of the following two conditions is satisfied:   r\xe2\x80\xb2=r and c\xe2\x80\xb2>c.  c\xe2\x80\xb2=c and r\xe2\x80\xb2>r. Chaneka and Bhinneka will play a game. In the beginning of the game, there is a castle in tile (1,1). The two players will play alternatingly with Chaneka going first. In one turn, the player on that turn must move the castle following the movement rules of the castle.If a player moves the castle to a special tile on her turn, then that player wins the game and the game ends. If on a turn, the castle cannot be moved, the player on that turn loses and the game ends.Given the size of the board and the locations of each special tile. Determine the winner of this game if Chaneka and Bhinneka plays optimally." 2300
1866H "Happy Sets" combinatorics "Define a set A as a child of set B if and only if for each element of value x that is in A, there exists an element of value x+1 that is in B.Given integers N and K. In order to make Chaneka happy, you must find the number of different arrays containing N sets [S1,S2,S3,\xe2\x80\xa6,SN] such that: - Each set can only contain zero or more different integers from 1 to K. - There exists a way to rearrange the order of the array of sets into [S\xe2\x80\xb21,S\xe2\x80\xb22,S\xe2\x80\xb23,\xe2\x80\xa6,S\xe2\x80\xb2N] such that S\xe2\x80\xb2i is a child of S\xe2\x80\xb2i+1 for each 1\xe2\x89\xa4i\xe2\x89\xa4N\xe2\x88\x921.Print the answer modulo 998244353.Two sets are considered different if and only if there is at least one value that only occurs in one of the two sets.Two arrays of sets are considered different if and only if there is at least one index i such that the sets at index i in the two arrays are different." 2100
1866G "Grouped Carriages" "binary search,data structures,dp,flows,greedy" "Pak Chanek observes that the carriages of a train is always full on morning departure hours and afternoon departure hours. Therefore, the balance between carriages is needed so that it is not too crowded in only a few carriages.A train contains N carriages that are numbered from 1 to N from left to right. Carriage i initially contains Ai passengers. All carriages are connected by carriage doors, namely for each i (1\xe2\x89\xa4i\xe2\x89\xa4N\xe2\x88\x921), carriage i and carriage i+1 are connected by a two-way door.Each passenger can move between carriages, but train regulation regulates that for each i, a passenger that starts from carriage i cannot go through more than Di doors.Define Z as the most number of passengers in one same carriage after moving. Pak Chanek asks, what is the minimum possible value of Z?" 2100
1866F "Freak Joker Process" "binary search,data structures,sortings" "After the success of the basketball teams formed and trained by Pak Chanek last year (Basketball Together), Pak Chanek wants to measure the performance of each player that is considered as a superstar.There are N superstar players that have been trained by Pak Chanek. At the end of the season, some calculations will be made on the performance of the N players using an international method. Each player has two values Ai and Bi where each represents the offensive and defensive value of that player.Define RankA(i) as the offensive ranking of the i-th player, whose value is c+1 with c here representing the number of j (1\xe2\x89\xa4j\xe2\x89\xa4N) such that Aj>Ai. Define RankB(i) as the defensive ranking of the i-th player, whose value is c+1 with c here representing the number of j (1\xe2\x89\xa4j\xe2\x89\xa4N) such that Bj>Bi.Define RankOverall(i) as the overall ranking of the i-th player, whose value is c+1 with c here representing the number of j (1\xe2\x89\xa4j\xe2\x89\xa4N) such that RankA(j)+RankB(j)<RankA(i)+RankB(i).During the next Q days, exactly one event will happen on each day. Each event is one of the three following possibilities:  1 k c \xe2\x80\x93 If c is +, then Ak increases by 1. If c is -, then Ak decreases by 1. (1\xe2\x89\xa4k\xe2\x89\xa4N; c is + or -)  2 k c \xe2\x80\x93 If c is +, then Bk increases by 1. If c is -, then Bk decreases by 1. (1\xe2\x89\xa4k\xe2\x89\xa4N; c is + or -)  3 k \xe2\x80\x93 Pak Chanek wants to know the value of RankOverall(k) at that moment. (1\xe2\x89\xa4k\xe2\x89\xa4N)" 3100
1866E "Elevators of Tamem" dp "There is a building named Taman Membeku (shortened as Tamem). The building has N floors numbered from 1 to N from bottom to top. The only way to move between floors in the building is to use elevators. There are 3 elevators available in Tamem, namely elevators 1, 2, and 3.Pak Chanek works as an elevator operator in Tamem. Pak Chanek will work for Q days. Initially, each elevator is in floor 1 and all elevators are on. On each day, exactly one of the following will happen:   1 x y \xe2\x80\x93 There is a person currently in floor x who wants to go to floor y. (1\xe2\x89\xa4x,y\xe2\x89\xa4N; x\xe2\x89\xa0y)  2 p \xe2\x80\x93 Elevator p changes state at the start of the day. If previously it is on, then it will turn off. If previously it is off, then it will turn on. (1\xe2\x89\xa4p\xe2\x89\xa43) For each day, Pak Chanek can control the movement of all elevators as he pleases. However, for each day where there is a person currently in floor x who wants to go to floor y, among all elevator movements done by Pak Chanek, the following must happen:   One elevator moves to floor x.  The person gets into the elevator.  The elevator moves to floor y.  The person gets out of the elevator. For each day, Pak Chanek can only move the elevators that are currently on. Note that, since a change in state happens at the start of the day, this means that an elevator that turns off on some day starts becoming unusable from that day itself. Conversely, an elevator that turns on on some day starts becoming usable from that day itself.It is known that the electricity fee for each day is different. More specifically, on the j-th day, the fee needed to move one elevator up or down by one floor is Aj.From the start, Pak Chanek already knows the electricity fees and the sequence of events that will happen on the Q days, so Pak Chanek can operate the elevators strategically. What is the minimum possible electricity fee to fulfill all needs of the people who want to move between floors in Tamem? Note: in the end, each elevator does not have to go back to floor 1." 2700
1866D "Digital Wallet" dp,greedy "There are N arrays, each array has M positive integer elements The j-th element of the i-th array is Ai,j.Initially, Chaneka\'s digital wallet contains 0 money. Given an integer K. Chaneka will do M\xe2\x88\x92K+1 operations. In the p-th operation, Chaneka does the following procedure:   Choose any array. Let\'s say Chaneka chooses the x-th array.  Choose an index y in that array such that p\xe2\x89\xa4y\xe2\x89\xa4p+K\xe2\x88\x921.  Add the value of Ax,y to the total money in the wallet.  Change the value of Ax,y into 0. Determine the maximum total money that can be earned!" 2300
1866C "Completely Searching for Inversions" "dfs and similar,dp,graphs" "Pak Chanek has a directed acyclic graph (a directed graph that does not have any cycles) containing N vertices. Vertex i has Si edges directed away from that vertex. The j-th edge of vertex i that is directed away from it, is directed towards vertex Li,j and has an integer Wi,j (0\xe2\x89\xa4Wi,j\xe2\x89\xa41). Another information about the graph is that the graph is shaped in such a way such that each vertex can be reached from vertex 1 via zero or more directed edges.Pak Chanek has an array Z that is initially empty.Pak Chanek defines the function dfs as follows:// dfs from vertex ivoid dfs(int i) {    // iterate each edge of vertex i that is directed away from it    for(int j = 1; j <= S[i]; j++) {        Z.push_back(W[i][j]); // add the integer in the edge to the end of Z        dfs(L[i][j]); // recurse to the next vertex    }}Note that the function does not keep track of which vertices have been visited, so each vertex can be processed more than once.Let\'s say Pak Chanek does dfs(1) once. After that, Pak Chanek will get an array Z containing some elements 0 or 1. Define an inversion in array Z as a pair of indices (x,y) (x<y) such that Zx>Zy. How many different inversions in Z are there if Pak Chanek does dfs(1) once? Since the answer can be very big, output the answer modulo 998244353." 1900
1866B "Battling with Numbers" "combinatorics,math,number theory" "On the trip to campus during the mid semester exam period, Chaneka thinks of two positive integers X and Y. Since the two integers can be very big, both are represented using their prime factorisations, such that:   X=AB11\xc3\x97AB22\xc3\x97\xe2\x80\xa6\xc3\x97ABNN (each Ai is prime, each Bi is positive, and A1<A2<\xe2\x80\xa6<AN)  Y=CD11\xc3\x97CD22\xc3\x97\xe2\x80\xa6\xc3\x97CDMM (each Cj is prime, each Dj is positive, and C1<C2<\xe2\x80\xa6<CM) Chaneka ponders about these two integers for too long throughout the trip, so Chaneka\'s friend commands her ""Gece, deh!"" (move fast) in order to not be late for the exam.Because of that command, Chaneka comes up with a problem, how many pairs of positive integers p and q such that LCM(p,q)=X and GCD(p,q)=Y. Since the answer can be very big, output the answer modulo 998244353.Notes:   LCM(p,q) is the smallest positive integer that is simultaneously divisible by p and q.  GCD(p,q) is the biggest positive integer that simultaneously divides p and q." 1400
1866A "Ambitious Kid" math "Chaneka, Pak Chanek\'s child, is an ambitious kid, so Pak Chanek gives her the following problem to test her ambition.Given an array of integers [A1,A2,A3,\xe2\x80\xa6,AN]. In one operation, Chaneka can choose one element, then increase or decrease the element\'s value by 1. Chaneka can do that operation multiple times, even for different elements.What is the minimum number of operations that must be done to make it such that A1\xc3\x97A2\xc3\x97A3\xc3\x97\xe2\x80\xa6\xc3\x97AN=0?" 800
1864I "Future Dominators" graphs,greedy "Dhruvil and amenotiomoi are sitting in different countries and chatting online. Initially, amenotiomoi has an empty board of size n\xc3\x97n, and Dhruvil has a sequence of integers 1,2,\xe2\x80\xa6,n2, each number occurring exactly once. The numbers may be placed in the cells of the board, each cell is either empty or contains exactly one number.The current state of the board is called good, if there is a way of placing the remaining numbers in empty cells so that all numbers except 1 have a neighbor with a smaller value. Two cells are neighbors if they share an edge.The rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. The cell at the intersection of the x-th row and the y-th column is denoted as (x,y).To chat, amenotiomoi asks q queries to Dhruvil. Each time he provides Dhruvil with an empty cell (x,y). Dhruvil has to place one of the remaining numbers in this cell so that the board is still good. Among all ways to do this, he chooses the largest possible number he can place and sends this number to amenotiomoi as the answer to the query.Since amenotiomoi knows the correct answer every time, he tells Dhruvil (x\xe2\x8a\x95k,y\xe2\x8a\x95k) instead of (x,y), where k is the answer for the previous query. If amenotiomoi is sending the first query, he considers k=0. Each time Dhruvil has to decode the query and send the answer to amenotiomoi. Here \xe2\x8a\x95 denotes the bitwise XOR operation.Help Dhruvil reply to all amenotiomoi\'s queries." 3500
1864H "Asterism Stream" dp,math,matrices "Bogocubic is playing a game with amenotiomoi. First, Bogocubic fixed an integer n, and then he gave amenotiomoi an integer x which is initially equal to 1.In one move amenotiomoi performs one of the following operations with the same probability:  increase x by 1;  multiply x by 2. Bogocubic wants to find the expected number of moves amenotiomoi has to do to make x greater than or equal to n. Help him find this number modulo 998244353.Formally, let M=998244353. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer y that 0\xe2\x89\xa4y<M and y\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 3200
1864G "Magic Square" "combinatorics,constructive algorithms,implementation" "Aquamoon has a Rubik\'s Square which can be seen as an n\xc3\x97n matrix, the elements of the matrix constitute a permutation of numbers 1,\xe2\x80\xa6,n2.Aquamoon can perform two operations on the matrix:  Row shift, i.e. shift an entire row of the matrix several positions (at least 1 and at most n\xe2\x88\x921) to the right. The elements that come out of the right border of the matrix are moved to the beginning of the row. For example, shifting a row (abc) by 2 positions would result in (bca); Column shift, i.e. shift an entire column of the matrix several positions (at least 1 and at most n\xe2\x88\x921) downwards. The elements that come out of the lower border of the matrix are moved to the beginning of the column. For example, shifting a column (abc) by 2 positions would result in (bca). The rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. The cell at the intersection of the x-th row and the y-th column is denoted as (x,y).Aquamoon can perform several (possibly, zero) operations, but she has to obey the following restrictions: each row and each column can be shifted at most once; each integer of the matrix can be moved at most twice; the offsets of any two integers moved twice cannot be the same. Formally, if integers a and b have been moved twice, assuming a has changed its position from (x1,y1) to (x2,y2), and b has changed its position from (x3,y3) to (x4,y4), then x2\xe2\x88\x92x1\xe2\x89\xa2x4\xe2\x88\x92x3(modn) or y2\xe2\x88\x92y1\xe2\x89\xa2y4\xe2\x88\x92y3(modn).Aquamoon wonders in how many ways she can transform the Rubik\'s Square from the given initial state to a given target state. Two ways are considered different if the sequences of applied operations are different. Since the answer can be very large, print the result modulo 998244353." 3100
1864F "Exotic Queries" "data structures,implementation,sortings" "AquaMoon gives RiverHamster a sequence of integers a1,a2,\xe2\x80\xa6,an, and RiverHamster gives you q queries. Each query is expressed by two integers l and r. For each query independently, you can take any continuous segment of the sequence and subtract an identical non-negative value from all the numbers of this segment. You can do so multiple (possibly, zero) times. However, you may not choose two intersecting segments which are not included in one another. Your goal is to convert to 0 all numbers whose initial value was within the range [l,r]. You must do so in the minimum number of operations.Please note that the queries are independent, the numbers in the array are restored to their initial values between the queries.Formally, for each query, you are to find the smallest m such that there exists a sequence {(xj,yj,zj)}mj=1 satisfying the following conditions:  for any 1\xe2\x89\xa4j\xe2\x89\xa4m, zj\xe2\x89\xa50 and 1\xe2\x89\xa4xj\xe2\x89\xa4yj\xe2\x89\xa4n (here [xj,yj] correspond to the segment of the sequence);  for any 1\xe2\x89\xa4j<k\xe2\x89\xa4m, it is true that [xj,yj]\xe2\x8a\x86[xk,yk], or [xk,yk]\xe2\x8a\x86[xj,yj], or [xj,yj]\xe2\x88\xa9[xk,yk]=\xe2\x88\x85;  for any 1\xe2\x89\xa4i\xe2\x89\xa4n, such that l\xe2\x89\xa4ai\xe2\x89\xa4r, it is true that ai=\xe2\x88\x911\xe2\x89\xa4j\xe2\x89\xa4mxj\xe2\x89\xa4i\xe2\x89\xa4yjzj." 2300
1864E "Guess Game" "bitmasks,data structures,games,math,probabilities,sortings,strings,trees" "Carol has a sequence s of n non-negative integers. She wants to play the ""Guess Game"" with Alice and Bob.To play the game, Carol will randomly select two integer indices ia and ib within the range [1,n], and set a=sia, b=sib. Please note that ia and ib may coincide.Carol will tell:  the value of a to Alice;  the value of b to Bob;  the value of a\xe2\x88\xa3b to both Alice and Bob, where | denotes the bitwise OR operation. Please note that Carol will not tell any information about s to either Alice or Bob.Then the guessing starts. The two players take turns making guesses, with Alice starting first. The goal of both players is to establish which of the following is true: a<b, a>b, or a=b.In their turn, a player can do one of the following two things:  say ""I don\'t know"", and pass the turn to the other player;  say ""I know"", followed by the answer ""a<b"", ""a>b"", or ""a=b""; then the game ends. Alice and Bob hear what each other says, and can use this information to deduce the answer. Both Alice and Bob are smart enough and only say ""I know"" when they are completely sure.You need to calculate the expected value of the number of turns taken by players in the game. Output the answer modulo 998244353.Formally, let M=998244353. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2100
1864D "Matrix Cascade" "brute force,constructive algorithms,data structures,dp,greedy,math" "There is a matrix of size n\xc3\x97n which consists of 0s and 1s. The rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. The cell at the intersection of the x-th row and the y-th column is denoted as (x,y).AquaMoon wants to turn all elements of the matrix to 0s. In one step she can perform the following operation:  Select an arbitrary cell, let it be (i,j), then invert the element in (i,j) and also invert all elements in cells (x,y) for x>i and x\xe2\x88\x92i\xe2\x89\xa5|y\xe2\x88\x92j|. To invert a value means to change it to the opposite: 0 changes to 1, 1 changes to 0. Help AquaMoon determine the minimum number of steps she need to perform to turn all elements of the matrix to 0s. We can show that an answer always exists." 1700
1864C "Divisor Chain" "bitmasks,constructive algorithms,math,number theory" "You are given an integer x. Your task is to reduce x to 1.To do that, you can do the following operation:  select a divisor d of x, then change x to x\xe2\x88\x92d, i.e. reduce x by d. (We say that d is a divisor of x if d is an positive integer and there exists an integer q such that x=d\xe2\x8b\x85q.) There is an additional constraint: you cannot select the same value of d more than twice.For example, for x=5, the following scheme is invalid because 1 is selected more than twice: 5\xe2\x88\x921\xe2\x86\x924\xe2\x88\x921\xe2\x86\x923\xe2\x88\x921\xe2\x86\x922\xe2\x88\x921\xe2\x86\x921. The following scheme is however a valid one: 5\xe2\x88\x921\xe2\x86\x924\xe2\x88\x922\xe2\x86\x922\xe2\x88\x921\xe2\x86\x921.Output any scheme which reduces x to 1 with at most 1000 operations. It can be proved that such a scheme always exists." 1300
1864B "Swap and Reverse" "constructive algorithms,greedy,sortings,strings" "You are given a string s of length n consisting of lowercase English letters, and an integer k. In one step you can perform any one of the two operations below:  Pick an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x922) and swap si and si+2.  Pick an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k+1) and reverse the order of letters formed by the range [i,i+k\xe2\x88\x921] of the string. Formally, if the string currently is equal to s1\xe2\x80\xa6si\xe2\x88\x921sisi+1\xe2\x80\xa6si+k\xe2\x88\x922si+k\xe2\x88\x921si+k\xe2\x80\xa6sn\xe2\x88\x921sn, change it to s1\xe2\x80\xa6si\xe2\x88\x921si+k\xe2\x88\x921si+k\xe2\x88\x922\xe2\x80\xa6si+1sisi+k\xe2\x80\xa6sn\xe2\x88\x921sn. You can make as many steps as you want (possibly, zero). Your task is to find the lexicographically smallest string you can obtain after some number of steps. A string a is lexicographically smaller than a string b of the same length if and only if the following holds:   in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 1100
1864A "Increasing and Decreasing" "constructive algorithms,greedy,implementation,math" "You are given three integers x, y, and n.Your task is to construct an array a consisting of n integers which satisfies the following conditions:  a1=x, an=y;  a is strictly increasing (i.e. a1<a2<\xe2\x80\xa6<an);  if we denote bi=ai+1\xe2\x88\x92ai for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, then b is strictly decreasing (i.e. b1>b2>\xe2\x80\xa6>bn\xe2\x88\x921). If there is no such array a, print a single integer \xe2\x88\x921." 800
1863I "Redundant Routes" "constructive algorithms,dp,trees" "You are given a tree with n vertices labeled 1,2,\xe2\x80\xa6,n. The length of a simple path in the tree is the number of vertices in it.You are to select a set of simple paths of length at least 2 each, but you cannot simultaneously select two distinct paths contained one in another. Find the largest possible size of such a set.Formally, a set S of vertices is called a route if it contains at least two vertices and coincides with the set of vertices of a simple path in the tree. A collection of distinct routes is called a timetable. A route S in a timetable T is called redundant if there is a different route S\xe2\x80\xb2\xe2\x88\x88T such that S\xe2\x8a\x82S\xe2\x80\xb2. A timetable is called efficient if it contains no redundant routes. Find the largest possible number of routes in an efficient timetable." 3500
1863H "Goldberg Machine 3" dp,trees "There is a complete rooted binary tree, that is, a rooted tree in which each vertex has either 0 or 2 children. The root of the tree is vertex 1. A node without children is called a leaf. Each leaf has a hunger value, we denote the hunger value of leaf v by hv.Each inner vertex of the tree has a selector pointing to one of the children of the vertex.This tree accepts cookies. Before launching the process you can choose the initial state of each selector individually. The process is as follows:  Initially there are no cookies in vertices.  You insert cookies into the root one by one.  As long as the cookie is not in a leaf, it falls to the child defined by the selector in the current vertex. This selector then changes its state to the opposite one, i. e. it starts pointing to the other child of the vertex.  You stop inserting cookies when each leaf v has at least hv cookies in it. In this case, we say that the tree is filled up. You have q queries. Each query changes the value of hv for some leaf v. You need to print q+1 numbers, the i-th of them being the minimum number of cookies required to fill up the machine after (i\xe2\x88\x921) updates if you can pick any initial state for every selector. Since these numbers may be very large, print the answers modulo 998244353.Please note that you can choose the initial state of all selectors independently between queries. However, the queries themselves are not independent: when answering the i-th query, you should also consider the effect of queries 1,2,\xe2\x80\xa6,i\xe2\x88\x921." 3500
1863G Swaps combinatorics,dp,graphs,math "You are given an array of integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4n). You can perform the following operation several (possibly, zero) times:  pick an arbitrary i and perform swap(ai,aai). How many distinct arrays is it possible to attain? Output the answer modulo (109+7)." 2800
1863F "Divide, XOR, and Conquer" bitmasks,dp,math "You are given an array of n integers a1,a2,\xe2\x80\xa6,an.In one operation you split the array into two parts: a non-empty prefix and a non-empty suffix. The value of each part is the bitwise XOR of all elements in it. Next, discard the part with the smaller value. If both parts have equal values, you can choose which one to discard. Replace the array with the remaining part.The operations are being performed until the length of the array becomes 1. For each i (1\xe2\x89\xa4i\xe2\x89\xa4n), determine whether it is possible to achieve the state when only the i-th element (with respect to the original numbering) remains.Formally, you have two numbers l and r, initially l=1 and r=n. The current state of the array is [al,al+1,\xe2\x80\xa6,ar].As long as l<r, you apply the following operation:   Choose an arbitrary k from the set {l,l+1,\xe2\x80\xa6,r\xe2\x88\x921}. Denote x=al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ak and y=ak+1\xe2\x8a\x95ak+2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar, where \xe2\x8a\x95 denotes the bitwise XOR operation.  If x<y, set l=k+1.  If x>y, set r=k.  If x=y, either set l=k+1, or set r=k. For each i (1\xe2\x89\xa4i\xe2\x89\xa4n), determine whether it is possible to achieve l=r=i." 2600
1863E Speedrun "brute force,dfs and similar,dp,graphs,greedy,math,sortings,two pointers" "You are playing a video game. The game has n quests that need to be completed. However, the j-th quest can only be completed at the beginning of hour hj of a game day. The game day is k hours long. The hours of each game day are numbered 0,1,\xe2\x80\xa6,k\xe2\x88\x921. After the first day ends, a new one starts, and so on.Also, there are dependencies between the quests, that is, for some pairs (ai,bi) the bi-th quest can only be completed after the ai-th quest. It is guaranteed that there are no circular dependencies, as otherwise the game would be unbeatable and nobody would play it.You are skilled enough to complete any number of quests in a negligible amount of time (i. e. you can complete any number of quests at the beginning of the same hour, even if there are dependencies between them). You want to complete all quests as fast as possible. To do this, you can complete the quests in any valid order. The completion time is equal to the difference between the time of completing the last quest and the time of completing the first quest in this order.Find the least amount of time you need to complete the game." 2100
1863D "Two-Colored Dominoes" "constructive algorithms,greedy" "There is an n\xc3\x97m board divided into cells. There are also some dominoes on this board. Each domino covers two adjacent cells (that is, two cells that share a side), and no two dominoes overlap.Piet thinks that this board is too boring and it needs to be painted. He will paint the cells of the dominoes black and white. He calls the painting beautiful if all of the following conditions hold:  for each domino, one of its cells is painted white and the other is painted black;  for each row, the number of black cells in this row equals the number of white cells in this row;  for each column, the number of black cells in this column equals the number of white cells in this column. Note that the cells that are not covered by dominoes are not painted at all, they are counted as neither black nor white.Help Piet produce a beautiful painting or tell that it is impossible." 1400
1863C "MEX Repetition" implementation,math "You are given an array a1,a2,\xe2\x80\xa6,an of pairwise distinct integers from 0 to n. Consider the following operation:  consecutively for each i from 1 to n in this order, replace ai with MEX(a1,a2,\xe2\x80\xa6,an). Here MEX of a collection of integers c1,c2,\xe2\x80\xa6,cm is defined as the smallest non-negative integer x which does not occur in the collection c. For example, MEX(0,2,2,1,4)=3 and MEX(1,2)=0.Print the array after applying k such operations." 1100
1863B "Split Sort" greedy,math,sortings "You are given a permutation\xe2\x80\xa0 p1,p2,\xe2\x80\xa6,pn of integers 1 to n.You can change the current permutation by applying the following operation several (possibly, zero) times:  choose some x (2\xe2\x89\xa4x\xe2\x89\xa4n);  create a new permutation by:   first, writing down all elements of p that are less than x, without changing their order;  second, writing down all elements of p that are greater than or equal to x, without changing their order;   replace p with the newly created permutation. For example, if the permutation used to be [6,4,3,5,2,1] and you choose x=4, then you will first write down [3,2,1], then append this with [6,4,5]. So the initial permutation will be replaced by [3,2,1,6,4,5].Find the minimum number of operations you need to achieve pi=i for i=1,2,\xe2\x80\xa6,n. We can show that it is always possible to do so.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1100
1863A Channel greedy,implementation "Petya is an administrator of a channel in one of the messengers. A total of n people are subscribed to his channel, and Petya is not considered a subscriber.Petya has published a new post on the channel. At the moment of the publication, there were a subscribers online. We assume that every subscriber always reads all posts in the channel if they are online.After this, Petya starts monitoring the number of subscribers online. He consecutively receives q notifications of the form ""a subscriber went offline"" or ""a subscriber went online"". Petya does not know which exact subscriber goes online or offline. It is guaranteed that such a sequence of notifications could have indeed been received.Petya wonders if all of his subscribers have read the new post. Help him by determining one of the following:   it is impossible that all n subscribers have read the post;  it is possible that all n subscribers have read the post;  it is guaranteed that all n subscribers have read the post." 800
1862G "The Great Equalizer" "binary search,data structures,math,sortings" "Tema bought an old device with a small screen and a worn-out inscription ""The Great Equalizer"" on the side.The seller said that the device needs to be given an array a of integers as input, after which ""The Great Equalizer"" will work as follows:   Sort the current array in non-decreasing order and remove duplicate elements leaving only one occurrence of each element.  If the current length of the array is equal to 1, the device stops working and outputs the single number in the array \xe2\x80\x94 output value of the device.  Add an arithmetic progression {n, n\xe2\x88\x921, n\xe2\x88\x922, \xe2\x80\xa6, 1} to the current array, where n is the length of the current array. In other words, n\xe2\x88\x92i is added to the i-th element of the array, when indexed from zero.  Go to the first step. To test the operation of the device, Tema came up with a certain array of integers a, and then wanted to perform q operations on the array a of the following type:   Assign the value x (1\xe2\x89\xa4x\xe2\x89\xa4109) to the element ai (1\xe2\x89\xa4i\xe2\x89\xa4n).  Give the array a as input to the device and find out the result of the device\'s operation, while the array a remains unchanged during the operation of the device. Help Tema find out the output values of the device after each operation." 2000
1862F "Magic Will Save the World" "binary search,bitmasks,brute force,dp" "A portal of dark forces has opened at the border of worlds, and now the whole world is under a terrible threat. To close the portal and save the world, you need to defeat n monsters that emerge from the portal one after another.Only the sorceress Vika can handle this. She possesses two magical powers \xe2\x80\x94 water magic and fire magic. In one second, Vika can generate w units of water mana and f units of fire mana. She will need mana to cast spells. Initially Vika have 0 units of water mana and 0 units of fire mana.Each of the n monsters that emerge from the portal has its own strength, expressed as a positive integer. To defeat the i-th monster with strength si, Vika needs to cast a water spell or a fire spell of at least the same strength. In other words, Vika can spend at least si units of water mana on a water spell, or at least si units of fire mana on a fire spell.Vika can create and cast spells instantly. Vika can cast an unlimited number of spells every second as long she has enough mana for that.The sorceress wants to save the world as quickly as possible, so tell her how much time she will need." 1800
1862E "Kolya and Movie Theatre" "constructive algorithms,data structures,greedy" "Recently, Kolya found out that a new movie theatre is going to be opened in his city soon, which will show a new movie every day for n days. So, on the day with the number 1\xe2\x89\xa4i\xe2\x89\xa4n, the movie theatre will show the premiere of the i-th movie. Also, Kolya found out the schedule of the movies and assigned the entertainment value to each movie, denoted by ai.However, the longer Kolya stays without visiting a movie theatre, the larger the decrease in entertainment value of the next movie. That decrease is equivalent to d\xe2\x8b\x85cnt, where d is a predetermined value and cnt is the number of days since the last visit to the movie theatre. It is also known that Kolya managed to visit another movie theatre a day before the new one opened \xe2\x80\x94 the day with the number 0. So if we visit the movie theatre the first time on the day with the number i, then cnt \xe2\x80\x94 the number of days since the last visit to the movie theatre will be equal to i.For example, if d=2 and a=[3,2,5,4,6], then by visiting movies with indices 1 and 3, cnt value for the day 1 will be equal to 1\xe2\x88\x920=1 and cnt value for the day 3 will be 3\xe2\x88\x921=2, so the total entertainment value of the movies will be a1\xe2\x88\x92d\xe2\x8b\x851+a3\xe2\x88\x92d\xe2\x8b\x852=3\xe2\x88\x922\xe2\x8b\x851+5\xe2\x88\x922\xe2\x8b\x852=2.Unfortunately, Kolya only has time to visit at most m movies. Help him create a plan to visit the cinema in such a way that the total entertainment value of all the movies he visits is maximized." 1600
1862D "Ice Cream Balls" "binary search,combinatorics,constructive algorithms,math" "Tema decided to improve his ice cream making skills. He has already learned how to make ice cream in a cone using exactly two balls.Before his ice cream obsession, Tema was interested in mathematics. Therefore, he is curious about the minimum number of balls he needs to have in order to make exactly n different types of ice cream.There are plenty possible ice cream flavours: 1,2,3,\xe2\x80\xa6. Tema can make two-balls ice cream with any flavours (probably the same).Two ice creams are considered different if their sets of ball flavours are different. For example, {1,2}={2,1}, but {1,1}\xe2\x89\xa0{1,2}.For example, having the following ice cream balls: {1,1,2}, Tema can make only two types of ice cream: {1,1} and {1,2}.Note, that Tema do not need to make all the ice cream cones at the same time. This means that he making ice cream cones independently. Also in order to make a following cone {x,x} for some x, Tema needs at least 2 balls of type x.Help Tema answer this question. It can be shown that answer always exist." 1300
1862C "Flower City Fence" "binary search,data structures,implementation,sortings" "Anya lives in the Flower City. By order of the city mayor, she has to build a fence for herself.The fence consists of n planks, each with a height of ai meters. According to the order, the heights of the planks must not increase. In other words, it is true that ai\xe2\x89\xa5aj for all i<j.Anya became curious whether her fence is symmetrical with respect to the diagonal. In other words, will she get the same fence if she lays all the planks horizontally in the same order.For example, for n=5, a=[5,4,3,2,1], the fence is symmetrical. Because if all the planks are laid horizontally, the fence will be [5,4,3,2,1], as shown in the diagram.  On the left is the fence [5,4,3,2,1], on the right is the same fence laid horizontally But for n=3, a=[4,2,1], the fence is not symmetrical. Because if all the planks are laid horizontally, the fence will be [3,2,1,1], as shown in the diagram.  On the left is the fence [4,2,1], on the right is the same fence laid horizontally  Help Anya and determine whether her fence is symmetrical." 1100
1862B "Sequence Game" "constructive algorithms" "Tema and Vika are playing the following game.First, Vika comes up with a sequence of positive integers a of length m and writes it down on a piece of paper. Then she takes a new piece of paper and writes down the sequence b according to the following rule:   First, she writes down a1.  Then, she writes down only those ai (2\xe2\x89\xa4i\xe2\x89\xa4m) such that ai\xe2\x88\x921\xe2\x89\xa4ai. Let the length of this sequence be denoted as n. For example, from the sequence a=[4,3,2,6,3,3], Vika will obtain the sequence b=[4,6,3].She then gives the piece of paper with the sequence b to Tema. He, in turn, tries to guess the sequence a.Tema considers winning in such a game highly unlikely, but still wants to find at least one sequence a that could have been originally chosen by Vika. Help him and output any such sequence.Note that the length of the sequence you output should not exceed the input sequence length by more than two times." 800
1862A "Gift Carpet" dp,greedy,implementation,strings "Recently, Tema and Vika celebrated Family Day. Their friend Arina gave them a carpet, which can be represented as an n\xe2\x8b\x85m table of lowercase Latin letters.Vika hasn\'t seen the gift yet, but Tema knows what kind of carpets she likes. Vika will like the carpet if she can read her name on. She reads column by column from left to right and chooses one or zero letters from current column.Formally, the girl will like the carpet if it is possible to select four distinct columns in order from left to right such that the first column contains ""v"", the second one contains ""i"", the third one contains ""k"", and the fourth one contains ""a"".Help Tema understand in advance whether Vika will like Arina\'s gift." 800
1861F "Four Suits" "binary search,bitmasks,flows,greedy" "The game of Berland poker is played as follows. There are n+1 people: n players, numbered from 1 to n, and the dealer. The dealer has a deck which contains cards of four different suits (the number of cards of each suit is not necessarily the same); the number of cards in the deck is divisible by n. The dealer gives all cards to the players, so that every player receives the same number of cards, and the whole deck is used.After the cards are dealt, every player chooses one of four suits (independently) and discards all cards from their hand which do not belong to their chosen suit. The winner of the game is the player with the maximum number of cards left in their hand. The number of points the winner receives is x\xe2\x88\x92y, where x is the number of cards in the winner\'s hand, and y is the maximum number of cards among all other players; everyone else receives 0 points. Note that it means that if there are multiple players with the maximum number of cards, everyone receives 0 points.Since every player wants to maximize their odds to win, they will choose a suit with the maximum number of cards in their hand.Monocarp is the dealer. He has already given some cards to the players; the i-th player received ai,j cards of suit j. Note that the number of cards in players\' hands don\'t have to be the same at this moment. Monocarp has b1,b2,b3,b4 cards of suit 1,2,3,4 respectively left in his deck. He has to give them to the players so that, after all cards are dealt, every player has the same number of cards.For each player, calculate the maximum number of points they can receive among all ways to deal the remaining cards according to the rules of the game." 3200
1861E "Non-Intersecting Subpermutations" combinatorics,dp,implementation,math "You are given two integers n and k.For an array of length n, let\'s define its cost as the maximum number of contiguous subarrays of this array that can be chosen so that:   each element belongs to at most one subarray;  the length of each subarray is exactly k;  each subarray contains each integer from 1 to k exactly once. For example, if n=10, k=3 and the array is [1,2,1,3,2,3,2,3,1,3], its cost is 2 because, for example, we can choose the subarrays from the 2-nd element to the 4-th element and from the 7-th element to the 9-th element, and we can show that it\'s impossible to choose more than 2 subarrays.Calculate the sum of costs over all arrays of length n consisting of integers from 1 to k, and print it modulo 998244353." 2300
1861D "Sorting By Multiplication" dp,greedy "You are given an array a of length n, consisting of positive integers. You can perform the following operation on this array any number of times (possibly zero):   choose three integers l, r and x such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and multiply every ai such that l\xe2\x89\xa4i\xe2\x89\xa4r by x. Note that you can choose any integer as x, it doesn\'t have to be positive.You have to calculate the minimum number of operations to make the array a sorted in strictly ascending order (i.\xe2\x80\x89e. the condition a1<a2<\xe2\x8b\xaf<an must be satisfied)." 1800
1861C "Queries for the Array" "data structures,dfs and similar,implementation,strings,trees" "Monocarp had an array a consisting of integers. Initially, this array was empty.Monocarp performed three types of queries to this array:  choose an integer and append it to the end of the array. Each time Monocarp performed a query of this type, he wrote out a character +;  remove the last element from the array. Each time Monocarp performed a query of this type, he wrote out a character -. Monocarp never performed this query on an empty array;  check if the array is sorted in non-descending order, i.,e. a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4ak, where k is the number of elements in the array currently. Every array with less than 2 elements is considered sorted. If the array was sorted by the time Monocarp was performing that query, he wrote out a character 1. Otherwise, he wrote out a character 0. You are given a sequence s of q characters 0, 1, + and/or -. These are the characters that were written out by Monocarp, given in the exact order he wrote them out.You have to check if this sequence is consistent, i.\xe2\x80\x89e. it was possible for Monocarp to perform the queries so that the sequence of characters he wrote out is exactly s." 1600
1861B "Two Binary Strings" "constructive algorithms,dp,greedy" "You are given two strings a and b of equal length, consisting of only characters 0 and/or 1; both strings start with character 0 and end with character 1. You can perform the following operation any number of times (possibly zero):   choose one of the strings and two equal characters in it; then turn all characters between them into those characters. Formally, you choose one of these two strings (let the chosen string be s), then pick two integers l and r such that 1\xe2\x89\xa4l<r\xe2\x89\xa4|s| and sl=sr, then replace every character si such that l<i<r with sl.For example, if the chosen string is 010101, you can transform it into one of the following strings by applying one operation:  000101 if you choose l=1 and r=3;  000001 if you choose l=1 and r=5;  010001 if you choose l=3 and r=5;  010111 if you choose l=4 and r=6;  011111 if you choose l=2 and r=6;  011101 if you choose l=2 and r=4. You have to determine if it\'s possible to make the given strings equal by applying this operation any number of times." 1000
1861A "Prime Deletion" "constructive algorithms,math" "A prime number is a positive integer that has exactly two different positive divisors: 1 and the integer itself. For example, 2, 3, 13 and 101 are prime numbers; 1, 4, 6 and 42 are not.You are given a sequence of digits from 1 to 9, in which every digit from 1 to 9 appears exactly once.You are allowed to do the following operation several (maybe zero) times: choose any digit from the sequence and delete it. However, you cannot perform this operation if the sequence consists of only two digits.Your goal is to obtain a sequence which represents a prime number. Note that you cannot reorder the digits in the sequence.Print the resulting sequence, or report that it is impossible to perform the operations so that the resulting sequence is a prime number." 800
1860F "Evaluate RBS" "data structures,geometry,implementation,math,sortings" "You are given 2n tuples of values (a,b,c), where a and b are positive integers and c is a bracket \'(\' or \')\'. Exactly n tuples have c=\'(\' and the other n tuples have c= \')\'.You are asked to choose two positive values x and y (x>0 and y>0; not necessarily integers) and sort the tuples in the increasing value of a\xe2\x8b\x85x+b\xe2\x8b\x85y. If several tuples have the same value, you can place them in any order among themselves.Is it possible to choose such x and y that taking brackets c from the tuples in the resulting order produces a regular bracket sequence?A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence." 2900
1860E "Fast Travel Text Editor" "data structures,dfs and similar,graphs,shortest paths" "You are given a string s, consisting of lowercase Latin letters.There\'s a cursor, initially placed between two adjacent letters of the string. The cursor can\'t be placed before the first or after the last letter.In one move, you can perform one of three actions:   move a cursor one position to the left (if that doesn\'t place it before the first letter);  move a cursor one position to the right (if that doesn\'t place it after the last letter);  let x be the letter immediately to the left of the cursor, and y be the letter immediately to the right of the cursor. Choose any pair of adjacent letters in the string such that the left of them is x and the right of them is y, and move the cursor to the position between these two letters. You are asked m queries. In each query, you are given two integers f and t, which correspond to two valid positions of the cursor in the string. In response to the query, you have to calculate the minimum number of operations required to move the cursor from position f to position t." 2400
1860D "Balanced String" dp "You are given a binary string s (a binary string is a string consisting of characters 0 and/or 1).Let\'s call a binary string balanced if the number of subsequences 01 (the number of indices i and j such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, si=0 and sj=1) equals to the number of subsequences 10 (the number of indices k and l such that 1\xe2\x89\xa4k<l\xe2\x89\xa4n, sk=1 and sl=0) in it.For example, the string 1000110 is balanced, because both the number of subsequences 01 and the number of subsequences 10 are equal to 6. On the other hand, 11010 is not balanced, because the number of subsequences 01 is 1, but the number of subsequences 10 is 5. You can perform the following operation any number of times: choose two characters in s and swap them. Your task is to calculate the minimum number of operations to make the string s balanced." 2200
1860C "Game on Permutation" "data structures,dp,games,greedy" "Alice and Bob are playing a game. They have a permutation p of size n (a permutation of size n is an array of size n where each element from 1 to n occurs exactly once). They also have a chip, which can be placed on any element of the permutation.Alice and Bob make alternating moves: Alice makes the first move, then Bob makes the second move, then Alice makes the third move, and so on. During the first move, Alice chooses any element of the permutation and places the chip on that element. During each of the next moves, the current player has to move the chip to any element that is simultaneously to the left and strictly less than the current element (i.\xe2\x80\x89e. if the chip is on the i-th element, it can be moved to the j-th element if j<i and pj<pi). If a player cannot make a move (it is impossible to move the chip according to the rules of the game), that player wins the game.Let\'s say that the i-th element of the permutation is lucky if the following condition holds:  if Alice places the chip on the i-th element during her first move, she can win the game no matter how Bob plays (i.\xe2\x80\x89e. she has a winning strategy). You have to calculate the number of lucky elements in the permutation." 1400
1860B "Fancy Coins" "binary search,brute force,greedy,math" "Monocarp is going to make a purchase with cost of exactly m burles.He has two types of coins, in the following quantities:   coins worth 1 burle: a1 regular coins and infinitely many fancy coins;  coins worth k burles: ak regular coins and infinitely many fancy coins. Monocarp wants to make his purchase in such a way that there\'s no change \xe2\x80\x94 the total worth of provided coins is exactly m. He can use both regular and fancy coins. However, he wants to spend as little fancy coins as possible.What\'s the smallest total number of fancy coins he can use to make a purchase?" 1200
1860A "Not a Substring" "constructive algorithms,strings" "A bracket sequence is a string consisting of characters \'(\' and/or \')\'. A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \'1\' and \'+\' between the original characters of the sequence. For example:  bracket sequences ""()()"" and ""(())"" are regular (they can be transformed into ""(1)+(1)"" and ""((1+1)+1)"", respectively);  bracket sequences "")("", ""("" and "")"" are not regular. You are given a bracket sequence s; let\'s define its length as n. Your task is to find a regular bracket sequence t of length 2n such that s does not occur in t as a contiguous substring, or report that there is no such sequence." 900
1859F "Teleportation in Byteland" "data structures,dfs and similar,divide and conquer,graphs,shortest paths,trees" "There are n cities in Byteland, some of which are connected by roads, which can be traversed in any direction. The i-th road has its own hardness parameter wi. Time spent on traversing a road with its hardness equal to wi is \xe2\x8c\x88wic\xe2\x8c\x89, where c is the current driving skill.The travel network of Byteland is a tree. In other words, between any pair of cities, there is exactly one path that passes through each city at most once.In some cities you can visit driving courses. A single course takes T time to complete, and after completing the course the driver\'s skill c is increased by 2 times. Notice that the time T required to complete a course is the same in all cities, and courses can be completed in the same city more than once.You need to answer the q queries: what is the minimum time it takes to get from the city a to city b if you start the travelling with driving skill c=1?" 3200
1859E "Maximum Monogonosity" "brute force,dp,math" "You are given an array a of length n and an array b of length n. The cost of a segment [l,r], 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, is defined as |bl\xe2\x88\x92ar|+|br\xe2\x88\x92al|.Recall that two segments [l1,r1], 1\xe2\x89\xa4l1\xe2\x89\xa4r1\xe2\x89\xa4n, and [l2,r2], 1\xe2\x89\xa4l2\xe2\x89\xa4r2\xe2\x89\xa4n, are non-intersecting if one of the following conditions is satisfied: r1<l2 or r2<l1.The length of a segment [l,r], 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, is defined as r\xe2\x88\x92l+1.Find the maximum possible sum of costs of non-intersecting segments [lj,rj], 1\xe2\x89\xa4lj\xe2\x89\xa4rj\xe2\x89\xa4n, whose total length is equal to k." 2500
1859D "Andrey and Escape from Capygrad" "binary search,data structures,dp,dsu,greedy,sortings" "An incident occurred in Capygrad, the capital of Tyagoland, where all the capybaras in the city went crazy and started throwing mandarins. Andrey was forced to escape from the city as far as possible, using portals.Tyagoland is represented by a number line, and the city of Capygrad is located at point 0. There are n portals all over Tyagoland, each of which is characterised by four integers li, ri, ai and bi (1\xe2\x89\xa4li\xe2\x89\xa4ai\xe2\x89\xa4bi\xe2\x89\xa4ri\xe2\x89\xa4109). Note that the segment [ai,bi] is contained in the segment [li,ri].If Andrey is on the segment [li,ri], then the portal can teleport him to any point on the segment [ai,bi]. Andrey has a pass that allows him to use the portals an unlimited number of times.Andrey thinks that the point x is on the segment [l,r] if the inequality l\xe2\x89\xa4x\xe2\x89\xa4r is satisfied.Andrey has q options for where to start his escape, each option is characterized by a single integer xi \xe2\x80\x94 the starting position of the escape. He wants to escape from Capygrad as far as possible (to the point with the maximum possible coordinate). Help Andrey determine how far he could escape from Capygrad, starting at each of the q positions." 1800
1859C "Another Permutation Problem" "brute force,dp,greedy,math" "Andrey is just starting to come up with problems, and it\'s difficult for him. That\'s why he came up with a strange problem about permutations\xe2\x80\xa0 and asks you to solve it. Can you do it?Let\'s call the cost of a permutation p of length n the value of the expression: (\xe2\x88\x91ni=1pi\xe2\x8b\x85i)\xe2\x88\x92(maxnj=1pj\xe2\x8b\x85j). Find the maximum cost among all permutations of length n.\xe2\x80\xa0A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1200
1859B "Olya and Game with Arrays" "constructive algorithms,greedy,math,sortings" "Artem suggested a game to the girl Olya. There is a list of n arrays, where the i-th array contains mi\xe2\x89\xa52 positive integers ai,1,ai,2,\xe2\x80\xa6,ai,mi.Olya can move at most one (possibly 0) integer from each array to another array. Note that integers can be moved from one array only once, but integers can be added to one array multiple times, and all the movements are done at the same time.The beauty of the list of arrays is defined as the sum \xe2\x88\x91ni=1minmij=1ai,j. In other words, for each array, we find the minimum value in it and then sum up these values.The goal of the game is to maximize the beauty of the list of arrays. Help Olya win this challenging game!" 1000
1859A "United We Stand" "constructive algorithms,math,number theory" "Given an array a of length n, containing integers. And there are two initially empty arrays b and c. You need to add each element of array a to exactly one of the arrays b or c, in order to satisfy the following conditions:  Both arrays b and c are non-empty. More formally, let lb be the length of array b, and lc be the length of array c. Then lb,lc\xe2\x89\xa51.  For any two indices i and j (1\xe2\x89\xa4i\xe2\x89\xa4lb,1\xe2\x89\xa4j\xe2\x89\xa4lc), cj is not a divisor of bi. Output the arrays b and c that can be obtained, or output \xe2\x88\x921 if they do not exist." 800
1858E2 "Rollbacks (Hard Version)" "data structures,interactive,trees" "This is a hard version of this problem. The only difference between the versions is that you have to solve the hard version in online mode. You can make hacks only if both versions of the problem are solved.You have an array a, which is initially empty. You need to process queries of the following types:  + x \xe2\x80\x94 add the integer x to the end of the array a.  - k \xe2\x80\x94 remove the last k numbers from the array a.  ! \xe2\x80\x94 roll back the last active change (i.e., make the array a the way it was before the change). In this problem, only queries of the first two types (+ and -) are considered as changes.  ? \xe2\x80\x94 find the number of distinct numbers in the array a." 2600
1858E1 "Rollbacks (Easy Version)" "brute force,data structures,dfs and similar,trees" "This is an easy version of this problem. The only difference between the versions is that you have to solve the hard version in online mode. You can make hacks only if both versions of the problem are solved.You have an array a, which is initially empty. You need to process queries of the following types:  + x \xe2\x80\x94 add the integer x to the end of the array a.  - k \xe2\x80\x94 remove the last k numbers from the array a.  ! \xe2\x80\x94 roll back the last active change (i.e., make the array a the way it was before the change). In this problem, only queries of the first two types (+ and -) are considered as changes.  ? \xe2\x80\x94 find the number of distinct numbers in the array a." 2500
1858D "Trees and Segments" "brute force,data structures,dp,greedy,two pointers" "The teachers of the Summer Informatics School decided to plant n trees in a row, and it was decided to plant only oaks and firs. To do this, they made a plan, which can be represented as a binary string s of length n. If si=0, then the i-th tree in the row should be an oak, and if si=1, then the i-th tree in the row should be a fir.The day of tree planting is tomorrow, and the day after tomorrow an inspector will come to the School. The inspector loves nature very much, and he will evaluate the beauty of the row as follows:  First, he will calculate l0 as the maximum number of consecutive oaks in the row (the maximum substring consisting of zeros in the plan s). If there are no oaks in the row, then l0=0.  Then, he will calculate l1 as the maximum number of consecutive firs in the row (the maximum substring consisting of ones in the plan s). If there are no firs in the row, then l1=0.  Finally, he will calculate the beauty of the row as a\xe2\x8b\x85l0+l1 for some a \xe2\x80\x94 the inspector\'s favourite number. The teachers know the value of the parameter a, but for security reasons they cannot tell it to you. They only told you that a is an integer from 1 to n.Since the trees have not yet been planted, the teachers decided to change the type of no more than k trees to the opposite (i.e., change si from 0 to 1 or from 1 to 0 in the plan) in order to maximize the beauty of the row of trees according to the inspector.For each integer j from 1 to n answer the following question independently:   What is the maximum beauty of the row of trees that the teachers can achieve by changing the type of no more than k trees if the inspector\'s favourite number a is equal to j?" 2200
1858C "Yet Another Permutation Problem" "constructive algorithms,greedy,math,number theory" "Alex got a new game called ""GCD permutations"" as a birthday present. Each round of this game proceeds as follows:  First, Alex chooses a permutation\xe2\x80\xa0 a1,a2,\xe2\x80\xa6,an of integers from 1 to n.  Then, for each i from 1 to n, an integer di=gcd(ai,a(imodn)+1) is calculated.  The score of the round is the number of distinct numbers among d1,d2,\xe2\x80\xa6,dn. Alex has already played several rounds so he decided to find a permutation a1,a2,\xe2\x80\xa6,an such that its score is as large as possible.Recall that gcd(x,y) denotes the greatest common divisor (GCD) of numbers x and y, and xmody denotes the remainder of dividing x by y.\xe2\x80\xa0A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1000
1858B "The Walkway" "brute force,dp,greedy,math,number theory" "There are n benches near the Main Walkway in Summer Infomatics School. These benches are numbered by integers from 1 to n in order they follow. Also there are m cookie sellers near the Walkway. The i-th (1\xe2\x89\xa4i\xe2\x89\xa4m) cookie sellers is located near the si-th bench.Petya is standing in the beginning of the Walkway. He will pass near all benches starting from the 1-st bench and ending with the n-th bench. Petya passes the distance between two consecutive benches in 1 minute. He has a knapsack with an infinite amount of cookies. Petya is going to eat cookies from his knapsack and buy them from cookie sellers during the walk.Petya eats cookies only near the benches according to the following rule: he will eat the cookie near the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) bench if and only if at least one of the following conditions holds:  There is a cookie seller near the i-th bench. Then Petya will buy a cookie from cookie seller and eat it immediately.  Petya has not yet eaten a cookie. Then Petya will take a cookie from his knapsack and eat it immediately.  At least d minutes passed since Petya ate the previous cookie. In other words, Petya has not eaten a cookie near the benches i\xe2\x88\x921,i\xe2\x88\x922,\xe2\x80\xa6,max(i\xe2\x88\x92d+1,1). Then Petya will take a cookie from his knapsack and eat it immediately. You may assume that Petya eats cookies instantly. Petya will not eat two or more cookies near the same bench.You want to minimize the number of cookies Petya will eat during his walk. In order to do this, you will ask the administration of the Summer Informatics School to remove exactly one cookie seller from the Walkway before Petya starts his walk.Please determine the minimum possible number of cookies Petya can eat after removing exactly one cookie seller. Also determine the number of cookie sellers, such that if you remove one of them, Petya will eat the minimum possible number of cookies." 1500
1858A Buttons games,greedy,math "Anna and Katie ended up in a secret laboratory.There are a+b+c buttons in the laboratory. It turned out that a buttons can only be pressed by Anna, b buttons can only be pressed by Katie, and c buttons can be pressed by either of them. Anna and Katie decided to play a game, taking turns pressing these buttons. Anna makes the first turn. Each button can be pressed at most once, so at some point, one of the girls will not be able to make her turn.The girl who cannot press a button loses. Determine who will win if both girls play optimally." 800
1857G "Counting Graphs" "combinatorics,divide and conquer,dsu,graphs,greedy,sortings,trees" "Given a tree consisting of n vertices. A tree is a connected undirected graph without cycles. Each edge of the tree has its weight, wi.Your task is to count the number of different graphs that satisfy all four conditions:  The graph does not have self-loops and multiple edges.  The weights on the edges of the graph are integers and do not exceed S.  The graph has exactly one minimum spanning tree.  The minimum spanning tree of the graph is the given tree. Two graphs are considered different if their sets of edges are different, taking into account the weights of the edges.The answer can be large, output it modulo 998244353." 2000
1857F "Sum and Product" "binary search,data structures,math" "You have an array a of length n.Your task is to answer q queries: given x,y, find the number of pairs i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) that both ai+aj=x and ai\xe2\x8b\x85aj=y.That is, for the array [1,3,2] and asking for x=3,y=2 the answer is 1:   i=1 and j=2 fail because 1+3=4 and not 3, also 1\xe2\x8b\x853=3 and not 2;  i=1 and j=3 satisfies both conditions;  i=2 and j=3 fail because 3+2=5 and not 3, also 3\xe2\x8b\x852=6 and not 2;" 1600
1857E "Power of Points" math,sortings "You are given n points with integer coordinates x1,\xe2\x80\xa6xn, which lie on a number line.For some integer s, we construct segments [s,x1], [s,x2], \xe2\x80\xa6, [s,xn]. Note that if xi<s, then the segment will look like [xi,s]. The segment [a,b] covers all integer points a,a+1,a+2,\xe2\x80\xa6,b.We define the power of a point p as the number of segments that intersect the point with coordinate p, denoted as fp.Your task is to compute 109\xe2\x88\x91p=1fp for each s\xe2\x88\x88{x1,\xe2\x80\xa6,xn}, i.e., the sum of fp for all integer points from 1 to 109.For example, if the initial coordinates are [1,2,5,7,1] and we choose s=5, then the segments will be: [1,5],[2,5],[5,5],[5,7],[1,5]. And the powers of the points will be: f1=2,f2=3,f3=3,f4=3,f5=5,f6=1,f7=1,f8=0,\xe2\x80\xa6,f109=0. Their sum is 2+3+3+3+5+1+1=18." 1500
1857D "Strong Vertices" math,sortings,trees "Given two arrays a and b, both of length n. Elements of both arrays indexed from 1 to n. You are constructing a directed graph, where edge from u to v (u\xe2\x89\xa0v) exists if au\xe2\x88\x92av\xe2\x89\xa5bu\xe2\x88\x92bv.A vertex V is called strong if there exists a path from V to all other vertices.A path in a directed graph is a chain of several vertices, connected by edges, such that moving from the vertex u, along the directions of the edges, the vertex v can be reached.Your task is to find all strong vertices.For example, if a=[3,1,2,4] and b=[4,3,2,1], the graph will look like this:   The graph has only one strong vertex with number 4" 1300
1857C "Assembly via Minimums" greedy,sortings "Sasha has an array a of n integers. He got bored and for all i, j (i<j), he wrote down the minimum value of ai and aj. He obtained a new array b of size n\xe2\x8b\x85(n\xe2\x88\x921)2.For example, if a= [2,3,5,1], he would write [min(2,3),min(2,5),min(2,1),min(3,5),min(3,1),min(5,1)] = [2,2,1,3,1,1].Then, he randomly shuffled all the elements of the array b.Unfortunately, he forgot the array a, and your task is to restore any possible array a from which the array b could have been obtained.The elements of array a should be in the range [\xe2\x88\x92109,109]." 1200
1857B "Maximum Rounding" greedy,implementation,math "Given a natural number x. You can perform the following operation:   choose a positive integer k and round x to the k-th digit Note that the positions are numbered from right to left, starting from zero. If the number has k digits, it is considered that the digit at the k-th position is equal to 0.The rounding is done as follows:   if the digit at the (k\xe2\x88\x921)-th position is greater than or equal to 5, then the digit at the k-th position is increased by 1, otherwise the digit at the k-th position remains unchanged (mathematical rounding is used).  if before the operations the digit at the k-th position was 9, and it should be increased by 1, then we search for the least position k\xe2\x80\xb2 (k\xe2\x80\xb2>k), where the digit at the k\xe2\x80\xb2-th position is less than 9 and add 1 to the digit at the k\xe2\x80\xb2-th position. Then we assign k=k\xe2\x80\xb2.  after that, all digits which positions are less than k are replaced with zeros.Your task is to make x as large as possible, if you can perform the operation as many times as you want.For example, if x is equal to 3451, then if you choose consecutively:   k=1, then after the operation x will become 3450  k=2, then after the operation x will become 3500  k=3, then after the operation x will become 4000  k=4, then after the operation x will become 0  To maximize the answer, you need to choose k=2 first, and then k=3, then the number will become 4000." 1100
1857A "Array Coloring" greedy,math "You are given an array consisting of n integers. Your task is to determine whether it is possible to color all its elements in two colors in such a way that the sums of the elements of both colors have the same parity and each color has at least one element colored.For example, if the array is [1,2,4,3,2,3,5,4], we can color it as follows: [1,2,4,3,2,3,5,4], where the sum of the blue elements is 6 and the sum of the red elements is 18." 800
1856E2 "PermuTree (hard version)" "bitmasks,dfs and similar,dp,fft,greedy,implementation,math,trees" "This is the hard version of the problem. The differences between the two versions are the constraint on n and the time limit. You can make hacks only if both versions of the problem are solved.You are given a tree with n vertices rooted at vertex 1.For some permutation\xe2\x80\xa0 a of length n, let f(a) be the number of pairs of vertices (u,v) such that au<alca(u,v)<av. Here, lca(u,v) denotes the lowest common ancestor of vertices u and v.Find the maximum possible value of f(a) over all permutations a of length n.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2700
1856E1 "PermuTree (easy version)" "dfs and similar,dp,trees" "This is the easy version of the problem. The differences between the two versions are the constraint on n and the time limit. You can make hacks only if both versions of the problem are solved.You are given a tree with n vertices rooted at vertex 1.For some permutation\xe2\x80\xa0 a of length n, let f(a) be the number of pairs of vertices (u,v) such that au<alca(u,v)<av. Here, lca(u,v) denotes the lowest common ancestor of vertices u and v.Find the maximum possible value of f(a) over all permutations a of length n.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1800
1856D "More Wrong" "divide and conquer,interactive" "This is an interactive problem.The jury has hidden a permutation\xe2\x80\xa0 p of length n.In one query, you can pick two integers l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) by paying (r\xe2\x88\x92l)2 coins. In return, you will be given the number of inversions\xe2\x80\xa1 in the subarray [pl,pl+1,\xe2\x80\xa6pr].Find the index of the maximum element in p by spending at most 5\xe2\x8b\x85n2 coins.Note: the grader is not adaptive: the permutation is fixed before any queries are made.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).\xe2\x80\xa1 The number of inversions in an array is the number of pairs of indices (i,j) such that i<j and ai>aj. For example, the array [10,2,6,3] contains 4 inversions. The inversions are (1,2),(1,3),(1,4), and (3,4)." 2100
1856C "To Become Max" "binary search,brute force,data structures,dp" "You are given an array of integers a of length n.In one operation you:   Choose an index i such that 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 and ai\xe2\x89\xa4ai+1.  Increase ai by 1. Find the maximum possible value of max(a1,a2,\xe2\x80\xa6an) that you can get after performing this operation at most k times." 1600
1856B "Good Arrays" implementation,math "You are given an array of positive integers a of length n.Let\'s call an array of positive integers b of length n good if:   ai\xe2\x89\xa0bi for all i from 1 to n,  a1+a2+\xe2\x80\xa6+an=b1+b2+\xe2\x80\xa6+bn. Does a good array exist?" 900
1856A "Tales of a Sort" implementation "Alphen has an array of positive integers a of length n.Alphen can perform the following operation:   For all i from 1 to n, replace ai with max(0,ai\xe2\x88\x921). Alphen will perform the above operation until a is sorted, that is a satisfies a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an. How many operations will Alphen perform? Under the constraints of the problem, it can be proven that Alphen will perform a finite number of operations." 800
1855B "Longest Divisors Interval" "brute force,combinatorics,greedy,math,number theory" "Given a positive integer n, find the maximum size of an interval [l,r] of positive integers such that, for every i in the interval (i.e., l\xe2\x89\xa4i\xe2\x89\xa4r), n is a multiple of i.Given two integers l\xe2\x89\xa4r, the size of the interval [l,r] is r\xe2\x88\x92l+1 (i.e., it coincides with the number of integers belonging to the interval)." 900
1855A "Dalton the Teacher" greedy,math "Dalton is the teacher of a class with n students, numbered from 1 to n. The classroom contains n chairs, also numbered from 1 to n. Initially student i is seated on chair pi. It is guaranteed that p1,p2,\xe2\x80\xa6,pn is a permutation of length n.A student is happy if his/her number is different from the number of his/her chair. In order to make all of his students happy, Dalton can repeatedly perform the following operation: choose two distinct students and swap their chairs. What is the minimum number of moves required to make all the students happy? One can show that, under the constraints of this problem, it is possible to make all the students happy with a finite number of moves.A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800
1854F "Mark and Spaceship" "brute force,dp" "Mark loves to move fast. So he made a spaceship that works in 4-dimensional space. He wants to use the spaceship to complete missions as fast as possible. In each mission, the spaceship starts at (0,0,0,0) and needs to end up at (a,b,c,d). To do this, he instructs the spaceship\'s computer to execute a series of moves, where each move is a unit step in one of the eight cardinal directions: (\xc2\xb11,0,0,0), (0,\xc2\xb11,0,0), (0,0,\xc2\xb11,0), (0,0,0,\xc2\xb11).Unfortunately, he also moved fast when building the spaceship, so there is a bug in the spaceship\'s code. The first move will be executed once, the second move will be executed twice, the third move will be executed thrice, and so on. In general, the i-th move will be executed i times.For any four integers a,b,c,d, let f(a,b,c,d) be the minimum number of moves of a mission that ends up at (a,b,c,d). Compute the sum of f(a,b,c,d) over all points (with integer coordinates) such that \xe2\x88\x92A\xe2\x89\xa4a\xe2\x89\xa4A, \xe2\x88\x92B\xe2\x89\xa4b\xe2\x89\xa4B, \xe2\x88\x92C\xe2\x89\xa4c\xe2\x89\xa4C, \xe2\x88\x92D\xe2\x89\xa4d\xe2\x89\xa4D." 3500
1854E "Game Bundles" "brute force,constructive algorithms,dp,greedy,math" "Rishi is developing games in the 2D metaverse and wants to offer game bundles to his customers. Each game has an associated enjoyment value. A game bundle consists of a subset of games whose total enjoyment value adds up to 60.Your task is to choose k games, where 1\xe2\x89\xa4k\xe2\x89\xa460, along with their respective enjoyment values a1,a2,\xe2\x80\xa6,ak, in such a way that exactly m distinct game bundles can be formed." 3000
1854D "Michael and Hotel" "binary search,interactive,trees" "Michael and Brian are stuck in a hotel with n rooms, numbered from 1 to n, and need to find each other. But this hotel\'s doors are all locked and the only way of getting around is by using the teleporters in each room. Room i has a teleporter that will take you to room ai (it might be that ai=i). But they don\'t know the values of a1,a2,\xe2\x80\xa6,an.Instead, they can call up the front desk to ask queries. In one query, they give a room u, a positive integer k, and a set of rooms S. The hotel concierge answers whether a person starting in room u, and using the teleporters k times, ends up in a room in S.Brian is in room 1. Michael wants to know the set A of rooms so that if he starts in one of those rooms they can use the teleporters to meet up. He can ask at most 2000 queries.The values a1,a2,\xe2\x80\xa6,an are fixed before the start of the interaction and do not depend on your queries. In other words, the interactor is not adaptive." 3000
1854C "Expected Destruction" combinatorics,dp,math,probabilities "You have a set S of n distinct integers between 1 and m.Each second you do the following steps:   Pick an element x in S uniformly at random.  Remove x from S.  If x+1\xe2\x89\xa4m and x+1 is not in S, add x+1 to S. What is the expected number of seconds until S is empty?Output the answer modulo 1000000007.Formally, let P=1000000007. It can be shown that the answer can be expressed as an irreducible fraction ab, where a and b are integers and b\xe2\x89\xa20(modP). Output the integer equal to a\xe2\x8b\x85b\xe2\x88\x921modP. In other words, output an integer z such that 0\xe2\x89\xa4z<P and z\xe2\x8b\x85b\xe2\x89\xa1a(modP)." 2500
1854B "Earn or Unlock" "bitmasks,brute force,dp" "Andrea is playing the game Tanto Cuore.  He has a deck of n cards with values a1,\xe2\x80\xa6,an from top to bottom. Each card can be either locked or unlocked. Initially, only the topmost card is unlocked. The game proceeds in turns. In each turn, Andrea chooses an unlocked card in the deck \xe2\x80\x94 the value written on the card is v \xe2\x80\x94 and performs exactly one of the following two operations:   Unlock the first v locked cards in the deck from the top. If there are less than v locked cards in the deck, then unlock all the locked cards.  Earn v victory points.  In both cases, after performing the operation, he removes the card from the deck.The game ends when all the cards remaining in the deck are locked, or there are no more cards in the deck.What is the maximum number of victory points Andrea can earn?" 2200
1854A2 "Dual (Hard Version)" "constructive algorithms,math" "Popskyy & tiasu - Dual\xe2\xa0\x80The only difference between the two versions of this problem is the constraint on the maximum number of operations. You can make hacks only if all versions of the problem are solved.You are given an array a1,a2,\xe2\x80\xa6,an of integers (positive, negative or 0). You can perform multiple operations on the array (possibly 0 operations).In one operation, you choose i,j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, they can be equal) and set ai:=ai+aj (i.e., add aj to ai).Make the array non-decreasing (i.e., ai\xe2\x89\xa4ai+1 for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) in at most 31 operations. You do not need to minimize the number of operations." 1900
1854A1 "Dual (Easy Version)" "constructive algorithms,math" "Popskyy & tiasu - Dual\xe2\xa0\x80The only difference between the two versions of this problem is the constraint on the maximum number of operations. You can make hacks only if all versions of the problem are solved.You are given an array a1,a2,\xe2\x80\xa6,an of integers (positive, negative or 0). You can perform multiple operations on the array (possibly 0 operations).In one operation, you choose i,j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, they can be equal) and set ai:=ai+aj (i.e., add aj to ai).Make the array non-decreasing (i.e., ai\xe2\x89\xa4ai+1 for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) in at most 50 operations. You do not need to minimize the number of operations." 1400
1853B Fibonaccharsis "binary search,brute force,math" "Ntarsis has received two integers n and k for his birthday. He wonders how many fibonacci-like sequences of length k can be formed with n as the k-th element of the sequence. A sequence of non-decreasing non-negative integers is considered fibonacci-like if fi=fi\xe2\x88\x921+fi\xe2\x88\x922 for all i>2, where fi denotes the i-th element in the sequence. Note that f1 and f2 can be arbitrary.For example, sequences such as [4,5,9,14] and [0,1,1] are considered fibonacci-like sequences, while [0,0,0,1,1], [1,2,1,3], and [\xe2\x88\x921,\xe2\x88\x921,\xe2\x88\x922] are not: the first two do not always satisfy fi=fi\xe2\x88\x921+fi\xe2\x88\x922, the latter does not satisfy that the elements are non-negative.Impress Ntarsis by helping him with this task." 1200
1853A Desorting "brute force,greedy,math" "Call an array a of length n sorted if a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an\xe2\x88\x921\xe2\x89\xa4an.Ntarsis has an array a of length n. He is allowed to perform one type of operation on it (zero or more times):   Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).  Add 1 to a1,a2,\xe2\x80\xa6,ai.  Subtract 1 from ai+1,ai+2,\xe2\x80\xa6,an. The values of a can be negative after an operation.Determine the minimum operations needed to make a not sorted." 800
1852F "Panda Meetups" "data structures,dp,flows" "The red pandas are in town to meet their relatives, the blue pandas! The town is modeled by a number line.The pandas have already planned their meetup, but the schedule keeps changing. You are given q updates of the form x t c.  If c<0, it means |c| more red pandas enter the number line at position x and time t. Then, each unit of time, they can each independently move one unit in either direction across the number line, or not move at all.  If c>0, it means that c more blue pandas check position x for red pandas at time t. If a blue panda does not meet a red panda at that specific location and time, they dejectedly leave the number line right away. If there is a red panda at a position at the same time a blue panda checks it, they form a friendship and leave the number line. Each red panda can form a friendship with at most one blue panda and vice versa. The updates will be given in order of non-decreasing x values. After each update, please print the maximum number of friendships if the red pandas move in an optimal order based on all the updates given in the input above (and including) this update. The order in which a red panda moves can change between updates." 3500
1852E Rivalries "constructive algorithms,data structures,greedy" "Ntarsis has an array a of length n.The power of a subarray al\xe2\x80\xa6ar (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) is defined as:   The largest value x such that al\xe2\x80\xa6ar contains x and neither a1\xe2\x80\xa6al\xe2\x88\x921 nor ar+1\xe2\x80\xa6an contains x.  If no such x exists, the power is 0. Call an array b a rival to a if the following holds:   The length of both a and b are equal to some n.  Over all l,r where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, the power of al\xe2\x80\xa6ar equals the power of bl\xe2\x80\xa6br.  The elements of b are positive. Ntarsis wants you to find a rival b to a such that the sum of bi over 1\xe2\x89\xa4i\xe2\x89\xa4n is maximized. Help him with this task!" 3400
1852D "Miriany and Matchstick" "constructive algorithms,dp,greedy" "Miriany\'s matchstick is a 2\xc3\x97n grid that needs to be filled with characters A or B. He has already filled in the first row of the grid and would like you to fill in the second row. You must do so in a way such that the number of adjacent pairs of cells with different characters\xe2\x80\xa0 is equal to k. If it is impossible, report so.\xe2\x80\xa0 An adjacent pair of cells with different characters is a pair of cells (r1,c1) and (r2,c2) (1\xe2\x89\xa4r1,r2\xe2\x89\xa42, 1\xe2\x89\xa4c1,c2\xe2\x89\xa4n) such that |r1\xe2\x88\x92r2|+|c1\xe2\x88\x92c2|=1 and the characters in (r1,c1) and (r2,c2) are different." 2800
1852C "Ina of the Mountain" "data structures,dp,greedy,math" "To prepare her ""Takodachi"" dumbo octopuses for world domination, Ninomae Ina\'nis, a.k.a. Ina of the Mountain, orders Hoshimachi Suisei to throw boulders at them. Ina asks you, Kiryu Coco, to help choose where the boulders are thrown.There are n octopuses on a single-file trail on Ina\'s mountain, numbered 1,2,\xe2\x80\xa6,n. The i-th octopus has a certain initial health value ai, where 1\xe2\x89\xa4ai\xe2\x89\xa4k.Each boulder crushes consecutive octopuses with indexes l,l+1,\xe2\x80\xa6,r, where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. You can choose the numbers l and r arbitrarily for each boulder.For each boulder, the health value of each octopus the boulder crushes is reduced by 1. However, as octopuses are immortal, once they reach a health value of 0, they will immediately regenerate to a health value of k. Given the octopuses\' initial health values, find the minimum number of boulders that need to be thrown to make the health of all octopuses equal to k." 2400
1852B "Imbalanced Arrays" "constructive algorithms,graphs,greedy,math,sortings,two pointers" "Ntarsis has come up with an array a of n non-negative integers.Call an array b of n integers imbalanced if it satisfies the following:   \xe2\x88\x92n\xe2\x89\xa4bi\xe2\x89\xa4n, bi\xe2\x89\xa00,  there are no two indices (i,j) (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that bi+bj=0,  for each 1\xe2\x89\xa4i\xe2\x89\xa4n, there are exactly ai indices j (1\xe2\x89\xa4j\xe2\x89\xa4n) such that bi+bj>0, where i and j are not necessarily distinct. Given the array a, Ntarsis wants you to construct some imbalanced array. Help him solve this task, or determine it is impossible." 1800
1852A "Ntarsis\' Set" "binary search,math,number theory" "Ntarsis has been given a set S, initially containing integers 1,2,3,\xe2\x80\xa6,101000 in sorted order. Every day, he will remove the a1-th, a2-th, \xe2\x80\xa6, an-th smallest numbers in S simultaneously.What is the smallest element in S after k days?" 1800
1851G "Vlad and the Mountains" "binary search,data structures,dsu,graphs,implementation,sortings,trees,two pointers" "Vlad decided to go on a trip to the mountains. He plans to move between n mountains, some of which are connected by roads. The i-th mountain has a height of hi.If there is a road between mountains i and j, Vlad can move from mountain i to mountain j by spending hj\xe2\x88\x92hi units of energy. If his energy drops below zero during the transition, he will not be able to move from mountain i to mountain j. Note that hj\xe2\x88\x92hi can be negative and then the energy will be restored.Vlad wants to consider different route options, so he asks you to answer the following queries: is it possible to construct some route starting at mountain a and ending at mountain b, given that he initially has e units of energy?" 2000
1851F "Lisa and the Martians" bitmasks,greedy,math,strings,trees "Lisa was kidnapped by martians! It okay, because she has watched a lot of TV shows about aliens, so she knows what awaits her. Let\'s call integer martian if it is a non-negative integer and strictly less than 2k, for example, when k=12, the numbers 51, 1960, 0 are martian, and the numbers \xcf\x80, \xe2\x88\x921, 218, 4096 are not.The aliens will give Lisa n martian numbers a1,a2,\xe2\x80\xa6,an. Then they will ask her to name any martian number x. After that, Lisa will select a pair of numbers ai,aj (i\xe2\x89\xa0j) in the given sequence and count (ai\xe2\x8a\x95x)&(aj\xe2\x8a\x95x). The operation \xe2\x8a\x95 means Bitwise exclusive OR, the operation & means Bitwise And. For example, (5\xe2\x8a\x9517)&(23\xe2\x8a\x9517)=(001012\xe2\x8a\x95100012)&(101112\xe2\x8a\x95100012)=101002&001102=001002=4.Lisa is sure that the higher the calculated value, the higher her chances of returning home. Help the girl choose such i,j,x that maximize the calculated value." 1800
1851E "Nastya and Potions" "dfs and similar,dp,graphs,sortings" "Alchemist Nastya loves mixing potions. There are a total of n types of potions, and one potion of type i can be bought for ci coins.Any kind of potions can be obtained in no more than one way, by mixing from several others. The potions used in the mixing process will be consumed. Moreover, no potion can be obtained from itself through one or more mixing processes.As an experienced alchemist, Nastya has an unlimited supply of k types of potions p1,p2,\xe2\x80\xa6,pk, but she doesn\'t know which one she wants to obtain next. To decide, she asks you to find, for each 1\xe2\x89\xa4i\xe2\x89\xa4n, the minimum number of coins she needs to spend to obtain a potion of type i next." 1500
1851D "Prefix Permutation Sums" implementation,math "Your friends have an array of n elements, calculated its array of prefix sums and passed it to you, accidentally losing one element during the transfer. Your task is to find out if the given array can matches permutation.A permutation of n elements is an array of n numbers from 1 to n such that each number occurs exactly one times in it.The array of prefix sums of the array a \xe2\x80\x94 is such an array b that bi=\xe2\x88\x91ij=1aj,1\xe2\x89\xa4i\xe2\x89\xa4n.For example, the original permutation was [1,5,2,4,3]. Its array of prefix sums \xe2\x80\x94 [1,6,8,12,15]. Having lost one element, you can get, for example, arrays [6,8,12,15] or [1,6,8,15].It can also be shown that the array [1,2,100] does not correspond to any permutation." 1300
1851C "Tiles Comeback" greedy "Vlad remembered that he had a series of n tiles and a number k. The tiles were numbered from left to right, and the i-th tile had colour ci.If you stand on the first tile and start jumping any number of tiles right, you can get a path of length p. The length of the path is the number of tiles you stood on.Vlad wants to see if it is possible to get a path of length p such that:   it ends at tile with index n;  p is divisible by k  the path is divided into blocks of length exactly k each;  tiles in each block have the same colour, the colors in adjacent blocks are not necessarily different. For example, let n=14, k=3.The colours of the tiles are contained in the array c = [1,2,1,1,7,5,3,3,1,3,4,4,2,4]. Then we can construct a path of length 6 consisting of 2 blocks:c1\xe2\x86\x92c3\xe2\x86\x92c4\xe2\x86\x92c11\xe2\x86\x92c12\xe2\x86\x92c14All tiles from the 1-st block will have colour 1, from the 2-nd block will have colour 4.It is also possible to construct a path of length 9 in this example, in which all tiles from the 1-st block will have colour 1, from the 2-nd block will have colour 3, and from the 3-rd block will have colour 4." 1000
1851B "Parity Sort" "greedy,sortings,two pointers" "You have an array of integers a of length n. You can apply the following operation to the given array:   Swap two elements ai and aj such that i\xe2\x89\xa0j, ai and aj are either both even or both odd.  Determine whether it is possible to sort the array in non-decreasing order by performing the operation any number of times (possibly zero).For example, let a = [7,10,1,3,2]. Then we can perform 3 operations to sort the array:   Swap a3=1 and a1=7, since 1 and 7 are odd. We get a = [1,10,7,3,2];  Swap a2=10 and a5=2, since 10 and 2 are even. We get a = [1,2,7,3,10];  Swap a4=3 and a3=7, since 3 and 7 are odd. We get a = [1,2,3,7,10]." 800
1851A "Escalator Conversations" "brute force,constructive algorithms,math" "One day, Vlad became curious about who he can have a conversation with on the escalator in the subway. There are a total of n passengers. The escalator has a total of m steps, all steps indexed from 1 to m and i-th step has height i\xe2\x8b\x85k.Vlad\'s height is H centimeters. Two people with heights a and b can have a conversation on the escalator if they are standing on different steps and the height difference between them is equal to the height difference between the steps.For example, if two people have heights 170 and 180 centimeters, and m=10,k=5, then they can stand on steps numbered 7 and 5, where the height difference between the steps is equal to the height difference between the two people: k\xe2\x8b\x852=5\xe2\x8b\x852=10=180\xe2\x88\x92170. There are other possible ways.Given an array h of size n, where hi represents the height of the i-th person. Vlad is interested in how many people he can have a conversation with on the escalator individually.For example, if n=5,m=3,k=3,H=11, and h=[5,4,14,18,2], Vlad can have a conversation with the person with height 5 (Vlad will stand on step 1, and the other person will stand on step 3) and with the person with height 14 (for example, Vlad can stand on step 3, and the other person will stand on step 2). Vlad cannot have a conversation with the person with height 2 because even if they stand on the extreme steps of the escalator, the height difference between them will be 6, while their height difference is 9. Vlad cannot have a conversation with the rest of the people on the escalator, so the answer for this example is 2." 800
1850H "The Third Letter" "dfs and similar,dsu,graphs,greedy,implementation" "In order to win his toughest battle, Mircea came up with a great strategy for his army. He has n soldiers and decided to arrange them in a certain way in camps. Each soldier has to belong to exactly one camp, and there is one camp at each integer point on the x-axis (at points \xe2\x8b\xaf,\xe2\x88\x922,\xe2\x88\x921,0,1,2,\xe2\x8b\xaf).The strategy consists of m conditions. Condition i tells that soldier ai should belong to a camp that is situated di meters in front of the camp that person bi belongs to. (If di<0, then ai\'s camp should be \xe2\x88\x92di meters behind bi\'s camp.)Now, Mircea wonders if there exists a partition of soldiers that respects the condition and he asks for your help! Answer ""YES"" if there is a partition of the n soldiers that satisfies all of the m conditions and ""NO"" otherwise.Note that two different soldiers may be placed in the same camp." 1700
1850G "The Morning Star" "combinatorics,data structures,geometry,implementation,math,sortings" "A compass points directly toward the morning star. It can only point in one of eight directions: the four cardinal directions (N, S, E, W) or some combination (NW, NE, SW, SE). Otherwise, it will break.  The directions the compass can point. There are nn distinct points with integer coordinates on a plane. How many ways can you put a compass at one point and the morning star at another so that the compass does not break?" 1500
1850F "We Were Both Children" "brute force,implementation,math,number theory" "Mihai and Slavic were looking at a group of n frogs, numbered from 1 to n, all initially located at point 0. Frog i has a hop length of ai. Each second, frog i hops ai units forward. Before any frogs start hopping, Slavic and Mihai can place exactly one trap in a coordinate in order to catch all frogs that will ever pass through the corresponding coordinate.However, the children can\'t go far away from their home so they can only place a trap in the first n points (that is, in a point with a coordinate between 1 and n) and the children can\'t place a trap in point 0 since they are scared of frogs.Can you help Slavic and Mihai find out what is the maximum number of frogs they can catch using a trap?" 1300
1850E "Cardboard for Pictures" "binary search,geometry,implementation,math" "Mircea has n pictures. The i-th picture is a square with a side length of si centimeters. He mounted each picture on a square piece of cardboard so that each picture has a border of w centimeters of cardboard on all sides. In total, he used c square centimeters of cardboard. Given the picture sizes and the value c, can you find the value of w?  A picture of the first test case. Here c=50=52+42+32, so w=1 is the answer. Please note that the piece of cardboard goes behind each picture, not just the border." 1100
1850D "Balanced Round" "brute force,greedy,implementation,sortings" "You are the author of a Codeforces round and have prepared n problems you are going to set, problem i having difficulty ai. You will do the following process:   remove some (possibly zero) problems from the list;  rearrange the remaining problems in any order you wish. A round is considered balanced if and only if the absolute difference between the difficulty of any two consecutive problems is at most k (less or equal than k).What is the minimum number of problems you have to remove so that an arrangement of problems is balanced?" 900
1850C "Word on the Paper" implementation,strings "On an 8\xc3\x978 grid of dots, a word consisting of lowercase Latin letters is written vertically in one column, from top to bottom. What is it?" 800
1850B "Ten Words of Wisdom" implementation,sortings "In the game show ""Ten Words of Wisdom"", there are n participants numbered from 1 to n, each of whom submits one response. The i-th response is ai words long and has quality bi. No two responses have the same quality, and at least one response has length at most 10.The winner of the show is the response which has the highest quality out of all responses that are not longer than 10 words. Which response is the winner?" 800
1850A "To My Critics" implementation,sortings "Suneet has three digits a, b, and c. Since math isn\'t his strongest point, he asks you to determine if you can choose any two digits to make a sum greater or equal to 10.Output ""YES"" if there is such a pair, and ""NO"" otherwise." 800
1849F "XOR Partition" "binary search,bitmasks,data structures,divide and conquer,greedy,trees" "For a set of integers S, let\'s define its cost as the minimum value of x\xe2\x8a\x95y among all pairs of different integers from the set (here, \xe2\x8a\x95 denotes bitwise XOR). If there are less than two elements in the set, its cost is equal to 230.You are given a set of integers {a1,a2,\xe2\x80\xa6,an}. You have to partition it into two sets S1 and S2 in such a way that every element of the given set belongs to exactly one of these two sets. The value of the partition is the minimum among the costs of S1 and S2.Find the partition with the maximum possible value." 2700
1849E "Max to the Right of Min" "binary search,data structures,divide and conquer,dp,dsu,two pointers" "You are given a permutation p of length n \xe2\x80\x94 an array, consisting of integers from 1 to n, all distinct.Let pl,r denote a subarray \xe2\x80\x94 an array formed by writing down elements from index l to index r, inclusive.Let maxposl,r denote the index of the maximum element on pl,r. Similarly, let minposl,r denote the index of the minimum element on it.Calculate the number of subarrays pl,r such that maxposl,r>minposl,r." 2300
1849D "Array Painting" "constructive algorithms,greedy,two pointers" "You are given an array of n integers, where each integer is either 0, 1, or 2. Initially, each element of the array is blue.Your goal is to paint each element of the array red. In order to do so, you can perform operations of two types:  pay one coin to choose a blue element and paint it red;  choose a red element which is not equal to 0 and a blue element adjacent to it, decrease the chosen red element by 1, and paint the chosen blue element red. What is the minimum number of coins you have to spend to achieve your goal?" 1700
1849C "Binary String Copying" "binary search,brute force,data structures,hashing,strings" "You are given a string s consisting of n characters 0 and/or 1.You make m copies of this string, let the i-th copy be the string ti. Then you perform exactly one operation on each of the copies: for the i-th copy, you sort its substring [li;ri] (the substring from the li-th character to the ri-th character, both endpoints inclusive). Note that each operation affects only one copy, and each copy is affected by only one operation.Your task is to calculate the number of different strings among t1,t2,\xe2\x80\xa6,tm. Note that the initial string s should be counted only if at least one of the copies stays the same after the operation." 1600
1849B Monsters greedy,math,sortings "Monocarp is playing yet another computer game. And yet again, his character is killing some monsters. There are n monsters, numbered from 1 to n, and the i-th of them has ai health points initially.Monocarp\'s character has an ability that deals k damage to the monster with the highest current health. If there are several of them, the one with the smaller index is chosen. If a monster\'s health becomes less than or equal to 0 after Monocarp uses his ability, then it dies.Monocarp uses his ability until all monsters die. Your task is to determine the order in which monsters will die." 1000
1849A "Morning Sandwich" implementation,math "Monocarp always starts his morning with a good ol\' sandwich. Sandwiches Monocarp makes always consist of bread, cheese and/or ham.A sandwich always follows the formula:   a piece of bread  a slice of cheese or ham  a piece of bread  \xe2\x80\xa6  a slice of cheese or ham  a piece of bread So it always has bread on top and at the bottom, and it alternates between bread and filling, where filling is a slice of either cheese or ham. Each piece of bread and each slice of cheese or ham is called a layer.Today Monocarp woke up and discovered that he has b pieces of bread, c slices of cheese and h slices of ham. What is the maximum number of layers his morning sandwich can have?" 800
1848F "Vika and Wiki" "binary search,bitmasks,combinatorics,divide and conquer,dp,math" "Recently, Vika was studying her favorite internet resource - Wikipedia.On the expanses of Wikipedia, she read about an interesting mathematical operation bitwise XOR, denoted by \xe2\x8a\x95. Vika began to study the properties of this mysterious operation. To do this, she took an array a consisting of n non-negative integers and applied the following operation to all its elements at the same time: ai=ai\xe2\x8a\x95a(i+1)modn. Here xmody denotes the remainder of dividing x by y. The elements of the array are numbered starting from 0.Since it is not enough to perform the above actions once for a complete study, Vika repeats them until the array a becomes all zeros.Determine how many of the above actions it will take to make all elements of the array a zero. If this moment never comes, output \xe2\x88\x921." 2400
1848E "Vika and Stone Skipping" "brute force,implementation,math,number theory" "In Vika\'s hometown, Vladivostok, there is a beautiful sea.Often you can see kids skimming stones. This is the process of throwing a stone into the sea at a small angle, causing it to fly far and bounce several times off the water surface.Vika has skimmed stones many times and knows that if you throw a stone from the shore perpendicular to the coastline with a force of f, it will first touch the water at a distance of f from the shore, then bounce off and touch the water again at a distance of f\xe2\x88\x921 from the previous point of contact. The stone will continue to fly in a straight line, reducing the distances between the points where it touches the water, until it falls into the sea.Formally, the points at which the stone touches the water surface will have the following coordinates: f, f+(f\xe2\x88\x921), f+(f\xe2\x88\x921)+(f\xe2\x88\x922), ... , f+(f\xe2\x88\x921)+(f\xe2\x88\x922)+\xe2\x80\xa6+1 (assuming that 0 is the coordinate of the shoreline).Once, while walking along the embankment of Vladivostok in the evening, Vika saw a group of guys skipping stones across the sea, launching them from the same point with different forces.She became interested in what is the maximum number of guys who can launch a stone with their force fi, so that all fi are different positive integers, and all n stones touched the water at the point with the coordinate x (assuming that 0 is the coordinate of the shoreline).After thinking a little, Vika answered her question. After that, she began to analyze how the answer to her question would change if she multiplied the coordinate x by some positive integers x1, x2, ... , xq, which she picked for analysis.Vika finds it difficult to cope with such analysis on her own, so she turned to you for help.Formally, Vika is interested in the answer to her question for the coordinates X1=x\xe2\x8b\x85x1, X2=X1\xe2\x8b\x85x2, ... , Xq=Xq\xe2\x88\x921\xe2\x8b\x85xq. Since the answer for such coordinates can be quite large, find it modulo M. It is guaranteed that M is prime." 2600
1848D "Vika and Bonuses" "binary search,brute force,math,ternary search" "A new bonus system has been introduced at Vika\'s favorite cosmetics store, ""Golden Pear""!The system works as follows: suppose a customer has b bonuses. Before paying for the purchase, the customer can choose one of two options:   Get a discount equal to the current number of bonuses, while the bonuses are not deducted.  Accumulate an additional x bonuses, where x is the last digit of the number b. As a result, the customer\'s account will have b+x bonuses. For example, if a customer had 24 bonuses, he can either get a discount of 24 or accumulate an additional 4 bonuses, after which his account will have 28 bonuses.At the moment, Vika has already accumulated s bonuses.The girl knows that during the remaining time of the bonus system, she will make k more purchases at the ""Golden Pear"" store network.After familiarizing herself with the rules of the bonus system, Vika became interested in the maximum total discount she can get.Help the girl answer this question." 2200
1848C "Vika and Price Tags" "math,number theory" "Vika came to her favorite cosmetics store ""Golden Pear"". She noticed that the prices of n items have changed since her last visit.She decided to analyze how much the prices have changed and calculated the difference between the old and new prices for each of the n items.Vika enjoyed calculating the price differences and decided to continue this process.Let the old prices be represented as an array of non-negative integers a, and the new prices as an array of non-negative integers b. Both arrays have the same length n.In one operation, Vika constructs a new array c according to the following principle: ci=|ai\xe2\x88\x92bi|. Then, array c renamed into array b, and array b renamed into array a at the same time, after which Vika repeats the operation with them.For example, if a=[1,2,3,4,5,6,7]; b=[7,6,5,4,3,2,1], then c=[6,4,2,0,2,4,6]. Then, a=[7,6,5,4,3,2,1]; b=[6,4,2,0,2,4,6].Vika decided to call a pair of arrays a, b dull if after some number of such operations all elements of array a become zeros.Output ""YES"" if the original pair of arrays is dull, and ""NO"" otherwise." 1800
1848B "Vika and the Bridge" "binary search,data structures,greedy,implementation,math,sortings" "In the summer, Vika likes to visit her country house. There is everything for relaxation: comfortable swings, bicycles, and a river.There is a wooden bridge over the river, consisting of n planks. It is quite old and unattractive, so Vika decided to paint it. And in the shed, they just found cans of paint of k colors.After painting each plank in one of k colors, Vika was about to go swinging to take a break from work. However, she realized that the house was on the other side of the river, and the paint had not yet completely dried, so she could not walk on the bridge yet.In order not to spoil the appearance of the bridge, Vika decided that she would still walk on it, but only stepping on planks of the same color. Otherwise, a small layer of paint on her sole will spoil the plank of another color. Vika also has a little paint left, but it will only be enough to repaint one plank of the bridge.Now Vika is standing on the ground in front of the first plank. To walk across the bridge, she will choose some planks of the same color (after repainting), which have numbers 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<im\xe2\x89\xa4n (planks are numbered from 1 from left to right). Then Vika will have to cross i1\xe2\x88\x921,i2\xe2\x88\x92i1\xe2\x88\x921,i3\xe2\x88\x92i2\xe2\x88\x921,\xe2\x80\xa6,im\xe2\x88\x92im\xe2\x88\x921\xe2\x88\x921,n\xe2\x88\x92im planks as a result of each of m+1 steps.Since Vika is afraid of falling, she does not want to take too long steps. Help her and tell her the minimum possible maximum number of planks she will have to cross in one step, if she can repaint one (or zero) plank a different color while crossing the bridge." 1200
1848A "Vika and Her Friends" games,math "Vika and her friends went shopping in a mall, which can be represented as a rectangular grid of rooms with sides of length n and m. Each room has coordinates (a,b), where 1\xe2\x89\xa4a\xe2\x89\xa4n,1\xe2\x89\xa4b\xe2\x89\xa4m. Thus we call a hall with coordinates (c,d) a neighbouring for it if |a\xe2\x88\x92c|+|b\xe2\x88\x92d|=1.Tired of empty fashion talks, Vika decided to sneak away unnoticed. But since she hasn\'t had a chance to visit one of the shops yet, she doesn\'t want to leave the mall. After a while, her friends noticed Vika\'s disappearance and started looking for her.Currently, Vika is in a room with coordinates (x,y), and her k friends are in rooms with coordinates (x1,y1), (x2,y2), ... ,(xk,yk), respectively. The coordinates can coincide. Note that all the girls must move to the neighbouring rooms.Every minute, first Vika moves to one of the adjacent to the side rooms of her choice, and then each friend (seeing Vika\'s choice) also chooses one of the adjacent rooms to move to.If at the end of the minute (that is, after all the girls have moved on to the neighbouring rooms) at least one friend is in the same room as Vika, she is caught and all the other friends are called.Tell us, can Vika run away from her annoying friends forever, or will she have to continue listening to empty fashion talks after some time?" 900
1847F "The Boss\'s Identity" "binary search,bitmasks,data structures,dfs and similar,greedy,math,sortings" "While tracking Diavolo\'s origins, Giorno receives a secret code from Polnareff. The code can be represented as an infinite sequence of positive integers: a1,a2,\xe2\x80\xa6. Giorno immediately sees the pattern behind the code. The first n numbers a1,a2,\xe2\x80\xa6,an are given. For i>n the value of ai is (ai\xe2\x88\x92n | ai\xe2\x88\x92n+1), where | denotes the bitwise OR operator.Pieces of information about Diavolo are hidden in q questions. Each question has a positive integer v associated with it and its answer is the smallest index i such that ai>v. If no such i exists, the answer is \xe2\x88\x921. Help Giorno in answering the questions!" 2500
1847E "Triangle Platinum?" "brute force,combinatorics,implementation,interactive,math,probabilities" "This is an interactive problem.Made in Heaven is a rather curious Stand. Of course, it is (arguably) the strongest Stand in existence, but it is also an ardent puzzle enjoyer. For example, it gave Qtaro the following problem recently:Made in Heaven has n hidden integers a1,a2,\xe2\x80\xa6,an (3\xe2\x89\xa4n\xe2\x89\xa45000, 1\xe2\x89\xa4ai\xe2\x89\xa44). Qtaro must determine all the ai by asking Made in Heaven some queries of the following form:   In one query Qtaro is allowed to give Made in Heaven three distinct indexes i, j and k (1\xe2\x89\xa4i,j,k\xe2\x89\xa4n).  If ai,aj,ak form the sides of a non-degenerate triangle\xe2\x80\xa0, Made in Heaven will respond with the area of this triangle.  Otherwise, Made in Heaven will respond with 0. By asking at most 5500 such questions, Qtaro must either tell Made in Heaven all the values of the ai, or report that it is not possible to uniquely determine them.Unfortunately due to the universe reboot, Qtaro is not as smart as Jotaro. Please help Qtaro solve Made In Heaven\'s problem.  \xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94 \xe2\x80\xa0 Three positive integers a,b,c are said to form the sides of a non-degenerate triangle if and only if all of the following three inequalities hold:   a+b>c,  b+c>a,  c+a>b." 2900
1847D "Professor Higashikata" "data structures,dsu,greedy,implementation,strings" "Josuke is tired of his peaceful life in Morioh. Following in his nephew Jotaro\'s footsteps, he decides to study hard and become a professor of computer science. While looking up competitive programming problems online, he comes across the following one: Let s be a binary string of length n. An operation on s is defined as choosing two distinct integers i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n), and swapping the characters si,sj.Consider the m strings t1,t2,\xe2\x80\xa6,tm, where ti is the substring \xe2\x80\xa0 of s from li to ri. Define t(s)=t1+t2+\xe2\x80\xa6+tm as the concatenation of the strings ti in that order.There are q updates to the string. In the i-th update sxi gets flipped. That is if sxi=1, then sxi becomes 0 and vice versa. After each update, find the minimum number of operations one must perform on s to make t(s) lexicographically as large\xe2\x80\xa1 as possible. Note that no operation is actually performed. We are only interested in the number of operations.Help Josuke in his dream by solving the problem for him. \xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94\xe2\x80\x94 \xe2\x80\xa0 A string a is a substring of a string b if a can be obtained from b by the deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.\xe2\x80\xa1 A string a is lexicographically larger than a string b of the same length if and only if the following holds:   in the first position where a and b differ, the string a has a 1, and the string b has a 0." 1900
1847C "Vampiric Powers, anyone?" "bitmasks,brute force,dp,greedy" "DIO knows that the Stardust Crusaders have determined his location and will be coming to fight him. To foil their plans he decides to send out some Stand users to fight them. Initially, he summoned n Stand users with him, the i-th one having a strength of ai. Using his vampiric powers, he can do the following as many times as he wishes:  Let the current number of Stand users be m.  DIO chooses an index i (1\xe2\x89\xa4i\xe2\x89\xa4m).  Then he summons a new Stand user, with index m+1 and strength given by: am+1=ai\xe2\x8a\x95ai+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95am,where the operator \xe2\x8a\x95 denotes the bitwise XOR operation.  Now, the number of Stand users becomes m+1. Unfortunately for DIO, by using Hermit Purple\'s divination powers, the Crusaders know that he is plotting this, and they also know the strengths of the original Stand users. Help the Crusaders find the maximum possible strength of a Stand user among all possible ways that DIO can summon." 1400
1847B "Hamon Odyssey" "bitmasks,greedy,two pointers" "Jonathan is fighting against DIO\'s Vampire minions. There are n of them with strengths a1,a2,\xe2\x80\xa6,an. Denote (l,r) as the group consisting of the vampires with indices from l to r. Jonathan realizes that the strength of any such group is in its weakest link, that is, the bitwise AND. More formally, the strength level of the group (l,r) is defined as f(l,r)=al&al+1&al+2&\xe2\x80\xa6&ar. Here, & denotes the bitwise AND operation. Because Jonathan would like to defeat the vampire minions fast, he will divide the vampires into contiguous groups, such that each vampire is in exactly one group, and the sum of strengths of the groups is minimized. Among all ways to divide the vampires, he would like to find the way with the maximum number of groups.Given the strengths of each of the n vampires, find the maximum number of groups among all possible ways to divide the vampires with the smallest sum of strengths." 1000
1847A "The Man who became a God" greedy,sortings "Kars is tired and resentful of the narrow mindset of his village since they are content with staying where they are and are not trying to become the perfect life form. Being a top-notch inventor, Kars wishes to enhance his body and become the perfect life form. Unfortunately, n of the villagers have become suspicious of his ideas. The i-th villager has a suspicion of ai on him. Individually each villager is scared of Kars, so they form into groups to be more powerful.The power of the group of villagers from l to r be defined as f(l,r) where f(l,r)=|al\xe2\x88\x92al+1|+|al+1\xe2\x88\x92al+2|+\xe2\x80\xa6+|ar\xe2\x88\x921\xe2\x88\x92ar|.Here |x\xe2\x88\x92y| is the absolute value of x\xe2\x88\x92y. A group with only one villager has a power of 0.Kars wants to break the villagers into exactly k contiguous subgroups so that the sum of their power is minimized. Formally, he must find k\xe2\x88\x921 positive integers 1\xe2\x89\xa4r1<r2<\xe2\x80\xa6<rk\xe2\x88\x921<n such that f(1,r1)+f(r1+1,r2)+\xe2\x80\xa6+f(rk\xe2\x88\x921+1,n) is minimised. Help Kars in finding the minimum value of f(1,r1)+f(r1+1,r2)+\xe2\x80\xa6+f(rk\xe2\x88\x921+1,n)." 800
1846G "Rudolf and CodeVid-23" "bitmasks,dp,graphs,greedy,shortest paths" "A new virus called ""CodeVid-23"" has spread among programmers. Rudolf, being a programmer, was not able to avoid it.There are n symptoms numbered from 1 to n that can appear when infected. Initially, Rudolf has some of them. He went to the pharmacy and bought m medicines.For each medicine, the number of days it needs to be taken is known, and the set of symptoms it removes. Unfortunately, medicines often have side effects. Therefore, for each medicine, the set of symptoms that appear when taking it is also known.After reading the instructions, Rudolf realized that taking more than one medicine at a time is very unhealthy.Rudolph wants to be healed as soon as possible. Therefore, he asks you to calculate the minimum number of days to remove all symptoms, or to say that it is impossible." 1900
1846F "Rudolph and Mimic" "constructive algorithms,implementation,interactive" "This is an interactive task.Rudolph is a scientist who studies alien life forms. There is a room in front of Rudolph with n different objects scattered around. Among the objects there is exactly one amazing creature \xe2\x80\x94 a mimic that can turn into any object. He has already disguised himself in this room and Rudolph needs to find him by experiment.The experiment takes place in several stages. At each stage, the following happens: Rudolf looks at all the objects in the room and writes down their types. The type of each object is indicated by a number; there can be several objects of the same type. After inspecting, Rudolph can point to an object that he thinks is a mimic. After that, the experiment ends. Rudolph only has one try, so if he is unsure of the mimic\'s position, he does the next step instead. Rudolf can remove any number of objects from the room (possibly zero). Then Rudolf leaves the room and at this time all objects, including the mimic, are mixed with each other, their order is changed, and the mimic can transform into any other object (even one that is not in the room). After this, Rudolf returns to the room and repeats the stage. The mimic may not change appearance, but it can not remain a same object for more than two stages in a row.Rudolf\'s task is to detect mimic in no more than five stages." 1800
1846E2 "Rudolf and Snowflakes (hard version)" "binary search,brute force,implementation,math" "This is the hard version of the problem. The only difference is that in this version n\xe2\x89\xa41018.One winter morning, Rudolf was looking thoughtfully out the window, watching the falling snowflakes. He quickly noticed a certain symmetry in the configuration of the snowflakes. And like a true mathematician, Rudolf came up with a mathematical model of a snowflake.He defined a snowflake as an undirected graph constructed according to the following rules:   Initially, the graph has only one vertex.  Then, more vertices are added to the graph. The initial vertex is connected by edges to k new vertices (k>1).  Each vertex that is connected to only one other vertex is connected by edges to k more new vertices. This step should be done at least once. The smallest possible snowflake for k=4 is shown in the figure.  After some mathematical research, Rudolf realized that such snowflakes may not have any number of vertices. Help Rudolf check whether a snowflake with n vertices can exist." 1800
1846E1 "Rudolf and Snowflakes (simple version)" "brute force,implementation,math" "This is a simple version of the problem. The only difference is that in this version n\xe2\x89\xa4106.One winter morning, Rudolf was looking thoughtfully out the window, watching the falling snowflakes. He quickly noticed a certain symmetry in the configuration of the snowflakes. And like a true mathematician, Rudolf came up with a mathematical model of a snowflake.He defined a snowflake as an undirected graph constructed according to the following rules:   Initially, the graph has only one vertex.  Then, more vertices are added to the graph. The initial vertex is connected by edges to k new vertices (k>1).  Each vertex that is connected to only one other vertex is connected by edges to k more new vertices. This step should be done at least once. The smallest possible snowflake for k=4 is shown in the figure.  After some mathematical research, Rudolf realized that such snowflakes may not have any number of vertices. Help Rudolf check if a snowflake with n vertices can exist." 1300
1846D "Rudolph and Christmas Tree" "constructive algorithms,geometry,math" "Rudolph drew a beautiful Christmas tree and decided to print the picture. However, the ink in the cartridge often runs out at the most inconvenient moment. Therefore, Rudolph wants to calculate in advance how much green ink he will need.The tree is a vertical trunk with identical triangular branches at different heights. The thickness of the trunk is negligible.Each branch is an isosceles triangle with base d and height h, whose base is perpendicular to the trunk. The triangles are arranged upward at an angle, and the trunk passes exactly in the middle. The base of the i-th triangle is located at a height of yi.The figure below shows an example of a tree with d=4,h=2 and three branches with bases at heights [1,4,5].  Help Rudolph calculate the total area of the tree branches." 1200
1846C "Rudolf and the Another Competition" "constructive algorithms,data structures,dp,greedy,sortings" "Rudolf has registered for a programming competition that will follow the rules of ICPC. The rules imply that for each solved problem, a participant gets 1 point, and also incurs a penalty equal to the number of minutes passed from the beginning of the competition to the moment of solving the problem. In the final table, the participant with the most points is ranked higher, and in case of a tie in points, the participant with the lower penalty is ranked higher.In total, n participants have registered for the competition. Rudolf is a participant with index 1. It is known that m problems will be proposed. And the competition will last h minutes.A powerful artificial intelligence has predicted the values ti,j, which represent the number of minutes it will take for the i-th participant to solve the j-th problem.Rudolf realized that the order of solving problems will affect the final result. For example, if h=120, and the times to solve problems are [20,15,110], then if Rudolf solves the problems in the order:  3,1,2, then he will only solve the third problem and get 1 point and 110 penalty.  1,2,3, then he will solve the first problem after 20 minutes from the start, the second one after 20+15=35 minutes, and he will not have time to solve the third one. Thus, he will get 2 points and 20+35=55 penalty.  2,1,3, then he will solve the second problem after 15 minutes from the start, the first one after 15+20=35 minutes, and he will not have time to solve the third one. Thus, he will get 2 points and 15+35=50 penalty. Rudolf became interested in what place he will take in the competition if each participant solves problems in the optimal order based on the predictions of the artificial intelligence. It will be assumed that in case of a tie in points and penalty, Rudolf will take the best place." 1200
1846B "Rudolph and Tic-Tac-Toe" "brute force,implementation,strings" "Rudolph invented the game of tic-tac-toe for three players. It has classic rules, except for the third player who plays with pluses. Rudolf has a 3\xc3\x973 field  \xe2\x80\x94 the result of the completed game. Each field cell contains either a cross, or a nought, or a plus sign, or nothing. The game is won by the player who makes a horizontal, vertical or diagonal row of 3\'s of their symbols.Rudolph wants to find the result of the game. Either exactly one of the three players won or it ended in a draw. It is guaranteed that multiple players cannot win at the same time." 800
1846A "Rudolph and Cut the Rope" implementation,math "There are n nails driven into the wall, the i-th nail is driven ai meters above the ground, one end of the bi meters long rope is tied to it. All nails hang at different heights one above the other. One candy is tied to all ropes at once. Candy is tied to end of a rope that is not tied to a nail.To take the candy, you need to lower it to the ground. To do this, Rudolph can cut some ropes, one at a time. Help Rudolph find the minimum number of ropes that must be cut to get the candy.The figure shows an example of the first test:" 800
1845F "Swimmers in the Pool" "dp,fft,math,number theory" "There is a pool of length l where n swimmers plan to swim. People start swimming at the same time (at the time moment 0), but you can assume that they take different lanes, so they don\'t interfere with each other.Each person swims along the following route: they start at point 0 and swim to point l with constant speed (which is equal to vi units per second for the i-th swimmer). After reaching the point l, the swimmer instantly (in negligible time) turns back and starts swimming to the point 0 with the same constant speed. After returning to the point 0, the swimmer starts swimming to the point l, and so on.Let\'s say that some real moment of time is a meeting moment if there are at least two swimmers that are in the same point of the pool at that moment of time (that point may be 0 or l as well as any other real point inside the pool).The pool will be open for t seconds. You have to calculate the number of meeting moments while the pool is open. Since the answer may be very large, print it modulo 109+7." 2800
1845E "Boxes and Balls" dp,implementation,math "There are n boxes placed in a line. The boxes are numbered from 1 to n. Some boxes contain one ball inside of them, the rest are empty. At least one box contains a ball and at least one box is empty.In one move, you have to choose a box with a ball inside and an adjacent empty box and move the ball from one box into another. Boxes i and i+1 for all i from 1 to n\xe2\x88\x921 are considered adjacent to each other. Boxes 1 and n are not adjacent.How many different arrangements of balls exist after exactly k moves are performed? Two arrangements are considered different if there is at least one such box that it contains a ball in one of them and doesn\'t contain a ball in the other one.Since the answer might be pretty large, print its remainder modulo 109+7." 2500
1845D "Rating System" "binary search,brute force,data structures,dp,dsu,greedy,math,two pointers" "You are developing a rating system for an online game. Every time a player participates in a match, the player\'s rating changes depending on the results.Initially, the player\'s rating is 0. There are n matches; after the i-th match, the rating change is equal to ai (the rating increases by ai if ai is positive, or decreases by |ai| if it\'s negative. There are no zeros in the sequence a).The system has an additional rule: for a fixed integer k, if a player\'s rating has reached the value k, it will never fall below it. Formally, if a player\'s rating at least k, and a rating change would make it less than k, then the rating will decrease to exactly k.Your task is to determine the value k in such a way that the player\'s rating after all n matches is the maximum possible (among all integer values of k). If there are multiple possible answers, you can print any of them." 1800
1845C "Strong Password" "binary search,dp,greedy,strings" "Monocarp finally got the courage to register on ForceCoders. He came up with a handle but is still thinking about the password.He wants his password to be as strong as possible, so he came up with the following criteria:   the length of the password should be exactly m;  the password should only consist of digits from 0 to 9;  the password should not appear in the password database (given as a string s) as a subsequence (not necessarily contiguous). Monocarp also came up with two strings of length m: l and r, both consisting only of digits from 0 to 9. He wants the i-th digit of his password to be between li and ri, inclusive.Does there exist a password that fits all criteria?" 1400
1845B "Come Together" geometry,implementation,math "Bob and Carol hanged out with Alice the whole day, but now it\'s time to go home. Alice, Bob and Carol live on an infinite 2D grid in cells A, B, and C respectively. Right now, all of them are in cell A.If Bob (or Carol) is in some cell, he (she) can move to one of the neighboring cells. Two cells are called neighboring if they share a side. For example, the cell (3,5) has four neighboring cells: (2,5), (4,5), (3,6) and (3,4).Bob wants to return to the cell B, Carol \xe2\x80\x94 to the cell C. Both of them want to go along the shortest path, i. e. along the path that consists of the minimum possible number of cells. But they would like to walk together as well. What is the maximum possible number of cells that Bob and Carol can walk together if each of them walks home using one of the shortest paths?" 900
1845A "Forbidden Integer" "constructive algorithms,implementation,math,number theory" "You are given an integer n, which you want to obtain. You have an unlimited supply of every integer from 1 to k, except integer x (there are no integer x at all).You are allowed to take an arbitrary amount of each of these integers (possibly, zero). Can you make the sum of taken integers equal to n?If there are multiple answers, print any of them." 800
1844H "Multiple of Three Cycles" "combinatorics,data structures,dp,dsu,math" "An array a1,\xe2\x80\xa6,an of length n is initially all blank. There are n updates where one entry of a is updated to some number, such that a becomes a permutation of 1,2,\xe2\x80\xa6,n after all the updates.After each update, find the number of ways (modulo 998244353) to fill in the remaining blank entries of a so that a becomes a permutation of 1,2,\xe2\x80\xa6,n and all cycle lengths in a are multiples of 3.A permutation of 1,2,\xe2\x80\xa6,n is an array of length n consisting of n distinct integers from 1 to n in arbitrary order. A cycle in a permutation a is a sequence of pairwise distinct integers (i1,\xe2\x80\xa6,ik) such that i2=ai1,i3=ai2,\xe2\x80\xa6,ik=aik\xe2\x88\x921,i1=aik. The length of this cycle is the number k, which is a multiple of 3 if and only if k\xe2\x89\xa10(mod3)." 3400
1844G "Tree Weights" "bitmasks,constructive algorithms,data structures,dfs and similar,implementation,math,matrices,number theory,trees" "You are given a tree with n nodes labelled 1,2,\xe2\x80\xa6,n. The i-th edge connects nodes ui and vi and has an unknown positive integer weight wi. To help you figure out these weights, you are also given the distance di between the nodes i and i+1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 (the sum of the weights of the edges on the simple path between the nodes i and i+1 in the tree).Find the weight of each edge. If there are multiple solutions, print any of them. If there are no weights wi consistent with the information, print a single integer \xe2\x88\x921." 3000
1844F2 "Min Cost Permutation (Hard Version)" "binary search,constructive algorithms,data structures,greedy,math,sortings" "The only difference between this problem and the easy version is the constraints on t and n.You are given an array of n positive integers a1,\xe2\x80\xa6,an, and a (possibly negative) integer c.Across all permutations b1,\xe2\x80\xa6,bn of the array a1,\xe2\x80\xa6,an, consider the minimum possible value of n\xe2\x88\x921\xe2\x88\x91i=1|bi+1\xe2\x88\x92bi\xe2\x88\x92c|. Find the lexicographically smallest permutation b of the array a that achieves this minimum.A sequence x is lexicographically smaller than a sequence y if and only if one of the following holds: x is a prefix of y, but x\xe2\x89\xa0y; in the first position where x and y differ, the sequence x has a smaller element than the corresponding element in y." 2800
1844F1 "Min Cost Permutation (Easy Version)" "brute force,constructive algorithms,greedy,math" "The only difference between this problem and the hard version is the constraints on t and n.You are given an array of n positive integers a1,\xe2\x80\xa6,an, and a (possibly negative) integer c.Across all permutations b1,\xe2\x80\xa6,bn of the array a1,\xe2\x80\xa6,an, consider the minimum possible value of n\xe2\x88\x921\xe2\x88\x91i=1|bi+1\xe2\x88\x92bi\xe2\x88\x92c|. Find the lexicographically smallest permutation b of the array a that achieves this minimum.A sequence x is lexicographically smaller than a sequence y if and only if one of the following holds: x is a prefix of y, but x\xe2\x89\xa0y; in the first position where x and y differ, the sequence x has a smaller element than the corresponding element in y." 2600
1844E "Great Grids" "2-sat,constructive algorithms,dfs and similar,dsu,graphs" "An n\xc3\x97m grid of characters is called great if it satisfies these three conditions:   Each character is either \'A\', \'B\', or \'C\'.  Every 2\xc3\x972 contiguous subgrid contains all three different letters.  Any two cells that share a common edge contain different letters. Let (x,y) denote the cell in the x-th row from the top and y-th column from the left.You want to construct a great grid that satisfies k constraints. Each constraint consists of two cells, (xi,1,yi,1) and (xi,2,yi,2), that share exactly one corner. You want your great grid to have the same letter in cells (xi,1,yi,1) and (xi,2,yi,2).Determine whether there exists a great grid satisfying all the constraints." 2400
1844D "Row Major" "constructive algorithms,greedy,math,number theory,strings" "The row-major order of an r\xc3\x97c grid of characters A is the string obtained by concatenating all the rows, i.e. A11A12\xe2\x80\xa6A1cA21A22\xe2\x80\xa6A2c\xe2\x80\xa6Ar1Ar2\xe2\x80\xa6Arc.A grid of characters A is bad if there are some two adjacent cells (cells sharing an edge) with the same character.You are given a positive integer n. Consider all strings s consisting of only lowercase Latin letters such that they are not the row-major order of any bad grid. Find any string with the minimum number of distinct characters among all such strings of length n.It can be proven that at least one such string exists under the constraints of the problem." 1400
1844C Particles dp,greedy,implementation,math "You have discovered n mysterious particles on a line with integer charges of c1,\xe2\x80\xa6,cn. You have a device that allows you to perform the following operation:   Choose a particle and remove it from the line. The remaining particles will shift to fill in the gap that is created. If there were particles with charges x and y directly to the left and right of the removed particle, they combine into a single particle of charge x+y. For example, if the line of particles had charges of [\xe2\x88\x923,1,4,\xe2\x88\x921,5,\xe2\x88\x929], performing the operation on the 4th particle will transform the line into [\xe2\x88\x923,1,9,\xe2\x88\x929].  If we then use the device on the 1st particle in this new line, the line will turn into [1,9,\xe2\x88\x929]. You will perform operations until there is only one particle left. What is the maximum charge of this remaining particle that you can obtain?" 1300
1844B "Permutations & Primes" "constructive algorithms,math" "You are given a positive integer n.In this problem, the MEX of a collection of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest positive integer x which does not occur in the collection c. The primality of an array a1,\xe2\x80\xa6,an is defined as the number of pairs (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and MEX(al,\xe2\x80\xa6,ar) is a prime number. Find any permutation of 1,2,\xe2\x80\xa6,n with the maximum possible primality among all permutations of 1,2,\xe2\x80\xa6,n. Note:   A prime number is a number greater than or equal to 2 that is not divisible by any positive integer except 1 and itself. For example, 2,5,13 are prime numbers, but 1 and 6 are not prime numbers.  A permutation of 1,2,\xe2\x80\xa6,n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1000
1844A "Subtraction Game" "constructive algorithms,games" "You are given two positive integers, a and b (a<b).For some positive integer n, two players will play a game starting with a pile of n stones. They take turns removing exactly a or exactly b stones from the pile. The player who is unable to make a move loses.Find a positive integer n such that the second player to move in this game has a winning strategy. This means that no matter what moves the first player makes, the second player can carefully choose their moves (possibly depending on the first player\'s moves) to ensure they win." 800
1843F2 "Omsk Metro (hard version)" "data structures,dfs and similar,divide and conquer,dp,math,trees" "This is the hard version of the problem. The only difference between the simple and hard versions is that in this version u can take any possible value.As is known, Omsk is the capital of Berland. Like any capital, Omsk has a well-developed metro system. The Omsk metro consists of a certain number of stations connected by tunnels, and between any two stations there is exactly one path that passes through each of the tunnels no more than once. In other words, the metro is a tree.To develop the metro and attract residents, the following system is used in Omsk. Each station has its own weight x\xe2\x88\x88{\xe2\x88\x921,1}. If the station has a weight of \xe2\x88\x921, then when the station is visited by an Omsk resident, a fee of 1 burle is charged. If the weight of the station is 1, then the Omsk resident is rewarded with 1 burle.Omsk Metro currently has only one station with number 1 and weight x=1. Every day, one of the following events occurs:  A new station with weight x is added to the station with number vi, and it is assigned a number that is one greater than the number of existing stations.  Alex, who lives in Omsk, wonders: is there a subsegment\xe2\x80\xa0 (possibly empty) of the path between vertices u and v such that, by traveling along it, exactly k burles can be earned (if k<0, this means that k burles will have to be spent on travel). In other words, Alex is interested in whether there is such a subsegment of the path that the sum of the weights of the vertices in it is equal to k. Note that the subsegment can be empty, and then the sum is equal to 0. You are a friend of Alex, so your task is to answer Alex\'s questions.\xe2\x80\xa0Subsegment \xe2\x80\x94 continuous sequence of elements." 2300
1843F1 "Omsk Metro (simple version)" "data structures,dfs and similar,dp,graphs,greedy,math,trees" "This is the simple version of the problem. The only difference between the simple and hard versions is that in this version u=1.As is known, Omsk is the capital of Berland. Like any capital, Omsk has a well-developed metro system. The Omsk metro consists of a certain number of stations connected by tunnels, and between any two stations there is exactly one path that passes through each of the tunnels no more than once. In other words, the metro is a tree.To develop the metro and attract residents, the following system is used in Omsk. Each station has its own weight x\xe2\x88\x88{\xe2\x88\x921,1}. If the station has a weight of \xe2\x88\x921, then when the station is visited by an Omsk resident, a fee of 1 burle is charged. If the weight of the station is 1, then the Omsk resident is rewarded with 1 burle.Omsk Metro currently has only one station with number 1 and weight x=1. Every day, one of the following events occurs:  A new station with weight x is added to the station with number vi, and it is assigned a number that is one greater than the number of existing stations.  Alex, who lives in Omsk, wonders: is there a subsegment\xe2\x80\xa0 (possibly empty) of the path between vertices u and v such that, by traveling along it, exactly k burles can be earned (if k<0, this means that k burles will have to be spent on travel). In other words, Alex is interested in whether there is such a subsegment of the path that the sum of the weights of the vertices in it is equal to k. Note that the subsegment can be empty, and then the sum is equal to 0. You are a friend of Alex, so your task is to answer Alex\'s questions.\xe2\x80\xa0Subsegment \xe2\x80\x94 continuous sequence of elements." 1800
1843E "Tracking Segments" "binary search,brute force,data structures,two pointers" "You are given an array a consisting of n zeros. You are also given a set of m not necessarily different segments. Each segment is defined by two numbers li and ri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n) and represents a subarray ali,ali+1,\xe2\x80\xa6,ari of the array a.Let\'s call the segment li,ri beautiful if the number of ones on this segment is strictly greater than the number of zeros. For example, if a=[1,0,1,0,1], then the segment [1,5] is beautiful (the number of ones is 3, the number of zeros is 2), but the segment [3,4] is not is beautiful (the number of ones is 1, the number of zeros is 1).You also have q changes. For each change you are given the number 1\xe2\x89\xa4x\xe2\x89\xa4n, which means that you must assign an element ax the value 1.You have to find the first change after which at least one of m given segments becomes beautiful, or report that none of them is beautiful after processing all q changes." 1600
1843D "Apple Tree" "combinatorics,dfs and similar,dp,math,trees" "Timofey has an apple tree growing in his garden; it is a rooted tree of n vertices with the root in vertex 1 (the vertices are numbered from 1 to n). A tree is a connected graph without loops and multiple edges.This tree is very unusual \xe2\x80\x94 it grows with its root upwards. However, it\'s quite normal for programmer\'s trees.The apple tree is quite young, so only two apples will grow on it. Apples will grow in certain vertices (these vertices may be the same). After the apples grow, Timofey starts shaking the apple tree until the apples fall. Each time Timofey shakes the apple tree, the following happens to each of the apples:Let the apple now be at vertex u.  If a vertex u has a child, the apple moves to it (if there are several such vertices, the apple can move to any of them).  Otherwise, the apple falls from the tree. It can be shown that after a finite time, both apples will fall from the tree.Timofey has q assumptions in which vertices apples can grow. He assumes that apples can grow in vertices x and y, and wants to know the number of pairs of vertices (a, b) from which apples can fall from the tree, where a \xe2\x80\x94 the vertex from which an apple from vertex x will fall, b \xe2\x80\x94 the vertex from which an apple from vertex y will fall. Help him do this." 1200
1843C "Sum in Binary Tree" bitmasks,combinatorics,math,trees "Vanya really likes math. One day when he was solving another math problem, he came up with an interesting tree. This tree is built as follows.Initially, the tree has only one vertex with the number 1 \xe2\x80\x94 the root of the tree. Then, Vanya adds two children to it, assigning them consecutive numbers \xe2\x80\x94 2 and 3, respectively. After that, he will add children to the vertices in increasing order of their numbers, starting from 2, assigning their children the minimum unused indices. As a result, Vanya will have an infinite tree with the root in the vertex 1, where each vertex will have exactly two children, and the vertex numbers will be arranged sequentially by layers.  Part of Vanya\'s tree. Vanya wondered what the sum of the vertex numbers on the path from the vertex with number 1 to the vertex with number n in such a tree is equal to. Since Vanya doesn\'t like counting, he asked you to help him find this sum." 800
1843B "Long Long" "greedy,math,two pointers" "Today Alex was brought array a1,a2,\xe2\x80\xa6,an of length n. He can apply as many operations as he wants (including zero operations) to change the array elements.In 1 operation Alex can choose any l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and multiply all elements of the array from l to r inclusive by \xe2\x88\x921. In other words, Alex can replace the subarray [al,al+1,\xe2\x80\xa6,ar] by [\xe2\x88\x92al,\xe2\x88\x92al+1,\xe2\x80\xa6,\xe2\x88\x92ar] in 1 operation.For example, let n=5, the array is [1,\xe2\x88\x922,0,3,\xe2\x88\x921], l=2 and r=4, then after the operation the array will be [1,2,0,\xe2\x88\x923,\xe2\x88\x921].Alex is late for school, so you should help him find the maximum possible sum of numbers in the array, which can be obtained by making any number of operations, as well as the minimum number of operations that must be done for this." 800
1843A "Sasha and Array Coloring" "greedy,sortings,two pointers" "Sasha found an array a consisting of n integers and asked you to paint elements.You have to paint each element of the array. You can use as many colors as you want, but each element should be painted into exactly one color, and for each color, there should be at least one element of that color.The cost of one color is the value of max(S)\xe2\x88\x92min(S), where S is the sequence of elements of that color. The cost of the whole coloring is the sum of costs over all colors.For example, suppose you have an array a=[1,5,6,3,4], and you painted its elements into two colors as follows: elements on positions 1, 2 and 5 have color 1; elements on positions 3 and 4 have color 2. Then:  the cost of the color 1 is max([1,5,4])\xe2\x88\x92min([1,5,4])=5\xe2\x88\x921=4;  the cost of the color 2 is max([6,3])\xe2\x88\x92min([6,3])=6\xe2\x88\x923=3;  the total cost of the coloring is 7. For the given array a, you have to calculate the maximum possible cost of the coloring." 800
1842I "Tenzing and Necklace" "divide and conquer,dp,greedy" "bright, sunny and innocent......Tenzing has a beautiful necklace. The necklace consists of n pearls numbered from 1 to n with a string connecting pearls i and (i mod n)+1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n.One day Tenzing wants to cut the necklace into several parts by cutting some strings. But for each connected part of the necklace, there should not be more than k pearls. The time needed to cut each string may not be the same. Tenzing needs to spend ai minutes cutting the string between pearls i and (i mod n)+1.Tenzing wants to know the minimum time in minutes to cut the necklace such that each connected part will not have more than k pearls." 3500
1842H "Tenzing and Random Real Numbers" bitmasks,dp,graphs,math,probabilities "There are n uniform random real variables between 0 and 1, inclusive, which are denoted as x1,x2,\xe2\x80\xa6,xn.Tenzing has m conditions. Each condition has the form of xi+xj\xe2\x89\xa41 or xi+xj\xe2\x89\xa51.Tenzing wants to know the probability that all the conditions are satisfied, modulo 998 244 353.Formally, let M=998 244 353. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output the integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 3000
1842G "Tenzing and Random Operations" combinatorics,dp,math,probabilities "Yet another random problem.Tenzing has an array a of length n and an integer v.Tenzing will perform the following operation m times:  Choose an integer i such that 1\xe2\x89\xa4i\xe2\x89\xa4n uniformly at random.  For all j such that i\xe2\x89\xa4j\xe2\x89\xa4n, set aj:=aj+v. Tenzing wants to know the expected value of \xe2\x88\x8fni=1ai after performing the m operations, modulo 109+7.Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output the integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2800
1842F "Tenzing and Tree" "dfs and similar,greedy,shortest paths,sortings,trees" "Tenzing has an undirected tree of n vertices.Define the value of a tree with black and white vertices in the following way. The value of an edge is the absolute difference between the number of black nodes in the two components of the tree after deleting the edge. The value of the tree is the sum of values over all edges.For all k such that 0\xe2\x89\xa4k\xe2\x89\xa4n, Tenzing wants to know the maximum value of the tree when k vertices are painted black and n\xe2\x88\x92k vertices are painted white." 2500
1842E "Tenzing and Triangle" "data structures,dp,geometry,greedy,math" "There are n pairwise-distinct points and a line x+y=k on a two-dimensional plane. The i-th point is at (xi,yi). All points have non-negative coordinates and are strictly below the line. Alternatively, 0\xe2\x89\xa4xi,yi,xi+yi<k.Tenzing wants to erase all the points. He can perform the following two operations:  Draw triangle: Tenzing will choose two non-negative integers a, b that satisfy a+b<k, then all points inside the triangle formed by lines x=a, y=b and x+y=k will be erased. It can be shown that this triangle is an isosceles right triangle. Let the side lengths of the triangle be l, l and \xe2\x88\x9a2l respectively. Then, the cost of this operation is l\xe2\x8b\x85A.The blue area of the following picture describes the triangle with a=1,b=1 with cost =1\xe2\x8b\x85A.   Erase a specific point: Tenzing will choose an integer i that satisfies 1\xe2\x89\xa4i\xe2\x89\xa4n and erase the point i. The cost of this operation is ci.Help Tenzing find the minimum cost to erase all of the points." 2300
1842D "Tenzing and His Animal Friends" "constructive algorithms,graphs,greedy" "Tell a story about me and my animal friends.Tenzing has n animal friends. He numbers them from 1 to n.One day Tenzing wants to play with his animal friends. To do so, Tenzing will host several games.In one game, he will choose a set S which is a subset of {1,2,3,...,n} and choose an integer t. Then, he will play the game with the animals in S for t minutes.But there are some restrictions:   Tenzing loves friend 1 very much, so 1 must be an element of S.  Tenzing doesn\'t like friend n, so n must not be an element of S.  There are m additional restrictions. The i-th special restriction is described by integers ui, vi and yi, suppose x is the total time that exactly one of ui and vi is playing with Tenzing. Tenzing must ensure that x is less or equal to yi. Otherwise, there will be unhappiness. Tenzing wants to know the maximum total time that he can play with his animal friends. Please find out the maximum total time that Tenzing can play with his animal friends and a way to organize the games that achieves this maximum total time, or report that he can play with his animal friends for an infinite amount of time. Also, Tenzing does not want to host so many games, so he will host at most n2 games." 1900
1842C "Tenzing and Balls" dp "Enjoy erasing Tenzing, identified as Accepted!Tenzing has n balls arranged in a line. The color of the i-th ball from the left is ai.Tenzing can do the following operation any number of times:  select i and j such that 1\xe2\x89\xa4i<j\xe2\x89\xa4|a| and ai=aj,  remove ai,ai+1,\xe2\x80\xa6,aj from the array (and decrease the indices of all elements to the right of aj by j\xe2\x88\x92i+1). Tenzing wants to know the maximum number of balls he can remove." 1500
1842B "Tenzing and Books" bitmasks,greedy,math "Tenzing received 3n books from his fans. The books are arranged in 3 stacks with n books in each stack. Each book has a non-negative integer difficulty rating.Tenzing wants to read some (possibly zero) books. At first, his knowledge is 0.To read the books, Tenzing will choose a non-empty stack, read the book on the top of the stack, and then discard the book. If Tenzing\'s knowledge is currently u, then his knowledge will become u|v after reading a book with difficulty rating v. Here | denotes the bitwise OR operation. Note that Tenzing can stop reading books whenever he wants.Tenzing\'s favourite number is x. Can you help Tenzing check if it is possible for his knowledge to become x?" 1100
1842A "Tenzing and Tsondu" games,math "Tsondu always runs first! ! !Tsondu and Tenzing are playing a card game. Tsondu has n monsters with ability values a1,a2,\xe2\x80\xa6,an while Tenzing has m monsters with ability values b1,b2,\xe2\x80\xa6,bm.Tsondu and Tenzing take turns making moves, with Tsondu going first. In each move, the current player chooses two monsters: one on their side and one on the other side. Then, these monsters will fight each other. Suppose the ability values for the chosen monsters are x and y respectively, then the ability values of the monsters will become x\xe2\x88\x92y and y\xe2\x88\x92x respectively. If the ability value of any monster is smaller than or equal to 0, the monster dies.The game ends when at least one player has no monsters left alive. The winner is the player with at least one monster left alive. If both players have no monsters left alive, the game ends in a draw.Find the result of the game when both players play optimally." 800
1841F "Monocarp and a Strategic Game" "geometry,sortings,two pointers" "Monocarp plays a strategic computer game in which he develops a city. The city is inhabited by creatures of four different races \xe2\x80\x94 humans, elves, orcs, and dwarves.Each inhabitant of the city has a happiness value, which is an integer. It depends on how many creatures of different races inhabit the city. Specifically, the happiness of each inhabitant is 0 by default; it increases by 1 for each other creature of the same race and decreases by 1 for each creature of a hostile race. Humans are hostile to orcs (and vice versa), and elves are hostile to dwarves (and vice versa).At the beginning of the game, Monocarp\'s city is not inhabited by anyone. During the game, n groups of creatures will come to his city, wishing to settle there. The i-th group consists of ai humans, bi orcs, ci elves, and di dwarves. Each time, Monocarp can either accept the entire group of creatures into the city, or reject the entire group.The game calculates Monocarp\'s score according to the following formula: m+k, where m is the number of inhabitants in the city, and k is the sum of the happiness values of all creatures in the city.Help Monocarp earn the maximum possible number of points by the end of the game!" 2700
1841E "Fill the Matrix" "data structures,greedy,math" "There is a square matrix, consisting of n rows and n columns of cells, both numbered from 1 to n. The cells are colored white or black. Cells from 1 to ai are black, and cells from ai+1 to n are white, in the i-th column.You want to place m integers in the matrix, from 1 to m. There are two rules:   each cell should contain at most one integer;  black cells should not contain integers. The beauty of the matrix is the number of such j that j+1 is written in the same row, in the next column as j (in the neighbouring cell to the right).What\'s the maximum possible beauty of the matrix?" 2200
1841D "Pairs of Segments" "data structures,greedy,sortings,two pointers" "Two segments [l1,r1] and [l2,r2] intersect if there exists at least one x such that l1\xe2\x89\xa4x\xe2\x89\xa4r1 and l2\xe2\x89\xa4x\xe2\x89\xa4r2.An array of segments [[l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk]] is called beautiful if k is even, and is possible to split the elements of this array into k2 pairs in such a way that:  every element of the array belongs to exactly one of the pairs;  segments in each pair intersect with each other;  segments in different pairs do not intersect. For example, the array [[2,4],[9,12],[2,4],[7,7],[10,13],[6,8]] is beautiful, since it is possible to form 3 pairs as follows:  the first element of the array (segment [2,4]) and the third element of the array (segment [2,4]);  the second element of the array (segment [9,12]) and the fifth element of the array (segment [10,13]);  the fourth element of the array (segment [7,7]) and the sixth element of the array (segment [6,8]). As you can see, the segments in each pair intersect, and no segments from different pairs intersect.You are given an array of n segments [[l1,r1],[l2,r2],\xe2\x80\xa6,[ln,rn]]. You have to remove the minimum possible number of elements from this array so that the resulting array is beautiful." 2000
1841C "Ranom Numbers" "brute force,dp,greedy,math,strings" "No, not ""random"" numbers.Ranom digits are denoted by uppercase Latin letters from A to E. Moreover, the value of the letter A is 1, B is 10, C is 100, D is 1000, E is 10000.A Ranom number is a sequence of Ranom digits. The value of the Ranom number is calculated as follows: the values of all digits are summed up, but some digits are taken with negative signs: a digit is taken with negative sign if there is a digit with a strictly greater value to the right of it (not necessarily immediately after it); otherwise, that digit is taken with a positive sign.For example, the value of the Ranom number DAAABDCA is 1000\xe2\x88\x921\xe2\x88\x921\xe2\x88\x921\xe2\x88\x9210+1000+100+1=2088.You are given a Ranom number. You can change no more than one digit in it. Calculate the maximum possible value of the resulting number." 1800
1841B "Keep it Beautiful" implementation "The array [a1,a2,\xe2\x80\xa6,ak] is called beautiful if it is possible to remove several (maybe zero) elements from the beginning of the array and insert all these elements to the back of the array in the same order in such a way that the resulting array is sorted in non-descending order.In other words, the array [a1,a2,\xe2\x80\xa6,ak] is beautiful if there exists an integer i\xe2\x88\x88[0,k\xe2\x88\x921] such that the array [ai+1,ai+2,\xe2\x80\xa6,ak\xe2\x88\x921,ak,a1,a2,\xe2\x80\xa6,ai] is sorted in non-descending order.For example:  [3,7,7,9,2,3] is beautiful: we can remove four first elements and insert them to the back in the same order, and we get the array [2,3,3,7,7,9], which is sorted in non-descending order;  [1,2,3,4,5] is beautiful: we can remove zero first elements and insert them to the back, and we get the array [1,2,3,4,5], which is sorted in non-descending order;  [5,2,2,1] is not beautiful. Note that any array consisting of zero elements or one element is beautiful.You are given an array a, which is initially empty. You have to process q queries to it. During the i-th query, you will be given one integer xi, and you have to do the following:  if you can append the integer xi to the back of the array a so that the array a stays beautiful, you have to append it;  otherwise, do nothing. After each query, report whether you appended the given integer xi, or not." 1000
1841A "Game with Board" "constructive algorithms,games" "Alice and Bob play a game. They have a blackboard; initially, there are n integers written on it, and each integer is equal to 1.Alice and Bob take turns; Alice goes first. On their turn, the player has to choose several (at least two) equal integers on the board, wipe them and write a new integer which is equal to their sum.For example, if the board currently contains integers {1,1,2,2,2,3}, then the following moves are possible:  choose two integers equal to 1, wipe them and write an integer 2, then the board becomes {2,2,2,2,3};  choose two integers equal to 2, wipe them and write an integer 4, then the board becomes {1,1,2,3,4};  choose three integers equal to 2, wipe them and write an integer 6, then the board becomes {1,1,3,6}. If a player cannot make a move (all integers on the board are different), that player wins the game.Determine who wins if both players play optimally." 800
1840G2 "In Search of Truth (Hard Version)" "constructive algorithms,interactive,math,meet-in-the-middle,probabilities" "The only difference between easy and hard versions is the maximum number of queries. In this version, you are allowed to ask at most 1000 queries.This is an interactive problem.You are playing a game. The circle is divided into n sectors, sectors are numbered from 1 to n in some order. You are in the adjacent room and do not know either the number of sectors or their numbers. There is also an arrow that initially points to some sector. Initially, the host tells you the number of the sector to which the arrow points. After that, you can ask the host to move the arrow k sectors counterclockwise or clockwise at most 1000 times. And each time you are told the number of the sector to which the arrow points.Your task is to determine the integer n \xe2\x80\x94 the number of sectors in at most 1000 queries.It is guaranteed that 1\xe2\x89\xa4n\xe2\x89\xa4106." 2500
1840G1 "In Search of Truth (Easy Version)" "constructive algorithms,interactive,math,meet-in-the-middle,probabilities" "The only difference between easy and hard versions is the maximum number of queries. In this version, you are allowed to ask at most 2023 queries.This is an interactive problem.You are playing a game. The circle is divided into n sectors, sectors are numbered from 1 to n in some order. You are in the adjacent room and do not know either the number of sectors or their numbers. There is also an arrow that initially points to some sector. Initially, the host tells you the number of the sector to which the arrow points. After that, you can ask the host to move the arrow k sectors counterclockwise or clockwise at most 2023 times. And each time you are told the number of the sector to which the arrow points.Your task is to determine the integer n \xe2\x80\x94 the number of sectors in at most 2023 queries.It is guaranteed that 1\xe2\x89\xa4n\xe2\x89\xa4106." 2200
1840F Railguns "brute force,dfs and similar,dp,graphs" "Tema is playing a very interesting computer game.During the next mission, Tema\'s character found himself on an unfamiliar planet. Unlike Earth, this planet is flat and can be represented as an n\xc3\x97m rectangle.Tema\'s character is located at the point with coordinates (0,0). In order to successfully complete the mission, he needs to reach the point with coordinates (n,m) alive.Let the character of the computer game be located at the coordinate (i,j). Every second, starting from the first, Tema can:  either use vertical hyperjump technology, after which his character will end up at coordinate (i+1,j) at the end of the second;  or use horizontal hyperjump technology, after which his character will end up at coordinate (i,j+1) at the end of the second;  or Tema can choose not to make a hyperjump, in which case his character will not move during this second; The aliens that inhabit this planet are very dangerous and hostile. Therefore, they will shoot from their railguns r times.Each shot completely penetrates one coordinate vertically or horizontally. If the character is in the line of its impact at the time of the shot (at the end of the second), he dies.Since Tema looked at the game\'s source code, he knows complete information about each shot \xe2\x80\x94 the time, the penetrated coordinate, and the direction of the shot.What is the minimum time for the character to reach the desired point? If he is doomed to die and cannot reach the point with coordinates (n,m), output \xe2\x88\x921." 2200
1840E "Character Blocking" "data structures,hashing,implementation" "You are given two strings of equal length s1 and s2, consisting of lowercase Latin letters, and an integer t.You need to answer q queries, numbered from 1 to q. The i-th query comes in the i-th second of time. Each query is one of three types:   block the characters at position pos (indexed from 1) in both strings for t seconds;  swap two unblocked characters;  determine if the two strings are equal at the time of the query, ignoring blocked characters. Note that in queries of the second type, the characters being swapped can be from the same string or from s1 and s2." 1600
1840D "Wooden Toy Festival" "binary search,greedy,sortings" "In a small town, there is a workshop specializing in woodwork. Since the town is small, only three carvers work there.Soon, a wooden toy festival is planned in the town. The workshop employees want to prepare for it.They know that n people will come to the workshop with a request to make a wooden toy. People are different and may want different toys. For simplicity, let\'s denote the pattern of the toy that the i-th person wants as ai (1\xe2\x89\xa4ai\xe2\x89\xa4109).Each of the carvers can choose an integer pattern x (1\xe2\x89\xa4x\xe2\x89\xa4109) in advance, different carvers can choose different patterns. x is the integer. During the preparation for the festival, the carvers will perfectly work out the technique of making the toy of the chosen pattern, which will allow them to cut it out of wood instantly. To make a toy of pattern y for a carver who has chosen pattern x, it will take |x\xe2\x88\x92y| time, because the more the toy resembles the one he can make instantly, the faster the carver will cope with the work.On the day of the festival, when the next person comes to the workshop with a request to make a wooden toy, the carvers can choose who will take on the job. At the same time, the carvers are very skilled people and can work on orders for different people simultaneously.Since people don\'t like to wait, the carvers want to choose patterns for preparation in such a way that the maximum waiting time over all people is as small as possible.Output the best maximum waiting time that the carvers can achieve." 1400
1840C "Ski Resort" "combinatorics,math,two pointers" "Dima Vatrushin is a math teacher at school. He was sent on vacation for n days for his good work. Dima has long dreamed of going to a ski resort, so he wants to allocate several consecutive days and go skiing. Since the vacation requires careful preparation, he will only go for at least k days.You are given an array a containing the weather forecast at the resort. That is, on the i-th day, the temperature will be ai degrees.Dima was born in Siberia, so he can go on vacation only if the temperature does not rise above q degrees throughout the vacation.Unfortunately, Dima was so absorbed in abstract algebra that he forgot how to count. He asks you to help him and count the number of ways to choose vacation dates at the resort." 1000
1840B "Binary Cafe" bitmasks,combinatorics,math "Once upon a time, Toma found himself in a binary cafe. It is a very popular and unusual place.The cafe offers visitors k different delicious desserts. The desserts are numbered from 0 to k\xe2\x88\x921. The cost of the i-th dessert is 2i coins, because it is a binary cafe! Toma is willing to spend no more than n coins on tasting desserts. At the same time, he is not interested in buying any dessert more than once, because one is enough to evaluate the taste.In how many different ways can he buy several desserts (possibly zero) for tasting?" 1100
1840A "Cipher Shifer" "implementation,strings,two pointers" "There is a string a (unknown to you), consisting of lowercase Latin letters, encrypted according to the following rule into string s:  after each character of string a, an arbitrary (possibly zero) number of any lowercase Latin letters, different from the character itself, is added;  after each such addition, the character that we supplemented is added. You are given string s, and you need to output the initial string a. In other words, you need to decrypt string s.Note that each string encrypted in this way is decrypted uniquely." 800
1839E "Decreasing Game" "constructive algorithms,dfs and similar,dp,greedy,interactive" "This is an interactive problem.Consider the following game for two players:  Initially, an array of integers a1,a2,\xe2\x80\xa6,an of length n is written on blackboard. Game consists of rounds. On each round, the following happens:   The first player selects any i such that ai>0. If there is no such i, the first player loses the game (the second player wins) and game ends.  The second player selects any j\xe2\x89\xa0i such that aj>0. If there is no such j, the second player loses the game (the first player wins) and game ends.  Let d=min(ai,aj). The values of ai and aj are simultaneously decreased by d and the next round starts.  It can be shown that game always ends after the finite number of rounds.You have to select which player you will play for (first or second) and win the game." 2400
1839D "Ball Sorting" "data structures,dp,sortings" "There are n colorful balls arranged in a row. The balls are painted in n distinct colors, denoted by numbers from 1 to n. The i-th ball from the left is painted in color ci. You want to reorder the balls so that the i-th ball from the left has color i. Additionally, you have k\xe2\x89\xa51 balls of color 0 that you can use in the reordering process.Due to the strange properties of the balls, they can be reordered only by performing the following operations:  Place a ball of color 0 anywhere in the sequence (between any two consecutive balls, before the leftmost ball or after the rightmost ball) while keeping the relative order of other balls. You can perform this operation no more than k times, because you have only k balls of color 0. Choose any ball of non-zero color such that at least one of the balls adjacent to him has color 0, and move that ball (of non-zero color) anywhere in the sequence (between any two consecutive balls, before the leftmost ball or after the rightmost ball) while keeping the relative order of other balls. You can perform this operation as many times as you want, but for each operation you should pay 1 coin.  You can perform these operations in any order. After the last operation, all balls of color 0 magically disappear, leaving a sequence of n balls of non-zero colors.What is the minimum amount of coins you should spend on the operations of the second type, so that the i-th ball from the left has color i for all i from 1 to n after the disappearance of all balls of color zero? It can be shown that under the constraints of the problem, it is always possible to reorder the balls in the required way. Solve the problem for all k from 1 to n." 2100
1839C "Insert Zero and Invert Prefix" "constructive algorithms" "You have a sequence a1,a2,\xe2\x80\xa6,an of length n, each element of which is either 0 or 1, and a sequence b, which is initially empty.You are going to perform n operations. On each of them you will increase the length of b by 1.  On the i-th operation you choose an integer p between 0 and i\xe2\x88\x921. You insert 0 in the sequence b on position p+1 (after the first p elements), and then you invert the first p elements of b. More formally: let\'s denote the sequence b before the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) operation as b1,b2,\xe2\x80\xa6,bi\xe2\x88\x921. On the i-th operation you choose an integer p between 0 and i\xe2\x88\x921 and replace b with \xc2\xafb1,\xc2\xafb2,\xe2\x80\xa6,\xc2\xafbp,0,bp+1,bp+2,\xe2\x80\xa6,bi\xe2\x88\x921. Here, \xc2\xafx denotes the binary inversion. Hence, \xc2\xaf0=1 and \xc2\xaf1=0. You can find examples of operations in the Notes section.Determine if there exists a sequence of operations that makes b equal to a. If such sequence of operations exists, find it." 1300
1839B Lamps greedy,sortings "You have n lamps, numbered by integers from 1 to n. Each lamp i has two integer parameters ai and bi.At each moment each lamp is in one of three states: it may be turned on, turned off, or broken.Initially all lamps are turned off. In one operation you can select one lamp that is turned off and turn it on (you can\'t turn on broken lamps). You receive bi points for turning lamp i on. The following happens after each performed operation:   Let\'s denote the number of lamps that are turned on as x (broken lamps do not count). All lamps i such that ai\xe2\x89\xa4x simultaneously break, whether they were turned on or off. Please note that broken lamps never count as turned on and that after a turned on lamp breaks, you still keep points received for turning it on.You can perform an arbitrary number of operations.Find the maximum number of points you can get." 1100
1839A "The Good Array" greedy,implementation,math "You are given two integers n and k.An array a1,a2,\xe2\x80\xa6,an of length n, consisting of zeroes and ones is good if for all integers i from 1 to n both of the following conditions are satisfied:  at least \xe2\x8c\x88ik\xe2\x8c\x89 of the first i elements of a are equal to 1,  at least \xe2\x8c\x88ik\xe2\x8c\x89 of the last i elements of a are equal to 1. Here, \xe2\x8c\x88ik\xe2\x8c\x89 denotes the result of division of i by k, rounded up. For example, \xe2\x8c\x8863\xe2\x8c\x89=2, \xe2\x8c\x88115\xe2\x8c\x89=\xe2\x8c\x882.2\xe2\x8c\x89=3 and \xe2\x8c\x8874\xe2\x8c\x89=\xe2\x8c\x881.75\xe2\x8c\x89=2.Find the minimum possible number of ones in a good array." 800
1838F "Stuck Conveyor" "binary search,constructive algorithms,interactive" "This is an interactive problem.There is an n by n grid of conveyor belts, in positions (1,1) through (n,n) of a coordinate plane. Every other square in the plane is empty. Each conveyor belt can be configured to move boxes up (\'^\'), down (\'v\'), left (\'<\'), or right (\'>\'). If a box moves onto an empty square, it stops moving.However, one of the n2 belts is stuck, and will always move boxes in the same direction, no matter how it is configured. Your goal is to perform a series of tests to determine which conveyor belt is stuck, and the direction in which it sends items.To achieve this, you can perform up to 25 tests. In each test, you assign a direction to all n2 belts, place a box on top of one of them, and then turn all of the conveyors on. One possible result of a query with n=4. In this case, the box starts at (2,2). If there were no stuck conveyor, it would end up at (5,4), but because of the stuck \'>\' conveyor at (3,3), it enters an infinite loop.The conveyors move the box around too quickly for you to see, so the only information you receive from a test is whether the box eventually stopped moving, and if so, the coordinates of its final position." 3000
1838E "Count Supersequences" combinatorics,dp,math "You are given an array a of n integers, where all elements ai lie in the range [1,k]. How many different arrays b of m integers, where all elements bi lie in the range [1,k], contain a as a subsequence? Two arrays are considered different if they differ in at least one position.A sequence x is a subsequence of a sequence y if x can be obtained from y by the deletion of several (possibly, zero or all) elements.Since the answer may be large, print it modulo 109+7." 2500
1838D "Bracket Walk" "data structures,greedy,strings" "There is a string s of length n consisting of the characters \'(\' and \')\'. You are walking on this string. You start by standing on top of the first character of s, and you want to make a sequence of moves such that you end on the n-th character. In one step, you can move one space to the left (if you are not standing on the first character), or one space to the right (if you are not standing on the last character). You may not stay in the same place, however you may visit any character, including the first and last character, any number of times.At each point in time, you write down the character you are currently standing on. We say the string is walkable if there exists some sequence of moves that take you from the first character to the last character, such that the string you write down is a regular bracket sequence.A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \'1\' and \'+\' between the original characters of the sequence. For example, bracket sequences ""()()"", ""(())"" are regular (the resulting expressions are: ""(1)+(1)"", ""((1+1)+1)""), and "")("" and ""("" are not.One possible valid walk on s=(())())). The red dot indicates your current position, and the red string indicates the string you have written down. Note that the red string is a regular bracket sequence at the end of the process.You are given q queries. Each query flips the value of a character from \'(\' to \')\' or vice versa. After each query, determine whether the string is walkable.Queries are cumulative, so the effects of each query carry on to future queries." 2100
1838C "No Prime Differences" "constructive algorithms,math,number theory" "You are given integers n and m. Fill an n by m grid with the integers 1 through n\xe2\x8b\x85m, in such a way that for any two adjacent cells in the grid, the absolute difference of the values in those cells is not a prime number. Two cells in the grid are considered adjacent if they share a side.  It can be shown that under the given constraints, there is always a solution." 1400
1838B "Minimize Permutation Subarrays" "constructive algorithms,math" "You are given a permutation p of size n. You want to minimize the number of subarrays of p that are permutations. In order to do so, you must perform the following operation exactly once:  Select integers i, j, where 1\xe2\x89\xa4i,j\xe2\x89\xa4n, then  Swap pi and pj. For example, if p=[5,1,4,2,3] and we choose i=2, j=3, the resulting array will be [5,4,1,2,3]. If instead we choose i=j=5, the resulting array will be [5,1,4,2,3].Which choice of i and j will minimize the number of subarrays that are permutations?A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).An array a is a subarray of an array b if a can be obtained from b by the deletion of several (possibly, zero or all) elements from the beginning and several (possibly, zero or all) elements from the end." 1100
1838A "Blackboard List" "constructive algorithms,math" "Two integers were written on a blackboard. After that, the following step was carried out n\xe2\x88\x922 times:  Select any two integers on the board, and write the absolute value of their difference on the board. After this process was complete, the list of n integers was shuffled. You are given the final list. Recover one of the initial two numbers. You do not need to recover the other one.You are guaranteed that the input can be generated using the above process." 800
1837F "Editorial for Two" "binary search,data structures,greedy,implementation" "Berland Intercollegiate Contest has just finished. Monocarp and Polycarp, as the jury, are going to conduct an editorial. Unfortunately, the time is limited, since they have to finish before the closing ceremony.There were n problems in the contest. The problems are numbered from 1 to n. The editorial for the i-th problem takes ai minutes. Monocarp and Polycarp are going to conduct an editorial for exactly k of the problems.The editorial goes as follows. They have a full problemset of n problems before them, in order. They remove n\xe2\x88\x92k problems without changing the order of the remaining k problems. Then, Monocarp takes some prefix of these k problems (possibly, an empty one or all problems). Polycarp takes the remaining suffix of them. After that, they go to different rooms and conduct editorials for their problems in parallel. So, the editorial takes as much time as the longer of these two does.Please, help Monocarp and Polycarp to choose the problems and the split in such a way that the editorial finishes as early as possible. Print the duration of the editorial." 2400
1837E "Playoff Fixing" combinatorics,trees "2k teams participate in a playoff tournament. The teams are numbered from 1 to 2k, in order of decreasing strength. So, team 1 is the strongest one, team 2k is the weakest one. A team with a smaller number always defeats a team with a larger number.First of all, the teams are arranged in some order during a procedure called seeding. Each team is assigned another unique value from 1 to 2k, called a seed, that represents its starting position in the playoff.The tournament consists of 2k\xe2\x88\x921 games. They are held as follows: the teams are split into pairs: team with seed 1 plays against team with seed 2, team with seed 3 plays against team with seed 4 (exactly in this order), and so on (so, 2k\xe2\x88\x921 games are played in that phase). When a team loses a game, it is eliminated.After that, only 2k\xe2\x88\x921 teams remain. If only one team remains, it is declared the champion; otherwise, 2k\xe2\x88\x922 games are played: in the first one of them, the winner of the game ""seed 1 vs seed 2"" plays against the winner of the game ""seed 3 vs seed 4"", then the winner of the game ""seed 5 vs seed 6"" plays against the winner of the game ""seed 7 vs seed 8"", and so on. This process repeats until only one team remains.After the tournament ends, the teams are assigned places according to the tournament phase when they were eliminated. In particular:  the winner of the tournament gets place 1;  the team eliminated in the finals gets place 2;  both teams eliminated in the semifinals get place 3;  all teams eliminated in the quarterfinals get place 5;  all teams eliminated in the 1/8 finals get place 9, and so on. Now that we established the rules, we do a little rigging. In particular, we want:   team 1 (not team with seed 1) to take place 1;  team 2 to take place 2;  teams 3 and 4 to take place 3;  teams from 5 to 8 to take place 5, and so on. For example, this picture describes one of the possible ways the tournament can go with k=3, and the resulting places of the teams:  Some seeds are already reserved for some teams (we are not the only ones rigging the tournament, apparently). We have to fill the rest of the seeds with the remaining teams to achieve the desired placements. How many ways are there to do that? Since that value might be large, print it modulo 998244353." 2200
1837D "Bracket Coloring" "constructive algorithms,greedy" "A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example:  the bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  the bracket sequences "")("", ""("" and "")"" are not. A bracket sequence is called beautiful if one of the following conditions is satisfied:  it is a regular bracket sequence;  if the order of the characters in this sequence is reversed, it becomes a regular bracket sequence. For example, the bracket sequences ""()()"", ""(())"", "")))((("", ""))()(("" are beautiful.You are given a bracket sequence s. You have to color it in such a way that:  every bracket is colored into one color;  for every color, there is at least one bracket colored into that color;  for every color, if you write down the sequence of brackets having that color in the order they appear, you will get a beautiful bracket sequence. Color the given bracket sequence s into the minimum number of colors according to these constraints, or report that it is impossible." 1400
1837C "Best Binary String" "constructive algorithms,greedy" "You are given a string s consisting of the characters 0, 1 and/or ?. Let\'s call it a pattern.Let\'s say that the binary string (a string where each character is either 0 or 1) matches the pattern if you can replace each character ? with 0 or 1 (for each character, the choice is independent) so that the strings become equal. For example, 0010 matches ?01?, but 010 doesn\'t match 1??, ??, or ????.Let\'s define the cost of the binary string as the minimum number of operations of the form ""reverse an arbitrary contiguous substring of the string"" required to sort the string in non-descending order.You have to find a binary string with the minimum possible cost among those that match the given pattern. If there are multiple answers, print any of them." 1000
1837B "Comparison String" greedy "You are given a string s of length n, where each character is either < or >.An array a consisting of n+1 elements is compatible with the string s if, for every i from 1 to n, the character si represents the result of comparing ai and ai+1, i.\xe2\x80\x89e.:  si is < if and only if ai<ai+1;  si is > if and only if ai>ai+1. For example, the array [1,2,5,4,2] is compatible with the string <<>>. There are other arrays with are compatible with that string, for example, [13,37,42,37,13].The cost of the array is the number of different elements in it. For example, the cost of [1,2,5,4,2] is 4; the cost of [13,37,42,37,13] is 3.You have to calculate the minimum cost among all arrays which are compatible with the given string s." 900
1837A "Grasshopper on a Line" "constructive algorithms,math" "You are given two integers x and k. Grasshopper starts in a point 0 on an OX axis. In one move, it can jump some integer distance, that is not divisible by k, to the left or to the right.What\'s the smallest number of moves it takes the grasshopper to reach point x? What are these moves? If there are multiple answers, print any of them." 800
1836B Astrophysicists greedy,math "In many, many years, far, far away, there will be a launch of the first flight to Mars. To celebrate the success, n astrophysicists working on the project will be given bonuses of a total value of k gold coins.You have to distribute the money among the astrophysicists, and to make it easier, you have to assign bonuses in silver coins. Each gold coin is worth g silver coins, so you have to distribute all k\xe2\x8b\x85g silver coins among n people.Unfortunately, the company has some financial troubles right now. Therefore, instead of paying the number of silver coins written on the bonus, they decided to round this amount to the nearest integer number of gold coins.The rounding procedure is as follows. If an astrophysicist has bonus equal to x silver coins, and we denote r=xmodg, then:   If r\xe2\x89\xa5\xe2\x8c\x88g2\xe2\x8c\x89, the astrophysicist receives x+(g\xe2\x88\x92r) silver coins;  Otherwise, an astrophysicists receives x\xe2\x88\x92r silver coins.  Note that due to rounding, the total sum of actually paid money is not, in general, equal to k\xe2\x8b\x85g silver coins. The operation amodb denotes the remainder of the division of a by b. Sum of values before rounding has to be equal to k\xe2\x8b\x85g silver coins, but some workers can be assigned 0 silver coins.You aim to distribute the bonuses so that the company saves as many silver coins due to rounding as possible. Please note that there is always a distribution in which the company spends no more than k\xe2\x8b\x85g silver coins." 1100
1836A Destroyer implementation,sortings "John is a lead programmer on a destroyer belonging to the space navy of the Confederacy of Independent Operating Systems. One of his tasks is checking if the electronic brains of robots were damaged during battles.A standard test is to order the robots to form one or several lines, in each line the robots should stand one after another. After that, each robot reports the number of robots standing in front of it in its line.  An example of robots\' arrangement (the front of the lines is on the left). The robots report the numbers above. The i-th robot reported number li. Unfortunately, John does not know which line each robot stands in, and can\'t check the reported numbers. Please determine if it is possible to form the lines in such a way that all reported numbers are correct, or not." 800
1835F "Good Graph" "bitmasks,dfs and similar,graph matchings,graphs,implementation" "You are given a bipartite graph G with the vertex set in the left part L, in the right part R, and m edges connecting these two sets. We know that |L|=|R|=n.For any subset S\xe2\x8a\x86L, let N(S) denote the set of all neighbors of vertices in S. We say that a subset S\xe2\x8a\x86L in graph G is tight if |S|=|N(S)|. We say that graph G is good if \xe2\x88\x80S\xe2\x8a\x86L,|S|\xe2\x89\xa4|N(S)|.Your task is to verify whether the graph is good and, if so, to optimize it. If the graph is not good, find a subset S\xe2\x8a\x86L such that |S|>|N(S)|. However, if the graph is good, your task is to find a good bipartite graph G\xe2\x80\xb2 with the same set of vertices L\xe2\x88\xaaR, in which \xe2\x88\x80S\xe2\x8a\x86L, S is tight in G if and only if S is tight in G\xe2\x80\xb2. If there are multiple such graphs, choose one with the smallest possible number of edges. If there are still multiple such graphs, print any." 3500
1835E "Old Mobile" combinatorics,dp,probabilities "During the latest mission of the starship U.S.S. Coder, Captain Jan Bitovsky was accidentally teleported to the surface of an unknown planet. Trying to find his way back, Jan found an artifact from planet Earth\'s ancient civilization \xe2\x80\x94 a mobile device capable of interstellar calls created by Byterola. Unfortunately, there was another problem. Even though Jan, as a representative of humans, knew perfectly the old notation of the cell phone numbers, the symbols on the device\'s keyboard were completely worn down and invisible to the human eye. The old keyboards had exactly m+1 buttons, one for each digit from the base m numerical system, and one single backspace button allowing one to erase the last written digit (if nothing was written on the screen, then this button does nothing, but it\'s still counted as pressed).Jan would like to communicate with his crew. He needs to type a certain number (also from the base m numerical system, that is, digits from 0 to m\xe2\x88\x921). He wants to know the expected number of button presses necessary to contact the U.S.S. Coder. Jan always chooses the most optimal buttons based on his current knowledge. Buttons are indistinguishable until pressed. Help him!" 3500
1835D "Doctor\'s Brown Hypothesis" "dfs and similar,graphs,math,number theory" "The rebels have been crushed in the most recent battle with the imperial forces, but there is a ray of new hope.Meanwhile, on one of the conquered planets, Luke was getting ready for an illegal street race (which should come as no surprise, given his family history). Luke arrived at the finish line with 88 miles per hour on his speedometer. After getting out of the car, he was greeted by a new reality. It turns out that the battle has not happened yet and will start in exactly k hours.The rebels have placed a single battleship on each of the n planets. m unidirectional wormholes connect the planets. Traversing each wormhole takes exactly one hour. Generals of the Imperium have planned the battle precisely, but their troops cannot dynamically adapt to changing circumstances. Because of this, it is enough for the rebels to move some ships around before the battle to confuse the enemy, secure victory and change the galaxy\'s fate.Owing to numerous strategical considerations, which we now omit, the rebels would like to choose two ships that will switch places so that both of them will be on the move for the whole time (exactly k hours). In other words, rebels look for two planets, x and y, such that paths of length k exist from x to y and from y to x.Because of the limited fuel supply, choosing one ship would also be acceptable. This ship should fly through the wormholes for k hours and then return to its initial planet.How many ways are there to choose the ships for completing the mission?" 2900
1835C "Twin Clusters" "bitmasks,brute force,constructive algorithms,math,probabilities" "Famous worldwide astrophysicist Mleil waGrasse Tysok recently read about the existence of twin galaxy clusters. Before he shares this knowledge with the broader audience in his podcast called S.tarT-ok, he wants to prove their presence on his own. Mleil is aware that the vastness of the universe is astounding (almost as astounding as his observation skills) and decides to try his luck and find some new pair of twin clusters.To do so, he used his TLEscope to observe a part of the night sky that was not yet examined by humanity in which there are exactly 2k+1 galaxies in a row. i-th of them consist of exactly 0\xe2\x89\xa4gi<4k stars.A galaxy cluster is any non-empty contiguous segment of galaxies. Moreover, its\' trait is said to be equal to the bitwise XOR of all values gi within this range.Two galaxy clusters are considered twins if and only if they have the same traits and their corresponding segments are disjoint.Write a program that, for many scenarios, will read a description of a night sky part observed by Mleil and outputs a location of two intervals belonging to some twin clusters pair, or a single value \xe2\x88\x921 if no such pair exists." 2600
1835B Lottery "binary search,brute force,greedy,math,two pointers" "n people indexed with integers from 1 to n came to take part in a lottery. Each received a ticket with an integer from 0 to m.In a lottery, one integer called target is drawn uniformly from 0 to m. k tickets (or less, if there are not enough participants) with the closest numbers to the target are declared the winners. In case of a draw, a ticket belonging to the person with a smaller index is declared a winner.Bytek decided to take part in the lottery. He knows the values on the tickets of all previous participants. He can pick whatever value he wants on his ticket, but unfortunately, as he is the last one to receive it, he is indexed with an integer n+1. Bytek wants to win the lottery. Thus, he wants to know what he should pick to maximize the chance of winning. He wants to know the smallest integer in case there are many such integers. Your task is to find it and calculate his chance of winning." 2500
1835A "k-th equality" "brute force,implementation,math" "Consider all equalities of form a+b=c, where a has A digits, b has B digits, and c has C digits. All the numbers are positive integers and are written without leading zeroes. Find the k-th lexicographically smallest equality when written as a string like above or determine that it does not exist.For example, the first three equalities satisfying A=1, B=1, C=2 are   1+9=10,  2+8=10,  2+9=11. An equality s is lexicographically smaller than an equality t with the same lengths of the numbers if and only if the following holds:   in the first position where s and t differ, the equality s has a smaller digit than the corresponding digit in t." 1700
1834F Typewriter "brute force,math" "Recently, Polycarp was given an unusual typewriter as a gift! Unfortunately, the typewriter was defective and had a rather strange design.The typewriter consists of n cells numbered from left to right from 1 to n, and a carriage that moves over them. The typewriter cells contain n distinct integers from 1 to n, and each cell i initially contains the integer pi. Before all actions, the carriage is at cell number 1 and there is nothing in its buffer storage. The cell on which the carriage is located is called the current cell. The carriage can perform five types of operations:  Take the integer from the current cell, if it is not empty, and put it in the carriage buffer, if it is empty (this buffer can contain no more than one integer).  Put the integer from the carriage buffer, if it is not empty, into the current cell, if it is empty.  Swap the number in the carriage buffer with the number in the current cell, if both the buffer and the cell contain integers.  Move the carriage from the current cell i to cell i+1 (if i<n), while the integer in the buffer is preserved.  Reset the carriage, i.e. move it to cell number 1, while the integer in the buffer is preserved. Polycarp was very interested in this typewriter, so he asks you to help him understand it and will ask you q queries of three types:  Perform a cyclic shift of the sequence p to the left by kj.  Perform a cyclic shift of the sequence p to the right by kj.  Reverse the sequence p. Before and after each query, Polycarp wants to know what minimum number of carriage resets is needed for the current sequence in order to distribute the numbers to their cells (so that the number i ends up in cell number i).Note that Polycarp only wants to know the minimum number of carriage resets required to arrange the numbers in their places, but he does not actually distribute them.Help Polycarp find the answers to his queries!" 2500
1834E "MEX of LCM" "binary search,data structures,implementation,math,number theory" "You are given an array a of length n. A positive integer x is called good if it is impossible to find a subsegment\xe2\x80\xa0 of the array such that the least common multiple of all its elements is equal to x.You need to find the smallest good integer.A subsegment\xe2\x80\xa0 of the array a is a set of elements al,al+1,\xe2\x80\xa6,ar for some 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. We will denote such subsegment as [l,r]." 2300
1834D "Survey in Class" "brute force,data structures,greedy,implementation,sortings" "Zinaida Viktorovna has n students in her history class. The homework for today included m topics, but the students had little time to prepare, so i-th student learned only topics from li to ri inclusive.At the beginning of the lesson, each student holds their hand at 0. The teacher wants to ask some topics. It goes like this:  The teacher asks the topic k.  If the student has learned topic k, then he raises his hand by 1, otherwise he lower it by 1. Each topic Zinaida Viktorovna can ask no more than one time.Find the maximum difference of the heights of the highest and the lowest hand that can be in class after the survey.Note that the student\'s hand can go below 0." 1900
1834C "Game with Reversing" games,greedy,math,strings "Alice and Bob are playing a game. They have two strings S and T of the same length n consisting of lowercase latin letters. Players take turns alternately, with Alice going first.On her turn, Alice chooses an integer i from 1 to n, one of the strings S or T, and any lowercase latin letter c, and replaces the i-th symbol in the chosen string with the character c.On his turn, Bob chooses one of the strings S or T, and reverses it. More formally, Bob makes the replacement S:=rev(S) or T:=rev(T), where rev(P)=PnPn\xe2\x88\x921\xe2\x80\xa6P1.The game lasts until the strings S and T are equal. As soon as the strings become equal, the game ends instantly.Define the duration of the game as the total number of moves made by both players during the game. For example, if Alice made 2 moves in total, and Bob made 1 move, then the duration of this game is 3.Alice\'s goal is to minimize the duration of the game, and Bob\'s goal is to maximize the duration of the game.What will be the duration of the game, if both players play optimally? It can be shown that the game will end in a finite number of turns." 1200
1834B "Maximum Strength" greedy,math "Fedya is playing a new game called ""The Legend of Link"", in which one of the character\'s abilities is to combine two materials into one weapon. Each material has its own strength, which can be represented by a positive integer x. The strength of the resulting weapon is determined as the sum of the absolute differences of the digits in the decimal representation of the integers at each position.Formally, let the first material have strength X=\xc2\xafx1x2\xe2\x80\xa6xn, and the second material have strength Y=\xc2\xafy1y2\xe2\x80\xa6yn. Then the strength of the weapon is calculated as |x1\xe2\x88\x92y1|+|x2\xe2\x88\x92y2|+\xe2\x80\xa6+|xn\xe2\x88\x92yn|. If the integers have different lengths, then the shorter integer is padded with leading zeros.Fedya has an unlimited supply of materials with all possible strengths from L to R, inclusive. Help him find the maximum possible strength of the weapon he can obtain.An integer C=\xc2\xafc1c2\xe2\x80\xa6ck is defined as an integer obtained by sequentially writing the digits c1,c2,\xe2\x80\xa6,ck from left to right, i.e. 10k\xe2\x88\x921\xe2\x8b\x85c1+10k\xe2\x88\x922\xe2\x8b\x85c2+\xe2\x80\xa6+ck." 1000
1834A "Unit Array" greedy,math "Given an array a of length n, which elements are equal to \xe2\x88\x921 and 1. Let\'s call the array a good if the following conditions are held at the same time:  a1+a2+\xe2\x80\xa6+an\xe2\x89\xa50;  a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85an=1. In one operation, you can select an arbitrary element of the array ai and change its value to the opposite. In other words, if ai=\xe2\x88\x921, you can assign the value to ai:=1, and if ai=1, then assign the value to ai:=\xe2\x88\x921.Determine the minimum number of operations you need to perform to make the array a good. It can be shown that this is always possible." 800
1833G "Ksyusha and Chinchilla" "constructive algorithms,dfs and similar,dp,dsu,greedy,implementation,trees" "Ksyusha has a pet chinchilla, a tree on n vertices and huge scissors. A tree is a connected graph without cycles. During a boring physics lesson Ksyusha thought about how to entertain her pet.Chinchillas like to play with branches. A branch is a tree of 3 vertices.  The branch looks like this. A cut is the removal of some (not yet cut) edge in the tree. Ksyusha has plenty of free time, so she can afford to make enough cuts so that the tree splits into branches. In other words, after several (possibly zero) cuts, each vertex must belong to exactly one branch.Help Ksyusha choose the edges to be cut or tell that it is impossible." 1800
1833F "Ira and Flamenco" "combinatorics,constructive algorithms,data structures,implementation,math,sortings,two pointers" "Ira loves Spanish flamenco dance very much. She decided to start her own dance studio and found n students, ith of whom has level ai.Ira can choose several of her students and set a dance with them. So she can set a huge number of dances, but she is only interested in magnificent dances. The dance is called magnificent if the following is true:   exactly m students participate in the dance;  levels of all dancers are pairwise distinct;  levels of every two dancers have an absolute difference strictly less than m. For example, if m=3 and a=[4,2,2,3,6], the following dances are magnificent (students participating in the dance are highlighted in red): [4,2,2,3,6], [4,2,2,3,6]. At the same time dances [4,2,2,3,6], [4,2,2,3,6], [4,2,2,3,6] are not magnificent.In the dance [4,2,2,3,6] only 2 students participate, although m=3.The dance [4,2,2,3,6] involves students with levels 2 and 2, although levels of all dancers must be pairwise distinct.In the dance [4,2,2,3,6] students with levels 3 and 6 participate, but |3\xe2\x88\x926|=3, although m=3.Help Ira count the number of magnificent dances that she can set. Since this number can be very large, count it modulo 109+7. Two dances are considered different if the sets of students participating in them are different." 1700
1833E "Round Dance" "dfs and similar,dsu,graphs,shortest paths" "n people came to the festival and decided to dance a few round dances. There are at least 2 people in the round dance and each person has exactly two neighbors. If there are 2 people in the round dance then they have the same neighbor on each side.You decided to find out exactly how many dances there were. But each participant of the holiday remembered exactly one neighbor. Your task is to determine what the minimum and maximum number of round dances could be.For example, if there were 6 people at the holiday, and the numbers of the neighbors they remembered are equal [2,1,4,3,6,5], then the minimum number of round dances is1:  1\xe2\x88\x922\xe2\x88\x923\xe2\x88\x924\xe2\x88\x925\xe2\x88\x926\xe2\x88\x921  and the maximum is 3:   1\xe2\x88\x922\xe2\x88\x921  3\xe2\x88\x924\xe2\x88\x923  5\xe2\x88\x926\xe2\x88\x925" 1600
1833D Flipper "brute force,constructive algorithms,greedy" "You are given a permutation p of length n.A permutation is an array consisting of n distinct integers from 1 to n in any order. For example, {2,3,1,5,4} is a permutation, while {1,2,2} is not (since 2 appears twice), and {1,3,4} is also not a permutation (as n=3, but the array contains 4).To the permutation p, you need to apply the following operation exactly once:  First you choose a segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, a segment is a continuous sequence of numbers {pl,pl+1,\xe2\x80\xa6,pr\xe2\x88\x921,pr}) and reverse it. Reversing a segment means swapping pairs of numbers (pl,pr), (pl+1,pr\xe2\x88\x921), ..., (pl+i,pr\xe2\x88\x92i) (where l+i\xe2\x89\xa4r\xe2\x88\x92i).  Then you swap the prefix and suffix: [r+1,n] and [1,l\xe2\x88\x921] (note that these segments may be empty). For example, given n=5,p={2,3,1,5,4}, if you choose the segment [l=2,r=3], after reversing the segment p={2,1,3,5,4}, then you swap the segments [4,5] and [1,1]. Thus, p={5,4,1,3,2}. It can be shown that this is the maximum possible result for the given permutation.You need to output the lexicographically maximum permutation that can be obtained by applying the operation described exactly once.A permutation a is lexicographically greater than permutation b if there exists an i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that aj=bj for 1\xe2\x89\xa4j<i and ai>bi." 1400
1833C "Vlad Building Beautiful Array" greedy,math "Vlad was given an array a of n positive integers. Now he wants to build a beautiful array b of length n from it.Vlad considers an array beautiful if all the numbers in it are positive and have the same parity. That is, all numbers in the beautiful array are greater than zero and are either all even or all odd.To build the array b, Vlad can assign each bi either the value ai or ai\xe2\x88\x92aj, where any j from 1 to n can be chosen.To avoid trying to do the impossible, Vlad asks you to determine whether it is possible to build a beautiful array b of length n using his array a." 800
1833B "Restore the Weather" greedy,sortings "You are given an array a containing the weather forecast for Berlandia for the last n days. That is, ai \xe2\x80\x94 is the estimated air temperature on day i (1\xe2\x89\xa4i\xe2\x89\xa4n).You are also given an array b \xe2\x80\x94 the air temperature that was actually present on each of the days. However, all the values in array b are mixed up. Determine which day was which temperature, if you know that the weather never differs from the forecast by more than k degrees. In other words, if on day i the real air temperature was c, then the equality |ai\xe2\x88\x92c|\xe2\x89\xa4k is always true.For example, let an array a = [1,3,5,3,9] of length n=5 and k=2 be given and an array b = [2,5,11,2,4]. Then, so that the value of bi corresponds to the air temperature on day i, we can rearrange the elements of the array b so: [2,2,5,4,11]. Indeed:   On the 1st day, |a1\xe2\x88\x92b1|=|1\xe2\x88\x922|=1, 1\xe2\x89\xa42=k is satisfied;  On the 2nd day |a2\xe2\x88\x92b2|=|3\xe2\x88\x922|=1, 1\xe2\x89\xa42=k is satisfied;  On the 3rd day, |a3\xe2\x88\x92b3|=|5\xe2\x88\x925|=0, 0\xe2\x89\xa42=k is satisfied;  On the 4th day, |a4\xe2\x88\x92b4|=|3\xe2\x88\x924|=1, 1\xe2\x89\xa42=k is satisfied;  On the 5th day, |a5\xe2\x88\x92b5|=|9\xe2\x88\x9211|=2, 2\xe2\x89\xa42=k is satisfied." 900
1833A "Musical Puzzle" implementation,strings "Vlad decided to compose a melody on his guitar. Let\'s represent the melody as a sequence of notes corresponding to the characters \'a\', \'b\', \'c\', \'d\', \'e\', \'f\', and \'g\'.However, Vlad is not very experienced in playing the guitar and can only record exactly two notes at a time. Vlad wants to obtain the melody s, and to do this, he can merge the recorded melodies together. In this case, the last sound of the first melody must match the first sound of the second melody.For example, if Vlad recorded the melodies ""ab"" and ""ba"", he can merge them together and obtain the melody ""aba"", and then merge the result with ""ab"" to get ""abab"".Help Vlad determine the minimum number of melodies consisting of two notes that he needs to record in order to obtain the melody s." 800
1832F Zombies "binary search,dp" "Polycarp plays a computer game in a post-apocalyptic setting. The zombies have taken over the world, and Polycarp with a small team of survivors is defending against hordes trying to invade their base. The zombies are invading for x minutes starting from minute 0. There are n entrances to the base, and every minute one zombie attempts to enter through every entrance.The survivors can defend the entrances against the zombies. There are two options:   manually \xe2\x80\x94 shoot the zombies coming through a certain entrance;  automatically \xe2\x80\x94 set up an electric fence on a certain entrance to fry the zombies. If an entrance is defended either or both ways during some minute, no zombie goes through.Every entrance is defended by a single dedicated survivor. The i-th entrance is defended manually from minute li until minute ri, non-inclusive \xe2\x80\x94 [li,ri).There are k generators that can be used to defend the entrances automatically. Every entrance should be connected to exactly one generator, but a generator can be connected to multiple entrances (or even none of them). Each generator will work for exactly m consecutive minutes. Polycarp can choose when to power on each generator independently of each other, the m minute long interval should be fully inside the [0,x) time interval.Polycarp is a weird gamer. He wants the game to be as difficult as possible for him. So he wants to connect each entrance to a generator and choose the time for each generator in such a way that as many zombies as possible enter the base. Please, help him to achieve that!" 3200
1832E "Combinatorics Problem" "brute force,combinatorics,dp" "Recall that the binomial coefficient (xy) is calculated as follows (x and y are non-negative integers):  if x<y, then (xy)=0;  otherwise, (xy)=x!y!\xe2\x8b\x85(x\xe2\x88\x92y)!. You are given an array a1,a2,\xe2\x80\xa6,an and an integer k. You have to calculate a new array b1,b2,\xe2\x80\xa6,bn, where  b1=((1k)\xe2\x8b\x85a1)mod998244353;  b2=((2k)\xe2\x8b\x85a1+(1k)\xe2\x8b\x85a2)mod998244353;  b3=((3k)\xe2\x8b\x85a1+(2k)\xe2\x8b\x85a2+(1k)\xe2\x8b\x85a3)mod998244353, and so on. Formally, bi=(i\xe2\x88\x91j=1(i\xe2\x88\x92j+1k)\xe2\x8b\x85aj)mod998244353.Note that the array is given in a modified way, and you have to output it in a modified way as well." 2200
1832D2 "Red-Blue Operations (Hard Version)" "binary search,constructive algorithms,greedy,implementation,math" "The only difference between easy and hard versions is the maximum values of n and q.You are given an array, consisting of n integers. Initially, all elements are red.You can apply the following operation to the array multiple times. During the i-th operation, you select an element of the array; then:   if the element is red, it increases by i and becomes blue;  if the element is blue, it decreases by i and becomes red. The operations are numbered from 1, i.\xe2\x80\x89e. during the first operation some element is changed by 1 and so on.You are asked q queries of the following form:   given an integer k, what can the largest minimum in the array be if you apply exactly k operations to it? Note that the operations don\'t affect the array between queries, all queries are asked on the initial array a." 2400
1832D1 "Red-Blue Operations (Easy Version)" "binary search,greedy,implementation,math" "The only difference between easy and hard versions is the maximum values of n and q.You are given an array, consisting of n integers. Initially, all elements are red.You can apply the following operation to the array multiple times. During the i-th operation, you select an element of the array; then:   if the element is red, it increases by i and becomes blue;  if the element is blue, it decreases by i and becomes red. The operations are numbered from 1, i.\xe2\x80\x89e. during the first operation some element is changed by 1 and so on.You are asked q queries of the following form:   given an integer k, what can the largest minimum in the array be if you apply exactly k operations to it? Note that the operations don\'t affect the array between queries, all queries are asked on the initial array a." 2100
1832C "Contrast Value" greedy,implementation "For an array of integers [a1,a2,\xe2\x80\xa6,an], let\'s call the value |a1\xe2\x88\x92a2|+|a2\xe2\x88\x92a3|+\xe2\x8b\xaf+|an\xe2\x88\x921\xe2\x88\x92an| the contrast of the array. Note that the contrast of an array of size 1 is equal to 0.You are given an array of integers a. Your task is to build an array of b in such a way that all the following conditions are met:  b is not empty, i.e there is at least one element;  b is a subsequence of a, i.e b can be produced by deleting some elements from a (maybe zero);  the contrast of b is equal to the contrast of a. What is the minimum possible size of the array b?" 1200
1832B "Maximum Sum" "brute force,sortings,two pointers" "You are given an array a1,a2,\xe2\x80\xa6,an, where all elements are different.You have to perform exactly k operations with it. During each operation, you do exactly one of the following two actions (you choose which to do yourself):  find two minimum elements in the array, and delete them;  find the maximum element in the array, and delete it. You have to calculate the maximum possible sum of elements in the resulting array." 1100
1832A "New Palindrome" strings "A palindrome is a string that reads the same from left to right as from right to left. For example, abacaba, aaaa, abba, racecar are palindromes.You are given a string s consisting of lowercase Latin letters. The string s is a palindrome.You have to check whether it is possible to rearrange the letters in it to get another palindrome (not equal to the given string s)." 800
1831B "Array merging" "constructive algorithms,greedy" "You are given two arrays a and b both of length n.You will merge\xe2\x80\xa0 these arrays forming another array c of length 2\xe2\x8b\x85n. You have to find the maximum length of a subarray consisting of equal values across all arrays c that could be obtained.\xe2\x80\xa0 A merge of two arrays results in an array c composed by successively taking the first element of either array (as long as that array is nonempty) and removing it. After this step, the element is appended to the back of c. We repeat this operation as long as we can (i.e. at least one array is nonempty)." 1000
1831A "Twin Permutations" "constructive algorithms" "You are given a permutation\xe2\x80\xa0 a of length n.Find any permutation b of length n such that a1+b1\xe2\x89\xa4a2+b2\xe2\x89\xa4a3+b3\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an+bn.It can be proven that a permutation b that satisfies the condition above always exists.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800
1830F "The Third Grace" "data structures,dp" "You are given n intervals and m points on the number line. The i-th intervals covers coordinates [li,ri] and the i-th point is on coordinate i and has coefficient pi.Initially, all points are not activated. You should choose a subset of the m points to activate. For each of n interval, we define its cost as:   0, if there are no activated points in the interval;  the coefficient of the activated point with the largest coordinate within it, otherwise. Your task is to maximize the sum of the costs of all intervals by choosing which points to activate." 3200
1830E "Bully Sort" "data structures,math" "On a permutation p of length n, we define a bully swap as follows:  Let i be the index of the largest element pi such that pi\xe2\x89\xa0i.  Let j be the index of the smallest element pj such that i<j.  Swap pi and pj. We define f(p) as the number of bully swaps we need to perform until p becomes sorted. Note that if p is the identity permutation, f(p)=0.You are given n and a permutation p of length n. You need to process the following q updates.In each update, you are given two integers x and y. You will swap px and py and then find the value of f(p).Note that the updates are persistent. Changes made to the permutation p will apply when processing future updates." 3500
1830D "Mex Tree" "brute force,dp,trees" "You are given a tree with n nodes. For each node, you either color it in 0 or 1.The value of a path (u,v) is equal to the MEX\xe2\x80\xa0 of the colors of the nodes from the shortest path between u and v.The value of a coloring is equal to the sum of values of all paths (u,v) such that 1\xe2\x89\xa4u\xe2\x89\xa4v\xe2\x89\xa4n.What is the maximum possible value of any coloring of the tree?\xe2\x80\xa0 The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:  The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4 because 0, 1, 2, and 3 belong to the array, but 4 does not." 2800
1830C "Hyperregular Bracket Strings" "combinatorics,greedy,hashing,math,number theory,sortings" "You are given an integer n and k intervals. The i-th interval is [li,ri] where 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n.Let us call a regular bracket sequence\xe2\x80\xa0,\xe2\x80\xa1 of length n hyperregular if for each i such that 1\xe2\x89\xa4i\xe2\x89\xa4k, the substring \xc2\xafslisli+1\xe2\x80\xa6sri is also a regular bracket sequence.Your task is to count the number of hyperregular bracket sequences. Since this number can be really large, you are only required to find it modulo 998244353.\xe2\x80\xa0 A bracket sequence is a string containing only the characters ""("" and "")"".\xe2\x80\xa1 A bracket sequence is called regular if one can turn it into a valid math expression by adding characters + and 1. For example, sequences (())(), (), (()(())) and the empty string are regular, while )(, ((), and (()))( are not." 2400
1830B "The BOSS Can Count Pairs" "brute force,math" "You are given two arrays a and b, both of length n.Your task is to count the number of pairs of integers (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n and ai\xe2\x8b\x85aj=bi+bj." 2000
1830A "Copil Copac Draws Trees" "dfs and similar,dp,graphs,trees" "Copil Copac is given a list of n\xe2\x88\x921 edges describing a tree of n vertices. He decides to draw it using the following algorithm:  Step 0: Draws the first vertex (vertex 1). Go to step 1.  Step 1: For every edge in the input, in order: if the edge connects an already drawn vertex u to an undrawn vertex v, he will draw the undrawn vertex v and the edge. After checking every edge, go to step 2.  Step 2: If all the vertices are drawn, terminate the algorithm. Else, go to step 1. The number of readings is defined as the number of times Copil Copac performs step 1.Find the number of readings needed by Copil Copac to draw the tree." 1400
1829H "Don\'t Blame Me" bitmasks,combinatorics,dp,math "Sadly, the problem setter couldn\'t think of an interesting story, thus he just asks you to solve the following problem.Given an array a consisting of n positive integers, count the number of non-empty subsequences for which the bitwise AND of the elements in the subsequence has exactly k set bits in its binary representation. The answer may be large, so output it modulo 109+7.Recall that the subsequence of an array a is a sequence that can be obtained from a by removing some (possibly, zero) elements. For example, [1,2,3], [3], [1,3] are subsequences of [1,2,3], but [3,2] and [4,5,6] are not.Note that AND represents the bitwise AND operation." 1700
1829G "Hits Different" "data structures,dp,implementation,math" "In a carnival game, there is a huge pyramid of cans with 2023 rows, numbered in a regular pattern as shown. If can 92 is hit initially, then all cans colored red in the picture above would fall. You throw a ball at the pyramid, and it hits a single can with number n2. This causes all cans that are stacked on top of this can to fall (that is, can n2 falls, then the cans directly above n2 fall, then the cans directly above those cans, and so on). For example, the picture above shows the cans that would fall if can 92 is hit.What is the sum of the numbers on all cans that fall? Recall that n2=n\xc3\x97n." 1600
1829F "Forever Winter" "dfs and similar,graphs,math" "A snowflake graph is generated from two integers x and y, both greater than 1, as follows:   Start with one central vertex.  Connect x new vertices to this central vertex.  Connect y new vertices to each of these x vertices.  For example, below is a snowflake graph for x=5 and y=3.  The snowflake graph above has a central vertex 15, then x=5 vertices attached to it (3, 6, 7, 8, and 20), and then y=3 vertices attached to each of those.  Given a snowflake graph, determine the values of x and y." 1300
1829E "The Lakes" "dfs and similar,dsu,graphs,implementation" "You are given an n\xc3\x97m grid a of non-negative integers. The value ai,j represents the depth of water at the i-th row and j-th column. A lake is a set of cells such that:  each cell in the set has ai,j>0, and  there exists a path between any pair of cells in the lake by going up, down, left, or right a number of times and without stepping on a cell with ai,j=0. The volume of a lake is the sum of depths of all the cells in the lake.Find the largest volume of a lake in the grid." 1100
1829D "Gold Rush" "brute force,dfs and similar,dp,implementation" "Initially you have a single pile with n gold nuggets. In an operation you can do the following:   Take any pile and split it into two piles, so that one of the resulting piles has exactly twice as many gold nuggets as the other. (All piles should have an integer number of nuggets.)   One possible move is to take a pile of size 6 and split it into piles of sizes 2 and 4, which is valid since 4 is twice as large as 2.  Can you make a pile with exactly m gold nuggets using zero or more operations?" 1000
1829C "Mr. Perfectly Fine" bitmasks,greedy,implementation "Victor wants to become ""Mr. Perfectly Fine"". For that, he needs to acquire a certain set of skills. More precisely, he has 2 skills he needs to acquire. Victor has n books. Reading book i takes him mi minutes and will give him some (possibly none) of the required two skills, represented by a binary string of length 2.What is the minimum amount of time required so that Victor acquires all of the two skills?" 800
1829B "Blank Space" implementation "You are given a binary array a of n elements, a binary array is an array consisting only of 0s and 1s. A blank space is a segment of consecutive elements consisting of only 0s. Your task is to find the length of the longest blank space." 800
1829A "Love Story" implementation,strings "Timur loves codeforces. That\'s why he has a string s having length 10 made containing only lowercase Latin letters. Timur wants to know how many indices string s differs from the string ""codeforces"".For example string s= ""coolforsez"" differs from ""codeforces"" in 4 indices, shown in bold.Help Timur by finding the number of indices where string s differs from ""codeforces"".Note that you can\'t reorder the characters in the string s." 800
1828B "Permutation Swap" "math,number theory" "You are given an unsorted permutation p1,p2,\xe2\x80\xa6,pn. To sort the permutation, you choose a constant k (k\xe2\x89\xa51) and do some operations on the permutation. In one operation, you can choose two integers i, j (1\xe2\x89\xa4j<i\xe2\x89\xa4n) such that i\xe2\x88\x92j=k, then swap pi and pj.What is the maximum value of k that you can choose to sort the given permutation?A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).An unsorted permutation p is a permutation such that there is at least one position i that satisfies pi\xe2\x89\xa0i." 900
1828A "Divisible Array" "constructive algorithms,math" "You are given a positive integer n. Please find an array a1,a2,\xe2\x80\xa6,an that is perfect.A perfect array a1,a2,\xe2\x80\xa6,an satisfies the following criteria:   1\xe2\x89\xa4ai\xe2\x89\xa41000 for all 1\xe2\x89\xa4i\xe2\x89\xa4n.  ai is divisible by i for all 1\xe2\x89\xa4i\xe2\x89\xa4n.  a1+a2+\xe2\x80\xa6+an is divisible by n." 800
1827F "Copium Permutation" "constructive algorithms,data structures,greedy" "You are given a permutation a1,a2,\xe2\x80\xa6,an of the first n positive integers. A subarray [l,r] is called copium if we can rearrange it so that it becomes a sequence of consecutive integers, or more formally, if max(al,al+1,\xe2\x80\xa6,ar)\xe2\x88\x92min(al,al+1,\xe2\x80\xa6,ar)=r\xe2\x88\x92l For each k in the range [0,n], print out the maximum number of copium subarrays of a over all ways of rearranging the last n\xe2\x88\x92k elements of a." 3500
1827E "Bus Routes" "binary search,constructive algorithms,dfs and similar,greedy,trees" "There is a country consisting of n cities and n\xe2\x88\x921 bidirectional roads connecting them such that we can travel between any two cities using these roads. In other words, these cities and roads form a tree.There are m bus routes connecting the cities together. A bus route between city x and city y allows you to travel between any two cities in the simple path between x and y with this route.Determine if for every pair of cities u and v, you can travel from u to v using at most two bus routes." 3400
1827D "Two Centroids" "data structures,dfs and similar,greedy,trees" "You are given a tree (an undirected connected acyclic graph) which initially only contains vertex 1. There will be several queries to the given tree. In the i-th query, vertex i+1 will appear and be connected to vertex pi (1\xe2\x89\xa4pi\xe2\x89\xa4i). After each query, please find out the least number of operations required to make the current tree has two centroids. In one operation, you can add one vertex and one edge to the tree such that it remains a tree.A vertex is called a centroid if its removal splits the tree into subtrees with at most \xe2\x8c\x8an2\xe2\x8c\x8b vertices each, with n as the number of vertices of the tree. For example, the centroid of the following tree is 3 because the biggest subtree after removing the centroid has 2 vertices.  In the next tree, vertex 1 and 2 are both centroids." 2800
1827C "Palindrome Partition" "binary search,brute force,data structures,dp,hashing,strings" "A substring is a continuous and non-empty segment of letters from a given string, without any reorders.An even palindrome is a string that reads the same backward as forward and has an even length. For example, strings ""zz"", ""abba"", ""abccba"" are even palindromes, but strings ""codeforces"", ""reality"", ""aba"", ""c"" are not.A beautiful string is an even palindrome or a string that can be partitioned into some smaller even palindromes.You are given a string s, consisting of n lowercase Latin letters. Count the number of beautiful substrings of s." 2600
1827B2 "Range Sorting (Hard Version)" "binary search,data structures,dp,greedy" "The only difference between this problem and the easy version is the constraints on t and n.You are given an array a, consisting of n distinct integers a1,a2,\xe2\x80\xa6,an. Define the beauty of an array p1,p2,\xe2\x80\xa6pk as the minimum amount of time needed to sort this array using an arbitrary number of range-sort operations. In each range-sort operation, you will do the following:   Choose two integers l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4k).  Sort the subarray pl,pl+1,\xe2\x80\xa6,pr in r\xe2\x88\x92l seconds. Please calculate the sum of beauty over all subarrays of array a.A subarray of an array is defined as a sequence of consecutive elements of the array." 2400
1827B1 "Range Sorting (Easy Version)" "binary search,dp,dsu,greedy,trees,two pointers" "The only difference between this problem and the hard version is the constraints on t and n.You are given an array a, consisting of n distinct integers a1,a2,\xe2\x80\xa6,an. Define the beauty of an array p1,p2,\xe2\x80\xa6pk as the minimum amount of time needed to sort this array using an arbitrary number of range-sort operations. In each range-sort operation, you will do the following:   Choose two integers l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4k).  Sort the subarray pl,pl+1,\xe2\x80\xa6,pr in r\xe2\x88\x92l seconds. Please calculate the sum of beauty over all subarrays of array a.A subarray of an array is defined as a sequence of consecutive elements of the array." 2000
1827A "Counting Orders" "combinatorics,math,sortings,two pointers" "You are given two arrays a and b each consisting of n integers. All elements of a are pairwise distinct.Find the number of ways to reorder a such that ai>bi for all 1\xe2\x89\xa4i\xe2\x89\xa4n, modulo 109+7.Two ways of reordering are considered different if the resulting arrays are different." 1100
1826F "Fading into Fog" geometry,interactive,math,probabilities "This is an interactive problem.There are n distinct hidden points with real coordinates on a two-dimensional Euclidean plane. In one query, you can ask some line ax+by+c=0 and get the projections of all n points to this line in some order. The given projections are not exact, please read the interaction section for more clarity.Using the minimum number of queries, guess all n points and output them in some order. Here minimality means the minimum number of queries required to solve any possible test case with n points.The hidden points are fixed in advance and do not change throughout the interaction. In other words, the interactor is not adaptive.A projection of point A to line ax+by+c=0 is the point on the line closest to A." 2800
1826E "Walk the Runway" "bitmasks,brute force,data structures,dp,graphs,implementation,sortings" "A fashion tour consists of m identical runway shows in different cities. There are n models willing to participate in the tour, numbered from 1 to n. People in different cities have different views on the fashion industry, so they rate each model differently. In particular, people in city i rate model j with rating ri,j.You are to choose some number of k models, and their order, let the chosen models have indices j1,j2,\xe2\x80\xa6,jk in the chosen order. In each city, these k models will walk the runway one after another in this order. To make the show exciting, in each city, the ratings of models should be strictly increasing in the order of their performance. More formally, for any city i and index t (2\xe2\x89\xa4t\xe2\x89\xa4k), the ratings must satisfy ri,jt\xe2\x88\x921<ri,jt. After all, the fashion industry is all about money, so choosing model j to participate in the tour profits you pj money. Compute the maximum total profit you can make by choosing the models and their order while satisfying all the requirements." 2400
1826D "Running Miles" "brute force,dp,greedy" "There is a street with n sights, with sight number i being i miles from the beginning of the street. Sight number i has beauty bi. You want to start your morning jog l miles and end it r miles from the beginning of the street. By the time you run, you will see sights you run by (including sights at l and r miles from the start). You are interested in the 3 most beautiful sights along your jog, but every mile you run, you get more and more tired.So choose l and r, such that there are at least 3 sights you run by, and the sum of beauties of the 3 most beautiful sights minus the distance in miles you have to run is maximized. More formally, choose l and r, such that bi1+bi2+bi3\xe2\x88\x92(r\xe2\x88\x92l) is maximum possible, where i1,i2,i3 are the indices of the three maximum elements in range [l,r]." 1700
1826C "Dreaming of Freedom" "greedy,math,number theory" "Because to take away a man\'s freedom of choice, even his freedom to make the wrong choice, is to manipulate him as though he were a puppet and not a person.\xe2\x80\x94 Madeleine L\'EngleThere are n programmers choosing their favorite algorithm amongst m different choice options. Before the first round, all m options are available. In each round, every programmer makes a vote for one of the remaining algorithms. After the round, only the algorithms with the maximum number of votes remain. The voting process ends when there is only one option left. Determine whether the voting process can continue indefinitely or no matter how people vote, they will eventually choose a single option after some finite amount of rounds?" 1300
1826B "Lunatic Never Content" "math,number theory" "You have an array a of n non-negative integers. Let\'s define f(a,x)=[a1modx,a2modx,\xe2\x80\xa6,anmodx] for some positive integer x. Find the biggest x, such that f(a,x) is a palindrome.Here, amodx is the remainder of the integer division of a by x.An array is a palindrome if it reads the same backward as forward. More formally, an array a of length n is a palindrome if for every i (1\xe2\x89\xa4i\xe2\x89\xa4n) ai=an\xe2\x88\x92i+1." 1100
1826A "Trust Nobody" "brute force,greedy,implementation,sortings" "There is a group of n people. Some of them might be liars, who always tell lies. Other people always tell the truth. The i-th person says ""There are at least li liars amongst us"". Determine if what people are saying is contradictory, or if it is possible. If it is possible, output the number of liars in the group. If there are multiple possible answers, output any one of them." 1200
1825B "LuoTianyi and the Table" greedy,math "LuoTianyi gave an array b of n\xe2\x8b\x85m integers. She asks you to construct a table a of size n\xc3\x97m, filled with these n\xe2\x8b\x85m numbers, and each element of the array must be used exactly once. Also she asked you to maximize the following value: n\xe2\x88\x91i=1m\xe2\x88\x91j=1(max1\xe2\x89\xa4x\xe2\x89\xa4i,1\xe2\x89\xa4y\xe2\x89\xa4jax,y\xe2\x88\x92min1\xe2\x89\xa4x\xe2\x89\xa4i,1\xe2\x89\xa4y\xe2\x89\xa4jax,y) This means that we consider n\xe2\x8b\x85m subtables with the upper left corner in (1,1) and the bottom right corner in (i,j) (1\xe2\x89\xa4i\xe2\x89\xa4n, 1\xe2\x89\xa4j\xe2\x89\xa4m), for each such subtable calculate the difference of the maximum and minimum elements in it, then sum up all these differences. You should maximize the resulting sum.Help her find the maximal possible value, you don\'t need to reconstruct the table itself." 1000
1825A "LuoTianyi and the Palindrome String" greedy,strings "LuoTianyi gives you a palindrome\xe2\x80\xa0 string s, and she wants you to find out the length of the longest non-empty subsequence\xe2\x80\xa1 of s which is not a palindrome string. If there is no such subsequence, output \xe2\x88\x921 instead.\xe2\x80\xa0 A palindrome is a string that reads the same backward as forward. For example, strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, but strings ""codeforces"", ""reality"", ""ab"" are not.\xe2\x80\xa1 A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from b. For example, strings ""a"", ""aaa"", ""bab"" are subsequences of string ""abaab"", but strings ""codeforces"", ""bbb"", ""h"" are not." 800
1824E "LuoTianyi and Cartridge" "data structures,trees" "LuoTianyi is watching the anime Made in Abyss. She finds that making a Cartridge is interesting. To describe the process of making a Cartridge more clearly, she abstracts the original problem and gives you the following problem.You are given a tree T consisting of n vertices. Each vertex has values ai and bi and each edge has values cj and dj.Now you are aim to build a tree T\xe2\x80\xb2 as follows:  First, select p vertices from T (p is a number chosen by yourself) as the vertex set S\xe2\x80\xb2 of T\xe2\x80\xb2.  Next, select p\xe2\x88\x921 edges from T one by one (you cannot select one edge more than once).  May you have chosen the j-th edge connects vertices xj and yj with values (cj,dj), then you can choose two vertices u and v in S\xe2\x80\xb2 that satisfy the edge (xj,yj) is contained in the simple path from u to v in T, and link u and v in T\xe2\x80\xb2 by the edge with values (cj,dj) (u and v shouldn\'t be contained in one connected component before in T\xe2\x80\xb2).   A tree with three vertices, min(A,C)=1,B+D=7, the cost is 7.   Selected vertices 2 and 3 as S\xe2\x80\xb2, used the edge (1,2) with cj=2 and dj=1 to link this vertices, now min(A,C)=2,B+D=4, the cost is 8. Let A be the minimum of values ai in T\xe2\x80\xb2 and C be the minimum of values ci in T\xe2\x80\xb2. Let B be the sum of bi in T\xe2\x80\xb2 and D be the sum of values di in T\xe2\x80\xb2. Let min(A,C)\xe2\x8b\x85(B+D) be the cost of T\xe2\x80\xb2. You need to find the maximum possible cost of T\xe2\x80\xb2." 3500
1824D "LuoTianyi and the Function" "data structures" "LuoTianyi gives you an array a of n integers and the index begins from 1.Define g(i,j) as follows:  g(i,j) is the largest integer x that satisfies {ap:i\xe2\x89\xa4p\xe2\x89\xa4j}\xe2\x8a\x86{aq:x\xe2\x89\xa4q\xe2\x89\xa4j} while i\xe2\x89\xa4j;  and g(i,j)=0 while i>j. There are q queries. For each query you are given four integers l,r,x,y, you need to calculate r\xe2\x88\x91i=ly\xe2\x88\x91j=xg(i,j)." 3000
1824C "LuoTianyi and XOR-Tree" "data structures,dfs and similar,dp,dsu,greedy,trees" "LuoTianyi gives you a tree with values in its vertices, and the root of the tree is vertex 11.In one operation, you can change the value in one vertex to any non-negative integer.Now you need to find the minimum number of operations you need to perform to make each path from the root to leaf\xe2\x80\xa0\xe2\x80\xa0 has a bitwise XOR value of zero.\xe2\x80\xa0\xe2\x80\xa0A leaf in a rooted tree is a vertex that has exactly one neighbor and is not a root." 2500
1824B2 "LuoTianyi and the Floating Islands (Hard Version)" "combinatorics,dfs and similar,math,probabilities,trees" "This is the hard version of the problem. The only difference is that in this version k\xe2\x89\xa4n. You can make hacks only if both versions of the problem are solved.   Chtholly and the floating islands. LuoTianyi now lives in a world with n floating islands. The floating islands are connected by n\xe2\x88\x921 undirected air routes, and any two of them can reach each other by passing the routes. That means, the n floating islands form a tree.One day, LuoTianyi wants to meet her friends: Chtholly, Nephren, William, .... Totally, she wants to meet k people. She doesn\'t know the exact positions of them, but she knows that they are in pairwise distinct islands. She define an island is good if and only if the sum of the distances\xe2\x80\xa0 from it to the islands with k people is the minimal among all the n islands.Now, LuoTianyi wants to know that, if the k people are randomly set in k distinct of the n islands, then what is the expect number of the good islands? You just need to tell her the expect number modulo 109+7.\xe2\x80\xa0The distance between two islands is the minimum number of air routes you need to take to get from one island to the other." 2300
1824B1 "LuoTianyi and the Floating Islands (Easy Version)" combinatorics,math,probabilities,trees "This is the easy version of the problem. The only difference is that in this version k\xe2\x89\xa4min(n,3). You can make hacks only if both versions of the problem are solved.  Chtholly and the floating islands. LuoTianyi now lives in a world with n floating islands. The floating islands are connected by n\xe2\x88\x921 undirected air routes, and any two of them can reach each other by passing the routes. That means, the n floating islands form a tree.One day, LuoTianyi wants to meet her friends: Chtholly, Nephren, William, .... Totally, she wants to meet k people. She doesn\'t know the exact positions of them, but she knows that they are in pairwise distinct islands. She define an island is good if and only if the sum of the distances\xe2\x80\xa0 from it to the islands with k people is the minimal among all the n islands.Now, LuoTianyi wants to know that, if the k people are randomly set in k distinct of the n islands, then what is the expect number of the good islands? You just need to tell her the expect number modulo 109+7.\xe2\x80\xa0The distance between two islands is the minimum number of air routes you need to take to get from one island to the other." 1800
1824A "LuoTianyi and the Show" greedy,implementation "There are n people taking part in a show about VOCALOID. They will sit in the row of seats, numbered 1 to m from left to right.The n people come and sit in order. Each person occupies a seat in one of three ways:  Sit in the seat next to the left of the leftmost person who is already sitting, or if seat 1 is taken, then leave the show. If there is no one currently sitting, sit in seat m. Sit in the seat next to the right of the rightmost person who is already sitting, or if seat m is taken, then leave the show. If there is no one currently sitting, sit in seat 1. Sit in the seat numbered xi. If this seat is taken, then leave the show. Now you want to know what is the maximum number of people that can take a seat, if you can let people into the show in any order?" 1400
1823F "Random Walk" dp,graphs,math,probabilities,trees "You are given a tree consisting of n vertices and n\xe2\x88\x921 edges, and each vertex v has a counter c(v) assigned to it.Initially, there is a chip placed at vertex s and all counters, except c(s), are set to 0; c(s) is set to 1.Your goal is to place the chip at vertex t. You can achieve it by a series of moves. Suppose right now the chip is placed at the vertex v. In one move, you do the following:  choose one of neighbors to of vertex v uniformly at random (to is neighbor of v if and only if there is an edge {v,to} in the tree);  move the chip to vertex to and increase c(to) by 1; You\'ll repeat the move above until you reach the vertex t.For each vertex v calculate the expected value of c(v) modulo 998244353." 2600
1823E "Removing Graph" "brute force,dp,games,graphs,math" "Alice and Bob are playing a game on a graph. They have an undirected graph without self-loops and multiple edges. All vertices of the graph have degree equal to 2. The graph may consist of several components. Note that if such graph has n vertices, it will have exactly n edges.Alice and Bob take turn. Alice goes first. In each turn, the player can choose k (l\xe2\x89\xa4k\xe2\x89\xa4r; l<r) vertices that form a connected subgraph and erase these vertices from the graph, including all incident edges.The player who can\'t make a step loses.For example, suppose they are playing on the given graph with given l=2 and r=3:  A valid vertex set for Alice to choose at the first move is one of the following:   {1,2}  {1,3}  {2,3}  {4,5}  {4,6}  {5,6}  {1,2,3}  {4,5,6}  Suppose, Alice chooses subgraph {4,6}.Then a valid vertex set for Bob to choose at the first move is one of the following:   {1,2}  {1,3}  {2,3}  {1,2,3}  Suppose, Bob chooses subgraph {1,2,3}.Alice can\'t make a move, so she loses.You are given a graph of size n and integers l and r. Who will win if both Alice and Bob play optimally." 2500
1823D "Unique Palindromes" "constructive algorithms,math,strings" "A palindrome is a string that reads the same backwards as forwards. For example, the string abcba is palindrome, while the string abca is not.Let p(t) be the number of unique palindromic substrings of string t, i. e. the number of substrings t[l\xe2\x80\xa6r] that are palindromes themselves. Even if some substring occurs in t several times, it\'s counted exactly once. (The whole string t is also counted as a substring of t).For example, string t = abcbbcabcb has p(t)=6 unique palindromic substrings: a, b, c, bb, bcb and cbbc.Now, let\'s define p(s,m)=p(t) where t=s[1\xe2\x80\xa6m]. In other words, p(s,m) is the number of palindromic substrings in the prefix of s of length m. For example, p(abcbbcabcb,5) = p(abcbb)=5.You are given an integer n and k ""conditions"" (k\xe2\x89\xa420). Let\'s say that string s, consisting of n lowercase Latin letters, is good if all k conditions are satisfied at the same time. A condition is a pair (xi,ci) and have the following meaning:   p(s,xi)=ci, i. e. a prefix of s of length xi contains exactly ci unique palindromic substrings.  Find a good string s or report that such s doesn\'t exist.Look in Notes if you need further clarifications." 1900
1823C "Strongly Composite" "greedy,math,number theory" "A prime number is an integer greater than 1, which has exactly two divisors. For example, 7 is a prime, since it has two divisors {1,7}. A composite number is an integer greater than 1, which has more than two different divisors.Note that the integer 1 is neither prime nor composite.Let\'s look at some composite number v. It has several divisors: some divisors are prime, others are composite themselves. If the number of prime divisors of v is less or equal to the number of composite divisors, let\'s name v as strongly composite.For example, number 12 has 6 divisors: {1,2,3,4,6,12}, two divisors 2 and 3 are prime, while three divisors 4, 6 and 12 are composite. So, 12 is strongly composite. Other examples of strongly composite numbers are 4, 8, 9, 16 and so on.On the other side, divisors of 15 are {1,3,5,15}: 3 and 5 are prime, 15 is composite. So, 15 is not a strongly composite. Other examples are: 2, 3, 5, 6, 7, 10 and so on.You are given n integers a1,a2,\xe2\x80\xa6,an (ai>1). You have to build an array b1,b2,\xe2\x80\xa6,bk such that following conditions are satisfied:   Product of all elements of array a is equal to product of all elements of array b: a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85an=b1\xe2\x8b\x85b2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85bk;  All elements of array b are integers greater than 1 and strongly composite;  The size k of array b is the maximum possible. Find the size k of array b, or report, that there is no array b satisfying the conditions." 1300
1823B "Sort with Step" "brute force,math,sortings" "Let\'s define a permutation of length n as an array p of length n, which contains every number from 1 to n exactly once.You are given a permutation p1,p2,\xe2\x80\xa6,pn and a number k. You need to sort this permutation in the ascending order. In order to do it, you can repeat the following operation any number of times (possibly, zero):   pick two elements of the permutation pi and pj such that |i\xe2\x88\x92j|=k, and swap them. Unfortunately, some permutations can\'t be sorted with some fixed numbers k. For example, it\'s impossible to sort [2,4,3,1] with k=2.That\'s why, before starting the sorting, you can make at most one preliminary exchange:   choose any pair pi and pj and swap them. Your task is to:   check whether is it possible to sort the permutation without any preliminary exchanges,  if it\'s not, check, whether is it possible to sort the permutation using exactly one preliminary exchange. For example, if k=2 and permutation is [2,4,3,1], then you can make a preliminary exchange of p1 and p4, which will produce permutation [1,4,3,2], which is possible to sort with given k." 900
1823A A-characteristic "combinatorics,constructive algorithms,math" "Consider an array a1,a2,\xe2\x80\xa6,an consisting of numbers 1 and \xe2\x88\x921. Define A-characteristic of this array as a number of pairs of indices 1\xe2\x89\xa4i<j\xe2\x89\xa4n, such that ai\xe2\x8b\x85aj=1.Find any array a with given length n with A-characteristic equal to the given value k." 800
1822G2 "Magic Triples (Hard Version)" "brute force,data structures,math,number theory" "This is the hard version of the problem. The only difference is that in this version, ai\xe2\x89\xa4109.For a given sequence of n integers a, a triple (i,j,k) is called magic if:   1\xe2\x89\xa4i,j,k\xe2\x89\xa4n.  i, j, k are pairwise distinct.  there exists a positive integer b such that ai\xe2\x8b\x85b=aj and aj\xe2\x8b\x85b=ak. Kolya received a sequence of integers a as a gift and now wants to count the number of magic triples for it. Help him with this task!Note that there are no constraints on the order of integers i, j and k." 2200
1822G1 "Magic Triples (Easy Version)" "brute force,data structures,math,number theory" "This is the easy version of the problem. The only difference is that in this version, ai\xe2\x89\xa4106.For a given sequence of n integers a, a triple (i,j,k) is called magic if:   1\xe2\x89\xa4i,j,k\xe2\x89\xa4n.  i, j, k are pairwise distinct.  there exists a positive integer b such that ai\xe2\x8b\x85b=aj and aj\xe2\x8b\x85b=ak. Kolya received a sequence of integers a as a gift and now wants to count the number of magic triples for it. Help him with this task!Note that there are no constraints on the order of integers i, j and k." 1700
1822F "Gardening Friends" "brute force,dfs and similar,dp,graphs,trees" "Two friends, Alisa and Yuki, planted a tree with n vertices in their garden. A tree is an undirected graph without cycles, loops, or multiple edges. Each edge in this tree has a length of k. Initially, vertex 1 is the root of the tree.Alisa and Yuki are growing the tree not just for fun, they want to sell it. The cost of the tree is defined as the maximum distance from the root to a vertex among all vertices of the tree. The distance between two vertices u and v is the sum of the lengths of the edges on the path from u to v.The girls took a course in gardening, so they know how to modify the tree. Alisa and Yuki can spend c coins to shift the root of the tree to one of the neighbors of the current root. This operation can be performed any number of times (possibly zero). Note that the structure of the tree is left unchanged; the only change is which vertex is the root.The friends want to sell the tree with the maximum profit. The profit is defined as the difference between the cost of the tree and the total cost of operations. The profit is cost of the tree minus the total cost of operations.Help the girls and find the maximum profit they can get by applying operations to the tree any number of times (possibly zero)." 1700
1822E "Making Anti-Palindromes" greedy,math,strings "You are given a string s, consisting of lowercase English letters. In one operation, you are allowed to swap any two characters of the string s.A string s of length n is called an anti-palindrome, if s[i]\xe2\x89\xa0s[n\xe2\x88\x92i+1] for every i (1\xe2\x89\xa4i\xe2\x89\xa4n). For example, the strings ""codeforces"", ""string"" are anti-palindromes, but the strings ""abacaba"", ""abc"", ""test"" are not.Determine the minimum number of operations required to make the string s an anti-palindrome, or output \xe2\x88\x921, if this is not possible." 1600
1822D Super-Permutation "constructive algorithms,math" "A permutation is a sequence n integers, where each integer from 1 to n appears exactly once. For example, [1], [3,5,2,1,4], [1,3,2] are permutations, while [2,3,2], [4,3,1], [0] are not.Given a permutation a, we construct an array b, where bi=(a1+a2+ \xe2\x80\xa6 +ai)modn.A permutation of numbers [a1,a2,\xe2\x80\xa6,an] is called a super-permutation if [b1+1,b2+1,\xe2\x80\xa6,bn+1] is also a permutation of length n.Grisha became interested whether a super-permutation of length n exists. Help him solve this non-trivial problem. Output any super-permutation of length n, if it exists. Otherwise, output \xe2\x88\x921." 1200
1822C "Bun Lover" math "Tema loves cinnabon rolls \xe2\x80\x94 buns with cinnabon and chocolate in the shape of a ""snail"".Cinnabon rolls come in different sizes and are square when viewed from above. The most delicious part of a roll is the chocolate, which is poured in a thin layer over the cinnabon roll in the form of a spiral and around the bun, as in the following picture:  Cinnabon rolls of sizes 4, 5, 6 For a cinnabon roll of size n, the length of the outer side of the square is n, and the length of the shortest vertical chocolate segment in the central part is one.Formally, the bun consists of two dough spirals separated by chocolate. A cinnabon roll of size n+1 is obtained from a cinnabon roll of size n by wrapping each of the dough spirals around the cinnabon roll for another layer.It is important that a cinnabon roll of size n is defined in a unique way.Tema is interested in how much chocolate is in his cinnabon roll of size n. Since Tema has long stopped buying small cinnabon rolls, it is guaranteed that n\xe2\x89\xa54.Answer this non-obvious question by calculating the total length of the chocolate layer." 800
1822B "Karina and Array" greedy,math,sortings "Karina has an array of n integers a1,a2,a3,\xe2\x80\xa6,an. She loves multiplying numbers, so she decided that the beauty of a pair of numbers is their product. And the beauty of an array is the maximum beauty of a pair of adjacent elements in the array.For example, for n=4, a=[3,5,7,4], the beauty of the array is max(3\xe2\x8b\x855, 5\xe2\x8b\x857, 7\xe2\x8b\x854) = max(15, 35, 28) = 35.Karina wants her array to be as beautiful as possible. In order to achieve her goal, she can remove some elements (possibly zero) from the array. After Karina removes all elements she wants to, the array must contain at least two elements.Unfortunately, Karina doesn\'t have enough time to do all her tasks, so she asks you to calculate the maximum beauty of the array that she can get by removing any number of elements (possibly zero)." 800
1822A "TubeTube Feed" "brute force,implementation" "Mushroom Filippov cooked himself a meal and while having his lunch, he decided to watch a video on TubeTube. He can not spend more than t seconds for lunch, so he asks you for help with the selection of video.The TubeTube feed is a list of n videos, indexed from 1 to n. The i-th video lasts ai seconds and has an entertainment value bi. Initially, the feed is opened on the first video, and Mushroom can skip to the next video in 1 second (if the next video exists). Mushroom can skip videos any number of times (including zero).Help Mushroom choose one video that he can open and watch in t seconds. If there are several of them, he wants to choose the most entertaining one. Print the index of any appropriate video, or \xe2\x88\x921 if there is no such." 800
1821F Timber combinatorics,dp,fft,math "There is a beautiful alley with trees in front of a shopping mall. Unfortunately, it has to go to make space for the parking lot.The trees on the alley all grow in a single line. There are n spots for trees, index 0 is the shopping mall, index n+1 is the road and indices from 1 to n are the spots for trees. Some of them are taken \xe2\x80\x94 there grow trees of the same height k. No more than one tree grows in each spot.When you chop down a tree in the spot x, you can make it fall either left or right. If it falls to the left, it takes up spots from x\xe2\x88\x92k to x, inclusive. If it falls to the right, it takes up spots from x to x+k, inclusive.Let m trees on the alley grow in some spots x1,x2,\xe2\x80\xa6,xm. Let an alley be called unfortunate if all m trees can be chopped down in such a way that:   no tree falls on the shopping mall or the road;  each spot is taken up by no more than one fallen tree. Calculate the number of different unfortunate alleys with m trees of height k. Two alleys are considered different if there is a spot y such that a tree grows in y on the first alley and doesn\'t grow in y on the second alley.Output the number modulo 998244353." 2600
1821E "Rearrange Brackets" "brute force,dp,greedy,sortings,strings" "A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example:  bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  bracket sequences "")("", ""("" and "")"" are not. You are given a regular bracket sequence. In one move, you can remove a pair of adjacent brackets such that the left one is an opening bracket and the right one is a closing bracket. Then concatenate the resulting parts without changing the order. The cost of this move is the number of brackets to the right of the right bracket of this pair.The cost of the regular bracket sequence is the smallest total cost of the moves required to make the sequence empty.Actually, you are not removing any brackets. Instead, you are given a regular bracket sequence and an integer k. You can perform the following operation at most k times:   extract some bracket from the sequence and insert it back at any position (between any two brackets, at the start or at the end; possibly, at the same place it was before). After all operations are performed, the bracket sequence has to be regular. What is the smallest possible cost of the resulting regular bracket sequence?" 2100
1821D "Black Cells" "binary search,brute force,greedy,math" "You are playing with a really long strip consisting of 1018 white cells, numbered from left to right as 0, 1, 2 and so on. You are controlling a special pointer that is initially in cell 0. Also, you have a ""Shift"" button you can press and hold.In one move, you can do one of three actions:   move the pointer to the right (from cell x to cell x+1);  press and hold the ""Shift"" button;  release the ""Shift"" button: the moment you release ""Shift"", all cells that were visited while ""Shift"" was pressed are colored in black.  (Of course, you can\'t press Shift if you already hold it. Similarly, you can\'t release Shift if you haven\'t pressed it.)Your goal is to color at least k cells, but there is a restriction: you are given n segments [li,ri] \xe2\x80\x94 you can color cells only inside these segments, i. e. you can color the cell x if and only if li\xe2\x89\xa4x\xe2\x89\xa4ri for some i.What is the minimum number of moves you need to make in order to color at least k cells black?" 1900
1821C "Tear It Apart" "brute force,implementation,math,strings" "You are given a string s, consisting of lowercase Latin letters.In one operation, you can select several (one or more) positions in it such that no two selected positions are adjacent to each other. Then you remove the letters on the selected positions from the string. The resulting parts are concatenated without changing their order.What is the smallest number of operations required to make all the letters in s the same?" 1300
1821B "Sort the Subarray" "brute force,greedy" "Monocarp had an array a consisting of n integers. He has decided to choose two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and then sort the subarray a[l..r] (the subarray a[l..r] is the part of the array a containing the elements al,al+1,al+2,\xe2\x80\xa6,ar\xe2\x88\x921,ar) in non-descending order. After sorting the subarray, Monocarp has obtained a new array, which we denote as a\xe2\x80\xb2.For example, if a=[6,7,3,4,4,6,5], and Monocarp has chosen l=2,r=5, then a\xe2\x80\xb2=[6,3,4,4,7,6,5].You are given the arrays a and a\xe2\x80\xb2. Find the integers l and r that Monocarp could have chosen. If there are multiple pairs of values (l,r), find the one which corresponds to the longest subarray." 1100
1821A Matching combinatorics,math "An integer template is a string consisting of digits and/or question marks.A positive (strictly greater than 0) integer matches the integer template if it is possible to replace every question mark in the template with a digit in such a way that we get the decimal representation of that integer without any leading zeroes.For example:  42 matches 4?;  1337 matches ????;  1337 matches 1?3?;  1337 matches 1337;  3 does not match ??;  8 does not match ???8;  1337 does not match 1?7. You are given an integer template consisting of at most 5 characters. Calculate the number of positive (strictly greater than 0) integers that match it." 800
1820B "JoJo\'s Incredible Adventures" "math,strings,two pointers" "Did you think there was going to be a JoJo legend here? But no, that was me, Dio!Given a binary string s of length n, consisting of characters 0 and 1. Let\'s build a square table of size n\xc3\x97n, consisting of 0 and 1 characters as follows.In the first row of the table write the original string s. In the second row of the table write cyclic shift of the string s by one to the right. In the third row of the table, write the cyclic shift of line s by two to the right. And so on. Thus, the row with number k will contain a cyclic shift of string s by k to the right. The rows are numbered from 0 to n\xe2\x88\x921 top-to-bottom.In the resulting table we need to find the rectangle consisting only of ones that has the largest area.We call a rectangle the set of all cells (i,j) in the table, such that x1\xe2\x89\xa4i\xe2\x89\xa4x2 and y1\xe2\x89\xa4j\xe2\x89\xa4y2 for some integers 0\xe2\x89\xa4x1\xe2\x89\xa4x2<n and 0\xe2\x89\xa4y1\xe2\x89\xa4y2<n.Recall that the cyclic shift of string s by k to the right is the string sn\xe2\x88\x92k+1\xe2\x80\xa6sns1s2\xe2\x80\xa6sn\xe2\x88\x92k. For example, the cyclic shift of the string ""01011"" by 0 to the right is the string itself ""01011"", its cyclic shift by 3 to the right is the string ""01101""." 1100
1820A "Yura\'s New Name" implementation,strings "After holding one team contest, boy Yura got very tired and wanted to change his life and move to Japan. In honor of such a change, Yura changed his name to something nice.Fascinated by this idea he already thought up a name s consisting only of characters ""_"" and ""^"". But there\'s a problem \xe2\x80\x94 Yura likes smiley faces ""^_^"" and ""^^"". Therefore any character of the name must be a part of at least one such smiley. Note that only the consecutive characters of the name can be a smiley face.More formally, consider all occurrences of the strings ""^_^"" and ""^^"" in the string s. Then all such occurrences must cover the whole string s, possibly with intersections. For example, in the string ""^^__^_^^__^"" the characters at positions 3,4,9,10 and 11 are not contained inside any smileys, and the other characters at positions 1,2,5,6,7 and 8 are contained inside smileys.In one operation Jura can insert one of the characters ""_"" and ""^"" into his name s (you can insert it at any position in the string). He asks you to tell him the minimum number of operations you need to do to make the name fit Yura\'s criteria." 800
1819F "Willy-nilly, Crack, Into Release!" "data structures,dp" "You have long dreamed of working in a large IT company and finally got a job there. You have studied all existing modern technologies for a long time and are ready to apply all your knowledge in practice. But then you sit down at your desk and see a sheet of paper with the company\'s motto printed in large letters: abcdabcdabcdabcd....The company\'s motto contains four main principles\xe2\x80\x94 a (Willi), b (Nilli), c (Crack), d (Release). Therefore, you consider strings of length n consisting of these four Latin letters. Unordered pairs of letters ""ab"", ""bc"", ""cd"", and ""da"" in this motto are adjacent, so we will call such pairs of symbols good. So, if you are given a string s of length n, and it is known that the unordered pair of symbols {x,y} is good, then you can perform one of the following operations on the string:  if sn=x, then you are allowed to replace this symbol with y,  if there exists 1\xe2\x89\xa4i<n such that si=x and si+1=\xe2\x80\xa6=sn=y, then you are allowed to replace the i-th symbol of the string with y, and all subsequent symbols with x. For example, the string bacdd can be replaced with one of the strings bacda, bacdc, or badcc, and the string aac can be replaced with aab or aad.A non-empty sequence of operations for the string s will be called correct if the following two conditions are met:  after performing all operations, the string becomes s again,  no string, except for s, will occur more than once during the operations. At the same time, the string s can occur exactly twice - before the start of the operations and after performing all operations. Now we are ready to move on to the problem statement! You have a set of strings that is initially empty. Then, each of q queries adds another string ti to the set, or removes the string ti from the set. After each query, you need to output the minimum and maximum size of a correct sequence of operations in which each word occurs at least once. The choice of the initial string s is up to you." 3500
1819E "Roads in E City" interactive,math,probabilities,trees "This is an interactive problem.As is well known, the city ""E"" has never had its roads repaired in its a thousand and a half years old history. And only recently the city administration repaired some of them.It is known that in total in the city ""E"" there are n intersections and m roads, which can be used in both directions, numbered with integers from 1 to m. The i-th road connects intersections with numbers ai and bi.Among all m roads, some subset of the roads has been repaired, but you do not know which one. The only information you could get from the city\'s road services is that you can get from any intersection to any other intersection by driving only on the roads that have been repaired.You are a young entrepreneur, and decided to organize a delivery service of fresh raw meat in the city ""E"" (in this city such meat is called ""steaks"", it is very popular among the locals). You have already recruited a staff of couriers, but the couriers are willing to travel only on repaired roads. Now you have to find out which roads have already been repaired.The city administration has given you the city for a period of time, so you can make different queries of one of three types:  Block the road with the number x. In this case, movement on the road for couriers will be forbidden. Initially all roads are unblocked. Unblock the road with the number x. In this case, couriers will be able to move on the road x if it is repaired. Try to deliver the order to the intersection with the number y. In this case, one of your couriers will start moving from intersection with number s you don\'t know and deliver the order to intersection with number y if there is a path on unblocked repaired roads from intersection s to intersection y. It is guaranteed that intersection s will be chosen beforehand. Unfortunately, the city is placed at your complete disposal for a short period of time, so you can make no more than 100\xe2\x8b\x85m requests." 3200
1819D "Misha and Apples" "brute force,data structures,dp,two pointers" "Schoolboy Misha got tired of doing sports programming, so he decided to quit everything and go to the magical forest to sell magic apples.His friend Danya came to the magical forest to visit Misha. What was his surprise when he found out that Misha found a lot of friends there, the same former sports programmers. And all of them, like Misha, have their own shop where they sell magic apples. To support his friends, who have changed their lives so drastically, he decided to buy up their entire assortment.The buying process works as follows: in total there are n stalls, numbered with integers from 1 to n, and m kinds of magic apples, numbered with integers from 1 to m. Each shop sells some number of kinds of apples. Danya visits all the shops in order of increasing number, starting with the first one. Upon entering the shop he buys one magic apple of each kind sold in that shop and puts them in his backpack.However, magical apples wouldn\'t be magical if they were all right. The point is that when two apples of the same type end up together in the backpack, all of the apples in it magically disappear. Importantly, the disappearance happens after Danya has put the apples in the backpack and left the shop.Upon returning home, Danya realized that somewhere in the forest he had managed to lose his backpack. Unfortunately, for some shops Danya had forgotten what assortment of apples there was. Remembering only for some shops, what kinds of magical apples were sold in them, he wants to know what is the maximum number of apples he could have in his backpack after all his purchases at best." 2800
1819C "The Fox and the Complete Tree Traversal" "constructive algorithms,dp,implementation,math,trees" "The fox Yae climbed the tree of the Sacred Sakura. A tree is a connected undirected graph that does not contain cycles.The fox uses her magical powers to move around the tree. Yae can jump from vertex v to another vertex u if and only if the distance between these vertices does not exceed 2. In other words, in one jump Yae can jump from vertex v to vertex u if vertices v and u are connected by an edge, or if there exists such vertex w that vertices v and w are connected by an edge, and also vertices u and w are connected by an edge.After Yae was able to get the sakura petal, she wondered if there was a cyclic route in the tree v1,v2,\xe2\x80\xa6,vn such that:  the fox can jump from vertex vi to vertex vi+1,  the fox can jump from vertex vn to vertex v1,  all vi are pairwise distinct. Help the fox determine if the required traversal exists." 2400
1819B "The Butcher" "geometry,greedy,implementation,sortings,two pointers" "Anton plays his favorite game ""Defense of The Ancients 2"" for his favorite hero \xe2\x80\x94 The Butcher. Now he wants to make his own dinner. To do this he will take a rectangle of height h and width w, then make a vertical or horizontal cut so that both resulting parts have integer sides. After that, he will put one of the parts in the box and cut the other again, and so on.More formally, a rectangle of size h\xc3\x97w can be cut into two parts of sizes x\xc3\x97w and (h\xe2\x88\x92x)\xc3\x97w, where x is an integer from 1 to (h\xe2\x88\x921), or into two parts of sizes h\xc3\x97y and h\xc3\x97(w\xe2\x88\x92y), where y is an integer from 1 to (w\xe2\x88\x921).He will repeat this operation n\xe2\x88\x921 times, and then put the remaining rectangle into the box too. Thus, the box will contain n rectangles, of which n\xe2\x88\x921 rectangles were put in the box as a result of the cuts, and the n-th rectangle is the one that the Butcher has left after all n\xe2\x88\x921 cuts.Unfortunately, Butcher forgot the numbers h and w, but he still has n rectangles mixed in random order. Note that Butcher didn\'t rotate the rectangles, but only shuffled them. Now he wants to know all possible pairs (h,w) from which this set of rectangles can be obtained. And you have to help him do it!It is guaranteed that there exists at least one pair (h,w) from which this set of rectangles can be obtained." 1900
1819A "Constructive Problem" "brute force,greedy" "As you know, any problem that does not require the use of complex data structures is considered constructive. You are offered to solve one of such problems.You are given an array a of n non-negative integers. You are allowed to perform the following operation exactly once: choose some non-empty subsegment al,al+1,\xe2\x80\xa6,ar of the array a and a non-negative integer k, and assign value k to all elements of the array on the chosen subsegment.The task is to find out whether MEX(a) can be increased by exactly one by performing such an operation. In other words, if before the operation MEX(a)=m held, then after the operation it must hold that MEX(a)=m+1.Recall that MEX of a set of integers c1,c2,\xe2\x80\xa6,ck is defined as the smallest non-negative integer x which does not occur in the set c." 1300
1818B Indivisible "constructive algorithms" "You\'re given a positive integer n.Find a permutation a1,a2,\xe2\x80\xa6,an such that for any 1\xe2\x89\xa4l<r\xe2\x89\xa4n, the sum al+al+1+\xe2\x8b\xaf+ar is not divisible by r\xe2\x88\x92l+1.A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 900
1818A Politics greedy,implementation "In a debate club with n members, including yourself (member 1), there are k opinions to be discussed in sequence. During each discussion, members express their agreement or disagreement with the opinion. Let\'s define Y as the number of members who agree and N as the number of members who disagree. After each discussion, members leave the club based on the following criteria:  If more members agree than disagree (Y>N), all members who disagreed leave the club.  If more members disagree than agree (Y<N), all members who agreed leave the club.  If there is a tie (Y=N), all members leave the club. As the club president, your goal is to stay in the club and maximize the number of members remaining after the meeting. You have access to each member\'s stance on all k opinions before the meeting starts, and you can expel any number of members (excluding yourself) before the meeting begins.Determine the maximum number of members, including yourself, who can remain in the club after the meeting. You don\'t need to provide the specific expulsion strategy but only the maximum number of members that can stay. Ensure that you remain in the club after the meeting as well." 800
1817F "Entangled Substrings" "string suffix structures,strings" "Quantum entanglement is when two particles link together in a certain way no matter how far apart they are in space.You are given a string s. A pair of its non-empty substrings (a,b) is called entangled if there is a (possibly empty) link string c such that:  Every occurrence of a in s is immediately followed by cb;  Every occurrence of b in s is immediately preceded by ac. In other words, a and b occur in s only as substrings of acb. Compute the total number of entangled pairs of substrings of s.A string a is a substring of a string b if a can be obtained from b by the deletion of several (possibly zero or all) characters from the beginning and several (possibly zero or all) characters from the end." 3500
1817E Half-sum "brute force,divide and conquer,greedy" "You\'re given a multiset of non-negative integers {a1,a2,\xe2\x80\xa6,an}.In one step you take two elements x and y of the multiset, remove them and insert their mean value x+y2 back into the multiset.You repeat the step described above until you are left with only two numbers A and B. What is the maximum possible value of their absolute difference |A\xe2\x88\x92B|?Since the answer is not an integer number, output it modulo 109+7." 3400
1817D "Toy Machine" "constructive algorithms,games,implementation" "There is a toy machine with toys arranged in two rows of n cells each (n is odd).  Initial state for n=9. Initially, n\xe2\x88\x922 toys are placed in the non-corner cells of the top row. The bottom row is initially empty, and its leftmost, rightmost, and central cells are blocked. There are 4 buttons to control the toy machine: left, right, up, and down marked by the letters L, R, U, and D correspondingly.When pressing L, R, U, or D, all the toys will be moved simultaneously in the corresponding direction and will only stop if they push into another toy, the wall or a blocked cell. Your goal is to move the k-th toy into the leftmost cell of the top row. The toys are numbered from 1 to n\xe2\x88\x922 from left to right. Given n and k, find a solution that uses at most 1000000 button presses.To test out the toy machine, a web page is available that lets you play the game in real time." 2700
1817C "Similar Polynomials" combinatorics,math "A polynomial A(x) of degree d is an expression of the form A(x)=a0+a1x+a2x2+\xe2\x8b\xaf+adxd, where ai are integers, and ad\xe2\x89\xa00. Two polynomials A(x) and B(x) are called similar if there is an integer s such that for any integer x it holds thatB(x)\xe2\x89\xa1A(x+s)(mod109+7).For two similar polynomials A(x) and B(x) of degree d, you\'re given their values in the points x=0,1,\xe2\x80\xa6,d modulo 109+7.Find a value s such that B(x)\xe2\x89\xa1A(x+s)(mod109+7) for all integers x." 2400
1817B "Fish Graph" "brute force,constructive algorithms,dfs and similar,graphs" "You are given a simple undirected graph with n nodes and m edges. Note that the graph is not necessarily connected. The nodes are labeled from 1 to n.We define a graph to be a Fish Graph if it contains a simple cycle with a special node u belonging to the cycle. Apart from the edges in the cycle, the graph should have exactly 2 extra edges. Both edges should connect to node u, but they should not be connected to any other node of the cycle. Determine if the graph contains a subgraph that is a Fish Graph, and if so, find any such subgraph.In this problem, we define a subgraph as a graph obtained by taking any subset of the edges of the original graph.  Visualization of example 1. The red edges form one possible subgraph that is a Fish Graph." 1900
1817A "Almost Increasing Subsequence" "binary search,data structures,greedy" "A sequence is almost-increasing if it does not contain three consecutive elements x,y,z such that x\xe2\x89\xa5y\xe2\x89\xa5z.You are given an array a1,a2,\xe2\x80\xa6,an and q queries.Each query consists of two integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. For each query, find the length of the longest almost-increasing subsequence of the subarray al,al+1,\xe2\x80\xa6,ar. A subsequence is a sequence that can be derived from the given sequence by deleting zero or more elements without changing the order of the remaining elements." 1500
1816B "Grid Reconstruction" "constructive algorithms,greedy" "Consider a 2\xc3\x97n grid, where n is an even integer. You may place the integers 1,2,\xe2\x80\xa6,2n on the grid, using each integer exactly once.A path is a sequence of cells achieved by starting at (1,1), then repeatedly walking either downwards or to the right, and stopping when (2,n) is reached. The path should not extend beyond the grid.The cost of a path is the alternating sum of the numbers written on the cells in a path. That is, let the numbers written on the cells be a1,a2,\xe2\x80\xa6,ak (in the order that it is visited), the cost of the path is a1\xe2\x88\x92a2+a3\xe2\x88\x92a4+\xe2\x80\xa6=\xe2\x88\x91ki=1ai\xe2\x8b\x85(\xe2\x88\x921)i+1.Construct a way to place the integers 1,2,\xe2\x80\xa6,2n on the grid, such that the minimum cost over all paths from (1,1) to (2,n) is maximized. If there are multiple such grids that result in the maximum value, output any of them." 1000
1816A "Ian Visits Mary" "constructive algorithms,geometry,number theory" "Ian and Mary are frogs living on lattice points of the Cartesian coordinate plane, with Ian living on (0,0) and Mary living on (a,b). Ian would like to visit Mary by jumping around the Cartesian coordinate plane. Every second, he jumps from his current position (xp,yp) to another lattice point (xq,yq), such that no lattice point other than (xp,yp) and (xq,yq) lies on the segment between point (xp,yp) and point (xq,yq). As Ian wants to meet Mary as soon as possible, he wants to jump towards point (a,b) using at most 2 jumps. Unfortunately, Ian is not good at maths. Can you help him?A lattice point is defined as a point with both the x-coordinate and y-coordinate being integers." 800
1815F "OH NO1 (-2-3-4)" "constructive algorithms,graphs,math" "You are given an undirected graph with n vertices and 3m edges. The graph may contain multi-edges, but does not contain self-loops. The graph satisfies the following property: the given edges can be divided into m groups of 3, such that each group is a triangle.A triangle is defined as three edges (a,b), (b,c) and (c,a) for some three distinct vertices a,b,c (1\xe2\x89\xa4a,b,c\xe2\x89\xa4n).Initially, each vertex v has a non-negative integer weight av. For every edge (u,v) in the graph, you should perform the following operation exactly once:   Choose an integer x between 1 and 4. Then increase both au and av by x. After performing all operations, the following requirement should be satisfied: if u and v are connected by an edge, then au\xe2\x89\xa0av.It can be proven this is always possible under the constraints of the task. Output a way to do so, by outputting the choice of x for each edge. It is easy to see that the order of operations does not matter. If there are multiple valid answers, output any." 3500
1815E "Bosco and Particle" "dp,math,number theory,strings" "Bosco is studying the behaviour of particles. He decided to investigate on the peculiar behaviour of the so-called ""four-one-two"" particle. He does the following:There is a line of length n+1, where the topmost point is position 0 and bottommost is position n+1. The particle is initially (at time t=0) at position 0 and heading downwards. The particle moves at the speed of 1 unit per second. There are n oscillators at positions 1,2,\xe2\x80\xa6,n.Each oscillator can be described by a binary string. The initial state of each oscillator is the first character of its binary string. When the particle hits with an oscillator, the particle reverses its direction if its current state is 1 and continues to move at the same direction if its current state is 0, and that oscillator moves on to the next state (the next state of the last state is defined as the first state). Additionally, the particle always reverses its direction when it is at position 0 or n+1 at time t>0.Bosco would like to know the cycle length of the movement of particle. The cycle length is defined as the minimum value of c such that for any time t\xe2\x89\xa50, the position of the particle at time t is same as the position of the particle at time t+c. It can be proved that such value c always exists. As he realises the answer might be too large, he asks you to output your answer modulo 998244353." 3100
1815D "XOR Counting" bitmasks,combinatorics,dp,math "Given two positive integers n and m. Find the sum of all possible values of a1\xe2\xa8\x81a2\xe2\xa8\x81\xe2\x80\xa6\xe2\xa8\x81am, where a1,a2,\xe2\x80\xa6,am are non-negative integers such that a1+a2+\xe2\x80\xa6+am=n.Note that all possible values a1\xe2\xa8\x81a2\xe2\xa8\x81\xe2\x80\xa6\xe2\xa8\x81am should be counted in the sum exactly once.As the answer may be too large, output your answer modulo 998244353.Here, \xe2\xa8\x81 denotes the bitwise XOR operation." 2600
1815C Between "constructive algorithms,dfs and similar,graphs,greedy" "You are given an integer n, as well as m pairs of integers (ai,bi), where 1\xe2\x89\xa4ai,bi\xe2\x89\xa4n, ai\xe2\x89\xa0bi.You want to construct a sequence satisfying the following requirements:  All elements in the sequence are integers between 1 and n.  There is exactly one element with value 1 in the sequence.  For each i (1\xe2\x89\xa4i\xe2\x89\xa4m), between any two elements (on different positions) in the sequence with value ai, there is at least one element with value bi.  The sequence constructed has the maximum length among all possible sequences satisfying the above properties. Sometimes, it is possible that such a sequence can be arbitrarily long, in which case you should output ""INFINITE"". Otherwise, you should output ""FINITE"" and the sequence itself. If there are multiple possible constructions that yield the maximum length, output any." 2200
1815B "Sum Graph" "brute force,constructive algorithms,graphs,implementation,interactive,shortest paths,trees" "This is an interactive problem.There is a hidden permutation p1,p2,\xe2\x80\xa6,pn. Consider an undirected graph with n nodes only with no edges. You can make two types of queries:  Specify an integer x satisfying 2\xe2\x89\xa4x\xe2\x89\xa42n. For all integers i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that 1\xe2\x89\xa4x\xe2\x88\x92i\xe2\x89\xa4n, an edge between node i and node x\xe2\x88\x92i will be added.  Query the number of edges in the shortest path between node pi and node pj. As the answer to this question you will get the number of edges in the shortest path if such a path exists, or \xe2\x88\x921 if there is no such path. Note that you can make both types of queries in any order.Within 2n queries (including type 1 and type 2), guess two possible permutations, at least one of which is p1,p2,\xe2\x80\xa6,pn. You get accepted if at least one of the permutations is correct. You are allowed to guess the same permutation twice.A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2000
1815A "Ian and Array Sorting" greedy,math "To thank Ian, Mary gifted an array a of length n to Ian. To make himself look smart, he wants to make the array in non-decreasing order by doing the following finitely many times: he chooses two adjacent elements ai and ai+1 (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), and increases both of them by 1 or decreases both of them by 1. Note that, the elements of the array can become negative.As a smart person, you notice that, there are some arrays such that Ian cannot make it become non-decreasing order! Therefore, you decide to write a program to determine if it is possible to make the array in non-decreasing order." 1300
1814F "Communication Towers" "brute force,divide and conquer,dsu" "There are n communication towers, numbered from 1 to n, and m bidirectional wires between them. Each tower has a certain set of frequencies that it accepts, the i-th of them accepts frequencies from li to ri.Let\'s say that a tower b is accessible from a tower a, if there exists a frequency x and a sequence of towers a=v1,v2,\xe2\x80\xa6,vk=b, where consecutive towers in the sequence are directly connected by a wire, and each of them accepts frequency x. Note that accessibility is not transitive, i.\xe2\x80\x89e if b is accessible from a and c is accessible from b, then c may not be accessible from a.Your task is to determine the towers that are accessible from the 1-st tower." 2700
1814E "Chain Chips" "data structures,dp,matrices" "You are given an undirected graph consisting of n vertices and n\xe2\x88\x921 edges. The i-th edge has weight ai; it connects the vertices i and i+1.Initially, each vertex contains a chip. Each chip has an integer written on it; the integer written on the chip in the i-th vertex is i.In one operation, you can choose a chip (if there are multiple chips in a single vertex, you may choose any one of them) and move it along one of the edges of the graph. The cost of this operation is equal to the weight of the edge.The cost of the graph is the minimum cost of a sequence of such operations that meets the following condition:  after all operations are performed, each vertex contains exactly one chip, and the integer on each chip is not equal to the index of the vertex where that chip is located. You are given q queries of the form:  k x \xe2\x80\x94 change the weight of the k-th edge (the one which connects the vertices k and k+1) to x. After each query, print the cost of the graph. Note that you don\'t actually move any chips; when you compute the cost, the chips are on their initial positions." 2300
1814D "Balancing Weapons" "binary search,brute force,data structures,math,two pointers" "You\'ve got a job in a game studio that developed an online shooter, and your first big task is to help to balance weapons. The game has n weapons: the i-th gun has an integer fire rate fi and an integer damage per bullet di. The i-th gun\'s total firepower is equal to pi=fi\xe2\x8b\x85di.You have to modify the values di of some guns in such a way that the new values di will still be integers, and the firepower of all guns will become balanced. Given an integer k, the guns are said to be balanced if max1\xe2\x89\xa4i\xe2\x89\xa4npi\xe2\x88\x92min1\xe2\x89\xa4i\xe2\x89\xa4npi\xe2\x89\xa4k.Since gamers that play your game don\'t like big changes, you need to change the values di for the minimum possible number of guns. What is the minimum number of guns for which you have to change these values to make the guns balanced?Note that the new values di must be integers greater than 0." 2500
1814C "Search in Parallel" "constructive algorithms,greedy,sortings" "Suppose you have n boxes. The i-th box contains infinitely many balls of color i. Sometimes you need to get a ball with some specific color; but you\'re too lazy to do it yourself.You have bought two robots to retrieve the balls for you. Now you have to program them. In order to program the robots, you have to construct two lists [a1,a2,\xe2\x80\xa6,ak] and [b1,b2,\xe2\x80\xa6,bn\xe2\x88\x92k], where the list a represents the boxes assigned to the first robot, and the list b represents the boxes assigned to the second robot. Every integer from 1 to n must be present in exactly one of these lists.When you request a ball with color x, the robots work as follows. Each robot looks through the boxes that were assigned to that robot, in the order they appear in the list. The first robot spends s1 seconds analyzing the contents of a box; the second robot spends s2. As soon as one of the robots finds the box with balls of color x (and analyzes its contents), the search ends. The search time is the number of seconds from the beginning of the search until one of the robots finishes analyzing the contents of the x-th box. If a robot analyzes the contents of all boxes assigned to it, it stops searching.For example, suppose s1=2, s2=3, a=[4,1,5,3,7], b=[2,6]. If you request a ball with color 3, the following happens:  initially, the first robot starts analyzing the box 4, and the second robot starts analyzing the box 2;  at the end of the 2-nd second, the first robot finishes analyzing the box 4. It is not the box you need, so the robot continues with the box 1;  at the end of the 3-rd second, the second robot finishes analyzing the box 2. It is not the box you need, so the robot continues with the box 6;  at the end of the 4-th second, the first robot finishes analyzing the box 1. It is not the box you need, so the robot continues with the box 5;  at the end of the 6-th second, the first robot finishes analyzing the box 5. It is not the box you need, so the robot continues with the box 3. At the same time, the second robot finishes analyzing the box 6. It is not the box you need, and the second robot has analyzed all the boxes in its list, so that robot stops searching;  at the end of the 8-th second, the first robot finishes analyzing the box 3. It is the box you need, so the search ends;  so, the search time is 8 seconds. You know that you are going to request a ball of color 1 r1 times, a ball of color 2 r2 times, and so on. You want to construct the lists a and b for the robots in such a way that the total search time over all requests is the minimum possible." 1500
1814B "Long Legs" "brute force,math" "A robot is placed in a cell (0,0) of an infinite grid. This robot has adjustable length legs. Initially, its legs have length 1.Let the robot currently be in the cell (x,y) and have legs of length m. In one move, it can perform one of the following three actions:   jump into the cell (x+m,y);  jump into the cell (x,y+m);  increase the length of the legs by 1, i.\xe2\x80\x89e. set it to m+1. What\'s the smallest number of moves robot has to make to reach a cell (a,b)?" 1700
1814A Coins implementation,math "In Berland, there are two types of coins, having denominations of 2 and k burles.Your task is to determine whether it is possible to represent n burles in coins, i.\xe2\x80\x89e. whether there exist non-negative integers x and y such that 2\xe2\x8b\x85x+k\xe2\x8b\x85y=n." 800
1812J "Unmysterious Language" "*special problem,constructive algorithms,strings" "There is an unmysterious language. You should make a submission in this language, and the judge will read your submission to determine whether it is accepted.You can only submit in the Mysterious Language we have provided. You can view the judge\'s response by clicking the submission ID on the ""My Submissions"" page." -999
1812I "Mountain Climber" "*special problem" "InputThe first line of input contains t (1\xe2\x89\xa4t\xe2\x89\xa425) \xe2\x80\x94 the number of test cases.The only line of each test case contains a single string s (1\xe2\x89\xa4|s|\xe2\x89\xa4100) consisting only of lowercase English letters.OutputFor each test case, print YES or NO.ExampleInputCopy23bigflashingclumpiunderpasspassundertranquilizingpoleandrejdumplingbocchiryonijikakitasingingsongsalperentoxicpiearibucketpotatoflamestormscarletsmaisakurajimamisakamikotoninfiasylveonpikachumewheniseearulhiiarulOutputCopyYESNOYESYESYESNOYESNOYESYESYESYESYESYESNONONOYESNONONONONO" -999
1812H "Expected Twist" "*special problem,interactive" "This is an interactive problem.There is an array a1,a2,\xe2\x80\xa6,an of n integers hidden from you. Your task is to find the smallest element of the array.To do this, you can ask several queries. In each query, you can pick two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). In return, you will be given the value of max(al,al+1,\xe2\x80\xa6,ar). In other words, you will be told the maximum value of the subarray from al to ar.Find the minimum of the array. You can ask at most 624 queries.It is guaranteed that the values a1,a2,\xe2\x80\xa6,an are chosen uniformly at random between 0 and 232\xe2\x88\x921 (inclusive)." -999
1812G "Colour Vision" "*special problem,implementation"  -999
1812F Factorization "*special problem,number theory" "What is the largest prime factor of n?" -999
1812E "Not a Geometry Problem" "*special problem,*special problem,constructive algorithms,geometry,math" "InputThe only line of input contains three integers x, y, z (\xe2\x88\x921000\xe2\x89\xa4x,y,z\xe2\x89\xa41000).OutputOutput one real number \xe2\x80\x94 the answer.Your answer is considered correct if its absolute or relative error does not exceed 106. Formally, let your answer be a, and the jury\'s answer be b. Your answer is accepted if and only if |a\xe2\x88\x92b|max(1,|b|)\xe2\x89\xa4106.ExamplesInputCopy1 1 1OutputCopy1.7320508075688772InputCopy1 -2 -2OutputCopy21.727922061357855InputCopy998 244 353OutputCopy-0.0006269592476489029InputCopy0 0 0OutputCopy1792283455048516.3" -999
1812D "Trivial Conjecture" "*special problem,constructive algorithms,math,number theory" "f(n)={n2n\xe2\x89\xa10(mod2)3n+1n\xe2\x89\xa11(mod2)Find an integer n so that none of the first k terms of the sequence n,f(n),f(f(n)),f(f(f(n))),\xe2\x80\xa6 are equal to 1." -999
1812C Digits "*special problem" "InputThe first line contains a single integer t (1\xe2\x89\xa4t\xe2\x89\xa432) \xe2\x80\x94 the number of test cases.Each test case contains n lines. The i-th line contains an integer ai (1\xe2\x89\xa4ai\xe2\x89\xa49).The sum of n over all test cases doesn\'t exceed 155.OutputFor each test case, print one integer \xe2\x80\x94 the answer.ExampleInputCopy321471235OutputCopy8730" -999
1812B "Was it Rated?" "*special problem,*special problem,*special problem,brute force,implementation" "InputThe only line of the input contains a single integer n (1\xe2\x89\xa4n\xe2\x89\xa425).ExamplesInputCopy1OutputCopyYESInputCopy15OutputCopyNO" -999
1812A "Are You a Robot?" "*special problem,*special problem,*special problem,expression parsing,strings"  -999
1811G2 "Vlad and the Nice Paths (hard version)" "binary search,combinatorics,data structures,dp,math,two pointers" "This is hard version of the problem, it differs from the easy one only by constraints on n and k.Vlad found a row of n tiles and the integer k. The tiles are indexed from left to right and the i-th tile has the color ci. After a little thought, he decided what to do with it.You can start from any tile and jump to any number of tiles right, forming the path p. Let\'s call the path p of length m nice if:  p can be divided into blocks of length exactly k, that is, m is divisible by k;  cp1=cp2=\xe2\x80\xa6=cpk;  cpk+1=cpk+2=\xe2\x80\xa6=cp2k;  \xe2\x80\xa6  cpm\xe2\x88\x92k+1=cpm\xe2\x88\x92k+2=\xe2\x80\xa6=cpm; Your task is to find the number of nice paths of maximum length. Since this number may be too large, print it modulo 109+7." 2200
1811G1 "Vlad and the Nice Paths (easy version)" combinatorics,dp,math "This is an easy version of the problem, it differs from the hard one only by constraints on n and k.Vlad found a row of n tiles and the integer k. The tiles are indexed from left to right and the i-th tile has the color ci. After a little thought, he decided what to do with it.You can start from any tile and jump to any number of tiles right, forming the path p. Let\'s call the path p of length m nice if:  p can be divided into blocks of length exactly k, that is, m is divisible by k;  cp1=cp2=\xe2\x80\xa6=cpk;  cpk+1=cpk+2=\xe2\x80\xa6=cp2k;  \xe2\x80\xa6  cpm\xe2\x88\x92k+1=cpm\xe2\x88\x92k+2=\xe2\x80\xa6=cpm; Your task is to find the number of nice paths of maximum length. Since this number may be too large, print it modulo 109+7." 2100
1811F "Is It Flower?" "dfs and similar,graphs,implementation" "Vlad found a flowerbed with graphs in his yard and decided to take one for himself. Later he found out that in addition to the usual graphs, k-flowers also grew on that flowerbed. A graph is called a k-flower if it consists of a simple cycle of length k, through each vertex of which passes its own simple cycle of length k and these cycles do not intersect at the vertices. For example, 3-flower looks like this:  Note that 1-flower and 2-flower do not exist, since at least 3 vertices are needed to form a cycle.Vlad really liked the structure of the k-flowers and now he wants to find out if he was lucky to take one of them from the flowerbed." 2100
1811E "Living Sequence" "binary search,dp,math,number theory" "In Japan, the number 4 reads like death, so Bob decided to build a live sequence. Living sequence a contains all natural numbers that do not contain the digit 4. a=[1,2,3,5,6,7,8,9,10,11,12,13,15,16,\xe2\x80\xa6].For example, the number 1235 is part of the sequence a, but the numbers 4321, 443 are not part of the sequence a.Bob realized that he does not know how to quickly search for a particular number by the position k in the sequence, so he asks for your help.For example, if Bob wants to find the number at position k=4 (indexing from 1), you need to answer ak=5." 1500
1811D "Umka and a Long Flight" "constructive algorithms,implementation,math" "The girl Umka loves to travel and participate in math olympiads. One day she was flying by plane to the next olympiad and out of boredom explored a huge checkered sheet of paper.Denote the n-th Fibonacci number as Fn={1,n=0;1,n=1;Fn\xe2\x88\x922+Fn\xe2\x88\x921,n\xe2\x89\xa52.A checkered rectangle with a height of Fn and a width of Fn+1 is called a Fibonacci rectangle of order n.Umka has a Fibonacci rectangle of order n. Someone colored a cell in it at the intersection of the row x and the column y.It is necessary to cut this rectangle exactly into n+1 squares in such way that  the painted cell was in a square with a side of 1;  there was at most one pair of squares with equal sides;  the side of each square was equal to a Fibonacci number. Will Umka be able to cut this rectangle in that way?" 1600
1811C "Restore the Array" "constructive algorithms,greedy" "Kristina had an array a of length n consisting of non-negative integers.She built a new array b of length n\xe2\x88\x921, such that bi=max(ai,ai+1) (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921).For example, suppose Kristina had an array a = [3,0,4,0,5] of length 5. Then she did the following:   Calculated b1=max(a1,a2)=max(3,0)=3;  Calculated b2=max(a2,a3)=max(0,4)=4;  Calculated b3=max(a3,a4)=max(4,0)=4;  Calculated b4=max(a4,a5)=max(0,5)=5.  As a result, she got an array b = [3,4,4,5] of length 4.You only know the array b. Find any matching array a that Kristina may have originally had." 1100
1811B "Conveyor Belts" implementation,math "Conveyor matrix mn is matrix of size n\xc3\x97n, where n is an even number. The matrix consists of concentric ribbons moving clockwise.In other words, the conveyor matrix for n=2 is simply a matrix 2\xc3\x972, whose cells form a cycle of length 4 clockwise. For any natural k\xe2\x89\xa52, the matrix m2k is obtained by adding to the matrix m2k\xe2\x88\x922 an outer layer forming a clockwise cycle.  The conveyor matrix 8\xc3\x978.   You are standing in a cell with coordinates x1,y1 and you want to get into a cell with coordinates x2,y2. A cell has coordinates x,y if it is located at the intersection of the xth row and the yth column.Standing on some cell, every second you will move to the cell next in the direction of movement of the tape on which you are. You can also move to a neighboring cell by spending one unit of energy. Movements happen instantly and you can make an unlimited number of them at any time.Your task is to find the minimum amount of energy that will have to be spent to get from the cell with coordinates x1,y1 to the cell with coordinates x2,y2.For example, n=8 initially you are in a cell with coordinates 1,3 and you want to get into a cell with coordinates 6,4. You can immediately make 2 movements, once you are in a cell with coordinates 3,3, and then after 8 seconds you will be in the right cell." 1000
1811A "Insert Digit" greedy,math,strings "You have a positive number of length n and one additional digit.You can insert this digit anywhere in the number, including at the beginning or at the end.Your task is to make the result as large as possible.For example, you have the number 76543, and the additional digit is 4. Then the maximum number you can get is 765443, and it can be obtained in two ways \xe2\x80\x94 by inserting a digit after the 3th or after the 4th digit of the number." 800
1810H "Last Number" combinatorics,math "You are given a multiset S. Initially, S={1,2,3,\xe2\x80\xa6,n}.You will perform the following operation n\xe2\x88\x921 times.  Choose the largest number Smax in S and the smallest number Smin in S. Remove the two numbers from S, and add Smax\xe2\x88\x92Smin into S. It\'s easy to show that there will be exactly one number left after n\xe2\x88\x921 operations. Output that number." 2900
1810G "The Maximum Prefix" dp "You\'re going to generate an array a with a length of at most n, where each ai equals either 1 or \xe2\x88\x921.You generate this array in the following way.   First, you choose some integer k (1\xe2\x89\xa4k\xe2\x89\xa4n), which decides the length of a.  Then, for each i (1\xe2\x89\xa4i\xe2\x89\xa4k), you set ai=1 with probability pi, otherwise set ai=\xe2\x88\x921 (with probability 1\xe2\x88\x92pi). After the array is generated, you calculate si=a1+a2+a3+\xe2\x80\xa6+ai. Specially, s0=0. Then you let S equal to kmaxi=0si. That is, S is the maximum prefix sum of the array a.You are given n+1 integers h0,h1,\xe2\x80\xa6,hn. The score of an array a with maximum prefix sum S is hS. Now, for each k, you want to know the expected score for an array of length k modulo 109+7." 3200
1810F M-tree "data structures,math,sortings,trees" "A rooted tree is called good if every vertex of the tree either is a leaf (a vertex with no children) or has exactly m children.For a good tree, each leaf u has a positive integer cu written on it, and we define the value of the leaf as cu+depu, where depu represents the number of edges of the path from vertex u to the root (also known as the depth of u). The value of a good tree is the maximum value of all its leaves.Now, you are given an array of n integers a1,a2,\xe2\x80\xa6,an, which are the integers that should be written on the leaves. You need to construct a good tree with n leaves and write the integers from the array a to all the leaves. Formally, you should assign each leaf u an index bu, where b is a permutation of length n, and represent that the integer written on leaf u is cu=abu. Under these constraints, you need to minimize the value of the good tree.You have q queries. Each query gives you x, y and changes ax to y, and after that, you should output the minimum value of a good tree based on the current array a. A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2800
1810E Monsters "brute force,data structures,dfs and similar,dsu,graphs,greedy" "There is an undirected graph with n vertices and m edges. Initially, for each vertex i, there is a monster with danger ai on that vertex. For a monster with danger ai, you can defeat it if and only if you have defeated at least ai other monsters before.Now you want to defeat all the monsters. First, you choose some vertex s and defeat the monster on that vertex (since you haven\'t defeated any monsters before, as has to be 0). Then, you can move through the edges. If you want to move from vertex u to vertex v, then the following must hold: either the monster on vertex v has been defeated before, or you can defeat it now. For the second case, you defeat the monster on vertex v and reach vertex v.You can pass the vertices and the edges any number of times. Determine whether you can defeat all the monsters or not." 2100
1810D "Climbing the Tree" "binary search,math" "The snails are climbing a tree. The tree height is h meters, and snails start at position 0.Each snail has two attributes a and b (a>b). Starting from the 1-st day, one snail climbs the tree like this: during the daylight hours of the day, he climbs up a meters; during the night, the snail rests, and he slides down b meters. If on the n-th day, the snail reaches position h for the first time (that is, the top of the tree), he will finish climbing, and we say that the snail spends n days climbing the tree. Note that on the last day of climbing, the snail doesn\'t necessarily climb up a meters, in case his distance to the top is smaller than a.Unfortunately, you don\'t know the exact tree height h at first, but you know that h is a positive integer. There are q events of two kinds.  Event of type 1: a snail with attributes a, b comes and claims that he spent n days climbing the tree. If this message contradicts previously adopted information (i. e. there is no tree for which all previously adopted statements and this one are true), ignore it. Otherwise, adopt it. Event of type 2: a snail with attributes a, b comes and asks you how many days he will spend if he climbs the tree. You can only give the answer based on the information you have adopted so far. If you cannot determine the answer precisely, report that. You need to deal with all the events in order." 1700
1810C "Make It Permutation" "brute force,greedy,sortings" "You have an integer array a of length n. There are two kinds of operations you can make.  Remove an integer from a. This operation costs c. Insert an arbitrary positive integer x to any position of a (to the front, to the back, or between any two consecutive elements). This operation costs d.You want to make the final array a permutation of any positive length. Please output the minimum cost of doing that. Note that you can make the array empty during the operations, but the final array must contain at least one integer.A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300
1810B Candies "constructive algorithms,math,number theory" "This problem is about candy. Initially, you only have 1 candy, and you want to have exactly n candies.You can use the two following spells in any order at most 40 times in total.  Assume you have x candies now. If you use the first spell, then x candies become 2x\xe2\x88\x921 candies.  Assume you have x candies now. If you use the second spell, then x candies become 2x+1 candies. Construct a sequence of spells, such that after using them in order, you will have exactly n candies, or determine it\'s impossible." 800
1810A "Beautiful Sequence" "brute force,greedy" "A sequence of m integers a1,a2,\xe2\x80\xa6,am is good, if and only if there exists at least one i (1\xe2\x89\xa4i\xe2\x89\xa4m) such that ai=i. For example, [3,2,3] is a good sequence, since a2=2, a3=3, while [3,1,1] is not a good sequence, since there is no i such that ai=i.A sequence a is beautiful, if and only if there exists at least one subsequence of a satisfying that this subsequence is good. For example, [4,3,2] is a beautiful sequence, since its subsequence [4,2] is good, while [5,3,4] is not a beautiful sequence.A sequence b is a subsequence of a sequence a if b can be obtained from a by the deletion of several (possibly, zero or all) elements. Now you are given a sequence, check whether it is beautiful or not." 800
1809G Prediction combinatorics,dp,math "Consider a tournament with n participants. The rating of the i-th participant is ai.The tournament will be organized as follows. First of all, organizers will assign each participant an index from 1 to n. All indices will be unique. Let pi be the participant who gets the index i.Then, n\xe2\x88\x921 games will be held. In the first game, participants p1 and p2 will play. In the second game, the winner of the first game will play against p3. In the third game, the winner of the second game will play against p4, and so on \xe2\x80\x94 in the last game, the winner of the (n\xe2\x88\x922)-th game will play against pn.Monocarp wants to predict the results of all n\xe2\x88\x921 games (of course, he will do the prediction only after the indices of the participants are assigned). He knows for sure that, when two participants with ratings x and y play, and |x\xe2\x88\x92y|>k, the participant with the higher rating wins. But if |x\xe2\x88\x92y|\xe2\x89\xa4k, any of the two participants may win.Among all n! ways to assign the indices to participants, calculate the number of ways to do this so that Monocarp can predict the results of all n\xe2\x88\x921 games. Since the answer can be large, print it modulo 998244353." 2800
1809F "Traveling in Berland" "binary search,data structures,graphs,greedy,implementation" "There are n cities in Berland, arranged in a circle and numbered from 1 to n in clockwise order.You want to travel all over Berland, starting in some city, visiting all the other cities and returning to the starting city. Unfortunately, you can only drive along the Berland Ring Highway, which connects all n cities. The road was designed by a very titled and respectable minister, so it is one-directional \xe2\x80\x94 it can only be traversed clockwise, only from the city i to the city (imodn)+1 (i.e. from 1 to 2, from 2 in 3, ..., from n to 1).The fuel tank of your car holds up to k liters of fuel. To drive from the i-th city to the next one, ai liters of fuel are needed (and are consumed in the process).Every city has a fuel station; a liter of fuel in the i-th city costs bi burles. Refueling between cities is not allowed; if fuel has run out between cities, then your journey is considered incomplete.For each city, calculate the minimum cost of the journey if you start and finish it in that city." 2500
1809E "Two Tanks" "binary search,dp,implementation,math" "There are two water tanks, the first one fits a liters of water, the second one fits b liters of water. The first tank has c (0\xe2\x89\xa4c\xe2\x89\xa4a) liters of water initially, the second tank has d (0\xe2\x89\xa4d\xe2\x89\xa4b) liters of water initially.You want to perform n operations on them. The i-th operation is specified by a single non-zero integer vi. If vi>0, then you try to pour vi liters of water from the first tank into the second one. If vi<0, you try to pour \xe2\x88\x92vi liters of water from the second tank to the first one.When you try to pour x liters of water from the tank that has y liters currently available to the tank that can fit z more liters of water, the operation only moves min(x,y,z) liters of water.For all pairs of the initial volumes of water (c,d) such that 0\xe2\x89\xa4c\xe2\x89\xa4a and 0\xe2\x89\xa4d\xe2\x89\xa4b, calculate the volume of water in the first tank after all operations are performed." 2400
1809D "Binary String Sorting" "constructive algorithms,greedy" "You are given a binary string s consisting of only characters 0 and/or 1.You can perform several operations on this string (possibly zero). There are two types of operations:   choose two consecutive elements and swap them. In order to perform this operation, you pay 1012 coins;  choose any element from the string and remove it. In order to perform this operation, you pay 1012+1 coins. Your task is to calculate the minimum number of coins required to sort the string s in non-decreasing order (i.\xe2\x80\x89e. transform s so that s1\xe2\x89\xa4s2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4sm, where m is the length of the string after applying all operations). An empty string is also considered sorted in non-decreasing order." 1800
1809C "Sum on Subarrays" "constructive algorithms,greedy,math" "For an array a=[a1,a2,\xe2\x80\xa6,an], let\'s denote its subarray a[l,r] as the array [al,al+1,\xe2\x80\xa6,ar].For example, the array a=[1,\xe2\x88\x923,1] has 6 non-empty subarrays:  a[1,1]=[1];  a[1,2]=[1,\xe2\x88\x923];  a[1,3]=[1,\xe2\x88\x923,1];  a[2,2]=[\xe2\x88\x923];  a[2,3]=[\xe2\x88\x923,1];  a[3,3]=[1]. You are given two integers n and k. Construct an array a consisting of n integers such that:  all elements of a are from \xe2\x88\x921000 to 1000;  a has exactly k subarrays with positive sums;  the rest (n+1)\xe2\x8b\x85n2\xe2\x88\x92k subarrays of a have negative sums." 1500
1809B "Points on Plane" "binary search,greedy,math" "You are given a two-dimensional plane, and you need to place n chips on it. You can place a chip only at a point with integer coordinates. The cost of placing a chip at the point (x,y) is equal to |x|+|y| (where |a| is the absolute value of a).The cost of placing n chips is equal to the maximum among the costs of each chip.You need to place n chips on the plane in such a way that the Euclidean distance between each pair of chips is strictly greater than 1, and the cost is the minimum possible." 1000
1809A Garland implementation "You have a garland consisting of 4 colored light bulbs, the color of the i-th light bulb is si.Initially, all the light bulbs are turned off. Your task is to turn all the light bulbs on. You can perform the following operation any number of times: select a light bulb and switch its state (turn it on if it was off, and turn it off if it was on). The only restriction on the above operation is that you can apply the operation to a light bulb only if the previous operation was applied to a light bulb of a different color (the first operation can be applied to any light bulb).Calculate the minimum number of operations to turn all the light bulbs on, or report that this is impossible." 800
1808E3 "Minibuses on Venus (hard version)" "brute force,combinatorics,dp,math" "This is the hard version of the problem. The only difference between the three versions is the constraints on n and k. You can make hacks only if all versions of the problem are solved.Maxim is a minibus driver on Venus.To ride on Maxim\'s minibus, you need a ticket. Each ticket has a number consisting of n digits. However, as we know, the residents of Venus use a numeral system with base k, rather than the decimal system. Therefore, the ticket number can be considered as a sequence of n integers from 0 to k\xe2\x88\x921, inclusive.The residents of Venus consider a ticket to be lucky if there is a digit on it that is equal to the sum of the remaining digits, modulo k. For example, if k=10, then the ticket 7135 is lucky because 7+1+5\xe2\x89\xa13(mod10). On the other hand, the ticket 7136 is not lucky because no digit is equal to the sum of the others modulo 10.Once, while on a trip, Maxim wondered: how many lucky tickets exist? At the same time, Maxim understands that this number can be very large, so he is interested only in the answer modulo some prime number m." 2800
1808E2 "Minibuses on Venus (medium version)" "combinatorics,divide and conquer,dp,matrices" "This is the medium version of the problem. The only difference between the three versions is the constraints on n and k. You can make hacks only if all versions of the problem are solved.Maxim is a minibus driver on Venus.To ride on Maxim\'s minibus, you need a ticket. Each ticket has a number consisting of n digits. However, as we know, the residents of Venus use a numeral system with base k, rather than the decimal system. Therefore, the ticket number can be considered as a sequence of n integers from 0 to k\xe2\x88\x921, inclusive.The residents of Venus consider a ticket to be lucky if there is a digit on it that is equal to the sum of the remaining digits, modulo k. For example, if k=10, then the ticket 7135 is lucky because 7+1+5\xe2\x89\xa13(mod10). On the other hand, the ticket 7136 is not lucky because no digit is equal to the sum of the others modulo 10.Once, while on a trip, Maxim wondered: how many lucky tickets exist? At the same time, Maxim understands that this number can be very large, so he is interested only in the answer modulo some prime number m." 2500
1808E1 "Minibuses on Venus (easy version)" "combinatorics,divide and conquer,dp" "This is the easy version of the problem. The only difference between the three versions is the constraints on n and k. You can make hacks only if all versions of the problem are solved.Maxim is a minibus driver on Venus.To ride on Maxim\'s minibus, you need a ticket. Each ticket has a number consisting of n digits. However, as we know, the residents of Venus use a numeral system with base k, rather than the decimal system. Therefore, the ticket number can be considered as a sequence of n integers from 0 to k\xe2\x88\x921, inclusive.The residents of Venus consider a ticket to be lucky if there is a digit on it that is equal to the sum of the remaining digits, modulo k. For example, if k=10, then the ticket 7135 is lucky because 7+1+5\xe2\x89\xa13(mod10). On the other hand, the ticket 7136 is not lucky because no digit is equal to the sum of the others modulo 10.Once, while on a trip, Maxim wondered: how many lucky tickets exist? At the same time, Maxim understands that this number can be very large, so he is interested only in the answer modulo some prime number m." 2200
1808D "Petya, Petya, Petr, and Palindromes" "binary search,brute force,data structures,two pointers" "Petya and his friend, the robot Petya++, have a common friend \xe2\x80\x94 the cyborg Petr#. Sometimes Petr# comes to the friends for a cup of tea and tells them interesting problems.Today, Petr# told them the following problem.A palindrome is a sequence that reads the same from left to right as from right to left. For example, [38,12,8,12,38], [1], and [3,8,8,3] are palindromes.Let\'s call the palindromicity of a sequence a1,a2,\xe2\x80\xa6,an the minimum count of elements that need to be replaced to make this sequence a palindrome. For example, the palindromicity of the sequence [38,12,8,38,38] is 1 since it is sufficient to replace the number 38 at the fourth position with the number 12. And the palindromicity of the sequence [3,3,5,5,5] is two since you can replace the first two threes with fives, and the resulting sequence [5,5,5,5,5] is a palindrome.Given a sequence a of length n, and an odd integer k, you need to find the sum of palindromicity of all subarrays of length k, i. e., the sum of the palindromicity values for the sequences ai,ai+1,\xe2\x80\xa6,ai+k\xe2\x88\x921 for all i from 1 to n\xe2\x88\x92k+1.The students quickly solved the problem. Can you do it too?" 2100
1808C "Unlucky Numbers" "brute force,dp,greedy,implementation" "In this problem, unlike problem A, you need to look for unluckiest number, not the luckiest one.Note that the constraints of this problem differ from such in problem A.Olympus City recently launched the production of personal starships. Now everyone on Mars can buy one and fly to other planets inexpensively.Each starship has a number \xe2\x80\x94some positive integer x. Let\'s define the luckiness of a number x as the difference between the largest and smallest digits of that number. For example, 142857 has 8 as its largest digit and 1 as its smallest digit, so its luckiness is 8\xe2\x88\x921=7. And the number 111 has all digits equal to 1, so its luckiness is zero.Hateehc is a famous Martian blogger who often flies to different corners of the solar system. To release interesting videos even faster, he decided to buy himself a starship. When he came to the store, he saw starships with numbers from l to r inclusively. While in the store, Hateehc wanted to find a starship with the unluckiest number.Since there are a lot of starships in the store, and Hateehc can\'t program, you have to help the blogger and write a program that answers his question." 1900
1808B "Playing in a Casino" math,sortings "Galaxy Luck, a well-known casino in the entire solar system, introduces a new card game.In this game, there is a deck that consists of n cards. Each card has m numbers written on it. Each of the n players receives exactly one card from the deck.Then all players play with each other in pairs, and each pair of players plays exactly once. Thus, if there are, for example, four players in total, then six games are played: the first against the second, the first against the third, the first against the fourth, the second against the third, the second against the fourth and the third against the fourth.Each of these games determines the winner in some way, but the rules are quite complicated, so we will not describe them here. All that matters is how many chips are paid out to the winner. Let the first player\'s card have the numbers a1,a2,\xe2\x80\xa6,am, and the second player\'s card \xe2\x80\x94 b1,b2,\xe2\x80\xa6,bm. Then the winner of the game gets |a1\xe2\x88\x92b1|+|a2\xe2\x88\x92b2|+\xe2\x8b\xaf+|am\xe2\x88\x92bm| chips from the total pot, where |x| denotes the absolute value of x.To determine the size of the total pot, it is necessary to calculate the winners\' total winnings for all games. Since there can be many cards in a deck and many players, you have been assigned to write a program that does all the necessary calculations." 1200
1808A "Lucky Numbers" "brute force,implementation" "Olympus City recently launched the production of personal starships. Now everyone on Mars can buy one and fly to other planets inexpensively.Each starship has a number \xe2\x80\x94some positive integer x. Let\'s define the luckiness of a number x as the difference between the largest and smallest digits of that number. For example, 142857 has 8 as its largest digit and 1 as its smallest digit, so its luckiness is 8\xe2\x88\x921=7. And the number 111 has all digits equal to 1, so its luckiness is zero.Hateehc is a famous Martian blogger who often flies to different corners of the solar system. To release interesting videos even faster, he decided to buy himself a starship. When he came to the store, he saw starships with numbers from l to r inclusively. While in the store, Hateehc wanted to find a starship with the luckiest number.Since there are a lot of starships in the store, and Hateehc can\'t program, you have to help the blogger and write a program that answers his question." 900
1807G2 "Subsequence Addition (Hard Version)" bitmasks,dp,greedy,implementation,sortings "The only difference between the two versions is that in this version, the constraints are higher.Initially, array a contains just the number 1. You can perform several operations in order to change the array. In an operation, you can select some subsequence\xe2\x80\xa0 of a and add into a an element equal to the sum of all elements of the subsequence. You are given a final array c. Check if c can be obtained from the initial array a by performing some number (possibly 0) of operations on the initial array.\xe2\x80\xa0 A sequence b is a subsequence of a sequence a if b can be obtained from a by the deletion of several (possibly zero, but not all) elements. In other words, select k (1\xe2\x89\xa4k\xe2\x89\xa4|a|) distinct indices i1,i2,\xe2\x80\xa6,ik and insert anywhere into a a new element with the value equal to ai1+ai2+\xe2\x8b\xaf+aik." 1100
1807G1 "Subsequence Addition (Easy Version)" "brute force,data structures,dp,greedy,implementation,sortings" "The only difference between the two versions is that in this version, the constraints are lower.Initially, array a contains just the number 1. You can perform several operations in order to change the array. In an operation, you can select some subsequence\xe2\x80\xa0 of a and add into a an element equal to the sum of all elements of the subsequence. You are given a final array c. Check if c can be obtained from the initial array a by performing some number (possibly 0) of operations on the initial array.\xe2\x80\xa0 A sequence b is a subsequence of a sequence a if b can be obtained from a by the deletion of several (possibly zero, but not all) elements. In other words, select k (1\xe2\x89\xa4k\xe2\x89\xa4|a|) distinct indices i1,i2,\xe2\x80\xa6,ik and insert anywhere into a a new element with the value equal to ai1+ai2+\xe2\x8b\xaf+aik." 1100
1807F "Bouncy Ball" "brute force,dfs and similar,implementation" "You are given a room that can be represented by a n\xc3\x97m grid. There is a ball at position (i1,j1) (the intersection of row i1 and column j1), and it starts going diagonally in one of the four directions:  The ball is going down and right, denoted by DR; it means that after a step, the ball\'s location goes from (i,j) to (i+1,j+1).  The ball is going down and left, denoted by DL; it means that after a step, the ball\'s location goes from (i,j) to (i+1,j\xe2\x88\x921).  The ball is going up and right, denoted by UR; it means that after a step, the ball\'s location goes from (i,j) to (i\xe2\x88\x921,j+1).  The ball is going up and left, denoted by UL; it means that after a step, the ball\'s location goes from (i,j) to (i\xe2\x88\x921,j\xe2\x88\x921). After each step, the ball maintains its direction unless it hits a wall (that is, the direction takes it out of the room\'s bounds in the next step). In this case, the ball\'s direction gets flipped along the axis of the wall; if the ball hits a corner, both directions get flipped. Any instance of this is called a bounce. The ball never stops moving.  In the above example, the ball starts at (1,7) and goes DL until it reaches the bottom wall, then it bounces and continues in the direction UL. After reaching the left wall, the ball bounces and continues to go in the direction UR. When the ball reaches the upper wall, it bounces and continues in the direction DR. After reaching the bottom-right corner, it bounces once and continues in direction UL, and so on.Your task is to find how many bounces the ball will go through until it reaches cell (i2,j2) in the room, or report that it never reaches cell (i2,j2) by printing \xe2\x88\x921.Note that the ball first goes in a cell and only after that bounces if it needs to." 1700
1807E Interview "binary search,implementation,interactive" "This is an interactive problem. If you are unsure how interactive problems work, then it is recommended to read the guide for participants.Before the last stage of the exam, the director conducted an interview. He gave Gon n piles of stones, the i-th pile having ai stones.Each stone is identical and weighs 1 grams, except for one special stone that is part of an unknown pile and weighs 2 grams.  A picture of the first test case. Pile 2 has the special stone. The piles have weights of 1,3,3,4,5, respectively. Gon can only ask the director questions of one kind: he can choose k piles, and the director will tell him the total weight of the piles chosen. More formally, Gon can choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) and k unique piles p1,p2,\xe2\x80\xa6,pk (1\xe2\x89\xa4pi\xe2\x89\xa4n), and the director will return the total weight mp1+mp2+\xe2\x8b\xaf+mpk, where mi denotes the weight of pile i. Gon is tasked with finding the pile that contains the special stone. However, the director is busy. Help Gon find this pile in at most 30 queries." 1300
1807D "Odd Queries" "data structures,implementation" "You have an array a1,a2,\xe2\x80\xa6,an. Answer q queries of the following form:   If we change all elements in the range al,al+1,\xe2\x80\xa6,ar of the array to k, will the sum of the entire array be odd?  Note that queries are independent and do not affect future queries." 900
1807C "Find and Replace" greedy,implementation,strings "You are given a string s consisting of lowercase Latin characters. In an operation, you can take a character and replace all occurrences of this character with 0 or replace all occurrences of this character with 1.Is it possible to perform some number of moves so that the resulting string is an alternating binary string\xe2\x80\xa0? For example, consider the string abacaba. You can perform the following moves:   Replace a with 0. Now the string is 0b0c0b0.  Replace b with 1. Now the string is 010c010.  Replace c with 1. Now the string is 0101010. This is an alternating binary string. \xe2\x80\xa0An alternating binary string is a string of 0s and 1s such that no two adjacent bits are equal. For example, 01010101, 101, 1 are alternating binary strings, but 0110, 0a0a0, 10100 are not." 800
1807B "Grab the Candies" greedy "Mihai and Bianca are playing with bags of candies. They have a row a of n bags of candies. The i-th bag has ai candies. The bags are given to the players in the order from the first bag to the n-th bag. If a bag has an even number of candies, Mihai grabs the bag. Otherwise, Bianca grabs the bag. Once a bag is grabbed, the number of candies in it gets added to the total number of candies of the player that took it. Mihai wants to show off, so he wants to reorder the array so that at any moment (except at the start when they both have no candies), Mihai will have strictly more candies than Bianca. Help Mihai find out if such a reordering exists." 800
1807A "Plus or Minus" implementation "You are given three integers a, b, and c such that exactly one of these two equations is true:   a+b=c  a\xe2\x88\x92b=c  Output + if the first equation is true, and - otherwise." 800
1806F2 "GCD Master (hard version)" greedy,math,sortings "This is the hard version of the problem. The only difference between the two versions is the constraint on m. You can make hacks only if both versions of the problem are solved.You are given an array a of length n and two integers m and k. Each element in a satisfies 1\xe2\x89\xa4ai\xe2\x89\xa4m.In one operation, you choose two indices i and j such that 1\xe2\x89\xa4i<j\xe2\x89\xa4|a|, then append gcd(ai,aj) to the back of the array and delete ai and aj from the array. Note that the length of the array decreases by one after this operation.Find the maximum possible sum of the array after performing exactly k operations." 2900
1806F1 "GCD Master (easy version)" "greedy,math,number theory,sortings" "This is the easy version of the problem. The only difference between the two versions is the constraint on m. You can make hacks only if both versions of the problem are solved.You are given an array a of length n and two integers m and k. Each element in a satisfies 1\xe2\x89\xa4ai\xe2\x89\xa4m.In one operation, you choose two indices i and j such that 1\xe2\x89\xa4i<j\xe2\x89\xa4|a|, then append gcd(ai,aj) to the back of the array and delete ai and aj from the array. Note that the length of the array decreases by one after this operation.Find the maximum possible sum of the array after performing exactly k operations." 2900
1806E "Tree Master" "brute force,data structures,dfs and similar,trees" "You are given a tree with n weighted vertices labeled from 1 to n rooted at vertex 1. The parent of vertex i is pi and the weight of vertex i is ai. For convenience, define p1=0.For two vertices x and y of the same depth\xe2\x80\xa0, define f(x,y) as follows:   Initialize ans=0.  While both x and y are not 0:   ans\xe2\x86\x90ans+ax\xe2\x8b\x85ay;  x\xe2\x86\x90px;  y\xe2\x86\x90py.   f(x,y) is the value of ans. You will process q queries. In the i-th query, you are given two integers xi and yi and you need to calculate f(xi,yi).\xe2\x80\xa0 The depth of vertex v is the number of edges on the unique simple path from the root of the tree to vertex v." 2200
1806D "DSU Master" combinatorics,dp,dsu,math "You are given an integer n and an array a of length n\xe2\x88\x921 whose elements are either 0 or 1.Let us define the value of a permutation\xe2\x80\xa0 p of length m\xe2\x88\x921 (m\xe2\x89\xa4n) by the following process.Let G be a graph of m vertices labeled from 1 to m that does not contain any edges. For each i from 1 to m\xe2\x88\x921, perform the following operations:   define u and v as the (unique) vertices in the weakly connected components\xe2\x80\xa1 containing vertices pi and pi+1 respectively with only incoming edges\xe2\x80\xa0\xe2\x80\xa0;  in graph G, add a directed edge from vertex v to u if api=0, otherwise add a directed edge from vertex u to v (if api=1).  Note that after each step, it can be proven that each weakly connected component of G has a unique vertex with only incoming edges.Then, the value of p is the number of incoming edges of vertex 1 of G.For each k from 1 to n\xe2\x88\x921, find the sum of values of all k! permutations of length k. Since this value can be big, you are only required to compute this value under modulo 998244353.  Operations when n=3, a=[0,1] and p=[1,2] \xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).\xe2\x80\xa1 The weakly connected components of a directed graph is the same as the components of the undirected version of the graph. Formally, for directed graph G, define a graph H where for all edges a\xe2\x86\x92b in G, you add an undirected edge a\xe2\x86\x94b in H. Then the weakly connected components of G are the components of H.\xe2\x80\xa0\xe2\x80\xa0 Note that a vertex that has no edges is considered to have only incoming edges." 2500
1806C "Sequence Master" "brute force,constructive algorithms,math" "For some positive integer m, YunQian considers an array q of 2m (possibly negative) integers good, if and only if for every possible subsequence of q that has length m, the product of the m elements in the subsequence is equal to the sum of the m elements that are not in the subsequence. Formally, let U={1,2,\xe2\x80\xa6,2m}. For all sets S\xe2\x8a\x86U such that |S|=m, \xe2\x88\x8fi\xe2\x88\x88Sqi=\xe2\x88\x91i\xe2\x88\x88U\xe2\x88\x96Sqi.Define the distance between two arrays a and b both of length k to be k\xe2\x88\x91i=1|ai\xe2\x88\x92bi|.You are given a positive integer n and an array p of 2n integers.Find the minimum distance between p and q over all good arrays q of length 2n. It can be shown for all positive integers n, at least one good array exists. Note that you are not required to construct the array q that achieves this minimum distance." 1600
1806B "Mex Master" "constructive algorithms,greedy" "You are given an array a of length n. The score of a is the MEX\xe2\x80\xa0 of [a1+a2,a2+a3,\xe2\x80\xa6,an\xe2\x88\x921+an]. Find the minimum score of a if you are allowed to rearrange elements of a in any order. Note that you are not required to construct the array a that achieves the minimum score.\xe2\x80\xa0 The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For instance:  The MEX of [2,2,1] is 0, because 0 does not belong to the array.  The MEX of [3,1,0,1] is 2, because 0 and 1 belong to the array, but 2 does not.  The MEX of [0,3,1,2] is 4 because 0, 1, 2, and 3 belong to the array, but 4 does not." 900
1806A "Walking Master" geometry,greedy,math "YunQian is standing on an infinite plane with the Cartesian coordinate system on it. In one move, she can move to the diagonally adjacent point on the top right or the adjacent point on the left.That is, if she is standing on point (x,y), she can either move to point (x+1,y+1) or point (x\xe2\x88\x921,y).YunQian initially stands at point (a,b) and wants to move to point (c,d). Find the minimum number of moves she needs to make or declare that it is impossible." 800
1805F2 "Survival of the Weakest (hard version)" "greedy,math,sortings,two pointers" "This is the hard version of the problem. It differs from the easy one only in constraints on n. You can make hacks only if you lock both versions.Let a1,a2,\xe2\x80\xa6,an be an array of non-negative integers. Let F(a1,a2,\xe2\x80\xa6,an) be the sorted in the non-decreasing order array of n\xe2\x88\x921 smallest numbers of the form ai+aj, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n. In other words, F(a1,a2,\xe2\x80\xa6,an) is the sorted in the non-decreasing order array of n\xe2\x88\x921 smallest sums of all possible pairs of elements of the array a1,a2,\xe2\x80\xa6,an. For example, F(1,2,5,7)=[1+2,1+5,2+5]=[3,6,7].You are given an array of non-negative integers a1,a2,\xe2\x80\xa6,an. Determine the single element of the array F(F(F\xe2\x80\xa6F\xe2\x8f\x9fn\xe2\x88\x921(a1,a2,\xe2\x80\xa6,an)\xe2\x80\xa6)). Since the answer can be quite large, output it modulo 109+7." 3100
1805F1 "Survival of the Weakest (easy version)" "binary search,brute force,implementation,math,sortings" "This is the easy version of the problem. It differs from the hard one only in constraints on n. You can make hacks only if you lock both versions.Let a1,a2,\xe2\x80\xa6,an be an array of non-negative integers. Let F(a1,a2,\xe2\x80\xa6,an) be the sorted in the non-decreasing order array of n\xe2\x88\x921 smallest numbers of the form ai+aj, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n. In other words, F(a1,a2,\xe2\x80\xa6,an) is the sorted in the non-decreasing order array of n\xe2\x88\x921 smallest sums of all possible pairs of elements of the array a1,a2,\xe2\x80\xa6,an. For example, F(1,2,5,7)=[1+2,1+5,2+5]=[3,6,7].You are given an array of non-negative integers a1,a2,\xe2\x80\xa6,an. Determine the single element of the array F(F(F\xe2\x80\xa6F\xe2\x8f\x9fn\xe2\x88\x921(a1,a2,\xe2\x80\xa6,an)\xe2\x80\xa6)). Since the answer can be quite large, output it modulo 109+7." 2600
1805E "There Should Be a Lot of Maximums" "brute force,data structures,dfs and similar,dp,trees,two pointers" "You are given a tree (a connected graph without cycles). Each vertex of the tree contains an integer. Let\'s define the MAD (maximum double) parameter of the tree as the maximum integer that occurs in the vertices of the tree at least 2 times. If no number occurs in the tree more than once, then we assume MAD=0.Note that if you remove an edge from the tree, it splits into two trees. Let\'s compute the MAD parameters of the two trees and take the maximum of the two values. Let the result be the value of the deleted edge.For each edge, find its value. Note that we don\'t actually delete any edges from the tree, the values are to be found independently." 2300
1805D "A Wide, Wide Graph" "dfs and similar,dp,graphs,greedy,trees" "You are given a tree (a connected graph without cycles) with n vertices. Consider a fixed integer k. Then, the graph Gk is an undirected graph with n vertices, where an edge between vertices u and v exists if and only if the distance between vertices u and v in the given tree is at least k.For each k from 1 to n, print the number of connected components in the graph Gk." 1800
1805C "Place for a Selfie" "binary search,data structures,geometry,math" "The universe is a coordinate plane. There are n space highways, each of which is a straight line y=kx passing through the origin (0,0). Also, there are m asteroid belts on the plane, which we represent as open upwards parabolas, i. e. graphs of functions y=ax2+bx+c, where a>0.You want to photograph each parabola. To do this, for each parabola you need to choose a line that does not intersect this parabola and does not touch it. You can select the same line for different parabolas. Please find such a line for each parabola, or determine that there is no such line." 1400
1805B "The String Has a Target" greedy,strings "You are given a string s. You can apply this operation to the string exactly once: choose index i and move character si to the beginning of the string (removing it at the old position). For example, if you apply the operation with index i=4 to the string ""abaacd"" with numbering from 1, you get the string ""aabacd"". What is the lexicographically minimal\xe2\x80\xa0 string you can obtain by this operation?\xe2\x80\xa0A string a is lexicographically smaller than a string b of the same length if and only if the following holds:   in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 800
1805A "We Need the Zero" "bitmasks,brute force" "There is an array a consisting of non-negative integers. You can choose an integer x and denote bi=ai\xe2\x8a\x95x for all 1\xe2\x89\xa4i\xe2\x89\xa4n, where \xe2\x8a\x95 denotes the bitwise XOR operation. Is it possible to choose such a number x that the value of the expression b1\xe2\x8a\x95b2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95bn equals 0?It can be shown that if a valid number x exists, then there also exists x such that (0\xe2\x89\xa4x<28)." 800
1804H "Code Lock" bitmasks,dp "Lara has a safe that is locked with a circle-shaped code lock that consists of a rotating arrow, a static circumference around the arrow, an input screen, and an input button.The circumference of the lock is split into k equal sections numbered from 1 to k in clockwise order. Arrow always points to one of the sections. Each section is marked with one of the first k letters of the English alphabet. No two sections are marked with the same letter.Due to the lock limitations, the safe\'s password is a string of length n that consists of first k letters of the English alphabet only. Lara enters the password by rotating the lock\'s arrow and pressing the input button. Initially, the lock\'s arrow points to section 1 and the input screen is empty. In one second she can do one of the following actions.   Rotate the arrow one section clockwise. If the arrow was pointing at section x<k it will now point at section x+1. If the arrow was pointing at section k it will now point at section 1.  Rotate the arrow one section counter-clockwise. If the arrow was pointing at section x>1 it will now point at section x\xe2\x88\x921. If the arrow was pointing at section 1 it will now point at section k.  Press the input button. The letter marked on the section that the arrow points to will be added to the content of the input screen.  As soon as the content of the input screen matches the password, the safe will open. Lara always enters her password in the minimum possible time.Lara has recently found out that the safe can be re-programmed. She can take the first k letters of the English alphabet and assign them to the sectors in any order she likes. Now she wants to re-arrange the letters in a way that will minimize the number of seconds it takes her to input the password. Compute this minimum number of seconds and the number of ways to assign letters, for which this minimum number of seconds is achieved.Two ways to assign letters to sectors are considered to be distinct if there exists at least one sector i that is assigned different letters." 3300
1804G "Flow Control" "data structures,dsu,implementation" "Raj has a single physical network line that connects his office to the Internet. This line bandwidth is b bytes per millisecond.There are n users who would like to use this network line to transmit some data. The i-th of them will use the line from millisecond si to millisecond fi inclusive. His initial data rate will be set to di. That means he will use data rate equal to di for millisecond si, and then it will change according to the procedure described below.The flow control will happen as follows. Suppose there are m users trying to transmit some data via the given network line during millisecond x. Denote as ti the data rate that the i-th of these m users has at the beginning of this millisecond. All ti are non-negative integer values.   If m=0, i. e. there are no users trying to transmit data during this millisecond, nothing happens.  If the sum of all ti is less than or equal to b, each active user successfully completes his transmission (the i-th active user transmits ti bytes). After that, the data rate of each active user grows by 1, i. e. each ti is increased by 1.  If the sum of all ti is greater than b, the congestion occurs and no data transmissions succeed this millisecond at all. If that happens, each ti decreases twice, i. e. each ti is replaced with \xe2\x8c\x8ati2\xe2\x8c\x8b. Raj knows all the values n, b, si, fi, and di, he wants to calculate the total number of bytes transmitted by all the users in the aggregate." 3500
1804F "Approximate Diameter" "binary search,divide and conquer,graphs,shortest paths" "Jack has a graph of n vertices and m edges. All edges are bidirectional and of unit length. The graph is connected, i. e. there exists a path between any two of its vertices. There can be more than one edge connecting the same pair of vertices. The graph can contain self-loops, i. e. edges connecting a node to itself.The distance between vertices u and v is denoted as \xcf\x81(u,v) and equals the minimum possible number of edges on a path between u and v. The diameter of graph G is defined as the maximum possible distance between some pair of its vertices. We denote it as d(G). In other words, d(G)=max1\xe2\x89\xa4u,v\xe2\x89\xa4n\xcf\x81(u,v).Jack plans to consecutively apply q updates to his graph. Each update adds exactly one edge to the graph. Denote as Gi the graph after exactly i updates are made. Jack wants to calculate q+1 values d(G0),d(G1),d(G2),\xe2\x80\xa6,d(Gq).However, Jack suspects that finding the exact diameters of q+1 graphs might be a difficult task, so he is fine with approximate answers that differ from the correct answers no more than twice. Formally, Jack wants to find a sequence of positive integers a0,a1,a2,\xe2\x80\xa6,aq such that \xe2\x8c\x88d(Gi)2\xe2\x8c\x89\xe2\x89\xa4ai\xe2\x89\xa42\xe2\x8b\x85d(Gi) for each i.HacksYou cannot make hacks in this problem." 2700
1804E Routing "bitmasks,brute force,dfs and similar,dp,graphs" "Ada operates a network that consists of n servers and m direct connections between them. Each direct connection between a pair of distinct servers allows bidirectional transmission of information between these two servers. Ada knows that these m direct connections allow to directly or indirectly transmit information between any two servers in this network. We say that server v is a neighbor of server u if there exists a direct connection between these two servers.Ada needs to configure her network\'s WRP (Weird Routing Protocol). For each server u she needs to select exactly one of its neighbors as an auxiliary server a(u). After all a(u) are set, routing works as follows. Suppose server u wants to find a path to server v (different from u).   Server u checks all of its direct connections to other servers. If it sees a direct connection with server v, it knows the path and the process terminates.  If the path was not found at the first step, server u asks its auxiliary server a(u) to find the path.  Auxiliary server a(u) follows this process starting from the first step.  After a(u) finds the path, it returns it to u. Then server u constructs the resulting path as the direct connection between u and a(u) plus the path from a(u) to v. As you can see, this procedure either produces a correct path and finishes or keeps running forever. Thus, it is critically important for Ada to configure her network\'s WRP properly.Your goal is to assign an auxiliary server a(u) for each server u in the given network. Your assignment should make it possible to construct a path from any server u to any other server v using the aforementioned procedure. Or you should report that such an assignment doesn\'t exist." 2400
1804D Accommodation "brute force,dp,greedy,implementation" "Annie is an amateur photographer. She likes to take pictures of giant residential buildings at night. She just took a picture of a huge rectangular building that can be seen as a table of n\xc3\x97m windows. That means that the building has n floors and each floor has exactly m windows. Each window is either dark or bright, meaning there is light turned on in the room behind it.Annies knows that each apartment in this building is either one-bedroom or two-bedroom. Each one-bedroom apartment has exactly one window representing it on the picture, and each two-bedroom apartment has exactly two consecutive windows on the same floor. Moreover, the value of m is guaranteed to be divisible by 4 and it is known that each floor has exactly m4 two-bedroom apartments and exactly m2 one-bedroom apartments. The actual layout of apartments is unknown and can be different for each floor.Annie considers an apartment to be occupied if at least one of its windows is bright. She now wonders, what are the minimum and maximum possible number of occupied apartments if judged by the given picture?Formally, for each of the floors, she comes up with some particular apartments layout with exactly m4 two-bedroom apartments (two consecutive windows) and m2 one-bedroom apartments (single window). She then counts the total number of apartments that have at least one bright window. What is the minimum and maximum possible number she can get?" 2000
1804C "Pull Your Luck" "brute force,greedy,math,number theory" "While James is gone on business, Vesper takes her time and explores what the legendary Casino Royale has to offer to people who are fond of competitive programming.Her attention was grabbed by the very new ""Pull Your Luck"" roulette which functions in a pretty peculiar way. The roulette\'s wheel consists of n sectors number from 0 to n\xe2\x88\x921. There is no ball and the winning sector is determined by a static arrow pointing to one of the sectors. Sectors\' indexes go in the natural order and the wheel always spins in the direction of indexes increment. That means that sector i+1 goes right after sector i for all i from 0 to n\xe2\x88\x922, and sector 0 goes right after sector n\xe2\x88\x921.After a bet is made, the player is allowed to pull the triggering handle herself and cause the wheel to spin. If the player\'s initial pull is made with the force equal to positive integer f, the wheel will spin for f seconds. During the first second it will advance f sectors, the next second it will advance f\xe2\x88\x921 sectors, then f\xe2\x88\x922 sectors, and so on until it comes to a complete stop. After the wheel comes to a complete stop, the sector which the arrow is pointing to is the winning one.The roulette\'s arrow currently points at sector x. Vesper knows that she can pull the handle with any integer force from 1 to p inclusive. Note that it is not allowed to pull the handle with force 0, i. e. not pull it all. The biggest prize is awarded if the winning sector is 0. Now Vesper wonders if she can make sector 0 win by pulling the triggering handle exactly once?" 1500
1804B Vaccination greedy,implementation "Ethan runs a vaccination station to help people combat the seasonal flu. He analyses the historical data in order to develop an optimal strategy for vaccine usage.Consider there are n patients coming to the station on a particular day. The i-th patient comes at the moment ti. We know that each of these patients can be asked to wait for no more than w time moments. That means the i-th patient can get vaccine at moments ti,ti+1,\xe2\x80\xa6,ti+w.Vaccines come in packs, each pack consists of k doses. Each patient needs exactly one dose. Packs are stored in a special fridge. After a pack is taken out of the fridge and opened, it can no longer be put back. The lifetime of the vaccine outside the fridge is d moments of time. Thus, if the pack was taken out of the fridge and opened at moment x, its doses can be used to vaccinate patients at moments x,x+1,\xe2\x80\xa6,x+d. At moment x+d+1 all the remaining unused doses of this pack are thrown away.Assume that the vaccination station has enough staff to conduct an arbitrary number of operations at every moment of time. What is the minimum number of vaccine packs required to vaccinate all n patients?" 1000
1804A "Lame King" greedy,math "You are given a checkerboard of size 201\xc3\x97201, i. e. it has 201 rows and 201 columns. The rows of this checkerboard are numbered from \xe2\x88\x92100 to 100 from bottom to top. The columns of this checkerboard are numbered from \xe2\x88\x92100 to 100 from left to right. The notation (r,c) denotes the cell located in the r-th row and the c-th column.There is a king piece at position (0,0) and it wants to get to position (a,b) as soon as possible. In this problem our king is lame. Each second, the king makes exactly one of the following five moves.   Skip move. King\'s position remains unchanged.  Go up. If the current position of the king is (r,c) he goes to position (r+1,c).  Go down. Position changes from (r,c) to (r\xe2\x88\x921,c).  Go right. Position changes from (r,c) to (r,c+1).  Go left. Position changes from (r,c) to (r,c\xe2\x88\x921).  King is not allowed to make moves that put him outside of the board. The important consequence of the king being lame is that he is not allowed to make the same move during two consecutive seconds. For example, if the king goes right, the next second he can only skip, go up, down, or left.What is the minimum number of seconds the lame king needs to reach position (a,b)?" 800
1802B "Settlement of Guinea Pigs" greedy,implementation,math "Dasha loves guinea pigs very much. In this regard, she decided to settle as many guinea pigs at home as possible and developed a plan for the next n days. Every day, she will either buy a new guinea pig or call a doctor to examine all her pets.Unfortunately, the store where she was going to buy guinea pigs does not understand them. Therefore, it cannot determine their gender. Dasha can\'t do it either. The only one who can help is a doctor. To keep guinea pigs, aviaries are needed. Dasha plans to buy them in the same store. Unfortunately, only one species is sold there \xe2\x80\x94 a double aviary. No more than two guinea pigs can live in it.Since Dasha does not want to cause moral injury to her pets \xe2\x80\x94 she will not settle two guinea pigs of different genders in one aviary.Help Dasha calculate how many aviaries in the worst case you need to buy so that you can be sure that at no moment of time do two guinea pigs of different genders live in the same aviary.As part of this task, we believe that guinea pigs have only two genders \xe2\x80\x94 male and female." 1000
1802A Likes greedy,implementation "Nikita recently held a very controversial round, after which his contribution changed very quickly.The announcement hung on the main page for n seconds. In the ith second |ai|th person either liked or removed the like (Nikita was lucky in this task and there are no dislikes). If ai>0, then the aith person put a like. If ai<0, then the person \xe2\x88\x92ai removed the like. Each person put and removed the like no more than once. A person could not remove a like if he had not put it before.Since Nikita\'s contribution became very bad after the round, he wanted to analyze how his contribution changed while the announcement was on the main page. He turned to the creator of the platform with a request to give him the sequence a1,a2,\xe2\x80\xa6,an. But due to the imperfection of the platform, the sequence a was shuffled.You are given a shuffled sequence of a that describes user activity. You need to tell for each moment from 1 to n what the maximum and minimum number of likes could be on the post at that moment." 800
1801G "A task for substrings" "data structures,string suffix structures,strings" "Philip is very fond of tasks on the lines. He had already solved all the problems known to him, but this was not enough for him. Therefore, Philip decided to come up with his own task.To do this, he took the string t and a set of n strings s1, s2, s3, ..., sn. Philip has m queries, in the ith of them, Philip wants to take a substring of the string t from lith to rith character, and count the number of its substrings that match some string from the set. More formally, Philip wants to count the number of pairs of positions a, b, such that li\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4ri, and the substring of the string t from ath to bth character coincides with some string sj from the set.A substring of the string t from ath to bth character is a string obtained from t by removing the a\xe2\x88\x921 character from the beginning and |t|\xe2\x88\x92b characters from the end, where |t| denotes the length of the string t.Philip has already solved this problem, but can you?" 3400
1801F "Another n-dimensional chocolate bar" "dp,math,meet-in-the-middle,number theory" "Mom bought the boy Vasya a n-dimensional chocolate bar, which is a n-dimensional cube with the length of each side equal to 1. The chocolate is planned to be divided into slices. According to the ith dimension, it can be divided by hyperplanes into ai equal parts. Thus, the chocolate is divided in total into a1\xe2\x8b\x85a2\xe2\x8b\x85a3\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85an slices, each slice has a length of i-th dimension equal to 1ai, respectively, the volume of each slice is 1a1a2\xe2\x8b\xafan.Vasya and his friends want to cut a chocolate bar to get at least k pieces, while Vasya wants to maximize the volume of the smallest of them. It is possible to cut the chocolate bar only at the junction of the lobules, and each incision must pass through the entire chocolate bar along some hyperplane involved in the formation of lobules. Only after making all the cuts, Vasya disassembles the chocolate into pieces.More formally, Vasya wants to choose the numbers b1,b2,\xe2\x80\xa6,bn (1\xe2\x89\xa4bi\xe2\x89\xa4ai) \xe2\x80\x94 the number of parts into which Vasya will cut the chocolate bar along each dimension. The condition b1\xe2\x8b\x85b2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85bn\xe2\x89\xa5k must be met to get at least k pieces after all cuts. It can be noted that with optimal cutting with such parameters, the minimum piece will contain \xe2\x8c\x8aa1b1\xe2\x8c\x8b\xe2\x8b\xaf\xe2\x8c\x8aanbn\xe2\x8c\x8b slices, and its volume will be equal to \xe2\x8c\x8aa1b1\xe2\x8c\x8b\xe2\x8b\xaf\xe2\x8c\x8aanbn\xe2\x8c\x8b\xe2\x8b\x851a1a2\xe2\x8b\xafan.Vasya wants to get the maximum possible value of the volume of the minimum piece multiplied by k, that is, he wants to maximize the number of \xe2\x8c\x8aa1b1\xe2\x8c\x8b\xe2\x8b\xaf\xe2\x8c\x8aanbn\xe2\x8c\x8b\xe2\x8b\x851a1a2\xe2\x8b\xafan\xe2\x8b\x85k. Help him with this." 2700
1801E "Gasoline prices" "data structures,divide and conquer,dsu,hashing,trees" "Berland \xe2\x80\x94 is a huge country consisting of n cities. The road network of Berland can be represented as a root tree, that is, there is only n\xe2\x88\x921 road in the country, and you can get from any city to any other exactly one way, if you do not visit any city twice. For the convenience of representing the country, for each city i, the city pi is fixed, equal to the first city to which you need to go from the city i to get to the city 1. In other words, the city pi is equal to the ancestor of the city i if the tree is hung for the city 1.There is one gas station in each city of Berland. Gas stations have special pricing, and for each gas station there is a fixed range of prices for which they are ready to sell gasoline. A gas station in the city with the number i is ready to sell gasoline at any price from li to ri inclusive.The King of Berland \xe2\x80\x94 is an exemplary family man, and for m years, two sons were born to him every year. The king\'s children have been involved in public affairs since early childhood, and at the end of each year they check the honesty of gasoline prices. From birth, the king\'s children, who are born in the year i, are responsible for checking gasoline prices on the ways from the city of ai to the city of bi and from the city of ci to the city of di, respectively.The check is as follows: both children simultaneously start their journey from the cities ai and ci, respectively. The first son of the king, born in the year i, moves along the path from the city ai to the city bi, and the second  \xe2\x80\x94 from the city ci to the city di. Children check that the price of gasoline in the city of ai coincides with the price of gasoline in the city of ci. Next, they check that the price of gasoline in the second city on the way from ai to bi coincides with the price in the second city on the way from ci to di. Then they repeat the same thing for a couple of third cities on their paths and so on. At the end, they check that the price of gasoline in the city of bi coincides with the price of gasoline in the city of di. It is guaranteed that the length of the path from the city ai to the city bi coincides with the length of the path from the city ci to the city di.Gas stations must strictly obey the laws, and therefore all checks of gasoline prices should not reveal violations. Help Berland gas stations find out how many ways they can set gasoline prices for m years. In other words, for each i from 1 to m, calculate how many ways you can set gasoline prices at all gas stations so that after the birth of the first i pairs of the king\'s children, all their checks did not reveal violations, and at any gas station the price was in the acceptable price range. Since the number of such methods can be large, calculate the answer modulo 109+7." 3000
1801D "The way home" "binary search,data structures,dp,graphs,greedy,shortest paths,sortings" "The famous magician Borya Budini traveled through the country X, which consists of n cities. However, an accident happened, and he was robbed in the city number 1. Now Budini will have a hard way home to the city number n.He\'s going to get there by plane. In total, there are m flights in the country, i-th flies from city ai to city bi and costs si coins. Note that the i-th flight is one-way, so it can\'t be used to get from city bi to city ai. To use it, Borya must be in the city ai and have at least si coins (which he will spend on the flight). After the robbery, he has only p coins left, but he does not despair! Being in the city i, he can organize performances every day, each performance will bring him wi coins. Help the magician find out if he will be able to get home, and what is the minimum number of performances he will have to organize." 2100
1801C "Music Festival" "binary search,data structures,dp,greedy,sortings" "The boy Vitya loves to listen to music very much. He knows that n albums are due to be released this Friday, i-th of which contains ki tracks. Of course, Vitya has already listened to all the tracks, and knows that in the i-th album, the coolness of the j-th track is equal to ai,j.Vitya has a friend Masha, whom he really wants to invite to the festival, where his favorite bands perform. However, in order for a friend to agree, she must first evaluate the released novelties. Vitya knows that if Masha listens to a track that was cooler than all the previous ones, she will get 1 unit of impression. Unfortunately, albums can only be listened to in their entirety, without changing the songs in them in places.Help Vitya find such an order of albums so that Masha\'s impression turns out to be as much as possible, and she definitely went to the festival with him." 1900
1801B "Buying gifts" "data structures,greedy,sortings" "Little Sasha has two friends, whom he wants to please with gifts on the Eighth of March. To do this, he went to the largest shopping center in the city.There are n departments in the mall, each of which has exactly two stores. For convenience, we number the departments with integers from 1 to n. It is known that gifts in the first store of the i department cost ai rubles, and in the second store of the i department \xe2\x80\x94 bi rubles.Entering the mall, Sasha will visit each of the n departments of the mall, and in each department, he will enter exactly one store. When Sasha gets into the i-th department, he will perform exactly one of two actions:  Buy a gift for the first friend, spending ai rubles on it.  Buy a gift for the second friend, spending bi rubles on it. Sasha is going to buy at least one gift for each friend. Moreover, he wants to pick up gifts in such a way that the price difference of the most expensive gifts bought for friends is as small as possible so that no one is offended.More formally: let m1  be the maximum price of a gift bought to the first friend, and m2  be the maximum price of a gift bought to the second friend. Sasha wants to choose gifts in such a way as to minimize the value of |m1\xe2\x88\x92m2|." 1800
1801A "The Very Beautiful Blanket" "bitmasks,constructive algorithms" "Kirill wants to weave the very beautiful blanket consisting of n\xc3\x97m of the same size square patches of some colors. He matched some non-negative integer to each color. Thus, in our problem, the blanket can be considered a B matrix of size n\xc3\x97m consisting of non-negative integers.Kirill considers that the blanket is very beautiful, if for each submatrix A of size 4\xc3\x974 of the matrix B is true: A11\xe2\x8a\x95A12\xe2\x8a\x95A21\xe2\x8a\x95A22=A33\xe2\x8a\x95A34\xe2\x8a\x95A43\xe2\x8a\x95A44, A13\xe2\x8a\x95A14\xe2\x8a\x95A23\xe2\x8a\x95A24=A31\xe2\x8a\x95A32\xe2\x8a\x95A41\xe2\x8a\x95A42,where \xe2\x8a\x95 means bitwise exclusive ORKirill asks you to help her weave a very beautiful blanket, and as colorful as possible!He gives you two integers n and m. Your task is to generate a matrix B of size n\xc3\x97m, which corresponds to a very beautiful blanket and in which the number of different numbers maximized." 1600
1800G Symmetree "dfs and similar,hashing,implementation,trees" "Kid was gifted a tree of n vertices with the root in the vertex 1. Since he really like symmetrical objects, Kid wants to find out if this tree is symmetrical.  For example, the trees in the picture above are symmetrical.   And the trees in this picture are not symmetrical. Formally, a tree is symmetrical if there exists an order of children such that:  The subtree of the leftmost child of the root is a mirror image of the subtree of the rightmost child;  the subtree of the second-left child of the root is a mirror image of the subtree of the second-right child of the root;  ...  if the number of children of the root is odd, then the subtree of the middle child should be symmetrical." 2200
1800F "Dasha and Nightmares" bitmasks,hashing,meet-in-the-middle,strings "Dasha, an excellent student, is studying at the best mathematical lyceum in the country. Recently, a mysterious stranger brought n words consisting of small latin letters s1,s2,\xe2\x80\xa6,sn to the lyceum. Since that day, Dasha has been tormented by nightmares.Consider some pair of integers \xe2\x9f\xa8i,j\xe2\x9f\xa9 (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n). A nightmare is a string for which it is true:  It is obtained by concatenation sisj;  Its length is odd;  The number of different letters in it is exactly 25;  The number of occurrences of each letter that is in the word is odd. For example, if si= ""abcdefg"" and sj= ""ijklmnopqrstuvwxyz"", the pair \xe2\x9f\xa8i,j\xe2\x9f\xa9 creates a nightmare.Dasha will stop having nightmares if she counts their number. There are too many nightmares, so Dasha needs your help. Count the number of different nightmares.Nightmares are called different if the corresponding pairs \xe2\x9f\xa8i,j\xe2\x9f\xa9 are different. The pairs \xe2\x9f\xa8i1,j1\xe2\x9f\xa9 and \xe2\x9f\xa8i2,j2\xe2\x9f\xa9 are called different if i1\xe2\x89\xa0i2 or j1\xe2\x89\xa0j2." 1900
1800E2 "Unforgivable Curse (hard version)" "brute force,constructive algorithms,dfs and similar,dsu,graphs,greedy,strings" "This is a complex version of the problem. This version has no additional restrictions on the number k.The chief wizard of the Wizengamot once caught the evil wizard Drahyrt, but the evil wizard has returned and wants revenge on the chief wizard. So he stole spell s from his student Harry.The spell \xe2\x80\x94 is a n-length string of lowercase Latin letters.Drahyrt wants to replace spell with an unforgivable curse \xe2\x80\x94 string t.Dragirt, using ancient magic, can swap letters at a distance k or k+1 in spell as many times as he wants. In other words, Drahyrt can change letters in positions i and j in spell s if |i\xe2\x88\x92j|=k or |i\xe2\x88\x92j|=k+1.For example, if k=3,s= ""talant"" and t= ""atltna"", Drahyrt can act as follows:  swap the letters at positions 1 and 4 to get spell ""aaltnt"".  swap the letters at positions 2 and 6 to get spell ""atltna"". You are given spells s and t. Can Drahyrt change spell s to t?" 1500
1800E1 "Unforgivable Curse (easy version)" "brute force,constructive algorithms,dsu,graphs,greedy,strings" "This is an easy version of the problem. In this version, k is always 3.The chief wizard of the Wizengamot once caught the evil wizard Drahyrt, but the evil wizard has returned and wants revenge on the chief wizard. So he stole spell s from his student Harry.The spell \xe2\x80\x94 is a n-length string of lowercase Latin letters.Drahyrt wants to replace spell with an unforgivable curse \xe2\x80\x94 string t.Drahyrt, using ancient magic, can swap letters at a distance k or k+1 in spell as many times as he wants. In this version of the problem, you can swap letters at a distance of 3 or 4. In other words, Drahyrt can change letters in positions i and j in spell s if |i\xe2\x88\x92j|=3 or |i\xe2\x88\x92j|=4.For example, if s= ""talant"" and t= ""atltna"", Drahyrt can act as follows:  swap the letters at positions 1 and 4 to get spell ""aaltnt"".  swap the letters at positions 2 and 6 to get spell ""atltna"". You are given spells s and t. Can Drahyrt change spell s to t?" 1400
1800D "Remove Two Letters" "data structures,greedy,hashing,strings" "Dmitry has a string s, consisting of lowercase Latin letters.Dmitry decided to remove two consecutive characters from the string s and you are wondering how many different strings can be obtained after such an operation.For example, Dmitry has a string ""aaabcc"". You can get the following different strings: ""abcc""(by deleting the first two or second and third characters), ""aacc""(by deleting the third and fourth characters),""aaac""(by deleting the fourth and the fifth character) and ""aaab"" (by deleting the last two)." 1200
1800C2 "Powering the Hero (hard version)" "data structures,greedy" "This is a hard version of the problem. It differs from the easy one only by constraints on n and t.There is a deck of n cards, each of which is characterized by its power. There are two types of cards:  a hero card, the power of such a card is always equal to 0;  a bonus card, the power of such a card is always positive. You can do the following with the deck:  take a card from the top of the deck;  if this card is a bonus card, you can put it on top of your bonus deck or discard;  if this card is a hero card, then the power of the top card from your bonus deck is added to his power (if it is not empty), after that the hero is added to your army, and the used bonus discards. Your task is to use such actions to gather an army with the maximum possible total power." 1100
1800C1 "Powering the Hero (easy version)" "data structures,greedy" "This is an easy version of the problem. It differs from the hard one only by constraints on n and t.There is a deck of n cards, each of which is characterized by its power. There are two types of cards:  a hero card, the power of such a card is always equal to 0;  a bonus card, the power of such a card is always positive. You can do the following with the deck:  take a card from the top of the deck;  if this card is a bonus card, you can put it on top of your bonus deck or discard;  if this card is a hero card, then the power of the top card from your bonus deck is added to his power (if it is not empty), after that the hero is added to your army, and the used bonus discards. Your task is to use such actions to gather an army with the maximum possible total power." 1000
1800B "Count the Number of Pairs" greedy,strings "Kristina has a string s of length n, consisting only of lowercase and uppercase Latin letters. For each pair of lowercase letter and its matching uppercase letter, Kristina can get 1 burl. However, pairs of characters cannot overlap, so each character can only be in one pair.For example, if she has the string s = ""aAaaBACacbE"", she can get a burl for the following character pairs:   s1 = ""a"" and s2 = ""A""  s4 = ""a"" and s6 = ""A""  s5 = ""B"" and s10 = ""b""  s7= ""C"" and s9 = ""c"" Kristina wants to get more burles for her string, so she is going to perform no more than k operations on it. In one operation, she can:  either select the lowercase character si (1\xe2\x89\xa4i\xe2\x89\xa4n) and make it uppercase.  or select uppercase character si (1\xe2\x89\xa4i\xe2\x89\xa4n) and make it lowercase. For example, when k = 2 and s = ""aAaaBACacbE"" it can perform one operation: choose s3 = ""a"" and make it uppercase. Then she will get another pair of s3 = ""A"" and s8 = ""a""Find maximum number of burles Kristina can get for her string." 1000
1800A "Is It a Cat?" implementation,strings "You were walking down the street and heard a sound. The sound was described by the string s consisting of lowercase and uppercase Latin characters. Now you want to find out if the sound was a cat meowing.For the sound to be a meowing, the string can only contain the letters \'m\', \'e\', \'o\' and \'w\', in either uppercase or lowercase. Also:   string must start with non-empty sequence consisting only of characters \'m\' or \'M\'  it must be immediately followed by non-empty sequence consisting only of characters \'e\' or \'E\'  it must be immediately followed by non-empty sequence consisting only of characters \'o\' or \'O\'  it must be immediately followed by non-empty sequence consisting only of characters \'w\' or \'W\', this sequence ends the string, after it immediately comes the string end For example, strings ""meow"", ""mmmEeOWww"", ""MeOooOw"" describe a meowing, but strings ""Mweo"", ""MeO"", ""moew"", ""MmEW"", ""meowmeow"" do not.Determine whether the sound you heard was a cat meowing or something else." 800
1799H "Tree Cutting" "bitmasks,dfs and similar,dp" "You are given a tree with n vertices.A hero k times do the following operation:  Choose some edge.  Remove it.  Take one of the two remaining parts and delete it.  Write the number of vertices in the remaining part. You are given an initial tree and the a sequence of written numbers. Find the number of ways to make operations such that the written numbers are equal to the given numbers. Due to the answer can be big, find it by modulo 998244353. Two ways are considered different, if on some operation edge or remaining part are selected differently." 3200
1799G "Count Voting" combinatorics,dp,math "There are n people that will participate in voting. Each person has exactly one vote.i-th person has a team ti (1\xe2\x89\xa4ti\xe2\x89\xa4n) where ti=tj means i, j are in the same team. By the rules each person should vote for the person from the different team. Note that it automatically means that each person can\'t vote for himself.Each person knows the number of votes ci he wants to get. How many possible votings exists, such that each person will get the desired number of votes? Due to this number can be big, find it by modulo 998244353." 2600
1799F "Halve or Subtract" "binary search,brute force,dp,greedy,sortings" "You have an array of positive integers a1,a2,\xe2\x80\xa6,an, of length n. You are also given a positive integer b.You are allowed to perform the following operations (possibly several) times in any order:   Choose some 1\xe2\x89\xa4i\xe2\x89\xa4n, and replace ai with \xe2\x8c\x88ai2\xe2\x8c\x89. Here, \xe2\x8c\x88x\xe2\x8c\x89 denotes the smallest integer not less than x.  Choose some 1\xe2\x89\xa4i\xe2\x89\xa4n, and replace ai with max(ai\xe2\x88\x92b,0). However, you must also follow these rules:   You can perform at most k1 operations of type 1 in total.  You can perform at most k2 operations of type 2 in total.  For all 1\xe2\x89\xa4i\xe2\x89\xa4n, you can perform at most 1 operation of type 1 on element ai.  For all 1\xe2\x89\xa4i\xe2\x89\xa4n, you can perform at most 1 operation of type 2 on element ai. The cost of an array is the sum of its elements. Find the minimum cost of a you can achieve by performing these operations." 2700
1799E "City Union" "constructive algorithms,dfs and similar,dsu,geometry,greedy,implementation,math" "You are given n\xc3\x97m grid. Some cells are filled and some are empty.A city is a maximal (by inclusion) set of filled cells such that it is possible to get from any cell in the set to any other cell in the set by moving to adjacent (by side) cells, without moving into any cells not in the set. In other words, a city is a connected component of filled cells with edges between adjacent (by side) cells.Initially, there are two cities on the grid. You want to change some empty cells into filled cells so that both of the following are satisfied:   There is one city on the resulting grid.  The shortest path between any two filled cells, achievable only by moving onto filled cells, is equal to the Manhattan distance between them. The Manhattan distance between two cells (a,b) and (c,d) is equal to |a\xe2\x88\x92c|+|b\xe2\x88\x92d|.Find a way to add filled cells that satisfies these conditions and minimizes the total number of filled cells." 2300
1799D2 "Hot Start Up (hard version)" "data structures,dp" "This is a hard version of the problem. The constraints of t, n, k are the only difference between versions.You have a device with two CPUs. You also have k programs, numbered 1 through k, that you can run on the CPUs. The i-th program (1\xe2\x89\xa4i\xe2\x89\xa4k) takes coldi seconds to run on some CPU. However, if the last program we ran on this CPU was also program i, it only takes hoti seconds (hoti\xe2\x89\xa4coldi). Note that this only applies if we run program i multiple times consecutively  \xe2\x80\x94 if we run program i, then some different program, then program i again, it will take coldi seconds the second time.You are given a sequence a1,a2,\xe2\x80\xa6,an of length n, consisting of integers from 1 to k. You need to use your device to run programs a1,a2,\xe2\x80\xa6,an in sequence. For all 2\xe2\x89\xa4i\xe2\x89\xa4n, you cannot start running program ai until program ai\xe2\x88\x921 has completed.Find the minimum amount of time needed to run all programs a1,a2,\xe2\x80\xa6,an in sequence." 2100
1799D1 "Hot Start Up (easy version)" dp "This is an easy version of the problem. The constraints of t, n, k are the only difference between versions.You have a device with two CPUs. You also have k programs, numbered 1 through k, that you can run on the CPUs. The i-th program (1\xe2\x89\xa4i\xe2\x89\xa4k) takes coldi seconds to run on some CPU. However, if the last program we ran on this CPU was also program i, it only takes hoti seconds (hoti\xe2\x89\xa4coldi). Note that this only applies if we run program i multiple times consecutively  \xe2\x80\x94 if we run program i, then some different program, then program i again, it will take coldi seconds the second time.You are given a sequence a1,a2,\xe2\x80\xa6,an of length n, consisting of integers from 1 to k. You need to use your device to run programs a1,a2,\xe2\x80\xa6,an in sequence. For all 2\xe2\x89\xa4i\xe2\x89\xa4n, you cannot start running program ai until program ai\xe2\x88\x921 has completed.Find the minimum amount of time needed to run all programs a1,a2,\xe2\x80\xa6,an in sequence." 1900
1799C "Double Lexicographically Minimum" greedy,strings "You are given a string s. You can reorder the characters to form a string t. Define tmax to be the lexicographical maximum of t and t in reverse order.Given s determine the lexicographically minimum value of tmax over all reorderings t of s.A string a is lexicographically smaller than a string b if and only if one of the following holds:   a is a prefix of b, but a\xe2\x89\xa0b;  in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 1700
1799B "Equalize by Divide" "brute force,constructive algorithms,greedy,math" "You are given an array a1,a2,\xe2\x80\xa6,an of positive integers.You can make this operation multiple (possibly zero) times:  Choose two indices i, j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j).  Assign ai:=\xe2\x8c\x88aiaj\xe2\x8c\x89. Here \xe2\x8c\x88x\xe2\x8c\x89 denotes x rounded up to the smallest integer \xe2\x89\xa5x. Is it possible to make all array elements equal by some sequence of operations (possibly empty)? If yes, print any way to do it in at most 30n operations.It can be proven, that under the problem constraints, if some way exists to make all elements equal, there exists a way with at most 30n operations." 1200
1799A "Recent Actions" "data structures,greedy,implementation,math" "On Codeforces the ""Recent Actions"" field shows the last n posts with recent actions.Initially, there are posts 1,2,\xe2\x80\xa6,n in the field (this is in order from top to down). Also there are infinitely many posts not in the field, numbered with integers n+1,n+2,\xe2\x80\xa6.When recent action happens in the post p:  If it is in the ""Recent Actions"" field, it moves from its position to the top position.  Otherwise, it is added to the top position, and the post on the down position is removed from the ""Recent Actions"" field. You know, that the next m recent actions will happen in the posts p1,p2,\xe2\x80\xa6,pm (n+1\xe2\x89\xa4pi\xe2\x89\xa4n+m) in the moments of time 1,2,\xe2\x80\xa6,m. Note, that recent actions only happen with posts with numbers \xe2\x89\xa5n+1.For each post i (1\xe2\x89\xa4i\xe2\x89\xa4n), find the first time it will be removed from the ""Recent Actions"" field or say, that it won\'t be removed." 800
1798F "Gifts from Grandfather Ahmed" "dp,math,number theory" "Grandfather Ahmed\'s School has n+1 students. The students are divided into k classes, and si students study in the i-th class. So, s1+s2+\xe2\x80\xa6+sk=n+1.Due to the upcoming April Fools\' Day, all students will receive gifts!Grandfather Ahmed planned to order n+1 boxes of gifts. Each box can contain one or more gifts. He plans to distribute the boxes between classes so that the following conditions are satisfied:  Class number i receives exactly si boxes (so that each student can open exactly one box).  The total number of gifts in the boxes received by the i-th class should be a multiple of si (it should be possible to equally distribute the gifts among the si students of this class). Unfortunately, Grandfather Ahmed ordered only n boxes with gifts, the i-th of which contains ai gifts.Ahmed has to buy the missing gift box, and the number of gifts in the box should be an integer between 1 and 106. Help Ahmed to determine, how many gifts should the missing box contain, and build a suitable distribution of boxes to classes, or report that this is impossible." 2500
1798E "Multitest Generator" "brute force,dp" "Let\'s call an array b1,b2,\xe2\x80\xa6,bm a test if b1=m\xe2\x88\x921.Let\'s call an array b1,b2,\xe2\x80\xa6,bm a multitest if the array b2,b3,\xe2\x80\xa6,bm can be split into b1 non-empty subarrays so that each of these subarrays is a test. Note that each element of the array must be included in exactly one subarray, and the subarrays must consist of consecutive elements.Let\'s define the function f from the array b1,b2,\xe2\x80\xa6,bm as the minimum number of operations of the form ""Replace any bi with any non-negative integer x"", which needs to be done so that the array b1,b2,\xe2\x80\xa6,bm becomes a multitest.You are given an array of positive integers a1,a2,\xe2\x80\xa6,an. For each i from 1 to n\xe2\x88\x921, find f([ai,ai+1,\xe2\x80\xa6,an]).Below are some examples of tests and multitests.   Tests: [1_,5], [2_,2,2], [3_,4,1,1], [5_,0,0,0,0,0], [7_,1,2,3,4,5,6,7], [0_]. These arrays are tests since their first element (underlined) is equal to the length of the array minus one.  Multitests: [1,1_,1_], [2,3_,0,0,1_,1_,12_], [3,2_,2,7_,1_,1_,3_,4,4,4_], [4,0__,3_,1,7,9_,4_,2,0,0,9_,1_,777_]. Underlined are the subarrays after the split, and double underlined are the first elements of each subarray." 2300
1798D "Shocking Arrangement" "constructive algorithms,greedy,math" "You are given an array a1,a2,\xe2\x80\xa6,an consisting of integers such that a1+a2+\xe2\x80\xa6+an=0.You have to rearrange the elements of the array a so that the following condition is satisfied:max1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n|al+al+1+\xe2\x80\xa6+ar|<max(a1,a2,\xe2\x80\xa6,an)\xe2\x88\x92min(a1,a2,\xe2\x80\xa6,an), where |x| denotes the absolute value of x.More formally, determine if there exists a permutation p1,p2,\xe2\x80\xa6,pn that for the array ap1,ap2,\xe2\x80\xa6,apn, the condition above is satisfied, and find the corresponding array.Recall that the array p1,p2,\xe2\x80\xa6,pn is called a permutation if for each integer x from 1 to n there is exactly one i from 1 to n such that pi=x." 1600
1798C "Candy Store" "greedy,math,number theory" "The store sells n types of candies with numbers from 1 to n. One candy of type i costs bi coins. In total, there are ai candies of type i in the store.You need to pack all available candies in packs, each pack should contain only one type of candies. Formally, for each type of candy i you need to choose the integer di, denoting the number of type i candies in one pack, so that ai is divided without remainder by di.Then the cost of one pack of candies of type i will be equal to bi\xe2\x8b\x85di. Let\'s denote this cost by ci, that is, ci=bi\xe2\x8b\x85di.After packaging, packs will be placed on the shelf. Consider the cost of the packs placed on the shelf, in order c1,c2,\xe2\x80\xa6,cn. Price tags will be used to describe costs of the packs. One price tag can describe the cost of all packs from l to r inclusive if cl=cl+1=\xe2\x80\xa6=cr. Each of the packs from 1 to n must be described by at least one price tag. For example, if c1,\xe2\x80\xa6,cn=[4,4,2,4,4], to describe all the packs, a 3 price tags will be enough, the first price tag describes the packs 1,2, the second: 3, the third: 4,5.You are given the integers a1,b1,a2,b2,\xe2\x80\xa6,an,bn. Your task is to choose integers di so that ai is divisible by di for all i, and the required number of price tags to describe the values of c1,c2,\xe2\x80\xa6,cn is the minimum possible.For a better understanding of the statement, look at the illustration of the first test case of the first test:  Let\'s repeat the meaning of the notation used in the problem:ai \xe2\x80\x94 the number of candies of type i available in the store.bi \xe2\x80\x94 the cost of one candy of type i.di \xe2\x80\x94 the number of candies of type i in one pack.ci \xe2\x80\x94 the cost of one pack of candies of type i is expressed by the formula ci=bi\xe2\x8b\x85di." 1700
1798B "Three Sevens" "brute force,data structures,greedy,implementation" "Lottery ""Three Sevens"" was held for m days. On day i, ni people with the numbers ai,1,\xe2\x80\xa6,ai,ni participated in the lottery.It is known that in each of the m days, only one winner was selected from the lottery participants. The lottery winner on day i was not allowed to participate in the lottery in the days from i+1 to m.Unfortunately, the information about the lottery winners has been lost. You need to find any possible list of lottery winners on days from 1 to m or determine that no solution exists." 1000
1798A Showstopper greedy,implementation,sortings "You are given two arrays a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn.In one operation, you can choose any integer i from 1 to n and swap the numbers ai and bi.Determine whether, after using any (possibly zero) number of operations, the following two conditions can be satisfied simultaneously:  an=max(a1,a2,\xe2\x80\xa6,an),  bn=max(b1,b2,\xe2\x80\xa6,bn). Here max(c1,c2,\xe2\x80\xa6,ck) denotes the maximum number among c1,c2,\xe2\x80\xa6,ck. For example, max(3,5,4)=5, max(1,7,7)=7, max(6,2)=6." 800
1797F "Li Hua and Path" "data structures,dfs and similar,divide and conquer,dsu,trees" "Li Hua has a tree of n vertices and n\xe2\x88\x921 edges. The vertices are numbered from 1 to n.A pair of vertices (u,v) (u<v) is considered cute if exactly one of the following two statements is true:  u is the vertex with the minimum index among all vertices on the path (u,v).  v is the vertex with the maximum index among all vertices on the path (u,v).There will be m operations. In each operation, he decides an integer kj, then inserts a vertex numbered n+j to the tree, connecting with the vertex numbered kj.He wants to calculate the number of cute pairs before operations and after each operation.Suppose you were Li Hua, please solve this problem." 3000
1797E "Li Hua and Array" "brute force,data structures,dsu,math,number theory,two pointers" "Li Hua wants to solve a problem about \xcf\x86 \xe2\x80\x94 Euler\'s totient function. Please recall that \xcf\x86(x)=x\xe2\x88\x91i=1[gcd(i,x)=1].\xe2\x80\xa0,\xe2\x80\xa1He has a sequence a1,a2,\xe2\x8b\xaf,an and he wants to perform m operations:  ""1 l r"" (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) \xe2\x80\x94 for each x\xe2\x88\x88[l,r], change ax into \xcf\x86(ax).  ""2 l r"" (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) \xe2\x80\x94 find out the minimum changes needed to make sure al=al+1=\xe2\x8b\xaf=ar. In each change, he chooses one x\xe2\x88\x88[l,r], change ax into \xcf\x86(ax). Each operation of this type is independent, which means the array doesn\'t actually change. Suppose you were Li Hua, please solve this problem.\xe2\x80\xa0 gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y. \xe2\x80\xa1 The notation [cond] equals 1 if the condition cond is true, and 0 otherwise." 2300
1797D "Li Hua and Tree" "brute force,data structures,dfs and similar,dp,implementation,trees" "Li Hua has a tree of n vertices and n\xe2\x88\x921 edges. The root of the tree is vertex 1. Each vertex i has importance ai. Denote the size of a subtree as the number of vertices in it, and the importance as the sum of the importance of vertices in it. Denote the heavy son of a non-leaf vertex as the son with the largest subtree size. If multiple of them exist, the heavy son is the one with the minimum index.Li Hua wants to perform m operations:  ""1 x"" (1\xe2\x89\xa4x\xe2\x89\xa4n) \xe2\x80\x94 calculate the importance of the subtree whose root is x.  ""2 x"" (2\xe2\x89\xa4x\xe2\x89\xa4n) \xe2\x80\x94 rotate the heavy son of x up. Formally, denote sonx as the heavy son of x, fax as the father of x. He wants to remove the edge between x and fax and connect an edge between sonx and fax. It is guaranteed that x is not root, but not guaranteed that x is not a leaf. If x is a leaf, please ignore the operation. Suppose you were Li Hua, please solve this problem." 1900
1797C "Li Hua and Chess" "constructive algorithms,greedy,interactive" "This is an interactive problem.Li Ming and Li Hua are playing a game. Li Hua has a chessboard of size n\xc3\x97m. Denote (r,c) (1\xe2\x89\xa4r\xe2\x89\xa4n,1\xe2\x89\xa4c\xe2\x89\xa4m) as the cell on the r-th row from the top and on the c-th column from the left. Li Ming put a king on the chessboard and Li Hua needs to guess its position.Li Hua can ask Li Ming no more than 3 questions. In each question, he can choose a cell and ask the minimum steps needed to move the king to the chosen cell. Each question is independent, which means the king doesn\'t actually move.A king can move from (x,y) to (x\xe2\x80\xb2,y\xe2\x80\xb2) if and only if max{|x\xe2\x88\x92x\xe2\x80\xb2|,|y\xe2\x88\x92y\xe2\x80\xb2|}=1 (shown in the following picture).  The position of the king is chosen before the interaction.Suppose you were Li Hua, please solve this problem." 1600
1797B "Li Hua and Pattern" "constructive algorithms,greedy" "Li Hua has a pattern of size n\xc3\x97n, each cell is either blue or red. He can perform exactly k operations. In each operation, he chooses a cell and changes its color from red to blue or from blue to red. Each cell can be chosen as many times as he wants. Is it possible to make the pattern, that matches its rotation by 180\xe2\x88\x98?Suppose you were Li Hua, please solve this problem." 1100
1797A "Li Hua and Maze" "constructive algorithms,flows,graphs,greedy,implementation" "There is a rectangular maze of size n\xc3\x97m. Denote (r,c) as the cell on the r-th row from the top and the c-th column from the left. Two cells are adjacent if they share an edge. A path is a sequence of adjacent empty cells.Each cell is initially empty. Li Hua can choose some cells (except (x1,y1) and (x2,y2)) and place an obstacle in each of them. He wants to know the minimum number of obstacles needed to be placed so that there isn\'t a path from (x1,y1) to (x2,y2).Suppose you were Li Hua, please solve this problem." 800
1796F "Strange Triples" "brute force,math,number theory" "Let\'s call a triple of positive integers (a,b,n) strange if the equality annb=ab holds, where an is the concatenation of a and n and nb is the concatenation of n and b. For the purpose of concatenation, the integers are considered without leading zeroes.For example, if a=1, b=5 and n=9, then the triple is strange, because 1995=15. But a=7, b=3 and n=11 is not strange, because 711113\xe2\x89\xa073.You are given three integers A, B and N. Calculate the number of strange triples (a,b,n), such that 1\xe2\x89\xa4a<A, 1\xe2\x89\xa4b<B and 1\xe2\x89\xa4n<N." 2900
1796E "Colored Subgraphs" "dfs and similar,dp,games,greedy,trees" "Monocarp has a tree, consisting of n vertices.He is going to select some vertex r and perform the following operations on each vertex v from 1 to n:   set dv equal to the distance from v to r (the number of edges on the shortest path);  color v some color. A nice coloring satisfies two conditions:   for each pair of vertices of the same color (v,u), there exists a path from v to u that only visits vertices of the same color;  for each pair of vertices of the same color (v,u), dv\xe2\x89\xa0du. Note that Monocarp can choose any amount of different colors he wants to use.For each used color, he then counts the number of vertices of this color. The cost of the tree is the minimum of these numbers.What can be the maximum cost of the tree?" 2500
1796D "Maximum Subarray" "data structures,dp,greedy,two pointers" "You are given an array a1,a2,\xe2\x80\xa6,an, consisting of n integers. You are also given two integers k and x.You have to perform the following operation exactly once: add x to the elements on exactly k distinct positions, and subtract x from all the others.For example, if a=[2,\xe2\x88\x921,2,3], k=1, x=2, and we have picked the first element, then after the operation the array a=[4,\xe2\x88\x923,0,1].Let f(a) be the maximum possible sum of a subarray of a. The subarray of a is a contiguous part of the array a, i.\xe2\x80\x89e. the array ai,ai+1,\xe2\x80\xa6,aj for some 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n. An empty subarray should also be considered, it has sum 0.Let the array a\xe2\x80\xb2 be the array a after applying the aforementioned operation. Apply the operation in such a way that f(a\xe2\x80\xb2) is the maximum possible, and print the maximum possible value of f(a\xe2\x80\xb2)." 2000
1796C "Maximum Set" "binary search,math" "A set of positive integers S is called beautiful if, for every two integers x and y from this set, either x divides y or y divides x (or both).You are given two integers l and r. Consider all beautiful sets consisting of integers not less than l and not greater than r. You have to print two numbers:  the maximum possible size of a beautiful set where all elements are from l to r;  the number of beautiful sets consisting of integers from l to r with the maximum possible size. Since the second number can be very large, print it modulo 998244353." 1600
1796B "Asterisk-Minor Template" implementation,strings "You are given two strings a and b, consisting of lowercase Latin letters.A template t is string, consisting of lowercase Latin letters and asterisks (character \'*\'). A template is called asterisk-minor if the number of asterisks in it is less than or equal to the number of letters in it.A string s is said to be matching a template t if you can replace each asterisk in t with a string of lowercase Latin letters (possibly, an empty string) so that it becomes equal to s.Find an asterisk-minor template such that both a and b match it, or report that such a template doesn\'t exist. If there are multiple answers, print any of them." 1000
1796A "Typical Interview Problem" "brute force,implementation,strings" "The FB-string is formed as follows. Initially, it is empty. We go through all positive integers, starting from 1, in ascending order, and do the following for each integer:  if the current integer is divisible by 3, append F to the end of the FB-string;  if the current integer is divisible by 5, append B to the end of the FB-string. Note that if an integer is divisible by both 3 and 5, we append F, and then B, not in the opposite order.The first 10 characters of the FB-string are FBFFBFFBFB: the first F comes from the integer 3, the next character (B) comes from 5, the next F comes from the integer 6, and so on. It\'s easy to see that this string is infinitely long. Let fi be the i-th character of FB-string; so, f1 is F, f2 is B, f3 is F, f4 is F, and so on.You are given a string s, consisting of characters F and/or B. You have to determine whether it is a substring (contiguous subsequence) of the FB-string. In other words, determine if it is possible to choose two integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r) so that the string flfl+1fl+2\xe2\x80\xa6fr is exactly s.For example:  FFB is a substring of the FB-string: if we pick l=3 and r=5, the string f3f4f5 is exactly FFB;  BFFBFFBF is a substring of the FB-string: if we pick l=2 and r=9, the string f2f3f4\xe2\x80\xa6f9 is exactly BFFBFFBF;  BBB is not a substring of the FB-string." 800
1795G "Removal Sequences" "bitmasks,dfs and similar,graphs" "You are given a simple undirected graph, consisting of n vertices and m edges. The vertices are numbered from 1 to n. The i-th vertex has a value ai written on it.You will be removing vertices from that graph. You are allowed to remove vertex i only if its degree is equal to ai. When a vertex is removed, all edges incident to it are also removed, thus, decreasing the degree of adjacent non-removed vertices.A valid sequence of removals is a permutation p1,p2,\xe2\x80\xa6,pn (1\xe2\x89\xa4pi\xe2\x89\xa4n) such that the i-th vertex to be removed is pi, and every removal is allowed.A pair (x,y) of vertices is nice if there exist two valid sequences of removals such that x is removed before y in one of them and y is removed before x in the other one.Count the number of nice pairs (x,y) such that x<y." 2700
1795F "Blocking Chips" "binary search,constructive algorithms,dfs and similar,greedy,trees" "You are given a tree, consisting of n vertices. There are k chips, placed in vertices a1,a2,\xe2\x80\xa6,ak. All ai are distinct. Vertices a1,a2,\xe2\x80\xa6,ak are colored black initially. The remaining vertices are white.You are going to play a game where you perform some moves (possibly, zero). On the i-th move (1-indexed) you are going to move the ((i\xe2\x88\x921)modk+1)-st chip from its current vertex to an adjacent white vertex and color that vertex black. So, if k=3, you move chip 1 on move 1, chip 2 on move 2, chip 3 on move 3, chip 1 on move 4, chip 2 on move 5 and so on. If there is no adjacent white vertex, then the game ends.What\'s the maximum number of moves you can perform?" 2400
1795E Explosions? "binary search,data structures,dp,greedy,math" "You are playing yet another game where you kill monsters using magic spells. There are n cells in the row, numbered from 1 to n. Initially, the i-th cell contains the i-th monster with hi health.You have a basic spell that costs 1 MP and deals 1 damage to the monster you choose. You can cast it any number of times. Also, you have a special scroll with ""Explosion"" spell you can use only once. You want to finish killing monsters with explosion, that\'s why you, firstly, cast the basic spell several times (possibly, zero), and then after that, you cast one ""Explosion"".How does ""Explosion"" spell work? Firstly, you choose the power of the spell: if you pour x MP into it, ""Explosion"" will deal x damage. Secondly, you choose some monster i, which will be targeted by the spell. That\'s what happens next:   if its current health hi>x, then he stays alive with health decreased by x;  if hi\xe2\x89\xa4x, the i-th monster dies with an explosion that deals hi\xe2\x88\x921 damage to monsters in the neighboring cells i\xe2\x88\x921 and i+1, if these cells exist and monsters inside are still alive;  if the damage dealt by the explosion is enough to kill the monster i\xe2\x88\x921 (or i+1), i. e. the current hi\xe2\x88\x921\xe2\x89\xa4hi\xe2\x88\x921 (or hi+1\xe2\x89\xa4hi\xe2\x88\x921), then that monster also dies creating a secondary explosion of power hi\xe2\x88\x921\xe2\x88\x921 (or hi+1\xe2\x88\x921) that may deals damage to their neighbors, and so on, until the explosions end. Your goal is to kill all the remaining monsters with those ""chaining"" explosions, that\'s why you need a basic spell to decrease hi of some monsters or even kill them beforehand (monsters die when their current health hi becomes less or equal to zero). Note that monsters don\'t move between cells, so, for example, monsters i and i+2 will never become neighbors.What is the minimum total MP you need to kill all monsters in the way you want? The total MP is counted as the sum of the number of basic spells you cast and the power x of explosion scroll you\'ve chosen." 2200
1795D "Triangle Coloring" combinatorics,math "You are given an undirected graph consisting of n vertices and n edges, where n is divisible by 6. Each edge has a weight, which is a positive (greater than zero) integer.The graph has the following structure: it is split into n3 triples of vertices, the first triple consisting of vertices 1,2,3, the second triple consisting of vertices 4,5,6, and so on. Every pair of vertices from the same triple is connected by an edge. There are no edges between vertices from different triples.You have to paint the vertices of this graph into two colors, red and blue. Each vertex should have exactly one color, there should be exactly n2 red vertices and n2 blue vertices. The coloring is called valid if it meets these constraints.The weight of the coloring is the sum of weights of edges connecting two vertices with different colors.Let W be the maximum possible weight of a valid coloring. Calculate the number of valid colorings with weight W, and print it modulo 998244353." 1600
1795C "Tea Tasting" "binary search,data structures,implementation" "A tea manufacturer decided to conduct a massive tea tasting. n sorts of tea will be tasted by n tasters. Both the sorts of tea and the tasters are numbered from 1 to n. The manufacturer prepared ai milliliters of the i-th sort of tea. The j-th taster can drink bj milliliters of tea at once.The tasting will be conducted in steps. During the first step, the i-th taster tastes the i-th sort of tea. The i-th taster drinks min(ai,bi) tea (how much is available of the i-th sort and how much the i-th taster can drink). ai also decreases by this amount.Then all tasters move to the previous sort of tea. Thus, during the second step, the i-th taster tastes the (i\xe2\x88\x921)-st sort of tea. The i-th taster drinks min(ai\xe2\x88\x921,bi) tea. The 1-st person ends the tasting.During the third step, the i-th taster tastes the (i\xe2\x88\x922)-nd sort of tea. The 2-nd taster ends the tasting. This goes on until everyone ends the tasting.Take a look at the tasting process for n=3, a=[10,20,15], b=[9,8,6]. In the left row, there are the current amounts of each sort of tea. In the right column, there are current amounts of tea each taster has drunk in total. The arrow tells which taster each tea goes to on the current step. The number on the arrow is the amount \xe2\x80\x94 minimum of how much is available of the sort of tea and how much the taster can drink.  For each taster, print how many milliliters of tea he/she will drink in total." 1500
1795B "Ideal Point" "brute force,geometry,greedy" "You are given n one-dimensional segments (each segment is denoted by two integers \xe2\x80\x94 its endpoints).Let\'s define the function f(x) as the number of segments covering point x (a segment covers the point x if l\xe2\x89\xa4x\xe2\x89\xa4r, where l is the left endpoint and r is the right endpoint of the segment).An integer point x is called ideal if it belongs to more segments than any other integer point, i.\xe2\x80\x89e. f(y)<f(x) is true for any other integer point y.You are given an integer k. Your task is to determine whether it is possible to remove some (possibly zero) segments, so that the given point k becomes ideal." 900
1795A "Two Towers" "brute force,implementation,strings" "There are two towers consisting of blocks of two colors: red and blue. Both towers are represented by strings of characters B and/or R denoting the order of blocks in them from the bottom to the top, where B corresponds to a blue block, and R corresponds to a red block.  These two towers are represented by strings BRBB and RBR. You can perform the following operation any number of times: choose a tower with at least two blocks, and move its top block to the top of the other tower.   The pair of towers is beautiful if no pair of touching blocks has the same color; i.\xe2\x80\x89e. no red block stands on top of another red block, and no blue block stands on top of another blue block.You have to check if it is possible to perform any number of operations (possibly zero) to make the pair of towers beautiful." 800
1794E "Labeling the Tree with Distances" "data structures,dp,greedy,hashing,implementation,trees" "You are given an unweighted tree of n vertices numbered from 1 to n and a list of n\xe2\x88\x921 integers a1,a2,\xe2\x80\xa6,an\xe2\x88\x921. A tree is a connected undirected graph without cycles. You will use each element of the list to label one vertex. No vertex should be labeled twice. You can label the only remaining unlabeled vertex with any integer. A vertex x is called good if it is possible to do this labeling so that for each vertex i, its label is the distance between x and i. The distance between two vertices s and t on a tree is the minimum number of edges on a path that starts at vertex s and ends at vertex t. Find all good vertices." 2400
1794D "Counting Factorizations" "combinatorics,divide and conquer,dp,math,number theory" "The prime factorization of a positive integer m is the unique way to write it as m=pe11\xe2\x8b\x85pe22\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85pekk, where p1,p2,\xe2\x80\xa6,pk are prime numbers, p1<p2<\xe2\x80\xa6<pk and e1,e2,\xe2\x80\xa6,ek are positive integers. For each positive integer m, f(m) is defined as the multiset of all numbers in its prime factorization, that is f(m)={p1,e1,p2,e2,\xe2\x80\xa6,pk,ek}. For example, f(24)={2,3,3,1}, f(5)={1,5} and f(1)={}.You are given a list consisting of 2n integers a1,a2,\xe2\x80\xa6,a2n. Count how many positive integers m satisfy that f(m)={a1,a2,\xe2\x80\xa6,a2n}. Since this value may be large, print it modulo 998244353." 1900
1794C "Scoring Subsequences" "binary search,greedy,math,two pointers" "The score of a sequence [s1,s2,\xe2\x80\xa6,sd] is defined as s1\xe2\x8b\x85s2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85sdd!, where d!=1\xe2\x8b\x852\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85d. In particular, the score of an empty sequence is 1.For a sequence [s1,s2,\xe2\x80\xa6,sd], let m be the maximum score among all its subsequences. Its cost is defined as the maximum length of a subsequence with a score of m.You are given a non-decreasing sequence [a1,a2,\xe2\x80\xa6,an] of integers of length n. In other words, the condition a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an is satisfied. For each k=1,2,\xe2\x80\xa6,n, find the cost of the sequence [a1,a2,\xe2\x80\xa6,ak]. A sequence x is a subsequence of a sequence y if x can be obtained from y by deletion of several (possibly, zero or all) elements." 1300
1794B "Not Dividing" "constructive algorithms,greedy,math" "You are given an array of n positive integers a1,a2,\xe2\x80\xa6,an. In one operation, you can choose any number of the array and add 1 to it. Make at most 2n operations so that the array satisfies the following property: ai+1 is not divisible by ai, for each i=1,2,\xe2\x80\xa6,n\xe2\x88\x921. You do not need to minimize the number of operations." 900
1794A "Prefix and Suffix Array" strings "Marcos loves strings a lot, so he has a favorite string s consisting of lowercase English letters. For this string, he wrote down all its non-empty prefixes and suffixes (except for s) on a piece of paper in arbitrary order. You see all these strings and wonder if Marcos\' favorite string is a palindrome or not. So, your task is to decide whether s is a palindrome by just looking at the piece of paper.A string a is a prefix of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the end.A string a is a suffix of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning.A palindrome is a string that reads the same backward as forward, for example, strings ""gg"", ""ioi"", ""abba"", ""icpci"" are palindromes, but strings ""codeforces"", ""abcd"", ""alt"" are not." 800
1793F Rebrending "brute force,data structures,divide and conquer,implementation" "Kostya and Zhenya \xe2\x80\x94 the creators of the band ""Paper"" \xe2\x80\x94 after the release of the legendary album decided to create a new band ""Day movers"", for this they need to find two new people.They invited n people to the casting. The casting will last q days. On the ith of the days, Kostya and Zhenya want to find two people on the segment from li to ri who are most suitable for their band. Since ""Day movers"" are doing a modern art, musical skills are not important to them and they look only at other signs: they want the height difference between two people to be as small as possible.Help them, and for each day, find the minimum difference in the growth of people from the casting on this segment!" 2600
1793E "Velepin and Marketing" "binary search,data structures,dp,greedy,sortings,two pointers" "The famous writer Velepin is very productive. Recently, he signed a contract with a well-known publication and now he needs to write ki books for i-th year. This is not a problem for him at all, he can write as much as he wants about samurai, space, emptiness, insects and werewolves.He has n regular readers, each of whom in the i-th year will read one of the ki books published by Velepin. Readers are very fond of discussing books, so the j-th of them will be satisfied within a year if at least aj persons read the same book as him (including himself).Velepin has obvious problems with marketing, so he turned to you! A well-known book reading service can control what each of Velepin\'s regular readers will read, but he does not want books to be wasted, so someone should read each book. And so they turned to you with a request to tell you what the maximum number of regular readers can be made satisfied during each of the years, if you can choose each person the book he will read." 2600
1793D "Moscow Gorillas" "binary search,dp,greedy,implementation,math,two pointers" "In winter, the inhabitants of the Moscow Zoo are very bored, in particular, it concerns gorillas. You decided to entertain them and brought a permutation p of length n to the zoo.A permutation of length n is an array consisting of n distinct integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 occurs twice in the array) and [1,3,4] is also not a permutation (n=3, but 4 is present in the array).The gorillas had their own permutation q of length n. They suggested that you count the number of pairs of integers l,r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that MEX([pl,pl+1,\xe2\x80\xa6,pr])=MEX([ql,ql+1,\xe2\x80\xa6,qr]).The MEX of the sequence is the minimum integer positive number missing from this sequence. For example, MEX([1,3])=2, MEX([5])=1, MEX([3,1,2,6])=4.You do not want to risk your health, so you will not dare to refuse the gorillas." 1800
1793C "Dora and Search" "constructive algorithms,data structures,two pointers" "As you know, the girl Dora is always looking for something. This time she was given a permutation, and she wants to find such a subsegment of it that none of the elements at its ends is either the minimum or the maximum of the entire subsegment. More formally, you are asked to find the numbers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that al\xe2\x89\xa0min(al,al+1,\xe2\x80\xa6,ar), al\xe2\x89\xa0max(al,al+1,\xe2\x80\xa6,ar) and ar\xe2\x89\xa0min(al,al+1,\xe2\x80\xa6,ar), ar\xe2\x89\xa0max(al,al+1,\xe2\x80\xa6,ar).A permutation of length n is an array consisting of n distinct integers from 1 to n in any order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 occurs twice in the array) and [1,3,4] is also not a permutation (n=3, but 4 is present in the array).Help Dora find such a subsegment, or tell her that such a subsegment does not exist." 1200
1793B "Fedya and Array" "constructive algorithms,math" "For his birthday recently Fedya was given an array a of n integers arranged in a circle, For each pair of neighboring numbers (a1 and a2, a2 and a3, \xe2\x80\xa6, an\xe2\x88\x921 and an, an and a1) the absolute difference between them is equal to 1.Let\'s call a local maximum an element, which is greater than both of its neighboring elements. Also call a local minimum an element, which is less than both of its neighboring elements. Note, that elements a1 and an are neighboring elements.Unfortunately, Fedya lost an array, but he remembered in it the sum of local maximums x and the sum of local minimums y.Given x and y, help Fedya find any matching array of minimum length." 1100
1793A "Yet Another Promotion" greedy,math "The famous store ""Second Food"" sells groceries only two days a month. And the prices in each of days differ. You wanted to buy n kilos of potatoes for a month. You know that on the first day of the month 1 kilo of potatoes costs a coins, and on the second day b coins. In ""Second Food"" you can buy any integer kilograms of potatoes.Fortunately, ""Second Food"" has announced a promotion for potatoes, which is valid only on the first day of the month \xe2\x80\x94 for each m kilos of potatoes you buy, you get 1 kilo as a gift! In other words, you can get m+1 kilograms by paying for m kilograms.Find the minimum number of coins that you have to spend to buy at least n kilos of potatoes." 800
1792F2 "Graph Coloring (hard version)" "brute force,combinatorics,divide and conquer,dp,fft,graphs" "The only difference between the easy and the hard version is the constraint on n.You are given an undirected complete graph on n vertices. A complete graph is a graph where each pair of vertices is connected by an edge. You have to paint the edges of the graph into two colors, red and blue (each edge will have one color).A set of vertices S is red-connected if, for every pair of vertices (v1,v2) such that v1\xe2\x88\x88S and v2\xe2\x88\x88S, there exists a path from v1 to v2 that goes only through red edges and vertices from S. Similarly, a set of vertices S is blue-connected if, for every pair of vertices (v1,v2) such that v1\xe2\x88\x88S and v2\xe2\x88\x88S, there exists a path from v1 to v2 that goes only through blue edges and vertices from S.You have to paint the graph in such a way that:  there is at least one red edge;  there is at least one blue edge;  for each set of vertices S such that |S|\xe2\x89\xa52, S is either red-connected or blue-connected, but not both. Calculate the number of ways to paint the graph, and print it modulo 998244353." 2900
1792F1 "Graph Coloring (easy version)" combinatorics,dp,graphs "The only difference between the easy and the hard version is the constraint on n.You are given an undirected complete graph on n vertices. A complete graph is a graph where each pair of vertices is connected by an edge. You have to paint the edges of the graph into two colors, red and blue (each edge will have one color).A set of vertices S is red-connected if, for every pair of vertices (v1,v2) such that v1\xe2\x88\x88S and v2\xe2\x88\x88S, there exists a path from v1 to v2 that goes only through red edges and vertices from S. Similarly, a set of vertices S is blue-connected if, for every pair of vertices (v1,v2) such that v1\xe2\x88\x88S and v2\xe2\x88\x88S, there exists a path from v1 to v2 that goes only through blue edges and vertices from S.You have to paint the graph in such a way that:  there is at least one red edge;  there is at least one blue edge;  for each set of vertices S such that |S|\xe2\x89\xa52, S is either red-connected or blue-connected, but not both. Calculate the number of ways to paint the graph, and print it modulo 998244353." 2700
1792E "Divisors and Table" "brute force,dfs and similar,dp,number theory" "You are given an n\xc3\x97n multiplication table and a positive integer m=m1\xe2\x8b\x85m2. A n\xc3\x97n multiplication table is a table with n rows and n columns numbered from 1 to n, where ai,j=i\xe2\x8b\x85j.For each divisor d of m, check: does d occur in the table at least once, and if it does, what is the minimum row that contains d." 2400
1792D "Fixed Prefix Permutations" "binary search,bitmasks,data structures,hashing,math,sortings" "You are given n permutations a1,a2,\xe2\x80\xa6,an, each of length m. Recall that a permutation of length m is a sequence of m distinct integers from 1 to m.Let the beauty of a permutation p1,p2,\xe2\x80\xa6,pm be the largest k such that p1=1,p2=2,\xe2\x80\xa6,pk=k. If p1\xe2\x89\xa01, then the beauty is 0.The product of two permutations p\xe2\x8b\x85q is a permutation r such that rj=qpj.For each i from 1 to n, print the largest beauty of a permutation ai\xe2\x8b\x85aj over all j from 1 to n (possibly, i=j)." 1700
1792C "Min Max Sort" "binary search,brute force,greedy,math,two pointers" "You are given a permutation p of length n (a permutation of length n is an array of length n in which each integer from 1 to n occurs exactly once).You can perform the following operation any number of times (possibly zero):   choose two different elements x and y and erase them from the permutation;  insert the minimum of x and y into the permutation in such a way that it becomes the first element;  insert the maximum of x and y into the permutation in such a way that it becomes the last element. For example, if p=[1,5,4,2,3] and we want to apply the operation to the elements 3 and 5, then after the first step of the operation, the permutation becomes p=[1,4,2]; and after we insert the elements, it becomes p=[3,1,4,2,5].Your task is to calculate the minimum number of operations described above to sort the permutation p in ascending order (i.\xe2\x80\x89e. transform p so that p1<p2<\xe2\x8b\xaf<pn)." 1500
1792B "Stand-up Comedian" greedy,math "Eve is a beginner stand-up comedian. Her first show gathered a grand total of two spectators: Alice and Bob.Eve prepared a1+a2+a3+a4 jokes to tell, grouped by their type:   type 1: both Alice and Bob like them;  type 2: Alice likes them, but Bob doesn\'t;  type 3: Bob likes them, but Alice doesn\'t;  type 4: neither Alice nor Bob likes them. Initially, both spectators have their mood equal to 0. When a spectator hears a joke he/she likes, his/her mood increases by 1. When a spectator hears a joke he/she doesn\'t like, his/her mood decreases by 1. If the mood of a spectator becomes negative (strictly below zero), he/she leaves.When someone leaves, Eve gets sad and ends the show. If no one leaves, and Eve is out of jokes, she also ends the show.Thus, Eve wants to arrange her jokes in such a way that the show lasts as long as possible. Help her to calculate the maximum number of jokes she can tell before the show ends." 1200
1792A GamingForces greedy,sortings "Monocarp is playing a computer game. He\'s going to kill n monsters, the i-th of them has hi health.Monocarp\'s character has two spells, either of which he can cast an arbitrary number of times (possibly, zero) and in an arbitrary order:   choose exactly two alive monsters and decrease their health by 1;  choose a single monster and kill it. When a monster\'s health becomes 0, it dies.What\'s the minimum number of spell casts Monocarp should perform in order to kill all monsters?" 800
1791G2 "Teleporters (Hard Version)" "binary search,greedy,sortings" "The only difference between the easy and hard versions are the locations you can teleport to.Consider the points 0,1,\xe2\x80\xa6,n+1 on the number line. There is a teleporter located on each of the points 1,2,\xe2\x80\xa6,n. At point i, you can do the following:  Move left one unit: it costs 1 coin.  Move right one unit: it costs 1 coin.  Use a teleporter at point i, if it exists: it costs ai coins. As a result, you can choose whether to teleport to point 0 or point n+1. Once you use a teleporter, you can\'t use it again. You have c coins, and you start at point 0. What\'s the most number of teleporters you can use?" 1900
1791G1 "Teleporters (Easy Version)" greedy,sortings "The only difference between the easy and hard versions are the locations you can teleport to.Consider the points 0,1,\xe2\x80\xa6,n on the number line. There is a teleporter located on each of the points 1,2,\xe2\x80\xa6,n. At point i, you can do the following:  Move left one unit: it costs 1 coin.  Move right one unit: it costs 1 coin.  Use a teleporter at point i, if it exists: it costs ai coins. As a result, you teleport to point 0. Once you use a teleporter, you can\'t use it again. You have c coins, and you start at point 0. What\'s the most number of teleporters you can use?" 1100
1791F "Range Update Point Query" "binary search,brute force,data structures" "Given an array a1,a2,\xe2\x80\xa6,an, you need to handle a total of q updates and queries of two types:  1 l r \xe2\x80\x94 for each index i with l\xe2\x89\xa4i\xe2\x89\xa4r, update the value of ai to the sum of the digits of ai.  2 x \xe2\x80\x94 output ax." 1500
1791E "Negatives and Positives" dp,greedy,sortings "Given an array a consisting of n elements, find the maximum possible sum the array can have after performing the following operation any number of times:   Choose 2 adjacent elements and flip both of their signs. In other words choose an index i such that 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 and assign ai=\xe2\x88\x92ai and ai+1=\xe2\x88\x92ai+1." 1100
1791D "Distinct Split" "brute force,greedy,strings" "Let\'s denote the f(x) function for a string x as the number of distinct characters that the string contains. For example f(abc)=3, f(bbbbb)=1, and f(babacaba)=3.Given a string s, split it into two non-empty strings a and b such that f(a)+f(b) is the maximum possible. In other words, find the maximum possible value of f(a)+f(b) such that a+b=s (the concatenation of string a and string b is equal to string s)." 1000
1791C "Prepend and Append" "implementation,two pointers" "Timur initially had a binary string\xe2\x80\xa0 s (possibly of length 0). He performed the following operation several (possibly zero) times:   Add 0 to one end of the string and 1 to the other end of the string. For example, starting from the string 1011, you can obtain either 010111 or 110110.  You are given Timur\'s final string. What is the length of the shortest possible string he could have started with?\xe2\x80\xa0 A binary string is a string (possibly the empty string) whose characters are either 0 or 1." 800
1791B "Following Directions" geometry,implementation "Alperen is standing at the point (0,0). He is given a string s of length n and performs n moves. The i-th move is as follows:   if si=L, then move one unit left;  if si=R, then move one unit right;  if si=U, then move one unit up;  if si=D, then move one unit down.    If Alperen starts at the center point, he can make the four moves shown.  There is a candy at (1,1) (that is, one unit above and one unit to the right of Alperen\'s starting point). You need to determine if Alperen ever passes the candy.   Alperen\'s path in the first test case." 800
1791A "Codeforces Checking" implementation,strings "Given a lowercase Latin character (letter), check if it appears in the string codeforces." 800
1790G "Tokens on Graph" "constructive algorithms,dfs and similar,graphs,shortest paths" "You are given an undirected connected graph, some vertices of which contain tokens and/or bonuses. Consider a game involving one player  \xe2\x80\x94 you.You can move tokens according to the following rules:  At the beginning of the game, you can make exactly one turn: move any token to any adjacent vertex.  If the movement of the token ended on the bonus, then you are allowed to make another turn with any other token. You can use different bonuses in any order. The same bonus can be used an unlimited number of times. Bonuses do not move during the game.There can be several tokens in one vertex at the same time, but initially there is no more than one token in each vertex.The vertex with number 1 is the finish vertex, and your task is to determine whether it is possible to hit it with any token by making turns with the tiles according to the rules described above. If a token is initially located at the vertex of 1, then the game is considered already won.  The finish line is in black, the bonuses are in red, the chips are in grey.  For example, for a given graph, you can reach the finish line with a chip from the 8th vertex by making the following sequence of turns:   Move from the 8-th vertex to the 6-th.  Move from the 7-th vertex to the 5-th.  Move from the 6-th vertex to the 4-th.  Move from the 5-th vertex to the 6-th.  Move from the 4-th vertex to the 2-nd.  Move from the 6-th vertex to the 4-th.  Move from the 2-nd vertex to the 1-st vertex, which is the finish." 2300
1790F "Timofey and Black-White Tree" "brute force,dfs and similar,divide and conquer,graphs,greedy,math,shortest paths,trees" "Timofey came to a famous summer school and found a tree on n vertices. A tree is a connected undirected graph without cycles.Every vertex of this tree, except c0, is colored white. The vertex c0 is colored black.Timofey wants to color all the vertices of this tree in black. To do this, he performs n\xe2\x88\x921 operations. During the i-th operation, he selects the vertex ci, which is currently white, and paints it black.Let\'s call the positivity of tree the minimum distance between all pairs of different black vertices in it. The distance between the vertices v and u is the number of edges on the path from v to u.After each operation, Timofey wants to know the positivity of the current tree." 2100
1790E "Vlad and a Pair of Numbers" "bitmasks,constructive algorithms" "Vlad found two positive numbers a and b (a,b>0). He discovered that a\xe2\x8a\x95b=a+b2, where \xe2\x8a\x95 means the bitwise exclusive OR , and division is performed without rounding..Since it is easier to remember one number than two, Vlad remembered only a\xe2\x8a\x95b, let\'s denote this number as x. Help him find any suitable a and b or tell him that they do not exist." 1400
1790D Matryoshkas "data structures,greedy,sortings" "Matryoshka is a wooden toy in the form of a painted doll, inside which you can put a similar doll of a smaller size.A set of nesting dolls contains one or more nesting dolls, their sizes are consecutive positive integers. Thus, a set of nesting dolls is described by two numbers: s \xe2\x80\x94 the size of a smallest nesting doll in a set and m \xe2\x80\x94 the number of dolls in a set. In other words, the set contains sizes of s,s+1,\xe2\x80\xa6,s+m\xe2\x88\x921 for some integer s and m (s,m>0).You had one or more sets of nesting dolls. Recently, you found that someone mixed all your sets in one and recorded a sequence of doll sizes \xe2\x80\x94 integers a1,a2,\xe2\x80\xa6,an.You do not remember how many sets you had, so you want to find the minimum number of sets that you could initially have.For example, if a given sequence is a=[2,2,3,4,3,1]. Initially, there could be 2 sets:   the first set consisting of 4 nesting dolls with sizes [1,2,3,4];  a second set consisting of 2 nesting dolls with sizes [2,3]. According to a given sequence of sizes of nesting dolls a1,a2,\xe2\x80\xa6,an, determine the minimum number of nesting dolls that can make this sequence.Each set is completely used, so all its nesting dolls are used. Each element of a given sequence must correspond to exactly one doll from some set." 1200
1790C Premutation "brute force,implementation,math" "A sequence of n numbers is called permutation if it contains all integers from 1 to n exactly once. For example, the sequences [3,1,4,2], [1] and [2,1] are permutations, but [1,2,1], [0,1] and [1,3,4] \xe2\x80\x94 are not.Kristina had a permutation p of n elements. She wrote it on the whiteboard n times in such a way that:   while writing the permutation at the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) time she skipped the element pi  So, she wrote in total n sequences of length n\xe2\x88\x921 each.For example, suppose Kristina had a permutation p = [4,2,1,3] of length 4. Then she did the following:   Wrote the sequence [2,1,3], skipping the element p1=4 from the original permutation.  Wrote the sequence [4,1,3], skipping the element p2=2 from the original permutation.  Wrote the sequence [4,2,3], skipping the element p3=1 from the original permutation.  Wrote the sequence [4,2,1], skipping the element p4=3 from the original permutation. You know all n of sequences that have been written on the whiteboard, but you do not know the order in which they were written. They are given in arbitrary order. Reconstruct the original permutation from them.For example, if you know the sequences [4,2,1], [4,2,3], [2,1,3], [4,1,3], then the original permutation will be p = [4,2,1,3]." 1000
1790B "Taisia and Dice" greedy,greedy,math "Taisia has n six-sided dice. Each face of the die is marked with a number from 1 to 6, each number from 1 to 6 is used once.Taisia rolls all n dice at the same time and gets a sequence of values a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa46), where ai is the value on the upper face of the i-th dice. The sum of this sequence is equal to s.Suddenly, Taisia\'s pet cat steals exactly one dice with maximum value ai and calculates the sum of the values on the remaining n\xe2\x88\x921 dice, which is equal to r.You only know the number of dice n and the values of s, r. Restore a possible sequence a that fulfills the constraints." 800
1790A "Polycarp and the Day of Pi" implementation,math,strings "On March 14, the day of the number \xcf\x80 is celebrated all over the world. This is a very important mathematical constant equal to the ratio of the circumference of a circle to its diameter.Polycarp was told at school that the number \xcf\x80 is irrational, therefore it has an infinite number of digits in decimal notation. He wanted to prepare for the Day of the number \xcf\x80 by memorizing this number as accurately as possible.Polycarp wrote out all the digits that he managed to remember. For example, if Polycarp remembered \xcf\x80 as 3.1415, he wrote out 31415.Polycarp was in a hurry and could have made a mistake, so you decided to check how many first digits of the number \xcf\x80 Polycarp actually remembers correctly." 800
1789F "Serval and Brain Power" "bitmasks,brute force,dp,greedy,implementation,strings" "Serval loves Brain Power and his brain power problem.Serval defines that a string T is powerful iff T can be obtained by concatenating some string T\xe2\x80\xb2 multiple times. Formally speaking, T is powerful iff there exist a string T\xe2\x80\xb2 and an integer k\xe2\x89\xa52 such that T=T\xe2\x80\xb2+T\xe2\x80\xb2+\xe2\x8b\xaf+T\xe2\x80\xb2\xe2\x8f\x9fk timesFor example, gogogo is powerful because it can be obtained by concatenating go three times, but power is not powerful.Serval has a string S consists of lowercase English letters. He is curious about the longest powerful subsequence of S, and he only needs you to find out the length of it. If all the non-empty subsequences of S is not powerful, the answer is considered to be 0.A string a is a subsequence of a string b if a can be obtained from b by the deletion of several (possibly, zero or all) characters." 2700
1789E "Serval and Music Game" "brute force,dp,implementation,math,number theory" "Serval loves playing music games. He meets a problem when playing music games, and he leaves it for you to solve.You are given n positive integers s1<s2<\xe2\x80\xa6<sn. f(x) is defined as the number of i (1\xe2\x89\xa4i\xe2\x89\xa4n) that exist non-negative integers pi,qi such that: si=pi\xe2\x8c\x8asnx\xe2\x8c\x8b+qi\xe2\x8c\x88snx\xe2\x8c\x89Find out \xe2\x88\x91snx=1x\xe2\x8b\x85f(x) modulo 998244353.As a reminder, \xe2\x8c\x8ax\xe2\x8c\x8b denotes the maximal integer that is no greater than x, and \xe2\x8c\x88x\xe2\x8c\x89 denotes the minimal integer that is no less than x." 2500
1789D "Serval and Shift-Shift-Shift" "bitmasks,brute force,constructive algorithms,implementation" "Serval has two n-bit binary integer numbers a and b. He wants to share those numbers with Toxel.Since Toxel likes the number b more, Serval decides to change a into b by some (possibly zero) operations. In an operation, Serval can choose any positive integer k between 1 and n, and change a into one of the following number:  a\xe2\x8a\x95(a\xe2\x89\xaak)  a\xe2\x8a\x95(a\xe2\x89\xabk) In other words, the operation moves every bit of a left or right by k positions, where the overflowed bits are removed, and the missing bits are padded with 0. The bitwise XOR of the shift result and the original a is assigned back to a.Serval does not have much time. He wants to perform no more than n operations to change a into b. Please help him to find out an operation sequence, or determine that it is impossible to change a into b in at most n operations. You do not need to minimize the number of operations. In this problem, x\xe2\x8a\x95y denotes the bitwise XOR operation of x and y. a\xe2\x89\xaak and a\xe2\x89\xabk denote the logical left shift and logical right shift." 2200
1789C "Serval and Toxel\'s Arrays" combinatorics,dp,implementation,math "Toxel likes arrays. Before traveling to the Paldea region, Serval gave him an array a as a gift. This array has n pairwise distinct elements.In order to get more arrays, Toxel performed m operations with the initial array. In the i-th operation, he modified the pi-th element of the (i\xe2\x88\x921)-th array to vi, resulting in the i-th array (the initial array a is numbered as 0). During modifications, Toxel guaranteed that the elements of each array are still pairwise distinct after each operation.Finally, Toxel got m+1 arrays and denoted them as A0=a,A1,\xe2\x80\xa6,Am. For each pair (i,j) (0\xe2\x89\xa4i<j\xe2\x89\xa4m), Toxel defines its value as the number of distinct elements of the concatenation of Ai and Aj. Now Toxel wonders, what is the sum of the values of all pairs? Please help him to calculate the answer." 1500
1789B "Serval and Inversion Magic" "brute force,implementation,strings,two pointers" "Serval has a string s that only consists of 0 and 1 of length n. The i-th character of s is denoted as si, where 1\xe2\x89\xa4i\xe2\x89\xa4n.Serval can perform the following operation called Inversion Magic on the string s:  Choose an segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n). For l\xe2\x89\xa4i\xe2\x89\xa4r, change si into 1 if si is 0, and change si into 0 if si is 1. For example, let s be 010100 and the segment [2,5] is chosen. The string s will be 001010 after performing the Inversion Magic.Serval wants to make s a palindrome after performing Inversion Magic exactly once. Help him to determine whether it is possible.A string is a palindrome iff it reads the same backwards as forwards. For example, 010010 is a palindrome but 10111 is not." 800
1789A "Serval and Mocha\'s Array" "brute force,math,number theory" "Mocha likes arrays, and Serval gave her an array consisting of positive integers as a gift.Mocha thinks that for an array of positive integers a, it is good iff the greatest common divisor of all the elements in a is no more than its length. And for an array of at least 2 positive integers, it is beautiful iff all of its prefixes whose length is no less than 2 are good. For example:  [3,6] is not good, because gcd(3,6)=3 is greater than its length 2.  [1,2,4] is both good and beautiful, because all of its prefixes whose length is no less than 2, which are [1,2] and [1,2,4], are both good.  [3,6,1] is good but not beautiful, because [3,6] is not good. Now Mocha gives you the gift array a of n positive integers, and she wants to know whether array a could become beautiful by reordering the elements in a. It is allowed to keep the array a unchanged." 800
1788F "XOR, Tree, and Queries" "bitmasks,constructive algorithms,dfs and similar,dsu,graphs,greedy,implementation,trees" "You are given a tree of n vertices. The vertices are numbered from 1 to n.You will need to assign a weight to each edge. Let the weight of the i-th edge be ai (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921). The weight of each edge should be an integer between 0 and 230\xe2\x88\x921, inclusive.You are given q conditions. Each condition consists of three integers u, v, and x. This means that the bitwise XOR of all edges on the shortest path from u to v should be x.Find out if there exist a1,a2,\xe2\x80\xa6,an\xe2\x88\x921 that satisfy the given conditions. If yes, print a solution such that a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an\xe2\x88\x921 is the smallest. Here, \xe2\x8a\x95 denotes the bitwise XOR operation.If there are multiple solutions such that a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an\xe2\x88\x921 is the smallest, print any." 2500
1788E "Sum Over Zero" "data structures,dfs and similar,dp" "You are given an array a1,a2,\xe2\x80\xa6,an of n integers. Consider S as a set of segments satisfying the following conditions.  Each element of S should be in form [x,y], where x and y are integers between 1 and n, inclusive, and x\xe2\x89\xa4y.  No two segments in S intersect with each other. Two segments [a,b] and [c,d] intersect if and only if there exists an integer x such that a\xe2\x89\xa4x\xe2\x89\xa4b and c\xe2\x89\xa4x\xe2\x89\xa4d.  For each [x,y] in S, ax+ax+1+\xe2\x80\xa6+ay\xe2\x89\xa50. The length of the segment [x,y] is defined as y\xe2\x88\x92x+1. f(S) is defined as the sum of the lengths of every element in S. In a formal way, f(S)=\xe2\x88\x91[x,y]\xe2\x88\x88S(y\xe2\x88\x92x+1). Note that if S is empty, f(S) is 0.What is the maximum f(S) among all possible S?" 2200
1788D "Moving Dots" "binary search,brute force,combinatorics,math,two pointers" "We play a game with n dots on a number line.The initial coordinate of the i-th dot is xi. These coordinates are distinct. Every dot starts moving simultaneously with the same constant speed.Each dot moves in the direction of the closest dot (different from itself) until it meets another dot. In the case of a tie, it goes to the left. Two dots meet if they are in the same coordinate, after that, they stop moving.After enough time, every dot stops moving. The result of a game is the number of distinct coordinates where the dots stop.Because this game is too easy, calculate the sum of results when we play the game for every subset of the given n dots that has at least two dots. As the result can be very large, print the sum modulo 109+7." 2000
1788C "Matching Numbers" "constructive algorithms,greedy,math" "You are given an integer n. Pair the integers 1 to 2n (i.e. each integer should be in exactly one pair) so that each sum of matched pairs is consecutive and distinct. Formally, let (ai,bi) be the pairs that you matched. {a1,b1,a2,b2,\xe2\x80\xa6,an,bn} should be a permutation of {1,2,\xe2\x80\xa6,2n}. Let the sorted list of {a1+b1,a2+b2,\xe2\x80\xa6,an+bn} be s1<s2<\xe2\x80\xa6<sn. We must have si+1\xe2\x88\x92si=1 for 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921." 1300
1788B "Sum of Two Numbers" "constructive algorithms,greedy,implementation,math,probabilities" "The sum of digits of a non-negative integer a is the result of summing up its digits together when written in the decimal system. For example, the sum of digits of 123 is 6 and the sum of digits of 10 is 1. In a formal way, the sum of digits of a=\xe2\x88\x9e\xe2\x88\x91i=0ai\xe2\x8b\x8510i, where 0\xe2\x89\xa4ai\xe2\x89\xa49, is defined as \xe2\x88\x9e\xe2\x88\x91i=0ai.Given an integer n, find two non-negative integers x and y which satisfy the following conditions.  x+y=n, and  the sum of digits of x and the sum of digits of y differ by at most 1. It can be shown that such x and y always exist." 1100
1788A "One and Two" "brute force,implementation,math" "You are given a sequence a1,a2,\xe2\x80\xa6,an. Each element of a is 1 or 2.Find out if an integer k exists so that the following conditions are met.   1\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921, and  a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85ak=ak+1\xe2\x8b\x85ak+2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85an. If there exist multiple k that satisfy the given condition, print the smallest." 800
1787I "Treasure Hunt" "data structures,divide and conquer,two pointers" "Define the beauty value of a sequence b1,b2,\xe2\x80\xa6,bc as the maximum value of q\xe2\x88\x91i=1bi+t\xe2\x88\x91i=sbi, where q, s, t are all integers and s>q or t\xe2\x89\xa4q. Note that bi=0 when i<1 or i>c, t\xe2\x88\x91i=sbi=0 when s>t.For example, when b=[\xe2\x88\x921,\xe2\x88\x922,\xe2\x88\x923], we may have q=0, s=3, t=2 so the beauty value is 0+0=0. And when b=[\xe2\x88\x921,2,\xe2\x88\x923], we have q=s=t=2 so the beauty value is 1+2=3.You are given a sequence a of length n, determine the sum of the beauty value of all non-empty subsegments al,al+1,\xe2\x80\xa6,ar (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) of the sequence a.Print the answer modulo 998244353." 3400
1787H "Codeforces Scoreboard" "binary search,data structures,dp,geometry" "You are participating in a Codeforces Round with n problems. You spend exactly one minute to solve each problem, the time it takes to submit a problem can be ignored. You can only solve at most one problem at any time. The contest starts at time 0, so you can make your first submission at any time t\xe2\x89\xa51 minutes. Whenever you submit a problem, it is always accepted.The scoring of the i-th problem can be represented by three integers ki, bi, and ai. If you solve it at time t minutes, you get max(bi\xe2\x88\x92ki\xe2\x8b\x85t,ai) points.Your task is to choose an order to solve all these n problems to get the maximum possible score. You can assume the contest is long enough to solve all problems." 3300
1787G "Colorful Tree Again" "brute force,data structures,trees" "An edge-weighted tree of n nodes is given with each edge colored in some color. Each node of this tree can be blocked or unblocked, all nodes are unblocked initially.A simple path is a path in a graph that does not have repeating nodes. The length of a path is defined as the sum of weights of all edges on the path.A path is good when it is a simple path consisting of edges of the same color c, all edges of color c are on this path, and every node on the path is unblocked.You need to operate 2 kinds of queries:   block a node,  unblock a node. After each query, print the maximum length among all good paths. If there are no good paths, print 0." 3000
1787F "Inverse Transformation" "constructive algorithms,implementation,math" "A permutation scientist is studying a self-transforming permutation a consisting of n elements a1,a2,\xe2\x80\xa6,an.A permutation is a sequence of integers from 1 to n of length n containing each number exactly once. For example, [1], [4,3,5,1,2] are permutations, while [1,1], [4,3,1] are not.The permutation transforms day by day. On each day, each element x becomes ax, that is, ax becomes aax. Specifically:   on the first day, the permutation becomes b, where bx=aax;  on the second day, the permutation becomes c, where cx=bbx;  \xe2\x80\xa6  For example, consider permutation a=[2,3,1]. On the first day, it becomes [3,1,2]. On the second day, it becomes [2,3,1].You\'re given the permutation a\xe2\x80\xb2 on the k-th day.Define \xcf\x83(x)=ax, and define f(x) as the minimal positive integer m such that \xcf\x83m(x)=x, where \xcf\x83m(x) denotes \xcf\x83(\xcf\x83(\xe2\x80\xa6\xcf\x83\xe2\x8f\x9fm times(x)\xe2\x80\xa6)).For example, if a=[2,3,1], then \xcf\x83(1)=2, \xcf\x832(1)=\xcf\x83(\xcf\x83(1))=\xcf\x83(2)=3, \xcf\x833(1)=\xcf\x83(\xcf\x83(\xcf\x83(1)))=\xcf\x83(3)=1, so f(1)=3. And if a=[4,2,1,3], \xcf\x83(2)=2 so f(2)=1; \xcf\x83(3)=1, \xcf\x832(3)=4, \xcf\x833(3)=3 so f(3)=3.Find the initial permutation a such that n\xe2\x88\x91i=11f(i) is minimum possible." 2500
1787E "The Harmonization of XOR" "bitmasks,constructive algorithms,greedy,math" "You are given an array of exactly n numbers [1,2,3,\xe2\x80\xa6,n] along with integers k and x.Partition the array in exactly k non-empty disjoint subsequences such that the bitwise XOR of all numbers in each subsequence is x, and each number is in exactly one subsequence. Notice that there are no constraints on the length of each subsequence.A sequence a is a subsequence of a sequence b if a can be obtained from b by the deletion of several (possibly, zero or all) elements.For example, for n=15, k=6, x=7, the following scheme is valid:   [6,10,11], 6\xe2\x8a\x9510\xe2\x8a\x9511=7,  [5,12,14], 5\xe2\x8a\x9512\xe2\x8a\x9514=7,  [3,9,13], 3\xe2\x8a\x959\xe2\x8a\x9513=7,  [1,2,4], 1\xe2\x8a\x952\xe2\x8a\x954=7,  [8,15], 8\xe2\x8a\x9515=7,  [7], 7=7,  where \xe2\x8a\x95 represents the bitwise XOR operation.The following scheme is invalid, since 8, 15 do not appear:   [6,10,11], 6\xe2\x8a\x9510\xe2\x8a\x9511=7,  [5,12,14], 5\xe2\x8a\x9512\xe2\x8a\x9514=7,  [3,9,13], 3\xe2\x8a\x959\xe2\x8a\x9513=7,  [1,2,4], 1\xe2\x8a\x952\xe2\x8a\x954=7,  [7], 7=7. The following scheme is invalid, since 3 appears twice, and 1, 2 do not appear:   [6,10,11], 6\xe2\x8a\x9510\xe2\x8a\x9511=7,  [5,12,14], 5\xe2\x8a\x9512\xe2\x8a\x9514=7,  [3,9,13], 3\xe2\x8a\x959\xe2\x8a\x9513=7,  [3,4], 3\xe2\x8a\x954=7,  [8,15], 8\xe2\x8a\x9515=7,  [7], 7=7." 2100
1787D "Game on Axis" "combinatorics,dfs and similar,dsu,graphs,implementation" "There are n points 1,2,\xe2\x80\xa6,n, each point i has a number ai on it. You\'re playing a game on them. Initially, you are at point 1. When you are at point i, take following steps:  If 1\xe2\x89\xa4i\xe2\x89\xa4n, go to i+ai,  Otherwise, the game ends. Before the game begins, you can choose two integers x and y satisfying 1\xe2\x89\xa4x\xe2\x89\xa4n, \xe2\x88\x92n\xe2\x89\xa4y\xe2\x89\xa4n and replace ax with y (set ax:=y). Find the number of distinct pairs (x,y) such that the game that you start after making the change ends in a finite number of steps.Notice that you do not have to satisfy ax\xe2\x89\xa0y." 1900
1787C "Remove the Bracket" dp,greedy,math "RSJ has a sequence a of n integers a1,a2,\xe2\x80\xa6,an and an integer s. For each of a2,a3,\xe2\x80\xa6,an\xe2\x88\x921, he chose a pair of non-negative integers xi and yi such that xi+yi=ai and (xi\xe2\x88\x92s)\xe2\x8b\x85(yi\xe2\x88\x92s)\xe2\x89\xa50.Now he is interested in the value F=a1\xe2\x8b\x85x2+y2\xe2\x8b\x85x3+y3\xe2\x8b\x85x4+\xe2\x80\xa6+yn\xe2\x88\x922\xe2\x8b\x85xn\xe2\x88\x921+yn\xe2\x88\x921\xe2\x8b\x85an.Please help him find the minimum possible value F he can get by choosing xi and yi optimally. It can be shown that there is always at least one valid way to choose them." 1600
1787B "Number Factorization" "greedy,math,number theory" "Given an integer n.Consider all pairs of integer arrays a and p of the same length such that n=\xe2\x88\x8fapii (i.e. ap11\xe2\x8b\x85ap22\xe2\x8b\x85\xe2\x80\xa6) (ai>1;pi>0) and ai is the product of some (possibly one) distinct prime numbers.For example, for n=28=22\xe2\x8b\x8571=41\xe2\x8b\x8571 the array pair a=[2,7], p=[2,1] is correct, but the pair of arrays a=[4,7], p=[1,1] is not, because 4=22 is a product of non-distinct prime numbers.Your task is to find the maximum value of \xe2\x88\x91ai\xe2\x8b\x85pi (i.e. a1\xe2\x8b\x85p1+a2\xe2\x8b\x85p2+\xe2\x80\xa6) over all possible pairs of arrays a and p. Note that you do not need to minimize or maximize the length of the arrays." 1100
1787A "Exponential Equation" "constructive algorithms,math" "You are given an integer n.Find any pair of integers (x,y) (1\xe2\x89\xa4x,y\xe2\x89\xa4n) such that xy\xe2\x8b\x85y+yx\xe2\x8b\x85x=n." 800
1786B "Cake Assembly Line" "brute force,sortings" "A cake assembly line in a bakery was once again optimized, and now n cakes are made at a time! In the last step, each of the n cakes should be covered with chocolate.Consider a side view on the conveyor belt, let it be a number line. The i-th cake occupies the segment [ai\xe2\x88\x92w,ai+w] on this line, each pair of these segments does not have common points. Above the conveyor, there are n dispensers, and when a common button is pressed, chocolate from the i-th dispenser will cover the conveyor segment [bi\xe2\x88\x92h,bi+h]. Each pair of these segments also does not have common points.  Cakes and dispensers corresponding to the first example. The calibration of this conveyor belt part has not yet been performed, so you are to make it. Determine if it\'s possible to shift the conveyor so that each cake has some chocolate on it, and there is no chocolate outside the cakes. You can assume that the conveyour is long enough, so the cakes never fall. Also note that the button can only be pressed once.  In the first example we can shift the cakes as shown in the picture." 1300
1786A2 "Alternating Deck (hard version)" implementation "This is a hard version of the problem. In this version, there are two colors of the cards.Alice has n cards, each card is either black or white. The cards are stacked in a deck in such a way that the card colors alternate, starting from a white card. Alice deals the cards to herself and to Bob, dealing at once several cards from the top of the deck in the following order: one card to herself, two cards to Bob, three cards to Bob, four cards to herself, five cards to herself, six cards to Bob, seven cards to Bob, eight cards to herself, and so on. In other words, on the i-th step, Alice deals i top cards from the deck to one of the players; on the first step, she deals the cards to herself and then alternates the players every two steps. When there aren\'t enough cards at some step, Alice deals all the remaining cards to the current player, and the process stops.  First Alice\'s steps in a deck of many cards. How many cards of each color will Alice and Bob have at the end?" 800
1786A1 "Non-alternating Deck (easy version)" implementation "This is an easy version of the problem. In this version, all cards have the same color.Alice has n cards, each card is white, and the cards are stacked in a deck. Alice deals the cards to herself and to Bob, dealing at once several cards from the top of the deck in the following order: one card to herself, two cards to Bob, three cards to Bob, four cards to herself, five cards to herself, six cards to Bob, seven cards to Bob, eight cards to herself, and so on. In other words, on the i-th step, Alice deals i top cards from the deck to one of the players; on the first step, she deals the cards to herself and then alternates the players every two steps. When there aren\'t enough cards at some step, Alice deals all the remaining cards to the current player, and the process stops.  First Alice\'s steps in a deck of many cards. How many cards will Alice and Bob have at the end?" 800
1784F "Minimums or Medians" NA "Vika has a set of all consecutive positive integers from 1 to 2n, inclusive.Exactly k times Vika will choose and perform one of the following two actions:   take two smallest integers from her current set and remove them;  take two median integers from her current set and remove them. Recall that medians are the integers located exactly in the middle of the set if you write down its elements in increasing order. Note that Vika\'s set always has an even size, thus the pair of median integers is uniquely defined. For example, two median integers of the set {1,5,6,10,15,16,18,23} are 10 and 15.How many different sets can Vika obtain in the end, after k actions? Print this number modulo 998244353. Two sets are considered different if some integer belongs to one of them but not to the other." 3400
1784E "Infinite Game" "brute force,combinatorics,dp,games,probabilities" "Alice and Bob are playing an infinite game consisting of sets. Each set consists of rounds. In each round, one of the players wins. The first player to win two rounds in a set wins this set. Thus, a set always ends with the score of 2:0 or 2:1 in favor of one of the players.Let\'s call a game scenario a finite string s consisting of characters \'a\' and \'b\'. Consider an infinite string formed with repetitions of string s: sss\xe2\x80\xa6 Suppose that Alice and Bob play rounds according to this infinite string, left to right. If a character of the string sss\xe2\x80\xa6 is \'a\', then Alice wins the round; if it\'s \'b\', Bob wins the round. As soon as one of the players wins two rounds, the set ends in their favor, and a new set starts from the next round.Let\'s define ai as the number of sets won by Alice among the first i sets while playing according to the given scenario. Let\'s also define r as the limit of ratio aii as i\xe2\x86\x92\xe2\x88\x9e. If r>12, we\'ll say that scenario s is winning for Alice. If r=12, we\'ll say that scenario s is tied. If r<12, we\'ll say that scenario s is winning for Bob.You are given a string s consisting of characters \'a\', \'b\', and \'?\'. Consider all possible ways of replacing every \'?\' with \'a\' or \'b\' to obtain a string consisting only of characters \'a\' and \'b\'. Count how many of them result in a scenario winning for Alice, how many result in a tied scenario, and how many result in a scenario winning for Bob. Print these three numbers modulo 998244353." 3100
1784D "Wooden Spoon" combinatorics,dp "2n people, numbered with distinct integers from 1 to 2n, are playing in a single elimination tournament. The bracket of the tournament is a full binary tree of height n with 2n leaves.When two players meet each other in a match, a player with the smaller number always wins. The winner of the tournament is the player who wins all n their matches.A virtual consolation prize ""Wooden Spoon"" is awarded to a player who satisfies the following n conditions:   they lost their first match;  the player who beat them lost their second match;  the player who beat that player lost their third match;  \xe2\x80\xa6;  the player who beat the player from the previous condition lost the final match of the tournament. It can be shown that there is always exactly one player who satisfies these conditions.Consider all possible (2n)! arrangements of players into the tournament bracket. For each player, find the number of these arrangements in which they will be awarded the ""Wooden Spoon"", and print these numbers modulo 998244353." 2400
1784C "Monsters (hard version)" "data structures,greedy" "This is the hard version of the problem. In this version, you need to find the answer for every prefix of the monster array.In a computer game, you are fighting against n monsters. Monster number i has ai health points, all ai are integers. A monster is alive while it has at least 1 health point.You can cast spells of two types:  Deal 1 damage to any single alive monster of your choice.  Deal 1 damage to all alive monsters. If at least one monster dies (ends up with 0 health points) as a result of this action, then repeat it (and keep repeating while at least one monster dies every time). Dealing 1 damage to a monster reduces its health by 1.Spells of type 1 can be cast any number of times, while a spell of type 2 can be cast at most once during the game.For every k=1,2,\xe2\x80\xa6,n, answer the following question. Suppose that only the first k monsters, with numbers 1,2,\xe2\x80\xa6,k, are present in the game. What is the smallest number of times you need to cast spells of type 1 to kill all k monsters?" 2200
1784B "Letter Exchange" "constructive algorithms" "A cooperative game is played by m people. In the game, there are 3m sheets of paper: m sheets with letter \'w\', m sheets with letter \'i\', and m sheets with letter \'n\'.Initially, each person is given three sheets (possibly with equal letters).The goal of the game is to allow each of the m people to spell the word ""win"" using their sheets of paper. In other words, everyone should have one sheet with letter \'w\', one sheet with letter \'i\', and one sheet with letter \'n\'.To achieve the goal, people can make exchanges. Two people participate in each exchange. Both of them choose exactly one sheet of paper from the three sheets they own and exchange it with each other.Find the shortest sequence of exchanges after which everyone has one \'w\', one \'i\', and one \'n\'." 1900
1784A "Monsters (easy version)" "brute force,greedy" "This is the easy version of the problem. In this version, you only need to find the answer once. In this version, hacks are not allowed.In a computer game, you are fighting against n monsters. Monster number i has ai health points, all ai are integers. A monster is alive while it has at least 1 health point.You can cast spells of two types:  Deal 1 damage to any single alive monster of your choice.  Deal 1 damage to all alive monsters. If at least one monster dies (ends up with 0 health points) as a result of this action, then repeat it (and keep repeating while at least one monster dies every time). Dealing 1 damage to a monster reduces its health by 1.Spells of type 1 can be cast any number of times, while a spell of type 2 can be cast at most once during the game.What is the smallest number of times you need to cast spells of type 1 to kill all monsters?" 1000
1783G "Weighed Tree Radius" "data structures,divide and conquer,implementation,trees" "You are given a tree of n vertices and n\xe2\x88\x921 edges. The i-th vertex has an initial weight ai.Let the distance dv(u) from vertex v to vertex u be the number of edges on the path from v to u. Note that dv(u)=du(v) and dv(v)=0.Let the weighted distance wv(u) from v to u be wv(u)=dv(u)+au. Note that wv(v)=av and wv(u)\xe2\x89\xa0wu(v) if au\xe2\x89\xa0av.Analogically to usual distance, let\'s define the eccentricity e(v) of vertex v as the greatest weighted distance from v to any other vertex (including v itself), or e(v)=max1\xe2\x89\xa4u\xe2\x89\xa4nwv(u).Finally, let\'s define the radius r of the tree as the minimum eccentricity of any vertex, or r=min1\xe2\x89\xa4v\xe2\x89\xa4ne(v).You need to perform m queries of the following form:   vj xj \xe2\x80\x94 assign avj=xj. After performing each query, print the radius r of the current tree." 2800
1783F "Double Sort II" "dfs and similar,flows,graph matchings,graphs" "You are given two permutations a and b, both of size n. A permutation of size n is an array of n elements, where each integer from 1 to n appears exactly once. The elements in each permutation are indexed from 1 to n.You can perform the following operation any number of times:  choose an integer i from 1 to n;  let x be the integer such that ax=i. Swap ai with ax;  let y be the integer such that by=i. Swap bi with by. Your goal is to make both permutations sorted in ascending order (i.\xe2\x80\x89e. the conditions a1<a2<\xe2\x8b\xaf<an and b1<b2<\xe2\x8b\xaf<bn must be satisfied) using minimum number of operations. Note that both permutations must be sorted after you perform the sequence of operations you have chosen." 2500
1783E "Game of the Year" "brute force,data structures,math,number theory" "Monocarp and Polycarp are playing a computer game. This game features n bosses for the playing to kill, numbered from 1 to n.They will fight each boss the following way:   Monocarp makes k attempts to kill the boss;  Polycarp makes k attempts to kill the boss;  Monocarp makes k attempts to kill the boss;  Polycarp makes k attempts to kill the boss;  ... Monocarp kills the i-th boss on his ai-th attempt. Polycarp kills the i-th boss on his bi-th attempt. After one of them kills the i-th boss, they move on to the (i+1)-st boss. The attempt counters reset for both of them. Once one of them kills the n-th boss, the game ends.Find all values of k from 1 to n such that Monocarp kills all bosses." 2300
1783D "Different Arrays" "brute force,dp,implementation" "You are given an array a consisting of n integers.You have to perform the sequence of n\xe2\x88\x922 operations on this array:  during the first operation, you either add a2 to a1 and subtract a2 from a3, or add a2 to a3 and subtract a2 from a1;  during the second operation, you either add a3 to a2 and subtract a3 from a4, or add a3 to a4 and subtract a3 from a2;  ...  during the last operation, you either add an\xe2\x88\x921 to an\xe2\x88\x922 and subtract an\xe2\x88\x921 from an, or add an\xe2\x88\x921 to an and subtract an\xe2\x88\x921 from an\xe2\x88\x922. So, during the i-th operation, you add the value of ai+1 to one of its neighbors, and subtract it from the other neighbor.For example, if you have the array [1,2,3,4,5], one of the possible sequences of operations is:  subtract 2 from a3 and add it to a1, so the array becomes [3,2,1,4,5];  subtract 1 from a2 and add it to a4, so the array becomes [3,1,1,5,5];  subtract 5 from a3 and add it to a5, so the array becomes [3,1,\xe2\x88\x924,5,10]. So, the resulting array is [3,1,\xe2\x88\x924,5,10].An array is reachable if it can be obtained by performing the aforementioned sequence of operations on a. You have to calculate the number of reachable arrays, and print it modulo 998244353." 2000
1783C "Yet Another Tournament" "binary search,greedy,sortings" "You are participating in Yet Another Tournament. There are n+1 participants: you and n other opponents, numbered from 1 to n.Each two participants will play against each other exactly once. If the opponent i plays against the opponent j, he wins if and only if i>j.When the opponent i plays against you, everything becomes a little bit complicated. In order to get a win against opponent i, you need to prepare for the match for at least ai minutes \xe2\x80\x94 otherwise, you lose to that opponent.You have m minutes in total to prepare for matches, but you can prepare for only one match at one moment. In other words, if you want to win against opponents p1,p2,\xe2\x80\xa6,pk, you need to spend ap1+ap2+\xe2\x8b\xaf+apk minutes for preparation \xe2\x80\x94 and if this number is greater than m, you cannot achieve a win against all of these opponents at the same time.The final place of each contestant is equal to the number of contestants with strictly more wins + 1. For example, if 3 contestants have 5 wins each, 1 contestant has 3 wins and 2 contestants have 1 win each, then the first 3 participants will get the 1-st place, the fourth one gets the 4-th place and two last ones get the 5-th place.Calculate the minimum possible place (lower is better) you can achieve if you can\'t prepare for the matches more than m minutes in total." 1700
1783B "Matrix of Differences" "constructive algorithms,math" "For a square matrix of integers of size n\xc3\x97n, let\'s define its beauty as follows: for each pair of side-adjacent elements x and y, write out the number |x\xe2\x88\x92y|, and then find the number of different numbers among them.For example, for the matrix (1342) the numbers we consider are |1\xe2\x88\x923|=2, |1\xe2\x88\x924|=3, |3\xe2\x88\x922|=1 and |4\xe2\x88\x922|=2; there are 3 different numbers among them (2, 3 and 1), which means that its beauty is equal to 3.You are given an integer n. You have to find a matrix of size n\xc3\x97n, where each integer from 1 to n2 occurs exactly once, such that its beauty is the maximum possible among all such matrices." 1100
1783A "Make it Beautiful" "constructive algorithms,math,sortings" "An array a is called ugly if it contains at least one element which is equal to the sum of all elements before it. If the array is not ugly, it is beautiful.For example:  the array [6,3,9,6] is ugly: the element 9 is equal to 6+3;  the array [5,5,7] is ugly: the element 5 (the second one) is equal to 5;  the array [8,4,10,14] is beautiful: 8\xe2\x89\xa00, 4\xe2\x89\xa08, 10\xe2\x89\xa08+4, 14\xe2\x89\xa08+4+10, so there is no element which is equal to the sum of all elements before it. You are given an array a such that 1\xe2\x89\xa4a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an\xe2\x89\xa4100. You have to reorder the elements of a in such a way that the resulting array is beautiful. Note that you are not allowed to insert new elements or erase existing ones, you can only change the order of elements of a. You are allowed to keep the array a unchanged, if it is beautiful." 800
1781H2 "Window Signals (hard version)" NA "This is the hard version of the problem. In this version, the constraints on h and w are higher.A house at the sea has h floors, all of the same height. The side of the house facing the sea has w windows at equal distances from each other on every floor. Thus, the windows are positioned in cells of a rectangular grid of size h\xc3\x97w.In every window, the light can be turned either on or off, except for the given k (at most 2) windows. In these k windows the light can not be turned on, because it is broken.In the dark, we can send a signal to a ship at sea using a configuration of lights turned on and off. However, the ship can not see the position of the lights with respect to the house. Thus, if one configuration of windows with lights on can be transformed into another using parallel translation, these configurations are considered equal. Note that only parallel translation is allowed, but neither rotations nor flips are. Moreover, a configuration without any light at all is not considered valid.Find how many different signals the ship can receive and print this number modulo 998244353." 3500
1781H1 "Window Signals (easy version)" NA "This is the easy version of the problem. In this version, the constraints on h and w are lower.A house at the sea has h floors, all of the same height. The side of the house facing the sea has w windows at equal distances from each other on every floor. Thus, the windows are positioned in cells of a rectangular grid of size h\xc3\x97w.In every window, the light can be turned either on or off, except for the given k (at most 2) windows. In these k windows the light can not be turned on, because it is broken.In the dark, we can send a signal to a ship at sea using a configuration of lights turned on and off. However, the ship can not see the position of the lights with respect to the house. Thus, if one configuration of windows with lights on can be transformed into another using parallel translation, these configurations are considered equal. Note that only parallel translation is allowed, but neither rotations nor flips are. Moreover, a configuration without any light at all is not considered valid.Find how many different signals the ship can receive and print this number modulo 998244353." 3200
1781G "Diverse Coloring" "constructive algorithms,trees" "In this problem, we will be working with rooted binary trees. A tree is called a rooted binary tree if it has a fixed root and every vertex has at most two children.Let\'s assign a color \xe2\x80\x94 white or blue \xe2\x80\x94 to each vertex of the tree, and call this assignment a coloring of the tree. Let\'s call a coloring diverse if every vertex has a neighbor (a parent or a child) colored into an opposite color compared to this vertex. It can be shown that any tree with at least two vertices allows a diverse coloring.Let\'s define the disbalance of a coloring as the absolute value of the difference between the number of white vertices and the number of blue vertices.Now to the problem. Initially, the tree consists of a single vertex with the number 1 which is its root. Then, for each i from 2 to n, a new vertex i appears in the tree, and it becomes a child of vertex pi. It is guaranteed that after each step the tree will keep being a binary tree rooted at vertex 1, that is, each vertex will have at most two children.After every new vertex is added, print the smallest value of disbalance over all possible diverse colorings of the current tree. Moreover, after adding the last vertex with the number n, also print a diverse coloring with the smallest possible disbalance as well." 3200
1781F "Bracket Insertion" combinatorics,dp,math,trees "Vika likes playing with bracket sequences. Today she wants to create a new bracket sequence using the following algorithm. Initially, Vika\'s sequence is an empty string, and then she will repeat the following actions n times:   Choose a place in the current bracket sequence to insert new brackets uniformly at random. If the length of the current sequence is k, then there are k+1 such places: before the first bracket, between the first and the second brackets, \xe2\x80\xa6, after the k-th bracket. In particular, there is one such place in an empty bracket sequence.  Choose string ""()"" with probability p or string "")("" with probability 1\xe2\x88\x92p and insert it into the chosen place. The length of the bracket sequence will increase by 2. A bracket sequence is called regular if it is possible to obtain a correct arithmetic expression by inserting characters \'+\' and \'1\' into it. For example, sequences ""(())()"", ""()"", and ""(()(()))"" are regular, while "")("", ""(()"", and ""(()))("" are not.Vika wants to know the probability that her bracket sequence will be a regular one at the end. Help her and find this probability modulo 998244353 (see Output section)." 2700
1781E "Rectangle Shrinking" "binary search,brute force,data structures,greedy,implementation,two pointers" "You have a rectangular grid of height 2 and width 109 consisting of unit cells. There are n rectangles placed on this grid, and the borders of these rectangles pass along cell borders. The i-th rectangle covers all cells in rows from ui to di inclusive and columns from li to ri inclusive (1\xe2\x89\xa4ui\xe2\x89\xa4di\xe2\x89\xa42; 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4109). The initial rectangles can intersect, be nested, and coincide arbitrarily.You should either remove each rectangle, or replace it with any of its non-empty subrectangles. In the latter case, the new subrectangle must lie inside the initial rectangle, and its borders must still pass along cell borders. In particular, it is allowed for the subrectangle to be equal to the initial rectangle.After that replacement, no two (non-removed) rectangles are allowed to have common cells, and the total area covered with the new rectangles must be as large as possible.  Illustration for the first test case. The initial rectangles are given at the top, the new rectangles are given at the bottom. Rectangle number 4 is removed." 2300
1781D "Many Perfect Squares" "brute force,math,number theory" "You are given a set a1,a2,\xe2\x80\xa6,an of distinct positive integers.We define the squareness of an integer x as the number of perfect squares among the numbers a1+x,a2+x,\xe2\x80\xa6,an+x.Find the maximum squareness among all integers x between 0 and 1018, inclusive.Perfect squares are integers of the form t2, where t is a non-negative integer. The smallest perfect squares are 0,1,4,9,16,\xe2\x80\xa6." 1800
1781C "Equal Frequencies" "brute force,constructive algorithms,greedy,implementation,sortings,strings" "Let\'s call a string balanced if all characters that are present in it appear the same number of times. For example, ""coder"", ""appall"", and ""ttttttt"" are balanced, while ""wowwow"" and ""codeforces"" are not.You are given a string s of length n consisting of lowercase English letters. Find a balanced string t of the same length n consisting of lowercase English letters that is different from the string s in as few positions as possible. In other words, the number of indices i such that si\xe2\x89\xa0ti should be as small as possible." 1600
1781B "Going to the Cinema" "brute force,greedy,sortings" "A company of n people is planning a visit to the cinema. Every person can either go to the cinema or not. That depends on how many other people will go. Specifically, every person i said: ""I want to go to the cinema if and only if at least ai other people will go, not counting myself"". That means that person i will become sad if:   they go to the cinema, and strictly less than ai other people go; or  they don\'t go to the cinema, and at least ai other people go. In how many ways can a set of people going to the cinema be chosen so that nobody becomes sad?" 1000
1781A "Parallel Projection" geometry,math "Vika\'s house has a room in a shape of a rectangular parallelepiped (also known as a rectangular cuboid). Its floor is a rectangle of size w\xc3\x97d, and the ceiling is right above at the constant height of h. Let\'s introduce a coordinate system on the floor so that its corners are at points (0,0), (w,0), (w,d), and (0,d).A laptop is standing on the floor at point (a,b). A projector is hanging on the ceiling right above point (f,g). Vika wants to connect the laptop and the projector with a cable in such a way that the cable always goes along the walls, ceiling, or floor (i. e. does not go inside the cuboid). Additionally, the cable should always run parallel to one of the cuboid\'s edges (i. e. it can not go diagonally).What is the minimum length of a cable that can connect the laptop to the projector?  Illustration for the first test case. One of the optimal ways to put the cable is shown in green." 800
1780G "Delicious Dessert" "binary search,dsu,hashing,math,number theory,string suffix structures" "Today is an important day for chef Tonio \xe2\x80\x94 an auditor has arrived in his hometown of Morioh. He has also arrived at Tonio\'s restaurant and ordered dessert. Tonio has not been prepared for this turn of events.As you know, dessert is a string of lowercase English letters. Tonio remembered the rule of desserts \xe2\x80\x94 a string s of length n. Any dessert t is delicious if the number of occurrences of t in s as a substring is divisible by the length of t.Now Tonio wants to know the number of delicious substrings of s. If the substring occurs several times in the string s, then all occurrences must be taken into account." 2400
1780F "Three Chairs" "bitmasks,brute force,combinatorics,data structures,dp,number theory,sortings" "One day Kira found n friends from Morioh and decided to gather them around a table to have a peaceful conversation. The height of friend i is equal to ai. It so happened that the height of each of the friends is unique.Unfortunately, there were only 3 chairs in Kira\'s house, and obviously, it will not be possible to seat all friends! So, Kira has to invite only 3 of his friends.But everything is not so simple! If the heights of the lowest and the tallest of the invited friends are not coprime, then the friends will play tricks on each other, which will greatly anger Kira.Kira became interested, how many ways are there to choose 3 of his friends so that they don\'t play tricks? Two ways are considered different if there is a friend invited in one way, but not in the other.Formally, if Kira invites friends i, j, and k, then the following should be true: gcd(min(ai,aj,ak),max(ai,aj,ak))=1, where gcd(x,y) denotes the greatest common divisor (GCD) of the numbers x and y.Kira is not very strong in computer science, so he asks you to count the number of ways to invide friends." 2300
1780E "Josuke and Complete Graph" "binary search,brute force,data structures,math,number theory" "Josuke received a huge undirected weighted complete\xe2\x80\xa0 graph G as a gift from his grandfather. The graph contains 1018 vertices. The peculiarity of the gift is that the weight of the edge between the different vertices u and v is equal to gcd(u,v)\xe2\x80\xa1. Josuke decided to experiment and make a new graph G\xe2\x80\xb2. To do this, he chooses two integers l\xe2\x89\xa4r and deletes all vertices except such vertices v that l\xe2\x89\xa4v\xe2\x89\xa4r, and also deletes all the edges except between the remaining vertices.Now Josuke is wondering how many different weights are there in G\xe2\x80\xb2. Since their count turned out to be huge, he asks for your help.\xe2\x80\xa0 A complete graph is a simple undirected graph in which every pair of distinct vertices is adjacent.\xe2\x80\xa1 gcd(x,y) denotes the greatest common divisor (GCD) of the numbers x and y." 2400
1780D "Bit Guessing Game" "binary search,bitmasks,constructive algorithms,interactive" "This is an interactive problem.Kira has a hidden positive integer n, and Hayato needs to guess it.Initially, Kira gives Hayato the value cnt \xe2\x80\x94 the number of unit bits in the binary notation of n. To guess n, Hayato can only do operations of one kind: choose an integer x and subtract it from n. Note that after each operation, the number n changes. Kira doesn\'t like bad requests, so if Hayato tries to subtract a number x greater than n, he will lose to Kira. After each operation, Kira gives Hayato the updated value cnt \xe2\x80\x94 the number of unit bits in the binary notation of the updated value of n.Kira doesn\'t have much patience, so Hayato must guess the original value of n after no more than 30 operations.Since Hayato is in elementary school, he asks for your help. Write a program that guesses the number n. Kira is an honest person, so he chooses the initial number n before all operations and does not change it afterward." 1800
1780B "GCD Partition" "brute force,greedy,math,number theory" "While at Kira\'s house, Josuke saw a piece of paper on the table with a task written on it.The task sounded as follows. There is an array a of length n. On this array, do the following:  select an integer k>1;  split the array into k subsegments \xe2\x80\xa0;  calculate the sum in each of k subsegments and write these sums to another array b (where the sum of the subsegment (l,r) is \xe2\x88\x91rj=laj);  the final score of such a split will be gcd(b1,b2,\xe2\x80\xa6,bk)\xe2\x80\xa1. The task is to find such a partition that the score is maximum possible. Josuke is interested in this task but is not strong in computer science. Help him to find the maximum possible score.\xe2\x80\xa0 A division of an array into k subsegments is k pairs of numbers (l1,r1),(l2,r2),\xe2\x80\xa6,(lk,rk) such that li\xe2\x89\xa4ri and for every 1\xe2\x89\xa4j\xe2\x89\xa4k\xe2\x88\x921 lj+1=rj+1, also l1=1 and rk=n. These pairs represent the subsegments.\xe2\x80\xa1 gcd(b1,b2,\xe2\x80\xa6,bk) stands for the greatest common divisor (GCD) of the array b." 1100
1780A "Hayato and School" "constructive algorithms,greedy" "Today Hayato came home from school with homework.In the assignment, Hayato was given an array a of length n. The task was to find 3 numbers in this array whose sum is odd. At school, he claimed that there are such 3 numbers, but Hayato was not sure, so he asked you for help.Answer if there are such three numbers, and if so, output indices i, j, and k such that ai+aj+ak is odd.The odd numbers are integers that are not divisible by 2: 1, 3, 5, and so on." 800
1779H "Olympic Team Building" "brute force,meet-in-the-middle" "Iron and Werewolf are participating in a chess Olympiad, so they want to practice team building. They gathered n players, where n is a power of 2, and they will play sports. Iron and Werewolf are among those n people.One of the sports is tug of war. For each 1\xe2\x89\xa4i\xe2\x89\xa4n, the i-th player has strength si. Elimination rounds will be held until only one player remains \xe2\x80\x94 we call that player the absolute winner.In each round:   Assume that m>1 players are still in the game, where m is a power of 2.  The m players are split into two teams of equal sizes (i. e., with m/2 players in each team). The strength of a team is the sum of the strengths of its players.  If the teams have equal strengths, Iron chooses who wins; otherwise, the stronger team wins.  Every player in the losing team is eliminated, so m/2 players remain. Iron already knows each player\'s strength and is wondering who can become the absolute winner and who can\'t if he may choose how the teams will be formed in each round, as well as the winning team in case of equal strengths." 3500
1779G "The Game of the Century" "constructive algorithms,graphs,shortest paths" "The time has finally come, MKnez and Baltic are to host The Game of the Century. For that purpose, they built a village to lodge its participants.The village has the shape of an equilateral triangle delimited by three roads of length n. It is cut into n2 smaller equilateral triangles, of side length 1, by 3n\xe2\x88\x923 additional roads which run parallel to the sides. See the figure for n=3. Each of the 3n roads is made of multiple (possibly 1) road segments of length 1 which connect adjacent intersections.  The direction has already been chosen for each of the 3n roads (so, for each road, the same direction is assigned to all its road segments). Traffic can only go in the specified directions (i. e. the roads are monodirectional).You are tasked with making adjustments to the traffic plan so that from each intersection it is possible to reach every other intersection. Specifically, you can invert the traffic direction of any number of road segments of length 1. What is the minimal number of road segments for which you need to invert the traffic direction?" 3000
1779F "Xorcerer\'s Stones" "bitmasks,constructive algorithms,dp,trees" "Misha had been banned from playing chess for good since he was accused of cheating with an engine. Therefore, he retired and decided to become a xorcerer.One day, while taking a walk in a park, Misha came across a rooted tree with nodes numbered from 11 to nn. The root of the tree is node 11. For each 1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n, node ii contains aiai stones in it. Misha has recently learned a new spell in his xorcery class and wants to test it out. A spell consists of:  Choose some node ii (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n).  Calculate the bitwise XOR xx of all ajaj such that node jj is in the subtree of ii (ii belongs to its own subtree).  Set ajaj equal to xx for all nodes jj in the subtree of ii. Misha can perform at most 2n2n spells and he wants to remove all stones from the tree. More formally, he wants ai=0ai=0 to hold for each 1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n. Can you help him perform the spells?A tree with nn nodes is a connected acyclic graph which contains n\xe2\x88\x921n\xe2\x88\x921 edges. The subtree of node ii is the set of all nodes jj such that ii lies on the simple path from 11 (the root) to jj. We consider ii to be contained in its own subtree." 2500
1779E "Anya\'s Simultaneous Exhibition" "constructive algorithms,graphs,greedy,interactive,sortings" "This is an interactive problem.Anya has gathered n chess experts numbered from 1 to n for which the following properties hold:  For any pair of players one of the players wins every game against the other (and no draws ever occur);  Transitivity does not necessarily hold \xe2\x80\x94 it might happen that A always beats B, B always beats C and C always beats A.  Anya does not know, for each pair, who is the player who beats the other.To organize a tournament, Anya hosts n\xe2\x88\x921 games. In each game, she chooses two players. One of them wins and stays, while the other one is disqualified. After all the games are hosted only one player will remain. A player is said to be a candidate master if they can win a tournament (notice that the winner of a tournament may depend on the players selected by Anya in the n\xe2\x88\x921 games).Since Anya is a curious girl, she is interested in finding the candidate masters. Unfortunately, she does not have much time. To speed up the process, she will organize up to 2n simuls (short for ""simultaneous exhibition"", in which one player plays against many).In one simul, Anya chooses exactly one player who will play against some (at least one) of the other players. The chosen player wins all games they would win in a regular game, and the same holds for losses. After the simul finishes, Anya is only told the total number of games won by the chosen player (but not which ones). Nobody is disqualified during a simul.Can you help Anya host simuls and determine the candidate masters?The winning players in each pair could be changed between the simuls, but only in a way that preserves the results of all previous simuls. These changes may depend on your queries." 2400
1779D "Boris and His Amazing Haircut" "constructive algorithms,data structures,dp,dsu,greedy,sortings" "Boris thinks that chess is a tedious game. So he left his tournament early and went to a barber shop as his hair was a bit messy.His current hair can be described by an array a1,a2,\xe2\x80\xa6,an, where ai is the height of the hair standing at position i. His desired haircut can be described by an array b1,b2,\xe2\x80\xa6,bn in a similar fashion.The barber has m razors. Each has its own size and can be used at most once. In one operation, he chooses a razor and cuts a segment of Boris\'s hair. More formally, an operation is:  Choose any razor which hasn\'t been used before, let its size be x;  Choose a segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n);  Set ai:=min(ai,x) for each l\xe2\x89\xa4i\xe2\x89\xa4r; Notice that some razors might have equal sizes \xe2\x80\x94 the barber can choose some size x only as many times as the number of razors with size x. He may perform as many operations as he wants, as long as any razor is used at most once and ai=bi for each 1\xe2\x89\xa4i\xe2\x89\xa4n at the end. He does not have to use all razors.Can you determine whether the barber can give Boris his desired haircut?" 1700
1779C "Least Prefix Sum" "data structures,greedy" "Baltic, a famous chess player who is also a mathematician, has an array a1,a2,\xe2\x80\xa6,an, and he can perform the following operation several (possibly 0) times:  Choose some index i (1\xe2\x89\xa4i\xe2\x89\xa4n);  multiply ai with \xe2\x88\x921, that is, set ai:=\xe2\x88\x92ai. Baltic\'s favorite number is m, and he wants a1+a2+\xe2\x8b\xaf+am to be the smallest of all non-empty prefix sums. More formally, for each k=1,2,\xe2\x80\xa6,n it should hold that a1+a2+\xe2\x8b\xaf+ak\xe2\x89\xa5a1+a2+\xe2\x8b\xaf+am.Please note that multiple smallest prefix sums may exist and that it is only required that a1+a2+\xe2\x8b\xaf+am is one of them.Help Baltic find the minimum number of operations required to make a1+a2+\xe2\x8b\xaf+am the least of all prefix sums. It can be shown that a valid sequence of operations always exists." 1600
1779B "MKnez\'s ConstructiveForces Task" "constructive algorithms,math" "MKnez wants to construct an array s1,s2,\xe2\x80\xa6,sn satisfying the following conditions:  Each element is an integer number different from 0;  For each pair of adjacent elements their sum is equal to the sum of the whole array. More formally, si\xe2\x89\xa00 must hold for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Moreover, it must hold that s1+s2+\xe2\x8b\xaf+sn=si+si+1 for each 1\xe2\x89\xa4i<n.Help MKnez to construct an array with these properties or determine that it does not exist." 900
1779A "Hall of Fame" "constructive algorithms,greedy,strings" "Thalia is a Legendary Grandmaster in chess. She has n trophies in a line numbered from 1 to n (from left to right) and a lamp standing next to each of them (the lamps are numbered as the trophies).A lamp can be directed either to the left or to the right, and it illuminates all trophies in that direction (but not the one it is next to). More formally, Thalia has a string s consisting only of characters \'L\' and \'R\' which represents the lamps\' current directions. The lamp i illuminates:  trophies 1,2,\xe2\x80\xa6,i\xe2\x88\x921 if si is \'L\';  trophies i+1,i+2,\xe2\x80\xa6,n if si is \'R\'. She can perform the following operation at most once:  Choose an index i (1\xe2\x89\xa4i<n);  Swap the lamps i and i+1 (without changing their directions). That is, swap si with si+1. Thalia asked you to illuminate all her trophies (make each trophy illuminated by at least one lamp), or to tell her that it is impossible to do so. If it is possible, you can choose to perform an operation or to do nothing. Notice that lamps cannot change direction, it is only allowed to swap adjacent ones." 800
1778F "Maximizing Root" "dfs and similar,dp,graphs,math,number theory,trees" "You are given a rooted tree consisting of n vertices numbered from 1 to n. Vertex 1 is the root of the tree. Each vertex has an integer value. The value of i-th vertex is ai. You can do the following operation at most k times.  Choose a vertex v that has not been chosen before and an integer x such that x is a common divisor of the values of all vertices of the subtree of v. Multiply by x the value of each vertex in the subtree of v. What is the maximum possible value of the root node 1 after at most k operations? Formally, you have to maximize the value of a1.A tree is a connected undirected graph without cycles. A rooted tree is a tree with a selected vertex, which is called the root. The subtree of a node u is the set of all nodes y such that the simple path from y to the root passes through u. Note that u is in the subtree of u." 2600
1778E "The Tree Has Fallen!" "bitmasks,dfs and similar,math,trees" "Recently, a tree has fallen on Bob\'s head from the sky. The tree has n nodes. Each node u of the tree has an integer number au written on it. But the tree has no fixed root, as it has fallen from the sky.Bob is currently studying the tree. To add some twist, Alice proposes a game. First, Bob chooses some node r to be the root of the tree. After that, Alice chooses a node v and tells him. Bob then can pick one or more nodes from the subtree of v. His score will be the bitwise XOR of all the values written on the nodes picked by him. Bob has to find the maximum score he can achieve for the given r and v.As Bob is not a good problem-solver, he asks you to help him find the answer. Can you help him? You need to find the answers for several combinations of r and v for the same tree.Recall that a tree is a connected undirected graph without cycles. The subtree of a node u is the set of all nodes y such that the simple path from y to the root passes through u. Note that u is in the subtree of u." 2500
1778D "Flexible String Revisit" combinatorics,dp,math,probabilities "You are given two binary strings a and b of length n. In each move, the string a is modified in the following way.  An index i (1\xe2\x89\xa4i\xe2\x89\xa4n) is chosen uniformly at random. The character ai will be flipped. That is, if ai is 0, it becomes 1, and if ai is 1, it becomes 0. What is the expected number of moves required to make both strings equal for the first time?A binary string is a string, in which the character is either 0 or 1." 2100
1778C "Flexible String" "bitmasks,brute force,strings" "You have a string a and a string b. Both of the strings have length n. There are at most 10 different characters in the string a. You also have a set Q. Initially, the set Q is empty. You can apply the following operation on the string a any number of times:  Choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and a lowercase English letter c. Add ai to the set Q and then replace ai with c. For example, Let the string a be ""abecca"". We can do the following operations:   In the first operation, if you choose i=3 and c=x, the character a3=e will be added to the set Q. So, the set Q will be {e}, and the string a will be ""abx_cca"". In the second operation, if you choose i=6 and c=s, the character a6=a will be added to the set Q. So, the set Q will be {e,a}, and the string a will be ""abxccs_"". You can apply any number of operations on a, but in the end, the set Q should contain at most k different characters. Under this constraint, you have to maximize the number of integer pairs (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that a[l,r]=b[l,r]. Here, s[l,r] means the substring of string s starting at index l (inclusively) and ending at index r (inclusively)." 1600
1778B "The Forbidden Permutation" greedy,math "You are given a permutation p of length n, an array of m distinct integers a1,a2,\xe2\x80\xa6,am (1\xe2\x89\xa4ai\xe2\x89\xa4n), and an integer d.Let pos(x) be the index of x in the permutation p. The array a is not good if   pos(ai)<pos(ai+1)\xe2\x89\xa4pos(ai)+d for all 1\xe2\x89\xa4i<m. For example, with the permutation p=[4,2,1,3,6,5] and d=2:   a=[2,3,6] is a not good array.  a=[2,6,5] is good because pos(a1)=2, pos(a2)=5, so the condition pos(a2)\xe2\x89\xa4pos(a1)+d is not satisfied.  a=[1,6,3] is good because pos(a2)=5, pos(a3)=4, so the condition pos(a2)<pos(a3) is not satisfied. In one move, you can swap two adjacent elements of the permutation p. What is the minimum number of moves needed such that the array a becomes good? It can be shown that there always exists a sequence of moves so that the array a becomes good.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3, but there is 4 in the array)." 1300
1778A "Flip Flop Sum" greedy,implementation "You are given an array of n integers a1,a2,\xe2\x80\xa6,an. The integers are either 1 or \xe2\x88\x921. You have to perform the following operation exactly once on the array a:  Choose an index i (1\xe2\x89\xa4i<n) and flip the signs of ai and ai+1. Here, flipping the sign means \xe2\x88\x921 will be 1 and 1 will be \xe2\x88\x921. What is the maximum possible value of a1+a2+\xe2\x80\xa6+an after applying the above operation?" 800
1777F "Comfortably Numb" "bitmasks,data structures,divide and conquer,strings,trees" "You are given an array a consisting of n non-negative integers.The numbness of a subarray al,al+1,\xe2\x80\xa6,ar (for arbitrary l\xe2\x89\xa4r) is defined as max(al,al+1,\xe2\x80\xa6,ar)\xe2\x8a\x95(al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar), where \xe2\x8a\x95 denotes the bitwise XOR operation.Find the maximum numbness over all subarrays." 2400
1777E "Edge Reverse" "binary search,dfs and similar,graphs,trees" "You will be given a weighted directed graph of n nodes and m directed edges, where the i-th edge has a weight of wi (1\xe2\x89\xa4i\xe2\x89\xa4m).You need to reverse some edges of this graph so that there is at least one node in the graph from which every other node is reachable. The cost of these reversals is equal to the maximum weight of all reversed edges. If no edge reversal is required, assume the cost to be 0.It is guaranteed that no self-loop or duplicate edge exists.Find the minimum cost required for completing the task. If there is no solution, print a single integer \xe2\x88\x921." 2200
1777D "Score of a Tree" "bitmasks,combinatorics,dfs and similar,dp,math,probabilities,trees" "You are given a tree of n nodes, rooted at 1. Every node has a value of either 0 or 1 at time t=0.At any integer time t>0, the value of a node becomes the bitwise XOR of the values of its children at time t\xe2\x88\x921; the values of leaves become 0 since they don\'t have any children.Let S(t) denote the sum of values of all nodes at time t. Let F(A) denote the sum of S(t) across all values of t such that 0\xe2\x89\xa4t\xe2\x89\xa410100, where A is the initial assignment of 0s and 1s in the tree.The task is to find the sum of F(A) for all 2n initial configurations of 0s and 1s in the tree. Print the sum modulo 109+7." 1900
1777C "Quiz Master" "binary search,math,number theory,sortings,two pointers" "A school has to decide on its team for an international quiz. There are n students in the school. We can describe the students using an array a where ai is the smartness of the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) student. There are m topics 1,2,3,\xe2\x80\xa6,m from which the quiz questions will be formed. The i-th student is considered proficient in a topic T if (aimodT)=0. Otherwise, he is a rookie in that topic. We say that a team of students is collectively proficient in all the topics if for every topic there is a member of the team proficient in this topic.Find a team that is collectively proficient in all the topics such that the maximum difference between the smartness of any two students in that team is minimized. Output this difference." 1700
1777B Emordnilap combinatorics,greedy,math "A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array). There are n!=n\xe2\x8b\x85(n\xe2\x88\x921)\xe2\x8b\x85(n\xe2\x88\x922)\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x851 different permutations of length n.Given a permutation p of n numbers, we create an array a consisting of 2n numbers, which is equal to p concatenated with its reverse. We then define the beauty of p as the number of inversions in a.The number of inversions in the array a is the number of pairs of indices i, j such that i<j and ai>aj.For example, for permutation p=[1,2], a would be [1,2,2,1]. The inversions in a are (2,4) and (3,4) (assuming 1-based indexing). Hence, the beauty of p is 2.Your task is to find the sum of beauties of all n! permutations of size n. Print the remainder we get when dividing this value by 1000000007 (109+7)." 900
1777A "Everybody Likes Good Arrays!" greedy,math "An array a is good if for all pairs of adjacent elements, ai and ai+1 (1\xe2\x89\xa4i<n) are of different parity. Note that an array of size 1 is trivially good.You are given an array of size n. In one operation you can select any pair of adjacent elements in which both elements are of the same parity, delete them, and insert their product in the same position.Find the minimum number of operations to form a good array." 800
1776N "Count Permutations" math "You are given a string s with length n\xe2\x88\x921 whose characters are either < or >.Count the permutations p1,p2,\xe2\x80\xa6,pn of 1,2,\xe2\x80\xa6,n such that, for all i=1,2,\xe2\x80\xa6,n\xe2\x88\x921, if si is < then pi<pi+1 and if si is > then pi>pi+1.Since this number can be very large, compute its logarithm in base 2." 3500
1776M "Parmigiana With Seafood" "binary search,dp,greedy,trees" "The ""Parmigiana di melanzane"" is a typical Italian dish. Alessandro and Bianca have very different tastes when it comes to it: Alessandro loves to eat Parmigiana with seafood, but Bianca thinks it is an atrocity! To decide which ingredients to include in the dish they prepare, they play the following game.There are n possible ingredients, labeled from 1 to n. The higher the label, the closer the ingredient is to being seafood. The ingredients are connected by n\xe2\x88\x921 edges, in such a way as to form a tree. Alessandro and Bianca take turns, with Alessandro going first. They alternately choose a terminal ingredient x, that is an ingredient currently connected to at most one other ingredient, and remove it from the tree. If the terminal ingredient x was chosen by Alessandro, it goes in the recipe; if it was chosen by Bianca, it is discarded.The taste of the Parmigiana is measured as the maximum label of an ingredient in the recipe. Alessandro wants to maximize the taste, while Bianca wants to minimize the taste. If both play optimally, what is the taste of the Parmigiana?" 3000
1776L Controllers "binary search,math" "You are at your grandparents\' house and you are playing an old video game on a strange console. Your controller has only two buttons and each button has a number written on it.Initially, your score is 0. The game is composed of n rounds. For each 1\xe2\x89\xa4i\xe2\x89\xa4n, the i-th round works as follows.On the screen, a symbol si appears, which is either + (plus) or - (minus). Then you must press one of the two buttons on the controller once. Suppose you press a button with the number x written on it: your score will increase by x if the symbol was + and will decrease by x if the symbol was -. After you press the button, the round ends. After you have played all n rounds, you win if your score is 0.Over the years, your grandparents bought many different controllers, so you have q of them. The two buttons on the j-th controller have the numbers aj and bj written on them. For each controller, you must compute whether you can win the game playing with that controller." 1500
1776K "Uniform Chemistry" dp,math "In a parallel universe there are n chemical elements, numbered from 1 to n. The element number n has not been discovered so far, and its discovery would be a pinnacle of research and would bring the person who does it eternal fame and the so-called SWERC prize.There are m independent researchers, numbered from 1 to m, that are trying to discover it. Currently, the i-th researcher has a sample of the element si. Every year, each researcher independently does one fusion experiment. In a fusion experiment, if the researcher currently has a sample of element a, they produce a sample of an element b that is chosen uniformly at random between a+1 and n, and they lose the sample of element a. The elements discovered by different researchers or in different years are completely independent.The first researcher to discover element n will get the SWERC prize. If several researchers discover the element in the same year, they all get the prize. For each i=1,2,\xe2\x80\xa6,m, you need to compute the probability that the i-th researcher wins the prize." 3200
1776J "Italian Data Centers" "graphs,shortest paths" "An Italian data center consists of a set of servers, each colored green, white, or red, and a set of wires connecting them. Each wire connects two distinct servers and two servers are connected by at most one wire. Additionally, the data center is connected, i.e. there is a way to transmit information between any two servers through a sequence of wires.To judge all of the contestant submissions, SWERC has an Italian data center. Since every year the number of contestants doubles, the data center needs to grow to adapt to the extra load. To address this, SWERC builds a new data center based on the previous year\'s one by following these steps:  For each server s in the old data center, the new data center contains two servers s1 and s2 of the same color as s. A wire is placed connecting the two servers s1 and s2.  For each wire connecting servers s and t in the old data center: if s and t have the same color, then a wire is placed in the new data center connecting s1 and t1 and another wire connecting s2 and t2; otherwise, a wire is placed in the new data center connecting s1 and t2 and another one connecting s2 and t1. One can show that if the old data center is connected than the new data center is also connected.You are given the Italian data center that SWERC currently has, which contains n servers (indexed by 1,2,\xe2\x80\xa6,n) and m wires connecting them. The organization wants to know how good their data center will be after k years, so you should determine the diameter of the data center SWERC will have in k years. The diameter of the data center is the largest distance between any two servers, i.e. the shortest number of wires that have to be used to transmit something between the two servers." 2500
1776I "Spinach Pizza" games,geometry,greedy,interactive "The two siblings Alberto and Beatrice have to eat a spinach pizza together. However, none of them likes spinach, so they both want to eat as little as possible.The pizza has the shape of a strictly convex polygon with n vertices located at integer coordinates (x1,y1),(x2,y2),\xe2\x80\xa6,(xn,yn) of the plane.The siblings have decided to eat the pizza in the following way: taking turns, starting with Alberto, each sibling chooses a vertex of the remaining part of the pizza and eats out the triangle determined by its two neighboring edges. In this way, after each of the first n\xe2\x88\x923 turns the pizza will have one less vertex. The game ends after the (n\xe2\x88\x922)-th turn, when all the pizza has been eaten.Assuming that Alberto and Beatrice choose the slices to eat optimally, which of the siblings manages to eat at most half of the pizza? You should identify a sibling that has a strategy to do so and help them choose the slices appropriately. Note that it is possible that both Alberto and Beatrice end up eating exactly half of the area if they choose their slices optimally." 2500
1776H "Beppa and SwerChat" "two pointers" "Beppa and her circle of geek friends keep up to date on a group chat in the instant messaging app SwerChatTM.The group has n members, excluding Beppa. Each of those members has a unique ID between 1 and n. When a user opens a group chat, SwerChatTM displays the list of other members of that group, sorted by decreasing times of last seen online (so the member who opened the chat most recently is the first of the list). However, the times of last seen are not displayed.Today, Beppa has been busy all day: she has only opened the group chat twice, once at 9:00 and once at 22:00. Both times, she wrote down the list of members in the order they appeared at that time. Now she wonders: what is the minimum number of other members that must have been online at least once between 9:00 and 22:00?Beppa is sure that no two members are ever online at the same time and no members are online when Beppa opens the group chat at 9:00 and 22:00." 1300
1776G "Another Wine Tasting Event" "combinatorics,constructive algorithms,math,strings" "After the first successful edition, Gabriella has been asked to organize a second wine tasting event. There will be 2n\xe2\x88\x921 bottles of wine arranged in a row, each of which is either red wine or white wine.This time, Gabriella has already chosen the type and order of all the bottles. The types of the wines are represented by a string s of length 2n\xe2\x88\x921. For each 1\xe2\x89\xa4i\xe2\x89\xa42n\xe2\x88\x921, it holds that si=R if the i-th bottle is red wine, and si=W if the i-th bottle is white wine.Exactly n critics have been invited to attend. The critics are numbered from 1 to n. Just like last year, each critic j wants to taste an interval of wines, that is, the bottles at positions aj,aj+1,\xe2\x80\xa6,bj for some 1\xe2\x89\xa4aj\xe2\x89\xa4bj\xe2\x89\xa42n\xe2\x88\x921. Moreover, they have the following additional requirements:  each of them wants to taste at least n wines, that is, it must hold that bj\xe2\x88\x92aj+1\xe2\x89\xa5n;  no two critics must taste exactly the same wines, that is, if j\xe2\x89\xa0k it must hold that aj\xe2\x89\xa0ak or bj\xe2\x89\xa0bk. Gabriella knows that, since the event is held in a coastal region of Italy, critics are especially interested in the white wines, and don\'t care much about the red ones. (Indeed, white wine is perfect to accompany seafood.) Thus, to ensure fairness, she would like that all critics taste the same number of white wines.Help Gabriella find an integer x (with 0\xe2\x89\xa4x\xe2\x89\xa42n\xe2\x88\x921) such that there exists a valid assignment of intervals to critics where each critic tastes exactly x white wines. It can be proved that at least one such x always exists." 2100
1776F "Train Splitting" "constructive algorithms,graphs,greedy" "There are n big cities in Italy, and there are m train routes between pairs of cities. Each route connects two different cities bidirectionally. Moreover, using the trains one can reach every city starting from any other city.Right now, all the routes are operated by the government-owned Italian Carriage Passenger Company, but the government wants to privatize the routes. The government does not want to give too much power to a single company, but it also does not want to make people buy a lot of different subscriptions. Also, it would like to give a fair chance to all companies. In order to formalize all these wishes, the following model was proposed.There will be k\xe2\x89\xa52 private companies indexed by 1,2,\xe2\x80\xa6,k. Each train route will be operated by exactly one of the k companies. Then:  For any company, there should exist two cities such that it is impossible to reach one from the other using only routes operated by that company.  On the other hand, for any two companies, it should be possible to reach every city from any other city using only routes operated by these two companies. Find a plan satisfying all these criteria. It can be shown that a viable plan always exists. Please note that you can choose the number k and you do not have to minimize or maximize it." 1700
1776E "Crossing the Railways" "data structures,dp" "Isona is in a train station. This station has two platforms, and between them there are m parallel railways that can be viewed as infinite straight lines. Each railway is identified with an integer from 1 to m, railway 1 being the closest to the first platform and railway m being the farthest. There is a 1 meter distance between consecutive railways, as well as between each platform and its closest railway.Isona is standing on the inner border of the first platform, when she realizes that she forgot to validate her ticket! There is a validating machine on the second platform, exactly opposite her current position (thus, the distance between Isona and the validating machine is m+1 meters). There are only s seconds left to validate the ticket and the bridge designated to cross the railways is too far from the validating machine. Therefore, Isona (who is very brave and a little bit careless) will cross the railways running in a straight line perpendicular to the railways themselves. Isona can only run forward (not backward) and she can stay still. When she runs at maximum speed, she needs v seconds to traverse 1 meter. She can run at any speed less than or equal to her maximum speed.There is only one problem: n trains are programmed to transit through the railways. The i-th train will use the railway ri. It will start crossing the straight line between Isona and the validating machine ai seconds from now and it will end bi seconds from now. Of course, Isona cannot cross a railway when a train is passing. Formally, for every i=1,2,\xe2\x80\xa6,n, Isona is not allowed to be on railway ri at any time t with ai<t<bi (but she is allowed to cross at times ai or bi).The following picture summarizes the situation. In the picture there are m=4 railways and two trains are visible; the train going through railway 3 is currently crossing the line between Isona and the validating machine.  Isona is a really good runner, but she gets tired every time she has to change her running speed. What is the minimum number of speed changes she has to perform to get to the validating machine on the other platform within s seconds from now? Note that at the beginning Isona is not running. She can start to run anytime. The instant she starts to run (i.e. her speed becomes positive) is not counted as a speed change." 3500
1776D Teamwork "constructive algorithms,greedy,math" "As soon as SWERC starts, your experienced 3-person team immediately realizes that the contest features a easy problems, b medium problems, and c hard problems. Solving a problem will take any of you 2, 3, or 4 time units, depending on whether the problem is easy, medium, or hard. Regardless of the difficulty of the problem, the last time unit spent to solve it has to be spent using your shared computer.You organize your efforts so that each of you starts (and ends) solving problems at integer time units. Any given problem can be solved by only one contestant; it requires a contiguous amount of time (which depends on the difficulty of the problem). None of the 3 of you can solve more than one problem at a time, but you can start solving a new problem immediately after finishing one. Similarly, the shared computer cannot be used by more than one of you at a time, but any of you can start using the computer (to complete the problem currently being solved) immediately after someone else stops using it.Given that the contest lasts l time units, find the maximum number of problems that your team can solve. Additionally, find one way to solve the maximum number of problems." 2800
1776C "Library game" games,greedy,interactive,sortings "Alessia and Bernardo are discovering the world of competitive programming through the books of their university library.The library consists of m sections numbered from 1 to m. Each section contains only books dedicated to a particular subject and different sections correspond to different subjects. In order to prevent the students from wandering in the library, the university has established a system of passes. Each pass has a length y associated to it and allows access to an interval of y consecutive sections in the library. During a visit, the student must choose exactly one book from one of these sections and leave the library. Each pass can be used only once.At the moment Alessia and Bernardo have n passes of lengths x1,x2,\xe2\x80\xa6,xn. They have different opinions on the best way to improve: Alessia thinks that it is important to study many different topics, while Bernardo believes that it is important to study deeply at least one topic. So, Alessia wants to use the n passes to get n books on distinct topics, while Bernardo would like to get at least two books on the same topic.They have reached the following agreement: for each of the following n days, Alessia will choose a pass of length y among those which are still available and an interval of y sections in the library, and Bernardo will go into the library and will take exactly one book from one of those sections.Can Bernardo manage to get at least two books on the same subject, or will Alessia be able to avoid it?You should decide whether you want to be Alessia or Bernardo, and you have to fulfill the goal of your chosen character. The judge will impersonate the other character. Note that, even if at some moment Bernardo has already taken two books on the same subject, the interaction should go on until the end of the n days." 2500
1776B "Vittorio Plays with LEGO Bricks" dp,geometry "Vittorio is playing with his new LEGO Duplo bricks. All the bricks have the shape of a square cuboid with a 2\xc3\x972 square base and a height of 1. They can be arranged in the 3D space to build structures, provided that the following rules are met: No two bricks can intersect, but they can touch on their faces. The corners of every brick must have integer coordinates (so bricks are axis-aligned) and the z coordinates of all corners must be non-negative. The square bases of every brick must be parallel to the ground (i.e. the plane z=0). The lower base of any brick that is not touching the ground must touch the upper base of some other brick in a region of positive area (when this happens, the two bricks stay attached to each other thanks to small studs).For example, this is a valid structure:  Vittorio wants to build a structure that includes purple bricks in the following n positions: (x1,0,h), (x2,0,h), \xe2\x80\xa6, (xn,0,h) \xe2\x80\x94 these are the coordinates of the centers of their lower bases; note that all of these bricks have y coordinate equal to 0 and z coordinate equal to h. Vittorio will use additional bricks of other colors to support the purple bricks. He is willing to place bricks only in positions where the center of the lower base has y coordinate equal to 0. What is the minimum number of additional bricks needed?It can be shown that a valid construction always exists." 2200
1776A "Walking Boy" greedy "One of the SWERC judges has a dog named Boy. Besides being a good competitive programmer, Boy loves fresh air, so she wants to be walked at least twice a day. Walking Boy requires 120 consecutive minutes. Two walks cannot overlap, but one can start as soon as the previous one has finished. Boy before and after getting ACCEPTED on this problem. Today, the judge sent n messages to the SWERC Discord server. The i-th message was sent ai minutes after midnight. You know that, when walking Boy, the judge does not send any messages, but he can send a message right before or right after a walk. Is it possible that the judge walked Boy at least twice today?Note that a day has 1440 minutes, and a walk is considered to happen today if it starts at a minute s\xe2\x89\xa50 and ends right before a minute e\xe2\x89\xa41440. In that case, it must hold that e\xe2\x88\x92s=120 and, for every i=1,2\xe2\x80\xa6,n, either ai\xe2\x89\xa4s or ai\xe2\x89\xa5e." 800
1775F "Laboratory on Pluto" "constructive algorithms,dp,greedy,math" "As you know, Martian scientists are actively engaged in space research. One of the highest priorities is Pluto. In order to study this planet in more detail, it was decided to build a laboratory on Pluto.It is known that the lab will be built of n square blocks of equal size. For convenience, we will assume that Pluto\'s surface is a plane divided by vertical and horizontal lines into unit squares. Each square is either occupied by a lab block or not, and only n squares are occupied.Since each block is square, it has four walls. If a wall is adjacent to another block, it is considered inside, otherwise \xe2\x80\x94 outside.Pluto is famous for its extremely cold temperatures, so the outside walls of the lab must be insulated. One unit of insulation per exterior wall would be required. Thus, the greater the total length of the outside walls of the lab (i. e., its perimeter), the more insulation will be needed.Consider the lab layout in the figure below. It shows that the lab consists of n=33 blocks, and all the blocks have a total of 24 outside walls, i. e. 24 units of insulation will be needed.You should build the lab optimally, i. e., minimize the amount of insulation. On the other hand, there may be many optimal options, so scientists may be interested in the number of ways to build the lab using the minimum amount of insulation, modulo a prime number m.Two ways are considered the same if they are the same when overlapping without turning. Thus, if a lab plan is rotated by 90\xe2\x88\x98, such a new plan can be considered a separate way.To help scientists explore Pluto, you need to write a program that solves these difficult problems." 2500
1775E "The Human Equation" greedy,implementation "Petya and his friend, the robot Petya++, went to BFDMONCON, where the costume contest is taking place today.   While walking through the festival, they came across a scientific stand named after Professor Oak and Golfball, where they were asked to solve an interesting problem.Given a sequence of numbers a1,a2,\xe2\x80\xa6,an you can perform several operations on this sequence.Each operation should look as follows. You choose some subsequence\xe2\x80\xa0. Then you call all the numbers at odd positions in this subsequence northern, and all the numbers at even positions in this subsequence southern. In this case, only the position of the number in the subsequence is taken into account, not in the original sequence.For example, consider the sequence 1,4,2,8,5,7,3,6,9 and its subsequence (shown in bold) 1,4,2,8,5,7,3,6,9. Then the numbers 4 and 5 are northern, and the numbers 2 and 6 are southern.After that, you can do one of the following:   add 1 to all northern numbers and subtract 1 from all south numbers; or  add 1 to all southern numbers and subtract 1 from all northern numbers. Thus, from the sequence 1,4,2,8,5,7,3,6,9, if you choose the subsequence shown in bold, you can get either 1,5,1,8,6,7,3,5,9 or 1,3,3,8,4,7,3,7,9.Then the operation ends. Note also that all operations are independent, i. e. the numbers are no longer called northern or southern when one operation ends.It is necessary to turn all the numbers of the sequence into zeros using the operations described above. Since there is very little time left before the costume contest, the friends want to know, what is the minimum number of operations required for this.The friends were unable to solve this problem, so can you help them?\xe2\x80\xa0 A sequence c is a subsequence of a sequence d if c can be obtained from d by the deletion of several (possibly, zero or all) elements." 2100
1775D "Friendly Spiders" "dfs and similar,graphs,math,number theory,shortest paths" "Mars is home to an unusual species of spiders \xe2\x80\x94 Binary spiders.Right now, Martian scientists are observing a colony of nn spiders, the ii-th of which has aiai legs.Some of the spiders are friends with each other. Namely, the ii-th and jj-th spiders are friends if gcd(ai,aj)\xe2\x89\xa01gcd(ai,aj)\xe2\x89\xa01, i. e., there is some integer k\xe2\x89\xa52k\xe2\x89\xa52 such that aiai and ajaj are simultaneously divided by kk without a remainder. Here gcd(x,y)gcd(x,y) denotes the greatest common divisor (GCD) of integers xx and yy.Scientists have discovered that spiders can send messages. If two spiders are friends, then they can transmit a message directly in one second. Otherwise, the spider must pass the message to his friend, who in turn must pass the message to his friend, and so on until the message reaches the recipient.Let\'s look at an example.Suppose a spider with eight legs wants to send a message to a spider with 1515 legs. He can\'t do it directly, because gcd(8,15)=1gcd(8,15)=1. But he can send a message through the spider with six legs because gcd(8,6)=2gcd(8,6)=2 and gcd(6,15)=3gcd(6,15)=3. Thus, the message will arrive in two seconds.Right now, scientists are observing how the ss-th spider wants to send a message to the tt-th spider. The researchers have a hypothesis that spiders always transmit messages optimally. For this reason, scientists would need a program that could calculate the minimum time to send a message and also deduce one of the optimal routes." 1800
1775C "Interesting Sequence" bitmasks,math "Petya and his friend, robot Petya++, like to solve exciting math problems.One day Petya++ came up with the numbers n and x and wrote the following equality on the board: n & (n+1) & \xe2\x80\xa6 & m=x, where & denotes the bitwise AND operation. Then he suggested his friend Petya find such a minimal m (m\xe2\x89\xa5n) that the equality on the board holds.Unfortunately, Petya couldn\'t solve this problem in his head and decided to ask for computer help. He quickly wrote a program and found the answer.Can you solve this difficult problem?" 1600
1775B "Gardener and the Array" "bitmasks,constructive algorithms" "The gardener Kazimir Kazimirovich has an array of n integers c1,c2,\xe2\x80\xa6,cn.He wants to check if there are two different subsequences a and b of the original array, for which f(a)=f(b), where f(x) is the bitwise OR of all of the numbers in the sequence x.A sequence q is a subsequence of p if q can be obtained from p by deleting several (possibly none or all) elements.Two subsequences are considered different if the sets of indexes of their elements in the original sequence are different, that is, the values of the elements are not considered when comparing the subsequences." 1300
1775A2 "Gardener and the Capybaras (hard version)" "constructive algorithms,greedy" "This is an hard version of the problem. The difference between the versions is that the string can be longer than in the easy version. You can only do hacks if both versions of the problem are passed.Kazimir Kazimirovich is a Martian gardener. He has a huge orchard of binary balanced apple trees.Recently Casimir decided to get himself three capybaras. The gardener even came up with their names and wrote them down on a piece of paper. The name of each capybara is a non-empty line consisting of letters ""a"" and ""b"".Denote the names of the capybaras by the lines a, b, and c. Then Casimir wrote the nonempty lines a, b, and c in a row without spaces. For example, if the capybara\'s name was ""aba"", ""ab"", and ""bb"", then the string the gardener wrote down would look like ""abaabbb"".The gardener remembered an interesting property: either the string b is lexicographically not smaller than the strings a and c at the same time, or the string b is lexicographically not greater than the strings a and c at the same time. In other words, either a\xe2\x89\xa4b and c\xe2\x89\xa4b are satisfied, or b\xe2\x89\xa4a and b\xe2\x89\xa4c are satisfied (or possibly both conditions simultaneously). Here \xe2\x89\xa4 denotes the lexicographic ""less than or equal to"" for strings. Thus, a\xe2\x89\xa4b means that the strings must either be equal, or the string a must stand earlier in the dictionary than the string b. For a more detailed explanation of this operation, see ""Notes"" section.Today the gardener looked at his notes and realized that he cannot recover the names because they are written without spaces. He is no longer sure if he can recover the original strings a, b, and c, so he wants to find any triplet of names that satisfy the above property." 900
1775A1 "Gardener and the Capybaras (easy version)" "brute force,constructive algorithms,implementation" "This is an easy version of the problem. The difference between the versions is that the string can be longer than in the easy version. You can only do hacks if both versions of the problem are passed.Kazimir Kazimirovich is a Martian gardener. He has a huge orchard of binary balanced apple trees.Recently Casimir decided to get himself three capybaras. The gardener even came up with their names and wrote them down on a piece of paper. The name of each capybara is a non-empty line consisting of letters ""a"" and ""b"".Denote the names of the capybaras by the lines a, b, and c. Then Casimir wrote the nonempty lines a, b, and c in a row without spaces. For example, if the capybara\'s name was ""aba"", ""ab"", and ""bb"", then the string the gardener wrote down would look like ""abaabbb"".The gardener remembered an interesting property: either the string b is lexicographically not smaller than the strings a and c at the same time, or the string b is lexicographically not greater than the strings a and c at the same time. In other words, either a\xe2\x89\xa4b and c\xe2\x89\xa4b are satisfied, or b\xe2\x89\xa4a and b\xe2\x89\xa4c are satisfied (or possibly both conditions simultaneously). Here \xe2\x89\xa4 denotes the lexicographic ""less than or equal to"" for strings. Thus, a\xe2\x89\xa4b means that the strings must either be equal, or the string a must stand earlier in the dictionary than the string b. For a more detailed explanation of this operation, see ""Notes"" section.Today the gardener looked at his notes and realized that he cannot recover the names because they are written without spaces. He is no longer sure if he can recover the original strings a, b, and c, so he wants to find any triplet of names that satisfy the above property." 800
1774H "Maximum Permutation" "constructive algorithms" "Ecrade bought a deck of cards numbered from 1 to n. Let the value of a permutation a of length n be n\xe2\x88\x92k+1mini=1 i+k\xe2\x88\x921\xe2\x88\x91j=iaj.Ecrade wants to find the most valuable one among all permutations of the cards. However, it seems a little difficult, so please help him!" 3500
1774G "Segment Covering" "brute force,combinatorics,constructive algorithms,data structures,dp,trees" "ChthollyNotaSeniorious gives DataStructures a number axis with m distinct segments on it. Let f(l,r) be the number of ways to choose an even number of segments such that the union of them is exactly [l,r], and g(l,r) be the number of ways to choose an odd number of segments such that the union of them is exactly [l,r].ChthollyNotaSeniorious asked DataStructures q questions. In each query, ChthollyNotaSeniorious will give DataStructures two numbers l,r, and now he wishes that you can help him find the value f(l,r)\xe2\x88\x92g(l,r) modulo 998244353 so that he wouldn\'t let her down." 3200
1774F2 "Magician and Pigs (Hard Version)" "binary search,brute force,data structures,implementation" "This is the hard version of the problem. The only difference between the two versions is the constraint on n and x. You can make hacks only if both versions of the problem are solved.Little09 has been interested in magic for a long time, and it\'s so lucky that he meets a magician! The magician will perform n operations, each of them is one of the following three: 1 x: Create a pig with x Health Points.  2 x: Reduce the Health Point of all living pigs by x.  3: Repeat all previous operations. Formally, assuming that this is the i-th operation in the operation sequence, perform the first i\xe2\x88\x921 operations (including ""Repeat"" operations involved) in turn.A pig will die when its Health Point is less than or equal to 0. Little09 wants to know how many living pigs there are after all the operations. Please, print the answer modulo 998244353." 2700
1774F1 "Magician and Pigs (Easy Version)" "brute force,data structures,implementation" "This is the easy version of the problem. The only difference between the two versions is the constraint on n and x. You can make hacks only if both versions of the problem are solved.Little09 has been interested in magic for a long time, and it\'s so lucky that he meets a magician! The magician will perform n operations, each of them is one of the following three: 1 x: Create a pig with x Health Points.  2 x: Reduce the Health Point of all living pigs by x.  3: Repeat all previous operations. Formally, assuming that this is the i-th operation in the operation sequence, perform the first i\xe2\x88\x921 operations (including ""Repeat"" operations involved) in turn.A pig will die when its Health Point is less than or equal to 0. Little09 wants to know how many living pigs there are after all the operations. Please, print the answer modulo 998244353." 2400
1774E "Two Chess Pieces" "dfs and similar,dp,greedy,trees" "Cirno_9baka has a tree with n nodes. He is willing to share it with you, which means you can operate on it.Initially, there are two chess pieces on the node 1 of the tree. In one step, you can choose any piece, and move it to the neighboring node. You are also given an integer d. You need to ensure that the distance between the two pieces doesn\'t ever exceed d.Each of these two pieces has a sequence of nodes which they need to pass in any order, and eventually, they have to return to the root. As a curious boy, he wants to know the minimum steps you need to take." 1900
1774D "Same Count One" "brute force,constructive algorithms,greedy,implementation,two pointers" "ChthollyNotaSeniorious received a special gift from AquaMoon: n binary arrays of length m. AquaMoon tells him that in one operation, he can choose any two arrays and any position pos from 1 to m, and swap the elements at positions pos in these arrays.He is fascinated with this game, and he wants to find the minimum number of operations needed to make the numbers of 1s in all arrays the same. He has invited you to participate in this interesting game, so please try to find it!If it is possible, please output specific exchange steps in the format described in the output section. Otherwise, please output \xe2\x88\x921." 1600
1774C "Ice and Fire" "constructive algorithms,dp,greedy" "Little09 and his friends are playing a game. There are n players, and the temperature value of the player i is i. The types of environment are expressed as 0 or 1. When two players fight in a specific environment, if its type is 0, the player with a lower temperature value in this environment always wins; if it is 1, the player with a higher temperature value in this environment always wins. The types of the n\xe2\x88\x921 environments form a binary string s with a length of n\xe2\x88\x921.If there are x players participating in the game, there will be a total of x\xe2\x88\x921 battles, and the types of the x\xe2\x88\x921 environments will be the first x\xe2\x88\x921 characters of s. While there is more than one player left in the tournament, choose any two remaining players to fight. The player who loses will be eliminated from the tournament. The type of the environment of battle i is si.For each x from 2 to n, answer the following question: if all players whose temperature value does not exceed x participate in the game, how many players have a chance to win?" 1300
1774B Coloring "constructive algorithms,greedy,math" "Cirno_9baka has a paper tape with n cells in a row on it. As he thinks that the blank paper tape is too dull, he wants to paint these cells with m kinds of colors. For some aesthetic reasons, he thinks that the i-th color must be used exactly ai times, and for every k consecutive cells, their colors have to be distinct. Help Cirno_9baka to figure out if there is such a way to paint the cells." 1500
1774A "Add Plus Minus Sign" "constructive algorithms,math" "AquaMoon has a string a consisting of only 0 and 1. She wants to add + and \xe2\x88\x92 between all pairs of consecutive positions to make the absolute value of the resulting expression as small as possible. Can you help her?" 800
1773L "Lisa\'s Sequences" dp "Lisa loves playing with the sequences of integers. When she gets a new integer sequence ai of length n, she starts looking for all monotone subsequences. A monotone subsequence [l,r] is defined by two indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n) such that \xe2\x88\x80i=l,l+1,\xe2\x80\xa6,r\xe2\x88\x921:ai\xe2\x89\xa4ai+1 or \xe2\x88\x80i=l,l+1,\xe2\x80\xa6,r\xe2\x88\x921:ai\xe2\x89\xa5ai+1. Lisa considers a sequence ai to be boring if there is a monotone subsequence [l,r] that is as long as her boredom threshold k, that is when r\xe2\x88\x92l+1=k.Lucas has a sequence bi that he wants to present to Lisa, but the sequence might be boring for Lisa. So, he wants to change some elements of his sequence bi, so that Lisa does not get bored playing with it. However, Lucas is lazy and wants to change as few elements of the sequence bi as possible. Your task is to help Lucas find the required changes." 3500
1773J "Jumbled Trees" "constructive algorithms,math" "You are given an undirected connected graph with n vertices and m edges. Each edge has an associated counter, initially equal to 0. In one operation, you can choose an arbitrary spanning tree and add any value v to all edges of this spanning tree. Determine if it\'s possible to make every counter equal to its target value xi modulo prime p, and provide a sequence of operations that achieves it." 2900
1773I "Interactive Factorial Guessing" "brute force,games,implementation,interactive" "Oh no, this wicked jury hides something from you again, and you need to guess it interactively. This time, you need to find an integer n. To do that, you can make at most 10 queries of the form ""What is the k-th decimal digit of the product of all integers from 1 to n (also known as factorial and denoted as n!)?""." 2500
1773H "Hot and Cold" "binary search,interactive" "This is an interactive problem.After emigrating to another country, little Hanna came across the fact that playing ""Hot and cold"" became more difficult: she does not understand the hint phrases! You are to write a helping program for her.The playground where the game happens is a rectangle, and the treasure is hidden in some point with integer coordinates between 0 and 106, inclusive. Hanna visits several points with valid coordinates. If the visited point contains the hidden treasure, she receives the phrase ""Found!"" in the local language. Fortunately, the intonations allow her to recognize this phrase \xe2\x80\x94 in this problem it will be denoted by an exclamation mark.Otherwise, for each visited point except for the first one, Hanna receives a phrase in the local language stating whether she is now ""Closer"", ""Further"", or ""At the same distance"" from the treasure, compared to the previous point. The distances are measured in Euclidean metric. After the first visited point, in case of no treasure there, Hanna receives the phrase ""Not found"" in the local language.Your program must help Hanna find the treasure by visiting at most 64 points." 2600
1773G "Game of Questions" bitmasks,combinatorics,dp,fft,math,probabilities "Genie is taking part in an intellectual game. The game consists of n questions, and there are m participants numbered from 1 to m. Genie is the participant number 1.For each question i and participant j, it is known whether the participant will answer the question correctly or not.The goal of the game is to be the last participant staying in the game.The game is conducted as follows. First, all n questions get shuffled uniformly at random (all n! permutations are equally likely). Then, the questions are asked one by one. Each participant answers the question. If all participants still in the game answer the question correctly, or if all of them answer the question incorrectly, nothing happens. Otherwise, those participants who answer the question incorrectly lose and leave the game.After all n questions are asked, all participants who are still in the game are declared to be the winners.What is the probability that Genie will win the game?" 2800
1773F Football "constructive algorithms" "Scientists are researching an impact of football match results on the mood of football fans. They have a hypothesis that there is a correlation between the number of draws and fans\' desire to watch football matches in the future.In football, two teams play a match. The teams score goals throughout a match. A score ""x:y"" means that the team we observe scored x goals and conceded y goals. If x=y, then the match ends in a draw. If x>y, then the observed team wins, and if x<y, then it loses.To find out if there is a correlation, the scientists gathered information about the results of teams in lower leagues. The information they found is the number of matches played by the team (n), the number of goals scored in these matches (a), and the number of goals conceded in these matches (b). You are given this information for a single team. You are asked to calculate the minimum number of draws that could have happened during the team\'s matches and provide a list of match scores with the minimum number of draws." 800
1773E "Easy Assembly" greedy,sortings "Emma loves playing with blocks. She has several cubic blocks of the same size that are numbered with distinct integers written on them. She assembles towers from those blocks by stacking them vertically. A configuration of her game is a set of towers that she has assembled from the blocks. Emma can perform two kinds of operations on a configuration of towers: Split any tower with more than one block in it by taking any number of blocks from the top of the tower and moving them to a new tower keeping their order, so that the top block of the old tower becomes the top block of the new tower. As a result of this operation, the number of towers increases by one. Combine any two towers by moving blocks from one tower on top of the other tower in the same order. As a result of this operation, the number of towers decreases by one.Emma wants to stack all the blocks into a single tower so that all blocks come in order sorted by the numbers \xe2\x80\x94 from the block with the minimal number at the top to the block with the maximal number at the bottom. Emma wants to do as little of splitting and combining operations as possible. Your task is to find the minimal number of operations she has to make and output how many splits and combines are needed." 1400
1773D Dominoes "combinatorics,flows,graph matchings,greedy" "Dora likes to play with dominoes. She takes n\xc3\x97m table, marks some cells as occupied, and then tries to fill all unoccupied cells with 2\xc3\x971 dominoes.  Her little brother Dani loves to play pranks on his older sister. So when she is away, he marks two more unoccupied cells as occupied. He wants to do it in such a way that it will be impossible to fill all unoccupied cells with dominoes.Help Dani to count the number of ways he can select these two cells. Since Dani can only count to one million, if this number of ways is x, output min(x,106)." 2600
1773B BinCoin "binary search,divide and conquer,hashing,implementation,probabilities,trees" "There are n employees in the BinCoin company numbered from 1 to n. The subordination structure in this company is a rooted tree. In other words:   There is one CEO in the company \xe2\x80\x94 the main boss.  Each other employee has exactly one direct superior.  There are no cycles in the subordination structure. Moreover, due to the inexplicable love of the CEO of BinCoin for all the binary stuff, the subordination structure in the company is a binary rooted tree. That means each employee is directly superior to exactly zero or two other employees.In the CEO\'s opinion, working in this company is almost as dangerous as in mines. So, employees should sign the waiver of claims sometimes. This process happens in the following way. Initially, CEO takes the journal, then recursively the following procedure is performed:  If an employee that holds the journal does not have any subordinates, they sign the waiver in the journal and give it back to their superior. The procedure stops if that was the CEO, who has no superior.  Otherwise   they choose one of two of their direct subordinates uniformly at random and give the journal to one of them;  when they get the journal back, they sign it;  and then they give it to another direct subordinate;  when they get it back again, they give it back to their superior. The procedure stops if that was the CEO, who has no superior.  All random choices are independent.One day, the CEO realized that they could not remember the subordination tree. Fortunately, they have the journal with k records. Each record is a sequence of employees in the order they\'ve signed in a journal.Help CEO restore the subordination tree." 2200
1773A "Amazing Trick" "constructive algorithms,graph matchings,math,probabilities" "Alice is a magician and she creates a new trick. She has n cards with different numbers from 1 to n written on them. First, she asks an audience member to shuffle the deck and put cards in a row. Let\'s say the i-th card from the left has the number ai on it. Then Alice picks two permutations p and q. There is a restriction on p and q \xe2\x80\x94 permutations can\'t have fixed points. Which means \xe2\x88\x80i:pi\xe2\x89\xa0i and qi\xe2\x89\xa0i.After permutations are chosen, Alice shuffles the cards according to them. Now the i-th card from the left is the card a[p[q[i]]. The trick is considered successful if i-th card from the left has the number i on it after the shuffles.Help Alice pick the permutations p and q or say it is not possible for the specific starting permutation a." 1900
1772G "Gaining Rating" "binary search,greedy,implementation,math,sortings,two pointers" "Monocarp is playing chess on one popular website. He has n opponents he can play with. The i-th opponent has rating equal to ai. Monocarp\'s initial rating is x. Monocarp wants to raise his rating to the value y (y>x).When Monocarp is playing against one of the opponents, he will win if his current rating is bigger or equal to the opponent\'s rating. If Monocarp wins, his rating is increased by 1, otherwise it is decreased by 1. The rating of his opponent does not change.Monocarp wants to gain rating y playing as few games as possible. But he can\'t just grind it, playing against weak opponents. The website has a rule that you should play against all opponents as evenly as possible. Speaking formally, if Monocarp wants to play against an opponent i, there should be no other opponent j such that Monocarp has played more games against i than against j.Calculate the minimum possible number of games Monocarp needs to gain rating y or say it\'s impossible. Note that ratings of Monocarp\'s opponents don\'t change, while Monocarp\'s rating does change." 2200
1772F "Copy of a Copy of a Copy" "constructive algorithms,dfs and similar,graphs,implementation,sortings" "It all started with a black-and-white picture, that can be represented as an n\xc3\x97m matrix such that all its elements are either 0 or 1. The rows are numbered from 1 to n, the columns are numbered from 1 to m.Several operations were performed on the picture (possibly, zero), each of one of the two kinds:   choose a cell such that it\'s not on the border (neither row 1 or n, nor column 1 or m) and it\'s surrounded by four cells of the opposite color (four zeros if it\'s a one and vice versa) and paint it the opposite color itself;  make a copy of the current picture. Note that the order of operations could be arbitrary, they were not necessarily alternating.You are presented with the outcome: all k copies that were made. Additionally, you are given the initial picture. However, all k+1 pictures are shuffled.Restore the sequence of the operations. If there are multiple answers, print any of them. The tests are constructed from the real sequence of operations, i.\xe2\x80\x89e. at least one answer always exists." 2000
1772E "Permutation Game" games "Two players are playing a game. They have a permutation of integers 1, 2, ..., n (a permutation is an array where each element from 1 to n occurs exactly once). The permutation is not sorted in either ascending or descending order (i.\xe2\x80\x89e. the permutation does not have the form [1,2,\xe2\x80\xa6,n] or [n,n\xe2\x88\x921,\xe2\x80\xa6,1]).Initially, all elements of the permutation are colored red. The players take turns. On their turn, the player can do one of three actions:  rearrange the elements of the permutation in such a way that all red elements keep their positions (note that blue elements can be swapped with each other, but it\'s not obligatory);  change the color of one red element to blue;  skip the turn. The first player wins if the permutation is sorted in ascending order (i.\xe2\x80\x89e. it becomes [1,2,\xe2\x80\xa6,n]). The second player wins if the permutation is sorted in descending order (i.\xe2\x80\x89e. it becomes [n,n\xe2\x88\x921,\xe2\x80\xa6,1]). If the game lasts for 100500 turns and nobody wins, it ends in a draw.Your task is to determine the result of the game if both players play optimally." 1700
1772D "Absolute Sorting" "constructive algorithms,math" "You are given an array a consisting of n integers. The array is sorted if a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an.You want to make the array a sorted by applying the following operation exactly once:  choose an integer x, then for every i\xe2\x88\x88[1,n], replace ai by |ai\xe2\x88\x92x|. Find any value of x that will make the array sorted, or report that there is no such value." 1400
1772C "Different Differences" "constructive algorithms,greedy,math" "An array a consisting of k integers is strictly increasing if a1<a2<\xe2\x8b\xaf<ak. For example, the arrays [1,3,5], [1,2,3,4], [3,5,6] are strictly increasing; the arrays [2,2], [3,7,5], [7,4,3], [1,2,2,3] are not.For a strictly increasing array a of k elements, let\'s denote the characteristic as the number of different elements in the array [a2\xe2\x88\x92a1,a3\xe2\x88\x92a2,\xe2\x80\xa6,ak\xe2\x88\x92ak\xe2\x88\x921]. For example, the characteristic of the array [1,3,4,7,8] is 3 since the array [2,1,3,1] contains 3 different elements: 2, 1 and 3.You are given two integers k and n (k\xe2\x89\xa4n). Construct an increasing array of k integers from 1 to n with maximum possible characteristic." 1000
1772B "Matrix Rotation" "brute force,implementation" "You have a matrix 2\xc3\x972 filled with distinct integers. You want your matrix to become beautiful. The matrix is beautiful if the following two conditions are satisfied:  in each row, the first element is smaller than the second element;  in each column, the first element is smaller than the second element.   You can perform the following operation on the matrix any number of times: rotate it clockwise by 90 degrees, so the top left element shifts to the top right cell, the top right element shifts to the bottom right cell, and so on:  Determine if it is possible to make the matrix beautiful by applying zero or more operations." 800
1772A A+B? implementation "You are given an expression of the form a+b, where a and b are integers from 0 to 9. You have to evaluate it and print the result." 800
1771F "Hossam and Range Minimum Query" "binary search,bitmasks,data structures,hashing,probabilities,strings,trees" "Hossam gives you a sequence of integers a1,a2,\xe2\x80\xa6,an of length n. Moreover, he will give you q queries of type (l,r). For each query, consider the elements al,al+1,\xe2\x80\xa6,ar. Hossam wants to know the smallest number in this sequence, such that it occurs in this sequence an odd number of times.You need to compute the answer for each query before process the next query." 2500
1771E "Hossam and a Letter" "brute force,dp,implementation,two pointers" "Hossam bought a new piece of ground with length n and width m, he divided it into an n\xe2\x8b\x85m grid, each cell being of size 1\xc3\x971.Since Hossam\'s name starts with the letter \'H\', he decided to draw the capital letter \'H\' by building walls of size 1\xc3\x971 on some squares of the ground. Each square 1\xc3\x971 on the ground is assigned a quality degree: perfect, medium, or bad.The process of building walls to form up letter \'H\' has the following constraints:  The letter must consist of one horizontal and two vertical lines.  The vertical lines must not be in the same or neighboring columns.  The vertical lines must start in the same row and end in the same row (and thus have the same length).  The horizontal line should connect the vertical lines, but must not cross them.  The horizontal line can be in any row between the vertical lines (not only in the middle), except the top and the bottom one. (With the horizontal line in the top row the letter looks like \'n\', and in the bottom row like \'U\'.)  It is forbidden to build walls in cells of bad quality.  You can use at most one square of medium quality.  You can use any number of squares of perfect quality. Find the maximum number of walls that can be used to draw the letter \'H\'.Check the note for more clarification." 2500
1771D "Hossam and (sub-)palindromic tree" "brute force,data structures,dfs and similar,dp,strings,trees" "Hossam has an unweighted tree G with letters in vertices.Hossam defines s(v,u) as a string that is obtained by writing down all the letters on the unique simple path from the vertex v to the vertex u in the tree G.A string a is a subsequence of a string s if a can be obtained from s by deletion of several (possibly, zero) letters. For example, ""dores"", ""cf"", and ""for"" are subsequences of ""codeforces"", while ""decor"" and ""fork"" are not.A palindrome is a string that reads the same from left to right and from right to left. For example, ""abacaba"" is a palindrome, but ""abac"" is not.Hossam defines a sub-palindrome of a string s as a subsequence of s, that is a palindrome. For example, ""k"", ""abba"" and ""abhba"" are sub-palindromes of the string ""abhbka"", but ""abka"" and ""cat"" are not.Hossam defines a maximal sub-palindrome of a string s as a sub-palindrome of s, which has the maximal length among all sub-palindromes of s. For example, ""abhbka"" has only one maximal sub-palindrome \xe2\x80\x94 ""abhba"". But it may also be that the string has several maximum sub-palindromes: the string ""abcd"" has 4 maximum sub-palindromes.Help Hossam find the length of the longest maximal sub-palindrome among all s(v,u) in the tree G.Note that the sub-palindrome is a subsequence, not a substring." 2100
1771C "Hossam and Trainees" "greedy,math,number theory" "Hossam has n trainees. He assigned a number ai for the i-th trainee. A pair of the i-th and j-th (i\xe2\x89\xa0j) trainees is called successful if there is an integer x (x\xe2\x89\xa52), such that x divides ai, and x divides aj.Hossam wants to know if there is a successful pair of trainees.Hossam is very tired now, so he asks you for your help!" 1600
1771B "Hossam and Friends" "binary search,constructive algorithms,dp,two pointers" "Hossam makes a big party, and he will invite his friends to the party.He has n friends numbered from 1 to n. They will be arranged in a queue as follows: 1,2,3,\xe2\x80\xa6,n.Hossam has a list of m pairs of his friends that don\'t know each other. Any pair not present in this list are friends.A subsegment of the queue starting from the friend a and ending at the friend b is [a,a+1,a+2,\xe2\x80\xa6,b]. A subsegment of the queue is called good when all pairs of that segment are friends.Hossam wants to know how many pairs (a,b) there are (1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4n), such that the subsegment starting from the friend a and ending at the friend b is good." 1400
1771A "Hossam and Combinatorics" combinatorics,math,sortings "Hossam woke up bored, so he decided to create an interesting array with his friend Hazem.Now, they have an array a of n positive integers, Hossam will choose a number ai and Hazem will choose a number aj.Count the number of interesting pairs (ai,aj) that meet all the following conditions: 1\xe2\x89\xa4i,j\xe2\x89\xa4n; i\xe2\x89\xa0j; The absolute difference |ai\xe2\x88\x92aj| must be equal to the maximum absolute difference over all the pairs in the array. More formally, |ai\xe2\x88\x92aj|=max1\xe2\x89\xa4p,q\xe2\x89\xa4n|ap\xe2\x88\x92aq|." 900
1770H "Koxia, Mahiru and Winter Festival" "constructive algorithms" "Wow, what a big face!Kagura MahiruKoxia and Mahiru are enjoying the Winter Festival. The streets of the Winter Festival can be represented as a n\xc3\x97n undirected grid graph. Formally, the set of vertices is {(i,j)|1\xe2\x89\xa4i,j\xe2\x89\xa4n} and two vertices (i1,j1) and (i2,j2) are connected by an edge if and only if |i1\xe2\x88\x92i2|+|j1\xe2\x88\x92j2|=1.  A network with size n=3. Koxia and Mahiru are planning to visit The Winter Festival by traversing 2n routes. Although routes are not planned yet, the endpoints of the routes are already planned as follows:  In the i-th route, they want to start from vertex (1,i) and end at vertex (n,pi), where p is a permutation of length n.  In the (i+n)-th route, they want to start from vertex (i,1) and end at vertex (qi,n), where q is a permutation of length n.   A network with size n=3, points to be connected are shown in the same color for p=[3,2,1] and q=[3,1,2]. Your task is to find a routing scheme \xe2\x80\x94 2n paths where each path connects the specified endpoints. Let\'s define the congestion of an edge as the number of times it is used (both directions combined) in the routing scheme. In order to ensure that Koxia and Mahiru won\'t get too bored because of traversing repeated edges, please find a routing scheme that minimizes the maximum congestion among all edges.  An example solution \xe2\x80\x94 the maximum congestion is 2, which is optimal in this case." 3500
1770G "Koxia and Bracket" "divide and conquer,fft,math" "Chiyuu has a bracket sequence\xe2\x80\xa0 s of length n. Let k be the minimum number of characters that Chiyuu has to remove from s to make s balanced\xe2\x80\xa1.Now, Koxia wants you to count the number of ways to remove k characters from s so that s becomes balanced, modulo 998244353.Note that two ways of removing characters are considered distinct if and only if the set of indices removed is different.\xe2\x80\xa0 A bracket sequence is a string containing only the characters ""("" and "")"".\xe2\x80\xa1 A bracket sequence is called balanced if one can turn it into a valid math expression by adding characters + and 1. For example, sequences (())(), (), (()(())) and the empty string are balanced, while )(, ((), and (()))( are not." 3400
1770F "Koxia and Sequence" "bitmasks,combinatorics,dp,math,number theory" "Mari has three integers n, x, and y.Call an array a of n non-negative integers good if it satisfies the following conditions:  a1+a2+\xe2\x80\xa6+an=x, and  a1|a2|\xe2\x80\xa6|an=y, where | denotes the bitwise OR operation. The score of a good array is the value of a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95an, where \xe2\x8a\x95 denotes the bitwise XOR operation.Koxia wants you to find the total bitwise XOR of the scores of all good arrays. If there are no good arrays, output 0 instead." 3100
1770E "Koxia and Tree" "combinatorics,dfs and similar,dp,dsu,math,probabilities,trees" "Imi has an undirected tree with n vertices where edges are numbered from 1 to n\xe2\x88\x921. The i-th edge connects vertices ui and vi. There are also k butterflies on the tree. Initially, the i-th butterfly is on vertex ai. All values of a are pairwise distinct.Koxia plays a game as follows:  For i=1,2,\xe2\x80\xa6,n\xe2\x88\x921, Koxia set the direction of the i-th edge as ui\xe2\x86\x92vi or vi\xe2\x86\x92ui with equal probability.  For i=1,2,\xe2\x80\xa6,n\xe2\x88\x921, if a butterfly is on the initial vertex of i-th edge and there is no butterfly on the terminal vertex, then this butterfly flies to the terminal vertex. Note that operations are sequentially in order of 1,2,\xe2\x80\xa6,n\xe2\x88\x921 instead of simultaneously.  Koxia chooses two butterflies from the k butterflies with equal probability from all possible k(k\xe2\x88\x921)2 ways to select two butterflies, then she takes the distance\xe2\x80\xa0 between the two chosen vertices as her score. Now, Koxia wants you to find the expected value of her score, modulo 998244353\xe2\x80\xa1.\xe2\x80\xa0 The distance between two vertices on a tree is the number of edges on the (unique) simple path between them.\xe2\x80\xa1 Formally, let M=998244353. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2400
1770D "Koxia and Game" "constructive algorithms,data structures,dfs and similar,dsu,flows,games,graph matchings,graphs,implementation" "Koxia and Mahiru are playing a game with three arrays a, b, and c of length n. Each element of a, b and c is an integer between 1 and n inclusive.The game consists of n rounds. In the i-th round, they perform the following moves:  Let S be the multiset {ai,bi,ci}.  Koxia removes one element from the multiset S by her choice.  Mahiru chooses one integer from the two remaining in the multiset S. Let di be the integer Mahiru chose in the i-th round. If d is a permutation\xe2\x80\xa0, Koxia wins. Otherwise, Mahiru wins.Currently, only the arrays a and b have been chosen. As an avid supporter of Koxia, you want to choose an array c such that Koxia will win. Count the number of such c, modulo 998244353.Note that Koxia and Mahiru both play optimally.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2000
1770C "Koxia and Number Theory" "brute force,chinese remainder theorem,math,number theory" "Joi has an array a of n positive integers. Koxia wants you to determine whether there exists a positive integer x>0 such that gcd(ai+x,aj+x)=1 for all 1\xe2\x89\xa4i<j\xe2\x89\xa4n.Here gcd(y,z) denotes the greatest common divisor (GCD) of integers y and z." 1700
1770B "Koxia and Permutation" "constructive algorithms" "Reve has two integers n and k.Let p be a permutation\xe2\x80\xa0 of length n. Let c be an array of length n\xe2\x88\x92k+1 such that ci=max(pi,\xe2\x80\xa6,pi+k\xe2\x88\x921)+min(pi,\xe2\x80\xa6,pi+k\xe2\x88\x921). Let the cost of the permutation p be the maximum element of c.Koxia wants you to construct a permutation with the minimum possible cost.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1000
1770A "Koxia and Whiteboards" "brute force,greedy" "Kiyora has n whiteboards numbered from 1 to n. Initially, the i-th whiteboard has the integer ai written on it.Koxia performs m operations. The j-th operation is to choose one of the whiteboards and change the integer written on it to bj.Find the maximum possible sum of integers written on the whiteboards after performing all m operations." 1000
1769D3 "\xd0\x98\xd0\xb3\xd1\x80\xd0\xb0 \xd0\xb2 \xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 III" "*special problem,brute force" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 26 \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2 \xd1\x81 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc\xd0\xb8 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f\xd0\xbc\xd0\xb8 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0.\xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x81\xd1\x8b\xd0\xb3\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x83\xd1\x8e \xd0\xb8\xd0\xb3\xd1\x80\xd1\x83 \xc2\xab\xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0\xc2\xbb. \xd0\x9f\xd0\xbe\xd0\xb6\xd0\xb0\xd0\xbb\xd1\x83\xd0\xb9\xd1\x81\xd1\x82\xd0\xb0, \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbe\xd1\x82\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xb0\xd0\xbc.\xd0\x94\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0\xd1\x80\xd1\x82\xd0\xbd\xd0\xb0\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb8\xd0\xb7 36 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xe2\x80\x94 \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 (\xd0\xbe\xd1\x82 \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xbe \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0) \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd1\x91\xd1\x85 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9 (\xd1\x82\xd1\x80\xd0\xb5\xd1\x84\xd1\x8b, \xd0\xb1\xd1\x83\xd0\xb1\xd0\xbd\xd1\x8b, \xd0\xbf\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb8 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8). \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd1\x83 \xd0\xbe\xd1\x82 \xd0\xbc\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xba \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc: \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82, \xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb0, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c, \xd1\x82\xd1\x83\xd0\xb7.\xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x88\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xb8 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb4\xd0\xb0\xd1\x91\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe 18 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82. \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x91\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0\xd0\xbc. \xd0\x92\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8.\xd0\x98\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x82 \xd0\xbf\xd0\xbe \xd0\xbe\xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8. \xd0\xa5\xd0\xbe\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbe\xd0\xb2:   \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd1\x83, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xb2\xd1\x8b\xd1\x88\xd0\xb5;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd1\x83, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82\xd0\xb0, \xd0\xb4\xd0\xb0\xd0\xbc\xd1\x83, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xbd\xd0\xb8\xd0\xb6\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbf\xd0\xb8\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb2 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84, \xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9.\xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8, \xd1\x82\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\xba \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd1\x83. \xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5: \xd0\xbd\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x8f \xd0\xbf\xd1\x80\xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe \xd1\x82\xd0\xb0\xd0\xba \xe2\x80\x94 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xba\xd0\xbe\xd1\x80\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe.\xd0\x9f\xd0\xbe\xd0\xbc\xd0\xb8\xd0\xbc\xd0\xbe \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba \xd1\x81\xd1\x82\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb8\xd0\xb7\xd0\xb1\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x86\xd0\xb5 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd1\x83 \xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5, \xd0\xb0 \xd0\xb2 \xd0\xb8\xd1\x85 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xe2\x80\x94 \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbd\xd0\xb8\xd0\xbc, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xba\xd0\xb0\xd0\xbd\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xba\xd0\xb0\xd0\xba \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbd\xd1\x8e\xd1\x8e \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8.\xd0\xa0\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd1\x81\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xba\xd1\x83\xd0\xbf\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd0\xb8\xd0\xbd\xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8 \xd0\xbe \xd1\x82\xd0\xbe\xd0\xbc, \xd0\xba\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x82\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb5, \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xbe \xd1\x82\xd0\xbe\xd0\xbc, \xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd1\x83 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb2\xd1\x88\xd0\xb5\xd0\xb3\xd0\xbe.\xd0\x9f\xd1\x83\xd1\x81\xd1\x82\xd1\x8c \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xb2\xd0\xb7\xd1\x8f\xd0\xbb\xd0\xb8 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb8 18 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9, \xd0\xbd\xd0\xbe \xd0\xb5\xd1\x89\xd1\x91 \xd0\xbd\xd0\xb5 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8, \xd0\xba\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc. \xd0\x92\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd0\xb0\xd0\xb1\xd1\x81\xd0\xbe\xd0\xbb\xd1\x8e\xd1\x82\xd0\xbd\xd1\x83\xd1\x8e \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd1\x80\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82\xd0\xb0\xd0\xbc\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xb2 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0, \xd0\xb8 \xd0\xb2 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\x91\xd0\xbe\xd0\xb1.\xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2 \xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd1\x8f\xd1\x85 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x91\xd0\xbe\xd0\xb1, \xd0\xbd\xd0\xbe \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd1\x83 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8b \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 6 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x86\xd0\xb5 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b, \xd0\xb0 \xd0\xb2\xd0\xbe \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xe2\x80\x94 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe 2, \xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0 4. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb6\xd0\xb5 \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd1\x83 \xd0\x91\xd0\xbe\xd0\xb1\xd0\xb0 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd0\xb0 \xd0\xb2\xd0\xbe \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x91\xd0\xbe\xd0\xb1 \xd0\xb8 \xd1\x83 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8b \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 3 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0 8.\xd0\xa0\xd0\xb5\xd0\xb1\xd1\x8f\xd1\x82\xd0\xb0 \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f\xd1\x82 \xd1\x83\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xbd\xd0\xb0\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb1\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2. \xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd1\x83 k\xe2\x89\xa426 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb8\xd0\xbc \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 k \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd1\x8b \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd0\xbd\xd0\xb8\xd1\x85 \xe2\x80\x94 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0." 2300
1769D2 "\xd0\x98\xd0\xb3\xd1\x80\xd0\xb0 \xd0\xb2 \xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 II" "*special problem,brute force" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0\xd1\x8e\xd1\x82 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xb1\xd0\xb5\xd0\xb4\xd1\x83, \xd0\xbd\xd0\xbe \xd0\xb8 \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xbf\xd1\x82\xd0\xb8\xd0\xbc\xd0\xb8\xd0\xb7\xd0\xb0\xd1\x86\xd0\xb8\xd1\x8e \xd1\x80\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82\xd0\xb0 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xbd\xd0\xb8\xd1\x85. \xd0\x92\xd0\xb2\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xbd\xd1\x8f\xd1\x82\xd0\xb8\xd0\xb5 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd1\x8b \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0, \xd0\xb8 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 13 \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2 \xd1\x81 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xbc\xd0\xb8 \xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f\xd0\xbc\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd1\x8b.\xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x81\xd1\x8b\xd0\xb3\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x83\xd1\x8e \xd0\xb8\xd0\xb3\xd1\x80\xd1\x83 \xc2\xab\xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0\xc2\xbb. \xd0\x9f\xd0\xbe\xd0\xb6\xd0\xb0\xd0\xbb\xd1\x83\xd0\xb9\xd1\x81\xd1\x82\xd0\xb0, \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbe\xd1\x82\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xb0\xd0\xbc.\xd0\x94\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0\xd1\x80\xd1\x82\xd0\xbd\xd0\xb0\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb8\xd0\xb7 36 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xe2\x80\x94 \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 (\xd0\xbe\xd1\x82 \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xbe \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0) \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd1\x91\xd1\x85 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9 (\xd1\x82\xd1\x80\xd0\xb5\xd1\x84\xd1\x8b, \xd0\xb1\xd1\x83\xd0\xb1\xd0\xbd\xd1\x8b, \xd0\xbf\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb8 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8). \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd1\x83 \xd0\xbe\xd1\x82 \xd0\xbc\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xba \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc: \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82, \xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb0, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c, \xd1\x82\xd1\x83\xd0\xb7.\xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x88\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xb8 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb4\xd0\xb0\xd1\x91\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe 18 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82. \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x91\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0\xd0\xbc. \xd0\x92\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8.\xd0\x98\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x82 \xd0\xbf\xd0\xbe \xd0\xbe\xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8. \xd0\xa5\xd0\xbe\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbe\xd0\xb2:   \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd1\x83, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xb2\xd1\x8b\xd1\x88\xd0\xb5;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd1\x83, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82\xd0\xb0, \xd0\xb4\xd0\xb0\xd0\xbc\xd1\x83, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xbd\xd0\xb8\xd0\xb6\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbf\xd0\xb8\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb2 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84, \xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9.\xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8, \xd1\x82\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\xba \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd1\x83. \xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5: \xd0\xbd\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x8f \xd0\xbf\xd1\x80\xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe \xd1\x82\xd0\xb0\xd0\xba \xe2\x80\x94 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xba\xd0\xbe\xd1\x80\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe.\xd0\x9f\xd0\xbe\xd0\xbc\xd0\xb8\xd0\xbc\xd0\xbe \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba \xd1\x81\xd1\x82\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb8\xd0\xb7\xd0\xb1\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f\xd1\x82, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x86\xd0\xb5 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd1\x83 \xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5, \xd0\xb0 \xd0\xb2 \xd0\xb8\xd1\x85 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xe2\x80\x94 \xd0\xba\xd0\xb0\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbc\xd0\xb5\xd0\xbd\xd1\x8c\xd1\x88\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbd\xd0\xb8\xd0\xbc, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0 \xd0\xb7\xd0\xb0\xd0\xba\xd0\xb0\xd0\xbd\xd1\x87\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xba\xd0\xb0\xd0\xba \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbd\xd1\x8e\xd1\x8e \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8.\xd0\xa0\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82\xd0\xbe\xd0\xbc \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd1\x81\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xba\xd1\x83\xd0\xbf\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd0\xb8\xd0\xbd\xd1\x84\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd1\x86\xd0\xb8\xd0\xb8 \xd0\xbe \xd1\x82\xd0\xbe\xd0\xbc, \xd0\xba\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x82\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb5, \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xbe \xd1\x82\xd0\xbe\xd0\xbc, \xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd1\x83 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb2\xd1\x88\xd0\xb5\xd0\xb3\xd0\xbe.\xd0\x9f\xd1\x83\xd1\x81\xd1\x82\xd1\x8c \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xb2\xd0\xb7\xd1\x8f\xd0\xbb\xd0\xb8 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb8 18 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9, \xd0\xbd\xd0\xbe \xd0\xb5\xd1\x89\xd1\x91 \xd0\xbd\xd0\xb5 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8, \xd0\xba\xd1\x82\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc. \xd0\x92\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xb2\xd1\x91\xd0\xbc \xd0\xb0\xd0\xb1\xd1\x81\xd0\xbe\xd0\xbb\xd1\x8e\xd1\x82\xd0\xbd\xd1\x83\xd1\x8e \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd1\x80\xd0\xb5\xd0\xb7\xd1\x83\xd0\xbb\xd1\x8c\xd1\x82\xd0\xb0\xd1\x82\xd0\xb0\xd0\xbc\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xb2 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb9 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0, \xd0\xb8 \xd0\xb2 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\x91\xd0\xbe\xd0\xb1.\xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb2 \xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd1\x8f\xd1\x85 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x91\xd0\xbe\xd0\xb1, \xd0\xbd\xd0\xbe \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd1\x83 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8b \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 6 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5 \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x86\xd0\xb5 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b, \xd0\xb0 \xd0\xb2\xd0\xbe \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xe2\x80\x94 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe 2, \xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0 4. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb6\xd0\xb5 \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd1\x83 \xd0\x91\xd0\xbe\xd0\xb1\xd0\xb0 \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd0\xb0 \xd0\xb2\xd0\xbe \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbb\xd1\x83\xd1\x87\xd0\xb0\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\x91\xd0\xbe\xd0\xb1 \xd0\xb8 \xd1\x83 \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8b \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f 3 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xb2 \xd1\x80\xd1\x83\xd0\xba\xd0\xb5, \xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xb0 8.\xd0\xa0\xd0\xb5\xd0\xb1\xd1\x8f\xd1\x82\xd0\xb0 \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f\xd1\x82 \xd1\x83\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x82\xd1\x8c, \xd0\xbd\xd0\xb0\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb1\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2. \xd0\x9f\xd0\xbe \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc\xd1\x83 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd1\x83 k\xe2\x89\xa413 \xd0\xbf\xd0\xbe\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb8\xd0\xbc \xd0\xbd\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 k \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xbe\xd0\xb2, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xbd\xd1\x8b \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd0\xbd\xd0\xb8\xd1\x85 \xe2\x80\x94 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0." 2200
1769D1 "\xd0\x98\xd0\xb3\xd1\x80\xd0\xb0 \xd0\xb2 \xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 I" "*special problem,brute force,dp" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd1\x8c, \xd0\xba\xd1\x82\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb5 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb8 \xd0\xbe\xd0\xbf\xd1\x82\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb5 \xd0\xbe\xd0\xb1\xd0\xbe\xd0\xb8\xd1\x85 \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2.\xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb8 \xd0\x91\xd0\xbe\xd0\xb1 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x81\xd1\x8b\xd0\xb3\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd1\x87\xd0\xbd\xd1\x83\xd1\x8e \xd0\xb8\xd0\xb3\xd1\x80\xd1\x83 \xc2\xab\xd0\x94\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0\xc2\xbb. \xd0\x9f\xd0\xbe\xd0\xb6\xd0\xb0\xd0\xbb\xd1\x83\xd0\xb9\xd1\x81\xd1\x82\xd0\xb0, \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbe\xd1\x82\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xb0\xd0\xbc.\xd0\x94\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0\xd1\x80\xd1\x82\xd0\xbd\xd0\xb0\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xb8\xd0\xb7 36 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xe2\x80\x94 \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 (\xd0\xbe\xd1\x82 \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xbe \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0) \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x87\xd0\xb5\xd1\x82\xd1\x8b\xd1\x80\xd1\x91\xd1\x85 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb5\xd0\xb9 (\xd1\x82\xd1\x80\xd0\xb5\xd1\x84\xd1\x8b, \xd0\xb1\xd1\x83\xd0\xb1\xd0\xbd\xd1\x8b, \xd0\xbf\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb8 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8). \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbf\xd0\xbe \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd1\x83 \xd0\xbe\xd1\x82 \xd0\xbc\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xba \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x88\xd0\xb5\xd0\xb9 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x82 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc: \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd0\xb0, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82, \xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb0, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8c, \xd1\x82\xd1\x83\xd0\xb7.\xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x88\xd0\xb8\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f, \xd0\xb8 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd1\x83 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb4\xd0\xb0\xd1\x91\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe 18 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82. \xd0\x9a\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbf\xd0\xbe \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd1\x91\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0\xd0\xbc. \xd0\x92\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x8b \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8.\xd0\x98\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x82 \xd0\xbf\xd0\xbe \xd0\xbe\xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb8. \xd0\xa5\xd0\xbe\xd0\xb4 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xb5\xd1\x82 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xbe\xd0\xb2:   \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8 \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x91\xd1\x80\xd0\xba\xd1\x83, \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd1\x83 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xb2\xd1\x8b\xd1\x88\xd0\xb5;  \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb4\xd0\xb5\xd1\x81\xd1\x8f\xd1\x82\xd0\xba\xd1\x83, \xd0\xb2\xd0\xb0\xd0\xbb\xd0\xb5\xd1\x82\xd0\xb0, \xd0\xb4\xd0\xb0\xd0\xbc\xd1\x83, \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xbb\xd0\xb5\xd0\xb6\xd0\xb8\xd1\x82 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xb0\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb4\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd0\xbd\xd1\x81\xd1\x82\xd0\xb2\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0 \xd0\xb5\xd0\xb4\xd0\xb8\xd0\xbd\xd0\xb8\xd1\x86\xd1\x83 \xd0\xbd\xd0\xb8\xd0\xb6\xd0\xb5. \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb4\xd0\xb5\xd0\xb2\xd1\x8f\xd1\x82\xd0\xba\xd1\x83 \xd0\xbf\xd0\xb8\xd0\xba \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xb2 \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82, \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x81\xd0\xb5\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xb2\xd0\xbe\xd1\x81\xd1\x8c\xd0\xbc\xd1\x91\xd1\x80\xd0\xba\xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x84, \xd0\xb0 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x8b\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x82\xd1\x83\xd0\xb7\xd0\xb0 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd1\x87\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd0\xb9.\xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xb8\xd0\xb7 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb5\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xb8, \xd1\x82\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\xba \xd1\x81\xd0\xbe\xd0\xbf\xd0\xb5\xd1\x80\xd0\xbd\xd0\xb8\xd0\xba\xd1\x83. \xd0\x9e\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5: \xd0\xbd\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x8f \xd0\xbf\xd1\x80\xd0\xbe\xd0\xbf\xd1\x83\xd1\x81\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe \xd1\x82\xd0\xb0\xd0\xba \xe2\x80\x94 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xbb\xd0\xbe\xd0\xb6\xd0\xb8\xd1\x82\xd1\x8c \xd0\xba\xd0\xb0\xd1\x80\xd1\x82\xd1\x83 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x82\xd0\xbe\xd0\xbb \xd0\xba\xd0\xbe\xd1\x80\xd1\x80\xd0\xb5\xd0\xba\xd1\x82\xd0\xbd\xd1\x8b\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe.\xd0\x92\xd0\xb0\xd0\xbc \xd0\xb4\xd0\xb0\xd0\xbd \xd1\x80\xd0\xb0\xd1\x81\xd0\xba\xd0\xbb\xd0\xb0\xd0\xb4 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb2 \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb5 \xd0\xb8\xd0\xb3\xd1\x80\xd1\x8b. \xd0\x90\xd0\xbb\xd0\xb8\xd1\x81\xd0\xb0 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd0\xbe\xd0\xb9. \xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5, \xd0\xba\xd1\x82\xd0\xbe \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xbc \xd0\xb8\xd0\xb7\xd0\xb1\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 \xd1\x81\xd0\xb2\xd0\xbe\xd0\xb8\xd1\x85 \xd0\xba\xd0\xb0\xd1\x80\xd1\x82 \xd0\xb8 \xd0\xb2\xd1\x8b\xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xb1\xd0\xb0 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0 \xd0\xb1\xd1\x83\xd0\xb4\xd1\x83\xd1\x82 \xd0\xbf\xd1\x8b\xd1\x82\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xb1\xd0\xb5\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbe\xd0\xbf\xd1\x82\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe." 1800
1769C2 "\xd0\x9f\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xba\xd0\xb0 II" "*special problem,dp" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 n\xe2\x89\xa42\xe2\x8b\x85105 \xd0\xb8 ai\xe2\x89\xa4106 (\xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd1\x83 n \xd0\xbf\xd0\xbe \xd0\xbd\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x80\xd0\xb0\xd0\xbc \xd0\xb2\xd1\x85\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2\xd0\xbd\xd1\x83\xd1\x82\xd1\x80\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x82\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0).\xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xb7\xd0\xb0 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 VK \xd1\x83\xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbb\xd0\xb0 n \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xb2 \xd1\x81\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5\xd0\xbc\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb9. i-\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82 \xd0\xb1\xd1\x8b\xd0\xbb \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbd \xd0\xb2 ai-\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\x92\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8. \xd0\x92 \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xbd\xd0\xb8 \xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbb\xd0\xb0 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2, \xd0\xb0 \xd0\xb2 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd0\xb5 \xe2\x80\x94 \xd0\xbd\xd0\xb5 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe.\xd0\x92\xd0\xb8\xd0\xba\xd1\x83 \xd0\xb8\xd0\xbd\xd1\x82\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x83\xd1\x8e\xd1\x82 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xba\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x80\xd1\x8f\xd0\xb4 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9 \xd1\x83 \xd0\xbd\xd0\xb5\xd1\x91 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82. \xd0\xa7\xd0\xb5\xd0\xbc \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd0\xb5\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb0\xd0\xbc\xd1\x8b\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x82\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xbe\xd0\xba, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb4\xd1\x83\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd1\x8b\xd0\xbc \xd1\x81\xd0\xbe\xd1\x82\xd1\x80\xd1\x83\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb5\xd0\xb1\xd1\x8f \xd0\xbe\xd1\x89\xd1\x83\xd1\x89\xd0\xb0\xd1\x82\xd1\x8c.\xd0\x9d\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe \xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xbd\xd0\xb0\xd1\x88\xd0\xbb\xd0\xb0 \xd1\x81\xd0\xbf\xd0\xbe\xd1\x81\xd0\xbe\xd0\xb1 \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd1\x91\xd0\xb4, \xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd1\x87\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x83\xd1\x82\xd0\xba\xd0\xb8. \xd0\xa2\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, i-\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82 \xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xc2\xab\xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbd\xc2\xbb \xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xb2 ai-\xd0\xb9, \xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xb2 (ai+1)-\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c. \xd0\x92\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd0\xb7\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbe\xd1\x82 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd1\x85 \xe2\x80\x94 \xd0\xb2 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8, \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd0\xb5\xd0\xbc \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0\xd0\xbc \xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f, \xd1\x82\xd0\xb0\xd0\xba \xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd1\x8b \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd1\x91\xd0\xb4.\xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x83 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xba\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x80\xd1\x8f\xd0\xb4 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9, \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd1\x83 \xd0\x92\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x84\xd0\xb8\xd0\xbb\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xbe\xd1\x82\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8 \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2." 1300
1769C1 "\xd0\x9f\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xba\xd0\xb0 I" "*special problem,brute force,dp,greedy" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 n\xe2\x89\xa450 \xd0\xb8 ai\xe2\x89\xa4100.\xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xb7\xd0\xb0 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 VK \xd1\x83\xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbb\xd0\xb0 n \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xb2 \xd1\x81\xd0\xb8\xd1\x81\xd1\x82\xd0\xb5\xd0\xbc\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbd\xd1\x82\xd1\x80\xd0\xbe\xd0\xbb\xd1\x8f \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb9. i-\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82 \xd0\xb1\xd1\x8b\xd0\xbb \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbd \xd0\xb2 ai-\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd1\x80\xd0\xb0\xd0\xb1\xd0\xbe\xd1\x82\xd1\x8b \xd0\x92\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbf\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8. \xd0\x92 \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb4\xd0\xbd\xd0\xb8 \xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbb\xd0\xb0 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2, \xd0\xb0 \xd0\xb2 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd0\xb5 \xe2\x80\x94 \xd0\xbd\xd0\xb5 \xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb8 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe.\xd0\x92\xd0\xb8\xd0\xba\xd1\x83 \xd0\xb8\xd0\xbd\xd1\x82\xd0\xb5\xd1\x80\xd0\xb5\xd1\x81\xd1\x83\xd1\x8e\xd1\x82 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xba\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x80\xd1\x8f\xd0\xb4 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9, \xd1\x87\xd1\x82\xd0\xbe \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x8d\xd1\x82\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9 \xd1\x83 \xd0\xbd\xd0\xb5\xd1\x91 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82. \xd0\xa7\xd0\xb5\xd0\xbc \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd0\xb5\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb0\xd0\xbc\xd1\x8b\xd0\xb9 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9 \xd1\x82\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xbe\xd0\xba, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb4\xd1\x83\xd0\xba\xd1\x82\xd0\xb8\xd0\xb2\xd0\xbd\xd1\x8b\xd0\xbc \xd1\x81\xd0\xbe\xd1\x82\xd1\x80\xd1\x83\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xbc \xd0\xbe\xd0\xbd\xd0\xb0 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd1\x81\xd0\xb5\xd0\xb1\xd1\x8f \xd0\xbe\xd1\x89\xd1\x83\xd1\x89\xd0\xb0\xd1\x82\xd1\x8c.\xd0\x9d\xd0\xb5\xd0\xb4\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe \xd0\x92\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xbd\xd0\xb0\xd1\x88\xd0\xbb\xd0\xb0 \xd1\x81\xd0\xbf\xd0\xbe\xd1\x81\xd0\xbe\xd0\xb1 \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xbb\xd1\x8e\xd0\xb1\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd1\x91\xd0\xb4, \xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd1\x87\xd0\xb5\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x81\xd1\x83\xd1\x82\xd0\xba\xd0\xb8. \xd0\xa2\xd0\xb0\xd0\xba\xd0\xb8\xd0\xbc \xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb7\xd0\xbe\xd0\xbc, i-\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82 \xd1\x82\xd0\xb5\xd0\xbf\xd0\xb5\xd1\x80\xd1\x8c \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xc2\xab\xd1\x81\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb0\xd0\xbd\xc2\xbb \xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xb2 ai-\xd0\xb9, \xd0\xbb\xd0\xb8\xd0\xb1\xd0\xbe \xd0\xb2 (ai+1)-\xd0\xb9 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c. \xd0\x92\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5\xd0\xb7\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbe\xd1\x82 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd1\x85 \xe2\x80\x94 \xd0\xb2 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8, \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba \xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb2\xd1\x81\xd0\xb5\xd0\xbc \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xb0\xd0\xbc \xd0\xb8\xd1\x81\xd1\x85\xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f, \xd1\x82\xd0\xb0\xd0\xba \xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbd\xd0\xb5\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb2\xd1\x81\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd1\x8b \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xb4\xd0\xb5\xd0\xbd\xd1\x8c \xd0\xb2\xd0\xbf\xd0\xb5\xd1\x80\xd1\x91\xd0\xb4.\xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd1\x83 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb4\xd0\xbb\xd0\xb8\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd0\xb7\xd0\xba\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x80\xd1\x8f\xd0\xb4 \xd0\xb8\xd0\xb4\xd1\x83\xd1\x89\xd0\xb8\xd1\x85 \xd0\xb4\xd0\xbd\xd0\xb5\xd0\xb9, \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd0\xb8\xd0\xb7 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd1\x83 \xd0\x92\xd0\xb8\xd0\xba\xd0\xb8 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x84\xd0\xb8\xd0\xbb\xd0\xb5 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xbe\xd1\x82\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xb4\xd0\xba\xd1\x80\xd1\x83\xd1\x82\xd0\xba\xd0\xb8 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8 \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd1\x85 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xbc\xd0\xb8\xd1\x82\xd0\xbe\xd0\xb2." 1200
1769B2 "\xd0\x9a\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xbe\xd0\xb2 II" "*special problem,binary search,brute force,math" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbc\xd0\xb5\xd1\x80\xd1\x8b \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc\xd1\x8b\xd1\x85 \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xbe\xd0\xb2 \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb2\xd1\x8b\xd1\x88\xd0\xb0\xd1\x8e\xd1\x82 1010 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82.\xd0\x92\xd1\x8b \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd0\xb5 \xd1\x81 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 n \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xbe\xd0\xb2 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xbc a1,a2,\xe2\x80\xa6,an \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82. \xd0\xa4\xd0\xb0\xd0\xb9\xd0\xbb\xd1\x8b \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd1\x83\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb2 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5.\xd0\x9f\xd1\x80\xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb2\xd1\x8b \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb5\xd1\x81\xd1\x81-\xd0\xb1\xd0\xb0\xd1\x80\xd0\xb0: \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82 \xd1\x81\xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2 \xd1\x82\xd0\xb5\xd0\xba\xd1\x83\xd1\x89\xd0\xb5\xd0\xbc \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xb5, \xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xe2\x80\x94 \xd0\xbe\xd0\xb1\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82 \xd1\x81\xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xbe \xd0\xb2\xd1\x81\xd0\xb5\xd0\xbc n \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xb0\xd0\xbc. \xd0\x9e\xd0\xb1\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0 \xd0\xbe\xd1\x82\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xbe\xd0\xba\xd1\x80\xd1\x83\xd0\xb3\xd0\xbb\xd1\x91\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xbc\xd0\xb8 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xbe \xd1\x86\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0. \xd0\x97\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb5\xd1\x81\xd1\x81-\xd0\xb1\xd0\xb0\xd1\x80\xd0\xb0\xd1\x85 \xd0\xbe\xd0\xb1\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbb\xd1\x8f\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb0.\xd0\xa4\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 x \xd0\xb8\xd0\xb7 \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 i \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb5\xd1\x81\xd1\x81-\xd0\xb1\xd0\xb0\xd1\x80 \xd0\xbf\xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xe2\x8c\x8a100\xe2\x8b\x85xai\xe2\x8c\x8b \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82\xd0\xbe\xd0\xb2, \xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xe2\x80\x94 \xe2\x8c\x8a100\xe2\x8b\x85(a1+a2+\xe2\x80\xa6+ai\xe2\x88\x921+x)a1+a2+\xe2\x80\xa6+an\xe2\x8c\x8b \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82\xd0\xbe\xd0\xb2. \xd0\x92 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbe\xd0\xb1\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb5\xd1\x81\xd1\x81-\xd0\xb1\xd0\xb0\xd1\x80\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8e\xd1\x82 0 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82\xd0\xbe\xd0\xb2.\xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd1\x81\xd0\xb5 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 \xd0\xbe\xd1\x82 0 \xd0\xb4\xd0\xbe 100 \xd0\xb2\xd0\xba\xd0\xbb\xd1\x8e\xd1\x87\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd1\x83\xd1\x89\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd1\x83\xd0\xb5\xd1\x82 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8, \xd0\xb2 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xbe\xd0\xb1\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb5\xd1\x81\xd1\x81-\xd0\xb1\xd0\xb0\xd1\x80\xd0\xb0 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8e\xd1\x82 \xd1\x8d\xd1\x82\xd0\xbe \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe. \xd0\x92\xd1\x8b\xd0\xb2\xd0\xb5\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xb8 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 \xd0\xb2 \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5 \xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f." 1400
1769B1 "\xd0\x9a\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xbe\xd0\xb2 I" "*special problem,brute force,implementation,math" "\xd0\x92 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb2\xd0\xb5\xd1\x80\xd1\x81\xd0\xb8\xd0\xb8 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb8 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbc\xd0\xb5\xd1\x80\xd1\x8b \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd0\xbc\xd1\x8b\xd1\x85 \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xbe\xd0\xb2 \xd0\xbd\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xb5\xd0\xb2\xd1\x8b\xd1\x88\xd0\xb0\xd1\x8e\xd1\x82 1000 \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82.\xd0\x92\xd1\x8b \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd1\x83\xd0\xb5\xd1\x82\xd0\xb5 \xd1\x81 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xbe\xd0\xb9 n \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xbe\xd0\xb2 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xbc a1,a2,\xe2\x80\xa6,an \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82. \xd0\xa4\xd0\xb0\xd0\xb9\xd0\xbb\xd1\x8b \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd1\x83\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb2 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5.\xd0\x9f\xd1\x80\xd0\xb8 \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb2\xd1\x8b \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb4\xd0\xb2\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb5\xd1\x81\xd1\x81-\xd0\xb1\xd0\xb0\xd1\x80\xd0\xb0: \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82 \xd1\x81\xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb2 \xd1\x82\xd0\xb5\xd0\xba\xd1\x83\xd1\x89\xd0\xb5\xd0\xbc \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xb5, \xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xe2\x80\x94 \xd0\xbe\xd0\xb1\xd1\x89\xd0\xb8\xd0\xb9 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82 \xd1\x81\xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb4\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xbe \xd0\xb2\xd1\x81\xd0\xb5\xd0\xbc n \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xb0\xd0\xbc. \xd0\x9e\xd0\xb1\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82\xd0\xb0 \xd0\xbe\xd1\x82\xd0\xbe\xd0\xb1\xd1\x80\xd0\xb0\xd0\xb6\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xbe\xd0\xba\xd1\x80\xd1\x83\xd0\xb3\xd0\xbb\xd1\x91\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xbc\xd0\xb8 \xd0\xb2\xd0\xbd\xd0\xb8\xd0\xb7 \xd0\xb4\xd0\xbe \xd1\x86\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0. \xd0\x97\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb5\xd1\x81\xd1\x81-\xd0\xb1\xd0\xb0\xd1\x80\xd0\xb0\xd1\x85 \xd0\xbe\xd0\xb1\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbb\xd1\x8f\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb0.\xd0\xa4\xd0\xbe\xd1\x80\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb1\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 x \xd0\xb8\xd0\xb7 \xd1\x84\xd0\xb0\xd0\xb9\xd0\xbb\xd0\xb0 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80 i \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb5\xd1\x81\xd1\x81-\xd0\xb1\xd0\xb0\xd1\x80 \xd0\xbf\xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xe2\x8c\x8a100\xe2\x8b\x85xai\xe2\x8c\x8b \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82\xd0\xbe\xd0\xb2, \xd0\xb0 \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xe2\x80\x94 \xe2\x8c\x8a100\xe2\x8b\x85(a1+a2+\xe2\x80\xa6+ai\xe2\x88\x921+x)a1+a2+\xe2\x80\xa6+an\xe2\x8c\x8b \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82\xd0\xbe\xd0\xb2. \xd0\x92 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb5 \xd0\xba\xd0\xbe\xd0\xbf\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xbe\xd0\xb1\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb5\xd1\x81\xd1\x81-\xd0\xb1\xd0\xb0\xd1\x80\xd0\xb0 \xd0\xbf\xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8e\xd1\x82 0 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x86\xd0\xb5\xd0\xbd\xd1\x82\xd0\xbe\xd0\xb2.\xd0\x9d\xd0\xb0\xd0\xb9\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd0\xb2\xd1\x81\xd0\xb5 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb8\xd0\xb5 \xd1\x86\xd0\xb5\xd0\xbb\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 \xd0\xbe\xd1\x82 0 \xd0\xb4\xd0\xbe 100 \xd0\xb2\xd0\xba\xd0\xbb\xd1\x8e\xd1\x87\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd1\x81\xd1\x83\xd1\x89\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd1\x83\xd0\xb5\xd1\x82 \xd0\xbc\xd0\xbe\xd0\xbc\xd0\xb5\xd0\xbd\xd1\x82 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8, \xd0\xb2 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb9 \xd0\xbe\xd0\xb1\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb5\xd1\x81\xd1\x81-\xd0\xb1\xd0\xb0\xd1\x80\xd0\xb0 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe \xd0\xbf\xd0\xbe\xd0\xba\xd0\xb0\xd0\xb7\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x8e\xd1\x82 \xd1\x8d\xd1\x82\xd0\xbe \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe. \xd0\x92\xd1\x8b\xd0\xb2\xd0\xb5\xd0\xb4\xd0\xb8\xd1\x82\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xb8 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xb0 \xd0\xb2 \xd0\xbf\xd0\xbe\xd1\x80\xd1\x8f\xd0\xb4\xd0\xba\xd0\xb5 \xd0\xb2\xd0\xbe\xd0\xb7\xd1\x80\xd0\xb0\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f." 1000
1769A "\xd0\xa3\xd0\xb7\xd0\xba\xd0\xb0\xd1\x8f \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb0" "*special problem,math" "\xd0\x9a\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xbd\xd0\xbd\xd0\xb0 \xd0\xb8\xd0\xb7 n \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xbe\xd0\xb2 \xd0\xb5\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xbe \xd1\x83\xd0\xb7\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd0\xbd\xd0\xb5\xd0\xb9 \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb5 \xd0\xb2 \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82 \xd0\x91. \xd0\xa1\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd1\x8b \xd0\xbf\xd1\x80\xd0\xbe\xd0\xbd\xd1\x83\xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd1\x8b \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n. \xd0\x94\xd0\xbb\xd1\x8f \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xb0 i \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd1\x82\xd0\xb5\xd0\xba\xd1\x83\xd1\x89\xd0\xb5\xd0\xb5 \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb5 \xd0\xbe\xd1\x82 \xd0\xbd\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb4\xd0\xbe \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82\xd0\xb0 \xd0\x91 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xbd\xd0\xbe ai \xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xbe\xd0\xb2. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc a1<a2<\xe2\x80\xa6<an, \xd0\xb2 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8, \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 1 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb1\xd0\xbb\xd0\xb8\xd0\xb6\xd0\xb5 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xba \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82\xd1\x83 \xd0\x91, \xd0\xb0 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 n \xe2\x80\x94 \xd0\xb4\xd0\xb0\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xb2\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe.\xd0\xa1\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd1\x81 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xbc i \xd0\xb4\xd0\xb2\xd0\xb8\xd0\xb6\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x81\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbd\xd1\x83 \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82\xd0\xb0 \xd0\x91 \xd1\x81\xd0\xbe \xd1\x81\xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e i \xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb2 \xd1\x81\xd0\xb5\xd0\xba\xd1\x83\xd0\xbd\xd0\xb4\xd1\x83 (\xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x87\xd0\xb5\xd0\xbc \xd0\xb1\xd0\xbb\xd0\xb8\xd0\xb6\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xbd\xd0\xbd\xd0\xb5 \xd0\xba \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82\xd1\x83 \xd0\x91, \xd1\x82\xd0\xb5\xd0\xbc \xd0\xbc\xd0\xb5\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xb5\xd0\xb5 \xd0\xbe\xd0\xbd \xd0\xb5\xd0\xb4\xd0\xb5\xd1\x82). \xd0\xa2\xd0\xb0\xd0\xba \xd0\xba\xd0\xb0\xd0\xba \xd0\xb4\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xb0 \xd1\x83\xd0\xb7\xd0\xba\xd0\xb0\xd1\x8f, \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd1\x8b \xd0\xbd\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xbe\xd0\xb1\xd0\xb3\xd0\xbe\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8c \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb0. \xd0\x91\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd1\x8b \xd0\xb2 \xd0\xba\xd0\xbe\xd0\xbb\xd0\xbe\xd0\xbd\xd0\xbd\xd0\xb5 \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xbd\xd1\x8b \xd1\x81\xd0\xbe\xd0\xb1\xd0\xbb\xd1\x8e\xd0\xb4\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb8\xd1\x81\xd1\x82\xd0\xb0\xd0\xbd\xd1\x86\xd0\xb8\xd1\x8e \xd1\x85\xd0\xbe\xd1\x82\xd1\x8f \xd0\xb1\xd1\x8b \xd0\xb2 1 \xd0\xbc\xd0\xb5\xd1\x82\xd1\x80. \xd0\x9f\xd0\xbe\xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xba\xd0\xbe\xd0\xb3\xd0\xb4\xd0\xb0 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xb1\xd1\x8b\xd1\x81\xd1\x82\xd1\x80\xd1\x8b\xd0\xb9 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe\xd0\xbd\xd1\x8f\xd0\xb5\xd1\x82 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xbc\xd0\xb5\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd1\x8b\xd0\xb9, \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xb1\xd1\x8b\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xbc\xd1\x83 \xd0\xbf\xd1\x80\xd0\xb8\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb4\xd0\xb0\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd1\x81\xd0\xbe \xd1\x81\xd0\xba\xd0\xbe\xd1\x80\xd0\xbe\xd1\x81\xd1\x82\xd1\x8c\xd1\x8e \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xbc\xd0\xb5\xd0\xb4\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xbf\xd1\x80\xd0\xb8\xd1\x87\xd1\x91\xd0\xbc \xd0\xbd\xd0\xb0 \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb2 1 \xd0\xbc\xd0\xb5\xd1\x82\xd1\x80 \xd0\xbe\xd1\x82 \xd0\xbd\xd0\xb5\xd0\xb3\xd0\xbe.\xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xbc \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd1\x82\xd0\xbe\xd1\x8f\xd0\xbd\xd0\xb8\xd0\xb8 \xd0\xb4\xd0\xbe \xd0\xbf\xd1\x83\xd0\xbd\xd0\xba\xd1\x82\xd0\xb0 \xd0\x91 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b\xd0\xb9 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd1\x83 \xd1\x81\xd0\xb5\xd0\xba\xd1\x83\xd0\xbd\xd0\xb4\xd1\x83." 800
1768F "Wonderful Jump" dp,greedy "You are given an array of positive integers a1,a2,\xe2\x80\xa6,an of length n. In one operation you can jump from index i to index j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n) by paying min(ai,ai+1,\xe2\x80\xa6,aj)\xe2\x8b\x85(j\xe2\x88\x92i)2 eris.For all k from 1 to n, find the minimum number of eris needed to get from index 1 to index k." 2900
1768E "Partial Sorting" "combinatorics,math,number theory" "Consider a permutation\xe2\x80\xa0 p of length 3n. Each time you can do one of the following operations:  Sort the first 2n elements in increasing order.  Sort the last 2n elements in increasing order. We can show that every permutation can be made sorted in increasing order using only these operations. Let\'s call f(p) the minimum number of these operations needed to make the permutation p sorted in increasing order.Given n, find the sum of f(p) over all (3n)! permutations p of size 3n.Since the answer could be very large, output it modulo a prime M.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 2300
1768D "Lucky Permutation" "constructive algorithms,dfs and similar,graphs,greedy" "You are given a permutation\xe2\x80\xa0 p of length n.In one operation, you can choose two indices 1\xe2\x89\xa4i<j\xe2\x89\xa4n and swap pi with pj.Find the minimum number of operations needed to have exactly one inversion\xe2\x80\xa1 in the permutation.\xe2\x80\xa0 A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).\xe2\x80\xa1 The number of inversions of a permutation p is the number of pairs of indices (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n and pi>pj." 1800
1768C "Elemental Decompress" "constructive algorithms,greedy,implementation,sortings" "You are given an array a of n integers.Find two permutations\xe2\x80\xa0 p and q of length n such that max(pi,qi)=ai for all 1\xe2\x89\xa4i\xe2\x89\xa4n or report that such p and q do not exist.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 1300
1768B "Quick Sort" greedy,math "You are given a permutation\xe2\x80\xa0 p of length n and a positive integer k\xe2\x89\xa4n.In one operation, you:   Choose k distinct elements pi1,pi2,\xe2\x80\xa6,pik.  Remove them and then add them sorted in increasing order to the end of the permutation. For example, if p=[2,5,1,3,4] and k=2 and you choose 5 and 3 as the elements for the operation, then [2,5,1,3,4]\xe2\x86\x92[2,1,4,3,5].Find the minimum number of operations needed to sort the permutation in increasing order. It can be proven that it is always possible to do so.\xe2\x80\xa0 A permutation of length n is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 900
1768A "Greatest Convex" "greedy,math,number theory" "You are given an integer k. Find the largest integer x, where 1\xe2\x89\xa4x<k, such that x!+(x\xe2\x88\x921)!\xe2\x80\xa0 is a multiple of \xe2\x80\xa1 k, or determine that no such x exists.\xe2\x80\xa0 y! denotes the factorial of y, which is defined recursively as y!=y\xe2\x8b\x85(y\xe2\x88\x921)! for y\xe2\x89\xa51 with the base case of 0!=1. For example, 5!=5\xe2\x8b\x854\xe2\x8b\x853\xe2\x8b\x852\xe2\x8b\x851\xe2\x8b\x850!=120.\xe2\x80\xa1 If a and b are integers, then a is a multiple of b if there exists an integer c such that a=b\xe2\x8b\x85c. For example, 10 is a multiple of 5 but 9 is not a multiple of 6." 800
1767F "Two Subtrees" "data structures,trees" "You are given a rooted tree consisting of n vertices. The vertex 1 is the root. Each vertex has an integer written on it; this integer is vali for the vertex i.You are given q queries to the tree. The i-th query is represented by two vertices, ui and vi. To answer the query, consider all vertices w that lie in the subtree of ui or vi (if a vertex is in both subtrees, it is counted twice). For all vertices in these two subtrees, list all integers written on them, and find the integer with the maximum number of occurrences. If there are multiple integers with maximum number of occurrences, the minimum among them is the answer." 3100
1767E "Algebra Flash" "bitmasks,brute force,dp,graphs,math,meet-in-the-middle,trees" "Algebra Flash 2.2 has just been released!Changelog:  New gamemode! Thank you for the continued support of the game! Huh, is that it? Slightly disappointed, you boot up the game and click on the new gamemode. It says ""Colored platforms"".There are n platforms, numbered from 1 to n, placed one after another. There are m colors available in the game, numbered from 1 to m. The i-th platform is colored ci.You start on the platform 1 and want to reach platform n. In one move, you can jump from some platform i to platforms i+1 or i+2.All platforms are initially deactivated (including platforms 1 and n). For each color j, you can pay xj coins to activate all platforms of that color.You want to activate some platforms so that you could start on an activated platform 1, jump through some activated platforms and reach an activated platform n.What\'s the smallest amount of coins you can spend to achieve that?" 2500
1767D Playoff "combinatorics,constructive algorithms,dp,greedy,math" "2n teams participate in a playoff tournament. The tournament consists of 2n\xe2\x88\x921 games. They are held as follows: in the first phase of the tournament, the teams are split into pairs: team 1 plays against team 2, team 3 plays against team 4, and so on (so, 2n\xe2\x88\x921 games are played in that phase). When a team loses a game, it is eliminated, and each game results in elimination of one team (there are no ties). After that, only 2n\xe2\x88\x921 teams remain. If only one team remains, it is declared the champion; otherwise, the second phase begins, where 2n\xe2\x88\x922 games are played: in the first one of them, the winner of the game ""1 vs 2"" plays against the winner of the game ""3 vs 4"", then the winner of the game ""5 vs 6"" plays against the winner of the game ""7 vs 8"", and so on. This process repeats until only one team remains. The skill level of the i-th team is pi, where p is a permutation of integers 1, 2, ..., 2n (a permutation is an array where each element from 1 to 2n occurs exactly once).You are given a string s which consists of n characters. These characters denote the results of games in each phase of the tournament as follows:   if si is equal to 0, then during the i-th phase (the phase with 2n\xe2\x88\x92i games), in each match, the team with the lower skill level wins;  if si is equal to 1, then during the i-th phase (the phase with 2n\xe2\x88\x92i games), in each match, the team with the higher skill level wins. Let\'s say that an integer x is winning if it is possible to find a permutation p such that the team with skill x wins the tournament. Find all winning integers." 1500
1767C "Count Binary Strings" "data structures,dp" "You are given an integer n. You have to calculate the number of binary (consisting of characters 0 and/or 1) strings s meeting the following constraints.For every pair of integers (i,j) such that 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n, an integer ai,j is given. It imposes the following constraint on the string sisi+1si+2\xe2\x80\xa6sj:  if ai,j=1, all characters in sisi+1si+2\xe2\x80\xa6sj should be the same;  if ai,j=2, there should be at least two different characters in sisi+1si+2\xe2\x80\xa6sj;  if ai,j=0, there are no additional constraints on the string sisi+1si+2\xe2\x80\xa6sj. Count the number of binary strings s of length n meeting the aforementioned constraints. Since the answer can be large, print it modulo 998244353." 2100
1767B "Block Towers" "data structures,greedy,sortings" "There are n block towers, numbered from 1 to n. The i-th tower consists of ai blocks.In one move, you can move one block from tower i to tower j, but only if ai>aj. That move increases aj by 1 and decreases ai by 1. You can perform as many moves as you would like (possibly, zero).What\'s the largest amount of blocks you can have on the tower 1 after the moves?" 800
1767A "Cut the Triangle" implementation "You are given a non-degenerate triangle (a non-degenerate triangle is a triangle with positive area). The vertices of the triangle have coordinates (x1,y1), (x2,y2) and (x3,y3).You want to draw a straight line to cut the triangle into two non-degenerate triangles. Furthermore, the line you draw should be either horizontal or vertical.Can you draw the line to meet all the constraints?Here are some suitable ways to draw the line:  However, these ways to draw the line are not suitable (the first line cuts the triangle into a triangle and a quadrangle; the second line doesn\'t cut the triangle at all; the third line is neither horizontal nor vertical):" 800
1766F MCF flows "You are given a graph consisting of n vertices and m directed arcs. The i-th arc goes from the vertex xi to the vertex yi, has capacity ci and weight wi. No arc goes into the vertex 1, and no arc goes from the vertex n. There are no cycles of negative weight in the graph (it is impossible to travel from any vertex to itself in such a way that the total weight of all arcs you go through is negative).You have to assign each arc a flow (an integer between 0 and its capacity, inclusive). For every vertex except 1 and n, the total flow on the arcs going to this vertex must be equal to the total flow on the arcs going from that vertex. Let the flow on the i-th arc be fi, then the cost of the flow is equal to m\xe2\x88\x91i=1fiwi. You have to find a flow which minimizes the cost.Sounds classical, right? Well, we have some additional constraints on the flow on every edge:  if ci is even, fi must be even;  if ci is odd, fi must be odd. Can you solve this problem?" 2800
1766E Decomposition "binary search,brute force,data structures,divide and conquer,dp,two pointers" "For a sequence of integers [x1,x2,\xe2\x80\xa6,xk], let\'s define its decomposition as follows:Process the sequence from the first element to the last one, maintaining the list of its subsequences. When you process the element xi, append it to the end of the first subsequence in the list such that the bitwise AND of its last element and xi is greater than 0. If there is no such subsequence in the list, create a new subsequence with only one element xi and append it to the end of the list of subsequences.For example, let\'s analyze the decomposition of the sequence [1,3,2,0,1,3,2,1]:  processing element 1, the list of subsequences is empty. There is no subsequence to append 1 to, so we create a new subsequence [1];  processing element 3, the list of subsequences is [[1]]. Since the bitwise AND of 3 and 1 is 1, the element is appended to the first subsequence;  processing element 2, the list of subsequences is [[1,3]]. Since the bitwise AND of 2 and 3 is 2, the element is appended to the first subsequence;  processing element 0, the list of subsequences is [[1,3,2]]. There is no subsequence to append 0 to, so we create a new subsequence [0];  processing element 1, the list of subsequences is [[1,3,2],[0]]. There is no subsequence to append 1 to, so we create a new subsequence [1];  processing element 3, the list of subsequences is [[1,3,2],[0],[1]]. Since the bitwise AND of 3 and 2 is 2, the element is appended to the first subsequence;  processing element 2, the list of subsequences is [[1,3,2,3],[0],[1]]. Since the bitwise AND of 2 and 3 is 2, the element is appended to the first subsequence;  processing element 1, the list of subsequences is [[1,3,2,3,2],[0],[1]]. The element 1 cannot be appended to any of the first two subsequences, but can be appended to the third one. The resulting list of subsequences is [[1,3,2,3,2],[0],[1,1]].Let f([x1,x2,\xe2\x80\xa6,xk]) be the number of subsequences the sequence [x1,x2,\xe2\x80\xa6,xk] is decomposed into.Now, for the problem itself.You are given a sequence [a1,a2,\xe2\x80\xa6,an], where each element is an integer from 0 to 3. Let a[i..j] be the sequence [ai,ai+1,\xe2\x80\xa6,aj]. You have to calculate n\xe2\x88\x91i=1n\xe2\x88\x91j=if(a[i..j])." 2300
1766D "Lucky Chains" "math,number theory" "Let\'s name a pair of positive integers (x,y) lucky if the greatest common divisor of them is equal to 1 (gcd(x,y)=1).Let\'s define a chain induced by (x,y) as a sequence of pairs (x,y), (x+1,y+1), (x+2,y+2), \xe2\x80\xa6, (x+k,y+k) for some integer k\xe2\x89\xa50. The length of the chain is the number of pairs it consists of, or (k+1).Let\'s name such chain lucky if all pairs in the chain are lucky.You are given n pairs (xi,yi). Calculate for each pair the length of the longest lucky chain induced by this pair. Note that if (xi,yi) is not lucky itself, the chain will have the length 0." 1600
1766C "Hamiltonian Wall" dp,implementation "Sir Monocarp Hamilton is planning to paint his wall. The wall can be represented as a grid, consisting of 2 rows and m columns. Initially, the wall is completely white.Monocarp wants to paint a black picture on the wall. In particular, he wants cell (i,j) (the j-th cell in the i-th row) to be colored black, if ci,j= \'B\', and to be left white, if ci,j= \'W\'. Additionally, he wants each column to have at least one black cell, so, for each j, the following constraint is satisfied: c1,j, c2,j or both of them will be equal to \'B\'.In order for the picture to turn out smooth, Monocarp wants to place down a paint brush in some cell (x1,y1) and move it along the path (x1,y1),(x2,y2),\xe2\x80\xa6,(xk,yk) so that:   for each i, (xi,yi) and (xi+1,yi+1) share a common side;  all black cells appear in the path exactly once;  white cells don\'t appear in the path. Determine if Monocarp can paint the wall." 1300
1766B Notepad# implementation "You want to type the string s, consisting of n lowercase Latin letters, using your favorite text editor Notepad#.Notepad# supports two kinds of operations:   append any letter to the end of the string;  copy a continuous substring of an already typed string and paste this substring to the end of the string. Can you type string s in strictly less than n operations?" 1000
1766A "Extremely Round" "brute force,implementation" "Let\'s call a positive integer extremely round if it has only one non-zero digit. For example, 5000, 4, 1, 10, 200 are extremely round integers; 42, 13, 666, 77, 101 are not.You are given an integer n. You have to calculate the number of extremely round integers x such that 1\xe2\x89\xa4x\xe2\x89\xa4n." 800
1765N "Number Reduction" greedy "You are given a positive integer x.You can apply the following operation to the number: remove one occurrence of any digit in such a way that the resulting number does not contain any leading zeroes and is still a positive integer. For example, 10142 can be converted to 1142, 1042, 1012 or 1014 (note that 0142 is not a valid outcome); 10 can be converted to 1 (but not to 0 since it is not positive).Your task is to find the minimum positive integer that you can obtain from x if you can apply the aforementioned operation exactly k times." 1500
1765M "Minimum LCM" "math,number theory" "You are given an integer n.Your task is to find two positive (greater than 0) integers a and b such that a+b=n and the least common multiple (LCM) of a and b is the minimum among all possible values of a and b. If there are multiple answers, you can print any of them." 1000
1765L "Project Manager" "brute force,data structures,implementation" "There are n employees at Bersoft company, numbered from 1 to n. Each employee works on some days of the week and rests on the other days. You are given the lists of working days of the week for each employee.There are regular days and holidays. On regular days, only those employees work that have the current day of the week on their list. On holidays, no one works. You are provided with a list of days that are holidays. The days are numbered from 1 onwards, day 1 is Monday.The company receives k project offers they have to complete. The projects are numbered from 1 to k in the order of decreasing priority. Each project consists of multiple parts, where the i-th part must be completed by the ai-th employee. The parts must be completed in order (i.\xe2\x80\x89e. the (i+1)-st part can only be started when the i-th part is completed). Each part takes the corresponding employee a day to complete.The projects can be worked on simultaneously. However, one employee can complete a part of only one project during a single day. If they have a choice of what project to complete a part on, they always go for the project with the highest priority (the lowest index).For each project, output the day that project will be completed on." 2400
1765K "Torus Path" greedy,math "You are given a square grid with n rows and n columns, where each cell has a non-negative integer written in it. There is a chip initially placed at the top left cell (the cell with coordinates (1,1)). You need to move the chip to the bottom right cell (the cell with coordinates (n,n)).In one step, you can move the chip to the neighboring cell, but:   you can move only right or down. In other words, if the current cell is (x,y), you can move either to (x,y+1) or to (x+1,y). There are two special cases:   if the chip is in the last column (cell (x,n)) and you\'re moving right, you\'ll teleport to the first column (to the cell (x,1));  if the chip is in the last row (cell (n,y)) and you\'re moving down, you\'ll teleport to the first row (to the cell (1,y)).   you cannot visit the same cell twice. The starting cell is counted visited from the beginning (so you cannot enter it again), and you can\'t leave the finishing cell once you visit it. Your total score is counted as the sum of numbers in all cells you have visited. What is the maximum possible score you can achieve?" 1500
1765J "Hero to Zero" "graph matchings,math" "There are no heroes in this problem. I guess we should have named it ""To Zero"".You are given two arrays a and b, each of these arrays contains n non-negative integers.Let c be a matrix of size n\xc3\x97n such that ci,j=|ai\xe2\x88\x92bj| for every i\xe2\x88\x88[1,n] and every j\xe2\x88\x88[1,n].Your goal is to transform the matrix c so that it becomes the zero matrix, i.\xe2\x80\x89e. a matrix where every element is exactly 0. In order to do so, you may perform the following operations any number of times, in any order:  choose an integer i, then decrease ci,j by 1 for every j\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. decrease all elements in the i-th row by 1). In order to perform this operation, you pay 1 coin;  choose an integer j, then decrease ci,j by 1 for every i\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. decrease all elements in the j-th column by 1). In order to perform this operation, you pay 1 coin;  choose two integers i and j, then decrease ci,j by 1. In order to perform this operation, you pay 1 coin;  choose an integer i, then increase ci,j by 1 for every j\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. increase all elements in the i-th row by 1). When you perform this operation, you receive 1 coin;  choose an integer j, then increase ci,j by 1 for every i\xe2\x88\x88[1,n] (i.\xe2\x80\x89e. increase all elements in the j-th column by 1). When you perform this operation, you receive 1 coin. You have to calculate the minimum number of coins required to transform the matrix c into the zero matrix. Note that all elements of c should be equal to 0 simultaneously after the operations." 2900
1765I "Infinite Chess" "implementation,shortest paths" "The black king lives on a chess board with an infinite number of columns (files) and 8 rows (ranks). The columns are numbered with all integer numbers (including negative). The rows are numbered from 1 to 8.Initially, the black king is located on the starting square (xs,ys), and he needs to reach some target square (xt,yt). Unfortunately, there are also white pieces on the board, and they threaten the black king. After negotiations, the white pieces agreed to let the black king pass to the target square on the following conditions:  each turn, the black king makes a move according to the movement rules;  the black king cannot move to a square occupied by a white piece;  the black king cannot move to a square which is under attack by any white piece. A square is under attack if a white piece can reach it in one move according to the movement rules;  the white pieces never move. Help the black king find the minimum number of moves needed to reach the target square while not violating the conditions. The black king cannot leave the board at any time.The black king moves according to the movement rules below. Even though the white pieces never move, squares which they can reach in one move are considered to be under attack, so the black king cannot move into those squares.Below are the movement rules. Note that the pieces (except for the knight) cannot jump over other pieces.  a king moves exactly one square horizontally, vertically, or diagonally.  a rook moves any number of vacant squares horizontally or vertically.  a bishop moves any number of vacant squares diagonally.  a queen moves any number of vacant squares horizontally, vertically, or diagonally.  a knight moves to one of the nearest squares not on the same rank, file, or diagonal (this can be thought of as moving two squares horizontally then one square vertically, or moving one square horizontally then two squares vertically \xe2\x80\x94 i.\xe2\x80\x89e. in an ""L"" pattern). Knights are not blocked by other pieces, they can simply jump over them. There are no pawns on the board.   King and knight possible moves, respectively. Dotted line shows that knight can jump over other pieces.    Queen, bishop, and rook possible moves, respectively." 2800
1765H "Hospital Queue" "binary search,graphs,greedy,implementation" "There are n people (numbered from 1 to n) signed up for a doctor\'s appointment. The doctor has to choose in which order he will appoint these people. The i-th patient should be appointed among the first pi people. There are also m restrictions of the following format: the i-th restriction is denoted by two integers (ai,bi) and means that the patient with the index ai should be appointed earlier than the patient with the index bi.For example, if n=4, p=[2,3,2,4], m=1, a=[3] and b=[1], then the only order of appointment of patients that does not violate the restrictions is [3,1,2,4]. For n=3, p=[3,3,3], m=0, a=[] and b=[], any order of appointment is valid.For each patient, calculate the minimum position in the order that they can have among all possible orderings that don\'t violate the restrictions." 2200
1765G "Guess the String" "constructive algorithms,interactive,probabilities" "This is an interactive problem. You have to use flush operation right after printing each line. For example, in C++ you should use the function fflush(stdout), in Java or Kotlin \xe2\x80\x94 System.out.flush(), and in Python \xe2\x80\x94 sys.stdout.flush().The jury has a string s consisting of characters 0 and/or 1. The first character of this string is 0. The length of this string is n. You have to guess this string. Let\'s denote s[l..r] as the substring of s from l to r (i.\xe2\x80\x89e. s[l..r] is the string slsl+1\xe2\x80\xa6sr).Let the prefix function of the string s be an array [p1,p2,\xe2\x80\xa6,pn], where pi is the greatest integer j\xe2\x88\x88[0,i\xe2\x88\x921] such that s[1..j]=s[i\xe2\x88\x92j+1..i]. Also, let the antiprefix function of the string s be an array [q1,q2,\xe2\x80\xa6,qn], where qi is the greatest integer j\xe2\x88\x88[0,i\xe2\x88\x921] such that s[1..j] differs from s[i\xe2\x88\x92j+1..i] in every position.For example, for the string 011001, its prefix function is [0,0,0,1,1,2], and its antiprefix function is [0,1,1,2,3,4].You can ask queries of two types to guess the string s:  1 i \xe2\x80\x94 ""what is the value of pi?"";  2 i \xe2\x80\x94 ""what is the value of qi?"". You have to guess the string by asking no more than 789 queries. Note that giving the answer does not count as a query.In every test and in every test case, the string s is fixed beforehand." 2600
1765F "Chemistry Lab" dp,geometry,probabilities "Monocarp is planning on opening a chemistry lab. During the first month, he\'s going to distribute solutions of a certain acid.First, he will sign some contracts with a local chemistry factory. Each contract provides Monocarp with an unlimited supply of some solution of the same acid. The factory provides n contract options, numbered from 1 to n. The i-th solution has a concentration of xi%, the contract costs wi burles, and Monocarp will be able to sell it for ci burles per liter. Monocarp is expecting k customers during the first month. Each customer will buy a liter of a y%-solution, where y is a real number chosen uniformly at random from 0 to 100 independently for each customer. More formally, the probability of number y being less than or equal to some t is P(y\xe2\x89\xa4t)=t100.Monocarp can mix the solution that he signed the contracts with the factory for, at any ratio. More formally, if he has contracts for m solutions with concentrations x1,x2,\xe2\x80\xa6,xm, then, for these solutions, he picks their volumes a1,a2,\xe2\x80\xa6,am so that m\xe2\x88\x91i=1ai=1 (exactly 1 since each customer wants exactly one liter of a certain solution).The concentration of the resulting solution is m\xe2\x88\x91i=1xi\xe2\x8b\x85ai. The price of the resulting solution is m\xe2\x88\x91i=1ci\xe2\x8b\x85ai.If Monocarp can obtain a solution of concentration y%, then he will do it while maximizing its price (the cost for the customer). Otherwise, the customer leaves without buying anything, and the price is considered equal to 0.Monocarp wants to sign some contracts with a factory (possibly, none or all of them) so that the expected profit is maximized \xe2\x80\x94 the expected total price of the sold solutions for all k customers minus the total cost of signing the contracts from the factory.Print the maximum expected profit Monocarp can achieve." 2200
1765E Exchange "brute force,math" "Monocarp is playing a MMORPG. There are two commonly used types of currency in this MMORPG \xe2\x80\x94 gold coins and silver coins. Monocarp wants to buy a new weapon for his character, and that weapon costs n silver coins. Unfortunately, right now, Monocarp has no coins at all.Monocarp can earn gold coins by completing quests in the game. Each quest yields exactly one gold coin. Monocarp can also exchange coins via the in-game trading system. Monocarp has spent days analyzing the in-game economy; he came to the following conclusion: it is possible to sell one gold coin for a silver coins (i.\xe2\x80\x89e. Monocarp can lose one gold coin to gain a silver coins), or buy one gold coin for b silver coins (i.\xe2\x80\x89e. Monocarp can lose b silver coins to gain one gold coin).Now Monocarp wants to calculate the minimum number of quests that he has to complete in order to have at least n silver coins after some abuse of the in-game economy. Note that Monocarp can perform exchanges of both types (selling and buying gold coins for silver coins) any number of times." 1000
1765D "Watch the Videos" "binary search,constructive algorithms,two pointers" "Monocarp wants to watch n videos. Each video is only one minute long, but its size may be arbitrary. The i-th video has the size ai megabytes. All videos are published on the Internet. A video should be downloaded before it can be watched. Monocarp has poor Internet connection \xe2\x80\x94 it takes exactly 1 minute to download 1 megabyte of data, so it will require ai minutes to download the i-th video.Monocarp\'s computer has a hard disk of m megabytes. The disk is used to store the downloaded videos. Once Monocarp starts the download of a video of size s, the s megabytes are immediately reserved on a hard disk. If there are less than s megabytes left, the download cannot be started until the required space is freed. Each single video can be stored on the hard disk, since ai\xe2\x89\xa4m for all i. Once the download is started, it cannot be interrupted. It is not allowed to run two or more downloads in parallel.Once a video is fully downloaded to the hard disk, Monocarp can watch it. Watching each video takes exactly 1 minute and does not occupy the Internet connection, so Monocarp can start downloading another video while watching the current one.When Monocarp finishes watching a video, he doesn\'t need it on the hard disk anymore, so he can delete the video, instantly freeing the space it occupied on a hard disk. Deleting a video takes negligible time.Monocarp wants to watch all n videos as quickly as possible. The order of watching does not matter, since Monocarp needs to watch all of them anyway. Please calculate the minimum possible time required for that." 1700
1765C "Card Guessing" combinatorics,dp,probabilities "Consider a deck of cards. Each card has one of 4 suits, and there are exactly n cards for each suit \xe2\x80\x94 so, the total number of cards in the deck is 4n. The deck is shuffled randomly so that each of (4n)! possible orders of cards in the deck has the same probability of being the result of shuffling. Let ci be the i-th card of the deck (from top to bottom).Monocarp starts drawing the cards from the deck one by one. Before drawing a card, he tries to guess its suit. Monocarp remembers the suits of the k last cards, and his guess is the suit that appeared the least often among the last k cards he has drawn. So, while drawing the i-th card, Monocarp guesses that its suit is the suit that appears the minimum number of times among the cards ci\xe2\x88\x92k,ci\xe2\x88\x92k+1,\xe2\x80\xa6,ci\xe2\x88\x921 (if i\xe2\x89\xa4k, Monocarp considers all previously drawn cards, that is, the cards c1,c2,\xe2\x80\xa6,ci\xe2\x88\x921). If there are multiple suits that appeared the minimum number of times among the previous cards Monocarp remembers, he chooses a random suit out of those for his guess (all suits that appeared the minimum number of times have the same probability of being chosen).After making a guess, Monocarp draws a card and compares its suit to his guess. If they match, then his guess was correct; otherwise it was incorrect.Your task is to calculate the expected number of correct guesses Monocarp makes after drawing all 4n cards from the deck." 2600
1765B "Broken Keyboard" greedy "Recently, Mishka started noticing that his keyboard malfunctions \xe2\x80\x94 maybe it\'s because he was playing rhythm games too much. Empirically, Mishka has found out that every other time he presses a key, it is registered as if the key was pressed twice. For example, if Mishka types text, the first time he presses a key, exactly one letter is printed; the second time he presses a key, two same letters are printed; the third time he presses a key, one letter is printed; the fourth time he presses a key, two same letters are printed, and so on. Note that the number of times a key was pressed is counted for the whole keyboard, not for each key separately. For example, if Mishka tries to type the word osu, it will be printed on the screen as ossu.You are given a word consisting of n lowercase Latin letters. You have to determine if it can be printed on Mishka\'s keyboard or not. You may assume that Mishka cannot delete letters from the word, and every time he presses a key, the new letter (or letters) is appended to the end of the word." 800
1765A "Access Levels" "bitmasks,dsu,flows,graph matchings" "BerSoft is the biggest IT corporation in Berland, and Monocarp is the head of its security department. This time, he faced the most difficult task ever. Basically, there are n developers working at BerSoft, numbered from 1 to n. There are m documents shared on the internal network, numbered from 1 to m. There is a table of access requirements a such that ai,j (the j-th element of the i-th row) is 1 if the i-th developer should have access to the j-th document, and 0 if they should have no access to it.In order to restrict the access, Monocarp is going to perform the following actions:   choose the number of access groups k\xe2\x89\xa51;  assign each document an access group (an integer from 1 to k) and the required access level (an integer from 1 to 109);  assign each developer k integer values (from 1 to 109) \xe2\x80\x94 their access levels for each of the access groups. The developer i has access to the document j if their access level for the access group of the document is greater than or equal to the required access level of the document.What\'s the smallest number of access groups Monocarp can choose so that it\'s possible to assign access groups and access levels in order to satisfy the table of access requirements?" 2400
1764H "Doremy\'s Paint 2" "data structures" "Doremy has nn buckets of paint which is represented by an array aa of length nn. Bucket ii contains paint with color aiai. Initially, ai=iai=i.Doremy has mm segments [li,ri][li,ri] (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n). Each segment describes an operation. Operation ii is performed as follows:   For each jj such that li<j\xe2\x89\xa4rili<j\xe2\x89\xa4ri, set aj:=aliaj:=ali. Doremy also selects an integer kk. She wants to know for each integer xx from 00 to m\xe2\x88\x921m\xe2\x88\x921, the number of distinct colors in the array after performing operations xmodm+1,(x+1)modm+1,\xe2\x80\xa6,(x+k\xe2\x88\x921)modm+1xmodm+1,(x+1)modm+1,\xe2\x80\xa6,(x+k\xe2\x88\x921)modm+1. Can you help her calculate these values? Note that for each xx individually we start from the initial array and perform only the given kk operations in the given order." 3400
1764G3 "Doremy\'s Perfect DS Class (Hard Version)" "binary search,interactive" "The only difference between this problem and the other two versions is the maximum number of queries. In this version, you are allowed to ask at most 20 queries. You can make hacks only if all versions of the problem are solved.This is an interactive problem.""Everybody! Doremy\'s Perfect Data Structure Class is about to start! Come and do your best if you want to have as much IQ as me!"" In today\'s Data Structure class, Doremy is teaching everyone a powerful data structure \xe2\x80\x94 Doremy tree! Now she gives you a quiz to prove that you are paying attention in class.Given an array a of length m, Doremy tree supports the query Q(l,r,k), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4m and 1\xe2\x89\xa4k\xe2\x89\xa4m, which returns the number of distinct integers in the array [\xe2\x8c\x8aalk\xe2\x8c\x8b,\xe2\x8c\x8aal+1k\xe2\x8c\x8b,\xe2\x80\xa6,\xe2\x8c\x8aark\xe2\x8c\x8b].Doremy has a secret permutation p of integers from 1 to n. You can make queries, in one query, you give 3 integers l,r,k (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4k\xe2\x89\xa4n) and receive the value of Q(l,r,k) for the array p. Can you find the index y (1\xe2\x89\xa4y\xe2\x89\xa4n) such that py=1 in at most 20 queries?Note that the permutation p is fixed before any queries are made." 3300
1764G2 "Doremy\'s Perfect DS Class (Medium Version)" "binary search,interactive" "The only difference between this problem and the other two versions is the maximum number of queries. In this version, you are allowed to ask at most 25 queries. You can make hacks only if all versions of the problem are solved.This is an interactive problem.""Everybody! Doremy\'s Perfect Data Structure Class is about to start! Come and do your best if you want to have as much IQ as me!"" In today\'s Data Structure class, Doremy is teaching everyone a powerful data structure \xe2\x80\x94 Doremy tree! Now she gives you a quiz to prove that you are paying attention in class.Given an array a of length m, Doremy tree supports the query Q(l,r,k), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4m and 1\xe2\x89\xa4k\xe2\x89\xa4m, which returns the number of distinct integers in the array [\xe2\x8c\x8aalk\xe2\x8c\x8b,\xe2\x8c\x8aal+1k\xe2\x8c\x8b,\xe2\x80\xa6,\xe2\x8c\x8aark\xe2\x8c\x8b].Doremy has a secret permutation p of integers from 1 to n. You can make queries, in one query, you give 3 integers l,r,k (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4k\xe2\x89\xa4n) and receive the value of Q(l,r,k) for the array p. Can you find the index y (1\xe2\x89\xa4y\xe2\x89\xa4n) such that py=1 in at most 25 queries?Note that the permutation p is fixed before any queries are made." 3000
1764G1 "Doremy\'s Perfect DS Class (Easy Version)" "binary search,interactive" "The only difference between this problem and the other two versions is the maximum number of queries. In this version, you are allowed to ask at most 30 queries. You can make hacks only if all versions of the problem are solved.This is an interactive problem.""Everybody! Doremy\'s Perfect Data Structure Class is about to start! Come and do your best if you want to have as much IQ as me!"" In today\'s Data Structure class, Doremy is teaching everyone a powerful data structure \xe2\x80\x94 Doremy tree! Now she gives you a quiz to prove that you are paying attention in class.Given an array a of length m, Doremy tree supports the query Q(l,r,k), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4m and 1\xe2\x89\xa4k\xe2\x89\xa4m, which returns the number of distinct integers in the array [\xe2\x8c\x8aalk\xe2\x8c\x8b,\xe2\x8c\x8aal+1k\xe2\x8c\x8b,\xe2\x80\xa6,\xe2\x8c\x8aark\xe2\x8c\x8b].Doremy has a secret permutation p of integers from 1 to n. You can make queries, in one query, you give 3 integers l,r,k (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, 1\xe2\x89\xa4k\xe2\x89\xa4n) and receive the value of Q(l,r,k) for the array p. Can you find the index y (1\xe2\x89\xa4y\xe2\x89\xa4n) such that py=1 in at most 30 queries?Note that the permutation p is fixed before any queries are made." 2900
1764F "Doremy\'s Experimental Tree" "brute force,constructive algorithms,dfs and similar,dsu,sortings,trees" "Doremy has an edge-weighted tree with n vertices whose weights are integers between 1 and 109. She does n(n+1)2 experiments on it.In each experiment, Doremy chooses vertices i and j such that j\xe2\x89\xa4i and connects them directly with an edge with weight 1. Then, there is exactly one cycle (or self-loop when i=j) in the graph. Doremy defines f(i,j) as the sum of lengths of shortest paths from every vertex to the cycle.Formally, let disi,j(x,y) be the length of the shortest path between vertex x and y when the edge (i,j) of weight 1 is added, and Si,j be the set of vertices that are on the cycle when edge (i,j) is added. Then,f(i,j)=\xe2\x88\x91x=1n(miny\xe2\x88\x88Si,jdisi,j(x,y)).Doremy writes down all values of f(i,j) such that 1\xe2\x89\xa4j\xe2\x89\xa4i\xe2\x89\xa4n, then goes to sleep. However, after waking up, she finds that the tree has gone missing. Fortunately, the values of f(i,j) are still in her notebook, and she knows which i and j they belong to. Given the values of f(i,j), can you help her restore the tree?It is guaranteed that at least one suitable tree exists." 2500
1764E "Doremy\'s Number Line" dp,greedy,sortings "Doremy has two arrays a and b of n integers each, and an integer k.Initially, she has a number line where no integers are colored. She chooses a permutation p of [1,2,\xe2\x80\xa6,n] then performs n moves. On the i-th move she does the following:  Pick an uncolored integer x on the number line such that either:   x\xe2\x89\xa4api; or  there exists a colored integer y such that y\xe2\x89\xa4api and x\xe2\x89\xa4y+bpi.   Color integer x with color pi. Determine if the integer k can be colored with color 1." 2400
1764D "Doremy\'s Pegging Game" combinatorics,dp,math "Doremy has n+1n+1 pegs. There are nn red pegs arranged as vertices of a regular nn-sided polygon, numbered from 11 to nn in anti-clockwise order. There is also a blue peg of slightly smaller diameter in the middle of the polygon. A rubber band is stretched around the red pegs.Doremy is very bored today and has decided to play a game. Initially, she has an empty array aa. While the rubber band does not touch the blue peg, she will:  choose ii (1\xe2\x89\xa4i\xe2\x89\xa4n1\xe2\x89\xa4i\xe2\x89\xa4n) such that the red peg ii has not been removed;  remove the red peg ii;  append ii to the back of aa. Doremy wonders how many possible different arrays aa can be produced by the following process. Since the answer can be big, you are only required to output it modulo pp. pp is guaranteed to be a prime number.  game with n=9n=9 and a=[7,5,2,8,3,9,4]a=[7,5,2,8,3,9,4] and another game with n=8n=8 and a=[3,4,7,1,8,5,2]a=[3,4,7,1,8,5,2]" 2000
1764C "Doremy\'s City Construction" graphs,greedy "Doremy\'s new city is under construction! The city can be regarded as a simple undirected graph with nn vertices. The ii-th vertex has altitude aiai. Now Doremy is deciding which pairs of vertices should be connected with edges.Due to economic reasons, there should be no self-loops or multiple edges in the graph.Due to safety reasons, there should not be pairwise distinct vertices uu, vv, and ww such that au\xe2\x89\xa4av\xe2\x89\xa4awau\xe2\x89\xa4av\xe2\x89\xa4aw and the edges (u,v)(u,v) and (v,w)(v,w) exist.Under these constraints, Doremy would like to know the maximum possible number of edges in the graph. Can you help her?Note that the constructed graph is allowed to be disconnected." 1400
1764B "Doremy\'s Perfect Math Class" "math,number theory" """Everybody! Doremy\'s Perfect Math Class is about to start! Come and do your best if you want to have as much IQ as me!"" In today\'s math class, Doremy is teaching everyone subtraction. Now she gives you a quiz to prove that you are paying attention in class.You are given a set S containing positive integers. You may perform the following operation some (possibly zero) number of times:  choose two integers x and y from the set S such that x>y and x\xe2\x88\x92y is not in the set S.  add x\xe2\x88\x92y into the set S. You need to tell Doremy the maximum possible number of integers in S if the operations are performed optimally. It can be proven that this number is finite." 900
1764A "Doremy\'s Paint" greedy "Doremy has n buckets of paint which is represented by an array a of length n. Bucket i contains paint with color ai. Let c(l,r) be the number of distinct elements in the subarray [al,al+1,\xe2\x80\xa6,ar]. Choose 2 integers l and r such that l\xe2\x89\xa4r and r\xe2\x88\x92l\xe2\x88\x92c(l,r) is maximized." 800
1763F "Edge Queries" "data structures,dfs and similar,dp,dsu,graphs,trees" "You are given an undirected, connected graph of n nodes and m edges. All nodes u of the graph satisfy the following:  Let Su be the set of vertices in the longest simple cycle starting and ending at u.  Let Cu be the union of the sets of vertices in any simple cycle starting and ending at u.  Su=Cu. You need to answer q queries.For each query, you will be given node a and node b. Out of all the edges that belong to any simple path from a to b, count the number of edges such that if you remove that edge, a and b are reachable from each other." 3000
1763E "Node Pairs" "dp,graphs,math,number theory" "Let\'s call an ordered pair of nodes (u,v) in a directed graph unidirectional if u\xe2\x89\xa0v, there exists a path from u to v, and there are no paths from v to u.A directed graph is called p-reachable if it contains exactly p ordered pairs of nodes (u,v) such that u<v and u and v are reachable from each other. Find the minimum number of nodes required to create a p-reachable directed graph.Also, among all such p-reachable directed graphs with the minimum number of nodes, let G denote a graph which maximizes the number of unidirectional pairs of nodes. Find this number." 2200
1763D "Valid Bitonic Permutations" "combinatorics,dp,implementation,math,number theory" "You are given five integers n, i, j, x, and y. Find the number of bitonic permutations B, of the numbers 1 to n, such that Bi=x, and Bj=y. Since the answer can be large, compute it modulo 109+7.A bitonic permutation is a permutation of numbers, such that the elements of the permutation first increase till a certain index k, 2\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921, and then decrease till the end. Refer to notes for further clarification." 2200
1763C "Another Array Problem" "brute force,constructive algorithms,greedy" "You are given an array a of n integers. You are allowed to perform the following operation on it as many times as you want (0 or more times):   Choose 2 indices i,j where 1\xe2\x89\xa4i<j\xe2\x89\xa4n and replace ak for all i\xe2\x89\xa4k\xe2\x89\xa4j with |ai\xe2\x88\x92aj| Print the maximum sum of all the elements of the final array that you can obtain in such a way." 2000
1763B Incinerate "binary search,brute force,data structures,implementation,math,sortings" "To destroy humanity, The Monster Association sent n monsters to Earth\'s surface. The i-th monster has health hi and power pi.With his last resort attack, True Spiral Incineration Cannon, Genos can deal k damage to all monsters alive. In other words, Genos can reduce the health of all monsters by k (if k>0) with a single attack. However, after every attack Genos makes, the monsters advance. With their combined efforts, they reduce Genos\' attack damage by the power of the \xe2\x80\xa0weakest monster \xe2\x80\xa1alive. In other words, the minimum pi among all currently living monsters is subtracted from the value of k after each attack.\xe2\x80\xa0The Weakest monster is the one with the least power.\xe2\x80\xa1A monster is alive if its health is strictly greater than 0.Will Genos be successful in killing all the monsters?" 1200
1763A "Absolute Maximization" "bitmasks,constructive algorithms,greedy,math" "You are given an array a of length n. You can perform the following operation several (possibly, zero) times:  Choose i, j, b: Swap the b-th digit in the binary representation of ai and aj. Find the maximum possible value of max(a)\xe2\x88\x92min(a).In a binary representation, bits are numbered from right (least significant) to left (most significant). Consider that there are an infinite number of leading zero bits at the beginning of any binary representation.For example, swap the 0-th bit for 4=1002 and 3=112 will result 1012=5 and 102=2. Swap the 2-nd bit for 4=1002 and 3=112 will result 0002=02=0 and 1112=7. Here, max(a) denotes the maximum element of array a and min(a) denotes the minimum element of array a.The binary representation of x is x written in base 2. For example, 9 and 6 written in base 2 are 1001 and 110, respectively." 800
1762G "Unequal Adjacent Elements" "constructive algorithms,sortings" "You are given an array a consisting of n positive integers. Find any permutation p of [1,2,\xe2\x80\xa6,n] such that:  pi\xe2\x88\x922<pi for all i, where 3\xe2\x89\xa4i\xe2\x89\xa4n, and  api\xe2\x88\x921\xe2\x89\xa0api for all i, where 2\xe2\x89\xa4i\xe2\x89\xa4n. Or report that no such permutation exists." 3100
1762F "Good Pairs" "binary search,data structures,dp" "You are given an array a consisting of n integers and an integer k.A pair (l,r) is good if there exists a sequence of indices i1,i2,\xe2\x80\xa6,im such that   i1=l and im=r;  ij<ij+1 for all 1\xe2\x89\xa4j<m; and  |aij\xe2\x88\x92aij+1|\xe2\x89\xa4k for all 1\xe2\x89\xa4j<m. Find the number of pairs (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) that are good." 2600
1762E "Tree Sum" combinatorics,math,trees "Let us call an edge-weighted tree with n vertices numbered from 1 to n good if the weight of each edge is either 1 or \xe2\x88\x921 and for each vertex i, the product of the edge weights of all edges having i as one endpoint is \xe2\x88\x921.You are given a positive integer n. There are nn\xe2\x88\x922\xe2\x8b\x852n\xe2\x88\x921 distinct\xe2\x80\xa0 edge-weighted trees with n vertices numbered from 1 to n such that each edge is either 1 or \xe2\x88\x921. Your task is to find the sum of d(1,n)\xe2\x80\xa1 of all such trees that are good. Since the answer can be quite large, you only need to find it modulo 998244353.\xe2\x80\xa0 Two trees are considered to be distinct if either:   there exists two vertices such that there is an edge between them in one of the trees, and not in the other.  there exists two vertices such that there is an edge between them in both trees but the weight of the edge between them in one tree is different from the one in the other tree. Note that by Cayley\'s formula, the number of trees on n labeled vertices is nn\xe2\x88\x922. Since we have n\xe2\x88\x921 edges, there are 2n\xe2\x88\x921 possible assignment of weights(weight can either be 1 or \xe2\x88\x921). That is why total number of distinct edge-weighted tree is nn\xe2\x88\x922\xe2\x8b\x852n\xe2\x88\x921.\xe2\x80\xa1 d(u,v) denotes the sum of the weight of all edges on the unique simple path from u to v." 2600
1762D "GCD Queries" "constructive algorithms,interactive,number theory" "This is an interactive problem.There is a secret permutation p of [0,1,2,\xe2\x80\xa6,n\xe2\x88\x921]. Your task is to find 2 indices x and y (1\xe2\x89\xa4x,y\xe2\x89\xa4n, possibly x=y) such that px=0 or py=0. In order to find it, you are allowed to ask at most 2n queries.In one query, you give two integers i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j) and receive the value of gcd(pi,pj)\xe2\x80\xa0.Note that the permutation p is fixed before any queries are made and does not depend on the queries.\xe2\x80\xa0 gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y. Note that gcd(x,0)=gcd(0,x)=x for all positive integers x." 2100
1762C "Binary Strings are Fun" combinatorics,math "A binary string\xe2\x80\xa0 b of odd length m is good if bi is the median\xe2\x80\xa1 of b[1,i]\xc2\xa7 for all odd indices i (1\xe2\x89\xa4i\xe2\x89\xa4m).For a binary string a of length k, a binary string b of length 2k\xe2\x88\x921 is an extension of a if b2i\xe2\x88\x921=ai for all i such that 1\xe2\x89\xa4i\xe2\x89\xa4k. For example, 1001011 and 1101001 are extensions of the string 1001. String x=1011011 is not an extension of string y=1001 because x3\xe2\x89\xa0y2. Note that there are 2k\xe2\x88\x921 different extensions of a.You are given a binary string s of length n. Find the sum of the number of good extensions over all prefixes of s. In other words, find \xe2\x88\x91ni=1f(s[1,i]), where f(x) gives number of good extensions of string x. Since the answer can be quite large, you only need to find it modulo 998244353.\xe2\x80\xa0 A binary string is a string whose elements are either 0 or 1.\xe2\x80\xa1 For a binary string a of length 2m\xe2\x88\x921, the median of a is the (unique) element that occurs at least m times in a.\xc2\xa7 a[l,r] denotes the string of length r\xe2\x88\x92l+1 which is formed by the concatenation of al,al+1,\xe2\x80\xa6,ar in that order." 1400
1762B "Make Array Good" "constructive algorithms,implementation,number theory,sortings" "An array b of m positive integers is good if for all pairs i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4m), max(bi,bj) is divisible by min(bi,bj).You are given an array a of n positive integers. You can perform the following operation:  Select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and an integer x (0\xe2\x89\xa4x\xe2\x89\xa4ai) and add x to ai, in other words, ai:=ai+x.  After this operation, ai\xe2\x89\xa41018 should be satisfied. You have to construct a sequence of at most n operations that will make a good. It can be proven that under the constraints of the problem, such a sequence of operations always exists." 1100
1762A "Divide and Conquer" "greedy,math,number theory" "An array b is good if the sum of elements of b is even. You are given an array a consisting of n positive integers. In one operation, you can select an index i and change ai:=\xe2\x8c\x8aai2\xe2\x8c\x8b. \xe2\x80\xa0Find the minimum number of operations (possibly 0) needed to make a good. It can be proven that it is always possible to make a good.\xe2\x80\xa0 \xe2\x8c\x8ax\xe2\x8c\x8b denotes the floor function \xe2\x80\x94 the largest integer less than or equal to x. For example, \xe2\x8c\x8a2.7\xe2\x8c\x8b=2, \xe2\x8c\x8a\xcf\x80\xe2\x8c\x8b=3 and \xe2\x8c\x8a5\xe2\x8c\x8b=5." 800
1761G "Centroid Guess" interactive,probabilities,trees "This in an interactive problem.There is an unknown tree consisting of n nodes, which has exactly one centroid. You only know n at first, and your task is to find the centroid of the tree.You can ask the distance between any two vertices for at most 2\xe2\x8b\x85105 times. Note that the interactor is not adaptive. That is, the tree is fixed in each test beforehand and does not depend on your queries.A vertex is called a centroid if its removal splits the tree into subtrees with at most \xe2\x8c\x8an2\xe2\x8c\x8b vertices each." 3500
1761F2 "Anti-median (Hard Version)" combinatorics,dp,math "This is the hard version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if all versions of the problem are solved.Let\'s call an array a of odd length 2m+1 (with m\xe2\x89\xa51) bad, if element am+1 is equal to the median of this array. In other words, the array is bad if, after sorting it, the element at m+1-st position remains the same.Let\'s call a permutation p of integers from 1 to n anti-median, if every its subarray of odd length \xe2\x89\xa53 is not bad.You are already given values of some elements of the permutation. Find the number of ways to set unknown values to obtain an anti-median permutation. As this number can be very large, find it modulo 109+7." 3500
1761F1 "Anti-median (Easy Version)" dp,math "This is the easy version of the problem. The only difference between the two versions is the constraint on n. You can make hacks only if all versions of the problem are solved.Let\'s call an array a of odd length 2m+1 (with m\xe2\x89\xa51) bad, if element am+1 is equal to the median of this array. In other words, the array is bad if, after sorting it, the element at m+1-st position remains the same.Let\'s call a permutation p of integers from 1 to n anti-median, if every its subarray of odd length \xe2\x89\xa53 is not bad.You are already given values of some elements of the permutation. Find the number of ways to set unknown values to obtain an anti-median permutation. As this number can be very large, find it modulo 109+7." 3100
1761E "Make It Connected" "binary search,brute force,constructive algorithms,dsu,graphs,greedy,matrices,trees,two pointers" "You are given a simple undirected graph consisting of n vertices. The graph doesn\'t contain self-loops, there is at most one edge between each pair of vertices. Your task is simple: make the graph connected.You can do the following operation any number of times (possibly zero):  Choose a vertex u arbitrarily.  For each vertex v satisfying v\xe2\x89\xa0u in the graph individually, if v is adjacent to u, remove the edge between u and v, otherwise add an edge between u and v. Find the minimum number of operations required to make the graph connected. Also, find any sequence of operations with the minimum length that makes the graph connected." 2400
1761D "Carry Bit" combinatorics,math "Let f(x,y) be the number of carries of x+y in binary (i. e. f(x,y)=g(x)+g(y)\xe2\x88\x92g(x+y), where g(x) is the number of ones in the binary representation of x).Given two integers n and k, find the number of ordered pairs (a,b) such that 0\xe2\x89\xa4a,b<2n, and f(a,b) equals k. Note that for a\xe2\x89\xa0b, (a,b) and (b,a) are considered as two different pairs. As this number may be large, output it modulo 109+7." 2100
1761C "Set Construction" "constructive algorithms,dfs and similar,graphs,greedy" "You are given a binary matrix b (all elements of the matrix are 0 or 1) of n rows and n columns.You need to construct a n sets A1,A2,\xe2\x80\xa6,An, for which the following conditions are satisfied:  Each set is nonempty and consists of distinct integers between 1 and n inclusive.  All sets are distinct.  For all pairs (i,j) satisfying 1\xe2\x89\xa4i,j\xe2\x89\xa4n, bi,j=1 if and only if Ai\xe2\x8a\x8aAj. In other words, bi,j is 1 if Ai is a proper subset of Aj and 0 otherwise. Set X is a proper subset of set Y, if X is a nonempty subset of Y, and X\xe2\x89\xa0Y.It\'s guaranteed that for all test cases in this problem, such n sets exist. Note that it doesn\'t mean that such n sets exist for all possible inputs.If there are multiple solutions, you can output any of them." 1400
1761B "Elimination of a Ring" "constructive algorithms,greedy,implementation" "Define a cyclic sequence of size n as an array s of length n, in which sn is adjacent to s1.Muxii has a ring represented by a cyclic sequence a of size n.However, the ring itself hates equal adjacent elements. So if two adjacent elements in the sequence are equal at any time, one of them will be erased immediately. The sequence doesn\'t contain equal adjacent elements initially.Muxii can perform the following operation until the sequence becomes empty:  Choose an element in a and erase it. For example, if ring is [1,2,4,2,3,2], and Muxii erases element 4, then ring would erase one of the elements equal to 2, and the ring will become [1,2,3,2].Muxii wants to find the maximum number of operations he could perform.Note that in a ring of size 1, its only element isn\'t considered adjacent to itself (so it\'s not immediately erased)." 1000
1761A "Two Permutations" "brute force,constructive algorithms" "You are given three integers n, a, and b. Determine if there exist two permutations p and q of length n, for which the following conditions hold:  The length of the longest common prefix of p and q is a.  The length of the longest common suffix of p and q is b. A permutation of length n is an array containing each integer from 1 to n exactly once. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array), and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800
1760G "SlavicG\'s Favorite Problem" "bitmasks,dfs and similar,graphs" "You are given a weighted tree with n vertices. Recall that a tree is a connected graph without any cycles. A weighted tree is a tree in which each edge has a certain weight. The tree is undirected, it doesn\'t have a root.Since trees bore you, you decided to challenge yourself and play a game on the given tree.In a move, you can travel from a node to one of its neighbors (another node it has a direct edge with).You start with a variable x which is initially equal to 0. When you pass through edge i, x changes its value to x XOR wi (where wi is the weight of the i-th edge). Your task is to go from vertex a to vertex b, but you are allowed to enter node b if and only if after traveling to it, the value of x will become 0. In other words, you can travel to node b only by using an edge i such that x XOR wi=0. Once you enter node b the game ends and you win.Additionally, you can teleport at most once at any point in time to any vertex except vertex b. You can teleport from any vertex, even from a.Answer with ""YES"" if you can reach vertex b from a, and ""NO"" otherwise.Note that XOR represents the bitwise XOR operation." 1700
1760F Quests "binary search,greedy,sortings" "There are n quests. If you complete the i-th quest, you will gain ai coins. You can only complete at most one quest per day. However, once you complete a quest, you cannot do the same quest again for k days. (For example, if k=2 and you do quest 1 on day 1, then you cannot do it on day 2 or 3, but you can do it again on day 4.)You are given two integers c and d. Find the maximum value of k such that you can gain at least c coins over d days. If no such k exists, output Impossible. If k can be arbitrarily large, output Infinity." 1500
1760E "Binary Inversions" "data structures,greedy,math" "You are given a binary array\xe2\x80\xa0 of length n. You are allowed to perform one operation on it at most once. In an operation, you can choose any element and flip it: turn a 0 into a 1 or vice-versa.What is the maximum number of inversions\xe2\x80\xa1 the array can have after performing at most one operation?\xe2\x80\xa0 A binary array is an array that contains only zeroes and ones.\xe2\x80\xa1 The number of inversions in an array is the number of pairs of indices i,j such that i<j and ai>aj." 1100
1760D "Challenging Valleys" "implementation,two pointers" "You are given an array a[0\xe2\x80\xa6n\xe2\x88\x921] of n integers. This array is called a ""valley"" if there exists exactly one subarray a[l\xe2\x80\xa6r] such that:  0\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n\xe2\x88\x921,  al=al+1=al+2=\xe2\x8b\xaf=ar,  l=0 or al\xe2\x88\x921>al,  r=n\xe2\x88\x921 or ar<ar+1. Here are three examples:  The first image shows the array [3,2,2,1,2,2,3], it is a valley because only subarray with indices l=r=3 satisfies the condition.The second image shows the array [1,1,1,2,3,3,4,5,6,6,6], it is a valley because only subarray with indices l=0,r=2 satisfies the codition.The third image shows the array [1,2,3,4,3,2,1], it is not a valley because two subarrays l=r=0 and l=r=6 that satisfy the condition.You are asked whether the given array is a valley or not.Note that we consider the array to be indexed from 0." 1000
1760C Advantage "data structures,implementation,sortings" "There are n participants in a competition, participant i having a strength of si. Every participant wonders how much of an advantage they have over the other best participant. In other words, each participant i wants to know the difference between si and sj, where j is the strongest participant in the competition, not counting i (a difference can be negative).So, they ask you for your help! For each i (1\xe2\x89\xa4i\xe2\x89\xa4n) output the difference between si and the maximum strength of any participant other than participant i." 800
1760B "Atilla\'s Favorite Problem" greedy,implementation,strings "In order to write a string, Atilla needs to first learn all letters that are contained in the string.Atilla needs to write a message which can be represented as a string s. He asks you what is the minimum alphabet size required so that one can write this message.The alphabet of size x (1\xe2\x89\xa4x\xe2\x89\xa426) contains only the first x Latin letters. For example an alphabet of size 4 contains only the characters a, b, c and d." 800
1760A "Medium Number" implementation,sortings "Given three distinct integers a, b, and c, find the medium number between all of them.The medium number is the number that is neither the minimum nor the maximum of the given three numbers. For example, the median of 5,2,6 is 5, since the minimum is 2 and the maximum is 6." 800
1759G "Restore the Permutation" "binary search,constructive algorithms,data structures,greedy,math" "A sequence of n numbers is called permutation if it contains all numbers from 1 to n exactly once. For example, the sequences [3,1,4,2], [1] and [2,1] are permutations, but [1,2,1], [0,1] and [1,3,4] \xe2\x80\x94 are not.For a permutation p of even length n you can make an array b of length n2 such that:   bi=max(p2i\xe2\x88\x921,p2i) for 1\xe2\x89\xa4i\xe2\x89\xa4n2 For example, if p = [2,4,3,1,5,6], then:   b1=max(p1,p2)=max(2,4)=4  b2=max(p3,p4)=max(3,1)=3  b3=max(p5,p6)=max(5,6)=6  As a result, we made b = [4,3,6].For a given array b, find the lexicographically minimal permutation p such that you can make the given array b from it.If b = [4,3,6], then the lexicographically minimal permutation from which it can be made is p = [1,4,2,3,5,6], since:   b1=max(p1,p2)=max(1,4)=4  b2=max(p3,p4)=max(2,3)=3  b3=max(p5,p6)=max(5,6)=6 A permutation x1,x2,\xe2\x80\xa6,xn is lexicographically smaller than a permutation y1,y2\xe2\x80\xa6,yn if and only if there exists such i (1\xe2\x89\xa4i\xe2\x89\xa4n) that x1=y1,x2=y2,\xe2\x80\xa6,xi\xe2\x88\x921=yi\xe2\x88\x921 and xi<yi." 1900
1759F "All Possible Digits" "binary search,data structures,greedy,math,number theory" "A positive number x of length n in base p (2\xe2\x89\xa4p\xe2\x89\xa4109) is written on the blackboard. The number x is given as a sequence a1,a2,\xe2\x80\xa6,an (0\xe2\x89\xa4ai<p) \xe2\x80\x94 the digits of x in order from left to right (most significant to least significant).Dmitry is very fond of all the digits of this number system, so he wants to see each of them at least once.In one operation, he can:   take any number x written on the board, increase it by 1, and write the new value x+1 on the board. For example, p=5 and x=2345.  Initially, the board contains the digits 2, 3 and 4;  Dmitry increases the number 2345 by 1 and writes down the number 2405. On the board there are digits 0,2,3,4;  Dmitry increases the number 2405 by 1 and writes down the number 2415. Now the board contains all the digits from 0 to 4. Your task is to determine the minimum number of operations required to make all the digits from 0 to p\xe2\x88\x921 appear on the board at least once." 1800
1759E "The Humanoid" "brute force,dp,sortings" "There are n astronauts working on some space station. An astronaut with the number i (1\xe2\x89\xa4i\xe2\x89\xa4n) has power ai.An evil humanoid has made his way to this space station. The power of this humanoid is equal to h. Also, the humanoid took with him two green serums and one blue serum.In one second , a humanoid can do any of three actions:  to absorb an astronaut with power strictly less humanoid power;  to use green serum, if there is still one left;  to use blue serum, if there is still one left. When an astronaut with power ai is absorbed, this astronaut disappears, and power of the humanoid increases by \xe2\x8c\x8aai2\xe2\x8c\x8b, that is, an integer part of ai2. For example, if a humanoid absorbs an astronaut with power 4, its power increases by 2, and if a humanoid absorbs an astronaut with power 7, its power increases by 3.After using the green serum, this serum disappears, and the power of the humanoid doubles, so it increases by 2 times.After using the blue serum, this serum disappears, and the power of the humanoid triples, so it increases by 3 times.The humanoid is wondering what the maximum number of astronauts he will be able to absorb if he acts optimally." 1500
1759D "Make It Round" "brute force,number theory" "Inflation has occurred in Berlandia, so the store needs to change the price of goods.The current price of good n is given. It is allowed to increase the price of the good by k times, with 1\xe2\x89\xa4k\xe2\x89\xa4m, k is an integer. Output the roundest possible new price of the good. That is, the one that has the maximum number of zeros at the end.For example, the number 481000 is more round than the number 1000010 (three zeros at the end of 481000 and only one at the end of 1000010).If there are several possible variants, output the one in which the new price is maximal.If it is impossible to get a rounder price, output n\xe2\x8b\x85m (that is, the maximum possible price)." 1400
1759C Thermostat "greedy,math,shortest paths" "Vlad came home and found out that someone had reconfigured the old thermostat to the temperature of a.The thermostat can only be set to a temperature from l to r inclusive, the temperature cannot change by less than x. Formally, in one operation you can reconfigure the thermostat from temperature a to temperature b if |a\xe2\x88\x92b|\xe2\x89\xa5x and l\xe2\x89\xa4b\xe2\x89\xa4r.You are given l, r, x, a and b. Find the minimum number of operations required to get temperature b from temperature a, or say that it is impossible." 1100
1759B "Lost Permutation" math "A sequence of n numbers is called a permutation if it contains all integers from 1 to n exactly once. For example, the sequences [3,1,4,2], [1] and [2,1] are permutations, but [1,2,1], [0,1] and [1,3,4] \xe2\x80\x94 are not.Polycarp lost his favorite permutation and found only some of its elements \xe2\x80\x94 the numbers b1,b2,\xe2\x80\xa6bm. He is sure that the sum of the lost elements equals s.Determine whether one or more numbers can be appended to the given sequence b1,b2,\xe2\x80\xa6bm such that the sum of the added numbers equals s, and the resulting new array is a permutation?" 800
1759A Yes-Yes? implementation,strings "You talked to Polycarp and asked him a question. You know that when he wants to answer ""yes"", he repeats Yes many times in a row.Because of the noise, you only heard part of the answer \xe2\x80\x94 some substring of it. That is, if he answered YesYes, then you could hear esY, YesYes, sYes, e, but you couldn\'t Yess, YES or se.Determine if it is true that the given string s is a substring of YesYesYes... (Yes repeated many times in a row)." 800
1758F "Decent Division" "constructive algorithms,data structures" "A binary string is a string where every character is 0 or 1. Call a binary string decent if it has an equal number of 0s and 1s.Initially, you have an infinite binary string t whose characters are all 0s. You are given a sequence a of n updates, where ai indicates that the character at index ai will be flipped (0\xe2\x86\x941). You need to keep and modify after each update a set S of disjoint ranges such that:   for each range [l,r], the substring tl\xe2\x80\xa6tr is a decent binary string, and  for all indices i such that ti=1, there exists [l,r] in S such that l\xe2\x89\xa4i\xe2\x89\xa4r. You only need to output the ranges that are added to or removed from S after each update. You can only add or remove ranges from S at most 106 times.More formally, let Si be the set of ranges after the i-th update, where S0=\xe2\x88\x85 (the empty set). Define Xi to be the set of ranges removed after update i, and Yi to be the set of ranges added after update i. Then for 1\xe2\x89\xa4i\xe2\x89\xa4n, Si=(Si\xe2\x88\x921\xe2\x88\x96Xi)\xe2\x88\xaaYi. The following should hold for all 1\xe2\x89\xa4i\xe2\x89\xa4n:   \xe2\x88\x80a,b\xe2\x88\x88Si,(a\xe2\x89\xa0b)\xe2\x86\x92(a\xe2\x88\xa9b=\xe2\x88\x85);  Xi\xe2\x8a\x86Si\xe2\x88\x921;  (Si\xe2\x88\x921\xe2\x88\x96Xi)\xe2\x88\xa9Yi=\xe2\x88\x85;  n\xe2\x88\x91i=1(|Xi|+|Yi|)\xe2\x89\xa4106." 3000
1758E "Tick, Tock" "combinatorics,dfs and similar,dsu,graphs" "Tannhaus, the clockmaker in the town of Winden, makes mysterious clocks that measure time in h hours numbered from 0 to h\xe2\x88\x921. One day, he decided to make a puzzle with these clocks. The puzzle consists of an n\xc3\x97m grid of clocks, and each clock always displays some hour exactly (that is, it doesn\'t lie between two hours). In one move, he can choose any row or column and shift all clocks in that row or column one hour forward\xe2\x80\xa0.The grid of clocks is called solvable if it is possible to make all the clocks display the same time.While building his puzzle, Tannhaus suddenly got worried that it might not be possible to make the grid solvable. Some cells of the grid have clocks already displaying a certain initial time, while the rest of the cells are empty.Given the partially completed grid of clocks, find the number of ways\xe2\x80\xa1 to assign clocks in the empty cells so that the grid is solvable. The answer can be enormous, so compute it modulo 109+7.\xe2\x80\xa0 If a clock currently displays hour t and is shifted one hour forward, then the clock will instead display hour (t+1)modh.\xe2\x80\xa1 Two assignments are different if there exists some cell with a clock that displays a different time in both arrangements." 2500
1758D "Range = \xe2\x88\x9aSum" "binary search,brute force,constructive algorithms,math,two pointers" "You are given an integer n. Find a sequence of n distinct integers a1,a2,\xe2\x80\xa6,an such that 1\xe2\x89\xa4ai\xe2\x89\xa4109 for all i and max(a1,a2,\xe2\x80\xa6,an)\xe2\x88\x92min(a1,a2,\xe2\x80\xa6,an)=\xe2\x88\x9aa1+a2+\xe2\x8b\xaf+an.It can be proven that there exists a sequence of distinct integers that satisfies all the conditions above." 1800
1758C "Almost All Multiples" "greedy,number theory" "Given two integers n and x, a permutation\xe2\x80\xa0 p of length n is called funny if pi is a multiple of i for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921, pn=1, and p1=x.Find the lexicographically minimal\xe2\x80\xa1 funny permutation, or report that no such permutation exists.\xe2\x80\xa0 A permutation of length n is an array consisting of each of the integers from 1 to n exactly once.\xe2\x80\xa1 Let a and b be permutations of length n. Then a is lexicographically smaller than b if in the first position i where a and b differ, ai<bi. A permutation is lexicographically minimal if it is lexicographically smaller than all other permutations." 1400
1758B "XOR = Average" "constructive algorithms" "You are given an integer n. Find a sequence of n integers a1,a2,\xe2\x80\xa6,an such that 1\xe2\x89\xa4ai\xe2\x89\xa4109 for all i and a1\xe2\x8a\x95a2\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95an=a1+a2+\xe2\x8b\xaf+ann, where \xe2\x8a\x95 represents the bitwise XOR.It can be proven that there exists a sequence of integers that satisfies all the conditions above." 900
1758A "SSeeeeiinngg DDoouubbllee" "constructive algorithms,strings" "A palindrome is a string that reads the same backward as forward. For example, the strings z, aaa, aba, and abccba are palindromes, but codeforces and ab are not.The double of a string s is obtained by writing each character twice. For example, the double of seeing is sseeeeiinngg.Given a string s, rearrange its double to form a palindrome. Output the rearranged string. It can be proven that such a rearrangement always exists." 800
1754B "Kevin and Permutation" "constructive algorithms,greedy,math" "For his birthday, Kevin received the set of pairwise distinct numbers 1,2,3,\xe2\x80\xa6,n as a gift.He is going to arrange these numbers in a way such that the minimum absolute difference between two consecutive numbers be maximum possible. More formally, if he arranges numbers in order p1,p2,\xe2\x80\xa6,pn, he wants to maximize the value n\xe2\x88\x921mini=1|pi+1\xe2\x88\x92pi|, where |x| denotes the absolute value of x.Help Kevin to do that." 800
1754A "Technical Support" greedy "You work in the quality control department of technical support for a large company. Your job is to make sure all client issues have been resolved.Today you need to check a copy of a dialog between a client and a technical support manager. According to the rules of work, each message of the client must be followed by one or several messages, which are the answer of a support manager. However, sometimes clients ask questions so quickly that some of the manager\'s answers to old questions appear after the client has asked some new questions.Due to the privacy policy, the full text of messages is not available to you, only the order of messages is visible, as well as the type of each message: a customer question or a response from the technical support manager. It is guaranteed that the dialog begins with the question of the client.You have to determine, if this dialog may correspond to the rules of work described above, or the rules are certainly breached." 800
1753F "Minecraft Series" "brute force,two pointers" "Little Misha goes to the programming club and solves nothing there. It may seem strange, but when you find out that Misha is filming a Minecraft series, everything will fall into place...Misha is inspired by Manhattan, so he built a city in Minecraft that can be imagined as a table of size n\xc3\x97m. k students live in a city, the i-th student lives in the house, located at the intersection of the xi-th row and the yi-th column. Also, each student has a degree of his aggressiveness wi. Since the city turned out to be very large, Misha decided to territorially limit the actions of his series to some square s, which sides are parallel to the coordinate axes. The length of the side of the square should be an integer from 1 to min(n,m) cells.According to the plot, the main hero will come to the city and accidentally fall into the square s. Possessing a unique degree of aggressiveness 0, he will be able to show his leadership qualities and assemble a team of calm, moderate and aggressive students.In order for the assembled team to be versatile and close-knit, degrees of aggressiveness of all students of the team must be pairwise distinct and must form a single segment of consecutive integers. Formally, if there exist students with degrees of aggressiveness l,l+1,\xe2\x80\xa6,\xe2\x88\x921,1,\xe2\x80\xa6,r\xe2\x88\x921,r inside the square s, where l\xe2\x89\xa40\xe2\x89\xa4r, the main hero will be able to form a team of r\xe2\x88\x92l+1 people (of course, he is included in this team).Notice, that it is not required to take all students from square s to the team.Misha thinks that the team should consist of at least t people. That is why he is interested, how many squares are there in the table in which the main hero will be able to form a team of at least t people. Help him to calculate this." 3500
1753E "N Machines" "binary search,brute force,greedy" "You have been invited as a production process optimization specialist to some very large company. The company has n machines at its factory, standing one behind another in the production chain. Each machine can be described in one of the following two ways: (+, ai) or (\xe2\x88\x97, ai).If a workpiece with the value x is supplied to the machine of kind (+, ai), then the output workpiece has value x+ai.If a workpiece with the value x is supplied to the machine of kind (\xe2\x88\x97, ai), then the output workpiece has value x\xe2\x8b\x85ai.The whole production process is as follows. The workpiece with the value 1 is supplied to the first machine, then the workpiece obtained after the operation of the first machine is supplied to the second machine, then the workpiece obtained after the operation of the second machine is supplied to the third machine, and so on. The company is not doing very well, so now the value of the resulting product does not exceed 2\xe2\x8b\x85109.The directors of the company are not satisfied with the efficiency of the production process and have given you a budget of b coins to optimize it.To optimize production you can change the order of machines in the chain. Namely, by spending p coins, you can take any machine of kind (+, ai) and move it to any place in the chain without changing the order of other machines. Also, by spending m coins, you can take any machine of kind (\xe2\x88\x97, ai) and move it to any place in the chain.What is the maximum value of the resulting product that can be achieved if the total cost of movements that are made should not exceed b coins?" 3300
1753D "The Beach" "constructive algorithms,dfs and similar,graphs,shortest paths" "Andrew loves the sea. That\'s why, at the height of the summer season, he decided to go to the beach, taking a sunbed with him to sunbathe.The beach is a rectangular field with n rows and m columns. Some cells of the beach are free, some have roads, stones, shops and other non-movable objects. Some of two adjacent along the side cells can have sunbeds located either horizontally or vertically.Andrew hopes to put his sunbed somewhere, but that\'s a bad luck, there may no longer be free places for him! That\'s why Andrew asked you to help him to find a free place for his sunbed. Andrew\'s sunbed also should be places on two adjacent cells. If there are no two adjacent free cells, then in order to free some place for a sunbed, you will have to disturb other tourists. You can do the following actions:  Come to some sunbed and, after causing p units of discomfort to its owner, lift the sunbed by one of its sides and rotate it by 90 degrees. One half of the sunbed must remain in the same cell and another half of the sunbed must move to the free cell. At the same time, anything could be on the way of a sunbed during the rotation .  Rotation of the sunbed by 90 degrees around cell (1,2).  Come to some sunbed and, after causing q units of discomfort to its owner, shift the sunbed along its long side by one cell. One half of the sunbed must move to the place of another, and another \xe2\x80\x94 to the free cell.  Shift of the sunbed by one cell to the right. In any moment each sunbed occupies two adjacent free cells. You cannot move more than one sunbed at a time.Help Andrew to free a space for his sunbed, causing the minimum possible number of units of discomfort to other tourists, or detect that it is impossible." 2400
1753C "Wish I Knew How to Sort" dp,math,probabilities "You are given a binary array a (all elements of the array are 0 or 1) of length n. You wish to sort this array, but unfortunately, your algorithms teacher forgot to teach you sorting algorithms. You perform the following operations until a is sorted:  Choose two random indices i and j such that i<j. Indices are chosen equally probable among all pairs of indices (i,j) such that 1\xe2\x89\xa4i<j\xe2\x89\xa4n.  If ai>aj, then swap elements ai and aj. What is the expected number of such operations you will perform before the array becomes sorted?It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(mod998244353). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921mod998244353. In other words, output such an integer x that 0\xe2\x89\xa4x<998244353 and x\xe2\x8b\x85q\xe2\x89\xa1p(mod998244353)." 2000
1753B "Factorial Divisibility" "math,number theory" "You are given an integer x and an array of integers a1,a2,\xe2\x80\xa6,an. You have to determine if the number a1!+a2!+\xe2\x80\xa6+an! is divisible by x!.Here k! is a factorial of k \xe2\x80\x94 the product of all positive integers less than or equal to k. For example, 3!=1\xe2\x8b\x852\xe2\x8b\x853=6, and 5!=1\xe2\x8b\x852\xe2\x8b\x853\xe2\x8b\x854\xe2\x8b\x855=120." 1600
1753A2 "Make Nonzero Sum (hard version)" "constructive algorithms,dp,greedy" "This is the hard version of the problem. The difference is that in this version the array contains zeros. You can make hacks only if both versions of the problem are solved.You are given an array [a1,a2,\xe2\x80\xa6an] consisting of integers \xe2\x88\x921, 0 and 1. You have to build a partition of this array into the set of segments [l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk] with the following property:  Denote the alternating sum of all elements of the i-th segment as si: si = ali\xe2\x88\x92ali+1+ali+2\xe2\x88\x92ali+3+\xe2\x80\xa6\xc2\xb1ari. For example, the alternating sum of elements of segment [2,4] in array [1,0,\xe2\x88\x921,1,1] equals to 0\xe2\x88\x92(\xe2\x88\x921)+1=2.  The sum of si over all segments of partition should be equal to zero. Note that each si does not have to be equal to zero, this property is about sum of si over all segments of partition.The set of segments [l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk] is called a partition of the array a of length n if 1=l1\xe2\x89\xa4r1,l2\xe2\x89\xa4r2,\xe2\x80\xa6,lk\xe2\x89\xa4rk=n and ri+1=li+1 for all i=1,2,\xe2\x80\xa6k\xe2\x88\x921. In other words, each element of the array must belong to exactly one segment.You have to build a partition of the given array with properties described above or determine that such partition does not exist.Note that it is not required to minimize the number of segments in the partition." 1500
1753A1 "Make Nonzero Sum (easy version)" "constructive algorithms,dp,greedy" "This is the easy version of the problem. The difference is that in this version the array can not contain zeros. You can make hacks only if both versions of the problem are solved.You are given an array [a1,a2,\xe2\x80\xa6an] consisting of integers \xe2\x88\x921 and 1. You have to build a partition of this array into the set of segments [l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk] with the following property:  Denote the alternating sum of all elements of the i-th segment as si: si = ali\xe2\x88\x92ali+1+ali+2\xe2\x88\x92ali+3+\xe2\x80\xa6\xc2\xb1ari. For example, the alternating sum of elements of segment [2,4] in array [1,0,\xe2\x88\x921,1,1] equals to 0\xe2\x88\x92(\xe2\x88\x921)+1=2.  The sum of si over all segments of partition should be equal to zero. Note that each si does not have to be equal to zero, this property is about sum of si over all segments of partition.The set of segments [l1,r1],[l2,r2],\xe2\x80\xa6,[lk,rk] is called a partition of the array a of length n if 1=l1\xe2\x89\xa4r1,l2\xe2\x89\xa4r2,\xe2\x80\xa6,lk\xe2\x89\xa4rk=n and ri+1=li+1 for all i=1,2,\xe2\x80\xa6k\xe2\x88\x921. In other words, each element of the array must belong to exactly one segment.You have to build a partition of the given array with properties described above or determine that such partition does not exist.Note that it is not required to minimize the number of segments in the partition." 1300
1750H BinaryStringForces "constructive algorithms,data structures,dp" "You are given a binary string s of length n. We define a maximal substring as a substring that cannot be extended while keeping all elements equal. For example, in the string 11000111 there are three maximal substrings: 11, 000 and 111.In one operation, you can select two maximal adjacent substrings. Since they are maximal and adjacent, it\'s easy to see their elements must have different values. Let a be the length of the sequence of ones and b be the length of the sequence of zeros. Then do the following: If a\xe2\x89\xa5b, then replace b selected zeros with b ones.  If a<b, then replace a selected ones with a zeros.As an example, for 1110000 we make it 0000000, for 0011 we make it 1111. We call a string being good if it can be turned into 1111...1111 using the aforementioned operation any number of times (possibly, zero). Find the number of good substrings among all n(n+1)2 non-empty substrings of s." 3500
1750G Doping combinatorics,dp,math "We call an array a of length n fancy if for each 1<i\xe2\x89\xa4n it holds that ai=ai\xe2\x88\x921+1.Let\'s call f(p) applied to a permutation\xe2\x80\xa0 of length n as the minimum number of subarrays it can be partitioned such that each one of them is fancy. For example f([1,2,3])=1, while f([3,1,2])=2 and f([3,2,1])=3.Given n and a permutation p of length n, we define a permutation p\xe2\x80\xb2 of length n to be k-special if and only if:  p\xe2\x80\xb2 is lexicographically smaller\xe2\x80\xa1 than p, and  f(p\xe2\x80\xb2)=k. Your task is to count for each 1\xe2\x89\xa4k\xe2\x89\xa4n the number of k-special permutations modulo m.\xe2\x80\xa0 A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).\xe2\x80\xa1 A permutation a of length n is lexicographically smaller than a permutation b of length n if and only if the following holds: in the first position where a and b differ, the permutation a has a smaller element than the corresponding element in b." 3300
1750F Majority combinatorics,dp,math,strings "Everyone was happy coding, until suddenly a power shortage happened and the best competitive programming site went down. Fortunately, a system administrator bought some new equipment recently, including some UPSs. Thus there are some servers that are still online, but we need all of them to be working in order to keep the round rated.Imagine the servers being a binary string s of length n. If the i-th server is online, then si=1, and si=0 otherwise.A system administrator can do the following operation called electricity spread, that consists of the following phases:   Select two servers at positions 1\xe2\x89\xa4i<j\xe2\x89\xa4n such that both are online (i.e. si=sj=1). The spread starts only from online servers.  Check if we have enough power to make the spread. We consider having enough power if the number of turned on servers in range [i,j] is at least the number of turned off servers in range [i,j]. More formally, check whether 2\xe2\x8b\x85(si+si+1+\xe2\x80\xa6+sj)\xe2\x89\xa5j\xe2\x88\x92i+1. If the check is positive, turn on all the offline servers in range [i,j]. More formally, make sk:=1 for all k from i to j. We call a binary string s of length n rated if we can turn on all servers (i.e. make si=1 for 1\xe2\x89\xa4i\xe2\x89\xa4n) using the electricity spread operation any number of times (possibly, 0). Your task is to find the number of rated strings of length n modulo m." 2700
1750E "Bracket Cost" "binary search,data structures,divide and conquer,dp,greedy,strings" "Daemon Targaryen decided to stop looking like a Metin2 character. He turned himself into the most beautiful thing, a bracket sequence.For a bracket sequence, we can do two kind of operations:  Select one of its substrings\xe2\x80\xa0 and cyclic shift it to the right. For example, after a cyclic shift to the right, ""(())"" will become "")(()"";  Insert any bracket, opening \'(\' or closing \')\', wherever you want in the sequence. We define the cost of a bracket sequence as the minimum number of such operations to make it balanced\xe2\x80\xa1.Given a bracket sequence s of length n, find the sum of costs across all its n(n+1)2 non-empty substrings. Note that for each substring we calculate the cost independently.\xe2\x80\xa0 A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.\xe2\x80\xa1 A sequence of brackets is called balanced if one can turn it into a valid math expression by adding characters + and 1. For example, sequences ""(())()"", ""()"", and ""(()(()))"" are balanced, while "")("", ""(()"", and ""(()))("" are not." 2400
1750D "Count GCD" "combinatorics,math,number theory" "You are given two integers n and m and an array a of n integers. For each 1\xe2\x89\xa4i\xe2\x89\xa4n it holds that 1\xe2\x89\xa4ai\xe2\x89\xa4m.Your task is to count the number of different arrays b of length n such that:   1\xe2\x89\xa4bi\xe2\x89\xa4m for each 1\xe2\x89\xa4i\xe2\x89\xa4n, and  gcd(b1,b2,b3,...,bi)=ai for each 1\xe2\x89\xa4i\xe2\x89\xa4n. Here gcd(a1,a2,\xe2\x80\xa6,ai) denotes the greatest common divisor (GCD) of integers a1,a2,\xe2\x80\xa6,ai.Since this number can be too large, print it modulo 998244353." 1800
1750C "Complementary XOR" "constructive algorithms,implementation" "You have two binary strings a and b of length n. You would like to make all the elements of both strings equal to 0. Unfortunately, you can modify the contents of these strings using only the following operation:  You choose two indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n);  For every i that respects l\xe2\x89\xa4i\xe2\x89\xa4r, change ai to the opposite. That is, ai:=1\xe2\x88\x92ai;  For every i that respects either 1\xe2\x89\xa4i<l or r<i\xe2\x89\xa4n, change bi to the opposite. That is, bi:=1\xe2\x88\x92bi. Your task is to determine if this is possible, and if it is, to find such an appropriate chain of operations. The number of operations should not exceed n+5. It can be proven that if such chain of operations exists, one exists with at most n+5 operations." 1400
1750B "Maximum Substring" "brute force,greedy,implementation" "A binary string is a string consisting only of the characters 0 and 1. You are given a binary string s.For some non-empty substring\xe2\x80\xa0 t of string s containing x characters 0 and y characters 1, define its cost as:  x\xe2\x8b\x85y, if x>0 and y>0;  x2, if x>0 and y=0;  y2, if x=0 and y>0. Given a binary string s of length n, find the maximum cost across all its non-empty substrings.\xe2\x80\xa0 A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end." 800
1750A "Indirect Sort" "constructive algorithms,implementation,math" "You are given a permutation a1,a2,\xe2\x80\xa6,an of size n, where each integer from 1 to n appears exactly once.You can do the following operation any number of times (possibly, zero):  Choose any three indices i,j,k (1\xe2\x89\xa4i<j<k\xe2\x89\xa4n).  If ai>ak, replace ai with ai+aj. Otherwise, swap aj and ak. Determine whether you can make the array a sorted in non-descending order." 800
1749F "Distance to the Path" "data structures,dfs and similar,trees" "You are given a tree consisting of nn vertices. Initially, each vertex has a value 00.You need to perform mm queries of two types:   You are given a vertex index vv. Print the value of the vertex vv.  You are given two vertex indices uu and vv and values kk and dd (d\xe2\x89\xa420d\xe2\x89\xa420). You need to add kk to the value of each vertex such that the distance from that vertex to the path from uu to vv is less than or equal to dd. The distance between two vertices xx and yy is equal to the number of edges on the path from xx to yy. For example, the distance from xx to xx itself is equal to 00.The distance from the vertex vv to some path from xx to yy is equal to the minimum among distances from vv to any vertex on the path from xx to yy." 2800
1749E "Cactus Wall" "constructive algorithms,dfs and similar,graphs,shortest paths" "Monocarp is playing Minecraft and wants to build a wall of cacti. He wants to build it on a field of sand of the size of n\xc3\x97m cells. Initially, there are cacti in some cells of the field. Note that, in Minecraft, cacti cannot grow on cells adjacent to each other by side \xe2\x80\x94 and the initial field meets this restriction. Monocarp can plant new cacti (they must also fulfil the aforementioned condition). He can\'t chop down any of the cacti that are already growing on the field \xe2\x80\x94 he doesn\'t have an axe, and the cacti are too prickly for his hands.Monocarp believes that the wall is complete if there is no path from the top row of the field to the bottom row, such that:   each two consecutive cells in the path are adjacent by side;  no cell belonging to the path contains a cactus. Your task is to plant the minimum number of cacti to build a wall (or to report that this is impossible)." 2400
1749D "Counting Arrays" "combinatorics,dp,math,number theory" "Consider an array a of length n with elements numbered from 1 to n. It is possible to remove the i-th element of a if gcd(ai,i)=1, where gcd denotes the greatest common divisor. After an element is removed, the elements to the right are shifted to the left by one position.An array b with n integers such that 1\xe2\x89\xa4bi\xe2\x89\xa4n\xe2\x88\x92i+1 is a removal sequence for the array a if it is possible to remove all elements of a, if you remove the b1-th element, then the b2-th, ..., then the bn-th element. For example, let a=[42,314]:  [1,1] is a removal sequence: when you remove the 1-st element of the array, the condition gcd(42,1)=1 holds, and the array becomes [314]; when you remove the 1-st element again, the condition gcd(314,1)=1 holds, and the array becomes empty.  [2,1] is not a removal sequence: when you try to remove the 2-nd element, the condition gcd(314,2)=1 is false. An array is ambiguous if it has at least two removal sequences. For example, the array [1,2,5] is ambiguous: it has removal sequences [3,1,1] and [1,2,1]. The array [42,314] is not ambiguous: the only removal sequence it has is [1,1].You are given two integers n and m. You have to calculate the number of ambiguous arrays a such that the length of a is from 1 to n and each ai is an integer from 1 to m." 1900
1749C "Number Game" "binary search,data structures,games,greedy,implementation" "Alice and Bob are playing a game. They have an array of positive integers a of size n.Before starting the game, Alice chooses an integer k\xe2\x89\xa50. The game lasts for k stages, the stages are numbered from 1 to k. During the i-th stage, Alice must remove an element from the array that is less than or equal to k\xe2\x88\x92i+1. After that, if the array is not empty, Bob must add k\xe2\x88\x92i+1 to an arbitrary element of the array. Note that both Alice\'s move and Bob\'s move are two parts of the same stage of the game. If Alice can\'t delete an element during some stage, she loses. If the k-th stage ends and Alice hasn\'t lost yet, she wins.Your task is to determine the maximum value of k such that Alice can win if both players play optimally. Bob plays against Alice, so he tries to make her lose the game, if it\'s possible." 1400
1749B "Death\'s Blessing" greedy "You are playing a computer game. To pass the current level, you have to kill a big horde of monsters. In this horde, there are n monsters standing in the row, numbered from 1 to n. The i-th monster has ai health and a special ""Death\'s Blessing"" spell of strength bi attached to it.You are going to kill all of them one by one. It takes exactly h seconds to kill a monster with health h.When the i-th monster dies, it casts its spell that increases the health of its neighbors by bi (the neighbors of the j-th monster in the row are the monsters on places j\xe2\x88\x921 and j+1. The first and the last monsters have only one neighbor each).After each monster is killed, the row shrinks, so its former neighbors become adjacent to each other (so if one of them dies, the other one is affected by its spell). For example, imagine a situation with 4 monsters with health a=[2,6,7,3] and spells b=[3,6,0,5]. One of the ways to get rid of the monsters is shown below:  26736 s\xe2\x86\x92813313 s\xe2\x86\x92838 s\xe2\x86\x9266 s\xe2\x86\x92{}3605305355 The first row represents the health of each monster, the second one \xe2\x80\x94 the power of the spells. As a result, we can kill all monsters in 6+13+8+6 = 33 seconds. Note that it\'s only an example and may not be the fastest way to get rid of the monsters.What is the minimum time required to kill all monsters in the row?" 900
1749A "Cowardly Rooks" greedy,implementation "There\'s a chessboard of size n\xc3\x97n. m rooks are placed on it in such a way that:   no two rooks occupy the same cell;  no two rooks attack each other. A rook attacks all cells that are in its row or column.Is it possible to move exactly one rook (you can choose which one to move) into a different cell so that no two rooks still attack each other? A rook can move into any cell in its row or column if no other rook stands on its path." 800
1748F "Circular Xor Reversal" "bitmasks,constructive algorithms" "You have an array a0,a1,\xe2\x80\xa6,an\xe2\x88\x921 of length n. Initially, ai=2i for all 0\xe2\x89\xa4i<n. Note that array a is zero-indexed. You want to reverse this array (that is, make ai equal to 2n\xe2\x88\x921\xe2\x88\x92i for all 0\xe2\x89\xa4i<n). To do this, you can perform the following operation no more than 250000 times:  Select an integer i (0\xe2\x89\xa4i<n) and replace ai by ai\xe2\x8a\x95a(i+1)modn. Here, \xe2\x8a\x95 denotes the bitwise XOR operation.Your task is to find any sequence of operations that will result in the array a being reversed. It can be shown that under the given constraints, a solution always exists." 3000
1748E "Yet Another Array Counting Problem" "binary search,data structures,divide and conquer,dp,flows,math,trees" "The position of the leftmost maximum on the segment [l;r] of array x=[x1,x2,\xe2\x80\xa6,xn] is the smallest integer i such that l\xe2\x89\xa4i\xe2\x89\xa4r and xi=max(xl,xl+1,\xe2\x80\xa6,xr).You are given an array a=[a1,a2,\xe2\x80\xa6,an] of length n. Find the number of integer arrays b=[b1,b2,\xe2\x80\xa6,bn] of length n that satisfy the following conditions:   1\xe2\x89\xa4bi\xe2\x89\xa4m for all 1\xe2\x89\xa4i\xe2\x89\xa4n;  for all pairs of integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, the position of the leftmost maximum on the segment [l;r] of the array b is equal to the position of the leftmost maximum on the segment [l;r] of the array a. Since the answer might be very large, print its remainder modulo 109+7." 2300
1748D ConstructOR "bitmasks,chinese remainder theorem,combinatorics,constructive algorithms,math,number theory" "You are given three integers a, b, and d. Your task is to find any integer x which satisfies all of the following conditions, or determine that no such integers exist:  0\xe2\x89\xa4x<260;  a|x is divisible by d;  b|x is divisible by d. Here, | denotes the bitwise OR operation." 2100
1748C "Zero-Sum Prefixes" "brute force,data structures,dp,greedy,implementation" "The score of an array v1,v2,\xe2\x80\xa6,vn is defined as the number of indices i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that v1+v2+\xe2\x80\xa6+vi=0.You are given an array a1,a2,\xe2\x80\xa6,an of length n. You can perform the following operation multiple times:  select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) such that ai=0;  then replace ai by an arbitrary integer.  What is the maximum possible score of a that can be obtained by performing a sequence of such operations?" 1600
1748B "Diverse Substrings" "brute force,implementation,strings" "A non-empty digit string is diverse if the number of occurrences of each character in it doesn\'t exceed the number of distinct characters in it.For example:   string ""7"" is diverse because 7 appears in it 1 time and the number of distinct characters in it is 1;  string ""77"" is not diverse because 7 appears in it 2 times and the number of distinct characters in it is 1;  string ""1010"" is diverse because both 0 and 1 appear in it 2 times and the number of distinct characters in it is 2;  string ""6668"" is not diverse because 6 appears in it 3 times and the number of distinct characters in it is 2. You are given a string s of length n, consisting of only digits 0 to 9. Find how many of its n(n+1)2 substrings are diverse.A string a is a substring of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.Note that if the same diverse string appears in s multiple times, each occurrence should be counted independently. For example, there are two diverse substrings in ""77"" both equal to ""7"", so the answer for the string ""77"" is 2." 1400
1748A "The Ultimate Square" math "You have n rectangular wooden blocks, which are numbered from 1 to n. The i-th block is 1 unit high and \xe2\x8c\x88i2\xe2\x8c\x89 units long.Here, \xe2\x8c\x88x2\xe2\x8c\x89 denotes the result of division of x by 2, rounded up. For example, \xe2\x8c\x8842\xe2\x8c\x89=2 and \xe2\x8c\x8852\xe2\x8c\x89=\xe2\x8c\x882.5\xe2\x8c\x89=3.For example, if n=5, then the blocks have the following sizes: 1\xc3\x971, 1\xc3\x971, 1\xc3\x972, 1\xc3\x972, 1\xc3\x973.  The available blocks for n=5 Find the maximum possible side length of a square you can create using these blocks, without rotating any of them. Note that you don\'t have to use all of the blocks.  One of the ways to create 3\xc3\x973 square using blocks 1 through 5" 800
1747E "List Generation" combinatorics,dp,math "For given integers n and m, let\'s call a pair of arrays a and b of integers good, if they satisfy the following conditions:   a and b have the same length, let their length be k. k\xe2\x89\xa52 and a1=0,ak=n,b1=0,bk=m. For each 1<i\xe2\x89\xa4k the following holds: ai\xe2\x89\xa5ai\xe2\x88\x921, bi\xe2\x89\xa5bi\xe2\x88\x921, and ai+bi\xe2\x89\xa0ai\xe2\x88\x921+bi\xe2\x88\x921.Find the sum of |a| over all good pairs of arrays (a,b). Since the answer can be very large, output it modulo 109+7." 2900
1747D "Yet Another Problem" "binary search,bitmasks,constructive algorithms,data structures" "You are given an array a of n integers a1,a2,a3,\xe2\x80\xa6,an.You have to answer q independent queries, each consisting of two integers l and r.   Consider the subarray a[l:r] = [al,al+1,\xe2\x80\xa6,ar]. You can apply the following operation to the subarray any number of times (possibly zero)-   Choose two integers L, R such that l\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4r and R\xe2\x88\x92L+1 is odd.  Replace each element in the subarray from L to R with the XOR of the elements in the subarray [L,R].   The answer to the query is the minimum number of operations required to make all elements of the subarray a[l:r] equal to 0 or \xe2\x88\x921 if it is impossible to make all of them equal to 0. You can find more details about XOR operation here." 1900
1747C "Swap Game" games "Alice and Bob are playing a game on an array a of n positive integers. Alice and Bob make alternating moves with Alice going first.In his/her turn, the player makes the following move: If a1=0, the player loses the game, otherwise: Player chooses some i with 2\xe2\x89\xa4i\xe2\x89\xa4n. Then player decreases the value of a1 by 1 and swaps a1 with ai. Determine the winner of the game if both players play optimally." 1200
1747B "BAN BAN" "constructive algorithms" "You are given an integer n.Let\'s define s(n) as the string ""BAN"" concatenated n times. For example, s(1) = ""BAN"", s(3) = ""BANBANBAN"". Note that the length of the string s(n) is equal to 3n.Consider s(n). You can perform the following operation on s(n) any number of times (possibly zero): Select any two distinct indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa43n,i\xe2\x89\xa0j). Then, swap s(n)i and s(n)j. You want the string ""BAN"" to not appear in s(n) as a subsequence. What\'s the smallest number of operations you have to do to achieve this? Also, find one such shortest sequence of operations.A string a is a subsequence of a string b if a can be obtained from b by deletion of several (possibly, zero or all) characters." 900
1747A "Two Groups" "constructive algorithms,greedy" "You are given an array a consisting of n integers. You want to distribute these n integers into two groups s1 and s2 (groups can be empty) so that the following conditions are satisfied:  For each i (1\xe2\x89\xa4i\xe2\x89\xa4n), ai goes into exactly one group. The value |sum(s1)|\xe2\x88\x92|sum(s2)| is the maximum possible among all such ways to distribute the integers.Here sum(s1) denotes the sum of the numbers in the group s1, and sum(s2) denotes the sum of the numbers in the group s2.Determine the maximum possible value of |sum(s1)|\xe2\x88\x92|sum(s2)|." 800
1746G "Olympiad Training" "binary search,data structures,dp,flows,geometry,implementation,sortings" "Anton decided to get ready for an Olympiad in Informatics. Ilya prepared n tasks for him to solve. It is possible to submit the solution for the i-th task in the first di days only. Anton cannot solve more than one task a day. Ilya estimated the usefulness of the i-th tasks as ri and divided the tasks into three topics, the topic of the i-th task is typei.Anton wants to solve exactly a tasks on the first topic, b tasks on the second topic and c tasks on the third topic. Tell Anton if it is possible to do so, and if it is, calculate the maximum total usefulness of the tasks he may solve." 3500
1746F Kazaee "data structures,hashing,probabilities" "You have an array a consisting of n positive integers and you have to handle q queries of the following types:  1 i x: change ai to x,  2 l r k: check if the number of occurrences of every positive integer in the subarray al,al+1,\xe2\x80\xa6ar is a multiple of k (check the example for better understanding)." 2800
1746E2 "Joking (Hard Version)" dp,interactive "The only difference between this problem and the hard version is the maximum number of questions.This is an interactive problem.There is a hidden integer 1\xe2\x89\xa4x\xe2\x89\xa4n which you have to find. In order to find it you can ask at most 53 questions.In each question you can choose a non-empty integer set S and ask if x belongs to S or not, after each question, if x belongs to S, you\'ll receive ""YES"", otherwise ""NO"".But the problem is that not all answers are necessarily true (some of them are joking), it\'s just guaranteed that for each two consecutive questions, at least one of them is answered correctly.Additionally to the questions, you can make at most 2 guesses for the answer x. Each time you make a guess, if you guess x correctly, you receive "":)"" and your program should terminate, otherwise you\'ll receive "":("".As a part of the joking, we will not fix the value of x in the beginning. Instead, it can change throughout the interaction as long as all the previous responses are valid as described above.Note that your answer guesses are always answered correctly. If you ask a question before and after a guess, at least one of these two questions is answered correctly, as normal." 3200
1746E1 "Joking (Easy Version)" "binary search,constructive algorithms,interactive,ternary search" "The only difference between this problem and the hard version is the maximum number of questions.This is an interactive problem.There is a hidden integer 1\xe2\x89\xa4x\xe2\x89\xa4n which you have to find. In order to find it you can ask at most 82 questions.In each question you can choose a non-empty integer set S and ask if x belongs to S or not, after each question, if x belongs to S, you\'ll receive ""YES"", otherwise ""NO"".But the problem is that not all answers are necessarily true (some of them are joking), it\'s just guaranteed that for each two consecutive questions, at least one of them is answered correctly.Additionally to the questions, you can make at most 2 guesses for the answer x. Each time you make a guess, if you guess x correctly, you receive "":)"" and your program should terminate, otherwise you\'ll receive "":("".As a part of the joking, we will not fix the value of x in the beginning. Instead, it can change throughout the interaction as long as all the previous responses are valid as described above.Note that your answer guesses are always answered correctly. If you ask a question before and after a guess, at least one of these two questions is answered correctly, as normal." 2500
1746D "Paths on the Tree" "dfs and similar,dp,greedy,sortings,trees" "You are given a rooted tree consisting of n vertices. The vertices are numbered from 1 to n, and the root is the vertex 1. You are also given a score array s1,s2,\xe2\x80\xa6,sn.A multiset of k simple paths is called valid if the following two conditions are both true.   Each path starts from 1.  Let ci be the number of paths covering vertex i. For each pair of vertices (u,v) (2\xe2\x89\xa4u,v\xe2\x89\xa4n) that have the same parent, |cu\xe2\x88\x92cv|\xe2\x89\xa41 holds.  The value of the path multiset is defined as n\xe2\x88\x91i=1cisi.It can be shown that it is always possible to find at least one valid multiset. Find the maximum value among all valid multisets." 1900
1746C "Permutation Operations" "constructive algorithms,greedy,implementation,math" "You are given a permutation a of size n and you should perform n operations on it. In the i-th operation, you can choose a non-empty suffix of a and increase all of its elements by i. How can we perform the operations to minimize the number of inversions in the final array?Note that you can perform operations on the same suffix any number of times you want.A permutation of size n is an array of size n such that each integer from 1 to n occurs exactly once in this array. A suffix is several consecutive elements of an array that include the last element of the array. An inversion in an array a is a pair of indices (i,j) such that i>j and ai<aj." 1300
1746B Rebellion "constructive algorithms,greedy,two pointers" "You have an array a of size n consisting only of zeroes and ones. You can do the following operation:  choose two indices 1\xe2\x89\xa4i,j\xe2\x89\xa4n, i\xe2\x89\xa0j,  add ai to aj,  remove ai from a. Note that elements of a can become bigger than 1 after performing some operations. Also note that n becomes 1 less after the operation.What is the minimum number of operations needed to make a non-decreasing, i. e. that each element is not less than the previous element?" 800
1746A Maxmina "constructive algorithms,greedy" "You have an array a of size n consisting only of zeroes and ones and an integer k. In one operation you can do one of the following:  Select 2 consecutive elements of a and replace them with their minimum (that is, let a:=[a1,a2,\xe2\x80\xa6,ai\xe2\x88\x921,min(ai,ai+1),ai+2,\xe2\x80\xa6,an] for some 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921). This operation decreases the size of a by 1.  Select k consecutive elements of a and replace them with their maximum (that is, let a:=[a1,a2,\xe2\x80\xa6,ai\xe2\x88\x921,max(ai,ai+1,\xe2\x80\xa6,ai+k\xe2\x88\x921),ai+k,\xe2\x80\xa6,an] for some 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x92k+1). This operation decreases the size of a by k\xe2\x88\x921. Determine if it\'s possible to turn a into [1] after several (possibly zero) operations." 800
1744F "MEX vs MED" "math,two pointers" "You are given a permutation p1,p2,\xe2\x80\xa6,pn of length n of numbers 0,\xe2\x80\xa6,n\xe2\x88\x921. Count the number of subsegments 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n of this permutation such that mex(pl,pl+1,\xe2\x80\xa6,pr)>med(pl,pl+1,\xe2\x80\xa6,pr).mex of S is the smallest non-negative integer that does not occur in S. For example: mex(0,1,2,3)=4 mex(0,4,1,3)=2 mex(5,4,0,1,2)=3med of the set S is the median of the set, i.e. the element that, after sorting the elements in non-decreasing order, will be at position number \xe2\x8c\x8a|S|+12\xe2\x8c\x8b (array elements are numbered starting from 1 and here \xe2\x8c\x8av\xe2\x8c\x8b denotes rounding v down.). For example: med(0,1,2,3)=1 med(0,4,1,3)=1 med(5,4,0,1,2)=2A sequence of n numbers is called a permutation if it contains all the numbers from 0 to n\xe2\x88\x921 exactly once." 2000
1744E2 "Divisible Numbers (hard version)" "brute force,math,number theory" "This is an hard version of the problem. The only difference between an easy and a hard version is the constraints on a, b, c and d.You are given 4 positive integers a, b, c, d with a<c and b<d. Find any pair of numbers x and y that satisfies the following conditions: a<x\xe2\x89\xa4c, b<y\xe2\x89\xa4d, x\xe2\x8b\x85y is divisible by a\xe2\x8b\x85b.Note that required x and y may not exist." 1900
1744E1 "Divisible Numbers (easy version)" "brute force,math,number theory" "This is an easy version of the problem. The only difference between an easy and a hard version is the constraints on a, b, c and d.You are given 4 positive integers a, b, c, d with a<c and b<d. Find any pair of numbers x and y that satisfies the following conditions: a<x\xe2\x89\xa4c, b<y\xe2\x89\xa4d, x\xe2\x8b\x85y is divisible by a\xe2\x8b\x85b.Note that required x and y may not exist." 1500
1744D "Divisibility by 2^n" greedy,math,sortings "You are given an array of positive integers a1,a2,\xe2\x80\xa6,an.Make the product of all the numbers in the array (that is, a1\xe2\x8b\x85a2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85an) divisible by 2n.You can perform the following operation as many times as you like:  select an arbitrary index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace the value ai with ai=ai\xe2\x8b\x85i. You cannot apply the operation repeatedly to a single index. In other words, all selected values of i must be different.Find the smallest number of operations you need to perform to make the product of all the elements in the array divisible by 2n. Note that such a set of operations does not always exist." 1200
1744C "Traffic Light" "binary search,implementation,two pointers" "You find yourself on an unusual crossroad with a weird traffic light. That traffic light has three possible colors: red (r), yellow (y), green (g). It is known that the traffic light repeats its colors every n seconds and at the i-th second the color si is on.That way, the order of the colors is described by a string. For example, if s=""rggry"", then the traffic light works as the following: red-green-green-red-yellow-red-green-green-red-yellow- ... and so on.More formally, you are given a string s1,s2,\xe2\x80\xa6,sn of length n. At the first second the color s1 is on, at the second \xe2\x80\x94 s2, ..., at the n-th second the color sn is on, at the n+1-st second the color s1 is on and so on.You need to cross the road and that can only be done when the green color is on. You know which color is on the traffic light at the moment, but you don\'t know the current moment of time. You need to find the minimum amount of time in which you are guaranteed to cross the road.You can assume that you cross the road immediately. For example, with s=""rggry"" and the current color r there are two options: either the green color will be on after 1 second, or after 3. That way, the answer is equal to 3 \xe2\x80\x94 that is the number of seconds that we are guaranteed to cross the road, if the current color is r." 1000
1744B "Even-Odd Increments" implementation,math "You are given n of integers a1,a2,\xe2\x80\xa6,an. Process q queries of two types: query of the form ""0 xj"": add the value xj to all even elements of the array a, query of the form ""1 xj"": add the value xj to all odd elements of the array a.Note that when processing the query, we look specifically at the odd/even value of ai, not its index.After processing each query, print the sum of the elements of the array a.Please note that the answer for some test cases won\'t fit into 32-bit integer type, so you should use at least 64-bit integer type in your programming language (like long long for C++)." 800
1744A "Number Replacement" greedy,implementation "An integer array a1,a2,\xe2\x80\xa6,an is being transformed into an array of lowercase English letters using the following prodecure:While there is at least one number in the array:   Choose any number x from the array a, and any letter of the English alphabet y.  Replace all occurrences of number x with the letter y. For example, if we initially had an array a=[2,3,2,4,1], then we could transform it the following way:  Choose the number 2 and the letter c. After that a=[c,3,c,4,1].  Choose the number 3 and the letter a. After that a=[c,a,c,4,1].  Choose the number 4 and the letter t. After that a=[c,a,c,t,1].  Choose the number 1 and the letter a. After that a=[c,a,c,t,a]. After the transformation all letters are united into a string, in our example we get the string ""cacta"".Having the array a and the string s determine if the string s could be got from the array a after the described transformation?" 800
1743G "Antifibonacci Cut" "bitmasks,combinatorics,constructive algorithms,data structures,dp,hashing,math" "Note that the memory limit is unusual.Let\'s define the sequence of Fibonacci strings as follows: f0 is 0, f1 is 1, fi is fi\xe2\x88\x921+fi\xe2\x88\x922 for i>1 (+ denotes the concatenation of two strings). So, for example, f2 is 10, f3 is 101, f4 is 10110.For a given string s, let\'s define g(s) as the number of ways to cut it into several (any number, possibly even just one) strings such that none of these strings are Fibonacci strings. For example, if s is 10110101, g(s)=3 since there are three ways to cut it:  101101 + 01;  1011 + 0101;  1011 + 01 + 01. You are given a sequence of strings s1,s2,\xe2\x80\xa6,sn. Calculate g(s1),g(s1+s2),\xe2\x80\xa6,g(s1+s2+\xe2\x80\xa6+sn). Since these values can be huge, print them modulo 998244353." 3000
1743F "Intersection and Union" "data structures,dp,matrices,probabilities" "You are given n segments on the coordinate axis. The i-th segment is [li,ri]. Let\'s denote the set of all integer points belonging to the i-th segment as Si.Let A\xe2\x88\xaaB be the union of two sets A and B, A\xe2\x88\xa9B be the intersection of two sets A and B, and A\xe2\x8a\x95B be the symmetric difference of A and B (a set which contains all elements of A and all elements of B, except for the ones that belong to both sets).Let [op1,op2,\xe2\x80\xa6,opn\xe2\x88\x921] be an array where each element is either \xe2\x88\xaa, \xe2\x8a\x95, or \xe2\x88\xa9. Over all 3n\xe2\x88\x921 ways to choose this array, calculate the sum of the following values:|(((S1 op1 S2) op2 S3) op3 S4) \xe2\x80\xa6 opn\xe2\x88\x921 Sn|In this expression, |S| denotes the size of the set S." 2300
1743E FTL "binary search,dp" "Monocarp is playing a video game. In the game, he controls a spaceship and has to destroy an enemy spaceship.Monocarp has two lasers installed on his spaceship. Both lasers 1 and 2 have two values:   pi \xe2\x80\x94 the power of the laser;  ti \xe2\x80\x94 the reload time of the laser. When a laser is fully charged, Monocarp can either shoot it or wait for the other laser to charge and shoot both of them at the same time.An enemy spaceship has h durability and s shield capacity. When Monocarp shoots an enemy spaceship, it receives (P\xe2\x88\x92s) damage (i.\xe2\x80\x89e. (P\xe2\x88\x92s) gets subtracted from its durability), where P is the total power of the lasers that Monocarp shoots (i.\xe2\x80\x89e. pi if he only shoots laser i and p1+p2 if he shoots both lasers at the same time). An enemy spaceship is considered destroyed when its durability becomes 0 or lower.Initially, both lasers are zero charged.What\'s the lowest amount of time it can take Monocarp to destroy an enemy spaceship?" 2400
1743D "Problem with Random Tests" "brute force,dp,greedy,probabilities" "You are given a string s consisting of n characters. Each character of s is either 0 or 1.A substring of s is a contiguous subsequence of its characters.You have to choose two substrings of s (possibly intersecting, possibly the same, possibly non-intersecting \xe2\x80\x94 just any two substrings). After choosing them, you calculate the value of the chosen pair of substrings as follows:  let s1 be the first substring, s2 be the second chosen substring, and f(si) be the integer such that si is its binary representation (for example, if si is 11010, f(si)=26);  the value is the bitwise OR of f(s1) and f(s2). Calculate the maximum possible value you can get, and print it in binary representation without leading zeroes." 1700
1743C "Save the Magazines" "constructive algorithms,dp,greedy" "Monocarp has been collecting rare magazines for quite a while, and now he has decided to sell them. He distributed the magazines between n boxes, arranged in a row. The i-th box contains ai magazines. Some of the boxes are covered with lids, others are not. Suddenly it started to rain, and now Monocarp has to save as many magazines from the rain as possible. To do this, he can move the lids between boxes as follows: if the i-th box was covered with a lid initially, he can either move the lid from the i-th box to the box (i\xe2\x88\x921) (if it exists), or keep the lid on the i-th box. You may assume that Monocarp can move the lids instantly at the same moment, and no lid can be moved more than once. If a box will be covered with a lid after Monocarp moves the lids, the magazines in it will be safe from the rain; otherwise they will soak.You have to calculate the maximum number of magazines Monocarp can save from the rain." 1100
1743B "Permutation Value" "constructive algorithms,greedy" "You are given an integer n. You have to construct a permutation of size n.A permutation is an array where each integer from 1 to s (where s is the size of permutation) occurs exactly once. For example, [2,1,4,3] is a permutation of size 4; [1,2,4,5,3] is a permutation of size 5; [1,4,3] is not a permutation (the integer 2 is absent), [2,1,3,1] is not a permutation (the integer 1 appears twice).A subsegment of a permutation is a contiguous subsequence of that permutation. For example, the permutation [2,1,4,3] has 10 subsegments: [2], [2,1], [2,1,4], [2,1,4,3], [1], [1,4], [1,4,3], [4], [4,3] and [3].The value of the permutation is the number of its subsegments which are also permutations. For example, the value of [2,1,4,3] is 3 since the subsegments [2,1], [1] and [2,1,4,3] are permutations.You have to construct a permutation of size n with minimum possible value among all permutations of size n." 800
1743A Password "brute force,combinatorics,implementation,math" "Monocarp has forgotten the password to his mobile phone. The password consists of 4 digits from 0 to 9 (note that it can start with the digit 0).Monocarp remembers that his password had exactly two different digits, and each of these digits appeared exactly two times in the password. Monocarp also remembers some digits which were definitely not used in the password.You have to calculate the number of different sequences of 4 digits that could be the password for Monocarp\'s mobile phone (i.\xe2\x80\x89e. these sequences should meet all constraints on Monocarp\'s password)." 800
1742G Orray "bitmasks,brute force,greedy,math,sortings" "You are given an array a consisting of n nonnegative integers. Let\'s define the prefix OR array b as the array bi=a1 OR a2 OR \xe2\x80\xa6 OR ai, where OR represents the bitwise OR operation. In other words, the array b is formed by computing the OR of every prefix of a.You are asked to rearrange the elements of the array a in such a way that its prefix OR array is lexicographically maximum.An array x is lexicographically greater than an array y if in the first position where x and y differ, xi>yi." 1500
1742F Smaller "constructive algorithms,greedy,strings" "Alperen has two strings, s and t which are both initially equal to ""a"". He will perform q operations of two types on the given strings:  1kx \xe2\x80\x94 Append the string x exactly k times at the end of string s. In other words, s:=s+x+\xe2\x8b\xaf+x\xe2\x8f\x9fk times.  2kx \xe2\x80\x94 Append the string x exactly k times at the end of string t. In other words, t:=t+x+\xe2\x8b\xaf+x\xe2\x8f\x9fk times. After each operation, determine if it is possible to rearrange the characters of s and t such that s is lexicographically smaller\xe2\x80\xa0 than t.Note that the strings change after performing each operation and don\'t go back to their initial states.\xe2\x80\xa0 Simply speaking, the lexicographical order is the order in which words are listed in a dictionary. A formal definition is as follows: string p is lexicographically smaller than string q if there exists a position i such that pi<qi, and for all j<i, pj=qj. If no such i exists, then p is lexicographically smaller than q if the length of p is less than the length of q. For example, abdc<abe and abc<abcd, where we write p<q if p is lexicographically smaller than q." 1500
1742E Scuza "binary search,greedy,math" "Timur has a stairway with n steps. The i-th step is ai meters higher than its predecessor. The first step is a1 meters higher than the ground, and the ground starts at 0 meters.   The stairs for the first test case. Timur has q questions, each denoted by an integer k1,\xe2\x80\xa6,kq. For each question ki, you have to print the maximum possible height Timur can achieve by climbing the steps if his legs are of length ki. Timur can only climb the j-th step if his legs are of length at least aj. In other words, ki\xe2\x89\xa5aj for each step j climbed.Note that you should answer each question independently." 1200
1742D Coprime "brute force,greedy,number theory" "Given an array of n positive integers a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa41000). Find the maximum value of i+j such that ai and aj are coprime,\xe2\x80\xa0 or \xe2\x88\x921 if no such i, j exist.For example consider the array [1,3,5,2,4,7,7]. The maximum value of i+j that can be obtained is 5+7, since a5=4 and a7=7 are coprime.\xe2\x80\xa0 Two integers p and q are coprime if the only positive integer that is a divisor of both of them is 1 (that is, their greatest common divisor is 1)." 1100
1742C Stripes implementation "On an 8\xc3\x978 grid, some horizontal rows have been painted red, and some vertical columns have been painted blue, in some order. The stripes are drawn sequentially, one after the other. When the stripe is drawn, it repaints all the cells through which it passes.Determine which color was used last.  The red stripe was painted after the blue one, so the answer is R." 900
1742B Increasing greedy,implementation,sortings "You are given an array a of n positive integers. Determine if, by rearranging the elements, you can make the array strictly increasing. In other words, determine if it is possible to rearrange the elements such that a1<a2<\xe2\x8b\xaf<an holds." 800
1742A Sum implementation "You are given three integers a, b, and c. Determine if one of them is the sum of the other two." 800
1741G "Kirill and Company" "bitmasks,brute force,dfs and similar,dp,flows,graphs,shortest paths" "Kirill lives on a connected undirected graph of n vertices and m edges at vertex 1. One fine evening he gathered f friends, the i-th friend lives at the vertex hi. So all friends are now in the vertex 1, the i-th friend must get to his home to the vertex hi.The evening is about to end and it is time to leave. It turned out that k (k\xe2\x89\xa46) of his friends have no cars, and they would have to walk if no one gives them a ride. One friend with a car can give a ride to any number of friends without cars, but only if he can give them a ride by driving along one of the shortest paths to his house.For example, in the graph below, a friend from vertex hi=5 can give a ride to friends from the following sets of vertices: [2,3], [2,4], [2], [3], [4], but can\'t give a ride to friend from vertex 6 or a set [3,4].  The vertices where friends without cars live are highlighted in green, and with cars \xe2\x80\x94 in red. Kirill wants as few friends as possible to have to walk. Help him find the minimum possible number." 2200
1741F "Multi-Colored Segments" "binary search,data structures,math,sortings" "Dmitry has n segments of different colors on the coordinate axis Ox. Each segment is characterized by three integers li, ri and ci (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4109,1\xe2\x89\xa4ci\xe2\x89\xa4n), where li and ri are are the coordinates of the ends of the i-th segment, and ci is its color.Dmitry likes to find the minimum distances between segments. However, he considers pairs of segments of the same color uninteresting. Therefore, he wants to know for each segment the distance from this segment to the nearest differently colored segment.The distance between two segments is the minimum of the distances between a point of the first segment and a point of the second segment. In particular, if the segments intersect, then the distance between them is equal to 0.For example, Dmitry has 5 segments:    The first segment intersects with the second (and these are segments of different colors), so the answers for them are equal to 0.  For the 3-rd segment, the nearest segment of a different color is the 2-nd segment, the distance to which is equal to 2.  For the 4-th segment, the nearest segment of a different color is the 5-th segment, the distance to which is equal to 1.  The 5-th segment lies inside the 2-nd segment (and these are segments of different colors), so the answers for them are equal to 0." 2000
1741E "Sending a Sequence Over the Network" dp "The sequence a is sent over the network as follows:  sequence a is split into segments (each element of the sequence belongs to exactly one segment, each segment is a group of consecutive elements of sequence);  for each segment, its length is written next to it, either to the left of it or to the right of it;  the resulting sequence b is sent over the network. For example, we needed to send the sequence a=[1,2,3,1,2,3]. Suppose it was split into segments as follows: [1]+[2,3,1]+[2,3]. Then we could have the following sequences:   b=[1,1,3,2,3,1,2,3,2],  b=[1,1,3,2,3,1,2,2,3],  b=[1,1,2,3,1,3,2,2,3],  b=[1,1,2,3,1,3,2,3,2]. If a different segmentation had been used, the sent sequence might have been different.The sequence b is given. Could the sequence b be sent over the network? In other words, is there such a sequence a that converting a to send it over the network could result in a sequence b?" 1600
1741D "Masha and a Beautiful Tree" "dfs and similar,divide and conquer,graphs,sortings,trees" "The girl named Masha was walking in the forest and found a complete binary tree of height n and a permutation p of length m=2n.A complete binary tree of height n is a rooted tree such that every vertex except the leaves has exactly two sons, and the length of the path from the root to any of the leaves is n. The picture below shows the complete binary tree for n=2.A permutation is an array consisting of n different integers from 1 to n. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not (2 occurs twice), and [1,3,4] is also not a permutation (n=3, but there is 4 in the array).Let\'s enumerate m leaves of this tree from left to right. The leaf with the number i contains the value pi (1\xe2\x89\xa4i\xe2\x89\xa4m).For example, if n=2, p=[3,1,4,2], the tree will look like this:  Masha considers a tree beautiful if the values in its leaves are ordered from left to right in increasing order.In one operation, Masha can choose any non-leaf vertex of the tree and swap its left and right sons (along with their subtrees).For example, if Masha applies this operation to the root of the tree discussed above, it will take the following form:  Help Masha understand if she can make a tree beautiful in a certain number of operations. If she can, then output the minimum number of operations to make the tree beautiful." 1300
1741C "Minimize the Thickness" "brute force,greedy,math,two pointers" "You are given a sequence a=[a1,a2,\xe2\x80\xa6,an] consisting of n positive integers.Let\'s call a group of consecutive elements a segment. Each segment is characterized by two indices: the index of its left end and the index of its right end. Denote by a[l,r] a segment of the sequence a with the left end in l and the right end in r, i.e. a[l,r]=[al,al+1,\xe2\x80\xa6,ar].For example, if a=[31,4,15,92,6,5], then a[2,5]=[4,15,92,6], a[5,5]=[6], a[1,6]=[31,4,15,92,6,5] are segments.We split the given sequence a into segments so that:   each element is in exactly one segment;  the sums of elements for all segments are equal. For example, if a = [55,45,30,30,40,100], then such a sequence can be split into three segments: a[1,2]=[55,45], a[3,5]=[30,30,40], a[6,6]=[100]. Each element belongs to exactly segment, the sum of the elements of each segment is 100.Let\'s define thickness of split as the length of the longest segment. For example, the thickness of the split from the example above is 3.Find the minimum thickness among all possible splits of the given sequence of a into segments in the required way." 1100
1741B "Funny Permutation" "constructive algorithms,math" "A sequence of n numbers is called permutation if it contains all numbers from 1 to n exactly once. For example, the sequences [3,1,4,2], [1] and [2,1] are permutations, but [1,2,1], [0,1] and [1,3,4] are not.For a given number n you need to make a permutation p such that two requirements are satisfied at the same time:  For each element pi, at least one of its neighbors has a value that differs from the value of pi by one. That is, for each element pi (1\xe2\x89\xa4i\xe2\x89\xa4n), at least one of its neighboring elements (standing to the left or right of pi) must be pi+1, or pi\xe2\x88\x921.  the permutation must have no fixed points. That is, for every i (1\xe2\x89\xa4i\xe2\x89\xa4n), pi\xe2\x89\xa0i must be satisfied. Let\'s call the permutation that satisfies these requirements funny.For example, let n=4. Then [4,3,1,2] is a funny permutation, since:   to the right of p1=4 is p2=p1\xe2\x88\x921=4\xe2\x88\x921=3;  to the left of p2=3 is p1=p2+1=3+1=4;  to the right of p3=1 is p4=p3+1=1+1=2;  to the left of p4=2 is p3=p4\xe2\x88\x921=2\xe2\x88\x921=1.  for all i is pi\xe2\x89\xa0i. For a given positive integer n, output any funny permutation of length n, or output -1 if funny permutation of length n does not exist." 800
1741A "Compare T-Shirt Sizes" implementation,implementation,strings "Two T-shirt sizes are given: a and b. The T-shirt size is either a string M or a string consisting of several (possibly zero) characters X and one of the characters S or L.For example, strings M, XXL, S, XXXXXXXS could be the size of some T-shirts. And the strings XM, LL, SX are not sizes.The letter M stands for medium, S for small, L for large. The letter X refers to the degree of size (from eXtra). For example, XXL is extra-extra-large (bigger than XL, and smaller than XXXL).You need to compare two given sizes of T-shirts a and b.The T-shirts are compared as follows:   any small size (no matter how many letters X) is smaller than the medium size and any large size;  any large size (regardless of the number of letters X) is larger than the medium size and any small size;  the more letters X before S, the smaller the size;  the more letters X in front of L, the larger the size. For example:   XXXS < XS  XXXL > XL  XL > M  XXL = XXL  XXXXXS < M  XL > XXXS" 800
1740I "Arranging Crystal Balls" "data structures,divide and conquer,divide and conquer,dp,geometry,graphs,number theory" "In the world of Compfestnesia, Pak Chanek discovers a secret underground dungeon. Inside it, there is a treasure chest that is surrounded by n statues that are arranged in a circular manner. The statues are numbered from 0 to n\xe2\x88\x921 with statue i being to the left of statue i+1 and statue n\xe2\x88\x921 being to the left of statue 0.Pak Chanek observes that each statue is holding a crystal ball with an integer between 0 and m\xe2\x88\x921 inclusive. Let\'s say the integer in the crystal ball of statue i is ai.The dungeon provides instructions that every integer in the crystal balls must be 0 in order to open the treasure chest. To achieve that, Pak Chanek is given an integer k, and he can do zero or more operations. In a single operation, Pak Chanek does the following:   Choose exactly k consecutive statues. In other words, choose the statues p,(p+1)modn,(p+2)modn,(p+3)modn,\xe2\x80\xa6,(p+k\xe2\x88\x921)modn for some chosen index p.  Do one of the following:   For all chosen statues, change their values of ai into (ai+1)modm.  For all chosen statues, change their values of ai into (ai\xe2\x88\x921)modm.  Help Pak Chanek find the minimum possible number of operations to open the treasure chest." 3500
1740H "MEX Tree Manipulation" "data structures,trees" "Given a rooted tree, define the value of vertex u in the tree recursively as the MEX\xe2\x80\xa0 of the values of its children. Note that it is only the children, not all of its descendants. In particular, the value of a leaf is 0.Pak Chanek has a rooted tree that initially only contains a single vertex with index 1, which is the root. Pak Chanek is going to do q queries. In the i-th query, Pak Chanek is given an integer xi. Pak Chanek needs to add a new vertex with index i+1 as the child of vertex xi. After adding the new vertex, Pak Chanek needs to recalculate the values of all vertices and report the sum of the values of all vertices in the current tree.\xe2\x80\xa0 The MEX (minimum excluded) of an array is the smallest non-negative integer that does not belong to the array. For example, the MEX of [0,1,1,2,6,7] is 3 and the MEX of [6,9] is 0." 3300
1740G "Dangerous Laser Power" "constructive algorithms,dsu,sortings" "Pak Chanek has an n\xc3\x97m grid of portals. The portal on the i-th row and j-th column is denoted as portal (i,j). The portals (1,1) and (n,m) are on the north-west and south-east corner of the grid respectively.The portal (i,j) has two settings:  Type ti,j, which is either 0 or 1.  Strength si,j, which is an integer between 1 and 109 inclusive.  Each portal has 4 faces labelled with integers 0,1,2,3, which correspond to the north, east, south, and west direction respectively.  When a laser enters face k of portal (i,j) with speed xin, it leaves the portal going out of face (k+2+ti,j)mod4 with speed xout=max(xin,si,j). The portal also has to consume xout\xe2\x88\x92xin units of energy. Pak Chanek is very bored today. He will shoot 4nm lasers with an initial speed of 1, one into each face of each portal. Each laser will travel throughout this grid of portals until it moves outside the grid or it has passed through 10100 portals.At the end, Pak Chanek thinks that a portal is good if and only if the total energy consumed by that portal modulo 2 is equal to its type. Given the strength settings of all portals, find a way to assign the type settings of each portal such that the number of good portals is maximised." 3100
1740F "Conditional Mix" combinatorics,dp,math "Pak Chanek is given an array a of n integers. For each i (1\xe2\x89\xa4i\xe2\x89\xa4n), Pak Chanek will write the one-element set {ai} on a whiteboard.After that, in one operation, Pak Chanek may do the following:   Choose two different sets S and T on the whiteboard such that S\xe2\x88\xa9T=\xe2\x88\x85 (S and T do not have any common elements).  Erase S and T from the whiteboard and write S\xe2\x88\xaaT (the union of S and T) onto the whiteboard. After performing zero or more operations, Pak Chanek will construct a multiset M containing the sizes of all sets written on the whiteboard. In other words, each element in M corresponds to the size of a set after the operations.How many distinct\xe2\x80\xa0 multisets M can be created by this process? Since the answer may be large, output it modulo 998244353.\xe2\x80\xa0 Multisets B and C are different if and only if there exists a value k such that the number of elements with value k in B is different than the number of elements with value k in C." 2600
1740E "Hanging Hearts" "constructive algorithms,data structures,dfs and similar,dp,greedy,trees" "Pak Chanek has n blank heart-shaped cards. Card 1 is attached directly to the wall while each of the other cards is hanging onto exactly one other card by a piece of string. Specifically, card i (i>1) is hanging onto card pi (pi<i).In the very beginning, Pak Chanek must write one integer number on each card. He does this by choosing any permutation a of [1,2,\xe2\x80\xa6,n]. Then, the number written on card i is ai.After that, Pak Chanek must do the following operation n times while maintaining a sequence s (which is initially empty):  Choose a card x such that no other cards are hanging onto it.  Append the number written on card x to the end of s.  If x\xe2\x89\xa01 and the number on card px is larger than the number on card x, replace the number on card px with the number on card x.  Remove card x. After that, Pak Chanek will have a sequence s with n elements. What is the maximum length of the longest non-decreasing subsequence\xe2\x80\xa0 of s at the end if Pak Chanek does all the steps optimally?\xe2\x80\xa0 A sequence b is a subsequence of a sequence c if b can be obtained from c by deletion of several (possibly, zero or all) elements. For example, [3,1] is a subsequence of [3,2,1], [4,3,1] and [3,1], but not [1,3,3,7] and [3,10,4]." 1800
1740D "Knowledge Cards" "constructive algorithms,data structures" "Pak Chanek, a renowned scholar, invented a card puzzle using his knowledge. In the puzzle, you are given a board with n rows and m columns. Let (r,c) represent the cell in the r-th row and the c-th column.Initially, there are k cards stacked in cell (1,1). Each card has an integer from 1 to k written on it. More specifically, the i-th card from the top of the stack in cell (1,1) has the number ai written on it. It is known that no two cards have the same number written on them. In other words, the numbers written on the cards are a permutation of integers from 1 to k. All other cells are empty.You need to move the k cards to cell (n,m) to create another stack of cards. Let bi be the number written on the i-th card from the top of the stack in cell (n,m). You should create the stack in cell (n,m) in such a way so that bi=i for all 1\xe2\x89\xa4i\xe2\x89\xa4k.In one move, you can remove the top card from a cell and place it onto an adjacent cell (a cell that shares a common side). If the target cell already contains one or more cards, you place your card on the top of the stack. You must do each operation while satisfying the following restrictions:   Each cell other than (1,1) and (n,m) must not have more than one card on it.  You cannot move a card onto cell (1,1).  You cannot move a card from cell (n,m). Given the values of n, m, k and the array a, determine if the puzzle is solvable." 1500
1740C "Bricks and Bags" "constructive algorithms,games,greedy,sortings" "There are n bricks numbered from 1 to n. Brick i has a weight of ai.Pak Chanek has 3 bags numbered from 1 to 3 that are initially empty. For each brick, Pak Chanek must put it into one of the bags. After this, each bag must contain at least one brick.After Pak Chanek distributes the bricks, Bu Dengklek will take exactly one brick from each bag. Let wj be the weight of the brick Bu Dengklek takes from bag j. The score is calculated as |w1\xe2\x88\x92w2|+|w2\xe2\x88\x92w3|, where |x| denotes the absolute value of x.It is known that Bu Dengklek will take the bricks in such a way that minimises the score. What is the maximum possible final score if Pak Chanek distributes the bricks optimally?" 1400
1740B "Jumbo Extra Cheese 2" geometry,greedy,sortings "Pak Chanek has n two-dimensional slices of cheese. The i-th slice of cheese can be represented as a rectangle of dimensions ai\xc3\x97bi. We want to arrange them on the two-dimensional plane such that:  Each edge of each cheese is parallel to either the x-axis or the y-axis.  The bottom edge of each cheese is a segment of the x-axis.  No two slices of cheese overlap, but their sides can touch.  They form one connected shape. Note that we can arrange them in any order (the leftmost slice of cheese is not necessarily the first slice of cheese). Also note that we can rotate each slice of cheese in any way as long as all conditions still hold.Find the minimum possible perimeter of the constructed shape." 800
1740A "Factorise N+M" "constructive algorithms,number theory" "Pak Chanek has a prime number\xe2\x80\xa0 n. Find a prime number m such that n+m is not prime.\xe2\x80\xa0 A prime number is a number with exactly 2 factors. The first few prime numbers are 2,3,5,7,11,13,\xe2\x80\xa6. In particular, 1 is not a prime number." 800
1739F "Keyboard Design" "bitmasks,data structures,dp,string suffix structures,strings" "Monocarp has a dictionary of n words, consisting of 12 first letters of the Latin alphabet. The words are numbered from 1 to n. In every pair of adjacent characters in each word, the characters are different. For every word i, Monocarp also has an integer ci denoting how often he uses this word.Monocarp wants to design a keyboard that would allow him to type some of the words easily. A keyboard can be denoted as a sequence of 12 first letters of the Latin alphabet, where each letter from a to l appears exactly once.A word can be typed with the keyboard easily if, for every pair of adjacent characters in the word, these characters are adjacent in the keyboard as well. The optimality of the keyboard is the sum of ci over all words i that can be typed easily with it.Help Monocarp to design a keyboard with the maximum possible optimality." 2600
1739E "Cleaning Robot" bitmasks,dp "Consider a hallway, which can be represented as the matrix with 2 rows and n columns. Let\'s denote the cell on the intersection of the i-th row and the j-th column as (i,j). The distance between the cells (i1,j1) and (i2,j2) is |i1\xe2\x88\x92i2|+|j1\xe2\x88\x92j2|.There is a cleaning robot in the cell (1,1). Some cells of the hallway are clean, other cells are dirty (the cell with the robot is clean). You want to clean the hallway, so you are going to launch the robot to do this.After the robot is launched, it works as follows. While at least one cell is dirty, the robot chooses the closest (to its current cell) cell among those which are dirty, moves there and cleans it (so the cell is no longer dirty). After cleaning a cell, the robot again finds the closest dirty cell to its current cell, and so on. This process repeats until the whole hallway is clean.However, there is a critical bug in the robot\'s program. If at some moment, there are multiple closest (to the robot\'s current position) dirty cells, the robot malfunctions.You want to clean the hallway in such a way that the robot doesn\'t malfunction. Before launching the robot, you can clean some (possibly zero) of the dirty cells yourself. However, you don\'t want to do too much dirty work yourself while you have this nice, smart (yet buggy) robot to do this. Note that you cannot make a clean cell dirty.Calculate the maximum possible number of cells you can leave dirty before launching the robot, so that it doesn\'t malfunction." 2400
1739D "Reset K Edges" "binary search,data structures,dfs and similar,graphs,greedy,trees" "You are given a rooted tree, consisting of n vertices. The vertices are numbered from 1 to n, the root is the vertex 1.You can perform the following operation at most k times:   choose an edge (v,u) of the tree such that v is a parent of u;  remove the edge (v,u);  add an edge (1,u) (i.\xe2\x80\x89e. make u with its subtree a child of the root). The height of a tree is the maximum depth of its vertices, and the depth of a vertex is the number of edges on the path from the root to it. For example, the depth of vertex 1 is 0, since it\'s the root, and the depth of all its children is 1.What\'s the smallest height of the tree that can be achieved?" 1900
1739C "Card Game" "combinatorics,constructive algorithms,dp,games" "Consider a game with n cards (n is even). Each card has a number written on it, between 1 and n. All numbers on the cards are different. We say that a card with number x is stronger than a card with number y if x>y.Two players, Alex and Boris, play this game. In the beginning, each of them receives exactly n2 cards, so each card belongs to exactly one player. Then, they take turns. Alex goes first, then Boris, then Alex again, and so on.On a player\'s turn, he must play exactly one of his cards. Then, if the opponent doesn\'t have any cards stronger than the card played, the opponent loses, and the game ends. Otherwise, the opponent has to play a stronger card (exactly one card as well). These two cards are removed from the game, and the turn ends. If there are no cards left, the game ends in a draw; otherwise it\'s the opponent\'s turn.Consider all possible ways to distribute the cards between two players, so that each of them receives exactly half of the cards. You have to calculate three numbers:  the number of ways to distribute the cards so that Alex wins;  the number of ways to distribute the cards so that Boris wins;  the number of ways to distribute the cards so that the game ends in a draw. You may assume that both players play optimally (i.\xe2\x80\x89e. if a player can win no matter how his opponent plays, he wins). Two ways to distribute the cards are different if there is at least one card such that, in one of these ways, it is given to Alex, and in the other way, it is given to Boris.For example, suppose n=4, Alex receives the cards [2,3], and Boris receives the cards [1,4]. Then the game may go as follows:  if Alex plays the card 2, then Boris has to respond with the card 4. Then, Alex\'s turn ends, and Boris\' turn starts. Boris has only one card left, which is 1; he plays it, and Alex responds with the card 3. So, the game ends in a draw;  if Alex plays the card 3, then Boris has to respond with the card 4. Then, Alex\'s turn ends, and Boris\' turn starts. Boris has only one card left, which is 1; he plays it, and Alex responds with the card 2. So, the game ends in a draw. So, in this case, the game ends in a draw." 1500
1739B "Array Recovery" "constructive algorithms,greedy,math" "For an array of non-negative integers a of size n, we construct another array d as follows: d1=a1, di=|ai\xe2\x88\x92ai\xe2\x88\x921| for 2\xe2\x89\xa4i\xe2\x89\xa4n.Your task is to restore the array a from a given array d, or to report that there are multiple possible arrays." 1100
1739A "Immobile Knight" implementation "There is a chess board of size n\xc3\x97m. The rows are numbered from 1 to n, the columns are numbered from 1 to m.Let\'s call a cell isolated if a knight placed in that cell can\'t move to any other cell on the board. Recall that a chess knight moves two cells in one direction and one cell in a perpendicular direction:   Find any isolated cell on the board. If there are no such cells, print any cell on the board." 800
1738H "Palindrome Addicts" "data structures,strings" "Your task is to maintain a queue consisting of lowercase English letters as follows:   ""push c"": insert a letter c at the back of the queue;  ""pop"": delete a letter from the front of the queue. Initially, the queue is empty. After each operation, you are asked to count the number of distinct palindromic substrings in the string that are obtained by concatenating the letters from the front to the back of the queue.Especially, the number of distinct palindromic substrings of the empty string is 0. A string s[1..n] of length n is palindromic if s[i]=s[n\xe2\x88\x92i+1] for every 1\xe2\x89\xa4i\xe2\x89\xa4n. The string s[l..r] is a substring of string s[1..n] for every 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n. Two strings s[1..n] and t[1..m] are distinct, if at least one of the following holds.   n\xe2\x89\xa0m;  s[i]\xe2\x89\xa0t[i] for some 1\xe2\x89\xa4i\xe2\x89\xa4min{n,m}." 3300
1738G "Anti-Increasing Addicts" "constructive algorithms,dp,greedy,math" "You are given an n\xc3\x97n grid. We write (i,j) to denote the cell in the i-th row and j-th column. For each cell, you are told whether yon can delete it or not. Given an integer k, you are asked to delete exactly (n\xe2\x88\x92k+1)2 cells from the grid such that the following condition holds.   You cannot find k not deleted cells (x1,y1),(x2,y2),\xe2\x80\xa6,(xk,yk) that are strictly increasing, i.e., xi<xi+1 and yi<yi+1 for all 1\xe2\x89\xa4i<k.  Your task is to find a solution, or report that it is impossible." 2900
1738F "Connectivity Addicts" "constructive algorithms,dsu,graphs,greedy,interactive,shortest paths,trees" "This is an interactive problem.Given a simple undirected graph with n vertices numbered from 1 to n, your task is to color all the vertices such that for every color c, the following conditions hold:   The set of vertices with color c is connected;  sc\xe2\x89\xa4n2c, where nc is the number of vertices with color c, and sc is the sum of degrees of vertices with color c.  It can be shown that there always exists a way to color all the vertices such that the above conditions hold. Initially, you are only given the number n of vertices and the degree of each vertex. In each query, you can choose a vertex u. As a response, you will be given the k-th edge incident to u, if this is the k-th query on vertex u. You are allowed to make at most n queries.An undirected graph is simple if it does not contain multiple edges or self-loops.The degree of a vertex is the number of edges incident to it. A set S of vertices is connected if for every two different vertices u,v\xe2\x88\x88S, there is a path, which only passes through vertices in S, that connects u and v. That is, there is a sequence of edges (u1,v1),(u2,v2),\xe2\x80\xa6,(uk,vk) with k\xe2\x89\xa51 such that   u1=u, vk=v, and vi=ui+1 for every 1\xe2\x89\xa4i<k; and  uk\xe2\x88\x88S and vk\xe2\x88\x88S for every 1\xe2\x89\xa4i\xe2\x89\xa4k.  Especially, a set containing only one vertex is connected." 2400
1738E "Balance Addicts" "combinatorics,dp,math,two pointers" "Given an integer sequence a1,a2,\xe2\x80\xa6,an of length n, your task is to compute the number, modulo 998244353, of ways to partition it into several non-empty continuous subsequences such that the sums of elements in the subsequences form a balanced sequence.A sequence s1,s2,\xe2\x80\xa6,sk of length k is said to be balanced, if si=sk\xe2\x88\x92i+1 for every 1\xe2\x89\xa4i\xe2\x89\xa4k. For example, [1,2,3,2,1] and [1,3,3,1] are balanced, but [1,5,15] is not. Formally, every partition can be described by a sequence of indexes i1,i2,\xe2\x80\xa6,ik of length k with 1=i1<i2<\xe2\x8b\xaf<ik\xe2\x89\xa4n such that   k is the number of non-empty continuous subsequences in the partition;  For every 1\xe2\x89\xa4j\xe2\x89\xa4k, the j-th continuous subsequence starts with aij, and ends exactly before aij+1, where ik+1=n+1. That is, the j-th subsequence is aij,aij+1,\xe2\x80\xa6,aij+1\xe2\x88\x921.  There are 2n\xe2\x88\x921 different partitions in total. Let s1,s2,\xe2\x80\xa6,sk denote the sums of elements in the subsequences with respect to the partition i1,i2,\xe2\x80\xa6,ik. Formally, for every 1\xe2\x89\xa4j\xe2\x89\xa4k, sj=ij+1\xe2\x88\x921\xe2\x88\x91i=ijai=aij+aij+1+\xe2\x8b\xaf+aij+1\xe2\x88\x921. For example, the partition [1|2,3|4,5,6] of sequence [1,2,3,4,5,6] is described by the sequence [1,2,4] of indexes, and the sums of elements in the subsequences with respect to the partition is [1,5,15].Two partitions i1,i2,\xe2\x80\xa6,ik and i\xe2\x80\xb21,i\xe2\x80\xb22,\xe2\x80\xa6,i\xe2\x80\xb2k\xe2\x80\xb2 (described by sequences of indexes) are considered to be different, if at least one of the following holds.   k\xe2\x89\xa0k\xe2\x80\xb2,  ij\xe2\x89\xa0i\xe2\x80\xb2j for some 1\xe2\x89\xa4j\xe2\x89\xa4min{k,k\xe2\x80\xb2}." 2300
1738D "Permutation Addicts" "constructive algorithms,data structures,dfs and similar,dsu,graphs,trees" "Given a permutation a1,a2,\xe2\x80\xa6,an of integers from 1 to n, and a threshold k with 0\xe2\x89\xa4k\xe2\x89\xa4n, you compute a sequence b1,b2,\xe2\x80\xa6,bn as follows. For every 1\xe2\x89\xa4i\xe2\x89\xa4n in increasing order, let x=ai.   If x\xe2\x89\xa4k, set bx to the last element aj (1\xe2\x89\xa4j<i) that aj>k. If no such element aj exists, set bx=n+1.  If x>k, set bx to the last element aj (1\xe2\x89\xa4j<i) that aj\xe2\x89\xa4k. If no such element aj exists, set bx=0. Unfortunately, after the sequence b1,b2,\xe2\x80\xa6,bn has been completely computed, the permutation a1,a2,\xe2\x80\xa6,an and the threshold k are discarded. Now you only have the sequence b1,b2,\xe2\x80\xa6,bn. Your task is to find any possible permutation a1,a2,\xe2\x80\xa6,an and threshold k that produce the sequence b1,b2,\xe2\x80\xa6,bn. It is guaranteed that there exists at least one pair of permutation a1,a2,\xe2\x80\xa6,an and threshold k that produce the sequence b1,b2,\xe2\x80\xa6,bn.A permutation of integers from 1 to n is a sequence of length n which contains all integers from 1 to n exactly once." 1900
1738C "Even Number Addicts" dp,games,greedy,math "Alice and Bob are playing a game on a sequence a1,a2,\xe2\x80\xa6,an of length n. They move in turns and Alice moves first.In the turn of each player, he or she should select an integer and remove it from the sequence. The game ends when there is no integer left in the sequence. Alice wins if the sum of her selected integers is even; otherwise, Bob wins. Your task is to determine who will win the game, if both players play optimally." 1500
1738B "Prefix Sum Addicts" "constructive algorithms,greedy,math,sortings" "Suppose a1,a2,\xe2\x80\xa6,an is a sorted integer sequence of length n such that a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an. For every 1\xe2\x89\xa4i\xe2\x89\xa4n, the prefix sum si of the first i terms a1,a2,\xe2\x80\xa6,ai is defined by si=i\xe2\x88\x91k=1ak=a1+a2+\xe2\x8b\xaf+ai.Now you are given the last k terms of the prefix sums, which are sn\xe2\x88\x92k+1,\xe2\x80\xa6,sn\xe2\x88\x921,sn. Your task is to determine whether this is possible. Formally, given k integers sn\xe2\x88\x92k+1,\xe2\x80\xa6,sn\xe2\x88\x921,sn, the task is to check whether there is a sequence a1,a2,\xe2\x80\xa6,an such that   a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an, and  si=a1+a2+\xe2\x8b\xaf+ai for all n\xe2\x88\x92k+1\xe2\x89\xa4i\xe2\x89\xa4n." 1200
1738A "Glory Addicts" greedy,implementation,sortings "The hero is addicted to glory, and is fighting against a monster. The hero has n skills. The i-th skill is of type ai (either fire or frost) and has initial damage bi. The hero can perform all of the n skills in any order (with each skill performed exactly once). When performing each skill, the hero can play a magic as follows:   If the current skill immediately follows another skill of a different type, then its damage is doubled.  In other words,   If a skill of type fire and with initial damage c is performed immediately after a skill of type fire, then it will deal c damage;  If a skill of type fire and with initial damage c is performed immediately after a skill of type frost, then it will deal 2c damage;  If a skill of type frost and with initial damage c is performed immediately after a skill of type fire, then it will deal 2c damage;  If a skill of type frost and with initial damage c is performed immediately after a skill of type frost , then it will deal c damage. Your task is to find the maximum damage the hero can deal." 800
1737G "Ela Takes Dancing Class" "binary search,data structures" "DTL engineers love partying in the weekend. Ela does, too! Unfortunately, she didn\'t know how to dance yet. Therefore, she decided to take a dancing class.There are n students in the dancing class, including Ela. In the final project, n students will participate in a choreography described below.n students are positioned on the positive side of the Ox-axis. The i-th dancer is located at ai>0. Some dancers will change positions during the dance (we\'ll call them movable dancers), and others will stay in the same place during a choreography (we\'ll call them immovable dancers). We distinguish the dancers using a binary string s of length n: if si equals \'1\', then the i-th dancer is movable, otherwise the i-th dancer is immovable.Let\'s call the ""positive energy value"" of the choreography d>0. The dancers will perform ""movements"" based on this value.Each minute after the dance begins, the movable dancer with the smallest x-coordinate will start moving to the right and initiate a ""movement"". At the beginning of the movement, the dancer\'s energy level will be initiated equally to the positive energy value of the choreography, which is d. Each time they move from some y to y+1, the energy level will be decreased by 1. At some point, the dancer might meet other fellow dancers in the same coordinates. If it happens, then the energy level of the dancer will be increased by 1. A dancer will stop moving to the right when his energy level reaches 0, and he doesn\'t share a position with another dancer.The dancers are very well-trained, and each ""movement"" will end before the next minute begins.To show her understanding of this choreography, Ela has to answer q queries, each consisting of two integers k and m. The answer to this query is the coordinate of the m-th dancer of both types from the left at k-th minute after the choreography begins. In other words, denote xk,1,xk,2,\xe2\x80\xa6,xk,n as the sorted coordinates of the dancers at k-th minute from the beginning, you need to print xk,m." 3500
1737F "Ela and Prime GCD" "constructive algorithms,math,number theory" "After a long, tough, but fruitful day at DTL, Ela goes home happily. She entertains herself by solving Competitive Programming problems. She prefers short statements, because she already read too many long papers and documentation at work. The problem of the day reads:You are given an integer c. Suppose that c has n divisors. You have to find a sequence with n\xe2\x88\x921 integers [a1,a2,...an\xe2\x88\x921], which satisfies the following conditions:  Each element is strictly greater than 1.  Each element is a divisor of c.  All elements are distinct.  For all 1\xe2\x89\xa4i<n\xe2\x88\x921, gcd(ai,ai+1) is a prime number. In this problem, because c can be too big, the result of prime factorization of c is given instead. Note that gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y and a prime number is a positive integer which has exactly 2 divisors." 3300
1737E "Ela Goes Hiking" combinatorics,dp,math,probabilities "Ela likes to go hiking a lot. She loves nature and exploring the various creatures it offers. One day, she saw a strange type of ant, with a cannibalistic feature. More specifically, an ant would eat any ants that it sees which is smaller than it.Curious about this feature from a new creature, Ela ain\'t furious. She conducts a long, non-dubious, sentimental experiment.She puts n cannibalistic ants in a line on a long wooden stick. Initially, the ants have the same weight of 1. The distance between any two consecutive ants is the same. The distance between the first ant in the line to the left end and the last ant in the line to the right end is also the same as the distance between the ants. Each ant starts moving towards the left-end or the right-end randomly and equiprobably, at the same constant pace throughout the experiment. Two ants will crash if they are standing next to each other in the line and moving in opposite directions, and ants will change direction immediately when they reach the end of the stick. Ela can\'t determine the moving direction of each ant, but she understands very well their behavior when crashes happen.  If a crash happens between two ants of different weights, the heavier one will eat the lighter one, and gain the weight of the lighter one. After that, the heavier and will continue walking in the same direction. In other words, if the heavier one has weight x and walking to the right, the lighter one has weight y and walking to the left (x>y), then after the crash, the lighter one will diminish, and the heavier one will have weight x+y and continue walking to the right.  If a crash happens between two ants with the same weight, the one walking to the left end of the stick will eat the one walking to the right, and then continue walking in the same direction. In other words, if one ant of weight x walking to the left, crashes with another ant of weight x walking to the right, the one walking to the right will disappear, and the one walking to the left will have to weight 2x and continue walking to the left. Please, check the example in the ""Note"" section, which will demonstrate the ants\' behavior as above.We can prove that after a definite amount of time, there will be only one last ant standing. Initially, each ant can randomly and equiprobably move to the left or the right, which generates 2n different cases of initial movements for the whole pack. For each position in the line, calculate the probability that the ant begins in that position and survives. Output it modulo 109+7.Formally, let M=109+7. It can be shown that the answer can be expressed as an irreducible fraction pq, where p and q are integers and q\xe2\x89\xa20(modM). Output the integer equal to p\xe2\x8b\x85q\xe2\x88\x921modM. In other words, output such an integer x that 0\xe2\x89\xa4x<M and x\xe2\x8b\x85q\xe2\x89\xa1p(modM)." 2500
1737D "Ela and the Wiring Wizard" "brute force,dp,graphs,greedy,implementation,shortest paths" "Ela needs to send a large package from machine 1 to machine n through a network of machines. Currently, with the network condition, she complains that the network is too slow and the package can\'t arrive in time. Luckily, a Wiring Wizard offered her a helping hand.The network can be represented as an undirected connected graph with n nodes, each node representing a machine. m wires are used to connect them. Wire i is used to connect machines ui and vi, and has a weight wi. The aforementioned large package, if going through wire i, will move from machine ui to machine vi (or vice versa) in exactly wi microseconds. The Wiring Wizard can use his spell an arbitrary number of times. For each spell, he will choose the wire of index i, connecting machine ui and vi, and rewire it following these steps:  Choose one machine that is connected by this wire. Without loss of generality, let\'s choose vi.  Choose a machine that is currently connecting to vi (including ui), call it ti. Disconnect the wire indexed i from vi, then using it to connect ui and ti. The rewiring of wire i will takes wi microseconds, and the weight of the wire will not change after this operation. After a rewiring, a machine might have some wire connect it with itself. Also, the Wiring Wizard has warned Ela that rewiring might cause temporary disconnections between some machines, but Ela just ignores it anyway. Her mission is to send the large package from machine 1 to machine n as fast as possible. Note that the Wizard can use his spell on a wire zero, one, or many times. To make sure the network works seamlessly while transferring the large package, once the package starts transferring from machine 1, the Wiring Wizard cannot use his spell to move wires around anymore.Ela wonders, with the help of the Wiring Wizard, what is the least amount of time needed to transfer the large package from machine 1 to n." 2200
1737C "Ela and Crickets" "constructive algorithms,games,implementation,math" "Ela likes Chess a lot. During breaks, she usually challenges her co-worker in DTL to some chess games. She\'s not an expert at classic chess, but she\'s very interested in Chess variants, where she has to adapt to new rules and test her tactical mindset to win the game.The problem, which involves a non-standard chess pieces type that is described below, reads: given 3 white crickets on a n\xe2\x8b\x85n board, arranged in an ""L"" shape next to each other, there are no other pieces on the board. Ela wants to know with a finite number of moves, can she put any white cricket on the square on row x, column y?An ""L""-shape piece arrangement can only be one of the below:    For simplicity, we describe the rules for crickets on the board where only three white crickets are. It can move horizontally, vertically, or diagonally, but only to a square in some direction that is immediately after another cricket piece (so that it must jump over it). If the square immediately behind the piece is unoccupied, the cricket will occupy the square. Otherwise (when the square is occupied by another cricket, or does not exist), the cricket isn\'t allowed to make such a move.See an example of valid crickets\' moves on the pictures in the Note section." 1500
1737B "Ela\'s Fitness and the Luxury Number" "binary search,implementation,math" "While working at DTL, Ela is very aware of her physical and mental health. She started to practice various sports, such as Archery, Yoga, and Football.Since she started engaging in sports activities, Ela switches to trying a new sport on days she considers being ""Luxury"" days. She counts the days since she started these activities, in which the day she starts is numbered as day 11. A ""Luxury"" day is the day in which the number of this day is a luxurious number. An integer xx is called a luxurious number if it is divisible by \xe2\x8c\x8ax\xe2\x88\x92\xe2\x88\x92\xe2\x88\x9a\xe2\x8c\x8b\xe2\x8c\x8ax\xe2\x8c\x8b.Here \xe2\x8c\x8ar\xe2\x8c\x8b\xe2\x8c\x8ar\xe2\x8c\x8b denotes the ""floor"" of a real number rr. In other words, it\'s the largest integer not greater than rr.For example: 88, 5656, 100100 are luxurious numbers, since 88 is divisible by \xe2\x8c\x8a8\xe2\x80\x93\xe2\x88\x9a\xe2\x8c\x8b=\xe2\x8c\x8a2.8284\xe2\x8c\x8b=2\xe2\x8c\x8a8\xe2\x8c\x8b=\xe2\x8c\x8a2.8284\xe2\x8c\x8b=2, 5656 is divisible \xe2\x8c\x8a56\xe2\x88\x92\xe2\x88\x92\xe2\x88\x9a\xe2\x8c\x8b=\xe2\x8c\x8a7.4833\xe2\x8c\x8b=7\xe2\x8c\x8a56\xe2\x8c\x8b=\xe2\x8c\x8a7.4833\xe2\x8c\x8b=7, and 100100 is divisible by \xe2\x8c\x8a100\xe2\x88\x92\xe2\x88\x92\xe2\x88\x92\xe2\x88\x9a\xe2\x8c\x8b=\xe2\x8c\x8a10\xe2\x8c\x8b=10\xe2\x8c\x8a100\xe2\x8c\x8b=\xe2\x8c\x8a10\xe2\x8c\x8b=10, respectively. On the other hand 55, 4040 are not, since 55 are not divisible by \xe2\x8c\x8a5\xe2\x80\x93\xe2\x88\x9a\xe2\x8c\x8b=\xe2\x8c\x8a2.2361\xe2\x8c\x8b=2\xe2\x8c\x8a5\xe2\x8c\x8b=\xe2\x8c\x8a2.2361\xe2\x8c\x8b=2, and 4040 are not divisible by \xe2\x8c\x8a40\xe2\x88\x92\xe2\x88\x92\xe2\x88\x9a\xe2\x8c\x8b=\xe2\x8c\x8a6.3246\xe2\x8c\x8b=6\xe2\x8c\x8a40\xe2\x8c\x8b=\xe2\x8c\x8a6.3246\xe2\x8c\x8b=6.Being a friend of Ela, you want to engage in these fitness activities with her to keep her and yourself accompanied (and have fun together, of course). Between day ll and day rr, you want to know how many times she changes the activities." 1300
1737A "Ela Sorting Books" greedy,implementation,strings "Ela loves reading a lot, just like her new co-workers in DTL! On her first day after becoming an engineer in DTL, she is challenged by a co-worker to sort a heap of books into different compartments on the shelf.n books must be split into k compartments on the bookshelf (n is divisible by k). Each book is represented by a lowercase Latin letter from \'a\' to \'y\' inclusively, which is the beginning letter in the title of the book.Ela must stack exactly nk books in each compartment. After the books are stacked, for each compartment indexed from 1 to k, she takes the minimum excluded (MEX) letter of the multiset of letters formed by letters representing all books in that compartment, then combines the resulting letters into a string. The first letter of the resulting string is the MEX letter of the multiset of letters formed by the first compartment, the second letter of the resulting string is the MEX letter of the multiset of letters formed by the second compartment, ... and so on. Please note, under the constraint of this problem, MEX letter can always be determined for any multiset found in this problem because \'z\' is not used.What is the lexicographically greatest resulting string possible that Ela can create?A string a is lexicographically greater than a string b if and only if one of the following holds:  b is a prefix of a, but b\xe2\x89\xa0a;  in the first position where a and b differ, the string a has a letter that appears later in the alphabet than the corresponding letter in b. The minimum excluded (MEX) letter of a multiset of letters is the letter that appears earliest in the alphabet and is not contained in the multiset. For example, if a multiset of letters contains 7 letters \'b\', \'a\', \'b\', \'c\', \'e\', \'c\', \'f\' respectively, then the MEX letter of this compartment is \'d\', because \'d\' is not included in the multiset, and all letters comes before \'d\' in the alphabet, namely \'a\', \'b\' and \'c\', are included in the multiset." 900
1736E "Swap and Take" dp,greedy "You\'re given an array consisting of n integers. You have to perform n turns.Initially your score is 0.On the i-th turn, you are allowed to leave the array as it is or swap any one pair of 2 adjacent elements in the array and change exactly one of them to 0(and leave the value of other element unchanged) after swapping. In either case(whether you swap or not), after this you add ai to your score. What\'s the maximum possible score you can get?" 2600
1736D "Equal Binary Subsequences" "constructive algorithms,geometry,greedy,implementation,strings" "Everool has a binary string s of length 2n. Note that a binary string is a string consisting of only characters 0 and 1. He wants to partition s into two disjoint equal subsequences. He needs your help to do it.You are allowed to do the following operation exactly once.   You can choose any subsequence (possibly empty) of s and rotate it right by one position. In other words, you can select a sequence of indices b1,b2,\xe2\x80\xa6,bm, where 1\xe2\x89\xa4b1<b2<\xe2\x80\xa6<bm\xe2\x89\xa42n. After that you simultaneously set sb1:=sbm, sb2:=sb1, \xe2\x80\xa6, sbm:=sbm\xe2\x88\x921.Can you partition s into two disjoint equal subsequences after performing the allowed operation exactly once?A partition of s into two disjoint equal subsequences sp and sq is two increasing arrays of indices p1,p2,\xe2\x80\xa6,pn and q1,q2,\xe2\x80\xa6,qn, such that each integer from 1 to 2n is encountered in either p or q exactly once, sp=sp1sp2\xe2\x80\xa6spn, sq=sq1sq2\xe2\x80\xa6sqn, and sp=sq.If it is not possible to partition after performing any kind of operation, report \xe2\x88\x921. If it is possible to do the operation and partition s into two disjoint subsequences sp and sq, such that sp=sq, print elements of b and indices of sp, i. e. the values p1,p2,\xe2\x80\xa6,pn." 2200
1736C2 "Good Subarrays (Hard Version)" "binary search,data structures,dp,two pointers" "This is the hard version of this problem. In this version, we have queries. Note that we do not have multiple test cases in this version. You can make hacks only if both versions of the problem are solved.An array b of length m is good if for all i the i-th element is greater than or equal to i. In other words, b is good if and only if bi\xe2\x89\xa5i for all i (1\xe2\x89\xa4i\xe2\x89\xa4m).You are given an array a consisting of n positive integers, and you are asked q queries. In each query, you are given two integers p and x (1\xe2\x89\xa4p,x\xe2\x89\xa4n). You have to do ap:=x (assign x to ap). In the updated array, find the number of pairs of indices (l,r), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, such that the array [al,al+1,\xe2\x80\xa6,ar] is good.Note that all queries are independent, which means after each query, the initial array a is restored." 2400
1736C1 "Good Subarrays (Easy Version)" "binary search,data structures,schedules,two pointers" "This is the easy version of this problem. In this version, we do not have queries. Note that we have multiple test cases in this version. You can make hacks only if both versions of the problem are solved.An array b of length m is good if for all i the i-th element is greater than or equal to i. In other words, b is good if and only if bi\xe2\x89\xa5i for all i (1\xe2\x89\xa4i\xe2\x89\xa4m).You are given an array a consisting of n positive integers. Find the number of pairs of indices (l,r), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, such that the array [al,al+1,\xe2\x80\xa6,ar] is good." 1300
1736B "Playing with GCD" "math,number theory" "You are given an integer array a of length n. Does there exist an array b consisting of n+1 positive integers such that ai=gcd(bi,bi+1) for all i (1\xe2\x89\xa4i\xe2\x89\xa4n)? Note that gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y." 1200
1736A "Make A Equal to B" "brute force,greedy,sortings" "You are given two arrays a and b of n elements, each element is either 0 or 1.You can make operations of 2 kinds.   Pick an index i and change ai to 1\xe2\x88\x92ai.  Rearrange the array a however you want. Find the minimum number of operations required to make a equal to b." 800
1735F "Pebbles and Beads" "data structures,geometry" "There are two currencies: pebbles and beads. Initially you have a pebbles, b beads.There are n days, each day you can exchange one currency for another at some exchange rate.On day i, you can exchange \xe2\x88\x92pi\xe2\x89\xa4x\xe2\x89\xa4pi pebbles for \xe2\x88\x92qi\xe2\x89\xa4y\xe2\x89\xa4qi beads or vice versa. It\'s allowed not to perform an exchange at all. Meanwhile, if you perform an exchange, the proportion x\xe2\x8b\x85qi=\xe2\x88\x92y\xe2\x8b\x85pi must be fulfilled. Fractional exchanges are allowed.You can perform no more than one such exchange in one day. The numbers of pebbles and beads you have must always remain non-negative.Please solve the following n problems independently: for each day i, output the maximum number of pebbles that you can have at the end of day i if you perform exchanges optimally." 2900
1735E "House Planning" "constructive algorithms,data structures,graph matchings,greedy" "There are n houses in your city arranged on an axis at points h1,h2,\xe2\x80\xa6,hn. You want to build a new house for yourself and consider two options where to place it: points p1 and p2.As you like visiting friends, you have calculated in advance the distances from both options to all existing houses. More formally, you have calculated two arrays d1, d2: di,j=|pi\xe2\x88\x92hj|, where |x| defines the absolute value of x.After a long time of inactivity you have forgotten the locations of the houses h and the options p1, p2. But your diary still keeps two arrays \xe2\x80\x94 d1, d2, whose authenticity you doubt. Also, the values inside each array could be shuffled, so values at the same positions of d1 and d2 may correspond to different houses. Pay attention, that values from one array could not get to another, in other words, all values in the array d1 correspond the distances from p1 to the houses, and in the array d2  \xe2\x80\x94 from p2 to the houses.Also pay attention, that the locations of the houses hi and the considered options pj could match. For example, the next locations are correct: h={1,0,3,3}, p={1,1}, that could correspond to already shuffled d1={0,2,1,2}, d2={2,2,1,0}.Check whether there are locations of houses h and considered points p1, p2, for which the founded arrays of distances would be correct. If it is possible, find appropriate locations of houses and considered options." 2400
1735D Meta-set "brute force,combinatorics,data structures,hashing,math" "You like the card board game ""Set"". Each card contains k features, each of which is equal to a value from the set {0,1,2}. The deck contains all possible variants of cards, that is, there are 3k different cards in total.A feature for three cards is called good if it is the same for these cards or pairwise distinct. Three cards are called a set if all k features are good for them.For example, the cards (0,0,0), (0,2,1), and (0,1,2) form a set, but the cards (0,2,2), (2,1,2), and (1,2,0) do not, as, for example, the last feature is not good.A group of five cards is called a meta-set, if there is strictly more than one set among them. How many meta-sets there are among given n distinct cards?" 1700
1735C "Phase Shift" "dfs and similar,dsu,graphs,greedy,implementation,strings" "There was a string s which was supposed to be encrypted. For this reason, all 26 lowercase English letters were arranged in a circle in some order, afterwards, each letter in s was replaced with the one that follows in clockwise order, in that way the string t was obtained. You are given a string t. Determine the lexicographically smallest string s that could be a prototype of the given string t.A string a is lexicographically smaller than a string b of the same length if and only if:   in the first position where a and b differ, the string a has a letter, that appears earlier in the alphabet than the corresponding letter in b." 1400
1735B "Tea with Tangerines" greedy,math "There are n pieces of tangerine peel, the i-th of them has size ai. In one step it is possible to divide one piece of size x into two pieces of positive integer sizes y and z so that y+z=x.You want that for each pair of pieces, their sizes differ strictly less than twice. In other words, there should not be two pieces of size x and y, such that 2x\xe2\x89\xa4y. What is the minimum possible number of steps needed to satisfy the condition?" 900
1735A "Working Week" "constructive algorithms,greedy,math" "Your working week consists of n days numbered from 1 to n, after day n goes day 1 again. And 3 of them are days off. One of the days off is the last day, day n. You have to decide when the other two are.Choosing days off, you pursue two goals:   No two days should go one after the other. Note that you can\'t make day 1 a day off because it follows day n.  Working segments framed by days off should be as dissimilar as possible in duration. More specifically, if the segments are of size l1, l2, and l3 days long, you want to maximize min(|l1\xe2\x88\x92l2|,|l2\xe2\x88\x92l3|,|l3\xe2\x88\x92l1|). Output the maximum value of min(|l1\xe2\x88\x92l2|,|l2\xe2\x88\x92l3|,|l3\xe2\x88\x92l1|) that can be obtained." 800
1734F "Zeros and Ones" "bitmasks,divide and conquer,dp,math" "Let S be the Thue-Morse sequence. In other words, S is the 0-indexed binary string with infinite length that can be constructed as follows:   Initially, let S be ""0"".  Then, we perform the following operation infinitely many times: concatenate S with a copy of itself with flipped bits.For example, here are the first four iterations:  IterationS before iterationS before iteration with flipped bitsConcatenated S1010120110011030110100101101001401101001100101100110100110010110\xe2\x80\xa6\xe2\x80\xa6\xe2\x80\xa6\xe2\x80\xa6  You are given two positive integers n and m. Find the number of positions where the strings S0S1\xe2\x80\xa6Sm\xe2\x88\x921 and SnSn+1\xe2\x80\xa6Sn+m\xe2\x88\x921 are different." 2500
1734E "Rectangular Congruence" "constructive algorithms,number theory" "You are given a prime number n, and an array of n integers b1,b2,\xe2\x80\xa6,bn, where 0\xe2\x89\xa4bi<n for each 1\xe2\x89\xa4i\xe2\x89\xa4n.You have to find a matrix a of size n\xc3\x97n such that all of the following requirements hold:  0\xe2\x89\xa4ai,j<n for all 1\xe2\x89\xa4i,j\xe2\x89\xa4n.  ar1,c1+ar2,c2\xe2\x89\xa2ar1,c2+ar2,c1(modn) for all positive integers r1, r2, c1, and c2 such that 1\xe2\x89\xa4r1<r2\xe2\x89\xa4n and 1\xe2\x89\xa4c1<c2\xe2\x89\xa4n. ai,i=bi for all 1\xe2\x89\xa4i\xe2\x89\xa4n. Here x\xe2\x89\xa2y(modm) denotes that x and y give different remainders when divided by m.If there are multiple solutions, output any. It can be shown that such a matrix always exists under the given constraints." 2100
1734D "Slime Escape" "data structures,dp,greedy,two pointers" "You are playing a game called Slime Escape. The game takes place on a number line. Initially, there are n slimes. For all positive integers i where 1\xe2\x89\xa4i\xe2\x89\xa4n, the i-th slime is located at position i and has health ai. You are controlling the slime at position k. There are two escapes located at positions 0 and n+1. Your goal is to reach any one of the two escapes by performing any number of game moves.In one game move, you move your slime to the left or right by one position. However, if there is another slime in the new position, you must absorb it. When absorbing a slime, the health of your slime would be increased by the health of the absorbed slime, then the absorbed slime would be removed from the game.Note that some slimes might have negative health, so your health would decrease when absorbing such slimes. You lose the game immediately if your slime has negative health at any moment during the game.Can you reach one of two escapes by performing any number of game moves, without ever losing the game?" 1800
1734C "Removing Smallest Multiples" greedy,math "You are given a set S, which contains the first n positive integers: 1,2,\xe2\x80\xa6,n.You can perform the following operation on S any number of times (possibly zero):   Choose a positive integer k where 1\xe2\x89\xa4k\xe2\x89\xa4n, such that there exists a multiple of k in S. Then, delete the smallest multiple of k from S. This operation requires a cost of k. You are given a set T, which is a subset of S. Find the minimum possible total cost of operations such that S would be transformed into T. We can show that such a transformation is always possible." 1200
1734B "Bright, Nice, Brilliant" "constructive algorithms" "There is a pyramid which consists of n floors. The floors are numbered from top to bottom in increasing order. In the pyramid, the i-th floor consists of i rooms.Denote the j-th room on the i-th floor as (i,j). For all positive integers i and j such that 1\xe2\x89\xa4j\xe2\x89\xa4i<n, there are 2 one-way staircases which lead from (i,j) to (i+1,j) and from (i,j) to (i+1,j+1) respectively.In each room you can either put a torch or leave it empty. Define the brightness of a room (i,j) to be the number of rooms with a torch from which you can reach the room (i,j) through a non-negative number of staircases.For example, when n=5 and torches are placed in the rooms (1,1), (2,1), (3,2), (4,1), (4,3), and (5,3), the pyramid can be illustrated as follows:  In the above picture, rooms with torches are colored in yellow, and empty rooms are white. The blue numbers in the bottom-right corner indicate the brightness of the rooms.The room (4,2) (the room with a star) has brightness 3. In the picture below, the rooms from where you can reach (4,2) have red border. The brightness is 3 since there are three torches among these rooms.  The pyramid is called nice if and only if for all floors, all rooms in the floor have the same brightness.Define the brilliance of a nice pyramid to be the sum of brightness over the rooms (1,1), (2,1), (3,1), ..., (n,1).Find an arrangement of torches in the pyramid, such that the resulting pyramid is nice and its brilliance is maximized.We can show that an answer always exists. If there are multiple answers, output any one of them." 800
1734A "Select Three Sticks" "brute force,greedy,sortings" "You are given n sticks with positive integral length a1,a2,\xe2\x80\xa6,an.You can perform the following operation any number of times (possibly zero):   choose one stick, then either increase or decrease its length by 1. After each operation, all sticks should have positive lengths. What is the minimum number of operations that you have to perform such that it is possible to select three of the n sticks and use them without breaking to form an equilateral triangle?An equilateral triangle is a triangle where all of its three sides have the same length." 800
1733E Conveyor "constructive algorithms,dp,math" "There is a conveyor with 120 rows and 120 columns. Each row and column is numbered from 0 to 119, and the cell in i-th row and j-th column is denoted as (i,j). The top leftmost cell is (0,0). Each cell has a belt, and all belts are initially facing to the right.Initially, a slime ball is on the belt of (0,0), and other belts are empty. Every second, the state of the conveyor changes as follows:   All slime balls on the conveyor move one cell in the direction of the belt at the same time. If there is no cell in the moved position, the slime gets out of the conveyor, and if two slime balls move to the same cell, they merge into one.  All belts with slime ball in the previous second change direction at the same time: belts facing to the right become facing to the down, and vice versa.  A new slime ball is placed on cell (0,0). There are q queries, each being three integers t, x, and y. You have to find out if there is a slime at the cell (x,y) after t seconds from the start. Can you do it?" 2700
1733D2 "Zero-One (Hard Version)" dp,greedy "This is the hard version of this problem. In this version, n\xe2\x89\xa45000 holds, and this version has no restriction between x and y. You can make hacks only if both versions of the problem are solved.You are given two binary strings a and b, both of length n. You can do the following operation any number of times (possibly zero).   Select two indices l and r (l<r).  Change al to (1\xe2\x88\x92al), and ar to (1\xe2\x88\x92ar).  If l+1=r, the cost of the operation is x. Otherwise, the cost is y. You have to find the minimum cost needed to make a equal to b or say there is no way to do so." 2000
1733D1 "Zero-One (Easy Version)" "constructive algorithms,greedy,math" "This is the easy version of the problem. In this version, n\xe2\x89\xa43000, x\xe2\x89\xa5y holds. You can make hacks only if both versions of the problem are solved.You are given two binary strings a and b, both of length n. You can do the following operation any number of times (possibly zero).   Select two indices l and r (l<r).  Change al to (1\xe2\x88\x92al), and ar to (1\xe2\x88\x92ar).  If l+1=r, the cost of the operation is x. Otherwise, the cost is y. You have to find the minimum cost needed to make a equal to b or say there is no way to do so." 1400
1733C "Parity Shuffle Sorting" "constructive algorithms,sortings" "You are given an array a with n non-negative integers. You can apply the following operation on it.   Choose two indices l and r (1\xe2\x89\xa4l<r\xe2\x89\xa4n).  If al+ar is odd, do ar:=al. If al+ar is even, do al:=ar. Find any sequence of at most n operations that makes a non-decreasing. It can be proven that it is always possible. Note that you do not have to minimize the number of operations.An array a1,a2,\xe2\x80\xa6,an is non-decreasing if and only if a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x80\xa6\xe2\x89\xa4an." 1300
1733B "Rule of League" "constructive algorithms,math" "There is a badminton championship in which n players take part. The players are numbered from 1 to n. The championship proceeds as follows: player 1 and player 2 play a game, then the winner and player 3 play a game, and then the winner and player 4 play a game, and so on. So, n\xe2\x88\x921 games are played, and the winner of the last game becomes the champion. There are no draws in the games.You want to find out the result of championship. Currently, you only know the following information:  Each player has either won x games or y games in the championship. Given n, x, and y, find out if there is a result that matches this information." 900
1733A "Consecutive Sum" greedy,sortings "You are given an array a with n integers. You can perform the following operation at most k times:  Choose two indices i and j, in which imodk=jmodk (1\xe2\x89\xa4i<j\xe2\x89\xa4n).  Swap ai and aj. After performing all operations, you have to select k consecutive elements, and the sum of the k elements becomes your score. Find the maximum score you can get.Here xmody denotes the remainder from dividing x by y." 800
1732E Location "data structures,dp,math,number theory" "You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bn. You need to handle q queries of the following two types: 1 l r x: assign ai:=x for all l\xe2\x89\xa4i\xe2\x89\xa4r; 2 l r: find the minimum value of the following expression among all l\xe2\x89\xa4i\xe2\x89\xa4r: lcm(ai,bi)gcd(ai,bi).In this problem gcd(x,y) denotes the greatest common divisor of x and y, and lcm(x,y) denotes the least common multiple of x and y." 2800
1732D2 "Balance (Hard version)" "brute force,data structures,number theory" "This is the hard version of the problem. The only difference is that in this version there are remove queries.Initially you have a set containing one element \xe2\x80\x94 0. You need to handle q queries of the following types:+ x \xe2\x80\x94 add the integer x to the set. It is guaranteed that this integer is not contained in the set; - x \xe2\x80\x94 remove the integer x from the set. It is guaranteed that this integer is contained in the set; ? k \xe2\x80\x94 find the k-mex of the set. In our problem, we define the k-mex of a set of integers as the smallest non-negative integer x that is divisible by k and which is not contained in the set." 2400
1732D1 "Balance (Easy version)" "brute force,data structures,implementation,number theory" "This is the easy version of the problem. The only difference is that in this version there are no ""remove"" queries.Initially you have a set containing one element \xe2\x80\x94 0. You need to handle q queries of the following types:+ x \xe2\x80\x94 add the integer x to the set. It is guaranteed that this integer is not contained in the set; ? k \xe2\x80\x94 find the k-mex of the set. In our problem, we define the k-mex of a set of integers as the smallest non-negative integer x that is divisible by k and which is not contained in the set." 1500
1732C2 "Sheikh (Hard Version)" "binary search,bitmasks,brute force,greedy,implementation,two pointers" "This is the hard version of the problem. The only difference is that in this version q=n.You are given an array of integers a1,a2,\xe2\x80\xa6,an.The cost of a subsegment of the array [l,r], 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, is the value f(l,r)=sum(l,r)\xe2\x88\x92xor(l,r), where sum(l,r)=al+al+1+\xe2\x80\xa6+ar, and xor(l,r)=al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar (\xe2\x8a\x95 stands for bitwise XOR).You will have q queries. Each query is given by a pair of numbers Li, Ri, where 1\xe2\x89\xa4Li\xe2\x89\xa4Ri\xe2\x89\xa4n. You need to find the subsegment [l,r], Li\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4Ri, with maximum value f(l,r). If there are several answers, then among them you need to find a subsegment with the minimum length, that is, the minimum value of r\xe2\x88\x92l+1." 2100
1732C1 "Sheikh (Easy version)" "binary search,bitmasks,greedy,two pointers" "This is the easy version of the problem. The only difference is that in this version q=1.You are given an array of integers a1,a2,\xe2\x80\xa6,an.The cost of a subsegment of the array [l,r], 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, is the value f(l,r)=sum(l,r)\xe2\x88\x92xor(l,r), where sum(l,r)=al+al+1+\xe2\x80\xa6+ar, and xor(l,r)=al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar (\xe2\x8a\x95 stands for bitwise XOR).You will have q=1 query. Each query is given by a pair of numbers Li, Ri, where 1\xe2\x89\xa4Li\xe2\x89\xa4Ri\xe2\x89\xa4n. You need to find the subsegment [l,r], Li\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4Ri, with maximum value f(l,r). If there are several answers, then among them you need to find a subsegment with the minimum length, that is, the minimum value of r\xe2\x88\x92l+1." 1800
1732B Ugu "brute force,dp,greedy,implementation" "A binary string is a string consisting only of the characters 0 and 1. You are given a binary string s1s2\xe2\x80\xa6sn. It is necessary to make this string non-decreasing in the least number of operations. In other words, each character should be not less than the previous. In one operation, you can do the following: Select an arbitrary index 1\xe2\x89\xa4i\xe2\x89\xa4n in the string; For all j\xe2\x89\xa5i, change the value in the j-th position to the opposite, that is, if sj=1, then make sj=0, and vice versa.What is the minimum number of operations needed to make the string non-decreasing?" 900
1732A Bestie "brute force,combinatorics,constructive algorithms,implementation,math,number theory" "You are given an array a consisting of n integers a1,a2,\xe2\x80\xa6,an. Friends asked you to make the greatest common divisor (GCD) of all numbers in the array equal to 1. In one operation, you can do the following: Select an arbitrary index in the array 1\xe2\x89\xa4i\xe2\x89\xa4n; Make ai=gcd(ai,i), where gcd(x,y) denotes the GCD of integers x and y. The cost of such an operation is n\xe2\x88\x92i+1.You need to find the minimum total cost of operations we need to perform so that the GCD of the all array numbers becomes equal to 1." 1000
1731F "Function Sum" "brute force,combinatorics,dp,fft,math" "Suppose you have an integer array a1,a2,\xe2\x80\xa6,an.Let lsl(i) be the number of indices j (1\xe2\x89\xa4j<i) such that aj<ai.Analogically, let grr(i) be the number of indices j (i<j\xe2\x89\xa4n) such that aj>ai.Let\'s name position i good in the array a if lsl(i)<grr(i).Finally, let\'s define a function f on array a f(a) as the sum of all ai such that i is good in a.Given two integers n and k, find the sum of f(a) over all arrays a of size n such that 1\xe2\x89\xa4ai\xe2\x89\xa4k for all 1\xe2\x89\xa4i\xe2\x89\xa4n modulo 998244353." 2500
1731E "Graph Cost" "dp,greedy,math,number theory" "You are given an initially empty undirected graph with n nodes, numbered from 1 to n (i. e. n nodes and 0 edges). You want to add m edges to the graph, so the graph won\'t contain any self-loop or multiple edges.If an edge connecting two nodes u and v is added, its weight must be equal to the greatest common divisor of u and v, i. e. gcd(u,v).In order to add edges to the graph, you can repeat the following process any number of times (possibly zero):   choose an integer k\xe2\x89\xa51;  add exactly k edges to the graph, each having a weight equal to k+1. Adding these k edges costs k+1 in total.  Note that you can\'t create self-loops or multiple edges. Also, if you can\'t add k edges of weight k+1, you can\'t choose such k.For example, if you can add 5 more edges to the graph of weight 6, you may add them, and it will cost 6 for the whole pack of 5 edges. But if you can only add 4 edges of weight 6 to the graph, you can\'t perform this operation for k=5.Given two integers n and m, find the minimum total cost to form a graph of n vertices and exactly m edges using the operation above. If such a graph can\'t be constructed, output \xe2\x88\x921.Note that the final graph may consist of several connected components." 2000
1731D "Valiant\'s New Map" "binary search,brute force,data structures,dp,two pointers" "Game studio ""DbZ Games"" wants to introduce another map in their popular game ""Valiant"". This time, the map named ""Panvel"" will be based on the city of Mumbai.Mumbai can be represented as n\xc3\x97m cellular grid. Each cell (i,j) (1\xe2\x89\xa4i\xe2\x89\xa4n; 1\xe2\x89\xa4j\xe2\x89\xa4m) of the grid is occupied by a cuboid building of height ai,j.This time, DbZ Games want to make a map that has perfect vertical gameplay. That\'s why they want to choose an l\xc3\x97l square inside Mumbai, such that each building inside the square has a height of at least l.Can you help DbZ Games find such a square of the maximum possible size l?" 1700
1731C "Even Subarrays" "bitmasks,brute force,hashing,math,number theory" "You are given an integer array a1,a2,\xe2\x80\xa6,an (1\xe2\x89\xa4ai\xe2\x89\xa4n).Find the number of subarrays of a whose XOR has an even number of divisors. In other words, find all pairs of indices (i,j) (i\xe2\x89\xa4j) such that ai\xe2\x8a\x95ai+1\xe2\x8a\x95\xe2\x8b\xaf\xe2\x8a\x95aj has an even number of divisors.For example, numbers 2, 3, 5 or 6 have an even number of divisors, while 1 and 4 \xe2\x80\x94 odd. Consider that 0 has an odd number of divisors in this task.Here XOR (or \xe2\x8a\x95) denotes the bitwise XOR operation.Print the number of subarrays but multiplied by 2022... Okay, let\'s stop. Just print the actual answer." 1700
1731B "Kill Demodogs" greedy,math "Demodogs from the Upside-down have attacked Hawkins again. El wants to reach Mike and also kill as many Demodogs in the way as possible.Hawkins can be represented as an n\xc3\x97n grid. The number of Demodogs in a cell at the i-th row and the j-th column is i\xe2\x8b\x85j. El is at position (1,1) of the grid, and she has to reach (n,n) where she can find Mike. The only directions she can move are the right (from (i,j) to (i,j+1)) and the down (from (i,j) to (i+1,j)). She can\'t go out of the grid, as there are doors to the Upside-down at the boundaries. Calculate the maximum possible number of Demodogs ans she can kill on the way, considering that she kills all Demodogs in cells she visits (including starting and finishing cells).Print 2022\xe2\x8b\x85ans modulo 109+7. Modulo 109+7 because the result can be too large and multiplied by 2022 because we are never gonna see it again!(Note, you firstly multiply by 2022 and only after that take the remainder.)" 1100
1731A "Joey Takes Money" greedy,math "Joey is low on money. His friend Chandler wants to lend Joey some money, but can\'t give him directly, as Joey is too proud of himself to accept it. So, in order to trick him, Chandler asks Joey to play a game.In this game, Chandler gives Joey an array a1,a2,\xe2\x80\xa6,an (n\xe2\x89\xa52) of positive integers (ai\xe2\x89\xa51).Joey can perform the following operation on the array any number of times:   Take two indices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n).  Choose two integers x and y (x,y\xe2\x89\xa51) such that x\xe2\x8b\x85y=ai\xe2\x8b\x85aj.  Replace ai by x and aj by y. In the end, Joey will get the money equal to the sum of elements of the final array. Find the maximum amount of money ans Joey can get but print 2022\xe2\x8b\x85ans. Why multiplied by 2022? Because we are never gonna see it again!It is guaranteed that the product of all the elements of the array a doesn\'t exceed 1012." 800
1730F "Almost Sorted" "bitmasks,data structures,dp" "You are given a permutation p of length n and a positive integer k. Consider a permutation q of length n such that for any integers i and j, where 1\xe2\x89\xa4i<j\xe2\x89\xa4n, we have pqi\xe2\x89\xa4pqj+k.Find the minimum possible number of inversions in a permutation q.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array).An inversion in a permutation a is a pair of indices i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that i<j, but ai>aj." 2700
1730E "Maximums and Minimums" "combinatorics,data structures,divide and conquer,number theory" "You are given an array a1,a2,\xe2\x80\xa6,an of positive integers.Find the number of pairs of indices (l,r), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, that pass the check. The check is performed in the following manner:   The minimum and maximum numbers are found among al,al+1,\xe2\x80\xa6,ar.  The check is passed if the maximum number is divisible by the minimum number." 2700
1730D "Prefixes and Suffixes" "constructive algorithms,strings,two pointers" "You have two strings s1 and s2 of length n, consisting of lowercase English letters. You can perform the following operation any (possibly zero) number of times:   Choose a positive integer 1\xe2\x89\xa4k\xe2\x89\xa4n.  Swap the prefix of the string s1 and the suffix of the string s2 of length k. Is it possible to make these two strings equal by doing described operations?" 2200
1730C "Minimum Notation" "data structures,greedy,math,sortings" "You have a string s consisting of digits from 0 to 9 inclusive. You can perform the following operation any (possibly zero) number of times:   You can choose a position i and delete a digit d on the i-th position. Then insert the digit min(d+1,9) on any position (at the beginning, at the end or in between any two adjacent digits). What is the lexicographically smallest string you can get by performing these operations?A string a is lexicographically smaller than a string b of the same length if and only if the following holds:   in the first position where a and b differ, the string a has a smaller digit than the corresponding digit in b." 1200
1730B "Meeting on the Line" "binary search,geometry,greedy,implementation,math,ternary search" "n people live on the coordinate line, the i-th one lives at the point xi (1\xe2\x89\xa4i\xe2\x89\xa4n). They want to choose a position x0 to meet. The i-th person will spend |xi\xe2\x88\x92x0| minutes to get to the meeting place. Also, the i-th person needs ti minutes to get dressed, so in total he or she needs ti+|xi\xe2\x88\x92x0| minutes. Here |y| denotes the absolute value of y.These people ask you to find a position x0 that minimizes the time in which all n people can gather at the meeting place." 1600
1730A Planets "data structures,greedy,sortings" "One day, Vogons wanted to build a new hyperspace highway through a distant system with n planets. The i-th planet is on the orbit ai, there could be multiple planets on the same orbit. It\'s a pity that all the planets are on the way and need to be destructed.Vogons have two machines to do that.  The first machine in one operation can destroy any planet at cost of 1 Triganic Pu.  The second machine in one operation can destroy all planets on a single orbit in this system at the cost of c Triganic Pus. Vogons can use each machine as many times as they want.Vogons are very greedy, so they want to destroy all planets with minimum amount of money spent. Can you help them to know the minimum cost of this project?" 800
1729G "Cut Substrings" "combinatorics,dp,hashing,strings,two pointers" "You are given two non-empty strings s and t, consisting of Latin letters.In one move, you can choose an occurrence of the string t in the string s and replace it with dots.Your task is to remove all occurrences of the string t in the string s in the minimum number of moves, and also calculate how many different sequences of moves of the minimum length exist.Two sequences of moves are considered different if the sets of indices at which the removed occurrences of the string t in s begin differ. For example, the sets {1,2,3} and {1,2,4} are considered different, the sets {2,4,6} and {2,6} \xe2\x80\x94 too, but sets {3,5} and {5,3} \xe2\x80\x94 not.For example, let the string s= ""abababacababa"" and the string t= ""aba"". We can remove all occurrences of the string t in 2 moves by cutting out the occurrences of the string t at the 3th and 9th positions. In this case, the string s is an example of the form ""ab...bac...ba"". It is also possible to cut occurrences of the string t at the 3th and 11th positions. There are two different sequences of minimum length moves.Since the answer can be large, output it modulo 109+7." 2100
1729F "Kirei and the Linear Function" hashing,math "Given the string s of decimal digits (0-9) of length n.A substring is a sequence of consecutive characters of a string. The substring of this string is defined by a pair of indexes \xe2\x80\x94 with its left and right ends. So, each pair of indexes (l,r), where 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, corresponds to a substring of the string s. We will define as v(l,r) the numeric value of the corresponding substring (leading zeros are allowed in it).For example, if n=7, s=""1003004"", then v(1,3)=100, v(2,3)=0 and v(2,7)=3004.You are given n, s and an integer w (1\xe2\x89\xa4w<n).You need to process m queries, each of which is characterized by 3 numbers li,ri,ki (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n;0\xe2\x89\xa4ki\xe2\x89\xa48).The answer to the ith query is such a pair of substrings of length w that if we denote them as (L1,L1+w\xe2\x88\x921) and (L2,L2+w\xe2\x88\x921), then:  L1\xe2\x89\xa0L2, that is, the substrings are different;  the remainder of dividing a number v(L1,L1+w\xe2\x88\x921)\xe2\x8b\x85v(li,ri)+v(L2,L2+w\xe2\x88\x921) by 9 is equal to ki. If there are many matching substring pairs, then find a pair where L1 is as small as possible. If there are many matching pairs in this case, then minimize L2.Note that the answer may not exist." 1900
1729E "Guess the Cycle Size" interactive,probabilities "This is an interactive problem.I want to play a game with you...We hid from you a cyclic graph of n vertices (3\xe2\x89\xa4n\xe2\x89\xa41018). A cyclic graph is an undirected graph of n vertices that form one cycle. Each vertex belongs to the cycle, i.e. the length of the cycle (the number of edges in it) is exactly n. The order of the vertices in the cycle is arbitrary.You can make queries in the following way: ""? a b"" where 1\xe2\x89\xa4a,b\xe2\x89\xa41018 and a\xe2\x89\xa0b. In response to the query, the interactor outputs on a separate line the length of random of two paths from vertex a to vertex b, or -1 if max(a,b)>n. The interactor chooses one of the two paths with equal probability. The length of the path \xe2\x80\x94is the number of edges in it.You win if you guess the number of vertices in the hidden graph (number n) by making no more than 50 queries.Note that the interactor is implemented in such a way that for any ordered pair (a,b), it always returns the same value for query ""? a b"", no matter how many such queries. Note that the ""? b a"" query may be answered differently by the interactor.The vertices in the graph are randomly placed, and their positions are fixed in advance.Hacks are forbidden in this problem. The number of tests the jury has is 50." 1800
1729D "Friends and the Restaurant" "greedy,sortings,two pointers" "A group of n friends decide to go to a restaurant. Each of the friends plans to order meals for xi burles and has a total of yi burles (1\xe2\x89\xa4i\xe2\x89\xa4n). The friends decide to split their visit to the restaurant into several days. Each day, some group of at least two friends goes to the restaurant. Each of the friends visits the restaurant no more than once (that is, these groups do not intersect). These groups must satisfy the condition that the total budget of each group must be not less than the amount of burles that the friends in the group are going to spend at the restaurant. In other words, the sum of all xi values in the group must not exceed the sum of yi values in the group.What is the maximum number of days friends can visit the restaurant?For example, let there be n=6 friends for whom x = [8,3,9,2,4,5] and y = [5,3,1,4,5,10]. Then:   first and sixth friends can go to the restaurant on the first day. They will spend 8+5=13 burles at the restaurant, and their total budget is 5+10=15 burles. Since 15\xe2\x89\xa513, they can actually form a group.  friends with indices 2,4,5 can form a second group. They will spend 3+2+4=9 burles at the restaurant, and their total budget will be 3+4+5=12 burles (12\xe2\x89\xa59). It can be shown that they will not be able to form more groups so that each group has at least two friends and each group can pay the bill.So, the maximum number of groups the friends can split into is 2. Friends will visit the restaurant for a maximum of two days. Note that the 3-rd friend will not visit the restaurant at all.Output the maximum number of days the friends can visit the restaurant for given n, x and y." 1200
1729C "Jumping on Tiles" "constructive algorithms,strings" "Polycarp was given a row of tiles. Each tile contains one lowercase letter of the Latin alphabet. The entire sequence of tiles forms the string s.In other words, you are given a string s consisting of lowercase Latin letters.Initially, Polycarp is on the first tile of the row and wants to get to the last tile by jumping on the tiles. Jumping from i-th tile to j-th tile has a cost equal to |index(si)\xe2\x88\x92index(sj)|, where index(c) is the index of the letter c in the alphabet (for example, index(\'a\')=1, index(\'b\')=2, ..., index(\'z\')=26) .Polycarp wants to get to the n-th tile for the minimum total cost, but at the same time make maximum number of jumps.In other words, among all possible ways to get to the last tile for the minimum total cost, he will choose the one with the maximum number of jumps.Polycarp can visit each tile at most once.Polycarp asks you to help \xe2\x80\x94 print the sequence of indices of string s on which he should jump." 1100
1729B "Decode String" greedy,strings "Polycarp has a string s consisting of lowercase Latin letters.He encodes it using the following algorithm.He goes through the letters of the string s from left to right and for each letter Polycarp considers its number in the alphabet:  if the letter number is single-digit number (less than 10), then just writes it out;  if the letter number is a two-digit number (greater than or equal to 10), then it writes it out and adds the number 0 after. For example, if the string s is code, then Polycarp will encode this string as follows:  \'c\' \xe2\x80\x94 is the 3-rd letter of the alphabet. Consequently, Polycarp adds 3 to the code (the code becomes equal to 3);  \'o\' \xe2\x80\x94 is the 15-th letter of the alphabet. Consequently, Polycarp adds 15 to the code and also 0 (the code becomes 3150);  \'d\' \xe2\x80\x94 is the 4-th letter of the alphabet. Consequently, Polycarp adds 4 to the code (the code becomes 31504);  \'e\' \xe2\x80\x94 is the 5-th letter of the alphabet. Therefore, Polycarp adds 5 to the code (the code becomes 315045). Thus, code of string code is 315045.You are given a string t resulting from encoding the string s. Your task is to decode it (get the original string s by t)." 800
1729A "Two Elevators" math "Vlad went into his appartment house entrance, now he is on the 1-th floor. He was going to call the elevator to go up to his apartment.There are only two elevators in his house. Vlad knows for sure that:  the first elevator is currently on the floor a (it is currently motionless),  the second elevator is located on floor b and goes to floor c (b\xe2\x89\xa0c). Please note, if b=1, then the elevator is already leaving the floor 1 and Vlad does not have time to enter it. If you call the first elevator, it will immediately start to go to the floor 1. If you call the second one, then first it will reach the floor c and only then it will go to the floor 1. It takes |x\xe2\x88\x92y| seconds for each elevator to move from floor x to floor y.Vlad wants to call an elevator that will come to him faster. Help him choose such an elevator." 800
1728G Illumination "binary search,bitmasks,brute force,combinatorics,dp,math,two pointers" "Consider a segment [0,d] of the coordinate line. There are n lanterns and m points of interest in this segment.For each lantern, you can choose its power \xe2\x80\x94 an integer between 0 and d (inclusive). A lantern with coordinate x illuminates the point of interest with coordinate y if |x\xe2\x88\x92y| is less than or equal to the power of the lantern.A way to choose the power values for all lanterns is considered valid if every point of interest is illuminated by at least one lantern.You have to process q queries. Each query is represented by one integer fi. To answer the i-th query, you have to:  add a lantern on coordinate fi;  calculate the number of valid ways to assign power values to all lanterns, and print it modulo 998244353;  remove the lantern you just added." 2700
1728F Fishermen "flows,graph matchings,greedy" "There are n fishermen who have just returned from a fishing trip. The i-th fisherman has caught a fish of size ai.The fishermen will choose some order in which they are going to tell the size of the fish they caught (the order is just a permutation of size n). However, they are not entirely honest, and they may ""increase"" the size of the fish they have caught.Formally, suppose the chosen order of the fishermen is [p1,p2,p3,\xe2\x80\xa6,pn]. Let bi be the value which the i-th fisherman in the order will tell to the other fishermen. The values bi are chosen as follows:  the first fisherman in the order just honestly tells the actual size of the fish he has caught, so b1=ap1;  every other fisherman wants to tell a value that is strictly greater than the value told by the previous fisherman, and is divisible by the size of the fish that the fisherman has caught. So, for i>1, bi is the smallest integer that is both strictly greater than bi\xe2\x88\x921 and divisible by api. For example, let n=7, a=[1,8,2,3,2,2,3]. If the chosen order is p=[1,6,7,5,3,2,4], then:  b1=ap1=1;  b2 is the smallest integer divisible by 2 and greater than 1, which is 2;  b3 is the smallest integer divisible by 3 and greater than 2, which is 3;  b4 is the smallest integer divisible by 2 and greater than 3, which is 4;  b5 is the smallest integer divisible by 2 and greater than 4, which is 6;  b6 is the smallest integer divisible by 8 and greater than 6, which is 8;  b7 is the smallest integer divisible by 3 and greater than 8, which is 9. You have to choose the order of fishermen in a way that yields the minimum possible n\xe2\x88\x91i=1bi." 3100
1728E "Red-Black Pepper" "brute force,data structures,greedy,math,number theory" "Monocarp is going to host a party for his friends. He prepared n dishes and is about to serve them. First, he has to add some powdered pepper to each of them \xe2\x80\x94 otherwise, the dishes will be pretty tasteless.The i-th dish has two values ai and bi \xe2\x80\x94 its tastiness with red pepper added or black pepper added, respectively. Monocarp won\'t add both peppers to any dish, won\'t add any pepper multiple times, and won\'t leave any dish without the pepper added.Before adding the pepper, Monocarp should first purchase the said pepper in some shop. There are m shops in his local area. The j-th of them has packages of red pepper sufficient for xj servings and packages of black pepper sufficient for yj servings.Monocarp goes to exactly one shop, purchases multiple (possibly, zero) packages of each pepper in such a way that each dish will get the pepper added once, and no pepper is left. More formally, if he purchases x red pepper packages and y black pepper packages, then x and y should be non-negative and x\xe2\x8b\x85xj+y\xe2\x8b\x85yj should be equal to n.For each shop, determine the maximum total tastiness of the dishes after Monocarp buys pepper packages only in this shop and adds the pepper to the dishes. If it\'s impossible to purchase the packages in the said way, print -1." 2300
1728D "Letter Picking" "constructive algorithms,dp,games,two pointers" "Alice and Bob are playing a game. Initially, they are given a non-empty string s, consisting of lowercase Latin letters. The length of the string is even. Each player also has a string of their own, initially empty.Alice starts, then they alternate moves. In one move, a player takes either the first or the last letter of the string s, removes it from s and prepends (adds to the beginning) it to their own string.The game ends when the string s becomes empty. The winner is the player with a lexicographically smaller string. If the players\' strings are equal, then it\'s a draw.A string a is lexicographically smaller than a string b if there exists such position i that aj=bj for all j<i and ai<bi.What is the result of the game if both players play optimally (e.\xe2\x80\x89g. both players try to win; if they can\'t, then try to draw)?" 1800
1728C "Digital Logarithm" "data structures,greedy,sortings" "Let\'s define f(x) for a positive integer x as the length of the base-10 representation of x without leading zeros. I like to call it a digital logarithm. Similar to a digital root, if you are familiar with that.You are given two arrays a and b, each containing n positive integers. In one operation, you do the following:   pick some integer i from 1 to n;  assign either f(ai) to ai or f(bi) to bi. Two arrays are considered similar to each other if you can rearrange the elements in both of them, so that they are equal (e.\xe2\x80\x89g. ai=bi for all i from 1 to n).What\'s the smallest number of operations required to make a and b similar to each other?" 1400
1728B "Best Permutation" "constructive algorithms,greedy" "Let\'s define the value of the permutation p of n integers 1, 2, ..., n (a permutation is an array where each element from 1 to n occurs exactly once) as follows:  initially, an integer variable x is equal to 0;  if x<p1, then add p1 to x (set x=x+p1), otherwise assign 0 to x;  if x<p2, then add p2 to x (set x=x+p2), otherwise assign 0 to x;  ...  if x<pn, then add pn to x (set x=x+pn), otherwise assign 0 to x;  the value of the permutation is x at the end of this process. For example, for p=[4,5,1,2,3,6], the value of x changes as follows: 0,4,9,0,2,5,11, so the value of the permutation is 11.You are given an integer n. Find a permutation p of size n with the maximum possible value among all permutations of size n. If there are several such permutations, you can print any of them." 800
1728A "Colored Balls: Revisited" "brute force,greedy,implementation,sortings" "The title is a reference to the very first Educational Round from our writers team, Educational Round 18.There is a bag, containing colored balls. There are n different colors of balls, numbered from 1 to n. There are cnti balls of color i in the bag. The total amount of balls in the bag is odd (e.\xe2\x80\x89g. cnt1+cnt2+\xe2\x8b\xaf+cntn is odd).In one move, you can choose two balls with different colors and take them out of the bag.At some point, all the remaining balls in the bag will have the same color. That\'s when you can\'t make moves anymore.Find any possible color of the remaining balls." 800
1726H "Mainak and the Bleeding Polygon" "binary search,geometry,implementation,math" "Mainak has a convex polygon P with n vertices labelled as A1,A2,\xe2\x80\xa6,An in a counter-clockwise fashion. The coordinates of the i-th point Ai are given by (xi,yi), where xi and yi are both integers.Further, it is known that the interior angle at Ai is either a right angle or a proper obtuse angle. Formally it is known that:   90\xe2\x88\x98\xe2\x89\xa4\xe2\x88\xa0Ai\xe2\x88\x921AiAi+1<180\xe2\x88\x98, \xe2\x88\x80i\xe2\x88\x88{1,2,\xe2\x80\xa6,n} where we conventionally consider A0=An and An+1=A1. Mainak\'s friend insisted that all points Q such that there exists a chord of the polygon P passing through Q with length not exceeding 1, must be coloured red. Mainak wants you to find the area of the coloured region formed by the red points.Formally, determine the area of the region S={Q\xe2\x88\x88P | Q is coloured red}.Recall that a chord of a polygon is a line segment between two points lying on the boundary (i.e. vertices or points on edges) of the polygon." 3500
1726G "A Certain Magical Party" "combinatorics,data structures,greedy,sortings" "There are n people at a party. The i-th person has an amount of happiness ai.Every person has a certain kind of personality which can be represented as a binary integer b. If b=0, it means the happiness of the person will increase if he tells the story to someone strictly less happy than them. If b=1, it means the happiness of the person will increase if he tells the story to someone strictly more happy than them.Let us define a speaking order as an ordering of the people from left to right. Now the following process occurs. We go from left to right. The current person tells the story to all people other than himself. Note that all happiness values stay constant while this happens. After the person is done, he counts the number of people who currently have strictly less/more happiness than him as per his kind of personality, and his happiness increases by that value. Note that only the current person\'s happiness value increases.As the organizer of the party, you don\'t want anyone to leave sad. Therefore, you want to count the number of speaking orders such that at the end of the process all n people have equal happiness.Two speaking orders are considered different if there exists at least one person who does not have the same position in the two speaking orders." 3300
1726F "Late For Work (submissions are not allowed)" "data structures,greedy,schedules,shortest paths" "This problem was copied by the author from another online platform. Codeforces strongly condemns this action and therefore further submissions to this problem are not accepted.Debajyoti has a very important meeting to attend and he is already very late. Harsh, his driver, needs to take Debajyoti to the destination for the meeting as fast as possible.Harsh needs to pick up Debajyoti from his home and take him to the destination so that Debajyoti can attend the meeting in time. A straight road with n traffic lights connects the home and the destination for the interview. The traffic lights are numbered in order from 1 to n.Each traffic light cycles after t seconds. The i-th traffic light is green (in which case Harsh can cross the traffic light) for the first gi seconds, and red (in which case Harsh must wait for the light to turn green) for the remaining (t\xe2\x88\x92gi) seconds, after which the pattern repeats. Each light\'s cycle repeats indefinitely and initially, the i-th light is ci seconds into its cycle (a light with ci=0 has just turned green). In the case that Harsh arrives at a light at the same time it changes colour, he will obey the new colour. Formally, the i-th traffic light is green from [0,gi) and red from [gi,t) (after which it repeats the cycle). The i-th traffic light is initially at the ci-th second of its cycle.From the i-th traffic light, exactly di seconds are required to travel to the next traffic light (that is to the (i+1)-th light). Debajyoti\'s home is located just before the first light and Debajyoti drops for the interview as soon as he passes the n-th light. In other words, no time is required to reach the first light from Debajyoti\'s home or to reach the interview centre from the n-th light.Harsh does not know how much longer it will take for Debajyoti to get ready. While waiting, he wonders what is the minimum possible amount of time he will spend driving provided he starts the moment Debajyoti arrives, which can be anywhere between 0 to \xe2\x88\x9e seconds from now. Can you tell Harsh the minimum possible amount of time he needs to spend on the road?Please note that Harsh can only start or stop driving at integer moments of time." 2900
1726E "Almost Perfect" combinatorics,fft,math "A permutation p of length n is called almost perfect if for all integer 1\xe2\x89\xa4i\xe2\x89\xa4n, it holds that |pi\xe2\x88\x92p\xe2\x88\x921i|\xe2\x89\xa41, where p\xe2\x88\x921 is the inverse permutation of p (i.e. p\xe2\x88\x921k1=k2 if and only if pk2=k1).Count the number of almost perfect permutations of length n modulo 998244353." 2400
1726D "Edge Split" "brute force,constructive algorithms,dfs and similar,dsu,graphs,probabilities,trees" "You are given a connected, undirected and unweighted graph with n vertices and m edges. Notice the limit on the number of edges: m\xe2\x89\xa4n+2.Let\'s say we color some of the edges red and the remaining edges blue. Now consider only the red edges and count the number of connected components in the graph. Let this value be c1. Similarly, consider only the blue edges and count the number of connected components in the graph. Let this value be c2.Find an assignment of colors to the edges such that the quantity c1+c2 is minimised." 2000
1726C "Jatayu\'s Balanced Bracket Sequence" "data structures,dsu,graphs,greedy" "Last summer, Feluda gifted Lalmohan-Babu a balanced bracket sequence ss of length 2n2n.Topshe was bored during his summer vacations, and hence he decided to draw an undirected graph of 2n2n vertices using the balanced bracket sequence ss. For any two distinct vertices ii and jj (1\xe2\x89\xa4i<j\xe2\x89\xa42n1\xe2\x89\xa4i<j\xe2\x89\xa42n), Topshe draws an edge (undirected and unweighted) between these two nodes if and only if the subsegment s[i\xe2\x80\xa6j]s[i\xe2\x80\xa6j] forms a balanced bracket sequence.Determine the number of connected components in Topshe\'s graph.See the Notes section for definitions of the underlined terms." 1300
1726B "Mainak and Interesting Sequence" "bitmasks,constructive algorithms,math" "Mainak has two positive integers n and m.Mainak finds a sequence a1,a2,\xe2\x80\xa6,an of n positive integers interesting, if for all integers i (1\xe2\x89\xa4i\xe2\x89\xa4n), the bitwise XOR of all elements in a which are strictly less than ai is 0. Formally if pi is the bitwise XOR of all elements in a which are strictly less than ai, then a is an interesting sequence if p1=p2=\xe2\x80\xa6=pn=0.For example, sequences [1,3,2,3,1,2,3], [4,4,4,4], [25] are interesting, whereas [1,2,3,4] (p2=1\xe2\x89\xa00), [4,1,1,2,4] (p1=1\xe2\x8a\x951\xe2\x8a\x952=2\xe2\x89\xa00), [29,30,30] (p2=29\xe2\x89\xa00) aren\'t interesting.Here a\xe2\x8a\x95b denotes bitwise XOR of integers a and b.Find any interesting sequence a1,a2,\xe2\x80\xa6,an (or report that there exists no such sequence) such that the sum of the elements in the sequence a is equal to m, i.e. a1+a2\xe2\x80\xa6+an=m.As a reminder, the bitwise XOR of an empty sequence is considered to be 0." 1100
1726A "Mainak and Array" greedy,math "Mainak has an array a1,a2,\xe2\x80\xa6,an of n positive integers. He will do the following operation to this array exactly once:  Pick a subsegment of this array and cyclically rotate it by any amount.  Formally, he can do the following exactly once:  Pick two integers l and r, such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, and any positive integer k.  Repeat this k times: set al=al+1,al+1=al+2,\xe2\x80\xa6,ar\xe2\x88\x921=ar,ar=al (all changes happen at the same time). Mainak wants to maximize the value of (an\xe2\x88\x92a1) after exactly one such operation. Determine the maximum value of (an\xe2\x88\x92a1) that he can obtain." 900
1725M "Moving Both Hands" "dp,graphs,shortest paths" "Pak Chanek is playing one of his favourite board games. In the game, there is a directed graph with N vertices and M edges. In the graph, edge i connects two different vertices Ui and Vi with a length of Wi. By using the i-th edge, something can move from Ui to Vi, but not from Vi to Ui.To play this game, initially Pak Chanek must place both of his hands onto two different vertices. In one move, he can move one of his hands to another vertex using an edge. To move a hand from vertex Ui to vertex Vi, Pak Chanek needs a time of Wi seconds. Note that Pak Chanek can only move one hand at a time. This game ends when both of Pak Chanek\'s hands are on the same vertex.Pak Chanek has several questions. For each p satisfying 2\xe2\x89\xa4p\xe2\x89\xa4N, you need to find the minimum time in seconds needed for Pak Chanek to end the game if initially Pak Chanek\'s left hand and right hand are placed on vertex 1 and vertex p, or report if it is impossible." 1800
1725L "Lemper Cooking Competition" "data structures" "Pak Chanek is participating in a lemper cooking competition. In the competition, Pak Chanek has to cook lempers with N stoves that are arranged sequentially from stove 1 to stove N. Initially, stove i has a temperature of Ai degrees. A stove can have a negative temperature.Pak Chanek realises that, in order for his lempers to be cooked, he needs to keep the temperature of each stove at a non-negative value. To make it happen, Pak Chanek can do zero or more operations. In one operation, Pak Chanek chooses one stove i with 2\xe2\x89\xa4i\xe2\x89\xa4N\xe2\x88\x921, then:  changes the temperature of stove i\xe2\x88\x921 into Ai\xe2\x88\x921:=Ai\xe2\x88\x921+Ai,  changes the temperature of stove i+1 into Ai+1:=Ai+1+Ai, and  changes the temperature of stove i into Ai:=\xe2\x88\x92Ai. Pak Chanek wants to know the minimum number of operations he needs to do such that the temperatures of all stoves are at non-negative values. Help Pak Chanek by telling him the minimum number of operations needed or by reporting if it is not possible to do." 2400
1725K "Kingdom of Criticism" "data structures,dsu" "Pak Chanek is visiting a kingdom that earned a nickname ""Kingdom of Criticism"" because of how often its residents criticise each aspect of the kingdom. One aspect that is often criticised is the heights of the buildings. The kingdom has N buildings. Initially, building i has a height of Ai units.At any point in time, the residents can give a new criticism, namely they currently do not like buildings with heights between l and r units inclusive for some two integers l and r. It is known that r\xe2\x88\x92l is always odd.In 1 minute, the kingdom\'s construction team can increase or decrease the height of any building by 1 unit as long as the height still becomes a positive number. Each time they receive the current criticism from the residents, the kingdom\'s construction team makes it so that there are no buildings with heights between l and r units inclusive in the minimum time possible. It can be obtained that there is only one way to do this. Note that the construction team only cares about the current criticism from the residents. All previous criticisms are forgotten.There will be Q queries that you must solve. Each query is one of the three following possibilities:   1 k w: The kingdom\'s construction team changes the height of building k to be w units (1\xe2\x89\xa4k\xe2\x89\xa4N, 1\xe2\x89\xa4w\xe2\x89\xa4109).  2 k: The kingdom\'s construction team wants you to find the height of building k (1\xe2\x89\xa4k\xe2\x89\xa4N).  3 l r: The residents currently do not like buildings with heights between l and r units inclusive (2\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4109\xe2\x88\x921, r\xe2\x88\x92l is odd). Note that each change in height still persists to the next queries." 2500
1725J Journey dp,trees "One day, Pak Chanek who is already bored of being alone at home decided to go traveling. While looking for an appropriate place, he found that Londonesia has an interesting structure.According to the information gathered by Pak Chanek, there are N cities numbered from 1 to N. The cities are connected to each other with N\xe2\x88\x921 two-directional roads, with the i-th road connecting cities Ui and Vi, and taking a time of Wi hours to be traversed. In other words, Londonesia\'s structure forms a tree.Pak Chanek wants to go on a journey in Londonesia starting and ending in any city (not necessarily the same city) such that each city is visited at least once with the least time possible. In order for the journey to end quicker, Pak Chanek also carries an instant teleportation device for moving from one city to any city that can only be used at most once. Help Pak Chanek for finding the minimum time needed.Notes:   Pak Chanek only needs to visit each city at least once. Pak Chanek does not have to traverse each road.  In the journey, a city or a road can be visited more than once." 2500
1725I "Imitating the Key Tree" combinatorics,dsu,trees "Pak Chanek has a tree called the key tree. This tree consists of N vertices and N\xe2\x88\x921 edges. The edges of the tree are numbered from 1 to N\xe2\x88\x921 with edge i connecting vertices Ui and Vi. Initially, each edge of the key tree does not have a weight.Formally, a path with length k in a graph is a sequence [v1,e1,v2,e2,v3,e3,\xe2\x80\xa6,vk,ek,vk+1] such that:   For each i, vi is a vertex and ei is an edge.  For each i, ei connects vertices vi and vi+1. A circuit is a path that starts and ends on the same vertex.A path in a graph is said to be simple if and only if the path does not use the same edge more than once. Note that a simple path can use the same vertex more than once.The cost of a simple path in a weighted graph is defined as the maximum weight of all edges it traverses.Count the number of distinct undirected weighted graphs that satisfy the following conditions:   The graph has N vertices and 2N\xe2\x88\x922 edges.  For each pair of different vertices (x,y), there exists a simple circuit that goes through vertices x and y in the graph.  The weight of each edge in the graph is an integer between 1 and 2N\xe2\x88\x922 inclusive. Each edge has distinct weights.  The graph is formed in a way such that there is a way to assign a weight Wi to each edge i in the key tree that satisfies the following conditions:   For each pair of edges (i,j), if i<j, then Wi<Wj.  For each pair of different vertex indices (x,y), the cost of the only simple path from vertex x to y in the key tree is equal to the minimum cost of a simple circuit that goes through vertices x and y in the graph.   Note that the graph is allowed to have multi-edges, but is not allowed to have self-loops. Print the answer modulo 998244353.Two graphs are considered distinct if and only if there exists a triple (a,b,c) such that there exists an edge that connects vertices a and b with weight c in one graph, but not in the other." 2800
