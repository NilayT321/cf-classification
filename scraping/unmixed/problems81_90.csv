450A "Jzzhu and Children" implementation "There are n children in Jzzhu\'s school. Jzzhu is going to give some candies to them. Let\'s number all the children from 1 to n. The i-th child wants to get at least ai candies.Jzzhu asks children to line up. Initially, the i-th child stands at the i-th place of the line. Then Jzzhu start distribution of the candies. He follows the algorithm:  Give m candies to the first child of the line.  If this child still haven\'t got enough candies, then the child goes to the end of the line, else the child go home.  Repeat the first two steps while the line is not empty. Consider all the children in the order they go home. Jzzhu wants to know, which child will be the last in this order?" 1000
449E "Jzzhu and Squares" "dp,math,number theory" "Jzzhu has two integers, n and m. He calls an integer point (x,\xe2\x80\x89y) of a plane special if 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. Jzzhu defines a unit square as a square with corners at points (x,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), where x and y are some integers.Let\'s look at all the squares (their sides not necessarily parallel to the coordinate axes) with corners at the special points. For each such square Jzzhu paints a dot in every unit square that is fully inside it. After that some unit squares can contain several dots. Now Jzzhu wonders, how many dots he has painted on the plane. Find this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2900
449D "Jzzhu and Numbers" bitmasks,combinatorics,dp "Jzzhu have n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. We will call a sequence of indexes i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) a group of size k. Jzzhu wonders, how many groups exists such that ai1 & ai2 & ... & aik\xe2\x80\x89=\xe2\x80\x890 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)? Help him and print this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Operation x & y denotes bitwise AND operation of two numbers." 2400
449C "Jzzhu and Apples" "constructive algorithms,number theory" "Jzzhu has picked n apples from his big apple tree. All the apples are numbered from 1 to n. Now he wants to sell them to an apple store. Jzzhu will pack his apples into groups and then sell them. Each group must contain two apples, and the greatest common divisor of numbers of the apples in each group must be greater than 1. Of course, each apple can be part of at most one group.Jzzhu wonders how to get the maximum possible number of groups. Can you help him?" 2500
449B "Jzzhu and Cities" "graphs,greedy,shortest paths" "Jzzhu is the president of country A. There are n cities numbered from 1 to n in his country. City 1 is the capital of A. Also there are m roads connecting the cities. One can go from city ui to vi (and vise versa) using the i-th road, the length of this road is xi. Finally, there are k train routes in the country. One can use the i-th train route to go from capital of the country to city si (and vise versa), the length of this route is yi.Jzzhu doesn\'t want to waste the money of the country, so he is going to close some of the train routes. Please tell Jzzhu the maximum number of the train routes which can be closed under the following condition: the length of the shortest path from every city to the capital mustn\'t change." 2000
449A "Jzzhu and Chocolate" greedy,math "Jzzhu has a big rectangular chocolate bar that consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m unit squares. He wants to cut this bar exactly k times. Each cut must meet the following requirements:  each cut should be straight (horizontal or vertical);  each cut should go along edges of unit squares (it is prohibited to divide any unit chocolate square with cut);  each cut should go inside the whole chocolate bar, and all cuts must be distinct. The picture below shows a possible way to cut a 5\xe2\x80\x89\xc3\x97\xe2\x80\x896 chocolate for 5 times.  Imagine Jzzhu have made k cuts and the big chocolate is splitted into several pieces. Consider the smallest (by area) piece of the chocolate, Jzzhu wants this piece to be as large as possible. What is the maximum possible area of smallest piece he can get with exactly k cuts? The area of a chocolate piece is the number of unit squares in it." 1700
448E Divisors "brute force,dfs and similar,implementation,number theory" "Bizon the Champion isn\'t just friendly, he also is a rigorous coder.Let\'s define function f(a), where a is a sequence of integers. Function f(a) returns the following sequence: first all divisors of a1 go in the increasing order, then all divisors of a2 go in the increasing order, and so on till the last element of sequence a. For example, f([2,\xe2\x80\x899,\xe2\x80\x891])\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x899,\xe2\x80\x891].Let\'s determine the sequence Xi, for integer i (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890): X0\xe2\x80\x89=\xe2\x80\x89[X] ([X] is a sequence consisting of a single number X), Xi\xe2\x80\x89=\xe2\x80\x89f(Xi\xe2\x80\x89-\xe2\x80\x891) (i\xe2\x80\x89>\xe2\x80\x890). For example, at X\xe2\x80\x89=\xe2\x80\x896 we get X0\xe2\x80\x89=\xe2\x80\x89[6], X1\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x896], X2\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x896].Given the numbers X and k, find the sequence Xk. As the answer can be rather large, find only the first 105 elements of this sequence." 2200
448D "Multiplication Table" "binary search,brute force" "Bizon the Champion isn\'t just charming, he also is very smart.While some of us were learning the multiplication table, Bizon the Champion had fun in his own manner. Bizon the Champion painted an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m multiplication table, where the element on the intersection of the i-th row and j-th column equals i\xc2\xb7j (the rows and columns of the table are numbered starting from 1). Then he was asked: what number in the table is the k-th largest number? Bizon the Champion always answered correctly and immediately. Can you repeat his success?Consider the given multiplication table. If you write out all n\xc2\xb7m numbers from the table in the non-decreasing order, then the k-th number you write out is called the k-th largest number." 1800
448C "Painting Fence" "divide and conquer,dp,greedy" "Bizon the Champion isn\'t just attentive, he also is very hardworking.Bizon the Champion decided to paint his old fence his favorite color, orange. The fence is represented as n vertical planks, put in a row. Adjacent planks have no gap between them. The planks are numbered from the left to the right starting from one, the i-th plank has the width of 1 meter and the height of ai meters.Bizon the Champion bought a brush in the shop, the brush\'s width is 1 meter. He can make vertical and horizontal strokes with the brush. During a stroke the brush\'s full surface must touch the fence at all the time (see the samples for the better understanding). What minimum number of strokes should Bizon the Champion do to fully paint the fence? Note that you are allowed to paint the same area of the fence multiple times." 1900
448B "Suffix Structures" implementation,strings "Bizon the Champion isn\'t just a bison. He also is a favorite of the ""Bizons"" team.At a competition the ""Bizons"" got the following problem: ""You are given two distinct words (strings of English letters), s and t. You need to transform word s into word t"". The task looked simple to the guys because they know the suffix data structures well. Bizon Senior loves suffix automaton. By applying it once to a string, he can remove from this string any single character. Bizon Middle knows suffix array well. By applying it once to a string, he can swap any two characters of this string. The guys do not know anything about the suffix tree, but it can help them do much more. Bizon the Champion wonders whether the ""Bizons"" can solve the problem. Perhaps, the solution do not require both data structures. Find out whether the guys can solve the problem and if they can, how do they do it? Can they solve it either only with use of suffix automaton or only with use of suffix array or they need both structures? Note that any structure may be used an unlimited number of times, the structures may be used in any order." 1400
448A Rewards implementation "Bizon the Champion is called the Champion for a reason. Bizon the Champion has recently got a present \xe2\x80\x94 a new glass cupboard with n shelves and he decided to put all his presents there. All the presents can be divided into two types: medals and cups. Bizon the Champion has a1 first prize cups, a2 second prize cups and a3 third prize cups. Besides, he has b1 first prize medals, b2 second prize medals and b3 third prize medals. Naturally, the rewards in the cupboard must look good, that\'s why Bizon the Champion decided to follow the rules:  any shelf cannot contain both cups and medals at the same time;  no shelf can contain more than five cups;  no shelf can have more than ten medals. Help Bizon the Champion find out if we can put all the rewards so that all the conditions are fulfilled." 800
447B "DZY Loves Strings" greedy,implementation "DZY loves collecting special strings which only contain lowercase letters. For each lowercase letter c DZY knows its value wc. For each special string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is the length of the string) he represents its value with a function f(s), where Now DZY has a string s. He wants to insert k lowercase letters into this string in order to get the largest possible value of the resulting string. Can you help him calculate the largest possible value he could get?" 1000
447A "DZY Loves Hash" implementation "DZY has a hash table with p buckets, numbered from 0 to p\xe2\x80\x89-\xe2\x80\x891. He wants to insert n numbers, in the order they are given, into the hash table. For the i-th number xi, DZY will put it into the bucket numbered h(xi), where h(x) is the hash function. In this problem we will assume, that h(x)\xe2\x80\x89=\xe2\x80\x89x mod p. Operation a mod b denotes taking a remainder after division a by b.However, each bucket can contain no more than one element. If DZY wants to insert an number into a bucket which is already filled, we say a ""conflict"" happens. Suppose the first conflict happens right after the i-th insertion, you should output i. If no conflict happens, just output -1." 800
446E "DZY Loves Bridges" math,matrices "DZY owns 2m islands near his home, numbered from 1 to 2m. He loves building bridges to connect the islands. Every bridge he builds takes one day\'s time to walk across.DZY has a strange rule of building the bridges. For every pair of islands u,\xe2\x80\x89v (u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v), he has built 2k different bridges connecting them, where  (a|b means b is divisible by a). These bridges are bidirectional.Also, DZY has built some bridges connecting his home with the islands. Specifically, there are ai different bridges from his home to the i-th island. These are one-way bridges, so after he leaves his home he will never come back.DZY decides to go to the islands for sightseeing. At first he is at home. He chooses and walks across one of the bridges connecting with his home, and arrives at some island. After that, he will spend t day(s) on the islands. Each day, he can choose to stay and rest, or to walk to another island across the bridge. It is allowed to stay at an island for more than one day. It\'s also allowed to cross one bridge more than once.Suppose that right after the t-th day DZY stands at the i-th island. Let ans[i] be the number of ways for DZY to reach the i-th island after t-th day. Your task is to calculate ans[i] for each i modulo 1051131." 3100
446D "DZY Loves Games" math,matrices,probabilities "Today DZY begins to play an old game. In this game, he is in a big maze with n rooms connected by m corridors (each corridor allows to move in both directions). You can assume that all the rooms are connected with corridors directly or indirectly.DZY has got lost in the maze. Currently he is in the first room and has k lives. He will act like the follows:  Firstly he will randomly pick one of the corridors going from his current room. Each outgoing corridor has the same probability to be picked.  Then he will go through the corridor and then the process repeats. There are some rooms which have traps in them. The first room definitely has no trap, the n-th room definitely has a trap. Each time DZY enters one of these rooms, he will lost one life. Now, DZY knows that if he enters the n-th room with exactly 2 lives, firstly he will lost one live, but then he will open a bonus round. He wants to know the probability for him to open the bonus round. Please, help him." 2800
446C "DZY Loves Fibonacci Numbers" "data structures,math,number theory" "In mathematical terms, the sequence Fn of Fibonacci numbers is defined by the recurrence relation F1\xe2\x80\x89=\xe2\x80\x891; F2\xe2\x80\x89=\xe2\x80\x891; Fn\xe2\x80\x89=\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x892 (n\xe2\x80\x89>\xe2\x80\x892).DZY loves Fibonacci numbers very much. Today DZY gives you an array consisting of n integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Moreover, there are m queries, each query has one of the two types:  Format of the query ""1 l r"". In reply to the query, you need to add Fi\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 to each element ai, where l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.  Format of the query ""2 l r"". In reply to the query you should output the value of  modulo 1000000009 (109\xe2\x80\x89+\xe2\x80\x899). Help DZY reply to all the queries." 2400
446B "DZY Loves Modification" "brute force,data structures,greedy" "As we know, DZY loves playing games. One day DZY decided to play with a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix. To be more precise, he decided to modify the matrix with exactly k operations.Each modification is one of the following:  Pick some row of the matrix and decrease each element of the row by p. This operation brings to DZY the value of pleasure equal to the sum of elements of the row before the decreasing.  Pick some column of the matrix and decrease each element of the column by p. This operation brings to DZY the value of pleasure equal to the sum of elements of the column before the decreasing. DZY wants to know: what is the largest total value of pleasure he could get after performing exactly k modifications? Please, help him to calculate this value." 2000
446A "DZY Loves Sequences" "dp,implementation,two pointers" "DZY has a sequence a, consisting of n integers.We\'ll call a sequence ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89aj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) a subsegment of the sequence a. The value (j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) denotes the length of the subsegment.Your task is to find the longest subsegment of a, such that it is possible to change at most one number (change one number to any integer you want) from the subsegment to make the subsegment strictly increasing.You only need to output the length of the subsegment you find." 1600
445B "DZY Loves Chemistry" "dfs and similar,dsu,greedy" "DZY loves chemistry, and he enjoys mixing chemicals.DZY has n chemicals, and m pairs of them will react. He wants to pour these chemicals into a test tube, and he needs to pour them in one by one, in any order. Let\'s consider the danger of a test tube. Danger of an empty test tube is 1. And every time when DZY pours a chemical, if there are already one or more chemicals in the test tube that can react with it, the danger of the test tube will be multiplied by 2. Otherwise the danger remains as it is.Find the maximum possible danger after pouring all the chemicals one by one in optimal order." 1400
445A "DZY Loves Chessboard" "dfs and similar,implementation" "DZY loves chessboard, and he enjoys playing with it.He has a chessboard of n rows and m columns. Some cells of the chessboard are bad, others are good. For every good cell, DZY wants to put a chessman on it. Each chessman is either white or black. After putting all chessmen, DZY wants that no two chessmen with the same color are on two adjacent cells. Two cells are adjacent if and only if they share a common edge.You task is to find any suitable placement of chessmen on the given chessboard." 1200
444E "DZY Loves Planting" "binary search,dsu,trees" "DZY loves planting, and he enjoys solving tree problems.DZY has a weighted tree (connected undirected graph without cycles) containing n nodes (they are numbered from 1 to n). He defines the function g(x,\xe2\x80\x89y) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) as the longest edge in the shortest path between nodes x and y. Specially g(z,\xe2\x80\x89z)\xe2\x80\x89=\xe2\x80\x890 for every z.For every integer sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), DZY defines f(p) as . DZY wants to find such a sequence p that f(p) has maximum possible value. But there is one more restriction: the element j can appear in p at most xj times.Please, find the maximum possible f(p) under the described restrictions." 2700
444D "DZY Loves Strings" "binary search,hashing,strings,two pointers" "DZY loves strings, and he enjoys collecting them.In China, many people like to use strings containing their names\' initials, for example: xyz, jcvb, dzy, dyh.Once DZY found a lucky string s. A lot of pairs of good friends came to DZY when they heard about the news. The first member of the i-th pair has name ai, the second one has name bi. Each pair wondered if there is a substring of the lucky string containing both of their names. If so, they want to find the one with minimum length, which can give them good luck and make their friendship last forever.Please help DZY for each pair find the minimum length of the substring of s that contains both ai and bi, or point out that such substring doesn\'t exist.A substring of s is a string slsl\xe2\x80\x89+\xe2\x80\x891... sr for some integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). The length of such the substring is (r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891).A string p contains some another string q if there is a substring of p equal to q." 2500
444C "DZY Loves Colors" "data structures" "DZY loves colors, and he enjoys painting.On a colorful day, DZY gets a colorful ribbon, which consists of n units (they are numbered from 1 to n from left to right). The color of the i-th unit of the ribbon is i at first. It is colorful enough, but we still consider that the colorfulness of each unit is 0 at first.DZY loves painting, we know. He takes up a paintbrush with color x and uses it to draw a line on the ribbon. In such a case some contiguous units are painted. Imagine that the color of unit i currently is y. When it is painted by this paintbrush, the color of the unit becomes x, and the colorfulness of the unit increases by |x\xe2\x80\x89-\xe2\x80\x89y|.DZY wants to perform m operations, each operation can be one of the following:  Paint all the units with numbers between l and r (both inclusive) with color x.  Ask the sum of colorfulness of the units between l and r (both inclusive). Can you help DZY?" 2400
444B "DZY Loves FFT" probabilities "DZY loves Fast Fourier Transformation, and he enjoys using it.Fast Fourier Transformation is an algorithm used to calculate convolution. Specifically, if a, b and c are sequences with length n, which are indexed from 0 to n\xe2\x80\x89-\xe2\x80\x891, andWe can calculate c fast using Fast Fourier Transformation.DZY made a little change on this formula. NowTo make things easier, a is a permutation of integers from 1 to n, and b is a sequence only containing 0 and 1. Given a and b, DZY needs your help to calculate c.Because he is naughty, DZY provides a special way to get a and b. What you need is only three integers n, d, x. After getting them, use the code below to generate a and b.//x is 64-bit variable;function getNextX() {    x = (x * 37 + 10007) % 1000000007;    return x;}function initAB() {    for(i = 0; i < n; i = i + 1){        a[i] = i + 1;    }    for(i = 0; i < n; i = i + 1){        swap(a[i], a[getNextX() % (i + 1)]);    }    for(i = 0; i < n; i = i + 1){        if (i < d)            b[i] = 1;        else            b[i] = 0;    }    for(i = 0; i < n; i = i + 1){        swap(b[i], b[getNextX() % (i + 1)]);    }}Operation x % y denotes remainder after division x by y. Function swap(x, y) swaps two values x and y." 2300
444A "DZY Loves Physics" greedy,math "DZY loves Physics, and he enjoys calculating density.Almost everything has density, even a graph. We define the density of a non-directed graph (nodes and edges of the graph have some values) as follows:  where v is the sum of the values of the nodes, e is the sum of the values of the edges.Once DZY got a graph G, now he wants to find a connected induced subgraph G\' of the graph, such that the density of G\' is as large as possible.An induced subgraph G\'(V\',\xe2\x80\x89E\') of a graph G(V,\xe2\x80\x89E) is a graph that satisfies:  ;  edge  if and only if , and edge ;  the value of an edge in G\' is the same as the value of the corresponding edge in G, so as the value of a node. Help DZY to find the induced subgraph with maximum density. Note that the induced subgraph you choose must be connected." 1600
443B "Kolya and Tandem Repeat" "brute force,implementation,strings" "Kolya got string s for his birthday, the string consists of small English letters. He immediately added k more characters to the right of the string.Then Borya came and said that the new string contained a tandem repeat of length l as a substring. How large could l be?See notes for definition of a tandem repeat." 1500
443A "Anton and Letters" "constructive algorithms,implementation" "Recently, Anton has found a set. The set consists of small English letters. Anton carefully wrote out all the letters from the set in one line, separated by a comma. He also added an opening curved bracket at the beginning of the line and a closing curved bracket at the end of the line. Unfortunately, from time to time Anton would forget writing some letter and write it again. He asks you to count the total number of distinct letters in his set." 800
442E "Gena and Second Distance" geometry "Gena doesn\'t like geometry, so he asks you to solve this problem for him.A rectangle with sides parallel to coordinate axes contains n dots. Let\'s consider some point of the plane. Let\'s count the distances from this point to the given n points. Let\'s sort these numbers in the non-decreasing order. We\'ll call the beauty of the point the second element of this array. If there are two mimimum elements in this array, the beaty will be equal to this minimum.Find the maximum beauty of a point inside the given rectangle." 3100
442D "Adam and Tree" "data structures,trees" "When Adam gets a rooted tree (connected non-directed graph without cycles), he immediately starts coloring it. More formally, he assigns a color to each edge of the tree so that it meets the following two conditions:   There is no vertex that has more than two incident edges painted the same color.  For any two vertexes that have incident edges painted the same color (say, c), the path between them consists of the edges of the color c. Not all tree paintings are equally good for Adam. Let\'s consider the path from some vertex to the root. Let\'s call the number of distinct colors on this path the cost of the vertex. The cost of the tree\'s coloring will be the maximum cost among all the vertexes. Help Adam determine the minimum possible cost of painting the tree. Initially, Adam\'s tree consists of a single vertex that has number one and is the root. In one move Adam adds a new vertex to the already existing one, the new vertex gets the number equal to the minimum positive available integer. After each operation you need to calculate the minimum cost of coloring the resulting tree." 2600
442C "Artem and Array" "data structures,greedy" "Artem has an array of n positive integers. Artem decided to play with it. The game consists of n moves. Each move goes like this. Artem chooses some element of the array and removes it. For that, he gets min(a,\xe2\x80\x89b) points, where a and b are numbers that were adjacent with the removed number. If the number doesn\'t have an adjacent number to the left or right, Artem doesn\'t get any points. After the element is removed, the two parts of the array glue together resulting in the new array that Artem continues playing with. Borya wondered what maximum total number of points Artem can get as he plays this game." 2500
442B "Andrey and Problem" greedy,math,probabilities "Andrey needs one more problem to conduct a programming contest. He has n friends who are always willing to help. He can ask some of them to come up with a contest problem. Andrey knows one value for each of his fiends \xe2\x80\x94 the probability that this friend will come up with a problem if Andrey asks him.Help Andrey choose people to ask. As he needs only one problem, Andrey is going to be really upset if no one comes up with a problem or if he gets more than one problem from his friends. You need to choose such a set of people that maximizes the chances of Andrey not getting upset." 1800
442A "Borya and Hanabi" "bitmasks,brute force,implementation" "Have you ever played Hanabi? If not, then you\'ve got to try it out! This problem deals with a simplified version of the game.Overall, the game has 25 types of cards (5 distinct colors and 5 distinct values). Borya is holding n cards. The game is somewhat complicated by the fact that everybody sees Borya\'s cards except for Borya himself. Borya knows which cards he has but he knows nothing about the order they lie in. Note that Borya can have multiple identical cards (and for each of the 25 types of cards he knows exactly how many cards of this type he has).The aim of the other players is to achieve the state when Borya knows the color and number value of each of his cards. For that, other players can give him hints. The hints can be of two types: color hints and value hints. A color hint goes like that: a player names some color and points at all the cards of this color. Similarly goes the value hint. A player names some value and points at all the cards that contain the value.Determine what minimum number of hints the other players should make for Borya to be certain about each card\'s color and value." 1700
441E "Valera and Number" bitmasks,dp,math,probabilities "Valera is a coder. Recently he wrote a funny program. The pseudo code for this program is given below://input: integers x, k, pa = x;for(step = 1; step <= k; step = step + 1){    rnd = [random integer from 1 to 100];    if(rnd <= p)        a = a * 2;    else        a = a + 1;}s = 0;while(remainder after dividing a by 2 equals 0){    a = a / 2;    s = s + 1;}Now Valera wonders: given the values x, k and p, what is the expected value of the resulting number s?" 2400
441D "Valera and Swaps" "constructive algorithms,dsu,graphs,implementation,math,string suffix structures" "A permutation p of length n is a sequence of distinct integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). A permutation is an identity permutation, if for any i the following equation holds pi\xe2\x80\x89=\xe2\x80\x89i. A swap (i,\xe2\x80\x89j) is the operation that swaps elements pi and pj in the permutation. Let\'s assume that f(p) is the minimum number of swaps that you need to make the permutation p an identity permutation. Valera wonders, how he can transform permutation p into any permutation q, such that f(q)\xe2\x80\x89=\xe2\x80\x89m, using the minimum number of swaps. Help him do that." 2100
441C "Valera and Tubes" "constructive algorithms,dfs and similar,implementation" "Valera has got a rectangle table consisting of n rows and m columns. Valera numbered the table rows starting from one, from top to bottom and the columns \xe2\x80\x93 starting from one, from left to right. We will represent cell that is on the intersection of row x and column y by a pair of integers (x,\xe2\x80\x89y).Valera wants to place exactly k tubes on his rectangle table. A tube is such sequence of table cells (x1,\xe2\x80\x89y1), (x2,\xe2\x80\x89y2), ..., (xr,\xe2\x80\x89yr), that:   r\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892;  for any integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891) the following equation |xi\xe2\x80\x89-\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89=\xe2\x80\x891 holds;  each table cell, which belongs to the tube, must occur exactly once in the sequence. Valera thinks that the tubes are arranged in a fancy manner if the following conditions are fulfilled:   no pair of tubes has common cells;  each cell of the table belongs to some tube. Help Valera to arrange k tubes on his rectangle table in a fancy manner." 1500
441B "Valera and Fruits" greedy,implementation "Valera loves his garden, where n fruit trees grow.This year he will enjoy a great harvest! On the i-th tree bi fruit grow, they will ripen on a day number ai. Unfortunately, the fruit on the tree get withered, so they can only be collected on day ai and day ai\xe2\x80\x89+\xe2\x80\x891 (all fruits that are not collected in these two days, become unfit to eat).Valera is not very fast, but there are some positive points. Valera is ready to work every day. In one day, Valera can collect no more than v fruits. The fruits may be either from the same tree, or from different ones. What is the maximum amount of fruit Valera can collect for all time, if he operates optimally well?" 1400
441A "Valera and Antique Items" implementation "Valera is a collector. Once he wanted to expand his collection with exactly one antique item.Valera knows n sellers of antiques, the i-th of them auctioned ki items. Currently the auction price of the j-th object of the i-th seller is sij. Valera gets on well with each of the n sellers. He is perfectly sure that if he outbids the current price of one of the items in the auction (in other words, offers the seller the money that is strictly greater than the current price of the item at the auction), the seller of the object will immediately sign a contract with him.Unfortunately, Valera has only v units of money. Help him to determine which of the n sellers he can make a deal with." 1000
440D "Berland Federalization" dp,trees "Recently, Berland faces federalization requests more and more often. The proponents propose to divide the country into separate states. Moreover, they demand that there is a state which includes exactly k towns.Currently, Berland has n towns, some pairs of them are connected by bilateral roads. Berland has only n\xe2\x80\x89-\xe2\x80\x891 roads. You can reach any city from the capital, that is, the road network forms a tree.The Ministry of Roads fears that after the reform those roads that will connect the towns of different states will bring a lot of trouble.Your task is to come up with a plan to divide the country into states such that:  each state is connected, i.e. for each state it is possible to get from any town to any other using its roads (that is, the roads that connect the state towns),  there is a state that consisted of exactly k cities,  the number of roads that connect different states is minimum." 2200
440C "One-Based Arithmetic" "brute force,dfs and similar,divide and conquer" "Prof. Vasechkin wants to represent positive integer n as a sum of addends, where each addends is an integer number containing only 1s. For example, he can represent 121 as 121=111+11+\xe2\x80\x931. Help him to find the least number of digits 1 in such sum." 1800
440B Balancer greedy,implementation "Petya has k matches, placed in n matchboxes lying in a line from left to right. We know that k is divisible by n. Petya wants all boxes to have the same number of matches inside. For that, he can move a match from its box to the adjacent one in one move. How many such moves does he need to achieve the desired configuration?" 1600
440A "Forgotten Episode" implementation "Polycarpus adores TV series. Right now he is ready to finish watching a season of a popular sitcom ""Graph Theory"". In total, the season has n episodes, numbered with integers from 1 to n.Polycarpus watches episodes not one by one but in a random order. He has already watched all the episodes except for one. Which episode has Polycaprus forgotten to watch?" 800
439E "Devu and Birthday Celebration" combinatorics,dp,math "Today is Devu\'s birthday. For celebrating the occasion, he bought n sweets from the nearby market. He has invited his f friends. He would like to distribute the sweets among them. As he is a nice guy and the occasion is great, he doesn\'t want any friend to be sad, so he would ensure to give at least one sweet to each friend. He wants to celebrate it in a unique style, so he would like to ensure following condition for the distribution of sweets. Assume that he has distributed n sweets to his friends such that ith friend is given ai sweets. He wants to make sure that there should not be any positive integer x\xe2\x80\x89>\xe2\x80\x891, which divides every ai.Please find the number of ways he can distribute sweets to his friends in the required way. Note that the order of distribution is important, for example [1, 2] and [2, 1] are distinct distributions. As the answer could be very large, output answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).To make the problem more interesting, you are given q queries. Each query contains an n, f pair. For each query please output the required number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100
439D "Devu and his Brother" "binary search,sortings,ternary search,two pointers" "Devu and his brother love each other a lot. As they are super geeks, they only like to play with arrays. They are given two arrays a and b by their father. The array a is given to Devu and b to his brother. As Devu is really a naughty kid, he wants the minimum value of his array a should be at least as much as the maximum value of his brother\'s array b. Now you have to help Devu in achieving this condition. You can perform multiple operations on the arrays. In a single operation, you are allowed to decrease or increase any element of any of the arrays by 1. Note that you are allowed to apply the operation on any index of the array multiple times.You need to find minimum number of operations required to satisfy Devu\'s condition so that the brothers can play peacefully without fighting." 1700
439C "Devu and Partitioning of the Array" "brute force,constructive algorithms,implementation,number theory" "Devu being a small kid, likes to play a lot, but he only likes to play with arrays. While playing he came up with an interesting question which he could not solve, can you please solve it for him?Given an array consisting of distinct integers. Is it possible to partition the whole array into k disjoint non-empty parts such that p of the parts have even sum (each of them must have even sum) and remaining k - p have odd sum? (note that parts need not to be continuous).If it is possible to partition the array, also give any possible way of valid partitioning." 1700
439B "Devu, the Dumb Guy" implementation,sortings "Devu is a dumb guy, his learning curve is very slow. You are supposed to teach him n subjects, the ith subject has ci chapters. When you teach him, you are supposed to teach all the chapters of a subject continuously.Let us say that his initial per chapter learning power of a subject is x hours. In other words he can learn a chapter of a particular subject in x hours.Well Devu is not complete dumb, there is a good thing about him too. If you teach him a subject, then time required to teach any chapter of the next subject will require exactly 1 hour less than previously required (see the examples to understand it more clearly). Note that his per chapter learning power can not be less than 1 hour.You can teach him the n subjects in any possible order. Find out minimum amount of time (in hours) Devu will take to understand all the subjects and you will be free to do some enjoying task rather than teaching a dumb guy.Please be careful that answer might not fit in 32 bit data type." 1200
439A "Devu, the Singer and Churu, the Joker" greedy,implementation "Devu is a renowned classical singer. He is invited to many big functions/festivals. Recently he was invited to ""All World Classical Singing Festival"". Other than Devu, comedian Churu was also invited.Devu has provided organizers a list of the songs and required time for singing them. He will sing n songs, ith song will take ti minutes exactly. The Comedian, Churu will crack jokes. All his jokes are of 5 minutes exactly.People have mainly come to listen Devu. But you know that he needs rest of 10 minutes after each song. On the other hand, Churu being a very active person, doesn\'t need any rest.You as one of the organizers should make an optimal s\xd1\x81hedule for the event. For some reasons you must follow the conditions:  The duration of the event must be no more than d minutes;  Devu must complete all his songs;  With satisfying the two previous conditions the number of jokes cracked by Churu should be as many as possible. If it is not possible to find a way to conduct all the songs of the Devu, output -1. Otherwise find out maximum number of jokes that Churu can crack in the grand event." 900
438E "The Child and Binary Tree" "combinatorics,divide and conquer,fft,number theory" "Our child likes computer science very much, especially he likes binary trees.Consider the sequence of n distinct positive integers: c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn. The child calls a vertex-weighted rooted binary tree good if and only if for every vertex v, the weight of v is in the set {c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn}. Also our child thinks that the weight of a vertex-weighted tree is the sum of all vertices\' weights.Given an integer m, can you for all s (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) calculate the number of good vertex-weighted rooted binary trees with weight s? Please, check the samples for better understanding what trees are considered different.We only want to know the answer modulo 998244353 (7\xe2\x80\x89\xc3\x97\xe2\x80\x8917\xe2\x80\x89\xc3\x97\xe2\x80\x89223\xe2\x80\x89+\xe2\x80\x891, a prime number)." 3100
438D "The Child and Sequence" "data structures,math" "At the children\'s day, the child came to Picks\'s house, and messed his house up. Picks was angry at him. A lot of important things were lost, in particular the favorite sequence of Picks.Fortunately, Picks remembers how to repair the sequence. Initially he should create an integer array a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n]. Then he should perform a sequence of m operations. An operation can be one of the following:  Print operation l,\xe2\x80\x89r. Picks should write down the value of .  Modulo operation l,\xe2\x80\x89r,\xe2\x80\x89x. Picks should perform assignment a[i]\xe2\x80\x89=\xe2\x80\x89a[i] mod x for each i (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r).  Set operation k,\xe2\x80\x89x. Picks should set the value of a[k] to x (in other words perform an assignment a[k]\xe2\x80\x89=\xe2\x80\x89x). Can you help Picks to perform the whole sequence of operations?" 2300
437E "The Child and Polygon" dp,geometry "This time our child has a simple polygon. He has to find the number of ways to split the polygon into non-degenerate triangles, each way must satisfy the following requirements:  each vertex of each triangle is one of the polygon vertex;  each side of the polygon must be the side of exactly one triangle;  the area of intersection of every two triangles equals to zero, and the sum of all areas of triangles equals to the area of the polygon;  each triangle must be completely inside the polygon;  each side of each triangle must contain exactly two vertices of the polygon. The picture below depicts an example of a correct splitting.  Please, help the child. Calculate the described number of ways modulo 1000000007 (109\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x897) for him." 2500
437D "The Child and Zoo" dsu,sortings "Of course our child likes walking in a zoo. The zoo has n areas, that are numbered from 1 to n. The i-th area contains ai animals in it. Also there are m roads in the zoo, and each road connects two distinct areas. Naturally the zoo is connected, so you can reach any area of the zoo from any other area using the roads.Our child is very smart. Imagine the child want to go from area p to area q. Firstly he considers all the simple routes from p to q. For each route the child writes down the number, that is equal to the minimum number of animals among the route areas. Let\'s denote the largest of the written numbers as f(p,\xe2\x80\x89q). Finally, the child chooses one of the routes for which he writes down the value f(p,\xe2\x80\x89q).After the child has visited the zoo, he thinks about the question: what is the average value of f(p,\xe2\x80\x89q) for all pairs p,\xe2\x80\x89q (p\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89q)? Can you answer his question?" 1900
437C "The Child and Toy" graphs,greedy,sortings "On Children\'s Day, the child got a toy from Delayyy as a present. However, the child is so naughty that he can\'t wait to destroy the toy.The toy consists of n parts and m ropes. Each rope links two parts, but every pair of parts is linked by at most one rope. To split the toy, the child must remove all its parts. The child can remove a single part at a time, and each remove consume an energy. Let\'s define an energy value of part i as vi. The child spend vf1\xe2\x80\x89+\xe2\x80\x89vf2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89vfk energy for removing part i where f1,\xe2\x80\x89f2,\xe2\x80\x89...,\xe2\x80\x89fk are the parts that are directly connected to the i-th and haven\'t been removed.Help the child to find out, what is the minimum total energy he should spend to remove all n parts." 1400
437B "The Child and Set" bitmasks,greedy,implementation,sortings "At the children\'s day, the child came to Picks\'s house, and messed his house up. Picks was angry at him. A lot of important things were lost, in particular the favorite set of Picks.Fortunately, Picks remembers something about his set S:  its elements were distinct integers from 1 to limit;  the value of  was equal to sum; here lowbit(x) equals 2k where k is the position of the first one in the binary representation of x. For example, lowbit(100102)\xe2\x80\x89=\xe2\x80\x89102,\xe2\x80\x89lowbit(100012)\xe2\x80\x89=\xe2\x80\x8912,\xe2\x80\x89lowbit(100002)\xe2\x80\x89=\xe2\x80\x89100002 (binary representation). Can you help Picks and find any set S, that satisfies all the above conditions?" 1500
437A "The Child and Homework" implementation "Once upon a time a child got a test consisting of multiple-choice questions as homework. A multiple-choice question consists of four choices: A, B, C and D. Each choice has a description, and the child should find out the only one that is correct.Fortunately the child knows how to solve such complicated test. The child will follow the algorithm:  If there is some choice whose description at least twice shorter than all other descriptions, or at least twice longer than all other descriptions, then the child thinks the choice is great.  If there is exactly one great choice then the child chooses it. Otherwise the child chooses C (the child think it is the luckiest choice). You are given a multiple-choice questions, can you predict child\'s choose?" 1300
436F Banners "brute force,data structures,dp" "All modern mobile applications are divided into free and paid. Even a single application developers often release two versions: a paid version without ads and a free version with ads.  Suppose that a paid version of the app costs p (p is an integer) rubles, and the free version of the application contains c ad banners. Each user can be described by two integers: ai \xe2\x80\x94 the number of rubles this user is willing to pay for the paid version of the application, and bi \xe2\x80\x94 the number of banners he is willing to tolerate in the free version.The behavior of each member shall be considered strictly deterministic:  if for user i, value bi is at least c, then he uses the free version,  otherwise, if value ai is at least p, then he buys the paid version without advertising,  otherwise the user simply does not use the application. Each user of the free version brings the profit of c\xe2\x80\x89\xc3\x97\xe2\x80\x89w rubles. Each user of the paid version brings the profit of p rubles.Your task is to help the application developers to select the optimal parameters p and c. Namely, knowing all the characteristics of users, for each value of c from 0 to (max bi)\xe2\x80\x89+\xe2\x80\x891 you need to determine the maximum profit from the application and the corresponding parameter p." 3000
436E "Cardboard Box" "data structures,greedy" "Everyone who has played Cut the Rope knows full well how the gameplay is organized. All levels in the game are divided into boxes. Initially only one box with some levels is available. Player should complete levels to earn stars, collecting stars opens new box with levels.  Imagine that you are playing Cut the Rope for the first time. Currently you have only the levels of the first box (by the way, it is called ""Cardboard Box""). Each level is characterized by two integers: ai \xe2\x80\x94 how long it takes to complete the level for one star, bi \xe2\x80\x94 how long it takes to complete the level for two stars (ai\xe2\x80\x89<\xe2\x80\x89bi).You want to open the next box as quickly as possible. So, you need to earn at least w stars. How do make it happen? Note that the level can be passed only once: either for one star or for two. You do not necessarily need to pass all the levels." 2600
436D "Pudding Monsters" dp "Have you ever played Pudding Monsters? In this task, a simplified one-dimensional model of this game is used.  Imagine an infinite checkered stripe, the cells of which are numbered sequentially with integers. Some cells of the strip have monsters, other cells of the strip are empty. All monsters are made of pudding, so if there are two monsters in the neighboring cells, they stick to each other (literally). Similarly, if several monsters are on consecutive cells, they all stick together in one block of monsters. We will call the stuck together monsters a block of monsters. A detached monster, not stuck to anyone else, is also considered a block.In one move, the player can take any block of monsters and with a movement of his hand throw it to the left or to the right. The selected monsters will slide on until they hit some other monster (or a block of monsters).For example, if a strip has three monsters in cells 1, 4 and 5, then there are only four possible moves: to send a monster in cell 1 to minus infinity, send the block of monsters in cells 4 and 5 to plus infinity, throw monster 1 to the right (it will stop in cell 3), throw a block of monsters in cells 4 and 5 to the left (they will stop in cells 2 and 3).Some cells on the strip are marked with stars. These are the special cells. The goal of the game is to make the largest possible number of special cells have monsters on them.You are given the numbers of the special cells on a strip as well as the initial position of all monsters. What is the maximum number of special cells that will contain monsters in the optimal game?" 2800
436C "Dungeons and Candies" dsu,graphs,greedy,trees "During the loading of the game ""Dungeons and Candies"" you are required to get descriptions of k levels from the server. Each description is a map of an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m checkered rectangular field. Some cells of the field contain candies (each cell has at most one candy). An empty cell is denoted as ""."" on the map, but if a cell has a candy, it is denoted as a letter of the English alphabet. A level may contain identical candies, in this case the letters in the corresponding cells of the map will be the same.  When you transmit information via a network, you want to minimize traffic \xe2\x80\x94 the total size of the transferred data. The levels can be transmitted in any order. There are two ways to transmit the current level A:  You can transmit the whole level A. Then you need to transmit n\xc2\xb7m bytes via the network.  You can transmit the difference between level A and some previously transmitted level B (if it exists); this operation requires to transmit dA,\xe2\x80\x89B\xc2\xb7w bytes, where dA,\xe2\x80\x89B is the number of cells of the field that are different for A and B, and w is a constant. Note, that you should compare only the corresponding cells of levels A and B to calculate dA,\xe2\x80\x89B. You cannot transform the maps of levels, i.e. rotate or shift them relatively to each other. Your task is to find a way to transfer all the k levels and minimize the traffic." 1800
436B "Om Nom and Spiders" implementation,math "Om Nom really likes candies and doesn\'t like spiders as they frequently steal candies. One day Om Nom fancied a walk in a park. Unfortunately, the park has some spiders and Om Nom doesn\'t want to see them at all.  The park can be represented as a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m field. The park has k spiders, each spider at time 0 is at some cell of the field. The spiders move all the time, and each spider always moves in one of the four directions (left, right, down, up). In a unit of time, a spider crawls from his cell to the side-adjacent cell in the corresponding direction. If there is no cell in the given direction, then the spider leaves the park. The spiders do not interfere with each other as they move. Specifically, one cell can have multiple spiders at the same time.Om Nom isn\'t yet sure where to start his walk from but he definitely wants:  to start walking at time 0 at an upper row cell of the field (it is guaranteed that the cells in this row do not contain any spiders);  to walk by moving down the field towards the lowest row (the walk ends when Om Nom leaves the boundaries of the park). We know that Om Nom moves by jumping. One jump takes one time unit and transports the little monster from his cell to either a side-adjacent cell on the lower row or outside the park boundaries.Each time Om Nom lands in a cell he sees all the spiders that have come to that cell at this moment of time. Om Nom wants to choose the optimal cell to start the walk from. That\'s why he wonders: for each possible starting cell, how many spiders will he see during the walk if he starts from this cell? Help him and calculate the required value for each possible starting cell." 1400
436A "Feed with Candy" greedy "The hero of the Cut the Rope game is a little monster named Om Nom. He loves candies. And what a coincidence! He also is the hero of today\'s problem.  One day, Om Nom visited his friend Evan. Evan has n candies of two types (fruit drops and caramel drops), the i-th candy hangs at the height of hi centimeters above the floor of the house, its mass is mi. Om Nom wants to eat as many candies as possible. At the beginning Om Nom can make at most x centimeter high jumps. When Om Nom eats a candy of mass y, he gets stronger and the height of his jump increases by y centimeters.What maximum number of candies can Om Nom eat if he never eats two candies of the same type in a row (Om Nom finds it too boring)?" 1500
435E "Special Graph" NA "In this problem you will need to deal with an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid graph. The graph\'s vertices are the nodes of the n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid. The graph\'s edges are all the sides and diagonals of the grid\'s unit squares.The figure below shows a 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 graph. The black lines are the graph\'s edges, the colored circles are the graph\'s vertices. The vertices of the graph are painted on the picture for a reason: the coloring is a correct vertex coloring of the 3\xe2\x80\x89\xc3\x97\xe2\x80\x895 graph into four colors. A graph coloring is correct if and only if each vertex is painted and no two vertices connected by an edge are painted the same color.  You are given the size of the grid graph n\xe2\x80\x89\xc3\x97\xe2\x80\x89m and the colors of some of its vertices. Find any way how to paint the unpainted vertices of the graph in 4 colors to make the final coloring a correct vertex graph coloring. If there is no such correct vertex coloring, say that the answer doesn\'t exist." 2500
435D "Special Grid" "brute force,dp,greedy" "You are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid, some of its nodes are black, the others are white. Moreover, it\'s not an ordinary grid \xe2\x80\x94 each unit square of the grid has painted diagonals.The figure below is an example of such grid of size 3\xe2\x80\x89\xc3\x97\xe2\x80\x895. Four nodes of this grid are black, the other 11 nodes are white.  Your task is to count the number of such triangles on the given grid that:  the corners match the white nodes, and the area is positive;  all sides go along the grid lines (horizontal, vertical or diagonal);  no side contains black nodes." 2000
435C Cardiogram implementation "In this problem, your task is to use ASCII graphics to paint a cardiogram. A cardiogram is a polyline with the following corners:That is, a cardiogram is fully defined by a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Your task is to paint a cardiogram by given sequence ai." 1600
435B "Pasha Maximizes" greedy "Pasha has a positive integer a without leading zeroes. Today he decided that the number is too small and he should make it larger. Unfortunately, the only operation Pasha can do is to swap two adjacent decimal digits of the integer.Help Pasha count the maximum number he can get if he has the time to make at most k swaps." 1400
435A "Queue on Bus Stop" implementation "It\'s that time of the year when the Russians flood their countryside summer cottages (dachas) and the bus stop has a lot of people. People rarely go to the dacha on their own, it\'s usually a group, so the people stand in queue by groups.The bus stop queue has n groups of people. The i-th group from the beginning has ai people. Every 30 minutes an empty bus arrives at the bus stop, it can carry at most m people. Naturally, the people from the first group enter the bus first. Then go the people from the second group and so on. Note that the order of groups in the queue never changes. Moreover, if some group cannot fit all of its members into the current bus, it waits for the next bus together with other groups standing after it in the queue.Your task is to determine how many buses is needed to transport all n groups to the dacha countryside." 1000
434E "Furukawa Nagisa\'s Tree" "binary search,divide and conquer,sortings,trees" "One day, Okazaki Tomoya has bought a tree for Furukawa Nagisa\'s birthday. The tree is so strange that every node of the tree has a value. The value of the i-th node is vi. Now Furukawa Nagisa and Okazaki Tomoya want to play a game on the tree.Let (s,\xe2\x80\x89e) be the path from node s to node e, we can write down the sequence of the values of nodes on path (s,\xe2\x80\x89e), and denote this sequence as S(s,\xe2\x80\x89e). We define the value of the sequence G(S(s,\xe2\x80\x89e)) as follows. Suppose that the sequence is z0,\xe2\x80\x89z1...zl\xe2\x80\x89-\xe2\x80\x891, where l is the length of the sequence. We define G(S(s,\xe2\x80\x89e))\xe2\x80\x89=\xe2\x80\x89z0\xe2\x80\x89\xc3\x97\xe2\x80\x89k0\xe2\x80\x89+\xe2\x80\x89z1\xe2\x80\x89\xc3\x97\xe2\x80\x89k1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89zl\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x89kl\xe2\x80\x89-\xe2\x80\x891. If the path (s,\xe2\x80\x89e) satisfies , then the path (s,\xe2\x80\x89e) belongs to Furukawa Nagisa, otherwise it belongs to Okazaki Tomoya.Calculating who has more paths is too easy, so they want to play something more difficult. Furukawa Nagisa thinks that if paths (p1,\xe2\x80\x89p2) and (p2,\xe2\x80\x89p3) belong to her, then path (p1,\xe2\x80\x89p3) belongs to her as well. Also, she thinks that if paths (p1,\xe2\x80\x89p2) and (p2,\xe2\x80\x89p3) belong to Okazaki Tomoya, then path (p1,\xe2\x80\x89p3) belongs to Okazaki Tomoya as well. But in fact, this conclusion isn\'t always right. So now Furukawa Nagisa wants to know how many triplets (p1,\xe2\x80\x89p2,\xe2\x80\x89p3) are correct for the conclusion, and this is your task." 3000
434D "Nanami\'s Power Plant" flows "Nanami likes playing games, and is also really good at it. This day she was playing a new game which involved operating a power plant. Nanami\'s job is to control the generators in the plant and produce maximum output.There are n generators in the plant. Each generator should be set to a generating level. Generating level is an integer (possibly zero or negative), the generating level of the i-th generator should be between li and ri (both inclusive). The output of a generator can be calculated using a certain quadratic function f(x), where x is the generating level of the generator. Each generator has its own function, the function of the i-th generator is denoted as fi(x).However, there are m further restrictions to the generators. Let the generating level of the i-th generator be xi. Each restriction is of the form xu\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xv\xe2\x80\x89+\xe2\x80\x89d, where u and v are IDs of two different generators and d is an integer.Nanami found the game tedious but giving up is against her creed. So she decided to have a program written to calculate the answer for her (the maximum total output of generators). Somehow, this became your job." 2900
433E "Tachibana Kanade\'s Tofu" dp "Tachibana Kanade likes Mapo Tofu very much. One day, the canteen cooked all kinds of tofu to sell, but not all tofu is Mapo Tofu, only those spicy enough can be called Mapo Tofu.Each piece of tofu in the canteen is given a m-based number, all numbers are in the range [l,\xe2\x80\x89r] (l and r being m-based numbers), and for every m-based integer in the range [l,\xe2\x80\x89r], there exists a piece of tofu with that number.To judge what tofu is Mapo Tofu, Tachibana Kanade chose n m-based number strings, and assigned a value to each string. If a string appears in the number of a tofu, the value of the string will be added to the value of that tofu. If a string appears multiple times, then the value is also added that many times. Initially the value of each tofu is zero.Tachibana Kanade considers tofu with values no more than k to be Mapo Tofu. So now Tachibana Kanade wants to know, how many pieces of tofu are Mapo Tofu?" 2500
433D "Nanami\'s Digital Board" dsu,implementation "Nanami is an expert at playing games. This day, Nanami\'s good friend Hajime invited her to watch a game of baseball. Unwilling as she was, she followed him to the stadium. But Nanami had no interest in the game, so she looked around to see if there was something that might interest her. That\'s when she saw the digital board at one end of the stadium.The digital board is n pixels in height and m pixels in width, every pixel is either light or dark. The pixels are described by its coordinate. The j-th pixel of the i-th line is pixel (i,\xe2\x80\x89j). The board displays messages by switching a combination of pixels to light, and the rest to dark. Nanami notices that the state of the pixels on the board changes from time to time. At certain times, certain pixels on the board may switch from light to dark, or from dark to light.Nanami wonders, what is the area of the biggest light block such that a specific pixel is on its side. A light block is a sub-rectangle of the board, in which all pixels are light. Pixel (i,\xe2\x80\x89j) belongs to a side of sub-rectangle with (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) as its upper-left and lower-right vertex if and only if it satisfies the logical condition: ((i\xe2\x80\x89=\xe2\x80\x89x1 or i\xe2\x80\x89=\xe2\x80\x89x2) and (y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2)) or ((j\xe2\x80\x89=\xe2\x80\x89y1 or j\xe2\x80\x89=\xe2\x80\x89y2) and (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2)).Nanami has all the history of changing pixels, also she has some questions of the described type, can you answer them?" 2000
433C "Ryouko\'s Memory Note" implementation,math,sortings "Ryouko is an extremely forgetful girl, she could even forget something that has just happened. So in order to remember, she takes a notebook with her, called Ryouko\'s Memory Note. She writes what she sees and what she hears on the notebook, and the notebook became her memory.Though Ryouko is forgetful, she is also born with superb analyzing abilities. However, analyzing depends greatly on gathered information, in other words, memory. So she has to shuffle through her notebook whenever she needs to analyze, which is tough work.Ryouko\'s notebook consists of n pages, numbered from 1 to n. To make life (and this problem) easier, we consider that to turn from page x to page y, |x\xe2\x80\x89-\xe2\x80\x89y| pages should be turned. During analyzing, Ryouko needs m pieces of information, the i-th piece of information is on page ai. Information must be read from the notebook in order, so the total number of pages that Ryouko needs to turn is .Ryouko wants to decrease the number of pages that need to be turned. In order to achieve this, she can merge two pages of her notebook. If Ryouko merges page x to page y, she would copy all the information on page x to y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and consequently, all elements in sequence a that was x would become y. Note that x can be equal to y, in which case no changes take place.Please tell Ryouko the minimum number of pages that she needs to turn. Note she can apply the described operation at most once before the reading. Note that the answer can exceed 32-bit integers." 1800
433B "Kuriyama Mirai\'s Stones" dp,implementation,sortings "Kuriyama Mirai has killed many monsters and got many (namely n) stones. She numbers the stones from 1 to n. The cost of the i-th stone is vi. Kuriyama Mirai wants to know something about these stones so she will ask you two kinds of questions:  She will tell you two numbers, l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and you should tell her .  Let ui be the cost of the i-th cheapest stone (the cost that will be on the i-th place if we arrange all the stone costs in non-decreasing order). This time she will tell you two numbers, l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), and you should tell her . For every question you should give the correct answer, or Kuriyama Mirai will say ""fuyukai desu"" and then become unhappy." 1200
433A "Kitahara Haruki\'s Gift" "brute force,implementation" "Kitahara Haruki has bought n apples for Touma Kazusa and Ogiso Setsuna. Now he wants to divide all the apples between the friends.Each apple weights 100 grams or 200 grams. Of course Kitahara Haruki doesn\'t want to offend any of his friend. Therefore the total weight of the apples given to Touma Kazusa must be equal to the total weight of the apples given to Ogiso Setsuna.But unfortunately Kitahara Haruki doesn\'t have a knife right now, so he cannot split any apple into some parts. Please, tell him: is it possible to divide all the apples in a fair way between his friends?" 1100
432E "Square Tiling" "constructive algorithms,greedy" "You have an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle table, its cells are not initially painted. Your task is to paint all cells of the table. The resulting picture should be a tiling of the table with squares. More formally:  each cell must be painted some color (the colors are marked by uppercase Latin letters);  we will assume that two cells of the table are connected if they are of the same color and share a side; each connected region of the table must form a square. Given n and m, find lexicographically minimum coloring of the table that meets the described properties." 2300
432D "Prefixes and Suffixes" "dp,string suffix structures,strings,two pointers" "You have a string s\xe2\x80\x89=\xe2\x80\x89s1s2...s|s|, where |s| is the length of string s, and si its i-th character. Let\'s introduce several definitions:  A substring s[i..j] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s is string sisi\xe2\x80\x89+\xe2\x80\x891...sj.  The prefix of string s of length l (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) is string s[1..l].  The suffix of string s of length l (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) is string s[|s|\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891..|s|]. Your task is, for any prefix of string s which matches a suffix of string s, print the number of times it occurs in string s as a substring." 2000
432C "Prime Swaps" greedy,sortings "You have an array a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n], containing distinct integers from 1 to n. Your task is to sort this array in increasing order with the following operation (you may need to apply it multiple times):  choose two indexes, i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; (j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) is a prime number);  swap the elements on positions i and j; in other words, you are allowed to apply the following sequence of assignments: tmp\xe2\x80\x89=\xe2\x80\x89a[i],\xe2\x80\x89a[i]\xe2\x80\x89=\xe2\x80\x89a[j],\xe2\x80\x89a[j]\xe2\x80\x89=\xe2\x80\x89tmp (tmp is a temporary variable). You do not need to minimize the number of used operations. However, you need to make sure that there are at most 5n operations." 1800
432B "Football Kit" "brute force,greedy,implementation" "Consider a football tournament where n teams participate. Each team has two football kits: for home games, and for away games. The kit for home games of the i-th team has color xi and the kit for away games of this team has color yi (xi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89yi).In the tournament, each team plays exactly one home game and exactly one away game with each other team (n(n\xe2\x80\x89-\xe2\x80\x891) games in total). The team, that plays the home game, traditionally plays in its home kit. The team that plays an away game plays in its away kit. However, if two teams has the kits of the same color, they cannot be distinguished. In this case the away team plays in its home kit.Calculate how many games in the described tournament each team plays in its home kit and how many games it plays in its away kit." 1200
432A "Choosing Teams" greedy,implementation,sortings "The Saratov State University Olympiad Programmers Training Center (SSU OPTC) has n students. For each student you know the number of times he/she has participated in the ACM ICPC world programming championship. According to the ACM ICPC rules, each person can participate in the world championship at most 5 times.The head of the SSU OPTC is recently gathering teams to participate in the world championship. Each team must consist of exactly three people, at that, any person cannot be a member of two or more teams. What maximum number of teams can the head make if he wants each team to participate in the world championship with the same members at least k times?" 800
431E "Chemistry Experiment" "binary search,data structures,ternary search" "One day two students, Grisha and Diana, found themselves in the university chemistry lab. In the lab the students found n test tubes with mercury numbered from 1 to n and decided to conduct an experiment.The experiment consists of q steps. On each step, one of the following actions occurs:  Diana pours all the contents from tube number pi and then pours there exactly xi liters of mercury.  Let\'s consider all the ways to add vi liters of water into the tubes; for each way let\'s count the volume of liquid (water and mercury) in the tube with water with maximum amount of liquid; finally let\'s find the minimum among counted maximums. That is the number the students want to count. At that, the students don\'t actually pour the mercury. They perform calculations without changing the contents of the tubes. Unfortunately, the calculations proved to be too complex and the students asked you to help them. Help them conduct the described experiment." 2200
431D "Random Task" "binary search,bitmasks,combinatorics,dp,math" "One day, after a difficult lecture a diligent student Sasha saw a graffitied desk in the classroom. She came closer and read: ""Find such positive integer n, that among numbers n\xe2\x80\x89+\xe2\x80\x891, n\xe2\x80\x89+\xe2\x80\x892, ..., 2\xc2\xb7n there are exactly m numbers which binary representation contains exactly k digits one"".The girl got interested in the task and she asked you to help her solve it. Sasha knows that you are afraid of large numbers, so she guaranteed that there is an answer that doesn\'t exceed 1018." 2100
431C k-Tree dp,implementation,trees "Quite recently a creative student Lesha had a lecture on trees. After the lecture Lesha was inspired and came up with the tree of his own which he called a k-tree.A k-tree is an infinite rooted tree where:  each vertex has exactly k children;  each edge has some weight;  if we look at the edges that goes from some vertex to its children (exactly k edges), then their weights will equal 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89k. The picture below shows a part of a 3-tree.      As soon as Dima, a good friend of Lesha, found out about the tree, he immediately wondered: ""How many paths of total weight n (the sum of all weights of the edges in the path) are there, starting from the root of a k-tree and also containing at least one edge of weight at least d?"".Help Dima find an answer to his question. As the number of ways can be rather large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1600
431B "Shower Line" "brute force,implementation" "Many students live in a dormitory. A dormitory is a whole new world of funny amusements and possibilities but it does have its drawbacks. There is only one shower and there are multiple students who wish to have a shower in the morning. That\'s why every morning there is a line of five people in front of the dormitory shower door. As soon as the shower opens, the first person from the line enters the shower. After a while the first person leaves the shower and the next person enters the shower. The process continues until everybody in the line has a shower.Having a shower takes some time, so the students in the line talk as they wait. At each moment of time the students talk in pairs: the (2i\xe2\x80\x89-\xe2\x80\x891)-th man in the line (for the current moment) talks with the (2i)-th one. Let\'s look at this process in more detail. Let\'s number the people from 1 to 5. Let\'s assume that the line initially looks as 23154 (person number 2 stands at the beginning of the line). Then, before the shower opens, 2 talks with 3, 1 talks with 5, 4 doesn\'t talk with anyone. Then 2 enters the shower. While 2 has a shower, 3 and 1 talk, 5 and 4 talk too. Then, 3 enters the shower. While 3 has a shower, 1 and 5 talk, 4 doesn\'t talk to anyone. Then 1 enters the shower and while he is there, 5 and 4 talk. Then 5 enters the shower, and then 4 enters the shower.We know that if students i and j talk, then the i-th student\'s happiness increases by gij and the j-th student\'s happiness increases by gji. Your task is to find such initial order of students in the line that the total happiness of all students will be maximum in the end. Please note that some pair of students may have a talk several times. In the example above students 1 and 5 talk while they wait for the shower to open and while 3 has a shower." 1200
431A "Black Square" implementation "Quite recently, a very smart student named Jury decided that lectures are boring, so he downloaded a game called ""Black Square"" on his super cool touchscreen phone.In this game, the phone\'s screen is divided into four vertical strips. Each second, a black square appears on some of the strips. According to the rules of the game, Jury must use this second to touch the corresponding strip to make the square go away. As Jury is both smart and lazy, he counted that he wastes exactly ai calories on touching the i-th strip.You\'ve got a string s, describing the process of the game and numbers a1,\xe2\x80\x89a2,\xe2\x80\x89a3,\xe2\x80\x89a4. Calculate how many calories Jury needs to destroy all the squares?" 800
430B "Balls Game" "brute force,two pointers" "Iahub is training for the IOI. What is a better way to train than playing a Zuma-like game? There are n balls put in a row. Each ball is colored in one of k colors. Initially the row doesn\'t contain three or more contiguous balls with the same color. Iahub has a single ball of color x. He can insert his ball at any position in the row (probably, between two other balls). If at any moment there are three or more contiguous balls of the same color in the row, they are destroyed immediately. This rule is applied multiple times, until there are no more sets of 3 or more contiguous balls of the same color. For example, if Iahub has the row of balls [black, black, white, white, black, black] and a white ball, he can insert the ball between two white balls. Thus three white balls are destroyed, and then four black balls become contiguous, so all four balls are destroyed. The row will not contain any ball in the end, so Iahub can destroy all 6 balls.Iahub wants to destroy as many balls as possible. You are given the description of the row of balls, and the color of Iahub\'s ball. Help Iahub train for the IOI by telling him the maximum number of balls from the row he can destroy." 1400
430A "Points and Segments (easy)" "constructive algorithms,sortings" "Iahub isn\'t well prepared on geometry problems, but he heard that this year there will be a lot of geometry problems on the IOI selection camp. Scared, Iahub locked himself in the basement and started thinking of new problems of this kind. One of them is the following.Iahub wants to draw n distinct points and m segments on the OX axis. He can draw each point with either red or blue. The drawing is good if and only if the following requirement is met: for each segment [li,\xe2\x80\x89ri] consider all the red points belong to it (ri points), and all the blue points belong to it (bi points); each segment i should satisfy the inequality |ri\xe2\x80\x89-\xe2\x80\x89bi|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891.Iahub thinks that point x belongs to segment [l,\xe2\x80\x89r], if inequality l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r holds.Iahub gives to you all coordinates of points and segments. Please, help him to find any good drawing." 1600
429E "Points and Segments" graphs "Iahub isn\'t well prepared on geometry problems, but he heard that this year there will be a lot of geometry problems on the IOI selection camp. Scared, Iahub locked himself in the basement and started thinking of new problems of this kind. One of them is the following.Iahub wants to draw n distinct segments [li,\xe2\x80\x89ri] on the OX axis. He can draw each segment with either red or blue. The drawing is good if and only if the following requirement is met: for each point x of the OX axis consider all the segments that contains point x; suppose, that rx red segments and bx blue segments contain point x; for each point x inequality |rx\xe2\x80\x89-\xe2\x80\x89bx|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 must be satisfied.A segment [l,\xe2\x80\x89r] contains a point x if and only if l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Iahub gives you the starting and ending points of all the segments. You have to find any good drawing for him." 3000
429D "Tricky Function" "data structures,divide and conquer,geometry" "Iahub and Sorin are the best competitive programmers in their town. However, they can\'t both qualify to an important contest. The selection will be made with the help of a single problem. Blatnatalag, a friend of Iahub, managed to get hold of the problem before the contest. Because he wants to make sure Iahub will be the one qualified, he tells Iahub the following task.You\'re given an (1-based) array a with n elements. Let\'s define function f(i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) as (i\xe2\x80\x89-\xe2\x80\x89j)2\xe2\x80\x89+\xe2\x80\x89g(i,\xe2\x80\x89j)2. Function g is calculated by the following pseudo-code:int g(int i, int j) {    int sum = 0;    for (int k = min(i, j) + 1; k <= max(i, j); k = k + 1)        sum = sum + a[k];    return sum;}Find a value mini\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j  f(i,\xe2\x80\x89j).Probably by now Iahub already figured out the solution to this problem. Can you?" 2200
429C "Guess the Tree" "bitmasks,constructive algorithms,dp,greedy,trees" "Iahub and Iahubina went to a picnic in a forest full of trees. Less than 5 minutes passed before Iahub remembered of trees from programming. Moreover, he invented a new problem and Iahubina has to solve it, otherwise Iahub won\'t give her the food. Iahub asks Iahubina: can you build a rooted tree, such that  each internal node (a node with at least one son) has at least two sons;  node i has ci nodes in its subtree? Iahubina has to guess the tree. Being a smart girl, she realized that it\'s possible no tree can follow Iahub\'s restrictions. In this way, Iahub will eat all the food. You need to help Iahubina: determine if there\'s at least one tree following Iahub\'s restrictions. The required tree must contain n nodes." 2300
429B "Working out" dp "Summer is coming! It\'s time for Iahub and Iahubina to work out, as they both want to look hot at the beach. The gym where they go is a matrix a with n lines and m columns. Let number a[i][j] represents the calories burned by performing workout at the cell of gym in the i-th line and the j-th column.Iahub starts with workout located at line 1 and column 1. He needs to finish with workout a[n][m]. After finishing workout a[i][j], he can go to workout a[i\xe2\x80\x89+\xe2\x80\x891][j] or a[i][j\xe2\x80\x89+\xe2\x80\x891]. Similarly, Iahubina starts with workout a[n][1] and she needs to finish with workout a[1][m]. After finishing workout from cell a[i][j], she goes to either a[i][j\xe2\x80\x89+\xe2\x80\x891] or a[i\xe2\x80\x89-\xe2\x80\x891][j]. There is one additional condition for their training. They have to meet in exactly one cell of gym. At that cell, none of them will work out. They will talk about fast exponentiation (pretty odd small talk) and then both of them will move to the next workout.If a workout was done by either Iahub or Iahubina, it counts as total gain. Please plan a workout for Iahub and Iahubina such as total gain to be as big as possible. Note, that Iahub and Iahubina can perform workouts with different speed, so the number of cells that they use to reach meet cell may differs." 1600
429A Xor-tree "dfs and similar,trees" "Iahub is very proud of his recent discovery, propagating trees. Right now, he invented a new tree, called xor-tree. After this new revolutionary discovery, he invented a game for kids which uses xor-trees.The game is played on a tree having n nodes, numbered from 1 to n. Each node i has an initial value initi, which is either 0 or 1. The root of the tree is node 1.One can perform several (possibly, zero) operations on the tree during the game. The only available type of operation is to pick a node x. Right after someone has picked node x, the value of node x flips, the values of sons of x remain the same, the values of sons of sons of x flips, the values of sons of sons of sons of x remain the same and so on.The goal of the game is to get each node i to have value goali, which can also be only 0 or 1. You need to reach the goal of the game by using minimum number of operations." 1300
427E "Police Patrol" "greedy,implementation,math,ternary search" "Imagine that your city is an infinite 2D plane with Cartesian coordinate system. The only crime-affected road of your city is the x-axis. Currently, there are n criminals along the road. No police station has been built on this road yet, so the mayor wants to build one.As you are going to be in charge of this new police station, the mayor has asked you to choose a suitable position (some integer point) for building it. You should choose the best position for the police station, so that you could minimize the total time of your criminal catching mission. Your mission of catching the criminals will operate only from this station. The new station will have only one patrol car. You will go to the criminals by this car, carry them on the car, bring them back to the police station and put them in prison. The patrol car can carry at most m criminals at a time. Note that, the criminals don\'t know about your mission. So, they will stay where they are instead of running away.Your task is to find the position for the police station, so that total distance you need to cover to catch all the criminals will be minimum possible. Note that, you also can built the police station on the positions where one or more criminals already exist. In such a case all these criminals are arrested instantly." 2000
427D "Match & Catch" "dp,string suffix structures,strings" "Police headquarter is monitoring signal on different frequency levels. They have got two suspiciously encoded strings s1 and s2 from two different frequencies as signals. They are suspecting that these two strings are from two different criminals and they are planning to do some evil task.Now they are trying to find a common substring of minimum length between these two strings. The substring must occur only once in the first string, and also it must occur only once in the second string.Given two strings s1 and s2 consist of lowercase Latin letters, find the smallest (by length) common substring p of both s1 and s2, where p is a unique substring in s1 and also in s2. See notes for formal definition of substring and uniqueness." 2200
427C Checkposts "dfs and similar,graphs,two pointers" "Your city has n junctions. There are m one-way roads between the junctions. As a mayor of the city, you have to ensure the security of all the junctions.To ensure the security, you have to build some police checkposts. Checkposts can only be built in a junction. A checkpost at junction i can protect junction j if either i\xe2\x80\x89=\xe2\x80\x89j or the police patrol car can go to j from i and then come back to i.Building checkposts costs some money. As some areas of the city are more expensive than others, building checkpost at some junctions might cost more money than other junctions.You have to determine the minimum possible money needed to ensure the security of all the junctions. Also you have to find the number of ways to ensure the security in minimum price and in addition in minimum number of checkposts. Two ways are different if any of the junctions contains a checkpost in one of them and do not contain in the other." 1700
427B "Prison Transfer" "data structures,implementation" "The prison of your city has n prisoners. As the prison can\'t accommodate all of them, the city mayor has decided to transfer c of the prisoners to a prison located in another city.For this reason, he made the n prisoners to stand in a line, with a number written on their chests. The number is the severity of the crime he/she has committed. The greater the number, the more severe his/her crime was.Then, the mayor told you to choose the c prisoners, who will be transferred to the other prison. He also imposed two conditions. They are,  The chosen c prisoners has to form a contiguous segment of prisoners.  Any of the chosen prisoner\'s crime level should not be greater then t. Because, that will make the prisoner a severe criminal and the mayor doesn\'t want to take the risk of his running away during the transfer. Find the number of ways you can choose the c prisoners." 1100
427A "Police Recruits" implementation "The police department of your city has just started its journey. Initially, they don\xe2\x80\x99t have any manpower. So, they started hiring new recruits in groups.Meanwhile, crimes keeps occurring within the city. One member of the police force can investigate only one crime during his/her lifetime.If there is no police officer free (isn\'t busy with crime) during the occurrence of a crime, it will go untreated.Given the chronological order of crime occurrences and recruit hirings, find the number of crimes which will go untreated." 800
426B "Sereja and Mirroring" implementation "Let\'s assume that we are given a matrix b of size x\xe2\x80\x89\xc3\x97\xe2\x80\x89y, let\'s determine the operation of mirroring matrix b. The mirroring of matrix b is a 2x\xe2\x80\x89\xc3\x97\xe2\x80\x89y matrix c which has the following properties:  the upper half of matrix c (rows with numbers from 1 to x) exactly matches b;  the lower half of matrix c (rows with numbers from x\xe2\x80\x89+\xe2\x80\x891 to 2x) is symmetric to the upper one; the symmetry line is the line that separates two halves (the line that goes in the middle, between rows x and x\xe2\x80\x89+\xe2\x80\x891). Sereja has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix a. He wants to find such matrix b, that it can be transformed into matrix a, if we\'ll perform on it several (possibly zero) mirrorings. What minimum number of rows can such matrix contain?" 1300
426A "Sereja and Mugs" implementation "Sereja showed an interesting game to his friends. The game goes like that. Initially, there is a table with an empty cup and n water mugs on it. Then all players take turns to move. During a move, a player takes a non-empty mug of water and pours all water from it into the cup. If the cup overfills, then we assume that this player lost.As soon as Sereja\'s friends heard of the game, they wanted to play it. Sereja, on the other hand, wanted to find out whether his friends can play the game in such a way that there are no losers. You are given the volumes of all mugs and the cup. Also, you know that Sereja has (n\xe2\x80\x89-\xe2\x80\x891) friends. Determine if Sereja\'s friends can play the game so that nobody loses." 800
425E "Sereja and Sets" dp "Let\'s assume that set S consists of m distinct intervals [l1,\xe2\x80\x89r1], [l2,\xe2\x80\x89r2], ..., [lm,\xe2\x80\x89rm] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; li,\xe2\x80\x89ri are integers).Let\'s assume that f(S) is the maximum number of intervals that you can choose from the set S, such that every two of them do not intersect. We assume that two intervals, [l1,\xe2\x80\x89r1] and [l2,\xe2\x80\x89r2], intersect if there is an integer x, which meets two inequalities: l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1 and l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2.Sereja wonders, how many sets S are there, such that f(S)\xe2\x80\x89=\xe2\x80\x89k? Count this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2500
425D "Sereja and Squares" "binary search,data structures,hashing" "Sereja has painted n distinct points on the plane. The coordinates of each point are integers. Now he is wondering: how many squares are there with sides parallel to the coordinate axes and with points painted in all its four vertexes? Help him, calculate this number." 2300
425C "Sereja and Two Sequences" "data structures,dp" "Sereja has two sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm, consisting of integers. One day Sereja got bored and he decided two play with them. The rules of the game was very simple. Sereja makes several moves, in one move he can perform one of the following actions:  Choose several (at least one) first elements of sequence a (non-empty prefix of a), choose several (at least one) first elements of sequence b (non-empty prefix of b); the element of sequence a with the maximum index among the chosen ones must be equal to the element of sequence b with the maximum index among the chosen ones; remove the chosen elements from the sequences.  Remove all elements of both sequences. The first action is worth e energy units and adds one dollar to Sereja\'s electronic account. The second action is worth the number of energy units equal to the number of elements Sereja removed from the sequences before performing this action. After Sereja performed the second action, he gets all the money that he earned on his electronic account during the game.Initially Sereja has s energy units and no money on his account. What maximum number of money can Sereja get? Note, the amount of Seraja\'s energy mustn\'t be negative at any time moment." 2300
425B "Sereja and Table" bitmasks,greedy "Sereja has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table a, each cell of the table contains a zero or a number one. Sereja wants his table to meet the following requirement: each connected component of the same values forms a rectangle with sides parallel to the sides of the table. Rectangles should be filled with cells, that is, if a component form a rectangle of size h\xe2\x80\x89\xc3\x97\xe2\x80\x89w, then the component must contain exactly hw cells.A connected component of the same values is a set of cells of the table that meet the following conditions:  every two cells of the set have the same value;  the cells of the set form a connected region on the table (two cells are connected if they are adjacent in some row or some column of the table);  it is impossible to add any cell to the set unless we violate the two previous conditions. Can Sereja change the values of at most k cells of the table so that the table met the described requirement? What minimum number of table cells should he change in this case?" 2200
425A "Sereja and Swaps" "brute force,sortings" "As usual, Sereja has array a, its elements are integers: a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n]. Let\'s introduce notation:A swap operation is the following sequence of actions:  choose two indexes i,\xe2\x80\x89j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j);  perform assignments tmp\xe2\x80\x89=\xe2\x80\x89a[i],\xe2\x80\x89a[i]\xe2\x80\x89=\xe2\x80\x89a[j],\xe2\x80\x89a[j]\xe2\x80\x89=\xe2\x80\x89tmp. What maximum value of function m(a) can Sereja get if he is allowed to perform at most k swap operations?" 1500
424E "Colored Jenga" "dfs and similar,dp,probabilities" "Cold winter evenings in Tomsk are very boring \xe2\x80\x94 nobody wants be on the streets at such a time. Residents of Tomsk while away the time sitting in warm apartments, inventing a lot of different games. One of such games is \'Colored Jenga\'.This game requires wooden blocks of three colors: red, green and blue. A tower of n levels is made from them. Each level consists of three wooden blocks. The blocks in each level can be of arbitrary colors, but they are always located close and parallel to each other. An example of such a tower is shown in the figure.  The game is played by exactly one person. Every minute a player throws a special dice which has six sides. Two sides of the dice are green, two are blue, one is red and one is black. The dice shows each side equiprobably.If the dice shows red, green or blue, the player must take any block of this color out of the tower at this minute so that the tower doesn\'t fall. If this is not possible, the player waits until the end of the minute, without touching the tower. He also has to wait until the end of the minute without touching the tower if the dice shows the black side. It is not allowed to take blocks from the top level of the tower (whether it is completed or not).Once a player got a block out, he must put it on the top of the tower so as to form a new level or finish the upper level consisting of previously placed blocks. The newly constructed levels should have all the same properties as the initial levels. If the upper level is not completed, starting the new level is prohibited.For the tower not to fall, in each of the levels except for the top, there should be at least one block. Moreover, if at some of these levels there is exactly one block left and this block is not the middle block, the tower falls.The game ends at the moment when there is no block in the tower that you can take out so that the tower doesn\'t fall.Here is a wonderful game invented by the residents of the city of Tomsk. I wonder for how many minutes can the game last if the player acts optimally well? If a player acts optimally well, then at any moment he tries to choose the block he takes out so as to minimize the expected number of the game duration.Your task is to write a program that determines the expected number of the desired amount of minutes." 2500
424D "Biathlon Track" "binary search,brute force,constructive algorithms,data structures,dp" "Recently an official statement of the world Olympic Committee said that the Olympic Winter Games 2030 will be held in Tomsk. The city officials decided to prepare for the Olympics thoroughly and to build all the necessary Olympic facilities as early as possible. First, a biathlon track will be built.To construct a biathlon track a plot of land was allocated, which is a rectangle divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m identical squares. Each of the squares has two coordinates: the number of the row (from 1 to n), where it is located, the number of the column (from 1 to m), where it is located. Also each of the squares is characterized by its height. During the sports the biathletes will have to move from one square to another. If a biathlete moves from a higher square to a lower one, he makes a descent. If a biathlete moves from a lower square to a higher one, he makes an ascent. If a biathlete moves between two squares with the same height, then he moves on flat ground.The biathlon track should be a border of some rectangular area of the allocated land on which biathletes will move in the clockwise direction. It is known that on one move on flat ground an average biathlete spends tp seconds, an ascent takes tu seconds, a descent takes td seconds. The Tomsk Administration wants to choose the route so that the average biathlete passes it in as close to t seconds as possible. In other words, the difference between time ts of passing the selected track and t should be minimum.For a better understanding you can look at the first sample of the input data. In this sample n\xe2\x80\x89=\xe2\x80\x896,\xe2\x80\x89m\xe2\x80\x89=\xe2\x80\x897, and the administration wants the track covering time to be as close to t\xe2\x80\x89=\xe2\x80\x8948 seconds as possible, also, tp\xe2\x80\x89=\xe2\x80\x893, tu\xe2\x80\x89=\xe2\x80\x896 and td\xe2\x80\x89=\xe2\x80\x892. If we consider the rectangle shown on the image by arrows, the average biathlete can move along the boundary in a clockwise direction in exactly 48 seconds. The upper left corner of this track is located in the square with the row number 4, column number 3 and the lower right corner is at square with row number 6, column number 7.  Among other things the administration wants all sides of the rectangle which boundaries will be the biathlon track to consist of no less than three squares and to be completely contained within the selected land.You are given the description of the given plot of land and all necessary time values. You are to write the program to find the most suitable rectangle for a biathlon track. If there are several such rectangles, you are allowed to print any of them." 2300
424C "Magic Formulas" math "People in the Tomskaya region like magic formulas very much. You can see some of them below.Imagine you are given a sequence of positive integer numbers p1, p2, ..., pn. Lets write down some magic formulas:Here, ""mod"" means the operation of taking the residue after dividing.The expression  means applying the bitwise xor (excluding ""OR"") operation to integers x and y. The given operation exists in all modern programming languages. For example, in languages C++ and Java it is represented by ""^"", in Pascal \xe2\x80\x94 by ""xor"".People in the Tomskaya region like magic formulas very much, but they don\'t like to calculate them! Therefore you are given the sequence p, calculate the value of Q." 1600
424B Megacity "binary search,greedy,implementation,sortings" "The administration of the Tomsk Region firmly believes that it\'s time to become a megacity (that is, get population of one million). Instead of improving the demographic situation, they decided to achieve its goal by expanding the boundaries of the city.The city of Tomsk can be represented as point on the plane with coordinates (0; 0). The city is surrounded with n other locations, the i-th one has coordinates (xi, yi) with the population of ki people. You can widen the city boundaries to a circle of radius r. In such case all locations inside the circle and on its border are included into the city.Your goal is to write a program that will determine the minimum radius r, to which is necessary to expand the boundaries of Tomsk, so that it becomes a megacity." 1200
424A Squats implementation "Pasha has many hamsters and he makes them work out. Today, n hamsters (n is even) came to work out. The hamsters lined up and each hamster either sat down or stood up.For another exercise, Pasha needs exactly  hamsters to stand up and the other hamsters to sit down. In one minute, Pasha can make some hamster ether sit down or stand up. How many minutes will he need to get what he wants if he acts optimally well?" 900
421D "Bug in Code" "binary search,data structures,sortings" "Recently a serious bug has been found in the FOS code. The head of the F company wants to find the culprit and punish him. For that, he set up an organizational meeting, the issue is: who\'s bugged the code? Each of the n coders on the meeting said: \'I know for sure that either x or y did it!\'The head of the company decided to choose two suspects and invite them to his office. Naturally, he should consider the coders\' opinions. That\'s why the head wants to make such a choice that at least p of n coders agreed with it. A coder agrees with the choice of two suspects if at least one of the two people that he named at the meeting was chosen as a suspect. In how many ways can the head of F choose two suspects?Note that even if some coder was chosen as a suspect, he can agree with the head\'s choice if he named the other chosen coder at the meeting." 1900
421A "Pasha and Hamsters" "constructive algorithms,implementation" "Pasha has two hamsters: Arthur and Alexander. Pasha put n apples in front of them. Pasha knows which apples Arthur likes. Similarly, Pasha knows which apples Alexander likes. Pasha doesn\'t want any conflict between the hamsters (as they may like the same apple), so he decided to distribute the apples between the hamsters on his own. He is going to give some apples to Arthur and some apples to Alexander. It doesn\'t matter how many apples each hamster gets but it is important that each hamster gets only the apples he likes. It is possible that somebody doesn\'t get any apples.Help Pasha distribute all the apples between the hamsters. Note that Pasha wants to distribute all the apples, not just some of them." 800
420E "Playing the ball" geometry "A coder cannot sit and code all day. Sometimes it is a good idea to rise from the desk, have a rest, have small talk with colleagues and even play. The coders of the F company have their favorite ball game.Let\'s imagine the game on the plane with a cartesian coordinate system. The point (0, 0) contains the player who chooses an arbitrary direction and throws a ball in that direction. The ball hits the plane at distance d from the player\'s original position and continues flying in the same direction. After the ball hits the plane for the first time, it flies on and hits the plane again at distance 2\xc2\xb7d from the player\'s original position and so on (it continue flying in the chosen direction and hitting the plane after each d units). All coders in the F company are strong, so the ball flies infinitely far away.The plane has n circles painted on it. If a ball hits the plane and hits a circle that is painted on the plane (including its border), then the player gets one point. The ball can hit multiple circles at once and get one point for each of them (if the ball hits some circle x times during the move, the player also gets x points). Count the maximum number of points a player can get if he throws a ball in the arbitrary direction. Note that the direction may have real cooridinates." 2600
420D "Cup Trick" "data structures" "The employees of the F company have lots of ways to entertain themselves. Today they invited a famous magician who shows a trick with plastic cups and a marble.The point is to trick the spectator\'s attention. Initially, the spectator stands in front of a line of n plastic cups. Then the magician places a small marble under one cup and shuffles the cups. Then the spectator should guess which cup hides the marble.But the head coder of the F company isn\'t easy to trick. When he saw the performance, he noticed several important facts:  each cup contains a mark \xe2\x80\x94 a number from 1 to n; all marks on the cups are distinct;  the magician shuffles the cups in m operations, each operation looks like that: take a cup marked xi, sitting at position yi in the row of cups (the positions are numbered from left to right, starting from 1) and shift it to the very beginning of the cup row (on the first position). When the head coder came home after work he wanted to re-do the trick. Unfortunately, he didn\'t remember the starting or the final position of the cups. He only remembered which operations the magician performed. Help the coder: given the operations in the order they were made find at least one initial permutation of the cups that can go through the described operations in the given order. Otherwise, state that such permutation doesn\'t exist." 2200
420C "Bug in Code" "data structures,graphs,implementation,two pointers" "Recently a serious bug has been found in the FOS code. The head of the F company wants to find the culprit and punish him. For that, he set up an organizational meeting, the issue is: who\'s bugged the code? Each of the n coders on the meeting said: \'I know for sure that either x or y did it!\'The head of the company decided to choose two suspects and invite them to his office. Naturally, he should consider the coders\' opinions. That\'s why the head wants to make such a choice that at least p of n coders agreed with it. A coder agrees with the choice of two suspects if at least one of the two people that he named at the meeting was chosen as a suspect. In how many ways can the head of F choose two suspects?Note that even if some coder was chosen as a suspect, he can agree with the head\'s choice if he named the other chosen coder at the meeting." 1900
420B "Online Meeting" implementation "Nearly each project of the F company has a whole team of developers working on it. They often are in different rooms of the office in different cities and even countries. To keep in touch and track the results of the project, the F company conducts shared online meetings in a Spyke chat.One day the director of the F company got hold of the records of a part of an online meeting of one successful team. The director watched the record and wanted to talk to the team leader. But how can he tell who the leader is? The director logically supposed that the leader is the person who is present at any conversation during a chat meeting. In other words, if at some moment of time at least one person is present on the meeting, then the leader is present on the meeting.You are the assistant director. Given the \'user logged on\'/\'user logged off\' messages of the meeting in the chronological order, help the director determine who can be the leader. Note that the director has the record of only a continuous part of the meeting (probably, it\'s not the whole meeting)." 1800
420A "Start Up" implementation "Recently, a start up by two students of a state university of city F gained incredible popularity. Now it\'s time to start a new company. But what do we call it?The market analysts came up with a very smart plan: the name of the company should be identical to its reflection in a mirror! In other words, if we write out the name of the company on a piece of paper in a line (horizontally, from left to right) with large English letters, then put this piece of paper in front of the mirror, then the reflection of the name in the mirror should perfectly match the line written on the piece of paper.There are many suggestions for the company name, so coming up to the mirror with a piece of paper for each name wouldn\'t be sensible. The founders of the company decided to automatize this process. They asked you to write a program that can, given a word, determine whether the word is a \'mirror\' word or not." 1000
418E "Tricky Password" "data structures" "In order to ensure confidentiality, the access to the ""Russian Code Cup"" problems is password protected during the problem development process.To select a password, the jury can generate a special table that contains n columns and the infinite number of rows. To construct a table, the first row is fixed, and all the others are obtained by the following rule:In the row i at position p there is a number equal to the number of times a[i\xe2\x80\x89-\xe2\x80\x891][p] occurs on the prefix a[i\xe2\x80\x89-\xe2\x80\x891][1... p].To ensure the required level of confidentiality, the jury must be able to perform the following operations:   Replace number a[1][p] by v and rebuild the table.  Find the number a[x][y], which will be the new password. Doing all these steps manually is very tedious, so the jury asks you to help him. Write a program that responds to the request of the jury." 3100
418D "Big Problems for Organizers" "data structures,graphs,trees" "The Finals of the ""Russian Code Cup"" 2214 will be held in n hotels. Two hotels (let\'s assume that they are the main hotels), will host all sorts of events, and the remaining hotels will accommodate the participants. The hotels are connected by n\xe2\x80\x89-\xe2\x80\x891 roads, you can get from any hotel to any other one.The organizers wonder what is the minimum time all the participants need to get to the main hotels, if each participant goes to the main hotel that is nearest to him and moving between two hotels connected by a road takes one unit of time.The hosts consider various options for the location of the main hotels. For each option help the organizers to find minimal time." 2800
417E "Square Table" "constructive algorithms,math,probabilities" "While resting on the ship after the ""Russian Code Cup"" a boy named Misha invented an interesting game. He promised to give his quadrocopter to whoever will be the first one to make a rectangular table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, consisting of positive integers such that the sum of the squares of numbers for each row and each column was also a square.Since checking the correctness of the table manually is difficult, Misha asks you to make each number in the table to not exceed 108." 2400
417D "Cunning Gena" bitmasks,dp,greedy,sortings "A boy named Gena really wants to get to the ""Russian Code Cup"" finals, or at least get a t-shirt. But the offered problems are too complex, so he made an arrangement with his n friends that they will solve the problems for him.The participants are offered m problems on the contest. For each friend, Gena knows what problems he can solve. But Gena\'s friends won\'t agree to help Gena for nothing: the i-th friend asks Gena xi rubles for his help in solving all the problems he can. Also, the friend agreed to write a code for Gena only if Gena\'s computer is connected to at least ki monitors, each monitor costs b rubles.Gena is careful with money, so he wants to spend as little money as possible to solve all the problems. Help Gena, tell him how to spend the smallest possible amount of money. Initially, there\'s no monitors connected to Gena\'s computer." 1900
417C Football "constructive algorithms,graphs,implementation" "One day, at the ""Russian Code Cup"" event it was decided to play football as an out of competition event. All participants was divided into n teams and played several matches, two teams could not play against each other more than once.The appointed Judge was the most experienced member \xe2\x80\x94 Pavel. But since he was the wisest of all, he soon got bored of the game and fell asleep. Waking up, he discovered that the tournament is over and the teams want to know the results of all the matches.Pavel didn\'t want anyone to discover about him sleeping and not keeping an eye on the results, so he decided to recover the results of all games. To do this, he asked all the teams and learned that the real winner was friendship, that is, each team beat the other teams exactly k times. Help Pavel come up with chronology of the tournir that meets all the conditions, or otherwise report that there is no such table." 1400
417B Crash implementation "During the ""Russian Code Cup"" programming competition, the testing system stores all sent solutions for each participant. We know that many participants use random numbers in their programs and are often sent several solutions with the same source code to check.Each participant is identified by some unique positive integer k, and each sent solution A is characterized by two numbers: x \xe2\x80\x94 the number of different solutions that are sent before the first solution identical to A, and k \xe2\x80\x94 the number of the participant, who is the author of the solution. Consequently, all identical solutions have the same x.It is known that the data in the testing system are stored in the chronological order, that is, if the testing system has a solution with number x (x\xe2\x80\x89>\xe2\x80\x890) of the participant with number k, then the testing system has a solution with number x\xe2\x80\x89-\xe2\x80\x891 of the same participant stored somewhere before.During the competition the checking system crashed, but then the data of the submissions of all participants have been restored. Now the jury wants to verify that the recovered data is in chronological order. Help the jury to do so." 1400
417A Elimination dp,implementation,math "The finalists of the ""Russian Code Cup"" competition in 2214 will be the participants who win in one of the elimination rounds.The elimination rounds are divided into main and additional. Each of the main elimination rounds consists of c problems, the winners of the round are the first n people in the rating list. Each of the additional elimination rounds consists of d problems. The winner of the additional round is one person. Besides, k winners of the past finals are invited to the finals without elimination.As a result of all elimination rounds at least n\xc2\xb7m people should go to the finals. You need to organize elimination rounds in such a way, that at least n\xc2\xb7m people go to the finals, and the total amount of used problems in all rounds is as small as possible." 1500
416E "President\'s Path" "dp,graphs,shortest paths" "Good old Berland has n cities and m roads. Each road connects a pair of distinct cities and is bidirectional. Between any pair of cities, there is at most one road. For each road, we know its length.We also know that the President will soon ride along the Berland roads from city s to city t. Naturally, he will choose one of the shortest paths from s to t, but nobody can say for sure which path he will choose.The Minister for Transport is really afraid that the President might get upset by the state of the roads in the country. That is the reason he is planning to repair the roads in the possible President\'s path.Making the budget for such an event is not an easy task. For all possible distinct pairs s,\xe2\x80\x89t (s\xe2\x80\x89<\xe2\x80\x89t) find the number of roads that lie on at least one shortest path from s to t." 2500
416D "Population Size" greedy,implementation,math "Polycarpus develops an interesting theory about the interrelation of arithmetic progressions with just everything in the world. His current idea is that the population of the capital of Berland changes over time like an arithmetic progression. Well, or like multiple arithmetic progressions.Polycarpus believes that if he writes out the population of the capital for several consecutive years in the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, then it is convenient to consider the array as several arithmetic progressions, written one after the other. For example, sequence (8,\xe2\x80\x896,\xe2\x80\x894,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x894,\xe2\x80\x897,\xe2\x80\x8910,\xe2\x80\x892) can be considered as a sequence of three arithmetic progressions (8,\xe2\x80\x896,\xe2\x80\x894,\xe2\x80\x892), (1,\xe2\x80\x894,\xe2\x80\x897,\xe2\x80\x8910) and (2), which are written one after another.Unfortunately, Polycarpus may not have all the data for the n consecutive years (a census of the population doesn\'t occur every year, after all). For this reason, some values of ai \xe2\x80\x8b\xe2\x80\x8bmay be unknown. Such values are represented by number -1.For a given sequence a\xe2\x80\x89=\xe2\x80\x89(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an), which consists of positive integers and values \xe2\x80\x8b\xe2\x80\x8b-1, find the minimum number of arithmetic progressions Polycarpus needs to get a. To get a, the progressions need to be written down one after the other. Values \xe2\x80\x8b\xe2\x80\x8b-1 may correspond to an arbitrary positive integer and the values ai\xe2\x80\x89>\xe2\x80\x890 must be equal to the corresponding elements of sought consecutive record of the progressions.Let us remind you that a finite sequence c is called an arithmetic progression if the difference ci\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ci of any two consecutive elements in it is constant. By definition, any sequence of length 1 is an arithmetic progression." 2400
416C "Booking System" "binary search,dp,greedy,implementation" "Innovation technologies are on a victorious march around the planet. They integrate into all spheres of human activity!A restaurant called ""Dijkstra\'s Place"" has started thinking about optimizing the booking system. There are n booking requests received by now. Each request is characterized by two numbers: ci and pi \xe2\x80\x94 the size of the group of visitors who will come via this request and the total sum of money they will spend in the restaurant, correspondingly.We know that for each request, all ci people want to sit at the same table and are going to spend the whole evening in the restaurant, from the opening moment at 18:00 to the closing moment.Unfortunately, there only are k tables in the restaurant. For each table, we know ri \xe2\x80\x94 the maximum number of people who can sit at it. A table can have only people from the same group sitting at it. If you cannot find a large enough table for the whole group, then all visitors leave and naturally, pay nothing.Your task is: given the tables and the requests, decide which requests to accept and which requests to decline so that the money paid by the happy and full visitors was maximum." 1600
416B "Art Union" "brute force,dp,implementation" "A well-known art union called ""Kalevich is Alive!"" manufactures objects d\'art (pictures). The union consists of n painters who decided to organize their work as follows.Each painter uses only the color that was assigned to him. The colors are distinct for all painters. Let\'s assume that the first painter uses color 1, the second one uses color 2, and so on. Each picture will contain all these n colors. Adding the j-th color to the i-th picture takes the j-th painter tij units of time.Order is important everywhere, so the painters\' work is ordered by the following rules:  Each picture is first painted by the first painter, then by the second one, and so on. That is, after the j-th painter finishes working on the picture, it must go to the (j\xe2\x80\x89+\xe2\x80\x891)-th painter (if j\xe2\x80\x89<\xe2\x80\x89n);  each painter works on the pictures in some order: first, he paints the first picture, then he paints the second picture and so on;  each painter can simultaneously work on at most one picture. However, the painters don\'t need any time to have a rest;  as soon as the j-th painter finishes his part of working on the picture, the picture immediately becomes available to the next painter. Given that the painters start working at time 0, find for each picture the time when it is ready for sale." 1300
416A "Guess a number!" "greedy,implementation,two pointers" "A TV show called ""Guess a number!"" is gathering popularity. The whole Berland, the old and the young, are watching the show.The rules are simple. The host thinks of an integer y and the participants guess it by asking questions to the host. There are four types of acceptable questions:  Is it true that y is strictly larger than number x?  Is it true that y is strictly smaller than number x?  Is it true that y is larger than or equal to number x?  Is it true that y is smaller than or equal to number x? On each question the host answers truthfully, ""yes"" or ""no"".Given the sequence of questions and answers, find any integer value of y that meets the criteria of all answers. If there isn\'t such value, print ""Impossible""." 1400
415B "Mashmokh and Tokens" "binary search,greedy,implementation,math" "Bimokh is Mashmokh\'s boss. For the following n days he decided to pay to his workers in a new way. At the beginning of each day he will give each worker a certain amount of tokens. Then at the end of each day each worker can give some of his tokens back to get a certain amount of money. The worker can save the rest of tokens but he can\'t use it in any other day to get more money. If a worker gives back w tokens then he\'ll get  dollars. Mashmokh likes the tokens however he likes money more. That\'s why he wants to save as many tokens as possible so that the amount of money he gets is maximal possible each day. He has n numbers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. Number xi is the number of tokens given to each worker on the i-th day. Help him calculate for each of n days the number of tokens he can save." 1500
415A "Mashmokh and Lights" implementation "Mashmokh works in a factory. At the end of each day he must turn off all of the lights. The lights on the factory are indexed from 1 to n. There are n buttons in Mashmokh\'s room indexed from 1 to n as well. If Mashmokh pushes button with index i, then each light with index not less than i that is still turned on turns off.Mashmokh is not very clever. So instead of pushing the first button he pushes some of the buttons randomly each night. He pushed m distinct buttons b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm (the buttons were pushed consecutively in the given order) this night. Now he wants to know for each light the index of the button that turned this light off. Please note that the index of button bi is actually bi, not i.Please, help Mashmokh, print these indices." 900
414E "Mashmokh\'s Designed Problem" "data structures" "After a lot of trying, Mashmokh designed a problem and it\'s your job to solve it.You have a tree T with n vertices. Each vertex has a unique index from 1 to n. The root of T has index 1. For each vertex of this tree v, you are given a list of its children in a specific order. You must perform three types of query on this tree:  find distance (the number of edges in the shortest path) between u and v;  given v and h, disconnect v from its father and connect it to its h-th ancestor; more formally, let\'s denote the path from v to the root by x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xl (h\xe2\x80\x89<\xe2\x80\x89l), so that x1\xe2\x80\x89=\xe2\x80\x89v and xl is root; disconnect v from its father (x2) and connect it to xh\xe2\x80\x89+\xe2\x80\x891; vertex v must be added to the end of the child-list of vertex xh\xe2\x80\x89+\xe2\x80\x891;  in the vertex sequence produced by calling function dfs(root) find the latest vertex that has distance k from the root. The pseudo-code of function dfs(v): // ls[v]: list of children of vertex v // its i-th element is ls[v][i]// its size is size(ls[v])sequence result = empty sequence;void dfs(vertex now){    add now to end of result;    for(int i = 1; i <= size(ls[v]); i = i + 1) //loop from i = 1 to i = size(ls[v])        dfs(ls[v][i]);}" 3200
414D "Mashmokh and Water Tanks" "binary search,data structures,greedy,trees,two pointers" "Mashmokh is playing a new game. In the beginning he has k liters of water and p coins. Additionally he has a rooted tree (an undirected connected acyclic graph) that consists of m vertices. Each vertex of the tree contains a water tank that is empty in the beginning.The game begins with the fact that Mashmokh chooses some (no more than k) of these tanks (except the root) and pours into each of them exactly 1 liter of water. Then the following process is performed until there is no water remained in tanks.  The process consists of several steps.  At the beginning of each step Mashmokh opens doors of all tanks. Then Mashmokh closes doors of some tanks (he is not allowed to close door of tank in the root) for the duration of this move. Let\'s denote the number of liters in some tank with closed door as w, Mashmokh pays w coins for the closing of that tank during this move.  Let\'s denote by x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm as the list of vertices of the tree sorted (nondecreasing) by their depth. The vertices from this list should be considered one by one in the order. Firstly vertex x1 (which is the root itself) is emptied. Then for each vertex xi (i\xe2\x80\x89>\xe2\x80\x891), if its door is closed then skip the vertex else move all the water from the tank of vertex xi to the tank of its father (even if the tank of the father is closed). Suppose l moves were made until the tree became empty. Let\'s denote the amount of water inside the tank of the root after the i-th move by wi then Mashmokh will win max(w1,\xe2\x80\x89w2,\xe2\x80\x89...,\xe2\x80\x89wl) dollars. Mashmokh wanted to know what is the maximum amount of dollars he can win by playing the above game. He asked you to find this value for him." 2300
414C "Mashmokh and Reverse Operation" "combinatorics,divide and conquer" "Mashmokh\'s boss, Bimokh, didn\'t like Mashmokh. So he fired him. Mashmokh decided to go to university and participate in ACM instead of finding a new job. He wants to become a member of Bamokh\'s team. In order to join he was given some programming tasks and one week to solve them. Mashmokh is not a very experienced programmer. Actually he is not a programmer at all. So he wasn\'t able to solve them. That\'s why he asked you to help him with these tasks. One of these tasks is the following.You have an array a of length 2n and m queries on it. The i-th query is described by an integer qi. In order to perform the i-th query you must:  split the array into 2n\xe2\x80\x89-\xe2\x80\x89qi parts, where each part is a subarray consisting of 2qi numbers; the j-th subarray (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n\xe2\x80\x89-\xe2\x80\x89qi) should contain the elements a[(j\xe2\x80\x89-\xe2\x80\x891)\xc2\xb72qi\xe2\x80\x89+\xe2\x80\x891],\xe2\x80\x89a[(j\xe2\x80\x89-\xe2\x80\x891)\xc2\xb72qi\xe2\x80\x89+\xe2\x80\x892],\xe2\x80\x89...,\xe2\x80\x89a[(j\xe2\x80\x89-\xe2\x80\x891)\xc2\xb72qi\xe2\x80\x89+\xe2\x80\x892qi];  reverse each of the subarrays;  join them into a single array in the same order (this array becomes new array a);  output the number of inversions in the new a. Given initial array a and all the queries. Answer all the queries. Please, note that the changes from some query is saved for further queries." 2100
414B "Mashmokh and ACM" "combinatorics,dp,number theory" "Mashmokh\'s boss, Bimokh, didn\'t like Mashmokh. So he fired him. Mashmokh decided to go to university and participate in ACM instead of finding a new job. He wants to become a member of Bamokh\'s team. In order to join he was given some programming tasks and one week to solve them. Mashmokh is not a very experienced programmer. Actually he is not a programmer at all. So he wasn\'t able to solve them. That\'s why he asked you to help him with these tasks. One of these tasks is the following.A sequence of l integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bl (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bl\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is called good if each number divides (without a remainder) by the next number in the sequence. More formally  for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891).Given n and k find the number of good sequences of length k. As the answer can be rather large print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1400
414A "Mashmokh and Numbers" "constructive algorithms,number theory" "It\'s holiday. Mashmokh and his boss, Bimokh, are playing a game invented by Mashmokh. In this game Mashmokh writes sequence of n distinct integers on the board. Then Bimokh makes several (possibly zero) moves. On the first move he removes the first and the second integer from from the board, on the second move he removes the first and the second integer of the remaining sequence from the board, and so on. Bimokh stops when the board contains less than two numbers. When Bimokh removes numbers x and y from the board, he gets gcd(x,\xe2\x80\x89y) points. At the beginning of the game Bimokh has zero points.Mashmokh wants to win in the game. For this reason he wants his boss to get exactly k points in total. But the guy doesn\'t know how choose the initial sequence in the right way. Please, help him. Find n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an such that his boss will score exactly k points. Also Mashmokh can\'t memorize too huge numbers. Therefore each of these integers must be at most 109." 1500
413E "Maze 2D" "data structures,divide and conquer" "The last product of the R2 company in the 2D games\' field is a new revolutionary algorithm of searching for the shortest path in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n maze.Imagine a maze that looks like a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n rectangle, divided into unit squares. Each unit square is either an empty cell or an obstacle. In one unit of time, a person can move from an empty cell of the maze to any side-adjacent empty cell. The shortest path problem is formulated as follows. Given two free maze cells, you need to determine the minimum time required to go from one cell to the other.Unfortunately, the developed algorithm works well for only one request for finding the shortest path, in practice such requests occur quite often. You, as the chief R2 programmer, are commissioned to optimize the algorithm to find the shortest path. Write a program that will effectively respond to multiple requests to find the shortest path in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x89n maze." 2200
413D 2048 bitmasks,dp "The programmers from the R2 company love playing 2048. One day, they decided to invent their own simplified version of this game \xe2\x80\x94 2k on a stripe.Imagine an infinite in one direction stripe, consisting of unit squares (the side of each square is equal to the height of the stripe). Each square can either be empty or contain some number.Initially, all squares are empty. Then at infinity one of the unit squares number 2 or 4 appears. Then the player presses a button once, and the appeared number begins to move towards the beginning of the stripe. Let\'s assume that some number x moves to the beginning of the stripe, then it will stop if:  it either gets in the first square of the stripe;  or it is in the square that is preceded by a square with number y (y\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x). But if number x at some point of time gets to the square with the same number then both numbers add to each other and result in 2x. The new number 2x continues moving to the beginning of the stripe by the same rules. After the final stop of the number moving process, the infinity gets a new number 2 or 4 and the process repeats. Read the notes to the test samples to better understand the moving strategy.I guess you\'ve understood that the game progress fully depends on the order in which numbers 2 and 4 appear. Let\'s look at some sequence of numbers 2 and 4 in the game. We assume that the sequence is winning if it results in at least one square getting the number greater or equal than 2k. The goal of the game is to make up a winning sequence of n numbers. But not everything is so simple, some numbers in the sequence are identified beforehand. You are given a sequence consisting of numbers 0, 2, 4. Count how many ways there are to replace each 0 of the sequence with 2 or 4 to get a winning sequence." 2000
413C Jeopardy! greedy,math "\'Jeopardy!\' is an intellectual game where players answer questions and earn points. Company Q conducts a simplified \'Jeopardy!\' tournament among the best IT companies. By a lucky coincidence, the old rivals made it to the finals: company R1 and company R2. The finals will have n questions, m of them are auction questions and n\xe2\x80\x89-\xe2\x80\x89m of them are regular questions. Each question has a price. The price of the i-th question is ai points. During the game the players chose the questions. At that, if the question is an auction, then the player who chose it can change the price if the number of his current points is strictly larger than the price of the question. The new price of the question cannot be less than the original price and cannot be greater than the current number of points of the player who chose the question. The correct answer brings the player the points equal to the price of the question. The wrong answer to the question reduces the number of the player\'s points by the value of the question price.The game will go as follows. First, the R2 company selects a question, then the questions are chosen by the one who answered the previous question correctly. If no one answered the question, then the person who chose last chooses again.All R2 employees support their team. They want to calculate what maximum possible number of points the R2 team can get if luck is on their side during the whole game (they will always be the first to correctly answer questions). Perhaps you are not going to be surprised, but this problem was again entrusted for you to solve." 1400
413B "Spyke Chatting" implementation "The R2 company has n employees working for it. The work involves constant exchange of ideas, sharing the stories of success and upcoming challenging. For that, R2 uses a famous instant messaging program Spyke.R2 has m Spyke chats just to discuss all sorts of issues. In each chat, some group of employees exchanges messages daily. An employee can simultaneously talk in multiple chats. If some employee is in the k-th chat, he can write messages to this chat and receive notifications about messages from this chat. If an employee writes a message in the chat, all other participants of the chat receive a message notification.The R2 company is conducting an audit. Now the specialists study effective communication between the employees. For this purpose, they have a chat log and the description of chat structure. You, as one of audit specialists, are commissioned to write a program that will use this data to determine the total number of message notifications received by each employee." 1300
413A "Data Recovery" implementation "Not so long ago company R2 bought company R1 and consequently, all its developments in the field of multicore processors. Now the R2 laboratory is testing one of the R1 processors.The testing goes in n steps, at each step the processor gets some instructions, and then its temperature is measured. The head engineer in R2 is keeping a report record on the work of the processor: he writes down the minimum and the maximum measured temperature in his notebook. His assistant had to write down all temperatures into his notebook, but (for unknown reasons) he recorded only m.The next day, the engineer\'s assistant filed in a report with all the m temperatures. However, the chief engineer doubts that the assistant wrote down everything correctly (naturally, the chief engineer doesn\'t doubt his notes). So he asked you to help him. Given numbers n, m, min, max and the list of m temperatures determine whether you can upgrade the set of m temperatures to the set of n temperatures (that is add n\xe2\x80\x89-\xe2\x80\x89m temperatures), so that the minimum temperature was min and the maximum one was max." 1200
412E "E-mail Addresses" implementation "One of the most important products of the R1 company is a popular @r1.com mail service. The R1 mailboxes receive and send millions of emails every day.Today, the online news thundered with terrible information. The R1 database crashed and almost no data could be saved except for one big string. The developers assume that the string contains the letters of some users of the R1 mail. Recovering letters is a tedious mostly manual work. So before you start this process, it was decided to estimate the difficulty of recovering. Namely, we need to calculate the number of different substrings of the saved string that form correct e-mail addresses.We assume that valid addresses are only the e-mail addresses which meet the following criteria:  the address should begin with a non-empty sequence of letters, numbers, characters \'_\', starting with a letter;  then must go character \'@\';  then must go a non-empty sequence of letters or numbers;  then must go character \'.\';  the address must end with a non-empty sequence of letters. You got lucky again and the job was entrusted to you! Please note that the substring is several consecutive characters in a string. Two substrings, one consisting of the characters of the string with numbers l1,\xe2\x80\x89l1\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89l1\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89r1 and the other one consisting of the characters of the string with numbers l2,\xe2\x80\x89l2\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89l2\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89r2, are considered distinct if l1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89l2 or r1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r2." 1900
412D "Giving Awards" "dfs and similar" "The employees of the R1 company often spend time together: they watch football, they go camping, they solve contests. So, it\'s no big deal that sometimes someone pays for someone else.Today is the day of giving out money rewards. The R1 company CEO will invite employees into his office one by one, rewarding each one for the hard work this month. The CEO knows who owes money to whom. And he also understands that if he invites person x to his office for a reward, and then immediately invite person y, who has lent some money to person x, then they can meet. Of course, in such a situation, the joy of person x from his brand new money reward will be much less. Therefore, the R1 CEO decided to invite the staff in such an order that the described situation will not happen for any pair of employees invited one after another.However, there are a lot of employees in the company, and the CEO doesn\'t have a lot of time. Therefore, the task has been assigned to you. Given the debt relationships between all the employees, determine in which order they should be invited to the office of the R1 company CEO, or determine that the described order does not exist." 2000
412C Pattern implementation,strings "Developers often face with regular expression patterns. A pattern is usually defined as a string consisting of characters and metacharacters that sets the rules for your search. These patterns are most often used to check whether a particular string meets the certain rules.In this task, a pattern will be a string consisting of small English letters and question marks (\'?\'). The question mark in the pattern is a metacharacter that denotes an arbitrary small letter of the English alphabet. We will assume that a string matches the pattern if we can transform the string into the pattern by replacing the question marks by the appropriate characters. For example, string aba matches patterns: ???, ??a, a?a, aba.Programmers that work for the R1 company love puzzling each other (and themselves) with riddles. One of them is as follows: you are given n patterns of the same length, you need to find a pattern that contains as few question marks as possible, and intersects with each of the given patterns. Two patterns intersect if there is a string that matches both the first and the second pattern. Can you solve this riddle?" 1200
412B "Network Configuration" greedy,sortings "The R1 company wants to hold a web search championship. There were n computers given for the competition, each of them is connected to the Internet. The organizers believe that the data transfer speed directly affects the result. The higher the speed of the Internet is, the faster the participant will find the necessary information. Therefore, before the competition started, each computer had its maximum possible data transfer speed measured. On the i-th computer it was ai kilobits per second.There will be k participants competing in the championship, each should get a separate computer. The organizing company does not want any of the participants to have an advantage over the others, so they want to provide the same data transfer speed to each participant\'s computer. Also, the organizers want to create the most comfortable conditions for the participants, so the data transfer speed on the participants\' computers should be as large as possible.The network settings of the R1 company has a special option that lets you to cut the initial maximum data transfer speed of any computer to any lower speed. How should the R1 company configure the network using the described option so that at least k of n computers had the same data transfer speed and the data transfer speed on these computers was as large as possible?" 900
412A Poster greedy,implementation "The R1 company has recently bought a high rise building in the centre of Moscow for its main office. It\'s time to decorate the new office, and the first thing to do is to write the company\'s slogan above the main entrance to the building.The slogan of the company consists of n characters, so the decorators hung a large banner, n meters wide and 1 meter high, divided into n equal squares. The first character of the slogan must be in the first square (the leftmost) of the poster, the second character must be in the second square, and so on.Of course, the R1 programmers want to write the slogan on the poster themselves. To do this, they have a large (and a very heavy) ladder which was put exactly opposite the k-th square of the poster. To draw the i-th character of the slogan on the poster, you need to climb the ladder, standing in front of the i-th square of the poster. This action (along with climbing up and down the ladder) takes one hour for a painter. The painter is not allowed to draw characters in the adjacent squares when the ladder is in front of the i-th square because the uncomfortable position of the ladder may make the characters untidy. Besides, the programmers can move the ladder. In one hour, they can move the ladder either a meter to the right or a meter to the left.Drawing characters and moving the ladder is very tiring, so the programmers want to finish the job in as little time as possible. Develop for them an optimal poster painting plan!" 900
411C Kicker implementation "Kicker (table football) is a board game based on football, in which players control the footballers\' figures mounted on rods by using bars to get the ball into the opponent\'s goal. When playing two on two, one player of each team controls the goalkeeper and the full-backs (plays defence), the other player controls the half-backs and forwards (plays attack).Two teams of company Q decided to battle each other. Let\'s enumerate players from both teams by integers from 1 to 4. The first and second player play in the first team, the third and the fourth one play in the second team. For each of the four players we know their game skills in defence and attack. The defence skill of the i-th player is ai, the attack skill is bi.Before the game, the teams determine how they will play. First the players of the first team decide who will play in the attack, and who will play in the defence. Then the second team players do the same, based on the choice of their opponents.We will define a team\'s defence as the defence skill of player of the team who plays defence. Similarly, a team\'s attack is the attack skill of the player of the team who plays attack. We assume that one team is guaranteed to beat the other one, if its defence is strictly greater than the opponent\'s attack and its attack is strictly greater than the opponent\'s defence.The teams of company Q know each other\'s strengths and therefore arrange their teams optimally. Identify the team that is guaranteed to win (if both teams act optimally) or tell that there is no such team." 1700
411B "Multi-core Processor" implementation "The research center Q has developed a new multi-core processor. The processor consists of n cores and has k cells of cache memory. Consider the work of this processor.At each cycle each core of the processor gets one instruction: either do nothing, or the number of the memory cell (the core will write an information to the cell). After receiving the command, the core executes it immediately. Sometimes it happens that at one cycle, multiple cores try to write the information into a single cell. Unfortunately, the developers did not foresee the possibility of resolving conflicts between cores, so in this case there is a deadlock: all these cores and the corresponding memory cell are locked forever. Each of the locked cores ignores all further commands, and no core in the future will be able to record an information into the locked cell. If any of the cores tries to write an information into some locked cell, it is immediately locked.The development team wants to explore the deadlock situation. Therefore, they need a program that will simulate the processor for a given set of instructions for each core within m cycles . You\'re lucky, this interesting work is entrusted to you. According to the instructions, during the m cycles define for each core the number of the cycle, during which it will become locked. It is believed that initially all cores and all memory cells are not locked." 1600
411A "Password Check" "*special problem,implementation" "You have probably registered on Internet sites many times. And each time you should enter your invented password. Usually the registration form automatically checks the password\'s crypt resistance. If the user\'s password isn\'t complex enough, a message is displayed. Today your task is to implement such an automatic check.Web-developers of the company Q assume that a password is complex enough, if it meets all of the following conditions:  the password length is at least 5 characters;  the password contains at least one large English letter;  the password contains at least one small English letter;  the password contains at least one digit. You are given a password. Please implement the automatic check of its complexity for company Q." 800
409I "Feed the Golorp" "*special problem" "Golorps are mysterious creatures who feed on variables. Golorp\'s name is a program in some programming language. Some scientists believe that this language is Befunge; golorps are tantalizingly silent.Variables consumed by golorps can take values from 0 to 9, inclusive. For each golorp its daily diet is defined by its name. Some golorps are so picky that they can\'t be fed at all. Besides, all golorps are very health-conscious and try to eat as little as possible. Given a choice of several valid sequences of variable values, each golorp will choose lexicographically smallest one.For the purposes of this problem you can assume that a golorp consists of jaws and a stomach. The number of variables necessary to feed a golorp is defined by the shape of its jaws. Variables can get to the stomach only via the jaws.A hungry golorp is visiting you. You know its name; feed it or figure out that it\'s impossible." 2400
409H "A + B Strikes Back" "*special problem,brute force,constructive algorithms,dsu,implementation" "A + B is often used as an example of the easiest problem possible to show some contest platform. However, some scientists have observed that sometimes this problem is not so easy to get accepted. Want to try?" 1500
409G "On a plane" "*special problem,geometry" "InputThe first line contains a single integer n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891000) \xe2\x80\x94 the number of points on a plane.Each of the next n lines contains two real coordinates xi and yi of the  point, specified with exactly 2 fractional digits. All coordinates are between \xe2\x80\x89-\xe2\x80\x891000 and 1000, inclusive.OutputOutput a single real number \xce\xb8 \xe2\x80\x94 the answer to the problem statement. The absolute or relative error of your answer should be at most 10\xe2\x80\x89-\xe2\x80\x892.ExamplesInputCopy8-2.14 2.06-1.14 2.04-2.16 1.46-2.14 0.70-1.42 0.40-0.94 -0.48-1.42 -1.28-2.16 -1.62OutputCopy5.410InputCopy52.26 1.442.28 0.642.30 -0.301.58 0.663.24 0.66OutputCopy5.620InputCopy86.98 2.066.40 1.125.98 0.245.54 -0.607.16 0.307.82 1.248.34 0.248.74 -0.76OutputCopy5.480InputCopy510.44 2.0610.90 0.8011.48 -0.4812.06 0.7612.54 2.06OutputCopy6.040InputCopy816.94 2.4215.72 2.3814.82 1.5814.88 0.5015.76 -0.1616.86 -0.2017.00 0.8816.40 0.92OutputCopy6.040InputCopy720.62 3.0021.06 2.2821.56 1.3621.66 0.5621.64 -0.5222.14 2.3222.62 3.04OutputCopy6.720" 2200
409F 000001 "*special problem" "InputThe input contains a single integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8964).OutputOutput a single integer.ExamplesInputCopy2OutputCopy1InputCopy4OutputCopy2InputCopy27OutputCopy5InputCopy42OutputCopy6" 1900
409E Dome "*special problem"  1800
409D "Big Data" "*special problem" "Little Petya wanted to give an April Fools Day present to some scientists. After some hesitation he decided to give them the array that he got as a present in Codeforces Round #153 (Div.2). The scientists rejoiced at the gift and decided to put some important facts to this array. Here are the first few of the facts: The highest mountain above sea level in the world is Mount Everest. Its peak rises to 8848 m.  The largest board game tournament consisted of 958 participants playing chapaev. The largest online maths competition consisted of 12766 participants. The Nile is credited as the longest river in the world. From its farthest stream in Burundi, it extends 6695 km in length. While not in flood, the main stretches of the Amazon river in South America can reach widths of up to 1100 km at its widest points. Angel Falls is the highest waterfall. Its greatest single drop measures 807 m. The Hotel Everest View above Namche, Nepal \xe2\x80\x94 the village closest to Everest base camp \xe2\x80\x93 is at a record height of 31962 m Uranium is the heaviest of all the naturally occurring elements. Its most common isotope has a nucleus containing 146 neutrons. The coldest permanently inhabited place is the Siberian village of Oymyakon, where the temperature of -68\xc2\xb0C was registered in the twentieth century. The longest snake held in captivity is over 25 feet long. Its name is Medusa. Colonel Meow holds the world record for longest fur on a cat \xe2\x80\x94 almost 134 centimeters. Sea otters can have up to 10000 hairs per square inch. This is the most dense fur in the animal kingdom. The largest state of USA is Alaska; its area is 663268 square miles Alaska has a longer coastline than all of the other 49 U.S. States put together: it is 154103 miles long. Lake Baikal is the largest freshwater lake in the world. It reaches 1642 meters in depth and contains around one-fifth of the world\xe2\x80\x99s unfrozen fresh water. The most colorful national flag is the one of Turkmenistan, with 106 colors." 1700
409C "Magnum Opus" "*special problem" "Salve, mi amice.Et tu quidem de lapis philosophorum. Barba non facit philosophum. Labor omnia vincit. Non potest creatio ex nihilo. Necesse est partibus.Rp:    I Aqua Fortis    I Aqua Regia    II Amalgama    VII Minium    IV VitriolMisce in vitro et \xc3\xa6stus, et nil admirari. Festina lente, et nulla tenaci invia est via.Fac et spera,Vale,Nicolas Flamel" 1700
409B "Mysterious Language" "*special problem" "You are given a mysterious language (codenamed ""Secret"") available in ""Custom Invocation"" tab. Figure out what this language is and write a program which prints its name. Note that the program must be written in this language." 1700
409A "The Great Game" "*special problem" "Two teams meet in The Game World Championship. Some scientists consider this game to be the most intellectually challenging game in the world. You are given two strings describing the teams\' actions in the final battle. Figure out who became the champion." 1700
408B Garland implementation "Once little Vasya read an article in a magazine on how to make beautiful handmade garland from colored paper. Vasya immediately went to the store and bought n colored sheets of paper, the area of each sheet is 1 square meter.The garland must consist of exactly m pieces of colored paper of arbitrary area, each piece should be of a certain color. To make the garland, Vasya can arbitrarily cut his existing colored sheets into pieces. Vasya is not obliged to use all the sheets to make the garland.Vasya wants the garland to be as attractive as possible, so he wants to maximize the total area of \xe2\x80\x8b\xe2\x80\x8bm pieces of paper in the garland. Calculate what the maximum total area of \xe2\x80\x8b\xe2\x80\x8bthe pieces of paper in the garland Vasya can get." 1200
408A "Line to Cashier" implementation "Little Vasya went to the supermarket to get some groceries. He walked about the supermarket for a long time and got a basket full of products. Now he needs to choose the cashier to pay for the products.There are n cashiers at the exit from the supermarket. At the moment the queue for the i-th cashier already has ki people. The j-th person standing in the queue to the i-th cashier has mi,\xe2\x80\x89j items in the basket. Vasya knows that:  the cashier needs 5 seconds to scan one item;  after the cashier scans each item of some customer, he needs 15 seconds to take the customer\'s money and give him the change. Of course, Vasya wants to select a queue so that he can leave the supermarket as soon as possible. Help him write a program that displays the minimum number of seconds after which Vasya can get to one of the cashiers." 900
407E k-d-sequence "data structures" "We\'ll call a sequence of integers a good k-d sequence if we can add to it at most k numbers in such a way that after the sorting the sequence will be an arithmetic progression with difference d.You got hold of some sequence a, consisting of n integers. Your task is to find its longest contiguous subsegment, such that it is a good k-d sequence." 3100
407D "Largest Submatrix 3" dp,hashing "You are given matrix a of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, its elements are integers. We will assume that the rows of the matrix are numbered from top to bottom from 1 to n, the columns are numbered from left to right from 1 to m. We will denote the element on the intersecting of the i-th row and the j-th column as aij.We\'ll call submatrix i1,\xe2\x80\x89j1,\xe2\x80\x89i2,\xe2\x80\x89j2 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) such elements aij of the given matrix that i1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i2 AND j1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j2. We\'ll call the area of the submatrix number (i2\xe2\x80\x89-\xe2\x80\x89i1\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(j2\xe2\x80\x89-\xe2\x80\x89j1\xe2\x80\x89+\xe2\x80\x891). We\'ll call a submatrix inhomogeneous, if all its elements are distinct.Find the largest (in area) inhomogenous submatrix of the given matrix." 2700
407C "Curious Array" "brute force,combinatorics,implementation,math" "You\'ve got an array consisting of n integers: a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n]. Moreover, there are m queries, each query can be described by three integers li,\xe2\x80\x89ri,\xe2\x80\x89ki. Query li,\xe2\x80\x89ri,\xe2\x80\x89ki means that we should add  to each element a[j], where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri.Record  means the binomial coefficient, or the number of combinations from y elements into groups of x elements.You need to fulfil consecutively all queries and then print the final array." 2500
407B "Long Path" dp,implementation "One day, little Vasya found himself in a maze consisting of (n\xe2\x80\x89+\xe2\x80\x891) rooms, numbered from 1 to (n\xe2\x80\x89+\xe2\x80\x891). Initially, Vasya is at the first room and to get out of the maze, he needs to get to the (n\xe2\x80\x89+\xe2\x80\x891)-th one.The maze is organized as follows. Each room of the maze has two one-way portals. Let\'s consider room number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), someone can use the first portal to move from it to room number (i\xe2\x80\x89+\xe2\x80\x891), also someone can use the second portal to move from it to room number pi, where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i.In order not to get lost, Vasya decided to act as follows.   Each time Vasya enters some room, he paints a cross on its ceiling. Initially, Vasya paints a cross at the ceiling of room 1.  Let\'s assume that Vasya is in room i and has already painted a cross on its ceiling. Then, if the ceiling now contains an odd number of crosses, Vasya uses the second portal (it leads to room pi), otherwise Vasya uses the first portal. Help Vasya determine the number of times he needs to use portals to get to room (n\xe2\x80\x89+\xe2\x80\x891) in the end." 1600
407A Triangle "brute force,geometry,implementation,math" "There is a right triangle with legs of length a and b. Your task is to determine whether it is possible to locate the triangle on the plane in such a way that none of its sides is parallel to the coordinate axes. All the vertices must have integer coordinates. If there exists such a location, you have to output the appropriate coordinates of vertices." 1600
406E "Hamming Triples" "implementation,math,two pointers" "Little Chris is having a nightmare. Even in dreams all he thinks about is math.Chris dreams about m binary strings of length n, indexed with numbers from 1 to m. The most horrifying part is that the bits of each string are ordered in either ascending or descending order. For example, Chris could be dreaming about the following 4 strings of length 5:  The Hamming distance H(a,\xe2\x80\x89b) between two strings a and b of length n is the number of positions at which the corresponding symbols are different. \xd0\xa1hris thinks that each three strings with different indices constitute a single triple. Chris\'s delusion is that he will wake up only if he counts the number of such string triples a, b, c that the sum H(a,\xe2\x80\x89b)\xe2\x80\x89+\xe2\x80\x89H(b,\xe2\x80\x89c)\xe2\x80\x89+\xe2\x80\x89H(c,\xe2\x80\x89a) is maximal among all the string triples constructed from the dreamed strings.Help Chris wake up from this nightmare!" 2800
406D "Hill Climbing" "dfs and similar,geometry,trees" "This problem has nothing to do with Little Chris. It is about hill climbers instead (and Chris definitely isn\'t one).There are n hills arranged on a line, each in the form of a vertical line segment with one endpoint on the ground. The hills are numbered with numbers from 1 to n from left to right. The i-th hill stands at position xi with its top at height yi. For every two hills a and b, if the top of hill a can be seen from the top of hill b, their tops are connected by a rope. Formally, the tops of two hills are connected if the segment connecting their top points does not intersect or touch any of the other hill segments. Using these ropes, the hill climbers can move from hill to hill.There are m teams of climbers, each composed of exactly two members. The first and the second climbers of the i-th team are located at the top of the ai-th and bi-th hills, respectively. They want to meet together at the top of some hill. Now, each of two climbers move according to the following process:  if a climber is at the top of the hill where the other climber is already located or will come eventually, the former climber stays at this hill;  otherwise, the climber picks a hill to the right of his current hill that is reachable by a rope and is the rightmost possible, climbs this hill and continues the process (the climber can also climb a hill whose top is lower than the top of his current hill).   For each team of climbers, determine the number of the meeting hill for this pair!" 2200
405E "Graph Cutting" "dfs and similar,graphs" "Little Chris is participating in a graph cutting contest. He\'s a pro. The time has come to test his skills to the fullest.Chris is given a simple undirected connected graph with n vertices (numbered from 1 to n) and m edges. The problem is to cut it into edge-distinct paths of length 2. Formally, Chris has to partition all edges of the graph into pairs in such a way that the edges in a single pair are adjacent and each edge must be contained in exactly one pair.For example, the figure shows a way Chris can cut a graph. The first sample test contains the description of this graph.  You are given a chance to compete with Chris. Find a way to cut the given graph or determine that it is impossible!" 2300
405D "Toy Sum" greedy,implementation,math "Little Chris is very keen on his toy blocks. His teacher, however, wants Chris to solve more problems, so he decided to play a trick on Chris.There are exactly s blocks in Chris\'s set, each block has a unique number from 1 to s. Chris\'s teacher picks a subset of blocks X and keeps it to himself. He will give them back only if Chris can pick such a non-empty subset Y from the remaining blocks, that the equality holds:  ""Are you kidding me?"", asks Chris.For example, consider a case where s\xe2\x80\x89=\xe2\x80\x898 and Chris\'s teacher took the blocks with numbers 1, 4 and 5. One way for Chris to choose a set is to pick the blocks with numbers 3 and 6, see figure. Then the required sums would be equal: (1\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89(4\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89(5\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89(8\xe2\x80\x89-\xe2\x80\x893)\xe2\x80\x89+\xe2\x80\x89(8\xe2\x80\x89-\xe2\x80\x896)\xe2\x80\x89=\xe2\x80\x897.  However, now Chris has exactly s\xe2\x80\x89=\xe2\x80\x89106 blocks. Given the set X of blocks his teacher chooses, help Chris to find the required set Y!" 1700
405C "Unusual Product" implementation,math "Little Chris is a huge fan of linear algebra. This time he has been given a homework about the unusual square of a square matrix.The dot product of two integer number vectors x and y of size n is the sum of the products of the corresponding components of the vectors. The unusual square of an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix A is defined as the sum of n dot products. The i-th of them is the dot product of the i-th row vector and the i-th column vector in the matrix A.Fortunately for Chris, he has to work only in GF(2)! This means that all operations (addition, multiplication) are calculated modulo 2. In fact, the matrix A is binary: each element of A is either 0 or 1. For example, consider the following matrix A:  The unusual square of A is equal to (1\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb70\xe2\x80\x89+\xe2\x80\x891\xc2\xb71)\xe2\x80\x89+\xe2\x80\x89(0\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb71\xe2\x80\x89+\xe2\x80\x891\xc2\xb70)\xe2\x80\x89+\xe2\x80\x89(1\xc2\xb71\xe2\x80\x89+\xe2\x80\x890\xc2\xb71\xe2\x80\x89+\xe2\x80\x890\xc2\xb70)\xe2\x80\x89=\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x890.However, there is much more to the homework. Chris has to process q queries; each query can be one of the following:   given a row index i, flip all the values in the i-th row in A;  given a column index i, flip all the values in the i-th column in A;  find the unusual square of A. To flip a bit value w means to change it to 1\xe2\x80\x89-\xe2\x80\x89w, i.e., 1 changes to 0 and 0 changes to 1.Given the initial matrix A, output the answers for each query of the third type! Can you solve Chris\'s homework?" 1600
405B "Domino Effect" NA "Little Chris knows there\'s no fun in playing dominoes, he thinks it\'s too random and doesn\'t require skill. Instead, he decided to play with the dominoes and make a ""domino show"".Chris arranges n dominoes in a line, placing each piece vertically upright. In the beginning, he simultaneously pushes some of the dominoes either to the left or to the right. However, somewhere between every two dominoes pushed in the same direction there is at least one domino pushed in the opposite direction.After each second, each domino that is falling to the left pushes the adjacent domino on the left. Similarly, the dominoes falling to the right push their adjacent dominoes standing on the right. When a vertical domino has dominoes falling on it from both sides, it stays still due to the balance of the forces. The figure shows one possible example of the process.  Given the initial directions Chris has pushed the dominoes, find the number of the dominoes left standing vertically at the end of the process!" 1100
405A "Gravity Flip" greedy,implementation,sortings "Little Chris is bored during his physics lessons (too easy), so he has built a toy box to keep himself occupied. The box is special, since it has the ability to change gravity.There are n columns of toy cubes in the box arranged in a line. The i-th column contains ai cubes. At first, the gravity in the box is pulling the cubes downwards. When Chris switches the gravity, it begins to pull all the cubes to the right side of the box. The figure shows the initial and final configurations of the cubes in the box: the cubes that have changed their position are highlighted with orange.  Given the initial configuration of the toy cubes in the box, find the amounts of cubes in each of the n columns after the gravity switch!" 900
404E "Maze 1D" "binary search,greedy,implementation" "Valera has a strip infinite in both directions and consisting of cells. The cells are numbered by integers. The cell number 0 has a robot.The robot has instructions \xe2\x80\x94 the sequence of moves that he must perform. In one move, the robot moves one cell to the left or one cell to the right, according to instructions. Before the robot starts moving, Valera puts obstacles in some cells of the strip, excluding cell number 0. If the robot should go into the cell with an obstacle according the instructions, it will skip this move.Also Valera indicates the finish cell in which the robot has to be after completing the entire instructions. The finishing cell should be different from the starting one. It is believed that the robot completed the instructions successfully, if during the process of moving he visited the finish cell exactly once \xe2\x80\x94 at its last move. Moreover, the latter move cannot be skipped.Let\'s assume that k is the minimum number of obstacles that Valera must put to make the robot able to complete the entire sequence of instructions successfully and end up in some finishing cell. You need to calculate in how many ways Valera can choose k obstacles and the finishing cell so that the robot is able to complete the instructions successfully." 2200
404D "Minesweeper 1D" dp,implementation "Game ""Minesweeper 1D"" is played on a line of squares, the line\'s height is 1 square, the line\'s width is n squares. Some of the squares contain bombs. If a square doesn\'t contain a bomb, then it contains a number from 0 to 2 \xe2\x80\x94 the total number of bombs in adjacent squares.For example, the correct field to play looks like that: 001*2***101*. The cells that are marked with ""*"" contain bombs. Note that on the correct field the numbers represent the number of bombs in adjacent cells. For example, field 2* is not correct, because cell with value 2 must have two adjacent cells with bombs.Valera wants to make a correct field to play ""Minesweeper 1D"". He has already painted a squared field with width of n cells, put several bombs on the field and wrote numbers into some cells. Now he wonders how many ways to fill the remaining cells with bombs and numbers are there if we should get a correct field in the end." 1900
404C "Restore Graph" "dfs and similar,graphs,sortings" "Valera had an undirected connected graph without self-loops and multiple edges consisting of n vertices. The graph had an interesting property: there were at most k edges adjacent to each of its vertices. For convenience, we will assume that the graph vertices were indexed by integers from 1 to n.One day Valera counted the shortest distances from one of the graph vertices to all other ones and wrote them out in array d. Thus, element d[i] of the array shows the shortest distance from the vertex Valera chose to vertex number i.Then something irreparable terrible happened. Valera lost the initial graph. However, he still has the array d. Help him restore the lost graph." 1800
404B Marathon implementation,math "Valera takes part in the Berland Marathon. The marathon race starts at the stadium that can be represented on the plane as a square whose lower left corner is located at point with coordinates (0,\xe2\x80\x890) and the length of the side equals a meters. The sides of the square are parallel to coordinate axes.As the length of the marathon race is very long, Valera needs to have extra drink during the race. The coach gives Valera a bottle of drink each d meters of the path. We know that Valera starts at the point with coordinates (0,\xe2\x80\x890) and runs counter-clockwise. That is, when Valera covers a meters, he reaches the point with coordinates (a,\xe2\x80\x890). We also know that the length of the marathon race equals nd\xe2\x80\x89+\xe2\x80\x890.5 meters. Help Valera\'s coach determine where he should be located to help Valera. Specifically, determine the coordinates of Valera\'s positions when he covers d,\xe2\x80\x892\xc2\xb7d,\xe2\x80\x89...,\xe2\x80\x89n\xc2\xb7d meters." 1500
404A "Valera and X" implementation "Valera is a little boy. Yesterday he got a huge Math hometask at school, so Valera didn\'t have enough time to properly learn the English alphabet for his English lesson. Unfortunately, the English teacher decided to have a test on alphabet today. At the test Valera got a square piece of squared paper. The length of the side equals n squares (n is an odd number) and each unit square contains some small letter of the English alphabet.Valera needs to know if the letters written on the square piece of paper form letter ""X"". Valera\'s teacher thinks that the letters on the piece of paper form an ""X"", if:  on both diagonals of the square paper all letters are the same;  all other squares of the paper (they are not on the diagonals) contain the same letter that is different from the letters on the diagonals. Help Valera, write the program that completes the described task for him." 1000
403E "Two Rooted Trees" "data structures,implementation,trees" "You have two rooted undirected trees, each contains n vertices. Let\'s number the vertices of each tree with integers from 1 to n. The root of each tree is at vertex 1. The edges of the first tree are painted blue, the edges of the second one are painted red. For simplicity, let\'s say that the first tree is blue and the second tree is red.Edge {x,\xe2\x80\x89y} is called bad for edge {p,\xe2\x80\x89q} if two conditions are fulfilled:   The color of edge {x,\xe2\x80\x89y} is different from the color of edge {p,\xe2\x80\x89q}.  Let\'s consider the tree of the same color that edge {p,\xe2\x80\x89q} is. Exactly one of vertices x, y lies both in the subtree of vertex p and in the subtree of vertex q. In this problem, your task is to simulate the process described below. The process consists of several stages:  On each stage edges of exactly one color are deleted.  On the first stage, exactly one blue edge is deleted.  Let\'s assume that at the stage i we\'ve deleted edges {u1,\xe2\x80\x89v1}, {u2,\xe2\x80\x89v2}, ..., {uk,\xe2\x80\x89vk}. At the stage i\xe2\x80\x89+\xe2\x80\x891 we will delete all undeleted bad edges for edge {u1,\xe2\x80\x89v1}, then we will delete all undeleted bad edges for edge {u2,\xe2\x80\x89v2} and so on until we reach edge {uk,\xe2\x80\x89vk}.  For each stage of deleting edges determine what edges will be removed on the stage. Note that the definition of a bad edge always considers the initial tree before it had any edges removed." 2900
403D "Beautiful Pairs of Numbers" combinatorics,dp "The sequence of integer pairs (a1,\xe2\x80\x89b1),\xe2\x80\x89(a2,\xe2\x80\x89b2),\xe2\x80\x89...,\xe2\x80\x89(ak,\xe2\x80\x89bk) is beautiful, if the following statements are fulfilled:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ak\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, where n is a given positive integer;  all numbers b1\xe2\x80\x89-\xe2\x80\x89a1, b2\xe2\x80\x89-\xe2\x80\x89a2, ..., bk\xe2\x80\x89-\xe2\x80\x89ak are distinct. For the given number n find the number of beautiful sequences of length k. As the answer can be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2300
402E "Strictly Positive Matrix" graphs,math "You have matrix a of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Let\'s number the rows of the matrix from 1 to n from top to bottom, let\'s number the columns from 1 to n from left to right. Let\'s use aij to represent the element on the intersection of the i-th row and the j-th column. Matrix a meets the following two conditions:   for any numbers i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the following inequality holds: aij\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890;  . Matrix b is strictly positive, if for any numbers i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the inequality bij\xe2\x80\x89>\xe2\x80\x890 holds. You task is to determine if there is such integer k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891, that matrix ak is strictly positive." 2200
402D "Upgrading Array" "dp,greedy,math,number theory" "You have an array of positive integers a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[n] and a set of bad prime numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. The prime numbers that do not occur in the set b are considered good. The beauty of array a is the sum , where function f(s) is determined as follows:  f(1)\xe2\x80\x89=\xe2\x80\x890;  Let\'s assume that p is the minimum prime divisor of s. If p is a good prime, then , otherwise . You are allowed to perform an arbitrary (probably zero) number of operations to improve array a. The operation of improvement is the following sequence of actions:  Choose some number r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and calculate the value g = GCD(a[1],\xe2\x80\x89a[2],\xe2\x80\x89...,\xe2\x80\x89a[r]).  Apply the assignments: , , ..., . What is the maximum beauty of the array you can get?" 1800
402C "Searching for Graph" "brute force,constructive algorithms,graphs" "Let\'s call an undirected graph of n vertices p-interesting, if the following conditions fulfill:   the graph contains exactly 2n\xe2\x80\x89+\xe2\x80\x89p edges;  the graph doesn\'t contain self-loops and multiple edges;  for any integer k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), any subgraph consisting of k vertices contains at most 2k\xe2\x80\x89+\xe2\x80\x89p edges. A subgraph of a graph is some set of the graph vertices and some set of the graph edges. At that, the set of edges must meet the condition: both ends of each edge from the set must belong to the chosen set of vertices. Your task is to find a p-interesting graph consisting of n vertices." 1500
402B "Trees in a Row" "brute force,implementation" "The Queen of England has n trees growing in a row in her garden. At that, the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) tree from the left has height ai meters. Today the Queen decided to update the scenery of her garden. She wants the trees\' heights to meet the condition: for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89=\xe2\x80\x89k, where k is the number the Queen chose.Unfortunately, the royal gardener is not a machine and he cannot fulfill the desire of the Queen instantly! In one minute, the gardener can either decrease the height of a tree to any positive integer height or increase the height of a tree to any positive integer height. How should the royal gardener act to fulfill a whim of Her Majesty in the minimum number of minutes?" 1400
402A Nuts greedy,math "You have a nuts and lots of boxes. The boxes have a wonderful feature: if you put x (x\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) divisors (the spacial bars that can divide a box) to it, you get a box, divided into x\xe2\x80\x89+\xe2\x80\x891 sections.You are minimalist. Therefore, on the one hand, you are against dividing some box into more than k sections. On the other hand, you are against putting more than v nuts into some section of the box. What is the minimum number of boxes you have to use if you want to put all the nuts in boxes, and you have b divisors?Please note that you need to minimize the number of used boxes, not sections. You do not have to minimize the number of used divisors." 1100
401E "Olympic Games" math "This problem was deleted from the contest, because it was used previously at another competition." 2500
401D "Roman and Numbers" "bitmasks,brute force,combinatorics,dp,number theory" "Roman is a young mathematician, very famous in Uzhland. Unfortunately, Sereja doesn\'t think so. To make Sereja change his mind, Roman is ready to solve any mathematical problem. After some thought, Sereja asked Roma to find, how many numbers are close to number n, modulo m.Number x is considered close to number n modulo m, if:  it can be obtained by rearranging the digits of number n,  it doesn\'t have any leading zeroes,  the remainder after dividing number x by m equals 0. Roman is a good mathematician, but the number of such numbers is too huge for him. So he asks you to help him." 2000
401C Team "constructive algorithms,greedy,implementation" "Now it\'s time of Olympiads. Vanya and Egor decided to make his own team to take part in a programming Olympiad. They\'ve been best friends ever since primary school and hopefully, that can somehow help them in teamwork.For each team Olympiad, Vanya takes his play cards with numbers. He takes only the cards containing numbers 1 and 0. The boys are very superstitious. They think that they can do well at the Olympiad if they begin with laying all the cards in a row so that:  there wouldn\'t be a pair of any side-adjacent cards with zeroes in a row;  there wouldn\'t be a group of three consecutive cards containing numbers one. Today Vanya brought n cards with zeroes and m cards with numbers one. The number of cards was so much that the friends do not know how to put all those cards in the described way. Help them find the required arrangement of the cards or else tell the guys that it is impossible to arrange cards in such a way." 1400
401B "Sereja and Contests" greedy,implementation,math "Sereja is a coder and he likes to take part in Codesorfes rounds. However, Uzhland doesn\'t have good internet connection, so Sereja sometimes skips rounds.Codesorfes has rounds of two types: Div1 (for advanced coders) and Div2 (for beginner coders). Two rounds, Div1 and Div2, can go simultaneously, (Div1 round cannot be held without Div2) in all other cases the rounds don\'t overlap in time. Each round has a unique identifier \xe2\x80\x94 a positive integer. The rounds are sequentially (without gaps) numbered with identifiers by the starting time of the round. The identifiers of rounds that are run simultaneously are different by one, also the identifier of the Div1 round is always greater.Sereja is a beginner coder, so he can take part only in rounds of Div2 type. At the moment he is taking part in a Div2 round, its identifier equals to x. Sereja remembers very well that he has taken part in exactly k rounds before this round. Also, he remembers all identifiers of the rounds he has taken part in and all identifiers of the rounds that went simultaneously with them. Sereja doesn\'t remember anything about the rounds he missed.Sereja is wondering: what minimum and what maximum number of Div2 rounds could he have missed? Help him find these two numbers." 1200
401A "Vanya and Cards" implementation,math "Vanya loves playing. He even has a special set of cards to play with. Each card has a single integer. The number on the card can be positive, negative and can even be equal to zero. The only limit is, the number on each card doesn\'t exceed x in the absolute value.Natasha doesn\'t like when Vanya spends a long time playing, so she hid all of his cards. Vanya became sad and started looking for the cards but he only found n of them. Vanya loves the balance, so he wants the sum of all numbers on found cards equal to zero. On the other hand, he got very tired of looking for cards. Help the boy and say what is the minimum number of cards does he need to find to make the sum equal to zero?You can assume that initially Vanya had infinitely many cards with each integer number from \xe2\x80\x89-\xe2\x80\x89x to x." 800
400E "Inna and Binary Logic" "binary search,bitmasks,data structures" "Inna is fed up with jokes about female logic. So she started using binary logic instead.Inna has an array of n elements a1[1],\xe2\x80\x89a1[2],\xe2\x80\x89...,\xe2\x80\x89a1[n]. Girl likes to train in her binary logic, so she does an exercise consisting of n stages: on the first stage Inna writes out all numbers from array a1, on the i-th (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) stage girl writes all elements of array ai, which consists of n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891 integers; the k-th integer of array ai is defined as follows: ai[k]\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891[k] AND ai\xe2\x80\x89-\xe2\x80\x891[k\xe2\x80\x89+\xe2\x80\x891]. Here AND is bit-wise binary logical operation.Dima decided to check Inna\'s skill. He asks Inna to change array, perform the exercise and say the sum of all  elements she wrote out during the current exercise.Help Inna to answer the questions!" 2100
400D "Dima and Bacteria" "dsu,graphs,shortest paths" "Dima took up the biology of bacteria, as a result of his experiments, he invented k types of bacteria. Overall, there are n bacteria at his laboratory right now, and the number of bacteria of type i equals ci. For convenience, we will assume that all the bacteria are numbered from 1 to n. The bacteria of type ci are numbered from  to .With the help of special equipment Dima can move energy from some bacteria into some other one. Of course, the use of such equipment is not free. Dima knows m ways to move energy from some bacteria to another one. The way with number i can be described with integers ui, vi and xi mean that this way allows moving energy from bacteria with number ui to bacteria with number vi or vice versa for xi dollars.Dima\'s Chef (Inna) calls the type-distribution correct if there is a way (may be non-direct) to move energy from any bacteria of the particular type to any other bacteria of the same type (between any two bacteria of the same type) for zero cost.As for correct type-distribution the cost of moving the energy depends only on the types of bacteria help Inna to determine is the type-distribution correct? If it is, print the matrix d with size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k. Cell d[i][j] of this matrix must be equal to the minimal possible cost of energy-moving from bacteria with type i to bacteria with type j." 2000
400C "Inna and Huge Candy Matrix" implementation,math "Inna and Dima decided to surprise Sereja. They brought a really huge candy matrix, it\'s big even for Sereja! Let\'s number the rows of the giant matrix from 1 to n from top to bottom and the columns \xe2\x80\x94 from 1 to m, from left to right. We\'ll represent the cell on the intersection of the i-th row and j-th column as (i,\xe2\x80\x89j). Just as is expected, some cells of the giant candy matrix contain candies. Overall the matrix has p candies: the k-th candy is at cell (xk,\xe2\x80\x89yk).The time moved closer to dinner and Inna was already going to eat p of her favourite sweets from the matrix, when suddenly Sereja (for the reason he didn\'t share with anyone) rotated the matrix x times clockwise by 90 degrees. Then he performed the horizontal rotate of the matrix y times. And then he rotated the matrix z times counterclockwise by 90 degrees. The figure below shows how the rotates of the matrix looks like.  Inna got really upset, but Duma suddenly understood two things: the candies didn\'t get damaged and he remembered which cells contained Inna\'s favourite sweets before Sereja\'s strange actions. Help guys to find the new coordinates in the candy matrix after the transformation Sereja made!" 1500
400B "Inna and New Matrix of Candies" "brute force,implementation,schedules" "Inna likes sweets and a game called the ""Candy Matrix"". Today, she came up with the new game ""Candy Matrix 2: Reload"".The field for the new game is a rectangle table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each line of the table contains one cell with a dwarf figurine, one cell with a candy, the other cells of the line are empty. The game lasts for several moves. During each move the player should choose all lines of the matrix where dwarf is not on the cell with candy and shout ""Let\'s go!"". After that, all the dwarves from the chosen lines start to simultaneously move to the right. During each second, each dwarf goes to the adjacent cell that is located to the right of its current cell. The movement continues until one of the following events occurs:  some dwarf in one of the chosen lines is located in the rightmost cell of his row;  some dwarf in the chosen lines is located in the cell with the candy. The point of the game is to transport all the dwarves to the candy cells.Inna is fabulous, as she came up with such an interesting game. But what about you? Your task is to play this game optimally well. Specifically, you should say by the given game field what minimum number of moves the player needs to reach the goal of the game." 1200
400A "Inna and Choose Options" implementation "There always is something to choose from! And now, instead of ""Noughts and Crosses"", Inna choose a very unusual upgrade of this game. The rules of the game are given below:There is one person playing the game. Before the beginning of the game he puts 12 cards in a row on the table. Each card contains a character: ""X"" or ""O"". Then the player chooses two positive integers a and b (a\xc2\xb7b\xe2\x80\x89=\xe2\x80\x8912), after that he makes a table of size a\xe2\x80\x89\xc3\x97\xe2\x80\x89b from the cards he put on the table as follows: the first b cards form the first row of the table, the second b cards form the second row of the table and so on, the last b cards form the last (number a) row of the table. The player wins if some column of the table contain characters ""X"" on all cards. Otherwise, the player loses.Inna has already put 12 cards on the table in a row. But unfortunately, she doesn\'t know what numbers a and b to choose. Help her win the game: print to her all the possible ways of numbers a,\xe2\x80\x89b that she can choose and win." 1000
399B "Red and Blue Balls" NA "User ainta has a stack of n red and blue balls. He can apply a certain operation which changes the colors of the balls inside the stack.  While the top ball inside the stack is red, pop the ball from the top of the stack.  Then replace the blue ball on the top with a red ball.  And finally push some blue balls to the stack until the stack has total of n balls inside.   If there are no blue balls inside the stack, ainta can\'t apply this operation. Given the initial state of the stack, ainta wants to know the maximum number of operations he can repeatedly apply." -999
399A Pages implementation "User ainta is making a web site. This time he is going to make a navigation of the pages. In his site, there are n pages numbered by integers from 1 to n. Assume that somebody is on the p-th page now. The navigation will look like this: << p\xe2\x80\x89-\xe2\x80\x89k p\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 ... p\xe2\x80\x89-\xe2\x80\x891 (p) p\xe2\x80\x89+\xe2\x80\x891 ... p\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891 p\xe2\x80\x89+\xe2\x80\x89k >> When someone clicks the button ""<<"" he is redirected to page 1, and when someone clicks the button "">>"" he is redirected to page n. Of course if someone clicks on a number, he is redirected to the corresponding page.There are some conditions in the navigation:  If page 1 is in the navigation, the button ""<<"" must not be printed.  If page n is in the navigation, the button "">>"" must not be printed.  If the page number is smaller than 1 or greater than n, it must not be printed.   You can see some examples of the navigations. Make a program that prints the navigation." -999
398E "Sorting Permutations" NA "We are given a permutation sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of numbers from 1 to n. Let\'s assume that in one second, we can choose some disjoint pairs (u1,\xe2\x80\x89v1),\xe2\x80\x89(u2,\xe2\x80\x89v2),\xe2\x80\x89...,\xe2\x80\x89(uk,\xe2\x80\x89vk) and swap all aui and avi for every i at the same time (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ui\xe2\x80\x89<\xe2\x80\x89vi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The pairs are disjoint if every ui and vj are different from each other.We want to sort the sequence completely in increasing order as fast as possible. Given the initial permutation, calculate the number of ways to achieve this. Two ways are different if and only if there is a time t, such that the set of pairs used for swapping at that time are different as sets (so ordering of pairs doesn\'t matter). If the given permutation is already sorted, it takes no time to sort, so the number of ways to sort it is 1.To make the problem more interesting, we have k holes inside the permutation. So exactly k numbers of a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an are not yet determined. For every possibility of filling the holes, calculate the number of ways, and print the total sum of these values modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." -999
398D "Instant Messanger" "data structures" "User ainta decided to make a new instant messenger called ""aintalk"". With aintalk, each user can chat with other people. User ainta made the prototype of some functions to implement this thing.  login(u): User u logins into aintalk and becomes online.  logout(u): User u logouts and becomes offline.  add_friend(u, v): User u and user v become friends. It means, u and v can talk with each other. The friendship is bidirectional.  del_friend(u, v): Unfriend user u and user v. It means, u and v cannot talk with each other from then.  count_online_friends(u): The function returns the number of friends of user u who are online at the moment.   Because the messenger is being tested by some users numbered from 1 to n, there is no register method. This means, at the beginning, some users may be online, and some users may have friends.User ainta is going to make these functions, but before making the messenger public, he wants to know whether he is correct. Help ainta verify his code." -999
398C "Tree and Array" "constructive algorithms" "User ainta likes trees. This time he is going to make an undirected tree with n vertices numbered by integers from 1 to n. The tree is weighted, so each edge of the tree will have some integer weight.Also he has an array t: t[1],\xe2\x80\x89t[2],\xe2\x80\x89...,\xe2\x80\x89t[n]. At first all the elements of the array are initialized to 0. Then for each edge connecting vertices u and v (u\xe2\x80\x89<\xe2\x80\x89v) of the tree with weight c, ainta adds value c to the elements t[u],\xe2\x80\x89t[u\xe2\x80\x89+\xe2\x80\x891],\xe2\x80\x89...,\xe2\x80\x89t[v\xe2\x80\x89-\xe2\x80\x891],\xe2\x80\x89t[v] of array t.Let\'s assume that d(u,\xe2\x80\x89v) is the total weight of edges on the shortest path between vertex u and vertex v. User ainta calls a pair of integers x,\xe2\x80\x89y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) good if and only if d(x,\xe2\x80\x89y)\xe2\x80\x89=\xe2\x80\x89t[x]\xe2\x80\x89+\xe2\x80\x89t[x\xe2\x80\x89+\xe2\x80\x891]\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89t[y\xe2\x80\x89-\xe2\x80\x891]\xe2\x80\x89+\xe2\x80\x89t[y].User ainta wants to make at least  good pairs, but he couldn\'t make a proper tree. Help ainta to find such a tree." -999
398B "Painting The Wall" dp,probabilities "User ainta decided to paint a wall. The wall consists of n2 tiles, that are arranged in an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table. Some tiles are painted, and the others are not. As he wants to paint it beautifully, he will follow the rules below.  Firstly user ainta looks at the wall. If there is at least one painted cell on each row and at least one painted cell on each column, he stops coloring. Otherwise, he goes to step 2.  User ainta choose any tile on the wall with uniform probability.  If the tile he has chosen is not painted, he paints the tile. Otherwise, he ignores it.  Then he takes a rest for one minute even if he doesn\'t paint the tile. And then ainta goes to step 1.   However ainta is worried if it would take too much time to finish this work. So he wants to calculate the expected time needed to paint the wall by the method above. Help him find the expected time. You can assume that choosing and painting any tile consumes no time at all." -999
398A Cards "constructive algorithms,implementation" "User ainta loves to play with cards. He has a cards containing letter ""o"" and b cards containing letter ""x"". He arranges the cards in a row, and calculates the score of the deck by the formula below.  At first, the score is 0.  For each block of contiguous ""o""s with length x the score increases by x2.  For each block of contiguous ""x""s with length y the score decreases by y2.   For example, if a\xe2\x80\x89=\xe2\x80\x896,\xe2\x80\x89b\xe2\x80\x89=\xe2\x80\x893 and ainta have arranged the cards in the order, that is described by string ""ooxoooxxo"", the score of the deck equals 22\xe2\x80\x89-\xe2\x80\x8912\xe2\x80\x89+\xe2\x80\x8932\xe2\x80\x89-\xe2\x80\x8922\xe2\x80\x89+\xe2\x80\x8912\xe2\x80\x89=\xe2\x80\x899. That is because the deck has 5 blocks in total: ""oo"", ""x"", ""ooo"", ""xx"", ""o"".User ainta likes big numbers, so he wants to maximize the score with the given cards. Help ainta make the score as big as possible. Note, that he has to arrange all his cards." -999
397B "On Corruption and Numbers" "constructive algorithms,implementation,math" "Alexey, a merry Berland entrant, got sick of the gray reality and he zealously wants to go to university. There are a lot of universities nowadays, so Alexey is getting lost in the diversity \xe2\x80\x94 he has not yet decided what profession he wants to get. At school, he had bad grades in all subjects, and it\'s only thanks to wealthy parents that he was able to obtain the graduation certificate.The situation is complicated by the fact that each high education institution has the determined amount of voluntary donations, paid by the new students for admission \xe2\x80\x94 ni berubleys. He cannot pay more than ni, because then the difference between the paid amount and ni can be regarded as a bribe!Each rector is wearing the distinctive uniform of his university. Therefore, the uniform\'s pockets cannot contain coins of denomination more than ri. The rector also does not carry coins of denomination less than li in his pocket \xe2\x80\x94 because if everyone pays him with so small coins, they gather a lot of weight and the pocket tears. Therefore, a donation can be paid only by coins of denomination x berubleys, where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri (Berland uses coins of any positive integer denomination). Alexey can use the coins of different denominations and he can use the coins of the same denomination any number of times. When Alexey was first confronted with such orders, he was puzzled because it turned out that not all universities can accept him! Alexey is very afraid of going into the army (even though he had long wanted to get the green uniform, but his dad says that the army bullies will beat his son and he cannot pay to ensure the boy\'s safety). So, Alexey wants to know for sure which universities he can enter so that he could quickly choose his alma mater.Thanks to the parents, Alexey is not limited in money and we can assume that he has an unlimited number of coins of each type.In other words, you are given t requests, each of them contains numbers ni,\xe2\x80\x89li,\xe2\x80\x89ri. For each query you need to answer, whether it is possible to gather the sum of exactly ni berubleys using only coins with an integer denomination from li to ri berubleys. You can use coins of different denominations. Coins of each denomination can be used any number of times." -999
397A "On Segment\'s Own Points" implementation "Our old friend Alexey has finally entered the University of City N \xe2\x80\x94 the Berland capital. Alexey expected his father to get him a place to live in but his father said it was high time for Alexey to practice some financial independence. So, Alexey is living in a dorm. The dorm has exactly one straight dryer \xe2\x80\x94 a 100 centimeter long rope to hang clothes on. The dryer has got a coordinate system installed: the leftmost end of the dryer has coordinate 0, and the opposite end has coordinate 100. Overall, the university has n students. Dean\'s office allows i-th student to use the segment (li,\xe2\x80\x89ri) of the dryer. However, the dean\'s office actions are contradictory and now one part of the dryer can belong to multiple students!Alexey don\'t like when someone touch his clothes. That\'s why he want make it impossible to someone clothes touch his ones. So Alexey wonders: what is the total length of the parts of the dryer that he may use in a such way that clothes of the others (n\xe2\x80\x89-\xe2\x80\x891) students aren\'t drying there. Help him! Note that Alexey, as the most respected student, has number 1." -999
396E "On Iteration of One Well-Known Function" math "Of course, many of you can calculate \xcf\x86(n) \xe2\x80\x94 the number of positive integers that are less than or equal to n, that are coprime with n. But what if we need to calculate \xcf\x86(\xcf\x86(...\xcf\x86(n))), where function \xcf\x86 is taken k times and n is given in the canonical decomposition into prime factors? You are given n and k, calculate the value of \xcf\x86(\xcf\x86(...\xcf\x86(n))). Print the result in the canonical decomposition into prime factors." -999
396D "On Sum of Number of Inversions in Permutations" combinatorics,math "You are given a permutation p. Calculate the total number of inversions in all permutations that lexicographically do not exceed the given one.As this number can be very large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." -999
396C "On Changing Tree" "data structures,graphs,trees" "You are given a rooted tree consisting of n vertices numbered from 1 to n. The root of the tree is a vertex number 1.Initially all vertices contain number 0. Then come q queries, each query has one of the two types:  The format of the query: 1 v x k. In response to the query, you need to add to the number at vertex v number x; to the numbers at the descendants of vertex v at distance 1, add x\xe2\x80\x89-\xe2\x80\x89k; and so on, to the numbers written in the descendants of vertex v at distance i, you need to add x\xe2\x80\x89-\xe2\x80\x89(i\xc2\xb7k). The distance between two vertices is the number of edges in the shortest path between these vertices.  The format of the query: 2 v. In reply to the query you should print the number written in vertex v modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Process the queries given in the input." -999
396B "On Sum of Fractions" "math,number theory" "Let\'s assume that   v(n) is the largest prime number, that does not exceed n; u(n) is the smallest prime number strictly greater than n. Find ." -999
396A "On Number of Decompositions into Multipliers" "combinatorics,math,number theory" "You are given an integer m as a product of integers a1,\xe2\x80\x89a2,\xe2\x80\x89... an . Your task is to find the number of distinct decompositions of number m into the product of n ordered positive integers.Decomposition into n products, given in the input, must also be considered in the answer. As the answer can be very large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." -999
394E "Lightbulb for Minister" geometry "The Minister for education is coming! Naturally, nobody wants to perform poorly in front of such a honored guest. However, two hours before the arrival it turned out that one of the classes has a malfunctioning lightbulb \xe2\x80\x94 for some reason it doesn\'t get enough energy. The solution was found quickly: all we\'ve got to do is to change the location of the lightbulb so that it got the maximum amount of energy.Everybody knows that the power of the lightbulb equals , where C is some constant value and ri is the Euclidean distance from the bulb to the i-th generator. Consequently, our task is to minimize . Of course, we know the positions of all generators.The bulb should be on the ceiling of the class. The ceiling of the class is in the form of a strictly convex m-gon (the class itself has the form of a right prism with a strictly convex m-gon at the bottom). Help to find the optimum location for the bulb. Assume that all generators are in the plane of the class ceiling. Consider that the plane of the class ceiling has some Cartesian coordinate system introduced." -999
394D "Physical Education and Buns" "brute force,implementation,math" "The Physical education teacher at SESC is a sort of mathematician too. His most favorite topic in mathematics is progressions. That is why the teacher wants the students lined up in non-decreasing height form an arithmetic progression.To achieve the goal, the gym teacher ordered a lot of magical buns from the dining room. The magic buns come in two types: when a student eats one magic bun of the first type, his height increases by one, when the student eats one magical bun of the second type, his height decreases by one. The physical education teacher, as expected, cares about the health of his students, so he does not want them to eat a lot of buns. More precisely, he wants the maximum number of buns eaten by some student to be minimum.Help the teacher, get the maximum number of buns that some pupils will have to eat to achieve the goal of the teacher. Also, get one of the possible ways for achieving the objective, namely, the height of the lowest student in the end and the step of the resulting progression." -999
394C Dominoes "constructive algorithms,greedy" "During the break, we decided to relax and play dominoes. Our box with Domino was empty, so we decided to borrow the teacher\'s dominoes.The teacher responded instantly at our request. He put nm dominoes on the table as an n\xe2\x80\x89\xc3\x97\xe2\x80\x892m rectangle so that each of the n rows contained m dominoes arranged horizontally. Each half of each domino contained number (0 or 1).We were taken aback, and the teacher smiled and said: ""Consider some arrangement of dominoes in an n\xe2\x80\x89\xc3\x97\xe2\x80\x892m matrix. Let\'s count for each column of the matrix the sum of numbers in this column. Then among all such sums find the maximum one. Can you rearrange the dominoes in the matrix in such a way that the maximum sum will be minimum possible? Note that it is prohibited to change the orientation of the dominoes, they all need to stay horizontal, nevertheless dominoes are allowed to rotate by 180 degrees. As a reward I will give you all my dominoes"".We got even more taken aback. And while we are wondering what was going on, help us make an optimal matrix of dominoes." -999
394B "Very Beautiful Number" math "Teacher thinks that we make a lot of progress. Now we are even allowed to use decimal notation instead of counting sticks. After the test the teacher promised to show us a ""very beautiful number"". But the problem is, he\'s left his paper with the number in the teachers\' office.The teacher remembers that the ""very beautiful number"" was strictly positive, didn\'t contain any leading zeroes, had the length of exactly p decimal digits, and if we move the last digit of the number to the beginning, it grows exactly x times. Besides, the teacher is sure that among all such numbers the ""very beautiful number"" is minimal possible.The teachers\' office isn\'t near and the teacher isn\'t young. But we\'ve passed the test and we deserved the right to see the ""very beautiful number"". Help to restore the justice, find the ""very beautiful number"" for us!" -999
394A "Counting Sticks" "brute force,implementation" "When new students come to the Specialized Educational and Scientific Centre (SESC) they need to start many things from the beginning. Sometimes the teachers say (not always unfairly) that we cannot even count. So our teachers decided to teach us arithmetics from the start. And what is the best way to teach students add and subtract? \xe2\x80\x94 That\'s right, using counting sticks! An here\'s our new task: An expression of counting sticks is an expression of type:[ A sticks][sign +][B sticks][sign =][C sticks] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89A,\xe2\x80\x89B,\xe2\x80\x89C).  Sign + consists of two crossed sticks: one vertical and one horizontal. Sign = consists of two horizontal sticks. The expression is arithmetically correct if A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89=\xe2\x80\x89C.We\'ve got an expression that looks like A\xe2\x80\x89+\xe2\x80\x89B\xe2\x80\x89=\xe2\x80\x89C given by counting sticks. Our task is to shift at most one stick (or we can shift nothing) so that the expression became arithmetically correct. Note that we cannot remove the sticks from the expression, also we cannot shift the sticks from the signs + and =.We really aren\'t fabulous at arithmetics. Can you help us?" -999
393B "Three matrices" NA "Chubby Yang is studying linear equations right now. He came up with a nice problem. In the problem you are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix W, consisting of integers, and you should find two n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrices A and B, all the following conditions must hold:   Aij\xe2\x80\x89=\xe2\x80\x89Aji, for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n);  Bij\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89Bji, for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n);  Wij\xe2\x80\x89=\xe2\x80\x89Aij\xe2\x80\x89+\xe2\x80\x89Bij, for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Can you solve the problem?" -999
393A Nineteen NA "Alice likes word ""nineteen"" very much. She has a string s and wants the string to contain as many such words as possible. For that reason she can rearrange the letters of the string.For example, if she has string ""xiineteenppnnnewtnee"", she can get string ""xnineteenppnineteenw"", containing (the occurrences marked) two such words. More formally, word ""nineteen"" occurs in the string the number of times you can read it starting from some letter of the string. Of course, you shouldn\'t skip letters.Help her to find the maximum number of ""nineteen""s that she can get in her string." -999
392E "Deleting Substrings" NA "SmallR likes a game called ""Deleting Substrings"". In the game you are given a sequence of integers w, you can modify the sequence and get points. The only type of modification you can perform is (unexpected, right?) deleting substrings. More formally, you can choose several contiguous elements of w and delete them from the sequence. Let\'s denote the sequence of chosen elements as wl,\xe2\x80\x89wl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89wr. They must meet the conditions:  the equality |wi\xe2\x80\x89-\xe2\x80\x89wi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89=\xe2\x80\x891 must hold for all i (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89r);  the inequality 2\xc2\xb7wi\xe2\x80\x89-\xe2\x80\x89wi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89wi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890 must hold for all i (l\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89r). After deleting the chosen substring of w, you gain vr\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 points. You can perform the described operation again and again while proper substrings exist. Also you can end the game at any time. Your task is to calculate the maximum total score you can get in the game." -999
392D "Three Arrays" "data structures" "There are three arrays a, b and c. Each of them consists of n integers. SmallY wants to find three integers u, v, w (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v,\xe2\x80\x89w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that the following condition holds: each number that appears in the union of a, b and c, appears either in the first u elements of a, or in the first v elements of b, or in the first w elements of c. Of course, SmallY doesn\'t want to have huge numbers u, v and w, so she wants sum u\xe2\x80\x89+\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x89w to be as small as possible.Please, help her to find the minimal possible sum of u\xe2\x80\x89+\xe2\x80\x89v\xe2\x80\x89+\xe2\x80\x89w." -999
392C "Yet Another Number Sequence" combinatorics,math,matrices "Everyone knows what the Fibonacci sequence is. This sequence can be defined by the recurrence relation: F1\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89F2\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89Fi\xe2\x80\x89=\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fi\xe2\x80\x89-\xe2\x80\x892 (i\xe2\x80\x89>\xe2\x80\x892).We\'ll define a new number sequence Ai(k) by the formula: Ai(k)\xe2\x80\x89=\xe2\x80\x89Fi\xe2\x80\x89\xc3\x97\xe2\x80\x89ik (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891).In this problem, your task is to calculate the following sum: A1(k)\xe2\x80\x89+\xe2\x80\x89A2(k)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89An(k). The answer can be very large, so print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." -999
392B "Tower of Hanoi" dp "The Tower of Hanoi is a well-known mathematical puzzle. It consists of three rods, and a number of disks of different sizes which can slide onto any rod. The puzzle starts with the disks in a neat stack in ascending order of size on one rod, the smallest at the top, thus making a conical shape.The objective of the puzzle is to move the entire stack to another rod, obeying the following simple rules:   Only one disk can be moved at a time.  Each move consists of taking the upper disk from one of the stacks and placing it on top of another stack i.e. a disk can only be moved if it is the uppermost disk on a stack.  No disk may be placed on top of a smaller disk. With three disks, the puzzle can be solved in seven moves. The minimum number of moves required to solve a Tower of Hanoi puzzle is 2n\xe2\x80\x89-\xe2\x80\x891, where n is the number of disks. (c) Wikipedia.SmallY\'s puzzle is very similar to the famous Tower of Hanoi. In the Tower of Hanoi puzzle you need to solve a puzzle in minimum number of moves, in SmallY\'s puzzle each move costs some money and you need to solve the same puzzle but for minimal cost. At the beginning of SmallY\'s puzzle all n disks are on the first rod. Moving a disk from rod i to rod j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893) costs tij units of money. The goal of the puzzle is to move all the disks to the third rod.In the problem you are given matrix t and an integer n. You need to count the minimal cost of solving SmallY\'s puzzle, consisting of n disks." -999
392A "Blocked Points" math "Imagine you have an infinite 2D plane with Cartesian coordinate system. Some of the integral points are blocked, and others are not. Two integral points A and B on the plane are 4-connected if and only if:  the Euclidean distance between A and B is one unit and neither A nor B is blocked;  or there is some integral point C, such that A is 4-connected with C, and C is 4-connected with B. Let\'s assume that the plane doesn\'t contain blocked points. Consider all the integral points of the plane whose Euclidean distance from the origin is no more than n, we\'ll name these points special. Chubby Yang wants to get the following property: no special point is 4-connected to some non-special point. To get the property she can pick some integral points of the plane and make them blocked. What is the minimum number of points she needs to pick?" -999
391F3 "Stock Trading" NA "This problem consists of three subproblems: for solving subproblem F1 you will receive 8 points, for solving subproblem F2 you will receive 15 points, and for solving subproblem F3 you will receive 10 points.Manao has developed a model to predict the stock price of a company over the next n days and wants to design a profit-maximizing trading algorithm to make use of these predictions. Unfortunately, Manao\'s trading account has the following restrictions:   It only allows owning either zero or one shares of stock at a time;  It only allows buying or selling a share of this stock once per day;  It allows a maximum of k buy orders over the next n days; For the purposes of this problem, we define a trade to a be the act of buying one share of stock on day i, then holding the stock until some day j\xe2\x80\x89>\xe2\x80\x89i at which point the share is sold. To restate the above constraints, Manao is permitted to make at most k non-overlapping trades during the course of an n-day trading period for which Manao\'s model has predictions about the stock price.Even though these restrictions limit the amount of profit Manao can make compared to what would be achievable with an unlimited number of trades or the ability to hold more than one share at a time, Manao still has the potential to make a lot of money because Manao\'s model perfectly predicts the daily price of the stock. For example, using this model, Manao could wait until the price is low, then buy one share and hold until the price reaches a high value, then sell for a profit, and repeat this process up to k times until n days have passed.Nevertheless, Manao is not satisfied by having a merely good trading algorithm, and wants to develop an optimal strategy for trading subject to these constraints. Help Manao achieve this goal by writing a program that will determine when to buy and sell stock to achieve the greatest possible profit during the n-day trading period subject to the above constraints." -999
391F2 "Stock Trading" greedy "This problem consists of three subproblems: for solving subproblem F1 you will receive 8 points, for solving subproblem F2 you will receive 15 points, and for solving subproblem F3 you will receive 10 points.Manao has developed a model to predict the stock price of a company over the next n days and wants to design a profit-maximizing trading algorithm to make use of these predictions. Unfortunately, Manao\'s trading account has the following restrictions:   It only allows owning either zero or one shares of stock at a time;  It only allows buying or selling a share of this stock once per day;  It allows a maximum of k buy orders over the next n days; For the purposes of this problem, we define a trade to a be the act of buying one share of stock on day i, then holding the stock until some day j\xe2\x80\x89>\xe2\x80\x89i at which point the share is sold. To restate the above constraints, Manao is permitted to make at most k non-overlapping trades during the course of an n-day trading period for which Manao\'s model has predictions about the stock price.Even though these restrictions limit the amount of profit Manao can make compared to what would be achievable with an unlimited number of trades or the ability to hold more than one share at a time, Manao still has the potential to make a lot of money because Manao\'s model perfectly predicts the daily price of the stock. For example, using this model, Manao could wait until the price is low, then buy one share and hold until the price reaches a high value, then sell for a profit, and repeat this process up to k times until n days have passed.Nevertheless, Manao is not satisfied by having a merely good trading algorithm, and wants to develop an optimal strategy for trading subject to these constraints. Help Manao achieve this goal by writing a program that will determine when to buy and sell stock to achieve the greatest possible profit during the n-day trading period subject to the above constraints." -999
391F1 "Stock Trading" dp "This problem consists of three subproblems: for solving subproblem F1 you will receive 8 points, for solving subproblem F2 you will receive 15 points, and for solving subproblem F3 you will receive 10 points.Manao has developed a model to predict the stock price of a company over the next n days and wants to design a profit-maximizing trading algorithm to make use of these predictions. Unfortunately, Manao\'s trading account has the following restrictions:   It only allows owning either zero or one shares of stock at a time;  It only allows buying or selling a share of this stock once per day;  It allows a maximum of k buy orders over the next n days; For the purposes of this problem, we define a trade to a be the act of buying one share of stock on day i, then holding the stock until some day j\xe2\x80\x89>\xe2\x80\x89i at which point the share is sold. To restate the above constraints, Manao is permitted to make at most k non-overlapping trades during the course of an n-day trading period for which Manao\'s model has predictions about the stock price.Even though these restrictions limit the amount of profit Manao can make compared to what would be achievable with an unlimited number of trades or the ability to hold more than one share at a time, Manao still has the potential to make a lot of money because Manao\'s model perfectly predicts the daily price of the stock. For example, using this model, Manao could wait until the price is low, then buy one share and hold until the price reaches a high value, then sell for a profit, and repeat this process up to k times until n days have passed.Nevertheless, Manao is not satisfied by having a merely good trading algorithm, and wants to develop an optimal strategy for trading subject to these constraints. Help Manao achieve this goal by writing a program that will determine when to buy and sell stock to achieve the greatest possible profit during the n-day trading period subject to the above constraints." -999
391E2 "Three Trees" NA "This problem consists of two subproblems: for solving subproblem E1 you will receive 11 points, and for solving subproblem E2 you will receive 13 points.A tree is an undirected connected graph containing no cycles. The distance between two nodes in an unweighted tree is the minimum number of edges that have to be traversed to get from one node to another.You are given 3 trees that have to be united into a single tree by adding two edges between these trees. Each of these edges can connect any pair of nodes from two trees. After the trees are connected, the distances between all unordered pairs of nodes in the united tree should be computed. What is the maximum possible value of the sum of these distances?" -999
391E1 "Three Trees" NA "This problem consists of two subproblems: for solving subproblem E1 you will receive 11 points, and for solving subproblem E2 you will receive 13 points.A tree is an undirected connected graph containing no cycles. The distance between two nodes in an unweighted tree is the minimum number of edges that have to be traversed to get from one node to another.You are given 3 trees that have to be united into a single tree by adding two edges between these trees. Each of these edges can connect any pair of nodes from two trees. After the trees are connected, the distances between all unordered pairs of nodes in the united tree should be computed. What is the maximum possible value of the sum of these distances?" -999
391D2 Supercollider "data structures" "This problem consists of two subproblems: for solving subproblem D1 you will receive 3 points, and for solving subproblem D2 you will receive 16 points.Manao is the chief architect involved in planning a new supercollider. He has to identify a plot of land where the largest possible supercollider can be built. The supercollider he is building requires four-way orthogonal collisions of particles traveling at the same speed, so it will consist of four accelerating chambers and be shaped like a plus sign (i.e., +). Each of the four accelerating chambers must be the same length and must be aligned with the Earth\'s magnetic field (parallel or orthogonal) to minimize interference.The accelerating chambers need to be laid down across long flat stretches of land to keep costs under control. Thus, Manao has already commissioned a topographical study that has identified all possible maximal length tracts of land available for building accelerating chambers that are either parallel or orthogonal to the Earth\'s magnetic field. To build the largest possible supercollider, Manao must identify the largest symmetric plus shape from among these candidate tracts. That is, he must find the two tracts of land that form an axis-aligned plus shape with the largest distance from the center of the plus to the tip of the shortest of the four arms of the plus. Note that the collider need not use the entire length of the tracts identified (see the example in the notes)." -999
391D1 Supercollider "brute force" "This problem consists of two subproblems: for solving subproblem D1 you will receive 3 points, and for solving subproblem D2 you will receive 16 points.Manao is the chief architect involved in planning a new supercollider. He has to identify a plot of land where the largest possible supercollider can be built. The supercollider he is building requires four-way orthogonal collisions of particles traveling at the same speed, so it will consist of four accelerating chambers and be shaped like a plus sign (i.e., +). Each of the four accelerating chambers must be the same length and must be aligned with the Earth\'s magnetic field (parallel or orthogonal) to minimize interference.The accelerating chambers need to be laid down across long flat stretches of land to keep costs under control. Thus, Manao has already commissioned a topographical study that has identified all possible maximal length tracts of land available for building accelerating chambers that are either parallel or orthogonal to the Earth\'s magnetic field. To build the largest possible supercollider, Manao must identify the largest symmetric plus shape from among these candidate tracts. That is, he must find the two tracts of land that form an axis-aligned plus shape with the largest distance from the center of the plus to the tip of the shortest of the four arms of the plus. Note that the collider need not use the entire length of the tracts identified (see the example in the notes)." -999
391C3 "The Tournament" NA "This problem consists of three subproblems: for solving subproblem C1 you will receive 4 points, for solving subproblem C2 you will receive 4 points, and for solving subproblem C3 you will receive 8 points.Manao decided to pursue a fighter\'s career. He decided to begin with an ongoing tournament. Before Manao joined, there were n contestants in the tournament, numbered from 1 to n. Each of them had already obtained some amount of tournament points, namely the i-th fighter had pi points.Manao is going to engage in a single fight against each contestant. Each of Manao\'s fights ends in either a win or a loss. A win grants Manao one point, and a loss grants Manao\'s opponent one point. For each i, Manao estimated the amount of effort ei he needs to invest to win against the i-th contestant. Losing a fight costs no effort.After Manao finishes all of his fights, the ranklist will be determined, with 1 being the best rank and n\xe2\x80\x89+\xe2\x80\x891 being the worst. The contestants will be ranked in descending order of their tournament points. The contestants with the same number of points as Manao will be ranked better than him if they won the match against him and worse otherwise. The exact mechanism of breaking ties for other fighters is not relevant here.Manao\'s objective is to have rank k or better. Determine the minimum total amount of effort he needs to invest in order to fulfill this goal, if it is possible." -999
391C2 "The Tournament" greedy "This problem consists of three subproblems: for solving subproblem C1 you will receive 4 points, for solving subproblem C2 you will receive 4 points, and for solving subproblem C3 you will receive 8 points.Manao decided to pursue a fighter\'s career. He decided to begin with an ongoing tournament. Before Manao joined, there were n contestants in the tournament, numbered from 1 to n. Each of them had already obtained some amount of tournament points, namely the i-th fighter had pi points.Manao is going to engage in a single fight against each contestant. Each of Manao\'s fights ends in either a win or a loss. A win grants Manao one point, and a loss grants Manao\'s opponent one point. For each i, Manao estimated the amount of effort ei he needs to invest to win against the i-th contestant. Losing a fight costs no effort.After Manao finishes all of his fights, the ranklist will be determined, with 1 being the best rank and n\xe2\x80\x89+\xe2\x80\x891 being the worst. The contestants will be ranked in descending order of their tournament points. The contestants with the same number of points as Manao will be ranked better than him if they won the match against him and worse otherwise. The exact mechanism of breaking ties for other fighters is not relevant here.Manao\'s objective is to have rank k or better. Determine the minimum total amount of effort he needs to invest in order to fulfill this goal, if it is possible." -999
391C1 "The Tournament" "brute force" "This problem consists of three subproblems: for solving subproblem C1 you will receive 4 points, for solving subproblem C2 you will receive 4 points, and for solving subproblem C3 you will receive 8 points.Manao decided to pursue a fighter\'s career. He decided to begin with an ongoing tournament. Before Manao joined, there were n contestants in the tournament, numbered from 1 to n. Each of them had already obtained some amount of tournament points, namely the i-th fighter had pi points.Manao is going to engage in a single fight against each contestant. Each of Manao\'s fights ends in either a win or a loss. A win grants Manao one point, and a loss grants Manao\'s opponent one point. For each i, Manao estimated the amount of effort ei he needs to invest to win against the i-th contestant. Losing a fight costs no effort.After Manao finishes all of his fights, the ranklist will be determined, with 1 being the best rank and n\xe2\x80\x89+\xe2\x80\x891 being the worst. The contestants will be ranked in descending order of their tournament points. The contestants with the same number of points as Manao will be ranked better than him if they won the match against him and worse otherwise. The exact mechanism of breaking ties for other fighters is not relevant here.Manao\'s objective is to have rank k or better. Determine the minimum total amount of effort he needs to invest in order to fulfill this goal, if it is possible." -999
391B "Word Folding" "brute force" "You will receive 5 points for solving this problem.Manao has invented a new operation on strings that is called folding. Each fold happens between a pair of consecutive letters and places the second part of the string above first part, running in the opposite direction and aligned to the position of the fold. Using this operation, Manao converts the string into a structure that has one more level than there were fold operations performed. See the following examples for clarity.We will denote the positions of folds with \'|\' characters. For example, the word ""ABRACADABRA"" written as ""AB|RACA|DAB|RA"" indicates that it has been folded three times: first, between the leftmost pair of \'B\' and \'R\' letters; second, between \'A\' and \'D\'; and third, between the rightmost pair of \'B\' and \'R\' letters. Here are several examples of folded strings:""ABCDEF|GHIJK"" |  ""A|BCDEFGHIJK"" |  ""AB|RACA|DAB|RA"" |  ""X|XXXXX|X|X|XXXXXX""               |                 |                   |       XXXXXX    KJIHG      |   KJIHGFEDCB    |      AR           |       X   ABCDEF      |            A    |     DAB           |       X               |                 |     ACAR          |       XXXXX               |                 |       AB          |           XOne last example for ""ABCD|EFGH|IJ|K"":  KIJHGFEABCDManao noticed that each folded string can be viewed as several piles of letters. For instance, in the previous example, there are four piles, which can be read as ""AHI"", ""BGJK"", ""CF"", and ""DE"" from bottom to top. Manao wonders what is the highest pile of identical letters he can build using fold operations on a given word. Note that the pile should not contain gaps and should start at the bottom level. For example, in the rightmost of the four examples above, none of the piles would be considered valid since each of them has gaps, starts above the bottom level, or both." -999
391A "Genetic Engineering" "implementation,two pointers" "You will receive 3 points for solving this problem.Manao is designing the genetic code for a new type of algae to efficiently produce fuel. Specifically, Manao is focusing on a stretch of DNA that encodes one protein. The stretch of DNA is represented by a string containing only the characters \'A\', \'T\', \'G\' and \'C\'.Manao has determined that if the stretch of DNA contains a maximal sequence of consecutive identical nucleotides that is of even length, then the protein will be nonfunctional. For example, consider a protein described by DNA string ""GTTAAAG"". It contains four maximal sequences of consecutive identical nucleotides: ""G"", ""TT"", ""AAA"", and ""G"". The protein is nonfunctional because sequence ""TT"" has even length.Manao is trying to obtain a functional protein from the protein he currently has. Manao can insert additional nucleotides into the DNA stretch. Each additional nucleotide is a character from the set {\'A\', \'T\', \'G\', \'C\'}. Manao wants to determine the minimum number of insertions necessary to make the DNA encode a functional protein." -999
390E "Inna and Large Sweet Matrix" NA "Inna loves sweets very much. That\'s why she wants to play the ""Sweet Matrix"" game with Dima and Sereja. But Sereja is a large person, so the game proved small for him. Sereja suggested playing the ""Large Sweet Matrix"" game.The ""Large Sweet Matrix"" playing field is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix. Let\'s number the rows of the matrix from 1 to n, and the columns \xe2\x80\x94 from 1 to m. Let\'s denote the cell in the i-th row and j-th column as (i,\xe2\x80\x89j). Each cell of the matrix can contain multiple candies, initially all cells are empty. The game goes in w moves, during each move one of the two following events occurs:  Sereja chooses five integers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2,\xe2\x80\x89v (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2,\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2) and adds v candies to each matrix cell (i,\xe2\x80\x89j) (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2; y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2).  Sereja chooses four integers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2,\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2). Then he asks Dima to calculate the total number of candies in cells (i,\xe2\x80\x89j) (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2; y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2) and he asks Inna to calculate the total number of candies in the cells of matrix (p,\xe2\x80\x89q), which meet the following logical criteria: (p\xe2\x80\x89<\xe2\x80\x89x1 OR p\xe2\x80\x89>\xe2\x80\x89x2) AND (q\xe2\x80\x89<\xe2\x80\x89y1 OR q\xe2\x80\x89>\xe2\x80\x89y2). Finally, Sereja asks to write down the difference between the number Dima has calculated and the number Inna has calculated (D - I). Unfortunately, Sereja\'s matrix is really huge. That\'s why Inna and Dima aren\'t coping with the calculating. Help them!" -999
390D "Inna and Sweet Matrix" "constructive algorithms" "Inna loves sweets very much. That\'s why she decided to play a game called ""Sweet Matrix"".Inna sees an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix and k candies. We\'ll index the matrix rows from 1 to n and the matrix columns from 1 to m. We\'ll represent the cell in the i-th row and j-th column as (i,\xe2\x80\x89j). Two cells (i,\xe2\x80\x89j) and (p,\xe2\x80\x89q) of the matrix are adjacent if |i\xe2\x80\x89-\xe2\x80\x89p|\xe2\x80\x89+\xe2\x80\x89|j\xe2\x80\x89-\xe2\x80\x89q|\xe2\x80\x89=\xe2\x80\x891. A path is a sequence of the matrix cells where each pair of neighbouring cells in the sequence is adjacent. We\'ll call the number of cells in the sequence the path\'s length.Each cell of the matrix can have at most one candy. Initiallly, all the cells are empty. Inna is trying to place each of the k candies in the matrix one by one. For each candy Inna chooses cell (i,\xe2\x80\x89j) that will contains the candy, and also chooses the path that starts in cell (1,\xe2\x80\x891) and ends in cell (i,\xe2\x80\x89j) and doesn\'t contain any candies. After that Inna moves the candy along the path from cell (1,\xe2\x80\x891) to cell (i,\xe2\x80\x89j), where the candy stays forever. If at some moment Inna can\'t choose a path for the candy, she loses. If Inna can place all the candies in the matrix in the described manner, then her penalty equals the sum of lengths of all the paths she has used.Help Inna to minimize the penalty in the game." -999
390C "Inna and Candy Boxes" "data structures" "Inna loves sweets very much. She has n closed present boxes lines up in a row in front of her. Each of these boxes contains either a candy (Dima\'s work) or nothing (Sereja\'s work). Let\'s assume that the boxes are numbered from 1 to n, from left to right.As the boxes are closed, Inna doesn\'t know which boxes contain candies and which boxes contain nothing. Inna chose number k and asked w questions to Dima to find that out. Each question is characterised by two integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 is divisible by k), the i-th question is: ""Dima, is that true that among the boxes with numbers from li to ri, inclusive, the candies lie only in boxes with numbers li\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891, li\xe2\x80\x89+\xe2\x80\x892k\xe2\x80\x89-\xe2\x80\x891, li\xe2\x80\x89+\xe2\x80\x893k\xe2\x80\x89-\xe2\x80\x891, ..., ri?""Dima hates to say ""no"" to Inna. That\'s why he wonders, what number of actions he will have to make for each question to make the answer to the question positive. In one action, Dima can either secretly take the candy from any box or put a candy to any box (Dima has infinitely many candies). Help Dima count the number of actions for each Inna\'s question.Please note that Dima doesn\'t change the array during Inna\'s questions. That\'s why when you calculate the number of operations for the current question, please assume that the sequence of boxes didn\'t change." -999
390B "Inna, Dima and Song" implementation "Inna is a great piano player and Dima is a modest guitar player. Dima has recently written a song and they want to play it together. Of course, Sereja wants to listen to the song very much. A song is a sequence of notes. Dima and Inna want to play each note at the same time. At that, they can play the i-th note at volume v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai; v is an integer) both on the piano and the guitar. They should retain harmony, so the total volume with which the i-th note was played on the guitar and the piano must equal bi. If Dima and Inna cannot play a note by the described rules, they skip it and Sereja\'s joy drops by 1. But if Inna and Dima play the i-th note at volumes xi and yi (xi\xe2\x80\x89+\xe2\x80\x89yi\xe2\x80\x89=\xe2\x80\x89bi) correspondingly, Sereja\'s joy rises by xi\xc2\xb7yi. Sereja has just returned home from the university and his current joy is 0. Help Dima and Inna play the song so as to maximize Sereja\'s total joy after listening to the whole song!" -999
390A "Inna and Alarm Clock" implementation "Inna loves sleeping very much, so she needs n alarm clocks in total to wake up. Let\'s suppose that Inna\'s room is a 100\xe2\x80\x89\xc3\x97\xe2\x80\x89100 square with the lower left corner at point (0,\xe2\x80\x890) and with the upper right corner at point (100,\xe2\x80\x89100). Then the alarm clocks are points with integer coordinates in this square.The morning has come. All n alarm clocks in Inna\'s room are ringing, so Inna wants to turn them off. For that Inna has come up with an amusing game:  First Inna chooses a type of segments that she will use throughout the game. The segments can be either vertical or horizontal.  Then Inna makes multiple moves. In a single move, Inna can paint a segment of any length on the plane, she chooses its type at the beginning of the game (either vertical or horizontal), then all alarm clocks that are on this segment switch off. The game ends when all the alarm clocks are switched off. Inna is very sleepy, so she wants to get through the alarm clocks as soon as possible. Help her, find the minimum number of moves in the game that she needs to turn off all the alarm clocks!" -999
389B "Fox and Cross" greedy,implementation "Fox Ciel has a board with n rows and n columns. So, the board consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. Each cell contains either a symbol \'.\', or a symbol \'#\'.A cross on the board is a connected set of exactly five cells of the board that looks like a cross. The picture below shows how it looks.Ciel wants to draw several (may be zero) crosses on the board. Each cross must cover exactly five cells with symbols \'#\', and any cell with symbol \'#\' must belong to some cross. No two crosses can share a cell.Please, tell Ciel if she can draw the crosses in the described way." 1100
389A "Fox and Number Game" greedy,math "Fox Ciel is playing a game with numbers now. Ciel has n positive integers: x1, x2, ..., xn. She can do the following operation as many times as needed: select two different indexes i and j such that xi > xj hold, and then apply assignment xi = xi - xj. The goal is to make the sum of all numbers as small as possible.Please help Ciel to find this minimal sum." 1000
388E "Fox and Meteor Shower" geometry "There is a meteor shower on the sky and there are n meteors. The sky can be viewed as a 2D Euclid Plane and the meteor is point on this plane. Fox Ciel looks at the sky. She finds out that the orbit of each meteor is a straight line, and each meteor has a constant velocity. Now Ciel wants to know: what is the maximum number of meteors such that any pair met at the same position at a certain time? Note that the time is not limited and can be also negative. The meteors will never collide when they appear at the same position at the same time." 3100
388D "Fox and Perfect Sets" math "Fox Ciel studies number theory.She thinks a non-empty set S contains non-negative integers is perfect if and only if for any  (a can be equal to b), . Where operation xor means exclusive or operation (http://en.wikipedia.org/wiki/Exclusive_or).Please calculate the number of perfect sets consisting of integers not greater than k. The answer can be very large, so print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700
388C "Fox and Card Game" games,greedy,sortings "Fox Ciel is playing a card game with her friend Fox Jiro. There are n piles of cards on the table. And there is a positive integer on each card.The players take turns and Ciel takes the first turn. In Ciel\'s turn she takes a card from the top of any non-empty pile, and in Jiro\'s turn he takes a card from the bottom of any non-empty pile. Each player wants to maximize the total sum of the cards he took. The game ends when all piles become empty.Suppose Ciel and Jiro play optimally, what is the score of the game?" 2000
388B "Fox and Minimal path" "bitmasks,constructive algorithms,graphs,implementation,math" "Fox Ciel wants to write a task for a programming contest. The task is: ""You are given a simple undirected graph with n vertexes. Each its edge has unit length. You should calculate the number of shortest paths between vertex 1 and vertex 2.""Same with some writers, she wants to make an example with some certain output: for example, her birthday or the number of her boyfriend. Can you help her to make a test case with answer equal exactly to k?" 1900
388A "Fox and Box Accumulation" greedy,sortings "Fox Ciel has n boxes in her room. They have the same size and weight, but they might have different strength. The i-th box can hold at most xi boxes on its top (we\'ll call xi the strength of the box). Since all the boxes have the same size, Ciel cannot put more than one box directly on the top of some box. For example, imagine Ciel has three boxes: the first has strength 2, the second has strength 1 and the third has strength 1. She cannot put the second and the third box simultaneously directly on the top of the first one. But she can put the second box directly on the top of the first one, and then the third box directly on the top of the second one. We will call such a construction of boxes a pile.Fox Ciel wants to construct piles from all the boxes. Each pile will contain some boxes from top to bottom, and there cannot be more than xi boxes on the top of i-th box. What is the minimal number of piles she needs to construct?" 1400
387E "George and Cards" "binary search,data structures" "George is a cat, so he loves playing very much.Vitaly put n cards in a row in front of George. Each card has one integer written on it. All cards had distinct numbers written on them. Let\'s number the cards from the left to the right with integers from 1 to n. Then the i-th card from the left contains number pi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Vitaly wants the row to have exactly k cards left. He also wants the i-th card from left to have number bi written on it. Vitaly gave a task to George, to get the required sequence of cards using the remove operation n\xe2\x80\x89-\xe2\x80\x89k times.In one remove operation George can choose w (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w; w is not greater than the current number of cards in the row) contiguous cards (contiguous subsegment of cards). Let\'s denote the numbers written on these card as x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xw (from the left to the right). After that, George can remove the card xi, such that xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xj for each j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w). After the described operation George gets w pieces of sausage.George wondered: what maximum number of pieces of sausage will he get in total if he reaches his goal and acts optimally well? Help George, find an answer to his question!" 2200
387D "George and Interesting Graph" "graph matchings" "George loves graphs. Most of all, he loves interesting graphs. We will assume that a directed graph is interesting, if it meets the following criteria:   The graph doesn\'t contain any multiple arcs;  There is vertex v (we\'ll call her the center), such that for any vertex of graph u, the graph contains arcs (u,\xe2\x80\x89v) and (v,\xe2\x80\x89u). Please note that the graph also contains loop (v,\xe2\x80\x89v).  The outdegree of all vertexes except for the center equals two and the indegree of all vertexes except for the center equals two. The outdegree of vertex u is the number of arcs that go out of u, the indegree of vertex u is the number of arcs that go in u. Please note that the graph can contain loops. However, not everything\'s that simple. George got a directed graph of n vertices and m arcs as a present. The graph didn\'t have any multiple arcs. As George loves interesting graphs, he wants to slightly alter the presented graph and transform it into an interesting one. In one alteration he can either remove an arbitrary existing arc from the graph or add an arbitrary arc to the graph. George wonders: what is the minimum number of changes that he needs to obtain an interesting graph from the graph he\'s got as a present? Help George and find the answer to the question." 2200
387C "George and Number" greedy,implementation "George is a cat, so he really likes to play. Most of all he likes to play with his array of positive integers b. During the game, George modifies the array by using special changes. Let\'s mark George\'s current array as b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89b|b| (record |b| denotes the current length of the array). Then one change is a sequence of actions:   Choose two distinct indexes i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|b|; i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j), such that bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bj.  Get number v\xe2\x80\x89=\xe2\x80\x89concat(bi,\xe2\x80\x89bj), where concat(x,\xe2\x80\x89y) is a number obtained by adding number y to the end of the decimal record of number x. For example, concat(500,\xe2\x80\x8910)\xe2\x80\x89=\xe2\x80\x8950010, concat(2,\xe2\x80\x892)\xe2\x80\x89=\xe2\x80\x8922.  Add number v to the end of the array. The length of the array will increase by one.  Remove from the array numbers with indexes i and j. The length of the array will decrease by two, and elements of the array will become re-numbered from 1 to current length of the array. George played for a long time with his array b and received from array b an array consisting of exactly one number p. Now George wants to know: what is the maximum number of elements array b could contain originally? Help him find this number. Note that originally the array could contain only positive integers." 1700
387B "George and Round" "brute force,greedy,two pointers" "George decided to prepare a Codesecrof round, so he has prepared m problems for the round. Let\'s number the problems with integers 1 through m. George estimates the i-th problem\'s complexity by integer bi.To make the round good, he needs to put at least n problems there. Besides, he needs to have at least one problem with complexity exactly a1, at least one with complexity exactly a2, ..., and at least one with complexity exactly an. Of course, the round can also have problems with other complexities.George has a poor imagination. It\'s easier for him to make some already prepared problem simpler than to come up with a new one and prepare it. George is magnificent at simplifying problems. He can simplify any already prepared problem with complexity c to any positive integer complexity d (c\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89d), by changing limits on the input data.However, nothing is so simple. George understood that even if he simplifies some problems, he can run out of problems for a good round. That\'s why he decided to find out the minimum number of problems he needs to come up with in addition to the m he\'s prepared in order to make a good round. Note that George can come up with a new problem of any complexity." 1200
387A "George and Sleep" implementation "George woke up and saw the current time s on the digital clock. Besides, George knows that he has slept for time t. Help George! Write a program that will, given time s and t, determine the time p when George went to bed. Note that George could have gone to bed yesterday relatively to the current time (see the second test sample)." 900
386D "Game with Points" "dp,graphs,implementation,shortest paths" "You are playing the following game. There are n points on a plane. They are the vertices of a regular n-polygon. Points are labeled with integer numbers from 1 to n. Each pair of distinct points is connected by a diagonal, which is colored in one of 26 colors. Points are denoted by lowercase English letters. There are three stones positioned on three distinct vertices. All stones are the same. With one move you can move the stone to another free vertex along some diagonal. The color of this diagonal must be the same as the color of the diagonal, connecting another two stones. Your goal is to move stones in such way that the only vertices occupied by stones are 1, 2 and 3. You must achieve such position using minimal number of moves. Write a program which plays this game in an optimal way." 2100
386C "Diverse Substrings" "dp,strings,two pointers" "String diversity is the number of symbols that occur in the string at least once. Diversity of s will be denoted by d(s). For example , d(""aaa"")=1, d(""abacaba"")=3.Given a string s, consisting of lowercase Latin letters. Consider all its substrings. Obviously, any substring diversity is a number from 1 to d(s). Find statistics about substrings diversity: for each k from 1 to d(s), find how many substrings of s has a diversity of exactly k." 2000
386B "Fly, freebies, fly!" "binary search,brute force,implementation" "Everyone loves a freebie. Especially students.It is well-known that if in the night before exam a student opens window, opens the student\'s record-book and shouts loudly three times ""Fly, freebie, fly!"" \xe2\x80\x94 then flown freebie helps him to pass the upcoming exam.In the night before the exam on mathematical analysis n students living in dormitory shouted treasured words. The i-th student made a sacrament at the time ti, where ti is the number of seconds elapsed since the beginning of the night.It is known that the freebie is a capricious and willful lady. That night the freebie was near dormitory only for T seconds. Therefore, if for two students their sacrament times differ for more than T, then the freebie didn\'t visit at least one of them.Since all students are optimists, they really want to know what is the maximal number of students visited by the freebie can be." 1400
386A "Second-Price Auction" implementation "In this problem we consider a special type of an auction, which is called the second-price auction. As in regular auction n bidders place a bid which is price a bidder ready to pay. The auction is closed, that is, each bidder secretly informs the organizer of the auction price he is willing to pay. After that, the auction winner is the participant who offered the highest price. However, he pay not the price he offers, but the highest price among the offers of other participants (hence the name: the second-price auction).Write a program that reads prices offered by bidders and finds the winner and the price he will pay. Consider that all of the offered prices are different." 800
385E "Bear in the Field" math,matrices "Our bear\'s forest has a checkered field. The checkered field is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table, the rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to n from left to right. Let\'s denote a cell of the field on the intersection of row x and column y by record (x,\xe2\x80\x89y). Each cell of the field contains growing raspberry, at that, the cell (x,\xe2\x80\x89y) of the field contains x\xe2\x80\x89+\xe2\x80\x89y raspberry bushes.The bear came out to walk across the field. At the beginning of the walk his speed is (dx,\xe2\x80\x89dy). Then the bear spends exactly t seconds on the field. Each second the following takes place:  Let\'s suppose that at the current moment the bear is in cell (x,\xe2\x80\x89y).  First the bear eats the raspberry from all the bushes he has in the current cell. After the bear eats the raspberry from k bushes, he increases each component of his speed by k. In other words, if before eating the k bushes of raspberry his speed was (dx,\xe2\x80\x89dy), then after eating the berry his speed equals (dx\xe2\x80\x89+\xe2\x80\x89k,\xe2\x80\x89dy\xe2\x80\x89+\xe2\x80\x89k).  Let\'s denote the current speed of the bear (dx,\xe2\x80\x89dy) (it was increased after the previous step). Then the bear moves from cell (x,\xe2\x80\x89y) to cell (((x\xe2\x80\x89+\xe2\x80\x89dx\xe2\x80\x89-\xe2\x80\x891) mod n)\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89((y\xe2\x80\x89+\xe2\x80\x89dy\xe2\x80\x89-\xe2\x80\x891) mod n)\xe2\x80\x89+\xe2\x80\x891).  Then one additional raspberry bush grows in each cell of the field. You task is to predict the bear\'s actions. Find the cell he ends up in if he starts from cell (sx,\xe2\x80\x89sy). Assume that each bush has infinitely much raspberry and the bear will never eat all of it." 2300
385D "Bear and Floodlight" bitmasks,dp,geometry "One day a bear lived on the Oxy axis. He was afraid of the dark, so he couldn\'t move at night along the plane points that aren\'t lit. One day the bear wanted to have a night walk from his house at point (l,\xe2\x80\x890) to his friend\'s house at point (r,\xe2\x80\x890), along the segment of length (r\xe2\x80\x89-\xe2\x80\x89l). Of course, if he wants to make this walk, he needs each point of the segment to be lit. That\'s why the bear called his friend (and yes, in the middle of the night) asking for a very delicate favor.The Oxy axis contains n floodlights. Floodlight i is at point (xi,\xe2\x80\x89yi) and can light any angle of the plane as large as ai degree with vertex at point (xi,\xe2\x80\x89yi). The bear asked his friend to turn the floodlights so that he (the bear) could go as far away from his house as possible during the walking along the segment. His kind friend agreed to fulfill his request. And while he is at it, the bear wonders: what is the furthest he can go away from his house? Hep him and find this distance.Consider that the plane has no obstacles and no other light sources besides the floodlights. The bear\'s friend cannot turn the floodlights during the bear\'s walk. Assume that after all the floodlights are turned in the correct direction, the bear goes for a walk and his friend goes to bed." 2200
385C "Bear and Prime Numbers" "binary search,brute force,data structures,dp,implementation,math,number theory" "Recently, the bear started studying data structures and faced the following problem.You are given a sequence of integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn of length n and m queries, each of them is characterized by two integers li,\xe2\x80\x89ri. Let\'s introduce f(p) to represent the number of such indexes k, that xk is divisible by p. The answer to the query li,\xe2\x80\x89ri is the sum: , where S(li,\xe2\x80\x89ri) is a set of prime numbers from segment [li,\xe2\x80\x89ri] (both borders are included in the segment).Help the bear cope with the problem." 1700
385B "Bear and Strings" "brute force,greedy,implementation,math,strings" "The bear has a string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (record |s| is the string\'s length), consisting of lowercase English letters. The bear wants to count the number of such pairs of indices i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|), that string x(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89sisi\xe2\x80\x89+\xe2\x80\x891... sj contains at least one string ""bear"" as a substring.String x(i,\xe2\x80\x89j) contains string ""bear"", if there is such index k (i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x893), that sk\xe2\x80\x89=\xe2\x80\x89b, sk\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89e, sk\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89a, sk\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x89r.Help the bear cope with the given problem." 1200
385A "Bear and Raspberry" "brute force,greedy,implementation" "The bear decided to store some raspberry for the winter. He cunningly found out the price for a barrel of honey in kilos of raspberry for each of the following n days. According to the bear\'s data, on the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) day, the price for one barrel of honey is going to is xi kilos of raspberry.Unfortunately, the bear has neither a honey barrel, nor the raspberry. At the same time, the bear\'s got a friend who is ready to lend him a barrel of honey for exactly one day for c kilograms of raspberry. That\'s why the bear came up with a smart plan. He wants to choose some day d (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89<\xe2\x80\x89n), lent a barrel of honey and immediately (on day d) sell it according to a daily exchange rate. The next day (d\xe2\x80\x89+\xe2\x80\x891) the bear wants to buy a new barrel of honey according to a daily exchange rate (as he\'s got some raspberry left from selling the previous barrel) and immediately (on day d\xe2\x80\x89+\xe2\x80\x891) give his friend the borrowed barrel of honey as well as c kilograms of raspberry for renting the barrel.The bear wants to execute his plan at most once and then hibernate. What maximum number of kilograms of raspberry can he earn? Note that if at some point of the plan the bear runs out of the raspberry, then he won\'t execute such a plan." 1000
384B Multitasking "greedy,implementation,sortings,two pointers" "Iahub wants to enhance his multitasking abilities. In order to do this, he wants to sort n arrays simultaneously, each array consisting of m integers.Iahub can choose a pair of distinct indices i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m,\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j). Then in each array the values at positions i and j are swapped only if the value at position i is strictly greater than the value at position j.Iahub wants to find an array of pairs of distinct indices that, chosen in order, sort all of the n arrays in ascending or descending order (the particular order is given in input). The size of the array can be at most  (at most  pairs). Help Iahub, find any suitable array." 1500
384A Coder implementation "Iahub likes chess very much. He even invented a new chess piece named Coder. A Coder can move (and attack) one square horizontally or vertically. More precisely, if the Coder is located at position (x,\xe2\x80\x89y), he can move to (or attack) positions (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x931,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) and (x,\xe2\x80\x89y\xe2\x80\x931).Iahub wants to know how many Coders can be placed on an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard, so that no Coder attacks any other Coder." 800
383E Vowels "combinatorics,divide and conquer,dp" "Iahubina is tired of so many complicated languages, so she decided to invent a new, simple language. She already made a dictionary consisting of n 3-words. A 3-word is a sequence of exactly 3 lowercase letters of the first 24 letters of the English alphabet (a to x). She decided that some of the letters are vowels, and all the others are consonants. The whole language is based on a simple rule: any word that contains at least one vowel is correct.Iahubina forgot which letters are the vowels, and wants to find some possible correct sets of vowels. She asks Iahub questions. In each question, she will give Iahub a set of letters considered vowels (in this question). For each question she wants to know how many words of the dictionary are correct, considering the given set of vowels.Iahubina wants to know the xor of the squared answers to all the possible questions. There are 224 different questions, they are all subsets of the set of the first 24 letters of the English alphabet. Help Iahub find that number." 2700
383D Antimatter dp "Iahub accidentally discovered a secret lab. He found there n devices ordered in a line, numbered from 1 to n from left to right. Each device i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) can create either ai units of matter or ai units of antimatter. Iahub wants to choose some contiguous subarray of devices in the lab, specify the production mode for each of them (produce matter or antimatter) and finally take a photo of it. However he will be successful only if the amounts of matter and antimatter produced in the selected subarray will be the same (otherwise there would be overflowing matter or antimatter in the photo). You are requested to compute the number of different ways Iahub can successful take a photo. A photo is different than another if it represents another subarray, or if at least one device of the subarray is set to produce matter in one of the photos and antimatter in the other one." 2300
383C "Propagating tree" "data structures,dfs and similar,trees" "Iahub likes trees very much. Recently he discovered an interesting tree named propagating tree. The tree consists of n nodes numbered from 1 to n, each node i having an initial value ai. The root of the tree is node 1.This tree has a special property: when a value val is added to a value of node i, the value -val is added to values of all the children of node i. Note that when you add value -val to a child of node i, you also add -(-val) to all children of the child of node i and so on. Look an example explanation to understand better how it works.This tree supports two types of queries:  ""1 x val"" \xe2\x80\x94 val is added to the value of node x;  ""2 x"" \xe2\x80\x94 print the current value of node x. In order to help Iahub understand the tree better, you must answer m queries of the preceding type." 2000
383B Volcanoes "binary search,implementation,sortings,two pointers" "Iahub got lost in a very big desert. The desert can be represented as a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix, where each cell is a zone of the desert. The cell (i,\xe2\x80\x89j) represents the cell at row i and column j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Iahub can go from one cell (i,\xe2\x80\x89j) only down or right, that is to cells (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j) or (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891). Also, there are m cells that are occupied by volcanoes, which Iahub cannot enter. Iahub is initially at cell (1,\xe2\x80\x891) and he needs to travel to cell (n,\xe2\x80\x89n). Knowing that Iahub needs 1 second to travel from one cell to another, find the minimum time in which he can arrive in cell (n,\xe2\x80\x89n)." 2500
383A "Milking cows" "data structures,greedy" "Iahub helps his grandfather at the farm. Today he must milk the cows. There are n cows sitting in a row, numbered from 1 to n from left to right. Each cow is either facing to the left or facing to the right. When Iahub milks a cow, all the cows that see the current cow get scared and lose one unit of the quantity of milk that they can give. A cow facing left sees all the cows with lower indices than her index, and a cow facing right sees all the cows with higher indices than her index. A cow that got scared once can get scared again (and lose one more unit of milk). A cow that has been milked once cannot get scared and lose any more milk. You can assume that a cow never loses all the milk she can give (a cow gives an infinitely amount of milk).Iahub can decide the order in which he milks the cows. But he must milk each cow exactly once. Iahub wants to lose as little milk as possible. Print the minimum amount of milk that is lost." 1600
382E "Ksenia and Combinatorics" combinatorics,dp "Ksenia has her winter exams. Today she is learning combinatorics. Here\'s one of the problems she needs to learn to solve.How many distinct trees are there consisting of n vertices, each with the following properties:  the tree is marked, that is, the vertices of the tree are numbered from 1 to n;  each vertex of the tree is connected with at most three other vertices, and at the same moment the vertex with number 1 is connected with at most two other vertices;  the size of the tree\'s maximum matching equals k. Two trees are considered distinct if there are such two vertices u and v, that in one tree they are connected by an edge and in the other tree they are not.Help Ksenia solve the problem for the given n and k. As the answer to the problem can be very huge you should output it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2600
382D "Ksenia and Pawns" "dfs and similar,graphs,implementation,trees" "Ksenia has a chessboard of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of the chessboard contains one of the characters: ""<"", "">"", ""^"", ""v"", ""#"". The cells that contain character ""#"" are blocked. We know that all chessboard cells that touch the border are blocked.Ksenia is playing with two pawns on this chessboard. Initially, she puts the pawns on the chessboard. One cell of the chessboard can contain two pawns if and only if the cell is blocked. In other cases two pawns can not stand in one cell. The game begins when Ksenia put pawns on the board. In one move, Ksenia moves each pawn to a side adjacent cell in the direction of arrows painted on the cell on which the corresponding pawn sits (if the pawn sits on ""#"", it does not move). Assume that Ksenia moves pawns simultaneously (see the second test case). Of course, Ksenia plays for points. How can one calculate the points per game? Very simply! Let\'s count how many movements the first pawn made and how many movements the second pawn made, sum these two numbers \xe2\x80\x94 it will be the resulting score of the game. Ksenia wonders: what is the maximum number of points she can earn (for that, she should place the pawns optimally well early in the game). Help her and find that number." 2200
382C "Arithmetic Progression" implementation,sortings "Everybody knows what an arithmetic progression is. Let us remind you just in case that an arithmetic progression is such sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of length n, that the following condition fulfills: a2\xe2\x80\x89-\xe2\x80\x89a1\xe2\x80\x89=\xe2\x80\x89a3\xe2\x80\x89-\xe2\x80\x89a2\xe2\x80\x89=\xe2\x80\x89a4\xe2\x80\x89-\xe2\x80\x89a3\xe2\x80\x89=\xe2\x80\x89...\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89=\xe2\x80\x89...\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891.For example, sequences [1, 5], [10], [5, 4, 3] are arithmetic progressions and sequences [1, 3, 2], [1, 2, 4] are not.Alexander has n cards containing integers. Arthur wants to give Alexander exactly one more card with a number so that he could use the resulting n\xe2\x80\x89+\xe2\x80\x891 cards to make an arithmetic progression (Alexander has to use all of his cards).Arthur has already bought a card but he hasn\'t written a number on it. Help him, print all integers that you can write on a card so that the described condition fulfilled." 1700
382B "Number Busters" "binary search,math" "Arthur and Alexander are number busters. Today they\'ve got a competition. Arthur took a group of four integers a,\xe2\x80\x89b,\xe2\x80\x89w,\xe2\x80\x89x (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89w,\xe2\x80\x890\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89w) and Alexander took integer \xd1\x81. Arthur and Alexander use distinct approaches to number bustings. Alexander is just a regular guy. Each second, he subtracts one from his number. In other words, he performs the assignment: c\xe2\x80\x89=\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891. Arthur is a sophisticated guy. Each second Arthur performs a complex operation, described as follows: if b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89x, perform the assignment b\xe2\x80\x89=\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89x, if b\xe2\x80\x89<\xe2\x80\x89x, then perform two consecutive assignments a\xe2\x80\x89=\xe2\x80\x89a\xe2\x80\x89-\xe2\x80\x891; b\xe2\x80\x89=\xe2\x80\x89w\xe2\x80\x89-\xe2\x80\x89(x\xe2\x80\x89-\xe2\x80\x89b).You\'ve got numbers a,\xe2\x80\x89b,\xe2\x80\x89w,\xe2\x80\x89x,\xe2\x80\x89c. Determine when Alexander gets ahead of Arthur if both guys start performing the operations at the same time. Assume that Alexander got ahead of Arthur if c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a." 2000
382A "Ksenia and Pan Scales" greedy,implementation "Ksenia has ordinary pan scales and several weights of an equal mass. Ksenia has already put some weights on the scales, while other weights are untouched. Ksenia is now wondering whether it is possible to put all the remaining weights on the scales so that the scales were in equilibrium. The scales is in equilibrium if the total sum of weights on the left pan is equal to the total sum of weights on the right pan." 1100
381B "Sereja and Stairs" greedy,implementation,sortings "Sereja loves integer sequences very much. He especially likes stairs.Sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a|a| (|a| is the length of the sequence) is stairs if there is such index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|), that the following condition is met: a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89>\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89...\xe2\x80\x89>\xe2\x80\x89a|a|\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89a|a|.For example, sequences [1, 2, 3, 2] and [4, 2] are stairs and sequence [3, 1, 2] isn\'t.Sereja has m cards with numbers. He wants to put some cards on the table in a row to get a stair sequence. What maximum number of cards can he put on the table?" 1100
381A "Sereja and Dima" "greedy,implementation,two pointers" "Sereja and Dima play a game. The rules of the game are very simple. The players have n cards in a row. Each card contains a number, all numbers on the cards are distinct. The players take turns, Sereja moves first. During his turn a player can take one card: either the leftmost card in a row, or the rightmost one. The game ends when there is no more cards. The player who has the maximum sum of numbers on his cards by the end of the game, wins.Sereja and Dima are being greedy. Each of them chooses the card with the larger number during his move.Inna is a friend of Sereja and Dima. She knows which strategy the guys are using, so she wants to determine the final score, given the initial state of the game. Help her." 800
380E "Sereja and Dividing" "data structures" "Let\'s assume that we have a sequence of doubles a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a|a| and a double variable x. You are allowed to perform the following two-staged operation:  choose an index of the sequence element i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|a|);  consecutively perform assignments: . Let\'s use function g(a,\xe2\x80\x89x) to represent the largest value that can be obtained from variable x, using the described operation any number of times and sequence a.Sereja has sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89b|b|. Help Sereja calculate sum: . Record [bi,\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89bj] represents a sequence containing the elements in brackets in the given order. To avoid problems with precision, please, print the required sum divided by |b|2." 2600
380D "Sereja and Cinema" combinatorics,math "The cinema theater hall in Sereja\'s city is n seats lined up in front of one large screen. There are slots for personal possessions to the left and to the right of each seat. Any two adjacent seats have exactly one shared slot. The figure below shows the arrangement of seats and slots for n\xe2\x80\x89=\xe2\x80\x894.  Today it\'s the premiere of a movie called ""Dry Hard"". The tickets for all the seats have been sold. There is a very strict controller at the entrance to the theater, so all n people will come into the hall one by one. As soon as a person enters a cinema hall, he immediately (momentarily) takes his seat and occupies all empty slots to the left and to the right from him. If there are no empty slots, the man gets really upset and leaves.People are not very constant, so it\'s hard to predict the order in which the viewers will enter the hall. For some seats, Sereja knows the number of the viewer (his number in the entering queue of the viewers) that will come and take this seat. For others, it can be any order. Being a programmer and a mathematician, Sereja wonders: how many ways are there for the people to enter the hall, such that nobody gets upset? As the number can be quite large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2500
380C "Sereja and Brackets" "data structures,schedules" "Sereja has a bracket sequence s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn, or, in other words, a string s of length n, consisting of characters ""("" and "")"".Sereja needs to answer m queries, each of them is described by two integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The answer to the i-th query is the length of the maximum correct bracket subsequence of sequence sli,\xe2\x80\x89sli\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sri. Help Sereja answer all queries.You can find the definitions for a subsequence and a correct bracket sequence in the notes." 2000
380B "Sereja and Tree" graphs,implementation "Sereja adores trees. Today he came up with a revolutionary new type of binary root trees.His new tree consists of n levels, each vertex is indexed by two integers: the number of the level and the number of the vertex on the current level. The tree root is at level 1, its index is (1,\xe2\x80\x891). Here is a pseudo code of tree construction.//the global data are integer arrays cnt[], left[][], right[][]cnt[1] = 1;fill arrays left[][], right[][] with values -1;for(level = 1; level < n; level = level + 1){    cnt[level + 1] = 0;    for(position = 1; position <= cnt[level]; position = position + 1){        if(the value of position is a power of two){ // that is, 1, 2, 4, 8...            left[level][position] = cnt[level + 1] + 1;            right[level][position] = cnt[level + 1] + 2;            cnt[level + 1] = cnt[level + 1] + 2;                    }else{            right[level][position] = cnt[level + 1] + 1;            cnt[level + 1] = cnt[level + 1] + 1;        }    }}After the pseudo code is run, cell cnt[level] contains the number of vertices on level level. Cell left[level][position] contains the number of the vertex on the level level\xe2\x80\x89+\xe2\x80\x891, which is the left child of the vertex with index (level,\xe2\x80\x89position), or it contains -1, if the vertex doesn\'t have a left child. Similarly, cell right[level][position] is responsible for the right child. You can see how the tree with n\xe2\x80\x89=\xe2\x80\x894 looks like in the notes.Serja loves to make things complicated, so he first made a tree and then added an empty set A(level,\xe2\x80\x89position) for each vertex. Then Sereja executes m operations. Each operation is of one of the two following types:  The format of the operation is ""1 t l r x"". For all vertices level,\xe2\x80\x89position (level\xe2\x80\x89=\xe2\x80\x89t; l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89position\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) add value x to set A(level,\xe2\x80\x89position).  The format of the operation is ""2 t v"". For vertex level,\xe2\x80\x89position (level\xe2\x80\x89=\xe2\x80\x89t,\xe2\x80\x89position\xe2\x80\x89=\xe2\x80\x89v), find the union of all sets of vertices that are in the subtree of vertex (level,\xe2\x80\x89position). Print the size of the union of these sets. Help Sereja execute the operations. In this problem a set contains only distinct values like std::set in C++." 2400
380A "Sereja and Prefixes" "binary search,brute force" "Sereja loves number sequences very much. That\'s why he decided to make himself a new one following a certain algorithm.Sereja takes a blank piece of paper. Then he starts writing out the sequence in m stages. Each time he either adds a new number to the end of the sequence or takes l first elements of the current sequence and adds them c times to the end. More formally, if we represent the current sequence as a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, then after we apply the described operation, the sequence transforms into a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an[,\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al] (the block in the square brackets must be repeated c times). A day has passed and Sereja has completed the sequence. He wonders what are the values of some of its elements. Help Sereja." 1600
379G "New Year Cactus" dp "Jack and Jill are tired of the New Year tree, now they\'ve got a New Year cactus at home! A cactus is a connected undirected graph where any two simple cycles have at most one common vertex. In other words, this graph doesn\'t have any edges that lie on more than one simple cycle.On the 31st of December they are going to decorate the cactus by hanging toys to its vertices. At most one toy is going to hang on each vertex \xe2\x80\x94 it\'s either the toy Jack hung or the toy Jill hung. It\'s possible for a vertex to have no toys.Jack and Jill has been arguing, so they don\'t want any edge to connect two vertices where one vertex has Jack\'s toy and the other vertex has Jill\'s toy.Jack has decided to hang a toys. What maximum number of toys b can Jill hang if they both cooperate to maximize this value? Your task is to write a program that finds the sought b for all a from 0 to the number of vertices on the New Year Cactus." 3100
379F "New Year Tree" "data structures,divide and conquer,trees" "You are a programmer and you have a New Year Tree (not the traditional fur tree, though) \xe2\x80\x94 a tree of four vertices: one vertex of degree three (has number 1), connected with three leaves (their numbers are from 2 to 4).On the New Year, programmers usually have fun. You decided to have fun as well by adding vertices to the tree. One adding operation looks as follows:  First we choose some leaf of the tree with number v.  Let\'s mark the number of vertices on the tree at this moment by variable n, then two vertexes are added to the tree, their numbers are n\xe2\x80\x89+\xe2\x80\x891 and n\xe2\x80\x89+\xe2\x80\x892, also you get new edges, one between vertices v and n\xe2\x80\x89+\xe2\x80\x891 and one between vertices v and n\xe2\x80\x89+\xe2\x80\x892. Your task is not just to model the process of adding vertices to the tree, but after each adding operation print the diameter of the current tree. Come on, let\'s solve the New Year problem!" 2400
379E "New Year Tree Decorations" geometry,schedules,sortings "Due to atheistic Soviet past, Christmas wasn\'t officially celebrated in Russia for most of the twentieth century. As a result, the Russian traditions for Christmas and New Year mixed into one event celebrated on the New Year but including the tree, a Santa-like \'Grandfather Frost\', presents and huge family reunions and dinner parties all over the country. Bying a Tree at the New Year and installing it in the house is a tradition. Usually the whole family decorates the tree on the New Year Eve. We hope that Codeforces is a big and loving family, so in this problem we are going to decorate a tree as well.So, our decoration consists of n pieces, each piece is a piece of colored paper, its border is a closed polyline of a special shape. The pieces go one by one as is shown on the picture. The i-th piece is a polyline that goes through points: (0,\xe2\x80\x890), (0,\xe2\x80\x89y0), (1,\xe2\x80\x89y1), (2,\xe2\x80\x89y2), ..., (k,\xe2\x80\x89yk), (k,\xe2\x80\x890). The width of each piece equals k.  The figure to the left shows the decoration, the figure to the right shows the individual pieces it consists of. The piece number 1 (shown red on the figure) is the outer piece (we see it completely), piece number 2 (shown yellow) follows it (we don\'t see it completely as it is partially closed by the first piece) and so on. The programmers are quite curious guys, so the moment we hung a decoration on the New Year tree we started to wonder: what area of each piece can people see?" 2500
379D "New Year Letter" "bitmasks,brute force,dp" "Many countries have such a New Year or Christmas tradition as writing a letter to Santa including a wish list for presents. Vasya is an ordinary programmer boy. Like all ordinary boys, he is going to write the letter to Santa on the New Year Eve (we Russians actually expect Santa for the New Year, not for Christmas). Vasya has come up with an algorithm he will follow while writing a letter. First he chooses two strings, s1 anf s2, consisting of uppercase English letters. Then the boy makes string sk, using a recurrent equation sn\xe2\x80\x89=\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x891, operation \'+\' means a concatenation (that is, the sequential record) of strings in the given order. Then Vasya writes down string sk on a piece of paper, puts it in the envelope and sends in to Santa. Vasya is absolutely sure that Santa will bring him the best present if the resulting string sk has exactly x occurrences of substring AC (the short-cut reminds him \xd0\xbef accepted problems). Besides, Vasya decided that string s1 should have length n, and string s2 should have length m. Vasya hasn\'t decided anything else.At the moment Vasya\'s got urgent New Year business, so he asks you to choose two strings for him, s1 and s2 in the required manner. Help Vasya." 2000
379C "New Year Ratings Change" greedy,sortings "One very well-known internet resource site (let\'s call it X) has come up with a New Year adventure. Specifically, they decided to give ratings to all visitors.There are n users on the site, for each user we know the rating value he wants to get as a New Year Present. We know that user i wants to get at least ai rating units as a present.The X site is administered by very creative and thrifty people. On the one hand, they want to give distinct ratings and on the other hand, the total sum of the ratings in the present must be as small as possible.Help site X cope with the challenging task of rating distribution. Find the optimal distribution." 1400
379B "New Year Present" "constructive algorithms,implementation" "The New Year is coming! That\'s why many people today are busy preparing New Year presents. Vasily the Programmer is no exception.Vasily knows that the best present is (no, it\'s not a contest) money. He\'s put n empty wallets from left to right in a row and decided how much money to put in what wallet. Vasily decided to put ai coins to the i-th wallet from the left.Vasily is a very busy man, so the money are sorted into the bags by his robot. Initially, the robot stands by the leftmost wallet in the row. The robot can follow instructions of three types: go to the wallet that is to the left of the current one (if such wallet exists), go to the wallet that is to the right of the current one (if such wallet exists), put a coin to the current wallet. Due to some technical malfunctions the robot cannot follow two ""put a coin"" instructions in a row.Vasily doesn\'t want to wait for long, so he wants to write a program for the robot that contains at most 106 operations (not necessarily minimum in length) the robot can use to put coins into the wallets. Help him." 1200
379A "New Year Candles" implementation "Vasily the Programmer loves romance, so this year he decided to illuminate his room with candles.Vasily has a candles.When Vasily lights up a new candle, it first burns for an hour and then it goes out. Vasily is smart, so he can make b went out candles into a new candle. As a result, this new candle can be used like any other new candle.Now Vasily wonders: for how many hours can his candles light up the room if he acts optimally well? Help him find this number." 1000
378B Semifinals implementation,sortings "Two semifinals have just been in the running tournament. Each semifinal had n participants. There are n participants advancing to the finals, they are chosen as follows: from each semifinal, we choose k people (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) who showed the best result in their semifinals and all other places in the finals go to the people who haven\'t ranked in the top k in their semifinal but got to the n\xe2\x80\x89-\xe2\x80\x892k of the best among the others.The tournament organizers hasn\'t yet determined the k value, so the participants want to know who else has any chance to get to the finals and who can go home." 1300
378A "Playing with Dice" "brute force" "Two players are playing a game. First each of them writes an integer from 1 to 6, and then a dice is thrown. The player whose written number got closer to the number on the dice wins. If both payers have the same difference, it\'s a draw.The first player wrote number a, the second player wrote number b. How many ways to throw a dice are there, at which the first player wins, or there is a draw, or the second player wins?" 800
377E "Cookie Clicker" dp,geometry "Kostya is playing the computer game Cookie Clicker. The goal of this game is to gather cookies. You can get cookies using different buildings: you can just click a special field on the screen and get the cookies for the clicks, you can buy a cookie factory, an alchemy lab, a time machine and it all will bring lots and lots of cookies.At the beginning of the game (time 0), Kostya has 0 cookies and no buildings. He has n available buildings to choose from: the i-th building is worth ci cookies and when it\'s built it brings vi cookies at the end of each second. Also, to make the game more interesting to play, Kostya decided to add a limit: at each moment of time, he can use only one building. Of course, he can change the active building each second at his discretion.It\'s important that Kostya is playing a version of the game where he can buy new buildings and change active building only at time moments that are multiples of one second. Kostya can buy new building and use it at the same time. If Kostya starts to use a building at the time moment t, he can get the first profit from it only at the time moment t\xe2\x80\x89+\xe2\x80\x891.Kostya wants to earn at least s cookies as quickly as possible. Determine the number of seconds he needs to do that." 2800
377D "Developing Game" "data structures" "Pavel is going to make a game of his dream. However, he knows that he can\'t make it on his own so he founded a development company and hired n workers of staff. Now he wants to pick n workers from the staff who will be directly responsible for developing a game.Each worker has a certain skill level vi. Besides, each worker doesn\'t want to work with the one whose skill is very different. In other words, the i-th worker won\'t work with those whose skill is less than li, and with those whose skill is more than ri.Pavel understands that the game of his dream isn\'t too hard to develop, so the worker with any skill will be equally useful. That\'s why he wants to pick a team of the maximum possible size. Help him pick such team." 2400
377C "Captains Mode" bitmasks,dp,games "Kostya is a progamer specializing in the discipline of Dota 2. Valve Corporation, the developer of this game, has recently released a new patch which turned the balance of the game upside down. Kostya, as the captain of the team, realizes that the greatest responsibility lies on him, so he wants to resort to the analysis of innovations patch from the mathematical point of view to choose the best heroes for his team in every game.A Dota 2 match involves two teams, each of them must choose some heroes that the players of the team are going to play for, and it is forbidden to choose the same hero several times, even in different teams. In large electronic sports competitions where Kostya\'s team is going to participate, the matches are held in the Captains Mode. In this mode the captains select the heroes by making one of two possible actions in a certain, predetermined order: pick or ban.  To pick a hero for the team. After the captain picks, the picked hero goes to his team (later one of a team members will play it) and can no longer be selected by any of the teams.  To ban a hero. After the ban the hero is not sent to any of the teams, but it still can no longer be selected by any of the teams. The team captain may miss a pick or a ban. If he misses a pick, a random hero is added to his team from those that were available at that moment, and if he misses a ban, no hero is banned, as if there was no ban.Kostya has already identified the strength of all the heroes based on the new patch fixes. Of course, Kostya knows the order of picks and bans. The strength of a team is the sum of the strengths of the team\'s heroes and both teams that participate in the match seek to maximize the difference in strengths in their favor. Help Kostya determine what team, the first one or the second one, has advantage in the match, and how large the advantage is." 2200
377B "Preparing for the Contest" "binary search,data structures,greedy,sortings" "Soon there will be held the world\'s largest programming contest, but the testing system still has m bugs. The contest organizer, a well-known university, has no choice but to attract university students to fix all the bugs. The university has n students able to perform such work. The students realize that they are the only hope of the organizers, so they don\'t want to work for free: the i-th student wants to get ci \'passes\' in his subjects (regardless of the volume of his work).Bugs, like students, are not the same: every bug is characterized by complexity aj, and every student has the level of his abilities bi. Student i can fix a bug j only if the level of his abilities is not less than the complexity of the bug: bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89aj, and he does it in one day. Otherwise, the bug will have to be fixed by another student. Of course, no student can work on a few bugs in one day. All bugs are not dependent on each other, so they can be corrected in any order, and different students can work simultaneously.The university wants to fix all the bugs as quickly as possible, but giving the students the total of not more than s passes. Determine which students to use for that and come up with the schedule of work saying which student should fix which bug." 1900
377A Maze "dfs and similar" "Pavel loves grid mazes. A grid maze is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle maze where each cell is either empty, or is a wall. You can go from one cell to another only if both cells are empty and have a common side.Pavel drew a grid maze with all empty cells forming a connected area. That is, you can go from any empty cell to any other one. Pavel doesn\'t like it when his maze has too little walls. He wants to turn exactly k empty cells into walls so that all the remaining cells still formed a connected area. Help him." 1600
376B I.O.U. implementation "Imagine that there is a group of three friends: A, B and \xd0\xa1. A owes B 20 rubles and B owes C 20 rubles. The total sum of the debts is 40 rubles. You can see that the debts are not organized in a very optimal manner. Let\'s rearrange them like that: assume that A owes C 20 rubles and B doesn\'t owe anything to anybody. The debts still mean the same but the total sum of the debts now equals 20 rubles.This task is a generalisation of a described example. Imagine that your group of friends has n people and you know the debts between the people. Optimize the given debts without changing their meaning. In other words, finally for each friend the difference between the total money he should give and the total money he should take must be the same. Print the minimum sum of all debts in the optimal rearrangement of the debts. See the notes to the test samples to better understand the problem." 1300
376A Lever implementation,math "You have a description of a lever as string s. We\'ll represent the string length as record |s|, then the lever looks as a horizontal bar with weights of length |s|\xe2\x80\x89-\xe2\x80\x891 with exactly one pivot. We will assume that the bar is a segment on the Ox axis between points 0 and |s|\xe2\x80\x89-\xe2\x80\x891.The decoding of the lever description is given below.  If the i-th character of the string equals ""^"", that means that at coordinate i there is the pivot under the bar.  If the i-th character of the string equals ""="", that means that at coordinate i there is nothing lying on the bar.  If the i-th character of the string equals digit c (1-9), that means that at coordinate i there is a weight of mass c on the bar. Your task is, given the lever description, print if it will be in balance or not. Assume that the bar doesn\'t weight anything. Assume that the bar initially is in balance then all weights are simultaneously put on it. After that the bar either tilts to the left, or tilts to the right, or is in balance." 900
375E "Red and Black Tree" dp,implementation,math "You have a weighted tree, consisting of n vertices. Each vertex is either painted black or is painted red. A red and black tree is called beautiful, if for any its vertex we can find a black vertex at distance at most x.The distance between two nodes is the shortest path between them.You have a red and black tree. Your task is to make it beautiful in the minimum number of color swap operations. In one color swap operation, you can choose two vertices of different colors and paint each of them the other color. In other words, if you choose a red vertex p and a black vertex q, then in one operation you are allowed to paint p black and paint q red.Print the minimum number of required actions." 3000
375D "Tree and Queries" "data structures,dfs and similar,trees" "You have a rooted tree consisting of n vertices. Each vertex of the tree has some color. We will assume that the tree vertices are numbered by integers from 1 to n. Then we represent the color of vertex v as cv. The tree root is a vertex with number 1.In this problem you need to answer to m queries. Each query is described by two integers vj,\xe2\x80\x89kj. The answer to query vj,\xe2\x80\x89kj is the number of such colors of vertices x, that the subtree of vertex vj contains at least kj vertices of color x.You can find the definition of a rooted tree by the following link: http://en.wikipedia.org/wiki/Tree_(graph_theory)." 2400
375C "Circling Round Treasures" "bitmasks,shortest paths" "You have a map as a rectangle table. Each cell of the table is either an obstacle, or a treasure with a certain price, or a bomb, or an empty cell. Your initial position is also given to you.You can go from one cell of the map to a side-adjacent one. At that, you are not allowed to go beyond the borders of the map, enter the cells with treasures, obstacles and bombs. To pick the treasures, you need to build a closed path (starting and ending in the starting cell). The closed path mustn\'t contain any cells with bombs inside. Let\'s assume that the sum of the treasures\' values that are located inside the closed path equals v, and besides, you\'ve made k single moves (from one cell to another) while you were going through the path, then such path brings you the profit of v\xe2\x80\x89-\xe2\x80\x89k rubles.Your task is to build a closed path that doesn\'t contain any bombs and brings maximum profit.Note that the path can have self-intersections. In order to determine if a cell lies inside a path or not, use the following algorithm:  Assume that the table cells are points on the plane (the table cell on the intersection of the i-th column and the j-th row is point (i,\xe2\x80\x89j)). And the given path is a closed polyline that goes through these points.  You need to find out if the point p of the table that is not crossed by the polyline lies inside the polyline.  Let\'s draw a ray that starts from point p and does not intersect other points of the table (such ray must exist).  Let\'s count the number of segments of the polyline that intersect the painted ray. If this number is odd, we assume that point p (and consequently, the table cell) lie inside the polyline (path). Otherwise, we assume that it lies outside." 2600
375B "Maximum Submatrix 2" "data structures,dp,implementation,sortings" "You are given a matrix consisting of digits zero and one, its size is n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. You are allowed to rearrange its rows. What is the maximum area of the submatrix that only consists of ones and can be obtained in the given problem by the described operations?Let\'s assume that the rows of matrix a are numbered from 1 to n from top to bottom and the columns are numbered from 1 to m from left to right. A matrix cell on the intersection of the i-th row and the j-th column can be represented as (i,\xe2\x80\x89j). Formally, a submatrix of matrix a is a group of four integers d,\xe2\x80\x89u,\xe2\x80\x89l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). We will assume that the submatrix contains cells (i,\xe2\x80\x89j) (d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u; l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). The area of the submatrix is the number of cells it contains." 1600
375A "Divisible by Seven" "math,number theory" "You have number a, whose decimal representation quite luckily contains digits 1, 6, 8, 9. Rearrange the digits in its decimal representation so that the resulting number will be divisible by 7.Number a doesn\'t contain any leading zeroes and contains digits 1, 6, 8, 9 (it also can contain another digits). The resulting number also mustn\'t contain any leading zeroes." 1600
374E "Inna and Babies" "binary search,data structures,dsu,geometry,implementation" "Inna, Dima and Sereja are in one room together. It\'s cold outside, so Sereja suggested to play a board game called ""Babies"". The babies playing board is an infinite plane containing n blue babies and m red ones. Each baby is a segment that grows in time. At time moment t the blue baby (x,\xe2\x80\x89y) is a blue segment with ends at points (x\xe2\x80\x89-\xe2\x80\x89t,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89t), (x\xe2\x80\x89+\xe2\x80\x89t,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89t). Similarly, at time t the red baby (x,\xe2\x80\x89y) is a red segment with ends at points (x\xe2\x80\x89+\xe2\x80\x89t,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89t), (x\xe2\x80\x89-\xe2\x80\x89t,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89t) of the plane. Initially, at time t\xe2\x80\x89=\xe2\x80\x890 all babies are points on the plane.The goal of the game is to find the first integer moment of time when the plane contains a rectangle of a non-zero area which sides are fully covered by some babies. A side may be covered by multiple babies. More formally, each point of each side of the rectangle should be covered by at least one baby of any color. At that, you must assume that the babies are closed segments, that is, they contain their endpoints.You are given the positions of all babies \xe2\x80\x94 help Inna and Dima to find the required moment of time." 2600
374D "Inna and Sequence" "binary search,data structures,dp,trees" "Dima\'s spent much time thinking what present to give to Inna and gave her an empty sequence w. Now they want to fill sequence w with numbers zero and one. For that, they decided to play an amusing game. Before the game begins, Dima chooses m integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89am). Then Inna and Dima start playing, that is, adding numbers to sequence w. Each new number they choose is added to the end of the sequence. At some moments of time Dima feels that the game is going to end too soon (and he wants to play with Inna as long as possible), so he hits a table hard with his fist. At that the a1-th, a2-th, a3-th, ..., ak-th numbers from the beginning simultaneously fall out of the sequence (the sequence gets k numbers less). Here k is such maximum number that value ak doesn\'t exceed the current length of the sequence. If number a1 is larger than the current length of w, then nothing falls out of the sequence.You are given the chronological sequence of events in the game. Each event is either adding a number to the end of sequence w or Dima\'s hit on the table. Calculate the sequence w after all these events happen." 2000
374C "Inna and Dima" "dfs and similar,dp,graphs,implementation" "Inna and Dima bought a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m in the shop. Each cell of the table contains a single letter: ""D"", ""I"", ""M"", ""A"".Inna loves Dima, so she wants to go through his name as many times as possible as she moves through the table. For that, Inna acts as follows:  initially, Inna chooses some cell of the table where letter ""D"" is written;  then Inna can move to some side-adjacent table cell that contains letter ""I""; then from this cell she can go to one of the side-adjacent table cells that contains the written letter ""M""; then she can go to a side-adjacent cell that contains letter ""A"". Then Inna assumes that she has gone through her sweetheart\'s name;  Inna\'s next move can be going to one of the side-adjacent table cells that contains letter ""D"" and then walk on through name DIMA in the similar manner. Inna never skips a letter. So, from the letter ""D"" she always goes to the letter ""I"", from the letter ""I"" she always goes the to letter ""M"", from the letter ""M"" she always goes to the letter ""A"", and from the letter ""A"" she always goes to the letter ""D"". Depending on the choice of the initial table cell, Inna can go through name DIMA either an infinite number of times or some positive finite number of times or she can\'t go through his name once. Help Inna find out what maximum number of times she can go through name DIMA." 1900
374B "Inna and Nine" combinatorics,greedy "Inna loves digit 9 very much. That\'s why she asked Dima to write a small number consisting of nines. But Dima must have misunderstood her and he wrote a very large number a, consisting of digits from 1 to 9.Inna wants to slightly alter the number Dima wrote so that in the end the number contained as many digits nine as possible. In one move, Inna can choose two adjacent digits in a number which sum equals 9 and replace them by a single digit 9.For instance, Inna can alter number 14545181 like this: 14545181\xe2\x80\x89\xe2\x86\x92\xe2\x80\x891945181\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89194519\xe2\x80\x89\xe2\x86\x92\xe2\x80\x8919919. Also, she can use this method to transform number 14545181 into number 19991. Inna will not transform it into 149591 as she can get numbers 19919 and 19991 which contain more digits nine.Dima is a programmer so he wants to find out how many distinct numbers containing as many digits nine as possible Inna can get from the written number. Help him with this challenging task." 1500
374A "Inna and Pink Pony" greedy,implementation "Dima and Inna are doing so great! At the moment, Inna is sitting on the magic lawn playing with a pink pony. Dima wanted to play too. He brought an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m chessboard, a very tasty candy and two numbers a and b.Dima put the chessboard in front of Inna and placed the candy in position (i,\xe2\x80\x89j) on the board. The boy said he would give the candy if it reaches one of the corner cells of the board. He\'s got one more condition. There can only be actions of the following types:  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89-\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89b);  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89+\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89b);  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89-\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89b);  move the candy from position (x,\xe2\x80\x89y) on the board to position (x\xe2\x80\x89+\xe2\x80\x89a,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89b). Naturally, Dima doesn\'t allow to move the candy beyond the chessboard borders.Inna and the pony started shifting the candy around the board. They wonder what is the minimum number of allowed actions that they need to perform to move the candy from the initial position (i,\xe2\x80\x89j) to one of the chessboard corners. Help them cope with the task!" 2000
373B "Making Sequences is Fun" "binary search,implementation,math" "We\'ll define S(n) for positive integer n as follows: the number of the n\'s digits in the decimal base. For example, S(893)\xe2\x80\x89=\xe2\x80\x893, S(114514)\xe2\x80\x89=\xe2\x80\x896.You want to make a consecutive integer sequence starting from number m (m,\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...). But you need to pay S(n)\xc2\xb7k to add the number n to the sequence.You can spend a cost up to w, and you want to make the sequence as long as possible. Write a program that tells sequence\'s maximum length." 1600
373A "Collecting Beats is Fun" implementation "Cucumber boy is fan of Kyubeat, a famous music game.Kyubeat has 16 panels for playing arranged in 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 table. When a panel lights up, he has to press that panel.Each panel has a timing to press (the preffered time when a player should press it), and Cucumber boy is able to press at most k panels in a time with his one hand. Cucumber boy is trying to press all panels in perfect timing, that is he wants to press each panel exactly in its preffered time. If he cannot press the panels with his two hands in perfect timing, his challenge to press all the panels in perfect timing will fail.You are given one scene of Kyubeat\'s panel from the music Cucumber boy is trying. Tell him is he able to press all the panels in perfect timing." 900
372E "Drawing Circles is Fun" combinatorics,geometry "There are a set of points S on the plane. This set doesn\'t contain the origin O(0,\xe2\x80\x890), and for each two distinct points in the set A and B, the triangle OAB has strictly positive area.Consider a set of pairs of points (P1,\xe2\x80\x89P2),\xe2\x80\x89(P3,\xe2\x80\x89P4),\xe2\x80\x89...,\xe2\x80\x89(P2k\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89P2k). We\'ll call the set good if and only if:  k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892.  All Pi are distinct, and each Pi is an element of S.  For any two pairs (P2i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89P2i) and (P2j\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89P2j), the circumcircles of triangles OP2i\xe2\x80\x89-\xe2\x80\x891P2j\xe2\x80\x89-\xe2\x80\x891 and OP2iP2j have a single common point, and the circumcircle of triangles OP2i\xe2\x80\x89-\xe2\x80\x891P2j and OP2iP2j\xe2\x80\x89-\xe2\x80\x891 have a single common point. Calculate the number of good sets of pairs modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 3000
372D "Choosing Subtree is Fun" "binary search,data structures,dfs and similar,trees,two pointers" "There is a tree consisting of n vertices. The vertices are numbered from 1 to n.Let\'s define the length of an interval [l,\xe2\x80\x89r] as the value r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891. The score of a subtree of this tree is the maximum length of such an interval [l,\xe2\x80\x89r] that, the vertices with numbers l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r belong to the subtree.Considering all subtrees of the tree whose size is at most k, return the maximum score of the subtree. Note, that in this problem tree is not rooted, so a subtree \xe2\x80\x94 is an arbitrary connected subgraph of the tree." 2600
372C "Watching Fireworks is Fun" "data structures,dp,math" "A festival will be held in a town\'s main street. There are n sections in the main street. The sections are numbered 1 through n from left to right. The distance between each adjacent sections is 1.In the festival m fireworks will be launched. The i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) launching is on time ti at section ai. If you are at section x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) at the time of i-th launching, you\'ll gain happiness value bi\xe2\x80\x89-\xe2\x80\x89|ai\xe2\x80\x89-\xe2\x80\x89x| (note that the happiness value might be a negative value).You can move up to d length units in a unit time interval, but it\'s prohibited to go out of the main street. Also you can be in an arbitrary section at initial time moment (time equals to 1), and want to maximize the sum of happiness that can be gained from watching fireworks. Find the maximum total happiness.Note that two or more fireworks can be launched at the same time." 2100
372B "Counting Rectangles is Fun" "brute force,divide and conquer,dp" "There is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular grid, each cell of the grid contains a single integer: zero or one. Let\'s call the cell on the i-th row and the j-th column as (i,\xe2\x80\x89j).Let\'s define a ""rectangle"" as four integers a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Rectangle denotes a set of cells of the grid {(x,\xe2\x80\x89y) :\xe2\x80\x89 a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d}. Let\'s define a ""good rectangle"" as a rectangle that includes only the cells with zeros.You should answer the following q queries: calculate the number of good rectangles all of which cells are in the given rectangle." 1900
372A "Counting Kangaroos is Fun" "binary search,greedy,sortings,two pointers" "There are n kangaroos with pockets. Each kangaroo has a size (integer number). A kangaroo can go into another kangaroo\'s pocket if and only if the size of kangaroo who hold the kangaroo is at least twice as large as the size of kangaroo who is held.Each kangaroo can hold at most one kangaroo, and the kangaroo who is held by another kangaroo cannot hold any kangaroos.The kangaroo who is held by another kangaroo cannot be visible from outside. Please, find a plan of holding kangaroos with the minimal number of kangaroos who is visible." 1600
371E "Subway Innovation" "greedy,math,two pointers" "Berland is going through tough times \xe2\x80\x94 the dirt price has dropped and that is a blow to the country\'s economy. Everybody knows that Berland is the top world dirt exporter!The President of Berland was forced to leave only k of the currently existing n subway stations.The subway stations are located on a straight line one after another, the trains consecutively visit the stations as they move. You can assume that the stations are on the Ox axis, the i-th station is at point with coordinate xi. In such case the distance between stations i and j is calculated by a simple formula |xi\xe2\x80\x89-\xe2\x80\x89xj|.Currently, the Ministry of Transport is choosing which stations to close and which ones to leave. Obviously, the residents of the capital won\'t be too enthusiastic about the innovation, so it was decided to show the best side to the people. The Ministry of Transport wants to choose such k stations that minimize the average commute time in the subway!Assuming that the train speed is constant (it is a fixed value), the average commute time in the subway is calculated as the sum of pairwise distances between stations, divided by the number of pairs (that is ) and divided by the speed of the train.Help the Minister of Transport to solve this difficult problem. Write a program that, given the location of the stations selects such k stations that the average commute time in the subway is minimized." 2000
371D Vessels "data structures,dsu,implementation,trees" "There is a system of n vessels arranged one above the other as shown in the figure below. Assume that the vessels are numbered from 1 to n, in the order from the highest to the lowest, the volume of the i-th vessel is ai liters.  Initially, all the vessels are empty. In some vessels water is poured. All the water that overflows from the i-th vessel goes to the (i\xe2\x80\x89+\xe2\x80\x891)-th one. The liquid that overflows from the n-th vessel spills on the floor.Your task is to simulate pouring water into the vessels. To do this, you will need to handle two types of queries:  Add xi liters of water to the pi-th vessel;  Print the number of liters of water in the ki-th vessel. When you reply to the second request you can assume that all the water poured up to this point, has already overflown between the vessels." 1800
371C Hamburgers "binary search,brute force" "Polycarpus loves hamburgers very much. He especially adores the hamburgers he makes with his own hands. Polycarpus thinks that there are only three decent ingredients to make hamburgers from: a bread, sausage and cheese. He writes down the recipe of his favorite ""Le Hamburger de Polycarpus"" as a string of letters \'B\' (bread), \'S\' (sausage) \xd0\xb8 \'C\' (cheese). The ingredients in the recipe go from bottom to top, for example, recipe ""\xd0\x92SCBS"" represents the hamburger where the ingredients go from bottom to top as bread, sausage, cheese, bread and sausage again.Polycarpus has nb pieces of bread, ns pieces of sausage and nc pieces of cheese in the kitchen. Besides, the shop nearby has all three ingredients, the prices are pb rubles for a piece of bread, ps for a piece of sausage and pc for a piece of cheese.Polycarpus has r rubles and he is ready to shop on them. What maximum number of hamburgers can he cook? You can assume that Polycarpus cannot break or slice any of the pieces of bread, sausage or cheese. Besides, the shop has an unlimited number of pieces of each ingredient." 1600
371B "Fox Dividing Cheese" "math,number theory" "Two little greedy bears have found two pieces of cheese in the forest of weight a and b grams, correspondingly. The bears are so greedy that they are ready to fight for the larger piece. That\'s where the fox comes in and starts the dialog: ""Little bears, wait a little, I want to make your pieces equal"" ""Come off it fox, how are you going to do that?"", the curious bears asked. ""It\'s easy"", said the fox. ""If the mass of a certain piece is divisible by two, then I can eat exactly a half of the piece. If the mass of a certain piece is divisible by three, then I can eat exactly two-thirds, and if the mass is divisible by five, then I can eat four-fifths. I\'ll eat a little here and there and make the pieces equal"". The little bears realize that the fox\'s proposal contains a catch. But at the same time they realize that they can not make the two pieces equal themselves. So they agreed to her proposal, but on one condition: the fox should make the pieces equal as quickly as possible. Find the minimum number of operations the fox needs to make pieces equal." 1300
371A "K-Periodic Array" greedy,implementation,math "This task will exclusively concentrate only on the arrays where all elements equal 1 and/or 2.Array a is k-period if its length is divisible by k and there is such array b of length k, that a is represented by array b written exactly  times consecutively. In other words, array a is k-periodic, if it has period of length k.For example, any array is n-periodic, where n is the array length. Array [2,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] is at the same time 2-periodic and 6-periodic and array [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] is at the same time 3-periodic and 9-periodic.For the given array a, consisting only of numbers one and two, find the minimum number of elements to change to make the array k-periodic. If the array already is k-periodic, then the required value equals 0." 1000
370E "Summer Reading" dp,greedy "At school Vasya got an impressive list of summer reading books. Unlike other modern schoolchildren, Vasya loves reading, so he read some book each day of the summer.As Vasya was reading books, he was making notes in the Reader\'s Diary. Each day he wrote the orderal number of the book he was reading. The books in the list are numbered starting from 1 and Vasya was reading them in the order they go in the list. Vasya never reads a new book until he finishes reading the previous one. Unfortunately, Vasya wasn\'t accurate and some days he forgot to note the number of the book and the notes for those days remained empty.As Vasya knows that the literature teacher will want to check the Reader\'s Diary, so he needs to restore the lost records. Help him do it and fill all the blanks. Vasya is sure that he spends at least two and at most five days for each book. Vasya finished reading all the books he had started. Assume that the reading list contained many books. So many, in fact, that it is impossible to read all of them in a summer. If there are multiple valid ways to restore the diary records, Vasya prefers the one that shows the maximum number of read books." 2500
370D "Broken Monitor" "brute force,constructive algorithms,greedy,implementation" "Innocentius has a problem \xe2\x80\x94 his computer monitor has broken. Now some of the pixels are ""dead"", that is, they are always black. As consequence, Innocentius can\'t play the usual computer games. He is recently playing the following game with his younger brother Polycarpus.Innocentius is touch-typing a program that paints a white square one-pixel wide frame on the black screen. As the monitor is broken, some pixels that should be white remain black. Polycarpus should look at what the program displayed on the screen and guess the position and size of the frame Innocentius has painted. Polycarpus doesn\'t like the game but Innocentius persuaded brother to play as ""the game is good for the imagination and attention"".Help Polycarpus, automatize his part in the gaming process. Write the code that finds such possible square frame that:  the frame\'s width is 1 pixel,  the frame doesn\'t go beyond the borders of the screen,  all white pixels of the monitor are located on the frame,  of all frames that satisfy the previous three conditions, the required frame must have the smallest size. Formally, a square frame is represented by such pixels of the solid square, that are on the square\'s border, that is, are not fully surrounded by the other pixels of the square. For example, if the frame\'s size is d\xe2\x80\x89=\xe2\x80\x893, then it consists of 8 pixels, if its size is d\xe2\x80\x89=\xe2\x80\x892, then it contains 4 pixels and if d\xe2\x80\x89=\xe2\x80\x891, then the frame is reduced to a single pixel." 2100
370C Mittens "constructive algorithms,greedy,sortings" "A Christmas party in city S. had n children. All children came in mittens. The mittens can be of different colors, but each child had the left and the right mitten of the same color. Let\'s say that the colors of the mittens are numbered with integers from 1 to m, and the children are numbered from 1 to n. Then the i-th child has both mittens of color ci.The Party had Santa Claus (\'Father Frost\' in Russian), his granddaughter Snow Girl, the children danced around the richly decorated Christmas tree. In fact, everything was so bright and diverse that the children wanted to wear mittens of distinct colors. The children decided to swap the mittens so that each of them got one left and one right mitten in the end, and these two mittens were of distinct colors. All mittens are of the same size and fit all the children.The children started exchanging the mittens haphazardly, but they couldn\'t reach the situation when each child has a pair of mittens of distinct colors. Vasily Petrov, the dad of one of the children, noted that in the general case the children\'s idea may turn out impossible. Besides, he is a mathematician and he came up with such scheme of distributing mittens that the number of children that have distinct-colored mittens was maximum. You task is to repeat his discovery. Note that the left and right mittens are different: each child must end up with one left and one right mitten." 1800
370B "Berland Bingo" implementation "Lately, a national version of a bingo game has become very popular in Berland. There are n players playing the game, each player has a card with numbers. The numbers on each card are distinct, but distinct cards can have equal numbers. The card of the i-th player contains mi numbers.During the game the host takes numbered balls one by one from a bag. He reads the number aloud in a high and clear voice and then puts the ball away. All participants cross out the number if it occurs on their cards. The person who crosses out all numbers from his card first, wins. If multiple people cross out all numbers from their cards at the same time, there are no winners in the game. At the beginning of the game the bag contains 100 balls numbered 1 through 100, the numbers of all balls are distinct.You are given the cards for each player. Write a program that determines whether a player can win the game at the most favorable for him scenario or not." 1300
370A "Rook, Bishop and King" "graphs,math,shortest paths" "Little Petya is learning to play chess. He has already learned how to move a king, a rook and a bishop. Let us remind you the rules of moving chess pieces. A chessboard is 64 square fields organized into an 8\xe2\x80\x89\xc3\x97\xe2\x80\x898 table. A field is represented by a pair of integers (r,\xe2\x80\x89c) \xe2\x80\x94 the number of the row and the number of the column (in a classical game the columns are traditionally indexed by letters). Each chess piece takes up exactly one field. To make a move is to move a chess piece, the pieces move by the following rules:  A rook moves any number of fields horizontally or vertically.  A bishop moves any number of fields diagonally.  A king moves one field in any direction \xe2\x80\x94 horizontally, vertically or diagonally.   The pieces move like that Petya is thinking about the following problem: what minimum number of moves is needed for each of these pieces to move from field (r1,\xe2\x80\x89c1) to field (r2,\xe2\x80\x89c2)? At that, we assume that there are no more pieces besides this one on the board. Help him solve this problem." 1100
369E "Valera and Queries" "binary search,data structures" "Valera loves segments. He has recently come up with one interesting problem.The Ox axis of coordinates has n segments, the i-th segment starts in position li and ends in position ri (we will mark it as [li,\xe2\x80\x89ri]). Your task is to process m queries, each consists of number cnti and a set of cnti coordinates of points located on the Ox axis. The answer to the query is the number of segments, such that each of them contains at least one point from the query. Segment [l,\xe2\x80\x89r] contains point q, if l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Valera found the solution of this problem too difficult. So he asked you to help him. Help Valera." 2200
369D "Valera and Fools" "dfs and similar,dp,graphs,shortest paths" "One fine morning, n fools lined up in a row. After that, they numbered each other with numbers from 1 to n, inclusive. Each fool got a unique number. The fools decided not to change their numbers before the end of the fun.Every fool has exactly k bullets and a pistol. In addition, the fool number i has probability of pi (in percent) that he kills the fool he shoots at.The fools decided to have several rounds of the fun. Each round of the fun looks like this: each currently living fool shoots at another living fool with the smallest number (a fool is not stupid enough to shoot at himself). All shots of the round are perfomed at one time (simultaneously). If there is exactly one living fool, he does not shoot.Let\'s define a situation as the set of numbers of all the living fools at the some time. We say that a situation is possible if for some integer number j (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) there is a nonzero probability that after j rounds of the fun this situation will occur.Valera knows numbers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn and k. Help Valera determine the number of distinct possible situations." 2200
369C "Valera and Elections" "dfs and similar,graphs,trees" "The city Valera lives in is going to hold elections to the city Parliament.The city has n districts and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. We know that from any district there is a path along the roads to any other district. Let\'s enumerate all districts in some way by integers from 1 to n, inclusive. Furthermore, for each road the residents decided if it is the problem road or not. A problem road is a road that needs to be repaired.There are n candidates running the elections. Let\'s enumerate all candidates in some way by integers from 1 to n, inclusive. If the candidate number i will be elected in the city Parliament, he will perform exactly one promise \xe2\x80\x94 to repair all problem roads on the way from the i-th district to the district 1, where the city Parliament is located.Help Valera and determine the subset of candidates such that if all candidates from the subset will be elected to the city Parliament, all problem roads in the city will be repaired. If there are several such subsets, you should choose the subset consisting of the minimum number of candidates." 1600
369B "Valera and Contest" "constructive algorithms,implementation,math" "Valera loves to participate in competitions. Especially in programming contests. Today he has participated in the contest with his team, consisting of n students (including Valera). This contest was an individual competition, so each student in the team solved problems individually.After the contest was over, Valera was interested in results. He found out that:  each student in the team scored at least l points and at most r points;  in total, all members of the team scored exactly sall points;  the total score of the k members of the team who scored the most points is equal to exactly sk; more formally, if a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is the sequence of points earned by the team of students in the non-increasing order (a1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89an), then sk\xe2\x80\x89=\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ak. However, Valera did not find out exactly how many points each of n students scored. Valera asked you to recover any distribution of scores between the students of the team, such that all the conditions above are met." 1400
369A "Valera and Plates" greedy,implementation "Valera is a lazy student. He has m clean bowls and k clean plates. Valera has made an eating plan for the next n days. As Valera is lazy, he will eat exactly one dish per day. At that, in order to eat a dish, he needs exactly one clean plate or bowl. We know that Valera can cook only two types of dishes. He can eat dishes of the first type from bowls and dishes of the second type from either bowls or plates. When Valera finishes eating, he leaves a dirty plate/bowl behind. His life philosophy doesn\'t let him eat from dirty kitchenware. So sometimes he needs to wash his plate/bowl before eating. Find the minimum number of times Valera will need to wash a plate/bowl, if he acts optimally." 900
368B "Sereja and Suffixes" "data structures,dp" "Sereja has an array a, consisting of n integers a1, a2, ..., an. The boy cannot sit and do nothing, he decided to study an array. Sereja took a piece of paper and wrote out m integers l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lm (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each number li he wants to know how many distinct numbers are staying on the positions li, li\xe2\x80\x89+\xe2\x80\x891, ..., n. Formally, he want to find the number of distinct numbers among ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an.?Sereja wrote out the necessary array elements but the array was so large and the boy was so pressed for time. Help him, find the answer for the described question for each li." 1100
368A "Sereja and Coat Rack" implementation "Sereja owns a restaurant for n people. The restaurant hall has a coat rack with n hooks. Each restaurant visitor can use a hook to hang his clothes on it. Using the i-th hook costs ai rubles. Only one person can hang clothes on one hook.Tonight Sereja expects m guests in the restaurant. Naturally, each guest wants to hang his clothes on an available hook with minimum price (if there are multiple such hooks, he chooses any of them). However if the moment a guest arrives the rack has no available hooks, Sereja must pay a d ruble fine to the guest. Help Sereja find out the profit in rubles (possibly negative) that he will get tonight. You can assume that before the guests arrive, all hooks on the rack are available, all guests come at different time, nobody besides the m guests is visiting Sereja\'s restaurant tonight." 1000
367E "Sereja and Intervals" combinatorics,dp "Sereja is interested in intervals of numbers, so he has prepared a problem about intervals for you. An interval of numbers is a pair of integers [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Interval [l1,\xe2\x80\x89r1] belongs to interval [l2,\xe2\x80\x89r2] if the following condition is met: l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2.Sereja wants to write out a sequence of n intervals [l1,\xe2\x80\x89r1], [l2,\xe2\x80\x89r2], ..., [ln,\xe2\x80\x89rn] on a piece of paper. At that, no interval in the sequence can belong to some other interval of the sequence. Also, Sereja loves number x very much and he wants some (at least one) interval in the sequence to have li\xe2\x80\x89=\xe2\x80\x89x. Sereja wonders, how many distinct ways to write such intervals are there?Help Sereja and find the required number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Two ways are considered distinct if there is such j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), that the j-th intervals in two corresponding sequences are not equal." 2700
367D "Sereja and Sets" "bitmasks,dfs and similar" "Sereja has m non-empty sets of integers A1,\xe2\x80\x89A2,\xe2\x80\x89...,\xe2\x80\x89Am. What a lucky coincidence! The given sets are a partition of the set of all integers from 1 to n. In other words, for any integer v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) there is exactly one set At such that . Also Sereja has integer d.Sereja decided to choose some sets from the sets he has. Let\'s suppose that i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) are indexes of the chosen sets. Then let\'s define an array of integers b, sorted in ascending order, as a union of the chosen sets, that is, . We\'ll represent the element with number j in this array (in ascending order) as bj. Sereja considers his choice of sets correct, if the following conditions are met:b1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d; bi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89|b|); n\xe2\x80\x89-\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b|b|.Sereja wants to know what is the minimum number of sets (k) that he can choose so that his choice will be correct. Help him with that." 2400
367C "Sereja and the Arrangement of Numbers" graphs,greedy,sortings "Let\'s call an array consisting of n integer numbers a1, a2, ..., an, beautiful if it has the following property:  consider all pairs of numbers x,\xe2\x80\x89y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y), such that number x occurs in the array a and number y occurs in the array a;  for each pair x,\xe2\x80\x89y must exist some position j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89n), such that at least one of the two conditions are met, either aj\xe2\x80\x89=\xe2\x80\x89x,\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89y, or aj\xe2\x80\x89=\xe2\x80\x89y,\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89x. Sereja wants to build a beautiful array a, consisting of n integers. But not everything is so easy, Sereja\'s friend Dima has m coupons, each contains two integers qi,\xe2\x80\x89wi. Coupon i costs wi and allows you to use as many numbers qi as you want when constructing the array a. Values qi are distinct. Sereja has no coupons, so Dima and Sereja have made the following deal. Dima builds some beautiful array a of n elements. After that he takes wi rubles from Sereja for each qi, which occurs in the array a. Sereja believed his friend and agreed to the contract, and now he is wondering, what is the maximum amount of money he can pay.Help Sereja, find the maximum amount of money he can pay to Dima." 2000
367B "Sereja ans Anagrams" "binary search,data structures" "Sereja has two sequences a and b and number p. Sequence a consists of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Similarly, sequence b consists of m integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. As usual, Sereja studies the sequences he has. Today he wants to find the number of positions q (q\xe2\x80\x89+\xe2\x80\x89(m\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; q\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891), such that sequence b can be obtained from sequence aq,\xe2\x80\x89aq\xe2\x80\x89+\xe2\x80\x89p,\xe2\x80\x89aq\xe2\x80\x89+\xe2\x80\x892p,\xe2\x80\x89...,\xe2\x80\x89aq\xe2\x80\x89+\xe2\x80\x89(m\xe2\x80\x89-\xe2\x80\x891)p by rearranging elements.Sereja needs to rush to the gym, so he asked to find all the described positions of q." 1900
367A "Sereja and Algorithm" "data structures,implementation" "Sereja loves all sorts of algorithms. He has recently come up with a new algorithm, which receives a string as an input. Let\'s represent the input string of the algorithm as q\xe2\x80\x89=\xe2\x80\x89q1q2... qk. The algorithm consists of two steps:  Find any continuous subsequence (substring) of three characters of string q, which doesn\'t equal to either string ""zyx"", ""xzy"", ""yxz"". If q doesn\'t contain any such subsequence, terminate the algorithm, otherwise go to step 2.  Rearrange the letters of the found subsequence randomly and go to step 1. Sereja thinks that the algorithm works correctly on string q if there is a non-zero probability that the algorithm will be terminated. But if the algorithm anyway will work for infinitely long on a string, then we consider the algorithm to work incorrectly on this string.Sereja wants to test his algorithm. For that, he has string s\xe2\x80\x89=\xe2\x80\x89s1s2... sn, consisting of n characters. The boy conducts a series of m tests. As the i-th test, he sends substring slisli\xe2\x80\x89+\xe2\x80\x891... sri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) to the algorithm input. Unfortunately, the implementation of his algorithm works too long, so Sereja asked you to help. For each test (li,\xe2\x80\x89ri) determine if the algorithm works correctly on this test or not." 1500
366E "Dima and Magic Guitar" "brute force,implementation,math" "Dima loves Inna very much. He decided to write a song for her. Dima has a magic guitar with n strings and m frets. Dima makes the guitar produce sounds like that: to play a note, he needs to hold one of the strings on one of the frets and then pull the string. When Dima pulls the i-th string holding it on the j-th fret the guitar produces a note, let\'s denote it as aij. We know that Dima\'s guitar can produce k distinct notes. It is possible that some notes can be produced in multiple ways. In other words, it is possible that aij\xe2\x80\x89=\xe2\x80\x89apq at (i,\xe2\x80\x89j)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89(p,\xe2\x80\x89q).Dima has already written a song \xe2\x80\x94 a sequence of s notes. In order to play the song, you need to consecutively produce the notes from the song on the guitar. You can produce each note in any available way. Dima understood that there are many ways to play a song and he wants to play it so as to make the song look as complicated as possible (try to act like Cobein).We\'ll represent a way to play a song as a sequence of pairs (xi,\xe2\x80\x89yi) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s), such that the xi-th string on the yi-th fret produces the i-th note from the song. The complexity of moving between pairs (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) equals  + . The complexity of a way to play a song is the maximum of complexities of moving between adjacent pairs.Help Dima determine the maximum complexity of the way to play his song! The guy\'s gotta look cool!" 2200
366D "Dima and Trap Graph" "binary search,data structures,dfs and similar,dsu,shortest paths,two pointers" "Dima and Inna love spending time together. The problem is, Seryozha isn\'t too enthusiastic to leave his room for some reason. But Dima and Inna love each other so much that they decided to get criminal...Dima constructed a trap graph. He shouted: ""Hey Seryozha, have a look at my cool graph!"" to get his roommate interested and kicked him into the first node.A trap graph is an undirected graph consisting of n nodes and m edges. For edge number k, Dima denoted a range of integers from lk to rk (lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk). In order to get out of the trap graph, Seryozha initially (before starting his movements) should pick some integer (let\'s call it x), then Seryozha must go some way from the starting node with number 1 to the final node with number n. At that, Seryozha can go along edge k only if lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk.Seryozha is a mathematician. He defined the loyalty of some path from the 1-st node to the n-th one as the number of integers x, such that if he initially chooses one of them, he passes the whole path. Help Seryozha find the path of maximum loyalty and return to his room as quickly as possible!" 2000
366C "Dima and Salad" dp "Dima, Inna and Seryozha have gathered in a room. That\'s right, someone\'s got to go. To cheer Seryozha up and inspire him to have a walk, Inna decided to cook something. Dima and Seryozha have n fruits in the fridge. Each fruit has two parameters: the taste and the number of calories. Inna decided to make a fruit salad, so she wants to take some fruits from the fridge for it. Inna follows a certain principle as she chooses the fruits: the total taste to the total calories ratio of the chosen fruits must equal k. In other words,  , where aj is the taste of the j-th chosen fruit and bj is its calories.Inna hasn\'t chosen the fruits yet, she is thinking: what is the maximum taste of the chosen fruits if she strictly follows her principle? Help Inna solve this culinary problem \xe2\x80\x94 now the happiness of a young couple is in your hands!Inna loves Dima very much so she wants to make the salad from at least one fruit." 1900
366B "Dima and To-do List" "brute force,implementation" "You helped Dima to have a great weekend, but it\'s time to work. Naturally, Dima, as all other men who have girlfriends, does everything wrong.Inna and Dima are now in one room. Inna tells Dima off for everything he does in her presence. After Inna tells him off for something, she goes to another room, walks there in circles muttering about how useless her sweetheart is. During that time Dima has time to peacefully complete k\xe2\x80\x89-\xe2\x80\x891 tasks. Then Inna returns and tells Dima off for the next task he does in her presence and goes to another room again. It continues until Dima is through with his tasks.Overall, Dima has n tasks to do, each task has a unique number from 1 to n. Dima loves order, so he does tasks consecutively, starting from some task. For example, if Dima has 6 tasks to do in total, then, if he starts from the 5-th task, the order is like that: first Dima does the 5-th task, then the 6-th one, then the 1-st one, then the 2-nd one, then the 3-rd one, then the 4-th one.Inna tells Dima off (only lovingly and appropriately!) so often and systematically that he\'s very well learned the power with which she tells him off for each task. Help Dima choose the first task so that in total he gets told off with as little power as possible." 1200
366A "Dima and Guards" implementation "Nothing has changed since the last round. Dima and Inna still love each other and want to be together. They\'ve made a deal with Seryozha and now they need to make a deal with the dorm guards...There are four guardposts in Dima\'s dorm. Each post contains two guards (in Russia they are usually elderly women). You can bribe a guard by a chocolate bar or a box of juice. For each guard you know the minimum price of the chocolate bar she can accept as a gift and the minimum price of the box of juice she can accept as a gift. If a chocolate bar for some guard costs less than the minimum chocolate bar price for this guard is, or if a box of juice for some guard costs less than the minimum box of juice price for this guard is, then the guard doesn\'t accept such a gift.In order to pass through a guardpost, one needs to bribe both guards.The shop has an unlimited amount of juice and chocolate of any price starting with 1. Dima wants to choose some guardpost, buy one gift for each guard from the guardpost and spend exactly n rubles on it.Help him choose a post through which he can safely sneak Inna or otherwise say that this is impossible. Mind you, Inna would be very sorry to hear that!" 1100
365B "The Fibonacci Segment" implementation "You have array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Segment [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is good if ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x892, for all i (l\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r).Let\'s define len([l,\xe2\x80\x89r])\xe2\x80\x89=\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891, len([l,\xe2\x80\x89r]) is the length of the segment [l,\xe2\x80\x89r]. Segment [l1,\xe2\x80\x89r1], is longer than segment [l2,\xe2\x80\x89r2], if len([l1,\xe2\x80\x89r1])\xe2\x80\x89>\xe2\x80\x89len([l2,\xe2\x80\x89r2]).Your task is to find a good segment of the maximum length in array a. Note that a segment of length 1 or 2 is always good." 1100
365A "Good Number" implementation "Let\'s call a number k-good if it contains all digits not exceeding k (0,\xe2\x80\x89...,\xe2\x80\x89k). You\'ve got a number k and an array a containing n numbers. Find out how many k-good numbers are in a (count each number every time it occurs in array a)." 1100
364E "Empty Rectangles" "divide and conquer,two pointers" "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table (n rows and m columns), each cell of the table contains a ""0"" or a ""1"".Your task is to calculate the number of rectangles with the sides that are parallel to the sides of the table and go along the cell borders, such that the number one occurs exactly k times in the rectangle." 3000
364D Ghd "brute force,math,probabilities" "John Doe offered his sister Jane Doe find the gcd of some set of numbers a.Gcd is a positive integer g, such that all number from the set are evenly divisible by g and there isn\'t such g\' (g\'\xe2\x80\x89>\xe2\x80\x89g), that all numbers of the set are evenly divisible by g\'.Unfortunately Jane couldn\'t cope with the task and John offered her to find the ghd of the same subset of numbers.Ghd is a positive integer g, such that at least half of numbers from the set are evenly divisible by g and there isn\'t such g\' (g\'\xe2\x80\x89>\xe2\x80\x89g) that at least half of the numbers from the set are evenly divisible by g\'.Jane coped with the task for two hours. Please try it, too." 2900
364C "Beautiful Set" "brute force,number theory" "We\'ll call a set of positive integers a beautiful if the following condition fulfills: for any prime p, if , then . In other words, if one number from the set is divisible by prime p, then at least half of numbers from the set is divisible by p.Your task is to find any beautiful set, where the number of elements is equal to k and each element doesn\'t exceed 2k2." 2300
364B "Free Market" dp,greedy "John Doe has recently found a ""Free Market"" in his city \xe2\x80\x94 that is the place where you can exchange some of your possessions for other things for free. John knows that his city has n items in total (each item is unique). You can bring any number of items to the market and exchange them for any other one. Note that each item is one of a kind and that means that you cannot exchange set {a,\xe2\x80\x89b} for set {v,\xe2\x80\x89a}. However, you can always exchange set x for any set y, unless there is item p, such that p occurs in x and p occurs in y.For each item, John knows its value ci. John\'s sense of justice doesn\'t let him exchange a set of items x for a set of items y, if s(x)\xe2\x80\x89+\xe2\x80\x89d\xe2\x80\x89<\xe2\x80\x89s(y) (s(x) is the total price of items in the set x). During one day John can exchange only one set of items for something else. Initially, he has no items. John wants to get a set of items with the maximum total price. Find the cost of such set and the minimum number of days John can get it in." 2200
364A Matrix "combinatorics,data structures,implementation" "You have a string of decimal digits s. Let\'s define bij\xe2\x80\x89=\xe2\x80\x89si\xc2\xb7sj. Find in matrix b the number of such rectangles that the sum bij for all cells (i,\xe2\x80\x89j) that are the elements of the rectangle equals a in each rectangle.A rectangle in a matrix is a group of four integers (x,\xe2\x80\x89y,\xe2\x80\x89z,\xe2\x80\x89t) (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t). The elements of the rectangle are all cells (i,\xe2\x80\x89j) such that x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y,\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t." 1600
363E "Two Circles" "brute force,data structures,implementation" "Let\'s assume that we are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table filled by integers. We\'ll mark a cell in the i-th row and j-th column as (i,\xe2\x80\x89j). Thus, (1,\xe2\x80\x891) is the upper left cell of the table and (n,\xe2\x80\x89m) is the lower right cell. We\'ll assume that a circle of radius r with the center in cell (i0,\xe2\x80\x89j0) is a set of such cells (i,\xe2\x80\x89j) that . We\'ll consider only the circles that do not go beyond the limits of the table, that is, for which r\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89r and r\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89r.    A circle of radius 3 with the center at (4,\xe2\x80\x895). Find two such non-intersecting circles of the given radius r that the sum of numbers in the cells that belong to these circles is maximum. Two circles intersect if there is a cell that belongs to both circles. As there can be more than one way to choose a pair of circles with the maximum sum, we will also be interested in the number of such pairs. Calculate the number of unordered pairs of circles, for instance, a pair of circles of radius 2 with centers at (3,\xe2\x80\x894) and (7,\xe2\x80\x897) is the same pair as the pair of circles of radius 2 with centers at (7,\xe2\x80\x897) and (3,\xe2\x80\x894)." 2500
363D "Renting Bikes" "binary search,greedy" "A group of n schoolboys decided to ride bikes. As nobody of them has a bike, the boys need to rent them.The renting site offered them m bikes. The renting price is different for different bikes, renting the j-th bike costs pj rubles.In total, the boys\' shared budget is a rubles. Besides, each of them has his own personal money, the i-th boy has bi personal rubles. The shared budget can be spent on any schoolchildren arbitrarily, but each boy\'s personal money can be spent on renting only this boy\'s bike.Each boy can rent at most one bike, one cannot give his bike to somebody else.What maximum number of schoolboys will be able to ride bikes? What minimum sum of personal money will they have to spend in total to let as many schoolchildren ride bikes as possible?" 1800
363C "Fixing Typos" greedy,implementation "Many modern text editors automatically check the spelling of the user\'s text. Some editors even suggest how to correct typos.In this problem your task to implement a small functionality to correct two types of typos in a word. We will assume that three identical letters together is a typo (for example, word ""helllo"" contains a typo). Besides, a couple of identical letters immediately followed by another couple of identical letters is a typo too (for example, words ""helloo"" and ""wwaatt"" contain typos).Write a code that deletes the minimum number of letters from a word, correcting described typos in the word. You are allowed to delete letters from both ends and from the middle of the word." 1400
363B Fence "brute force,dp" "There is a fence in front of Polycarpus\'s home. The fence consists of n planks of the same width which go one after another from left to right. The height of the i-th plank is hi meters, distinct planks can have distinct heights.  Fence for n\xe2\x80\x89=\xe2\x80\x897 and h\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x896,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x897,\xe2\x80\x891] Polycarpus has bought a posh piano and is thinking about how to get it into the house. In order to carry out his plan, he needs to take exactly k consecutive planks from the fence. Higher planks are harder to tear off the fence, so Polycarpus wants to find such k consecutive planks that the sum of their heights is minimal possible.Write the program that finds the indexes of k consecutive planks with minimal total height. Pay attention, the fence is not around Polycarpus\'s home, it is in front of home (in other words, the fence isn\'t cyclic)." 1100
363A Soroban implementation "You know that Japan is the country with almost the largest \'electronic devices per person\' ratio. So you might be quite surprised to find out that the primary school in Japan teaches to count using a Soroban \xe2\x80\x94 an abacus developed in Japan. This phenomenon has its reasons, of course, but we are not going to speak about them. Let\'s have a look at the Soroban\'s construction.  Soroban consists of some number of rods, each rod contains five beads. We will assume that the rods are horizontal lines. One bead on each rod (the leftmost one) is divided from the others by a bar (the reckoning bar). This single bead is called go-dama and four others are ichi-damas. Each rod is responsible for representing a single digit from 0 to 9. We can obtain the value of a digit by following simple algorithm:  Set the value of a digit equal to 0.  If the go-dama is shifted to the right, add 5.  Add the number of ichi-damas shifted to the left. Thus, the upper rod on the picture shows digit 0, the middle one shows digit 2 and the lower one shows 7. We will consider the top rod to represent the last decimal digit of a number, so the picture shows number 720.Write the program that prints the way Soroban shows the given number n." 800
362E "Petya and Pipes" "flows,graphs,shortest paths" "A little boy Petya dreams of growing up and becoming the Head Berland Plumber. He is thinking of the problems he will have to solve in the future. Unfortunately, Petya is too inexperienced, so you are about to solve one of such problems for Petya, the one he\'s the most interested in.The Berland capital has n water tanks numbered from 1 to n. These tanks are connected by unidirectional pipes in some manner. Any pair of water tanks is connected by at most one pipe in each direction. Each pipe has a strictly positive integer width. Width determines the number of liters of water per a unit of time this pipe can transport. The water goes to the city from the main water tank (its number is 1). The water must go through some pipe path and get to the sewer tank with cleaning system (its number is n). Petya wants to increase the width of some subset of pipes by at most k units in total so that the width of each pipe remains integer. Help him determine the maximum amount of water that can be transmitted per a unit of time from the main tank to the sewer tank after such operation is completed." 2300
362D "Fools and Foolproof Roads" "data structures,dfs and similar,dsu,graphs,greedy" "You must have heard all about the Foolland on your Geography lessons. Specifically, you must know that federal structure of this country has been the same for many centuries. The country consists of n cities, some pairs of cities are connected by bidirectional roads, each road is described by its length li.The fools lived in their land joyfully, but a recent revolution changed the king. Now the king is Vasily the Bear. Vasily divided the country cities into regions, so that any two cities of the same region have a path along the roads between them and any two cities of different regions don\'t have such path. Then Vasily decided to upgrade the road network and construct exactly p new roads in the country. Constructing a road goes like this:  We choose a pair of distinct cities u, v that will be connected by a new road (at that, it is possible that there already is a road between these cities).  We define the length of the new road: if cities u, v belong to distinct regions, then the length is calculated as min(109,\xe2\x80\x89S\xe2\x80\x89+\xe2\x80\x891) (S \xe2\x80\x94 the total length of all roads that exist in the linked regions), otherwise we assume that the length equals 1000.  We build a road of the specified length between the chosen cities. If the new road connects two distinct regions, after construction of the road these regions are combined into one new region. Vasily wants the road constructing process to result in the country that consists exactly of q regions. Your task is to come up with such road constructing plan for Vasily that it meets the requirement and minimizes the total length of the built roads." 2100
362C "Insertion Sort" "data structures,dp,implementation,math" "Petya is a beginner programmer. He has already mastered the basics of the C++ language and moved on to learning algorithms. The first algorithm he encountered was insertion sort. Petya has already written the code that implements this algorithm and sorts the given integer zero-indexed array a of size n in the non-decreasing order. for (int i = 1; i < n; i = i + 1){   int j = i;    while (j > 0 && a[j] < a[j - 1])   {      swap(a[j], a[j - 1]); // swap elements a[j] and a[j - 1]      j = j - 1;   }}Petya uses this algorithm only for sorting of arrays that are permutations of numbers from 0 to n\xe2\x80\x89-\xe2\x80\x891. He has already chosen the permutation he wants to sort but he first decided to swap some two of its elements. Petya wants to choose these elements in such a way that the number of times the sorting executes function swap, was minimum. Help Petya find out the number of ways in which he can make the swap and fulfill this requirement.It is guaranteed that it\'s always possible to swap two elements of the input permutation in such a way that the number of swap function calls decreases." 1900
362B "Petya and Staircases" implementation,sortings "Little boy Petya loves stairs very much. But he is bored from simple going up and down them \xe2\x80\x94 he loves jumping over several stairs at a time. As he stands on some stair, he can either jump to the next one or jump over one or two stairs at a time. But some stairs are too dirty and Petya doesn\'t want to step on them.Now Petya is on the first stair of the staircase, consisting of n stairs. He also knows the numbers of the dirty stairs of this staircase. Help Petya find out if he can jump through the entire staircase and reach the last stair number n without touching a dirty stair once.One has to note that anyway Petya should step on the first and last stairs, so if the first or the last stair is dirty, then Petya cannot choose a path with clean steps only." 1100
362A "Two Semiknights Meet" greedy,math "A boy Petya loves chess very much. He even came up with a chess piece of his own, a semiknight. The semiknight can move in any of these four directions: 2 squares forward and 2 squares to the right, 2 squares forward and 2 squares to the left, 2 squares backward and 2 to the right and 2 squares backward and 2 to the left. Naturally, the semiknight cannot move beyond the limits of the chessboard.Petya put two semiknights on a standard chessboard. Petya simultaneously moves with both semiknights. The squares are rather large, so after some move the semiknights can meet, that is, they can end up in the same square. After the meeting the semiknights can move on, so it is possible that they meet again. Petya wonders if there is such sequence of moves when the semiknights meet. Petya considers some squares bad. That is, they do not suit for the meeting. The semiknights can move through these squares but their meetings in these squares don\'t count.Petya prepared multiple chess boards. Help Petya find out whether the semiknights can meet on some good square for each board.Please see the test case analysis." 1500
361B "Levko and Permutation" "constructive algorithms,math,number theory" "Levko loves permutations very much. A permutation of length n is a sequence of distinct positive integers, each is at most n.Let\xe2\x80\x99s assume that value gcd(a,\xe2\x80\x89b) shows the greatest common divisor of numbers a and b. Levko assumes that element pi of permutation p1,\xe2\x80\x89p2,\xe2\x80\x89... ,\xe2\x80\x89pn is good if gcd(i,\xe2\x80\x89pi)\xe2\x80\x89>\xe2\x80\x891. Levko considers a permutation beautiful, if it has exactly k good elements. Unfortunately, he doesn\xe2\x80\x99t know any beautiful permutation. Your task is to help him to find at least one of them." 1200
361A "Levko and Table" "constructive algorithms,implementation" "Levko loves tables that consist of n rows and n columns very much. He especially loves beautiful tables. A table is beautiful to Levko if the sum of elements in each row and column of the table equals k.Unfortunately, he doesn\'t know any such table. Your task is to help him to find at least one of them." 800
360E "Levko and Game" "graphs,greedy,shortest paths" "Levko loves sports pathfinding competitions in his city very much. In order to boost his performance, Levko spends his spare time practicing. The practice is a game.The city consists of n intersections connected by m\xe2\x80\x89+\xe2\x80\x89k directed roads. Two or more roads can connect the same pair of intersections. Besides, there can be roads leading from an intersection to itself. Levko and Zenyk are playing a game. First Levko stands on intersection s1, and Zenyk stands on intersection s2. They both want to get to intersection f. The person who does it quicker wins. If they get there at the same time, the game ends with a draw. By agreement both players start simultaneously and move with the same speed.Levko wants to win very much. He knows the lengths of all the roads in the city. Also he knows that he can change the lengths of some roads (there are k such roads at all) if he pays the government. So, the government can change the length of the i-th road to any integer value in the segment [li, ri] (both borders inclusive). Levko wondered if he can reconstruct the roads so as to win the game and whether he can hope for the draw if he cannot win.You should consider that both players play optimally well. It is guaranteed that we can get from intersections s1 and s2 to intersection f." 2800
360D "Levko and Sets" "number theory" "Levko loves all sorts of sets very much.Levko has two arrays of integers a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89... ,\xe2\x80\x89bm and a prime number p. Today he generates n sets. Let\'s describe the generation process for the i-th set:  First it has a single number 1.  Let\'s take any element c from this set. For all j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) if number (c\xc2\xb7aibj) mod p doesn\'t occur in the set, then add it to the set.  Repeat step 2 as long as we can add at least one element to our set. Levko wonders, how many numbers belong to at least one set. That is, he wants to know what size is the union of n generated sets." 2600
360C "Levko and Strings" combinatorics,dp "Levko loves strings of length n, consisting of lowercase English letters, very much. He has one such string s. For each string t of length n, Levko defines its beauty relative to s as the number of pairs of indexes i, j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that substring t[i..j] is lexicographically larger than substring s[i..j].The boy wondered how many strings t are there, such that their beauty relative to s equals exactly k. Help him, find the remainder after division this number by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).A substring s[i..j] of string s\xe2\x80\x89=\xe2\x80\x89s1s2... sn is string sisi\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891... sj.String x\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89x1x2... xp is lexicographically larger than string y\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y1y2... yp, if there is such number r (r\xe2\x80\x89<\xe2\x80\x89p), that x1\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y1,\xe2\x80\x89\xe2\x80\x89x2\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y2,\xe2\x80\x89\xe2\x80\x89... ,\xe2\x80\x89\xe2\x80\x89xr\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89yr and xr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89yr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891. The string characters are compared by their ASCII codes." 2500
360B "Levko and Array" "binary search,dp" "Levko has an array that consists of integers: a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89an. But he doesn\xe2\x80\x99t like this array at all.Levko thinks that the beauty of the array a directly depends on value c(a), which can be calculated by the formula:  The less value c(a) is, the more beautiful the array is.It\xe2\x80\x99s time to change the world and Levko is going to change his array for the better. To be exact, Levko wants to change the values of at most k array elements (it is allowed to replace the values by any integers). Of course, the changes should make the array as beautiful as possible.Help Levko and calculate what minimum number c(a) he can reach." 2000
360A "Levko and Array Recovery" greedy,implementation "Levko loves array a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89an, consisting of integers, very much. That is why Levko is playing with array a, performing all sorts of operations with it. Each operation Levko performs is of one of two types:  Increase all elements from li to ri by di. In other words, perform assignments aj\xe2\x80\x89=\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x89di for all j that meet the inequation li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri.  Find the maximum of elements from li to ri. That is, calculate the value . Sadly, Levko has recently lost his array. Fortunately, Levko has records of all operations he has performed on array a. Help Levko, given the operation records, find at least one suitable array. The results of all operations for the given array must coincide with the record results. Levko clearly remembers that all numbers in his array didn\'t exceed 109 in their absolute value, so he asks you to find such an array." 1700
359E Neatness "constructive algorithms,dfs and similar" "Simon loves neatness. So before he goes to bed, Simon wants to complete all chores in the house.Simon\'s house looks like a rectangular table consisting of n rows and n columns from above. All rows of the table are numbered from 1 to n from top to bottom. All columns of the table are numbered from 1 to n from left to right. Each cell of the table is a room. Pair (x,\xe2\x80\x89y) denotes the room, located at the intersection of the x-th row and the y-th column. For each room we know if the light is on or not there.Initially Simon is in room (x0,\xe2\x80\x89y0). He wants to turn off the lights in all the rooms in the house, and then return to room (x0,\xe2\x80\x89y0). Suppose that at the current moment Simon is in the room (x,\xe2\x80\x89y). To reach the desired result, he can perform the following steps:  The format of the action is ""1"". The action is to turn on the light in room (x,\xe2\x80\x89y). Simon cannot do it if the room already has light on.  The format of the action is ""2"". The action is to turn off the light in room (x,\xe2\x80\x89y). Simon cannot do it if the room already has light off.  The format of the action is ""dir"" (dir is a character). The action is to move to a side-adjacent room in direction dir. The direction can be left, right, up or down (the corresponding dir is L, R, U or D). Additionally, Simon can move only if he see a light in the direction dir. More formally, if we represent the room, Simon wants to go, as (nx,\xe2\x80\x89ny), there shold be an integer k (k\xe2\x80\x89>\xe2\x80\x890), that room (x\xe2\x80\x89+\xe2\x80\x89(nx\xe2\x80\x89-\xe2\x80\x89x)k,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89(ny\xe2\x80\x89-\xe2\x80\x89y)k) has a light. Of course, Simon cannot move out of his house. Help Simon, find the sequence of actions that lets him achieve the desired result." 2400
359D "Pair of Numbers" "binary search,brute force,data structures,math,two pointers" "Simon has an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, consisting of n positive integers. Today Simon asked you to find a pair of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the following conditions hold:  there is integer j (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), such that all integers al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar are divisible by aj;  value r\xe2\x80\x89-\xe2\x80\x89l takes the maximum value among all pairs for which condition 1 is true; Help Simon, find the required pair of numbers (l,\xe2\x80\x89r). If there are multiple required pairs find all of them." 2000
359C "Prime Number" "math,number theory" "Simon has a prime number x and an array of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Simon loves fractions very much. Today he wrote out number  on a piece of paper. After Simon led all fractions to a common denominator and summed them up, he got a fraction: , where number t equals xa1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an. Now Simon wants to reduce the resulting fraction. Help him, find the greatest common divisor of numbers s and t. As GCD can be rather large, print it as a remainder after dividing it by number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900
359B Permutation "constructive algorithms,dp,math" "A permutation p is an ordered group of numbers p1,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each is no more than n. We\'ll define number n as the length of permutation p1,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89\xe2\x80\x89pn.Simon has a positive integer n and a non-negative integer k, such that 2k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Help him find permutation a of length 2n, such that it meets this equation: ." 1400
359A Table "constructive algorithms,greedy,implementation" "Simon has a rectangular table consisting of n rows and m columns. Simon numbered the rows of the table from top to bottom starting from one and the columns \xe2\x80\x94 from left to right starting from one. We\'ll represent the cell on the x-th row and the y-th column as a pair of numbers (x,\xe2\x80\x89y). The table corners are cells: (1,\xe2\x80\x891), (n,\xe2\x80\x891), (1,\xe2\x80\x89m), (n,\xe2\x80\x89m).Simon thinks that some cells in this table are good. Besides, it\'s known that no good cell is the corner of the table. Initially, all cells of the table are colorless. Simon wants to color all cells of his table. In one move, he can choose any good cell of table (x1,\xe2\x80\x89y1), an arbitrary corner of the table (x2,\xe2\x80\x89y2) and color all cells of the table (p,\xe2\x80\x89q), which meet both inequations: min(x1,\xe2\x80\x89x2)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89max(x1,\xe2\x80\x89x2), min(y1,\xe2\x80\x89y2)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89max(y1,\xe2\x80\x89y2).Help Simon! Find the minimum number of operations needed to color all cells of the table. Note that you can color one cell multiple times." 1000
358E "Dima and Kicks" "brute force,dsu,graphs,implementation" "Dima is a good person. In fact, he\'s great. But all good things come to an end...Seryozha is going to kick Dima just few times.. For this reason he divides the room into unit squares. Now the room is a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m consisting of unit squares.For the beginning, Seryozha put Dima in a center of some square. Then he started to kick Dima (it is known, that he kicks Dima at least once). Each time when Dima is kicked he flyes up and moves into one of four directions (up, left, right, down). On each move Dima passes k (k\xe2\x80\x89>\xe2\x80\x891) unit of the length in the corresponding direction. Seryozha is really kind, so he kicks Dima in such way that Dima never meets the walls (in other words, Dima never leave the room\'s space). Seryozha is also dynamic character so Dima never flies above the same segment, connecting a pair of adjacent squares, twice.Seryozha kicks Dima for a long time, but Dima is not vindictive \xe2\x80\x94 Dima writes. Dima marked all squares in which he was staying or above which he was flying. Thanks to kicks, Dima does not remember the k value, so he asks you to find all possible values which matches to the Dima\'s records." 2300
358D "Dima and Hares" dp,greedy "Dima liked the present he got from Inna very much. He liked the present he got from Seryozha even more. Dima felt so grateful to Inna about the present that he decided to buy her n hares. Inna was very happy. She lined up the hares in a row, numbered them from 1 to n from left to right and started feeding them with carrots. Inna was determined to feed each hare exactly once. But in what order should she feed them?Inna noticed that each hare radiates joy when she feeds it. And the joy of the specific hare depends on whether Inna fed its adjacent hares before feeding it. Inna knows how much joy a hare radiates if it eats when either both of his adjacent hares are hungry, or one of the adjacent hares is full (that is, has been fed), or both of the adjacent hares are full. Please note that hares number 1 and n don\'t have a left and a right-adjacent hare correspondingly, so they can never have two full adjacent hares.Help Inna maximize the total joy the hares radiate. :)" 1800
358C "Dima and Containers" "constructive algorithms,greedy,implementation" "Dima has a birthday soon! It\'s a big day! Saryozha\'s present to Dima is that Seryozha won\'t be in the room and won\'t disturb Dima and Inna as they celebrate the birthday. Inna\'s present to Dima is a stack, a queue and a deck.Inna wants her present to show Dima how great a programmer he is. For that, she is going to give Dima commands one by one. There are two types of commands:  Add a given number into one of containers. For the queue and the stack, you can add elements only to the end. For the deck, you can add elements to the beginning and to the end.  Extract a number from each of at most three distinct containers. Tell all extracted numbers to Inna and then empty all containers. In the queue container you can extract numbers only from the beginning. In the stack container you can extract numbers only from the end. In the deck number you can extract numbers from the beginning and from the end. You cannot extract numbers from empty containers. Every time Dima makes a command of the second type, Inna kisses Dima some (possibly zero) number of times. Dima knows Inna perfectly well, he is sure that this number equals the sum of numbers he extracts from containers during this operation.As we\'ve said before, Dima knows Inna perfectly well and he knows which commands Inna will give to Dima and the order of the commands. Help Dima find the strategy that lets him give as more kisses as possible for his birthday!" 2000
358B "Dima and Text Messages" "brute force,strings" "Seryozha has a very changeable character. This time he refused to leave the room to Dima and his girlfriend (her hame is Inna, by the way). However, the two lovebirds can always find a way to communicate. Today they are writing text messages to each other.Dima and Inna are using a secret code in their text messages. When Dima wants to send Inna some sentence, he writes out all words, inserting a heart before each word and after the last word. A heart is a sequence of two characters: the ""less"" characters (<) and the digit three (3). After applying the code, a test message looks like that: <3word1<3word2<3 ... wordn<3.Encoding doesn\'t end here. Then Dima inserts a random number of small English characters, digits, signs ""more"" and ""less"" into any places of the message.Inna knows Dima perfectly well, so she knows what phrase Dima is going to send her beforehand. Inna has just got a text message. Help her find out if Dima encoded the message correctly. In other words, find out if a text message could have been received by encoding in the manner that is described above." 1500
358A "Dima and Continuous Line" "brute force,implementation" "Dima and Seryozha live in an ordinary dormitory room for two. One day Dima had a date with his girl and he asked Seryozha to leave the room. As a compensation, Seryozha made Dima do his homework.The teacher gave Seryozha the coordinates of n distinct points on the abscissa axis and asked to consecutively connect them by semi-circus in a certain order: first connect the first point with the second one, then connect the second point with the third one, then the third one with the fourth one and so on to the n-th point. Two points with coordinates (x1,\xe2\x80\x890) and (x2,\xe2\x80\x890) should be connected by a semi-circle that passes above the abscissa axis with the diameter that coincides with the segment between points. Seryozha needs to find out if the line on the picture intersects itself. For clarifications, see the picture Seryozha showed to Dima (the left picture has self-intersections, the right picture doesn\'t have any).  Seryozha is not a small boy, so the coordinates of the points can be rather large. Help Dima cope with the problem." 1400
357B "Flag Day" "constructive algorithms,implementation" "In Berland, there is the national holiday coming \xe2\x80\x94 the Flag Day. In the honor of this event the president of the country decided to make a big dance party and asked your agency to organize it. He has several conditions:  overall, there must be m dances; exactly three people must take part in each dance; each dance must have one dancer in white clothes, one dancer in red clothes and one dancer in blue clothes (these are the colors of the national flag of Berland). The agency has n dancers, and their number can be less than 3m. That is, some dancers will probably have to dance in more than one dance. All of your dancers must dance on the party. However, if some dance has two or more dancers from a previous dance, then the current dance stops being spectacular. Your agency cannot allow that to happen, so each dance has at most one dancer who has danced in some previous dance. You considered all the criteria and made the plan for the m dances: each dance had three dancers participating in it. Your task is to determine the clothes color for each of the n dancers so that the President\'s third condition fulfilled: each dance must have a dancer in white, a dancer in red and a dancer in blue. The dancers cannot change clothes between the dances." 1400
357A "Group of Students" "brute force,greedy,implementation" "At the beginning of the school year Berland State University starts two city school programming groups, for beginners and for intermediate coders. The children were tested in order to sort them into groups. According to the results, each student got some score from 1 to m points. We know that c1 schoolchildren got 1 point, c2 children got 2 points, ..., cm children got m points. Now you need to set the passing rate k (integer from 1 to m): all schoolchildren who got less than k points go to the beginner group and those who get at strictly least k points go to the intermediate group. We know that if the size of a group is more than y, then the university won\'t find a room for them. We also know that if a group has less than x schoolchildren, then it is too small and there\'s no point in having classes with it. So, you need to split all schoolchildren into two groups so that the size of each group was from x to y, inclusive. Help the university pick the passing rate in a way that meets these requirements." 1000
356E "Xenia and String Problem" "dp,hashing,implementation,string suffix structures,strings" "Xenia the coder went to The Olympiad of Informatics and got a string problem. Unfortunately, Xenia isn\'t fabulous in string algorithms. Help her solve the problem.String s is a sequence of characters s1s2... s|s|, where record |s| shows the length of the string. Substring s[i... j] of string s is string sisi\xe2\x80\x89+\xe2\x80\x891... sj.String s is a Gray string, if it meets the conditions:  the length of string |s| is odd;  character  occurs exactly once in the string;  either |s|\xe2\x80\x89=\xe2\x80\x891, or substrings  and  are the same and are Gray strings. For example, strings ""abacaba"", ""xzx"", ""g"" are Gray strings and strings ""aaa"", ""xz"", ""abaxcbc"" are not.The beauty of string p is the sum of the squares of the lengths of all substrings of string p that are Gray strings. In other words, consider all pairs of values i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|). If substring p[i... j] is a Gray string, you should add (j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891)2 to the beauty.Xenia has got string t consisting of lowercase English letters. She is allowed to replace at most one letter of the string by any other English letter. The task is to get a string of maximum beauty." 3000
356D "Bags and Coins" "bitmasks,constructive algorithms,dp,greedy" "When you were a child you must have been told a puzzle of bags and coins. Anyway, here\'s one of its versions: A horse has three bags. The first bag has one coin, the second bag has one coin and the third bag has three coins. In total, the horse has three coins in the bags. How is that possible? The answer is quite simple. The third bag contains a coin and two other bags. This problem is a generalization of the childhood puzzle. You have n bags. You know that the first bag contains a1 coins, the second bag contains a2 coins, ..., the n-th bag contains an coins. In total, there are s coins. Find the way to arrange the bags and coins so that they match the described scenario or else state that it is impossible to do." 2700
356C Compartments "combinatorics,constructive algorithms,greedy,implementation" "A team of students from the city S is sent to the All-Berland Olympiad in Informatics. Traditionally, they go on the train. All students have bought tickets in one carriage, consisting of n compartments (each compartment has exactly four people). We know that if one compartment contain one or two students, then they get bored, and if one compartment contain three or four students, then the compartment has fun throughout the entire trip.The students want to swap with other people, so that no compartment with students had bored students. To swap places with another person, you need to convince him that it is really necessary. The students can not independently find the necessary arguments, so they asked a sympathetic conductor for help. The conductor can use her life experience to persuade any passenger to switch places with some student.However, the conductor does not want to waste time persuading the wrong people, so she wants to know what is the minimum number of people necessary to persuade her to change places with the students. Your task is to find the number. After all the swaps each compartment should either have no student left, or have a company of three or four students." 2100
356B "Xenia and Hamming" implementation,math "Xenia is an amateur programmer. Today on the IT lesson she learned about the Hamming distance.The Hamming distance between two strings s\xe2\x80\x89=\xe2\x80\x89s1s2... sn and t\xe2\x80\x89=\xe2\x80\x89t1t2... tn of equal length n is value . Record [si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ti] is the Iverson notation and represents the following: if si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ti, it is one, otherwise \xe2\x80\x94 zero.Now Xenia wants to calculate the Hamming distance between two long strings a and b. The first string a is the concatenation of n copies of string x, that is, . The second string b is the concatenation of m copies of string y. Help Xenia, calculate the required Hamming distance, given n,\xe2\x80\x89x,\xe2\x80\x89m,\xe2\x80\x89y." 1900
356A "Knight Tournament" "data structures,dsu" "Hooray! Berl II, the king of Berland is making a knight tournament. The king has already sent the message to all knights in the kingdom and they in turn agreed to participate in this grand event.As for you, you\'re just a simple peasant. There\'s no surprise that you slept in this morning and were late for the tournament (it was a weekend, after all). Now you are really curious about the results of the tournament. This time the tournament in Berland went as follows:  There are n knights participating in the tournament. Each knight was assigned his unique number \xe2\x80\x94 an integer from 1 to n.  The tournament consisted of m fights, in the i-th fight the knights that were still in the game with numbers at least li and at most ri have fought for the right to continue taking part in the tournament.  After the i-th fight among all participants of the fight only one knight won \xe2\x80\x94 the knight number xi, he continued participating in the tournament. Other knights left the tournament.  The winner of the last (the m-th) fight (the knight number xm) became the winner of the tournament. You fished out all the information about the fights from your friends. Now for each knight you want to know the name of the knight he was conquered by. We think that the knight number b was conquered by the knight number a, if there was a fight with both of these knights present and the winner was the knight number a.Write the code that calculates for each knight, the name of the knight that beat him." 1500
355B "Vasya and Public Transport" greedy,implementation "Vasya often uses public transport. The transport in the city is of two types: trolleys and buses. The city has n buses and m trolleys, the buses are numbered by integers from 1 to n, the trolleys are numbered by integers from 1 to m.Public transport is not free. There are 4 types of tickets:   A ticket for one ride on some bus or trolley. It costs c1 burles;  A ticket for an unlimited number of rides on some bus or on some trolley. It costs c2 burles;  A ticket for an unlimited number of rides on all buses or all trolleys. It costs c3 burles;  A ticket for an unlimited number of rides on all buses and trolleys. It costs c4 burles. Vasya knows for sure the number of rides he is going to make and the transport he is going to use. He asked you for help to find the minimum sum of burles he will have to spend on the tickets." 1100
355A "Vasya and Digital Root" "constructive algorithms,implementation" "Vasya has recently found out what a digital root of a number is and he decided to share his knowledge with you.Let\'s assume that S(n) is the sum of digits of number n, for example, S(4098)\xe2\x80\x89=\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x899\xe2\x80\x89+\xe2\x80\x898\xe2\x80\x89=\xe2\x80\x8921. Then the digital root of number n equals to:   dr(n)\xe2\x80\x89=\xe2\x80\x89S(n), if S(n)\xe2\x80\x89<\xe2\x80\x8910;  dr(n)\xe2\x80\x89=\xe2\x80\x89dr(\xe2\x80\x89S(n)\xe2\x80\x89), if S(n)\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x8910. For example, dr(4098)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89dr(21)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x893.Vasya is afraid of large numbers, so the numbers he works with are at most 101000. For all such numbers, he has proved that dr(n)\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89S(\xe2\x80\x89S(\xe2\x80\x89S(\xe2\x80\x89S(n)\xe2\x80\x89)\xe2\x80\x89)\xe2\x80\x89) (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89101000).Now Vasya wants to quickly find numbers with the given digital root. The problem is, he hasn\'t learned how to do that and he asked you to help him. You task is, given numbers k and d, find the number consisting of exactly k digits (the leading zeroes are not allowed), with digital root equal to d, or else state that such number does not exist." 1100
354E "Lucky Number Representation" "constructive algorithms,dfs and similar,dp" "We know that lucky digits are digits 4 and 7, however Vasya\'s got another favorite digit 0 and he assumes it also is lucky! Lucky numbers are such non-negative integers whose decimal record only contains lucky digits. For example, numbers 0,\xe2\x80\x8947,\xe2\x80\x897074 are lucky, but 1,\xe2\x80\x897377,\xe2\x80\x89895,\xe2\x80\x89 -7 are not.Vasya has t important positive integers he needs to remember. Vasya is quite superstitious and he wants to remember lucky numbers only, so he is asking you for each important number to represent it as a sum of exactly six lucky numbers (Vasya just can\'t remember more numbers). Then Vasya can just remember these six numbers and calculate the important number at any moment.For each of t important integers represent it as the sum of six lucky numbers or state that this is impossible." 2200
354D "Transferring Pyramid" dp "Vasya and Petya are using an interesting data storing structure: a pyramid.The pyramid consists of n rows, the i-th row contains i cells. Each row is shifted half a cell to the left relative to the previous row. The cells are numbered by integers from 1 to  as shown on the picture below.An example of a pyramid at n\xe2\x80\x89=\xe2\x80\x895 is:   This data structure can perform operations of two types:   Change the value of a specific cell. It is described by three integers: ""t\xe2\x80\x82i\xe2\x80\x82v"", where t\xe2\x80\x89=\xe2\x80\x891 (the type of operation), i \xe2\x80\x94 the number of the cell to change and v the value to assign to the cell.  Change the value of some subpyramid. The picture shows a highlighted subpyramid with the top in cell 5. It is described by s\xe2\x80\x89+\xe2\x80\x892 numbers: ""t\xe2\x80\x82i\xe2\x80\x82v1\xe2\x80\x82v2\xe2\x80\x82...\xe2\x80\x82vs"", where t\xe2\x80\x89=\xe2\x80\x892, i \xe2\x80\x94 the number of the top cell of the pyramid, s \xe2\x80\x94 the size of the subpyramid (the number of cells it has), vj \xe2\x80\x94 the value you should assign to the j-th cell of the subpyramid. Formally: a subpyramid with top at the i-th cell of the k-th row (the 5-th cell is the second cell of the third row) will contain cells from rows from k to n, the (k\xe2\x80\x89+\xe2\x80\x89p)-th row contains cells from the i-th to the (i\xe2\x80\x89+\xe2\x80\x89p)-th (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k).Vasya and Petya had two identical pyramids. Vasya changed some cells in his pyramid and he now wants to send his changes to Petya. For that, he wants to find a sequence of operations at which Petya can repeat all Vasya\'s changes. Among all possible sequences, Vasya has to pick the minimum one (the one that contains the fewest numbers).You have a pyramid of n rows with k changed cells. Find the sequence of operations which result in each of the k changed cells being changed by at least one operation. Among all the possible sequences pick the one that contains the fewest numbers." 2900
354C "Vasya and Beautiful Arrays" "brute force,dp,number theory" "Vasya\'s got a birthday coming up and his mom decided to give him an array of positive integers a of length n.Vasya thinks that an array\'s beauty is the greatest common divisor of all its elements. His mom, of course, wants to give him as beautiful an array as possible (with largest possible beauty). Unfortunately, the shop has only one array a left. On the plus side, the seller said that he could decrease some numbers in the array (no more than by k for each number).The seller can obtain array b from array a if the following conditions hold: bi\xe2\x80\x89>\xe2\x80\x890;\xe2\x80\x820\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.Help mom find the maximum possible beauty of the array she will give to Vasya (that seller can obtain)." 2100
354B "Game with Strings" bitmasks,dp,games "Given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n table T consisting of lowercase English letters. We\'ll consider some string s good if the table contains a correct path corresponding to the given string. In other words, good strings are all strings we can obtain by moving from the left upper cell of the table only to the right and down. Here\'s the formal definition of correct paths:Consider rows of the table are numbered from 1 to n from top to bottom, and columns of the table are numbered from 1 to n from left to the right. Cell (r,\xe2\x80\x89c) is a cell of table T on the r-th row and in the c-th column. This cell corresponds to letter Tr,\xe2\x80\x89c.A path of length k is a sequence of table cells [(r1,\xe2\x80\x89c1),\xe2\x80\x89(r2,\xe2\x80\x89c2),\xe2\x80\x89...,\xe2\x80\x89(rk,\xe2\x80\x89ck)]. The following paths are correct:   There is only one correct path of length 1, that is, consisting of a single cell: [(1,\xe2\x80\x891)];  Let\'s assume that [(r1,\xe2\x80\x89c1),\xe2\x80\x89...,\xe2\x80\x89(rm,\xe2\x80\x89cm)] is a correct path of length m, then paths [(r1,\xe2\x80\x89c1),\xe2\x80\x89...,\xe2\x80\x89(rm,\xe2\x80\x89cm),\xe2\x80\x89(rm\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89cm)] and [(r1,\xe2\x80\x89c1),\xe2\x80\x89...,\xe2\x80\x89(rm,\xe2\x80\x89cm),\xe2\x80\x89(rm,\xe2\x80\x89cm\xe2\x80\x89+\xe2\x80\x891)] are correct paths of length m\xe2\x80\x89+\xe2\x80\x891. We should assume that a path [(r1,\xe2\x80\x89c1),\xe2\x80\x89(r2,\xe2\x80\x89c2),\xe2\x80\x89...,\xe2\x80\x89(rk,\xe2\x80\x89ck)] corresponds to a string of length k: Tr1,\xe2\x80\x89c1\xe2\x80\x89+\xe2\x80\x89Tr2,\xe2\x80\x89c2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89Trk,\xe2\x80\x89ck.Two players play the following game: initially they have an empty string. Then the players take turns to add a letter to the end of the string. After each move (adding a new letter) the resulting string must be good. The game ends after 2n\xe2\x80\x89-\xe2\x80\x891 turns. A player wins by the following scenario:   If the resulting string has strictly more letters ""a"" than letters ""b"", then the first player wins;  If the resulting string has strictly more letters ""b"" than letters ""a"", then the second player wins;  If the resulting string has the same number of letters ""a"" and ""b"", then the players end the game with a draw. Your task is to determine the result of the game provided that both players played optimally well." 2400
354A "Vasya and Robot" "brute force,greedy,math" "Vasya has n items lying in a line. The items are consecutively numbered by numbers from 1 to n in such a way that the leftmost item has number 1, the rightmost item has number n. Each item has a weight, the i-th item weights wi kilograms.Vasya needs to collect all these items, however he won\'t do it by himself. He uses his brand new robot. The robot has two different arms \xe2\x80\x94 the left one and the right one. The robot can consecutively perform the following actions:   Take the leftmost item with the left hand and spend wi\xe2\x80\x89\xc2\xb7\xe2\x80\x89l energy units (wi is a weight of the leftmost item, l is some parameter). If the previous action was the same (left-hand), then the robot spends extra Ql energy units;  Take the rightmost item with the right hand and spend wj\xe2\x80\x89\xc2\xb7\xe2\x80\x89r energy units (wj is a weight of the rightmost item, r is some parameter). If the previous action was the same (right-hand), then the robot spends extra Qr energy units; Naturally, Vasya wants to program the robot in a way that the robot spends as little energy as possible. He asked you to solve this problem. Your task is to find the minimum number of energy units robot spends to collect all items." 1500
353E Antichain "dp,graph matchings,greedy" "You have a directed acyclic graph G, consisting of n vertexes, numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891. The graph contains n edges numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891. An edge with number i connects vertexes i and (i\xe2\x80\x89+\xe2\x80\x891) mod n, and it can be directed in either direction (from i to (i\xe2\x80\x89+\xe2\x80\x891) mod n, or vise versa).Operation x mod y means taking the remainder after dividing number x by number y.Let\'s call two vertexes u and v in graph G comparable if the graph contains a path either from u to v or from v to u. We\'ll assume that an antichain is a set of vertexes of graph G, where any two distinct vertexes are not comparable. The size of an antichain is the number of vertexes in the corresponding set. An antichain is maximum if the graph doesn\'t have antichains of a larger size.Your task is to find the size of the maximum antichain in graph G." 2200
353D Queue "constructive algorithms,dp" "There are n schoolchildren, boys and girls, lined up in the school canteen in front of the bun stall. The buns aren\'t ready yet and the line is undergoing some changes.Each second all boys that stand right in front of girls, simultaneously swap places with the girls (so that the girls could go closer to the beginning of the line). In other words, if at some time the i-th position has a boy and the (i\xe2\x80\x89+\xe2\x80\x891)-th position has a girl, then in a second, the i-th position will have a girl and the (i\xe2\x80\x89+\xe2\x80\x891)-th one will have a boy.Let\'s take an example of a line of four people: a boy, a boy, a girl, a girl (from the beginning to the end of the line). Next second the line will look like that: a boy, a girl, a boy, a girl. Next second it will be a girl, a boy, a girl, a boy. Next second it will be a girl, a girl, a boy, a boy. The line won\'t change any more.Your task is: given the arrangement of the children in the line to determine the time needed to move all girls in front of boys (in the example above it takes 3 seconds). Baking buns takes a lot of time, so no one leaves the line until the line stops changing." 2000
353C "Find Maximum" "implementation,math,number theory" "Valera has array a, consisting of n integers a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891, and function f(x), taking an integer from 0 to 2n\xe2\x80\x89-\xe2\x80\x891 as its single argument. Value f(x) is calculated by formula , where value bit(i) equals one if the binary representation of number x contains a 1 on the i-th position, and zero otherwise.For example, if n\xe2\x80\x89=\xe2\x80\x894 and x\xe2\x80\x89=\xe2\x80\x8911 (11\xe2\x80\x89=\xe2\x80\x8920\xe2\x80\x89+\xe2\x80\x8921\xe2\x80\x89+\xe2\x80\x8923), then f(x)\xe2\x80\x89=\xe2\x80\x89a0\xe2\x80\x89+\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a3.Help Valera find the maximum of function f(x) among all x, for which an inequality holds: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m." 1600
353B "Two Heaps" "combinatorics,constructive algorithms,greedy,implementation,math,sortings" "Valera has 2\xc2\xb7n cubes, each cube contains an integer from 10 to 99. He arbitrarily chooses n cubes and puts them in the first heap. The remaining cubes form the second heap. Valera decided to play with cubes. During the game he takes a cube from the first heap and writes down the number it has. Then he takes a cube from the second heap and write out its two digits near two digits he had written (to the right of them). In the end he obtained a single fourdigit integer \xe2\x80\x94 the first two digits of it is written on the cube from the first heap, and the second two digits of it is written on the second cube from the second heap.Valera knows arithmetic very well. So, he can easily count the number of distinct fourdigit numbers he can get in the game. The other question is: how to split cubes into two heaps so that this number (the number of distinct fourdigit integers Valera can get) will be as large as possible?" 1900
353A Domino implementation,math "Valera has got n domino pieces in a row. Each piece consists of two halves \xe2\x80\x94 the upper one and the lower one. Each of the halves contains a number from 1 to 6. Valera loves even integers very much, so he wants the sum of the numbers on the upper halves and the sum of the numbers on the lower halves to be even.To do that, Valera can rotate the dominoes by 180 degrees. After the rotation the upper and the lower halves swap places. This action takes one second. Help Valera find out the minimum time he must spend rotating dominoes to make his wish come true." 1200
352B "Jeff and Periods" implementation,sortings "One day Jeff got hold of an integer sequence a1, a2, ..., an of length n. The boy immediately decided to analyze the sequence. For that, he needs to find all values of x, for which these conditions hold:  x occurs in sequence a.  Consider all positions of numbers x in the sequence a (such i, that ai\xe2\x80\x89=\xe2\x80\x89x). These numbers, sorted in the increasing order, must form an arithmetic progression. Help Jeff, find all x that meet the problem conditions." 1300
352A "Jeff and Digits" "brute force,implementation,math" "Jeff\'s got n cards, each card contains either digit 0, or digit 5. Jeff can choose several cards and put them in a line so that he gets some number. What is the largest possible number divisible by 90 Jeff can make from the cards he\'s got?Jeff must make the number without leading zero. At that, we assume that number 0 doesn\'t contain any leading zeroes. Jeff doesn\'t have to use all the cards." 1000
351E "Jeff and Permutation" greedy "Jeff\'s friends know full well that the boy likes to get sequences and arrays for his birthday. Thus, Jeff got sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn for his birthday.Jeff hates inversions in sequences. An inversion in sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is a pair of indexes i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that an inequality ai\xe2\x80\x89>\xe2\x80\x89aj holds.Jeff can multiply some numbers of the sequence p by -1. At that, he wants the number of inversions in the sequence to be minimum. Help Jeff and find the minimum number of inversions he manages to get." 2200
351D "Jeff and Removing Periods" "data structures" "Cosider a sequence, consisting of n integers: a1, a2, ..., an. Jeff can perform the following operation on sequence a:  take three integers v, t, k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v,\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k; v\xe2\x80\x89+\xe2\x80\x89tk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that av = av\xe2\x80\x89+\xe2\x80\x89t, av\xe2\x80\x89+\xe2\x80\x89t = av\xe2\x80\x89+\xe2\x80\x892t, ..., av\xe2\x80\x89+\xe2\x80\x89t(k\xe2\x80\x89-\xe2\x80\x891) = av\xe2\x80\x89+\xe2\x80\x89tk;  remove elements av, av\xe2\x80\x89+\xe2\x80\x89t, ..., av\xe2\x80\x89+\xe2\x80\x89t\xc2\xb7k from the sequence a, the remaining elements should be reindexed a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891.  permute in some order the remaining elements of sequence a. A beauty of a sequence a is the minimum number of operations that is needed to delete all elements from sequence a.Jeff\'s written down a sequence of m integers b1, b2, ..., bm. Now he wants to ask q questions. Each question can be described with two integers li,\xe2\x80\x89ri. The answer to the question is the beauty of sequence bli, bli\xe2\x80\x89+\xe2\x80\x891, ..., bri. You are given the sequence b and all questions. Help Jeff, answer all his questions." 2700
351C "Jeff and Brackets" dp,matrices "Jeff loves regular bracket sequences.Today Jeff is going to take a piece of paper and write out the regular bracket sequence, consisting of nm brackets. Let\'s number all brackets of this sequence from 0 to nm - 1 from left to right. Jeff knows that he is going to spend ai mod n liters of ink on the i-th bracket of the sequence if he paints it opened and bi mod n liters if he paints it closed.You\'ve got sequences a, b and numbers n, m. What minimum amount of ink will Jeff need to paint a regular bracket sequence of length nm?Operation x mod y means taking the remainder after dividing number x by number y." 2500
351B "Jeff and Furik" combinatorics,dp,probabilities "Jeff has become friends with Furik. Now these two are going to play one quite amusing game.At the beginning of the game Jeff takes a piece of paper and writes down a permutation consisting of n numbers: p1, p2, ..., pn. Then the guys take turns to make moves, Jeff moves first. During his move, Jeff chooses two adjacent permutation elements and then the boy swaps them. During his move, Furic tosses a coin and if the coin shows ""heads"" he chooses a random pair of adjacent elements with indexes i and i\xe2\x80\x89+\xe2\x80\x891, for which an inequality pi\xe2\x80\x89>\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 holds, and swaps them. But if the coin shows ""tails"", Furik chooses a random pair of adjacent elements with indexes i and i\xe2\x80\x89+\xe2\x80\x891, for which the inequality pi\xe2\x80\x89<\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 holds, and swaps them. If the coin shows ""heads"" or ""tails"" and Furik has multiple ways of adjacent pairs to take, then he uniformly takes one of the pairs. If Furik doesn\'t have any pair to take, he tosses a coin one more time. The game ends when the permutation is sorted in the increasing order.Jeff wants the game to finish as quickly as possible (that is, he wants both players to make as few moves as possible). Help Jeff find the minimum mathematical expectation of the number of moves in the game if he moves optimally well.You can consider that the coin shows the heads (or tails) with the probability of 50 percent." 1900
351A "Jeff and Rounding" dp,greedy,implementation,math "Jeff got 2n real numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a2n as a birthday present. The boy hates non-integer numbers, so he decided to slightly ""adjust"" the numbers he\'s got. Namely, Jeff consecutively executes n operations, each of them goes as follows:  choose indexes i and j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) that haven\'t been chosen yet;  round element ai to the nearest integer that isn\'t more than ai (assign to ai: \xe2\x8c\x8a ai \xe2\x8c\x8b);  round element aj to the nearest integer that isn\'t less than aj (assign to aj: \xe2\x8c\x88 aj \xe2\x8c\x89). Nevertheless, Jeff doesn\'t want to hurt the feelings of the person who gave him the sequence. That\'s why the boy wants to perform the operations so as to make the absolute value of the difference between the sum of elements before performing the operations and the sum of elements after performing the operations as small as possible. Help Jeff find the minimum absolute value of the difference." 1800
350E "Wrong Floyd" "brute force,constructive algorithms,dfs and similar,graphs" "Valera conducts experiments with algorithms that search for shortest paths. He has recently studied the Floyd\'s algorithm, so it\'s time to work with it.Valera\'s already written the code that counts the shortest distance between any pair of vertexes in a non-directed connected graph from n vertexes and m edges, containing no loops and multiple edges. Besides, Valera\'s decided to mark part of the vertexes. He\'s marked exactly k vertexes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak.Valera\'s code is given below.ans[i][j] // the shortest distance for a pair of vertexes i,\xe2\x80\x89ja[i]  // vertexes, marked by Valerafor(i = 1; i <= n; i++) {    for(j = 1; j <= n; j++) {        if (i == j)            ans[i][j] = 0;        else            ans[i][j] = INF;  //INF is a very large number     }}    for(i = 1; i <= m; i++) {    read a pair of vertexes u, v that have a non-directed edge between them;    ans[u][v] = 1;    ans[v][u] = 1;}for (i = 1; i <= k; i++) {    v = a[i];    for(j = 1; j <= n; j++)        for(r = 1; r <= n; r++)            ans[j][r] = min(ans[j][r], ans[j][v] + ans[v][r]);}Valera has seen that his code is wrong. Help the boy. Given the set of marked vertexes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, find such non-directed connected graph, consisting of n vertexes and m edges, for which Valera\'s code counts the wrong shortest distance for at least one pair of vertexes (i,\xe2\x80\x89j). Valera is really keen to get a graph without any loops and multiple edges. If no such graph exists, print -1." 2200
350D "Looking for Owls" "binary search,data structures,geometry,hashing,sortings" "Emperor Palpatine loves owls very much. The emperor has some blueprints with the new Death Star, the blueprints contain n distinct segments and m distinct circles. We will consider the segments indexed from 1 to n in some way and the circles \xe2\x80\x94 indexed from 1 to m in some way. Palpatine defines an owl as a set of a pair of distinct circles (i,\xe2\x80\x89j) (i\xe2\x80\x89<\xe2\x80\x89j) and one segment k, such that:   circles i and j are symmetrical relatively to the straight line containing segment k;  circles i and j don\'t have any common points;  circles i and j have the same radius;  segment k intersects the segment that connects the centers of circles i and j. Help Palpatine, count the number of distinct owls on the picture." 2400
350C Bombs greedy,implementation,sortings "You\'ve got a robot, its task is destroying bombs on a square plane. Specifically, the square plane contains n bombs, the i-th bomb is at point with coordinates (xi,\xe2\x80\x89yi). We know that no two bombs are at the same point and that no bomb is at point with coordinates (0,\xe2\x80\x890). Initially, the robot is at point with coordinates (0,\xe2\x80\x890). Also, let\'s mark the robot\'s current position as (x,\xe2\x80\x89y). In order to destroy all the bombs, the robot can perform three types of operations:  Operation has format ""1 k dir"". To perform the operation robot have to move in direction dir k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) times. There are only 4 directions the robot can move in: ""R"", ""L"", ""U"", ""D"". During one move the robot can move from the current point to one of following points: (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) (corresponding to directions). It is forbidden to move from point (x,\xe2\x80\x89y), if at least one point on the path (besides the destination point) contains a bomb.  Operation has format ""2"". To perform the operation robot have to pick a bomb at point (x,\xe2\x80\x89y) and put it in a special container. Thus, the robot can carry the bomb from any point to any other point. The operation cannot be performed if point (x,\xe2\x80\x89y) has no bomb. It is forbidden to pick a bomb if the robot already has a bomb in its container.  Operation has format ""3"". To perform the operation robot have to take a bomb out of the container and destroy it. You are allowed to perform this operation only if the robot is at point (0,\xe2\x80\x890). It is forbidden to perform the operation if the container has no bomb. Help the robot and find the shortest possible sequence of operations he can perform to destroy all bombs on the coordinate plane." 1600
350B Resort graphs "Valera\'s finally decided to go on holiday! He packed up and headed for a ski resort.Valera\'s fancied a ski trip but he soon realized that he could get lost in this new place. Somebody gave him a useful hint: the resort has n objects (we will consider the objects indexed in some way by integers from 1 to n), each object is either a hotel or a mountain.Valera has also found out that the ski resort had multiple ski tracks. Specifically, for each object v, the resort has at most one object u, such that there is a ski track built from object u to object v. We also know that no hotel has got a ski track leading from the hotel to some object.Valera is afraid of getting lost on the resort. So he wants you to come up with a path he would walk along. The path must consist of objects v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) and meet the following conditions:  Objects with numbers v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vk\xe2\x80\x89-\xe2\x80\x891 are mountains and the object with number vk is the hotel.  For any integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k), there is exactly one ski track leading from object vi. This track goes to object vi\xe2\x80\x89+\xe2\x80\x891.  The path contains as many objects as possible (k is maximal). Help Valera. Find such path that meets all the criteria of our hero!" 1500
350A TL "brute force,greedy,implementation" "Valera wanted to prepare a Codesecrof round. He\'s already got one problem and he wants to set a time limit (TL) on it.Valera has written n correct solutions. For each correct solution, he knows its running time (in seconds). Valera has also wrote m wrong solutions and for each wrong solution he knows its running time (in seconds).Let\'s suppose that Valera will set v seconds TL in the problem. Then we can say that a solution passes the system testing if its running time is at most v seconds. We can also say that a solution passes the system testing with some ""extra"" time if for its running time, a seconds, an inequality 2a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v holds.As a result, Valera decided to set v seconds TL, that the following conditions are met:  v is a positive integer;  all correct solutions pass the system testing;  at least one correct solution passes the system testing with some ""extra"" time;  all wrong solutions do not pass the system testing;  value v is minimum among all TLs, for which points 1, 2, 3, 4 hold. Help Valera and find the most suitable TL or else state that such TL doesn\'t exist." 1200
349B "Color the Fence" "data structures,dp,greedy,implementation" "Igor has fallen in love with Tanya. Now Igor wants to show his feelings and write a number on the fence opposite to Tanya\'s house. Igor thinks that the larger the number is, the more chance to win Tanya\'s heart he has. Unfortunately, Igor could only get v liters of paint. He did the math and concluded that digit d requires ad liters of paint. Besides, Igor heard that Tanya doesn\'t like zeroes. That\'s why Igor won\'t use them in his number.Help Igor find the maximum number he can write on the fence." 1700
349A "Cinema Line" greedy,implementation "The new ""Die Hard"" movie has just been released! There are n people at the cinema box office standing in a huge line. Each of them has a single 100, 50 or 25 ruble bill. A ""Die Hard"" ticket costs 25 rubles. Can the booking clerk sell a ticket to each person and give the change if he initially has no money and sells the tickets strictly in the order people follow in the line?" 1100
348E Pilgrims "dfs and similar,dp,trees" "A long time ago there was a land called Dudeland. Dudeland consisted of n towns connected with n\xe2\x80\x89-\xe2\x80\x891 bidirectonal roads. The towns are indexed from 1 to n and one can reach any city from any other city if he moves along the roads of the country. There are m monasteries in Dudeland located in m different towns. In each monastery lives a pilgrim.At the beginning of the year, each pilgrim writes down which monastery is the farthest from the monastery he is living in. If there is more than one farthest monastery, he lists all of them. On the Big Lebowski day each pilgrim picks one town from his paper at random and starts walking to that town. Walter hates pilgrims and wants to make as many of them unhappy as possible by preventing them from finishing their journey. He plans to destroy exactly one town that does not contain a monastery. A pilgrim becomes unhappy if all monasteries in his list become unreachable from the monastery he is living in. You need to find the maximum number of pilgrims Walter can make unhappy. Also find the number of ways he can make this maximal number of pilgrims unhappy: the number of possible towns he can destroy." 2800
348D Turtles dp,matrices "You\'ve got a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. We\'ll consider the table rows numbered from top to bottom 1 through n, and the columns numbered from left to right 1 through m. Then we\'ll denote the cell in row x and column y as (x,\xe2\x80\x89y).Initially cell (1,\xe2\x80\x891) contains two similar turtles. Both turtles want to get to cell (n,\xe2\x80\x89m). Some cells of the table have obstacles but it is guaranteed that there aren\'t any obstacles in the upper left and lower right corner. A turtle (one or the other) can go from cell (x,\xe2\x80\x89y) to one of two cells (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) and (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), as long as the required cell doesn\'t contain an obstacle. The turtles have had an argument so they don\'t want to have any chance of meeting each other along the way. Help them find the number of ways in which they can go from cell (1,\xe2\x80\x891) to cell (n,\xe2\x80\x89m).More formally, find the number of pairs of non-intersecting ways from cell (1,\xe2\x80\x891) to cell (n,\xe2\x80\x89m) modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Two ways are called non-intersecting if they have exactly two common points \xe2\x80\x94 the starting point and the final point." 2500
348C "Subset Sums" "brute force,data structures" "You are given an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and m sets S1,\xe2\x80\x89S2,\xe2\x80\x89...,\xe2\x80\x89Sm of indices of elements of this array. Let\'s denote Sk\xe2\x80\x89=\xe2\x80\x89{Sk,\xe2\x80\x89i} (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|Sk|). In other words, Sk,\xe2\x80\x89i is some element from set Sk.In this problem you have to answer q queries of the two types:  Find the sum of elements with indices from set Sk: . The query format is ""? k"".  Add number x to all elements at indices from set Sk: aSk,\xe2\x80\x89i is replaced by aSk,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89x for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|Sk|). The query format is ""+ k x"". After each first type query print the required sum." 2500
348B "Apple Tree" "dfs and similar,number theory,trees" "You are given a rooted tree with n vertices. In each leaf vertex there\'s a single integer \xe2\x80\x94 the number of apples in this vertex. The weight of a subtree is the sum of all numbers in this subtree leaves. For instance, the weight of a subtree that corresponds to some leaf is the number written in the leaf.A tree is balanced if for every vertex v of the tree all its subtrees, corresponding to the children of vertex v, are of equal weight. Count the minimum number of apples that you need to remove from the tree (specifically, from some of its leaves) in order to make the tree balanced. Notice that you can always achieve the goal by just removing all apples." 2100
348A Mafia "binary search,math,sortings" "One day n friends gathered together to play ""Mafia"". During each round of the game some player must be the supervisor and other n\xe2\x80\x89-\xe2\x80\x891 people take part in the game. For each person we know in how many rounds he wants to be a player, not the supervisor: the i-th person wants to play ai rounds. What is the minimum number of rounds of the ""Mafia"" game they need to play to let each person play at least as many rounds as they want?" 1600
347B "Fixed Points" "brute force,implementation,math" "A permutation of length n is an integer sequence such that each integer from 0 to (n\xe2\x80\x89-\xe2\x80\x891) appears exactly once in it. For example, sequence [0,\xe2\x80\x892,\xe2\x80\x891] is a permutation of length 3 while both [0,\xe2\x80\x892,\xe2\x80\x892] and [1,\xe2\x80\x892,\xe2\x80\x893] are not.A fixed point of a function is a point that is mapped to itself by the function. A permutation can be regarded as a bijective function. We\'ll get a definition of a fixed point in a permutation. An integer i is a fixed point of permutation a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891 if and only if ai\xe2\x80\x89=\xe2\x80\x89i. For example, permutation [0,\xe2\x80\x892,\xe2\x80\x891] has 1 fixed point and permutation [0,\xe2\x80\x891,\xe2\x80\x892] has 3 fixed points.You are given permutation a. You are allowed to swap two elements of the permutation at most once. Your task is to maximize the number of fixed points in the resulting permutation. Note that you are allowed to make at most one swap operation." 1100
347A "Difference Row" "constructive algorithms,implementation,sortings" "You want to arrange n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an in some order in a row. Let\'s define the value of an arrangement as the sum of differences between all pairs of adjacent integers.More formally, let\'s denote some arrangement as a sequence of integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn, where sequence x is a permutation of sequence a. The value of such an arrangement is (x1\xe2\x80\x89-\xe2\x80\x89x2)\xe2\x80\x89+\xe2\x80\x89(x2\xe2\x80\x89-\xe2\x80\x89x3)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89(xn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89xn).Find the largest possible value of an arrangement. Then, output the lexicographically smallest sequence x that corresponds to an arrangement of the largest possible value." 1300
346E "Doodle Jump" "math,number theory" "In Doodle Jump the aim is to guide a four-legged creature called ""The Doodler"" up a never-ending series of platforms without falling. \xe2\x80\x94 Wikipedia. It is a very popular game and xiaodao likes it very much. One day when playing the game she wondered whether there exists a platform that the doodler couldn\'t reach due to the limits of its jumping ability. Consider the following problem.There are n platforms. The height of the x-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) platform is a\xc2\xb7x mod p, where a and p are positive co-prime integers. The maximum possible height of a Doodler\'s jump is h. That is, it can jump from height h1 to height h2 (h1\xe2\x80\x89<\xe2\x80\x89h2) if h2\xe2\x80\x89-\xe2\x80\x89h1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h. Initially, the Doodler is on the ground, the height of which is 0. The question is whether it can reach the highest platform or not.For example, when a\xe2\x80\x89=\xe2\x80\x897, n\xe2\x80\x89=\xe2\x80\x894, p\xe2\x80\x89=\xe2\x80\x8912, h\xe2\x80\x89=\xe2\x80\x892, the heights of the platforms are 7, 2, 9, 4 as in the picture below. With the first jump the Doodler can jump to the platform at height 2, with the second one the Doodler can jump to the platform at height 4, but then it can\'t jump to any of the higher platforms. So, it can\'t reach the highest platform.  User xiaodao thought about the problem for a long time but didn\'t solve it, so she asks you for help. Also, she has a lot of instances of the problem. Your task is solve all of these instances." 3000
346D "Robot Control" "dp,graphs,shortest paths" "The boss of the Company of Robot is a cruel man. His motto is ""Move forward Or Die!"". And that is exactly what his company\'s product do. Look at the behavior of the company\'s robot when it is walking in the directed graph. This behavior has been called ""Three Laws of Robotics"":  Law 1. The Robot will destroy itself when it visits a vertex of the graph which it has already visited.  Law 2. The Robot will destroy itself when it has no way to go (that is when it reaches a vertex whose out-degree is zero).  Law 3. The Robot will move randomly when it has multiple ways to move (that is when it reach a vertex whose out-degree is more than one). Of course, the robot can move only along the directed edges of the graph. Can you imagine a robot behaving like that? That\'s why they are sold at a very low price, just for those who are short of money, including mzry1992, of course. mzry1992 has such a robot, and she wants to move it from vertex s to vertex t in a directed graph safely without self-destruction. Luckily, she can send her robot special orders at each vertex. A special order shows the robot which way to move, if it has multiple ways to move (to prevent random moving of the robot according to Law 3). When the robot reaches vertex t, mzry1992 takes it off the graph immediately. So you can see that, as long as there exists a path from s to t, she can always find a way to reach the goal (whatever the vertex t has the outdegree of zero or not).   Sample 2 However, sending orders is expensive, so your task is to find the minimum number of orders mzry1992 needs to send in the worst case. Please note that mzry1992 can give orders to the robot while it is walking on the graph. Look at the first sample to clarify that part of the problem." 2600
346C "Number Transformation II" greedy,math "You are given a sequence of positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn and two non-negative integers a and b. Your task is to transform a into b. To do that, you can perform the following moves:  subtract 1 from the current a;  subtract a mod xi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) from the current a. Operation a mod xi means taking the remainder after division of number a by number xi.Now you want to know the minimum number of moves needed to transform a into b." 2200
346B "Lucky Common Subsequence" dp,strings "In mathematics, a subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements. For example, the sequence BDF is a subsequence of ABCDEF. A substring of a string is a continuous subsequence of the string. For example, BCD is a substring of ABCDEF.You are given two strings s1, s2 and another string called virus. Your task is to find the longest common subsequence of s1 and s2, such that it doesn\'t contain virus as a substring." 2000
346A "Alice and Bob" "games,math,number theory" "It is so boring in the summer holiday, isn\'t it? So Alice and Bob have invented a new game to play. The rules are as follows. First, they get a set of n distinct integers. And then they take turns to make the following moves. During each move, either Alice or Bob (the player whose turn is the current) can choose two distinct integers x and y from the set, such that the set doesn\'t contain their absolute difference |x\xe2\x80\x89-\xe2\x80\x89y|. Then this player adds integer |x\xe2\x80\x89-\xe2\x80\x89y| to the set (so, the size of the set increases by one).If the current player has no valid move, he (or she) loses the game. The question is who will finally win the game if both players play optimally. Remember that Alice always moves first." 1600
345G "Suffix Subgroup" "*special problem,strings" "You are given a group of n strings: s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn.You should find a subgroup si1,\xe2\x80\x89si2,\xe2\x80\x89...,\xe2\x80\x89sik (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of the group. The following two conditions must hold:  there exists a string t such, that each string from found subgroup is its suffix;  the number of strings in the found subgroup is as large as possible. Your task is to print the number of strings in the found subgroup." 2200
345F "Superstitions Inspection" "*special problem" "You read scientific research regarding popularity of most famous superstitions across various countries, and you want to analyze their data. More specifically, you want to know which superstitions are popular in most countries.The data is given as a single file in the following format: country name on a separate line, followed by a list of superstitions popular in it, one entry per line. Each entry of the list is formatted as an asterisk ""*"" followed by a single space and then by the superstition name. Entries are unique within each country. The first line of input will represent a country. The input will contain at least one superstition. Country name is a non-empty sequence of words, where each word consists of only English letters. The words of the name of some country will be separated in input with one or more spaces.Superstition name is a non-empty sequence of words, where each word consists of only English letters and digits. The words of the name of some superstition will be separated in input with one or more spaces.You can consider two names equal, if corresponding sequences of words are equal. You shouldn\'t consider the case of the letters when you compare the words.Output the list of superstitions which are observed in the greatest number of countries. It\'s guaranteed that all countries have distinct names." 2700
345E "Black Cat Rush" "*special problem" "Today you go out of your house and immediately notice that something is weird. Around your door there is a swarm of black cats \xe2\x80\x94 all tense paws and twitching tails. As you do your first step, they all dart off and start running towards you. It looks like they want to thwart you!You are moving in a straight line from point (0,\xe2\x80\x890) to point (a,\xe2\x80\x890) with velocity v. There are n black cats around you who want to cross your paths. A cat can move in any direction with velocity at most u. A cat assumes it has crossed your path if it managed to get to at least one point of your path earlier or at the same time as you got there.You are given four integers: a, v, u, n, as well as cats\' coordinates (xi,\xe2\x80\x89yi). What is the greatest number of cats who manage to cross your path?" 2700
345D "Chain Letter" "*special problem,dfs and similar,graphs" "A chain letter is a kind of a message which urges the recipient to forward it to as many contacts as possible, usually with some kind of mystic explanation. Of course, this is only a superstition, and you don\'t believe in it, but all your friends do. You know that today there will be one of these letters going around, and you want to know how many times you\'ll receive it \xe2\x80\x94 of course, not that you\'ll be sending it yourself!You are given an array of strings f with n elements which describes the contacts between you and n\xe2\x80\x89-\xe2\x80\x891 of your friends: j-th character of i-th string (f[i][j]) is ""1"" if people i and j will send messages to each other, and ""0"" otherwise. Person 1 starts sending the letter to all his contacts; every person who receives the letter for the first time sends it to all his contacts. You are person n, and you don\'t forward the letter when you receive it. Calculate the number of copies of this letter you\'ll receive." 2200
345C "Counting Fridays" "*special problem" "Judging from the previous problem, Friday the 13th really doesn\'t treat you well, so you start thinking about how to minimize its impact on your life. You are a passionate participant of programming contests, so various competitions are an important part of your schedule. Naturally, you\'d like as few of them to be spoiled as possible.A friendly admin leaked to you the list of dates on which the contests will be held for several years ahead. Check how many of them happen to take place on Friday the 13th of any month." 2000
345B Triskaidekaphobia "*special problem" "Triskaidekaphobia is a fear of number 13. Ordinary people who suffer from this phobia feel uncomfortable around numbers 13, 130, 513 etc, but you, being a programmer, take this fear one step further. For example, consider number 7. It\'s ok when written in decimal, but written in base 4 it becomes 13, the dreadful number!The more you think about it, the worse it looks. Number 100 has as many as 13 notations which contain 13! And there are numbers which have 13 in infinite number of their notations! Luckily, you can do any math in binary, which is completely safe from the nasty number. But still, you want to be able to estimate the level of nastiness of any number. Your task is: given an integer n, find the number of different integer bases b (b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) for which n, written in base b, contains at least one 13. Assume that ""digits"" of the number in bases larger than 10 are written not as letters but as decimal numbers; thus, 30 in base 16 is not 1E but (1)(14) or simply 114. Please note, that 13 must be present as a substring of notation, not a subsequence (123 doesn\'t contain 13)." 2100
345A "Expecting Trouble" "*special problem,probabilities" "It is Friday the 13th today, and even though you\'re a modern well-educated person, you can\'t help feeling a bit nervous about it. You decide to look for evidence against this superstition (or for it). As a first step, you recall all Fridays the 13th in your life and calculate how many of them were unusually bad \xe2\x80\x94 like that time when you decided to play a game on ZX Spectrum and ended up breaking your TV set. The problem is, you can\'t remember some Fridays, and you\'re not sure why \xe2\x80\x94 were they really that bad?You have assembled a sequence of your recollections. Character ""0"" stands for a normal day, ""1"" \xe2\x80\x94 for a nasty one, and ""?"" means you have no idea what kind of day that was. Being a programmer, you decide to approximate these unknown days with independent random variables, which take value 1 with probability p, and 0 with probability (1\xe2\x80\x89-\xe2\x80\x89p).Given a string of your memories and the value of p, calculate out the expected value of average badness of your Fridays the 13th." 1500
344B "Simple Molecules" "brute force,graphs,math" "Mad scientist Mike is busy carrying out experiments in chemistry. Today he will attempt to join three atoms into one molecule.A molecule consists of atoms, with some pairs of atoms connected by atomic bonds. Each atom has a valence number \xe2\x80\x94 the number of bonds the atom must form with other atoms. An atom can form one or multiple bonds with any other atom, but it cannot form a bond with itself. The number of bonds of an atom in the molecule must be equal to its valence number.  Mike knows valence numbers of the three atoms. Find a molecule that can be built from these atoms according to the stated rules, or determine that it is impossible." 1200
344A Magnets implementation "Mad scientist Mike entertains himself by arranging rows of dominoes. He doesn\'t need dominoes, though: he uses rectangular magnets instead. Each magnet has two poles, positive (a ""plus"") and negative (a ""minus""). If two magnets are put together at a close distance, then the like poles will repel each other and the opposite poles will attract each other.Mike starts by laying one magnet horizontally on the table. During each following step Mike adds one more magnet horizontally to the right end of the row. Depending on how Mike puts the magnet on the table, it is either attracted to the previous one (forming a group of multiple magnets linked together) or repelled by it (then Mike lays this magnet at some distance to the right from the previous one). We assume that a sole magnet not linked to others forms a group of its own.  Mike arranged multiple magnets in a row. Determine the number of groups that the magnets formed." 800
343E "Pumping Stations" "brute force,dfs and similar,divide and conquer,flows,graphs,greedy,trees" "Mad scientist Mike has applied for a job. His task is to manage a system of water pumping stations.The system consists of n pumping stations, which are numbered by integers from 1 to n. Some pairs of stations are connected by bidirectional pipes through which water can flow in either direction (but only in one at a time). For each pipe you know its bandwidth \xe2\x80\x94 the maximum number of liters of water that can flow through it in one hour. Each pumping station can pump incoming water from some stations to other stations through the pipes, provided that in one hour the total influx of water to the station is equal to the total outflux of water from the station.It is Mike\'s responsibility to pump water between stations. From station a to station b through the pipes (possibly through other stations) within one hour one can transmit a certain number of liters of water according to the rules described above. During this time, water from other stations can not flow into station a, and can not flow out of the station b. However, any amount of water can flow out of station a or in station b. If a total of x litres of water flows out of the station a in an hour, then Mike gets x bollars more to his salary.To get paid, Mike needs to work for n\xe2\x80\x89-\xe2\x80\x891 days, according to the contract. On the first day he selects two stations v1 and v2, and within one hour he pumps a certain amount of water from v1 to v2. Next, on the i-th day Mike chooses a station vi\xe2\x80\x89+\xe2\x80\x891 that has been never selected before, and pumps a certain amount of water out of the station vi to station vi\xe2\x80\x89+\xe2\x80\x891 for one hour. The quantity of water he pumps on the i-th day does not depend on the amount of water pumped on the (i\xe2\x80\x89-\xe2\x80\x891)-th day.Mike needs to earn as much bollars as he can for his projects. Help Mike find such a permutation of station numbers v1, v2, ..., vn so Mike will be able to earn the highest possible salary." 2900
343D "Water Tree" "data structures,dfs and similar,graphs,trees" "Mad scientist Mike has constructed a rooted tree, which consists of n vertices. Each vertex is a reservoir which can be either empty or filled with water.The vertices of the tree are numbered from 1 to n with the root at vertex 1. For each vertex, the reservoirs of its children are located below the reservoir of this vertex, and the vertex is connected with each of the children by a pipe through which water can flow downwards.Mike wants to do the following operations with the tree:   Fill vertex v with water. Then v and all its children are filled with water.  Empty vertex v. Then v and all its ancestors are emptied.  Determine whether vertex v is filled with water at the moment.  Initially all vertices of the tree are empty.Mike has already compiled a full list of operations that he wants to perform in order. Before experimenting with the tree Mike decided to run the list through a simulation. Help Mike determine what results will he get after performing all the operations." 2100
343C "Read Time" "binary search,greedy,two pointers" "Mad scientist Mike does not use slow hard disks. His modification of a hard drive has not one, but n different heads that can read data in parallel.When viewed from the side, Mike\'s hard drive is an endless array of tracks. The tracks of the array are numbered from left to right with integers, starting with 1. In the initial state the i-th reading head is above the track number hi. For each of the reading heads, the hard drive\'s firmware can move the head exactly one track to the right or to the left, or leave it on the current track. During the operation each head\'s movement does not affect the movement of the other heads: the heads can change their relative order; there can be multiple reading heads above any of the tracks. A track is considered read if at least one head has visited this track. In particular, all of the tracks numbered h1, h2, ..., hn have been read at the beginning of the operation.  Mike needs to read the data on m distinct tracks with numbers p1, p2, ..., pm. Determine the minimum time the hard drive firmware needs to move the heads and read all the given tracks. Note that an arbitrary number of other tracks can also be read." 1900
343B "Alternating Current" "data structures,greedy,implementation" "Mad scientist Mike has just finished constructing a new device to search for extraterrestrial intelligence! He was in such a hurry to launch it for the first time that he plugged in the power wires without giving it a proper glance and started experimenting right away. After a while Mike observed that the wires ended up entangled and now have to be untangled again.The device is powered by two wires ""plus"" and ""minus"". The wires run along the floor from the wall (on the left) to the device (on the right). Both the wall and the device have two contacts in them on the same level, into which the wires are plugged in some order. The wires are considered entangled if there are one or more places where one wire runs above the other one. For example, the picture below has four such places (top view):  Mike knows the sequence in which the wires run above each other. Mike also noticed that on the left side, the ""plus"" wire is always plugged into the top contact (as seen on the picture). He would like to untangle the wires without unplugging them and without moving the device. Determine if it is possible to do that. A wire can be freely moved and stretched on the floor, but cannot be cut.To understand the problem better please read the notes to the test samples." 1600
343A "Rational Resistance" "math,number theory" "Mad scientist Mike is building a time machine in his spare time. To finish the work, he needs a resistor with a certain resistance value.However, all Mike has is lots of identical resistors with unit resistance R0\xe2\x80\x89=\xe2\x80\x891. Elements with other resistance can be constructed from these resistors. In this problem, we will consider the following as elements:   one resistor;  an element and one resistor plugged in sequence;  an element and one resistor plugged in parallel.   With the consecutive connection the resistance of the new element equals R\xe2\x80\x89=\xe2\x80\x89Re\xe2\x80\x89+\xe2\x80\x89R0. With the parallel connection the resistance of the new element equals . In this case Re equals the resistance of the element being connected.Mike needs to assemble an element with a resistance equal to the fraction . Determine the smallest possible number of resistors he needs to make such an element." 1600
342E "Xenia and Tree" "data structures,divide and conquer,trees" "Xenia the programmer has a tree consisting of n nodes. We will consider the tree nodes indexed from 1 to n. We will also consider the first node to be initially painted red, and the other nodes \xe2\x80\x94 to be painted blue.The distance between two tree nodes v and u is the number of edges in the shortest path between v and u.Xenia needs to learn how to quickly execute queries of two types:  paint a specified blue node in red;  calculate which red node is the closest to the given one and print the shortest distance to the closest red node. Your task is to write a program which will execute the described queries." 2400
342D "Xenia and Dominoes" "bitmasks,dfs and similar,dp" "Xenia likes puzzles very much. She is especially fond of the puzzles that consist of domino pieces. Look at the picture that shows one of such puzzles.  A puzzle is a 3\xe2\x80\x89\xc3\x97\xe2\x80\x89n table with forbidden cells (black squares) containing dominoes (colored rectangles on the picture). A puzzle is called correct if it meets the following conditions:  each domino occupies exactly two non-forbidden cells of the table;  no two dominoes occupy the same table cell;  exactly one non-forbidden cell of the table is unoccupied by any domino (it is marked by a circle in the picture). To solve the puzzle, you need multiple steps to transport an empty cell from the starting position to some specified position. A move is transporting a domino to the empty cell, provided that the puzzle stays correct. The horizontal dominoes can be moved only horizontally, and vertical dominoes can be moved only vertically. You can\'t rotate dominoes. The picture shows a probable move.Xenia has a 3\xe2\x80\x89\xc3\x97\xe2\x80\x89n table with forbidden cells and a cell marked with a circle. Also, Xenia has very many identical dominoes. Now Xenia is wondering, how many distinct correct puzzles she can make if she puts dominoes on the existing table. Also, Xenia wants the circle-marked cell to be empty in the resulting puzzle. The puzzle must contain at least one move.Help Xenia, count the described number of puzzles. As the described number can be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100
342C "Cupboard and Balloons" geometry "A girl named Xenia has a cupboard that looks like an arc from ahead. The arc is made of a semicircle with radius r (the cupboard\'s top) and two walls of height h (the cupboard\'s sides). The cupboard\'s depth is r, that is, it looks like a rectangle with base r and height h\xe2\x80\x89+\xe2\x80\x89r from the sides. The figure below shows what the cupboard looks like (the front view is on the left, the side view is on the right).  Xenia got lots of balloons for her birthday. The girl hates the mess, so she wants to store the balloons in the cupboard. Luckily, each balloon is a sphere with radius . Help Xenia calculate the maximum number of balloons she can put in her cupboard. You can say that a balloon is in the cupboard if you can\'t see any part of the balloon on the left or right view. The balloons in the cupboard can touch each other. It is not allowed to squeeze the balloons or deform them in any way. You can assume that the cupboard\'s walls are negligibly thin." 1900
342B "Xenia and Spies" "brute force,greedy,implementation" "Xenia the vigorous detective faced n (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) foreign spies lined up in a row. We\'ll consider the spies numbered from 1 to n from left to right. Spy s has an important note. He has to pass the note to spy f. Xenia interrogates the spies in several steps. During one step the spy keeping the important note can pass the note to one of his neighbours in the row. In other words, if this spy\'s number is x, he can pass the note to another spy, either x\xe2\x80\x89-\xe2\x80\x891 or x\xe2\x80\x89+\xe2\x80\x891 (if x\xe2\x80\x89=\xe2\x80\x891 or x\xe2\x80\x89=\xe2\x80\x89n, then the spy has only one neighbour). Also during a step the spy can keep a note and not pass it to anyone.But nothing is that easy. During m steps Xenia watches some spies attentively. Specifically, during step ti (steps are numbered from 1) Xenia watches spies numbers li,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Of course, if during some step a spy is watched, he can\'t do anything: neither give the note nor take it from some other spy. Otherwise, Xenia reveals the spies\' cunning plot. Nevertheless, if the spy at the current step keeps the note, Xenia sees nothing suspicious even if she watches him.You\'ve got s and f. Also, you have the steps during which Xenia watches spies and which spies she is going to watch during each step. Find the best way the spies should act in order to pass the note from spy s to spy f as quickly as possible (in the minimum number of steps)." 1500
342A "Xenia and Divisors" greedy,implementation "Xenia the mathematician has a sequence consisting of n (n is divisible by 3) positive integers, each of them is at most 7. She wants to split the sequence into groups of three so that for each group of three a,\xe2\x80\x89b,\xe2\x80\x89c the following conditions held:  a\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c;  a divides b, b divides c. Naturally, Xenia wants each element of the sequence to belong to exactly one group of three. Thus, if the required partition exists, then it has  groups of three.Help Xenia, find the required partition or else say that it doesn\'t exist." 1200
341E "Candies Game" "constructive algorithms,greedy" "Iahub is playing an uncommon game. Initially, he has n boxes, numbered 1, 2, 3, ..., n. Each box has some number of candies in it, described by a sequence a1, a2, ..., an. The number ak represents the number of candies in box k. The goal of the game is to move all candies into exactly two boxes. The rest of n\xe2\x80\x89-\xe2\x80\x892 boxes must contain zero candies. Iahub is allowed to do several (possible zero) moves. At each move he chooses two different boxes i and j, such that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj. Then, Iahub moves from box j to box i exactly ai candies. Obviously, when two boxes have equal number of candies, box number j becomes empty.Your task is to give him a set of moves such as Iahub to archive the goal of the game. If Iahub can\'t win the game for the given configuration of boxes, output -1. Please note that in case there exist a solution, you don\'t need to print the solution using minimal number of moves." 3000
341D "Iahub and Xors" "data structures" "Iahub does not like background stories, so he\'ll tell you exactly what this problem asks you for.You are given a matrix a with n rows and n columns. Initially, all values of the matrix are zeros. Both rows and columns are 1-based, that is rows are numbered 1, 2, ..., n and columns are numbered 1, 2, ..., n. Let\'s denote an element on the i-th row and j-th column as ai,\xe2\x80\x89j.We will call a submatrix (x0,\xe2\x80\x89y0,\xe2\x80\x89x1,\xe2\x80\x89y1) such elements ai,\xe2\x80\x89j for which two inequalities hold: x0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1, y0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1.Write a program to perform two following operations:  Query(x0, y0, x1, y1): print the xor sum of the elements of the submatrix (x0,\xe2\x80\x89y0,\xe2\x80\x89x1,\xe2\x80\x89y1).  Update(x0, y0, x1, y1, v): each element from submatrix (x0,\xe2\x80\x89y0,\xe2\x80\x89x1,\xe2\x80\x89y1) gets xor-ed by value v." 2500
340E "Iahub and Permutations" combinatorics,math "Iahub is so happy about inventing bubble sort graphs that he\'s staying all day long at the office and writing permutations. Iahubina is angry that she is no more important for Iahub. When Iahub goes away, Iahubina comes to his office and sabotage his research work.The girl finds an important permutation for the research. The permutation contains n distinct integers a1, a2, ..., an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). She replaces some of permutation elements with -1 value as a revenge. When Iahub finds out his important permutation is broken, he tries to recover it. The only thing he remembers about the permutation is it didn\'t have any fixed point. A fixed point for a permutation is an element ak which has value equal to k (ak\xe2\x80\x89=\xe2\x80\x89k). Your job is to proof to Iahub that trying to recover it is not a good idea. Output the number of permutations which could be originally Iahub\'s important permutation, modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000
340D "Bubble Sort Graph" "binary search,data structures,dp" "Iahub recently has learned Bubble Sort, an algorithm that is used to sort a permutation with n elements a1, a2, ..., an in ascending order. He is bored of this so simple algorithm, so he invents his own graph. The graph (let\'s call it G) initially has n vertices and 0 edges. During Bubble Sort execution, edges appear as described in the following algorithm (pseudocode). procedure bubbleSortGraph()    build a graph G with n vertices and 0 edges    repeat        swapped = false        for i = 1 to n - 1 inclusive do:            if a[i] > a[i + 1] then                add an undirected edge in G between a[i] and a[i + 1]                swap( a[i], a[i + 1] )                swapped = true            end if        end for    until not swapped     /* repeat the algorithm as long as swapped value is true. */ end procedureFor a graph, an independent set is a set of vertices in a graph, no two of which are adjacent (so there are no edges between vertices of an independent set). A maximum independent set is an independent set which has maximum cardinality. Given the permutation, find the size of the maximum independent set of graph G, if we use such permutation as the premutation a in procedure bubbleSortGraph." 1500
340C "Tourist Problem" combinatorics,implementation,math "Iahub is a big fan of tourists. He wants to become a tourist himself, so he planned a trip. There are n destinations on a straight road that Iahub wants to visit. Iahub starts the excursion from kilometer 0. The n destinations are described by a non-negative integers sequence a1, a2, ..., an. The number ak represents that the kth destination is at distance ak kilometers from the starting point. No two destinations are located in the same place. Iahub wants to visit each destination only once. Note that, crossing through a destination is not considered visiting, unless Iahub explicitly wants to visit it at that point. Also, after Iahub visits his last destination, he doesn\'t come back to kilometer 0, as he stops his trip at the last destination. The distance between destination located at kilometer x and next destination, located at kilometer y, is |x\xe2\x80\x89-\xe2\x80\x89y| kilometers. We call a ""route"" an order of visiting the destinations. Iahub can visit destinations in any order he wants, as long as he visits all n destinations and he doesn\'t visit a destination more than once. Iahub starts writing out on a paper all possible routes and for each of them, he notes the total distance he would walk. He\'s interested in the average number of kilometers he would walk by choosing a route. As he got bored of writing out all the routes, he asks you to help him." 1600
340B "Maximal Area Quadrilateral" "brute force,geometry" "Iahub has drawn a set of n points in the cartesian plane which he calls ""special points"". A quadrilateral is a simple polygon without self-intersections with four sides (also called edges) and four vertices (also called corners). Please note that a quadrilateral doesn\'t have to be convex. A special quadrilateral is one which has all four vertices in the set of special points. Given the set of special points, please calculate the maximal area of a special quadrilateral." 2100
340A "The Wall" math "Iahub and his friend Floyd have started painting a wall. Iahub is painting the wall red and Floyd is painting it pink. You can consider the wall being made of a very large number of bricks, numbered 1, 2, 3 and so on. Iahub has the following scheme of painting: he skips x\xe2\x80\x89-\xe2\x80\x891 consecutive bricks, then he paints the x-th one. That is, he\'ll paint bricks x, 2\xc2\xb7x, 3\xc2\xb7x and so on red. Similarly, Floyd skips y\xe2\x80\x89-\xe2\x80\x891 consecutive bricks, then he paints the y-th one. Hence he\'ll paint bricks y, 2\xc2\xb7y, 3\xc2\xb7y and so on pink.After painting the wall all day, the boys observed that some bricks are painted both red and pink. Iahub has a lucky number a and Floyd has a lucky number b. Boys wonder how many bricks numbered no less than a and no greater than b are painted both red and pink. This is exactly your task: compute and print the answer to the question." 1200
339E "Three Swaps" "constructive algorithms,dfs and similar,greedy" "Xenia the horse breeder has n (n\xe2\x80\x89>\xe2\x80\x891) horses that stand in a row. Each horse has its own unique number. Initially, the i-th left horse has number i. That is, the sequence of numbers of horses in a row looks as follows (from left to right): 1, 2, 3, ..., n.Xenia trains horses before the performance. During the practice sessions, she consistently gives them commands. Each command is a pair of numbers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The command l,\xe2\x80\x89r means that the horses that are on the l-th, (l\xe2\x80\x89+\xe2\x80\x891)-th, (l\xe2\x80\x89+\xe2\x80\x892)-th, ..., r-th places from the left must be rearranged. The horses that initially stand on the l-th and r-th places will swap. The horses on the (l\xe2\x80\x89+\xe2\x80\x891)-th and (r\xe2\x80\x89-\xe2\x80\x891)-th places will swap. The horses on the (l\xe2\x80\x89+\xe2\x80\x892)-th and (r\xe2\x80\x89-\xe2\x80\x892)-th places will swap and so on. In other words, the horses that were on the segment [l,\xe2\x80\x89r] change their order to the reverse one.For example, if Xenia commanded l\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89r\xe2\x80\x89=\xe2\x80\x895, and the sequence of numbers of horses before the command looked as (2, 1, 3, 4, 5, 6), then after the command the sequence will be (2, 5, 4, 3, 1, 6).We know that during the practice Xenia gave at most three commands of the described form. You have got the final sequence of numbers of horses by the end of the practice. Find what commands Xenia gave during the practice. Note that you do not need to minimize the number of commands in the solution, find any valid sequence of at most three commands." 2700
339D "Xenia and Bit Operations" "data structures,trees" "Xenia the beginner programmer has a sequence a, consisting of 2n non-negative integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a2n. Xenia is currently studying bit operations. To better understand how they work, Xenia decided to calculate some value v for a.Namely, it takes several iterations to calculate value v. At the first iteration, Xenia writes a new sequence a1 or a2,\xe2\x80\x89a3 or a4,\xe2\x80\x89...,\xe2\x80\x89a2n\xe2\x80\x89-\xe2\x80\x891 or a2n, consisting of 2n\xe2\x80\x89-\xe2\x80\x891 elements. In other words, she writes down the bit-wise OR of adjacent elements of sequence a. At the second iteration, Xenia writes the bitwise exclusive OR of adjacent elements of the sequence obtained after the first iteration. At the third iteration Xenia writes the bitwise OR of the adjacent elements of the sequence obtained after the second iteration. And so on; the operations of bitwise exclusive OR and bitwise OR alternate. In the end, she obtains a sequence consisting of one element, and that element is v.Let\'s consider an example. Suppose that sequence a\xe2\x80\x89=\xe2\x80\x89(1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894). Then let\'s write down all the transformations (1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (1 or 2\xe2\x80\x89=\xe2\x80\x893,\xe2\x80\x893 or 4\xe2\x80\x89=\xe2\x80\x897) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (3 xor 7\xe2\x80\x89=\xe2\x80\x894). The result is v\xe2\x80\x89=\xe2\x80\x894.You are given Xenia\'s initial sequence. But to calculate value v for a given sequence would be too easy, so you are given additional m queries. Each query is a pair of integers p,\xe2\x80\x89b. Query p,\xe2\x80\x89b means that you need to perform the assignment ap\xe2\x80\x89=\xe2\x80\x89b. After each query, you need to print the new value v for the new sequence a." 1700
339C "Xenia and Weights" "constructive algorithms,dfs and similar,dp,graphs,greedy,shortest paths" "Xenia has a set of weights and pan scales. Each weight has an integer weight from 1 to 10 kilos. Xenia is going to play with scales and weights a little. For this, she puts weights on the scalepans, one by one. The first weight goes on the left scalepan, the second weight goes on the right scalepan, the third one goes on the left scalepan, the fourth one goes on the right scalepan and so on. Xenia wants to put the total of m weights on the scalepans.Simply putting weights on the scales is not interesting, so Xenia has set some rules. First, she does not put on the scales two consecutive weights of the same weight. That is, the weight that goes i-th should be different from the (i\xe2\x80\x89+\xe2\x80\x891)-th weight for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89m). Second, every time Xenia puts a weight on some scalepan, she wants this scalepan to outweigh the other one. That is, the sum of the weights on the corresponding scalepan must be strictly greater than the sum on the other pan.You are given all types of weights available for Xenia. You can assume that the girl has an infinite number of weights of each specified type. Your task is to help Xenia lay m weights on \xe2\x80\x8b\xe2\x80\x8bthe scales or to say that it can\'t be done." 1700
339B "Xenia and Ringroad" implementation "Xenia lives in a city that has n houses built along the main ringroad. The ringroad houses are numbered 1 through n in the clockwise order. The ringroad traffic is one way and also is clockwise.Xenia has recently moved into the ringroad house number 1. As a result, she\'s got m things to do. In order to complete the i-th task, she needs to be in the house number ai and complete all tasks with numbers less than i. Initially, Xenia is in the house number 1, find the minimum time she needs to complete all her tasks if moving from a house to a neighboring one along the ringroad takes one unit of time." 1000
339A "Helpful Maths" greedy,implementation,sortings,strings "Xenia the beginner mathematician is a third year student at elementary school. She is now learning the addition operation.The teacher has written down the sum of multiple numbers. Pupils should calculate the sum. To make the calculation easier, the sum only contains numbers 1, 2 and 3. Still, that isn\'t enough for Xenia. She is only beginning to count, so she can calculate a sum only if the summands follow in non-decreasing order. For example, she can\'t calculate sum 1+3+2+1 but she can calculate sums 1+1+2 and 3+3.You\'ve got the sum that was written on the board. Rearrange the summans and print the sum in such a way that Xenia can calculate the sum." 800
338E Optimize! "data structures" "Manao is solving a problem with the following statement:  He came up with a solution that produces the correct answers but is too slow. You are given the pseudocode of his solution, where the function getAnswer calculates the answer to the problem:getAnswer(a[1..n], b[1..len], h)  answer = 0  for i = 1 to n-len+1    answer = answer + f(a[i..i+len-1], b, h, 1)  return answerf(s[1..len], b[1..len], h, index)  if index = len+1 then    return 1  for i = 1 to len    if s[index] + b[i] >= h      mem = b[i]      b[i] = 0      res = f(s, b, h, index + 1)      b[i] = mem      if res > 0        return 1  return 0Your task is to help Manao optimize his algorithm." 2600
338D "GCD Table" "chinese remainder theorem,math,number theory" "Consider a table G of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m such that G(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89GCD(i,\xe2\x80\x89j) for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. GCD(a,\xe2\x80\x89b) is the greatest common divisor of numbers a and b.You have a sequence of positive integer numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak. We say that this sequence occurs in table G if it coincides with consecutive elements in some row, starting from some position. More formally, such numbers 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 should exist that G(i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89al for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k.Determine if the sequence a occurs in table G." 2900
337E "Divisor Tree" "brute force,number theory,trees" "A divisor tree is a rooted tree that meets the following conditions:   Each vertex of the tree contains a positive integer number.  The numbers written in the leaves of the tree are prime numbers.  For any inner vertex, the number within it is equal to the product of the numbers written in its children. Manao has n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He tries to build a divisor tree which contains each of these numbers. That is, for each ai, there should be at least one vertex in the tree which contains ai. Manao loves compact style, but his trees are too large. Help Manao determine the minimum possible number of vertices in the divisor tree sought." 2200
337D "Book of Evil" "dfs and similar,divide and conquer,dp,trees" "Paladin Manao caught the trail of the ancient Book of Evil in a swampy area. This area contains n settlements numbered from 1 to n. Moving through the swamp is very difficult, so people tramped exactly n\xe2\x80\x89-\xe2\x80\x891 paths. Each of these paths connects some pair of settlements and is bidirectional. Moreover, it is possible to reach any settlement from any other one by traversing one or several paths.The distance between two settlements is the minimum number of paths that have to be crossed to get from one settlement to the other one. Manao knows that the Book of Evil has got a damage range d. This means that if the Book of Evil is located in some settlement, its damage (for example, emergence of ghosts and werewolves) affects other settlements at distance d or less from the settlement where the Book resides.Manao has heard of m settlements affected by the Book of Evil. Their numbers are p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pm. Note that the Book may be affecting other settlements as well, but this has not been detected yet. Manao wants to determine which settlements may contain the Book. Help him with this difficult task." 2000
337C Quiz "binary search,greedy,math,matrices,number theory" "Manao is taking part in a quiz. The quiz consists of n consecutive questions. A correct answer gives one point to the player. The game also has a counter of consecutive correct answers. When the player answers a question correctly, the number on this counter increases by 1. If the player answers a question incorrectly, the counter is reset, that is, the number on it reduces to 0. If after an answer the counter reaches the number k, then it is reset, and the player\'s score is doubled. Note that in this case, first 1 point is added to the player\'s score, and then the total score is doubled. At the beginning of the game, both the player\'s score and the counter of consecutive correct answers are set to zero.Manao remembers that he has answered exactly m questions correctly. But he does not remember the order in which the questions came. He\'s trying to figure out what his minimum score may be. Help him and compute the remainder of the corresponding number after division by 1000000009 (109\xe2\x80\x89+\xe2\x80\x899)." 1600
337B "Routine Problem" "greedy,math,number theory" "Manao has a monitor. The screen of the monitor has horizontal to vertical length ratio a:b. Now he is going to watch a movie. The movie\'s frame has horizontal to vertical length ratio c:d. Manao adjusts the view in such a way that the movie preserves the original frame ratio, but also occupies as much space on the screen as possible and fits within it completely. Thus, he may have to zoom the movie in or out, but Manao will always change the frame proportionally in both dimensions.Calculate the ratio of empty screen (the part of the screen not occupied by the movie) to the total screen size. Print the answer as an irreducible fraction p\xe2\x80\x89/\xe2\x80\x89q." 1400
337A Puzzles greedy "The end of the school year is near and Ms. Manana, the teacher, will soon have to say goodbye to a yet another class. She decided to prepare a goodbye present for her n students and give each of them a jigsaw puzzle (which, as wikipedia states, is a tiling puzzle that requires the assembly of numerous small, often oddly shaped, interlocking and tessellating pieces).The shop assistant told the teacher that there are m puzzles in the shop, but they might differ in difficulty and size. Specifically, the first jigsaw puzzle consists of f1 pieces, the second one consists of f2 pieces and so on.Ms. Manana doesn\'t want to upset the children, so she decided that the difference between the numbers of pieces in her presents must be as small as possible. Let A be the number of pieces in the largest puzzle that the teacher buys and B be the number of pieces in the smallest such puzzle. She wants to choose such n puzzles that A\xe2\x80\x89-\xe2\x80\x89B is minimum possible. Help the teacher and find the least possible value of A\xe2\x80\x89-\xe2\x80\x89B." 900
336E "Vasily the Bear and Painting Square" bitmasks,combinatorics,dp,implementation "Vasily the bear has two favorite integers n and k and a pencil. Besides, he\'s got k jars with different water color paints. All jars are numbered in some manner from 1 to k, inclusive. The jar number i contains the paint of the i-th color. Initially the bear took a pencil and drew four segments on the coordinate plane. All of them end at point (0,\xe2\x80\x890). They begin at: (0,\xe2\x80\x892n), (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892n), (2n,\xe2\x80\x890), (\xe2\x80\x89-\xe2\x80\x892n,\xe2\x80\x890). Then for each i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, the bear drew two squares. The first square has the following vertex coordinates: (2i,\xe2\x80\x890), (\xe2\x80\x89-\xe2\x80\x892i,\xe2\x80\x890), (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892i), (0,\xe2\x80\x892i). The second square has the following vertex coordinates: (\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891), (\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891), (2i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891), (2i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x892i\xe2\x80\x89-\xe2\x80\x891). After that, the bear drew another square: (1,\xe2\x80\x890), (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890), (0,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891), (0,\xe2\x80\x891). All points mentioned above form the set of points A.The sample of the final picture at n\xe2\x80\x89=\xe2\x80\x890The sample of the final picture at n\xe2\x80\x89=\xe2\x80\x892The bear decided to paint the resulting picture in k moves. The i-th move consists of the following stages:   The bear chooses 3 distinct points in set \xd0\x90 so that any pair of the chosen points has a segment on the picture between them. The chosen points and segments mark the area that mustn\'t contain any previously painted points.  The bear paints the area bounded by the chosen points and segments the i-th color. Note that after the k-th move some parts of the picture can stay unpainted.The bear asked you to calculate, how many distinct ways there are to paint his picture. A way to paint the picture is a sequence of three-element sets of points he chose on each step. Two sequences are considered distinct if there is such number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that the i-th members of these sequences do not coincide as sets. As the sought number can be rather large, you only need to calculate the remainder after dividing it by number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700
336D "Vasily the Bear and Beautiful Strings" "combinatorics,math,number theory" "Vasily the Bear loves beautiful strings. String s is beautiful if it meets the following criteria:   String s only consists of characters 0 and 1, at that character 0 must occur in string s exactly n times, and character 1 must occur exactly m times.  We can obtain character g from string s with some (possibly, zero) number of modifications. The character g equals either zero or one. A modification of string with length at least two is the following operation: we replace two last characters from the string by exactly one other character. This character equals one if it replaces two zeros, otherwise it equals zero. For example, one modification transforms string ""01010"" into string ""0100"", two modifications transform it to ""011"". It is forbidden to modify a string with length less than two.Help the Bear, count the number of beautiful strings. As the number of beautiful strings can be rather large, print the remainder after dividing the number by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100
336C "Vasily the Bear and Sequence" "brute force,greedy,implementation,number theory" "Vasily the bear has got a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Vasily the Bear wants to write out several numbers on a piece of paper so that the beauty of the numbers he wrote out was maximum. The beauty of the written out numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk is such maximum non-negative integer v, that number b1 and b2 and ... and bk is divisible by number 2v without a remainder. If such number v doesn\'t exist (that is, for any non-negative integer v, number b1 and b2 and ... and bk is divisible by 2v without a remainder), the beauty of the written out numbers equals -1. Tell the bear which numbers he should write out so that the beauty of the written out numbers is maximum. If there are multiple ways to write out the numbers, you need to choose the one where the bear writes out as many numbers as possible.Here expression x and y means applying the bitwise AND operation to numbers x and y. In programming languages C++ and Java this operation is represented by ""&"", in Pascal \xe2\x80\x94 by ""and""." 1800
336B "Vasily the Bear and Fly" math "One beautiful day Vasily the bear painted 2m circles of the same radius R on a coordinate plane. Circles with numbers from 1 to m had centers at points (2R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), (4R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), ..., (2Rm\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x890), respectively. Circles with numbers from m\xe2\x80\x89+\xe2\x80\x891 to 2m had centers at points (2R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), (4R\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), ..., (2Rm\xe2\x80\x89-\xe2\x80\x89R,\xe2\x80\x892R), respectively. Naturally, the bear painted the circles for a simple experiment with a fly. The experiment continued for m2 days. Each day of the experiment got its own unique number from 0 to m2\xe2\x80\x89-\xe2\x80\x891, inclusive. On the day number i the following things happened:   The fly arrived at the coordinate plane at the center of the circle with number  ( is the result of dividing number x by number y, rounded down to an integer).  The fly went along the coordinate plane to the center of the circle number  ( is the remainder after dividing number x by number y). The bear noticed that the fly went from the center of circle v to the center of circle u along the shortest path with all points lying on the border or inside at least one of the 2m circles. After the fly reached the center of circle u, it flew away in an unknown direction. Help Vasily, count the average distance the fly went along the coordinate plane during each of these m2 days." 1900
336A "Vasily the Bear and Triangle" implementation,math "Vasily the bear has a favorite rectangle, it has one vertex at point (0,\xe2\x80\x890), and the opposite vertex at point (x,\xe2\x80\x89y). Of course, the sides of Vasya\'s favorite rectangle are parallel to the coordinate axes. Vasya also loves triangles, if the triangles have one vertex at point B\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890). That\'s why today he asks you to find two points A\xe2\x80\x89=\xe2\x80\x89(x1,\xe2\x80\x89y1) and C\xe2\x80\x89=\xe2\x80\x89(x2,\xe2\x80\x89y2), such that the following conditions hold:  the coordinates of points: x1, x2, y1, y2 are integers. Besides, the following inequation holds: x1\xe2\x80\x89<\xe2\x80\x89x2;  the triangle formed by point A, B and C is rectangular and isosceles ( is right);  all points of the favorite rectangle are located inside or on the border of triangle ABC;  the area of triangle ABC is as small as possible. Help the bear, find the required points. It is not so hard to proof that these points are unique." 1000
335F "Buy One, Get One Free" dp,greedy "A nearby pie shop is having a special sale. For each pie you pay full price for, you may select one pie of a strictly lesser value to get for free. Given the prices of all the pies you wish to acquire, determine the minimum total amount you must pay for all of the pies." 3000
335E "Counting Skyscrapers" dp,math,probabilities "A number of skyscrapers have been built in a line. The number of skyscrapers was chosen uniformly at random between 2 and 314! (314 factorial, a very large number). The height of each skyscraper was chosen randomly and independently, with height i having probability 2\xe2\x80\x89-\xe2\x80\x89i for all positive integers i. The floors of a skyscraper with height i are numbered 0 through i\xe2\x80\x89-\xe2\x80\x891.To speed up transit times, a number of zip lines were installed between skyscrapers. Specifically, there is a zip line connecting the i-th floor of one skyscraper with the i-th floor of another skyscraper if and only if there are no skyscrapers between them that have an i-th floor.Alice and Bob decide to count the number of skyscrapers.Alice is thorough, and wants to know exactly how many skyscrapers there are. She begins at the leftmost skyscraper, with a counter at 1. She then moves to the right, one skyscraper at a time, adding 1 to her counter each time she moves. She continues until she reaches the rightmost skyscraper.Bob is impatient, and wants to finish as fast as possible. He begins at the leftmost skyscraper, with a counter at 1. He moves from building to building using zip lines. At each stage Bob uses the highest available zip line to the right, but ignores floors with a height greater than h due to fear of heights. When Bob uses a zip line, he travels too fast to count how many skyscrapers he passed. Instead, he just adds 2i to his counter, where i is the number of the floor he\'s currently on. He continues until he reaches the rightmost skyscraper.Consider the following example. There are 6 buildings, with heights 1, 4, 3, 4, 1, 2 from left to right, and h\xe2\x80\x89=\xe2\x80\x892. Alice begins with her counter at 1 and then adds 1 five times for a result of 6. Bob begins with his counter at 1, then he adds 1, 4, 4, and 2, in order, for a result of 12. Note that Bob ignores the highest zip line because of his fear of heights (h\xe2\x80\x89=\xe2\x80\x892).  Bob\'s counter is at the top of the image, and Alice\'s counter at the bottom. All zip lines are shown. Bob\'s path is shown by the green dashed line and Alice\'s by the pink dashed line. The floors of the skyscrapers are numbered, and the zip lines Bob uses are marked with the amount he adds to his counter.When Alice and Bob reach the right-most skyscraper, they compare counters. You will be given either the value of Alice\'s counter or the value of Bob\'s counter, and must compute the expected value of the other\'s counter." 2800
335D "Rectangles and Square" "brute force,dp" "You are given n rectangles, labeled 1 through n. The corners of rectangles have integer coordinates and their edges are parallel to the Ox and Oy axes. The rectangles may touch each other, but they do not overlap (that is, there are no points that belong to the interior of more than one rectangle).Your task is to determine if there\'s a non-empty subset of the rectangles that forms a square. That is, determine if there exists a subset of the rectangles and some square for which every point that belongs to the interior or the border of that square belongs to the interior or the border of at least one of the rectangles in the subset, and every point that belongs to the interior or the border of at least one rectangle in the subset belongs to the interior or the border of that square." 2400
335C "More Reclamation" games "In a far away land, there are two cities near a river. One day, the cities decide that they have too little space and would like to reclaim some of the river area into land.The river area can be represented by a grid with r rows and exactly two columns \xe2\x80\x94 each cell represents a rectangular area. The rows are numbered 1 through r from top to bottom, while the columns are numbered 1 and 2.Initially, all of the cells are occupied by the river. The plan is to turn some of those cells into land one by one, with the cities alternately choosing a cell to reclaim, and continuing until no more cells can be reclaimed.However, the river is also used as a major trade route. The cities need to make sure that ships will still be able to sail from one end of the river to the other. More formally, if a cell (r,\xe2\x80\x89c) has been reclaimed, it is not allowed to reclaim any of the cells (r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x893\xe2\x80\x89-\xe2\x80\x89c), (r,\xe2\x80\x893\xe2\x80\x89-\xe2\x80\x89c), or (r\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x893\xe2\x80\x89-\xe2\x80\x89c).The cities are not on friendly terms, and each city wants to be the last city to reclaim a cell (they don\'t care about how many cells they reclaim, just who reclaims a cell last). The cities have already reclaimed n cells. Your job is to determine which city will be the last to reclaim a cell, assuming both choose cells optimally from current moment." 2100
335B Palindrome "constructive algorithms,dp" "Given a string s, determine if it contains any palindrome of length exactly 100 as a subsequence. If it has any, print any one of them. If it doesn\'t have any, print a palindrome that is a subsequence of s and is as long as possible." 1900
335A Banana "binary search,constructive algorithms,greedy" "Piegirl is buying stickers for a project. Stickers come on sheets, and each sheet of stickers contains exactly n stickers. Each sticker has exactly one character printed on it, so a sheet of stickers can be described by a string of length n. Piegirl wants to create a string s using stickers. She may buy as many sheets of stickers as she wants, and may specify any string of length n for the sheets, but all the sheets must be identical, so the string is the same for all sheets. Once she attains the sheets of stickers, she will take some of the stickers from the sheets and arrange (in any order) them to form s. Determine the minimum number of sheets she has to buy, and provide a string describing a possible sheet of stickers she should buy." 1400
334B "Eight Point Sets" sortings "Gerald is very particular to eight point sets. He thinks that any decent eight point set must consist of all pairwise intersections of three distinct integer vertical straight lines and three distinct integer horizontal straight lines, except for the average of these nine points. In other words, there must be three integers x1,\xe2\x80\x89x2,\xe2\x80\x89x3 and three more integers y1,\xe2\x80\x89y2,\xe2\x80\x89y3, such that x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89<\xe2\x80\x89x3, y1\xe2\x80\x89<\xe2\x80\x89y2\xe2\x80\x89<\xe2\x80\x89y3 and the eight point set consists of all points (xi,\xe2\x80\x89yj) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893), except for point (x2,\xe2\x80\x89y2).You have a set of eight points. Find out if Gerald can use this set?" 1400
334A "Candy Bags" implementation "Gerald has n younger brothers and their number happens to be even. One day he bought n2 candy bags. One bag has one candy, one bag has two candies, one bag has three candies and so on. In fact, for each integer k from 1 to n2 he has exactly one bag with k candies. Help him give n bags of candies to each brother so that all brothers got the same number of candies." 1000
333E "Summer Earnings" "binary search,bitmasks,brute force,geometry,sortings" "Many schoolchildren look for a job for the summer, and one day, when Gerald was still a schoolboy, he also decided to work in the summer. But as Gerald was quite an unusual schoolboy, he found quite unusual work. A certain Company agreed to pay him a certain sum of money if he draws them three identical circles on a plane. The circles must not interfere with each other (but they may touch each other). He can choose the centers of the circles only from the n options granted by the Company. He is free to choose the radius of the circles himself (all three radiuses must be equal), but please note that the larger the radius is, the more he gets paid. Help Gerald earn as much as possible." 2500
333D "Characteristics of Rectangles" "binary search,bitmasks,brute force,implementation,sortings" "Gerald found a table consisting of n rows and m columns. As a prominent expert on rectangular tables, he immediately counted the table\'s properties, that is, the minimum of the numbers in the corners of the table (minimum of four numbers). However, he did not like the final value \xe2\x80\x94 it seemed to be too small. And to make this value larger, he decided to crop the table a little: delete some columns on the left and some on the right, as well as some rows from the top and some from the bottom. Find what the maximum property of the table can be after such cropping. Note that the table should have at least two rows and at least two columns left in the end. The number of cropped rows or columns from each of the four sides can be zero." 2100
333C "Lucky Tickets" "brute force,constructive algorithms" "Gerald has a friend, Pollard. Pollard is interested in lucky tickets (ticket is a sequence of digits). At first he thought that a ticket is lucky if between some its digits we can add arithmetic signs and brackets so that the result obtained by the arithmetic expression was number 100. But he quickly analyzed all such tickets and moved on to a more general question. Now he explores k-lucky tickets.Pollard sais that a ticket is k-lucky if we can add arithmetic operation signs between its digits to the left or right of them (i.e., ""+"", ""-"", ""\xe2\x80\x89\xc3\x97\xe2\x80\x89"") and brackets so as to obtain the correct arithmetic expression whose value would equal k. For example, ticket ""224201016"" is 1000-lucky as (\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x89(2\xe2\x80\x89+\xe2\x80\x894))\xe2\x80\x89\xc3\x97\xe2\x80\x89(2\xe2\x80\x89+\xe2\x80\x890)\xe2\x80\x89+\xe2\x80\x891016\xe2\x80\x89=\xe2\x80\x891000.Pollard was so carried away by the lucky tickets that he signed up for a seminar on lucky tickets and, as far as Gerald knows, Pollard will attend it daily at 7 pm in some famous institute and will commute to it in the same tram for m days. In this tram tickets have eight digits. And Gerald wants to make a surprise for Pollard: each day Pollard will receive a tram k-lucky ticket. The conductor has already agreed to give Pollard certain tickets during all these m days and he only wants Gerald to tell him what kind of tickets to give out. In this regard, help Gerald pick exactly m distinct k-lucky tickets." 2700
333B Chips greedy "Gerald plays the following game. He has a checkered field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells, where m various cells are banned. Before the game, he has to put a few chips on some border (but not corner) board cells. Then for n\xe2\x80\x89-\xe2\x80\x891 minutes, Gerald every minute moves each chip into an adjacent cell. He moves each chip from its original edge to the opposite edge. Gerald loses in this game in each of the three cases:  At least one of the chips at least once fell to the banned cell.  At least once two chips were on the same cell.  At least once two chips swapped in a minute (for example, if you stand two chips on two opposite border cells of a row with even length, this situation happens in the middle of the row). In that case he loses and earns 0 points. When nothing like that happened, he wins and earns the number of points equal to the number of chips he managed to put on the board. Help Gerald earn the most points." 1800
333A Secrets greedy "Gerald has been selling state secrets at leisure. All the secrets cost the same: n marks. The state which secrets Gerald is selling, has no paper money, only coins. But there are coins of all positive integer denominations that are powers of three: 1 mark, 3 marks, 9 marks, 27 marks and so on. There are no coins of other denominations. Of course, Gerald likes it when he gets money without the change. And all buyers respect him and try to give the desired sum without change, if possible. But this does not always happen.One day an unlucky buyer came. He did not have the desired sum without change. Then he took out all his coins and tried to give Gerald a larger than necessary sum with as few coins as possible. What is the maximum number of coins he could get?The formal explanation of the previous paragraph: we consider all the possible combinations of coins for which the buyer can not give Gerald the sum of n marks without change. For each such combination calculate the minimum number of coins that can bring the buyer at least n marks. Among all combinations choose the maximum of the minimum number of coins. This is the number we want." 1600
332E "Binary Key" dp,greedy,implementation "Let\'s assume that p and q are strings of positive length, called the container and the key correspondingly, string q only consists of characters 0 and 1. Let\'s take a look at a simple algorithm that extracts message s from the given container p:i = 0;j = 0;s = <>;while i is less than the length of the string p{    if q[j] == 1, then add to the right of string s character p[i];    increase variables i, j by one;    if the value of the variable j equals the length of the string q, then j = 0; }In the given pseudocode i, j are integer variables, s is a string, \'=\' is an assignment operator, \'==\' is a comparison operation, \'[]\' is the operation of obtaining the string character with the preset index, \'<>\' is an empty string. We suppose that in all strings the characters are numbered starting from zero. We understand that implementing such algorithm is quite easy, so your task is going to be slightly different. You need to construct the lexicographically minimum key of length k, such that when it is used, the algorithm given above extracts message s from container p (otherwise find out that such key doesn\'t exist)." 2400
332D "Theft of Blueprints" graphs,math "Insurgents accidentally got hold of the plan of a top secret research polygon created on a distant planet for the needs of the Galaxy Empire. The insurgents suppose that this polygon is developing new deadly weapon. The polygon consists of n missile silos connected by bidirectional underground passages. The passages are linked to laboratories where research is conducted. Naturally, the passages are guarded severely: the passage between silos i and j is patrolled by ci,\xe2\x80\x89j war droids.The insurgents studied the polygon plan and noticed its unusual structure. As it turned out, for any k-element set of silos S there is exactly one silo that is directly connected by a passage with each silo from S (we\'ll call this silo adjacent with S). Having considered that, the insurgents decided to act as follows:  they choose a k-element set of silos S;  a group of scouts lands from the air into each silo from S;  each group moves along the corresponding passage to the silo, adjacent with S (as the scouts move, they check out the laboratories and watch for any signs of weapon blueprints);  in the silo, adjacent with S, the groups get on the ship and fly away. The danger of the operation is the total number of droids that patrol the passages through which the scouts will go. The danger of the operation obviously only depends on the way to choose set S. The insurgents haven\'t yet decided on the exact silos to send the scouts to. However, they already want to start preparing the weapons for the scout groups. To do that, the insurgents need to know the mathematical average of the dangers of the operations that correspond to all possible ways to choose set S. Solve this problem to help the insurgents protect the ideals of the Republic!" 2400
332C "Students\' Revenge" "data structures,greedy,sortings" "A student\'s life is fraught with complications. Some Berland University students know this only too well. Having studied for two years, they contracted strong antipathy towards the chairperson of some department. Indeed, the person in question wasn\'t the kindest of ladies to begin with: prone to reforming groups, banning automatic passes and other mean deeds. At last the students decided that she just can\'t get away with all this anymore...The students pulled some strings on the higher levels and learned that the next University directors\' meeting is going to discuss n orders about the chairperson and accept exactly p of them. There are two values assigned to each order: ai is the number of the chairperson\'s hairs that turn grey if she obeys the order and bi \xe2\x80\x94 the displeasement of the directors if the order isn\'t obeyed. The students may make the directors pass any p orders chosen by them. The students know that the chairperson will obey exactly k out of these p orders. She will pick the orders to obey in the way that minimizes first, the directors\' displeasement and second, the number of hairs on her head that turn grey.The students want to choose p orders in the way that maximizes the number of hairs on the chairperson\'s head that turn grey. If there are multiple ways to accept the orders, then the students are keen on maximizing the directors\' displeasement with the chairperson\'s actions. Help them." 2200
332B "Maximum Absurdity" "data structures,dp,implementation" "Reforms continue entering Berland. For example, during yesterday sitting the Berland Parliament approved as much as n laws (each law has been assigned a unique number from 1 to n). Today all these laws were put on the table of the President of Berland, G.W. Boosch, to be signed.This time mr. Boosch plans to sign 2k laws. He decided to choose exactly two non-intersecting segments of integers from 1 to n of length k and sign all laws, whose numbers fall into these segments. More formally, mr. Boosch is going to choose two integers a, b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89k) and sign all laws with numbers lying in the segments [a; a\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891] and [b; b\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891] (borders are included).As mr. Boosch chooses the laws to sign, he of course considers the public opinion. Allberland Public Opinion Study Centre (APOSC) conducted opinion polls among the citizens, processed the results into a report and gave it to the president. The report contains the absurdity value for each law, in the public opinion. As mr. Boosch is a real patriot, he is keen on signing the laws with the maximum total absurdity. Help him." 1500
332A "Down the Hatch!" implementation "Everybody knows that the Berland citizens are keen on health, especially students. Berland students are so tough that all they drink is orange juice!Yesterday one student, Vasya and his mates made some barbecue and they drank this healthy drink only. After they ran out of the first barrel of juice, they decided to play a simple game. All n people who came to the barbecue sat in a circle (thus each person received a unique index bi from 0 to n\xe2\x80\x89-\xe2\x80\x891). The person number 0 started the game (this time it was Vasya). All turns in the game were numbered by integers starting from 1. If the j-th turn was made by the person with index bi, then this person acted like that:  he pointed at the person with index (bi\xe2\x80\x89+\xe2\x80\x891) mod n either with an elbow or with a nod (x mod y is the remainder after dividing x by y);  if j\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x894 and the players who had turns number j\xe2\x80\x89-\xe2\x80\x891, j\xe2\x80\x89-\xe2\x80\x892, j\xe2\x80\x89-\xe2\x80\x893, made during their turns the same moves as player bi on the current turn, then he had drunk a glass of juice;  the turn went to person number (bi\xe2\x80\x89+\xe2\x80\x891) mod n. The person who was pointed on the last turn did not make any actions.The problem was, Vasya\'s drunk too much juice and can\'t remember the goal of the game. However, Vasya\'s got the recorded sequence of all the participants\' actions (including himself). Now Vasya wants to find out the maximum amount of juice he could drink if he played optimally well (the other players\' actions do not change). Help him.You can assume that in any scenario, there is enough juice for everybody." 1300
331E2 "Deja Vu" "constructive algorithms,dp" "Everybody knows that we have been living in the Matrix for a long time. And in the new seventh Matrix the world is ruled by beavers.So let\'s take beaver Neo. Neo has so-called ""deja vu"" outbursts when he gets visions of events in some places he\'s been at or is going to be at. Let\'s examine the phenomenon in more detail.We can say that Neo\'s city is represented by a directed graph, consisting of n shops and m streets that connect the shops. No two streets connect the same pair of shops (besides, there can\'t be one street from A to B and one street from B to A). No street connects a shop with itself. As Neo passes some streets, he gets visions. No matter how many times he passes street k, every time he will get the same visions in the same order. A vision is a sequence of shops.We know that Neo is going to get really shocked if he passes the way from some shop a to some shop b, possible coinciding with a, such that the list of visited shops in the real life and in the visions coincide.Suggest beaver Neo such path of non-zero length. Or maybe you can even count the number of such paths modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)?.." 3100
331E1 "Deja Vu" "constructive algorithms,graphs,implementation" "Everybody knows that we have been living in the Matrix for a long time. And in the new seventh Matrix the world is ruled by beavers.So let\'s take beaver Neo. Neo has so-called ""deja vu"" outbursts when he gets visions of events in some places he\'s been at or is going to be at. Let\'s examine the phenomenon in more detail.We can say that Neo\'s city is represented by a directed graph, consisting of n shops and m streets that connect the shops. No two streets connect the same pair of shops (besides, there can\'t be one street from A to B and one street from B to A). No street connects a shop with itself. As Neo passes some streets, he gets visions. No matter how many times he passes street k, every time he will get the same visions in the same order. A vision is a sequence of shops.We know that Neo is going to get really shocked if he passes the way from some shop a to some shop b, possible coinciding with a, such that the list of visited shops in the real life and in the visions coincide.Suggest beaver Neo such path of non-zero length. Or maybe you can even count the number of such paths modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)?.." 2900
331D3 "Escaping on Beaveractor" "data structures,implementation,trees" "Don\'t put up with what you\'re sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b square on a plane. Each point x,\xe2\x80\x89y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.The campus obeys traffic rules: there are n arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow\'s direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.The BSA scientists want to transport the brand new Beaveractor to the ""Academic Tractor"" research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have q plans, representing the Beaveractor\'s initial position (xi,\xe2\x80\x89yi), the initial motion vector wi and the time ti that have passed after the escape started.Your task is for each of the q plans to determine the Smart Beaver\'s position after the given time." 3000
331D2 "Escaping on Beaveractor" graphs "Don\'t put up with what you\'re sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b square on a plane. Each point x,\xe2\x80\x89y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.The campus obeys traffic rules: there are n arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow\'s direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.The BSA scientists want to transport the brand new Beaveractor to the ""Academic Tractor"" research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have q plans, representing the Beaveractor\'s initial position (xi,\xe2\x80\x89yi), the initial motion vector wi and the time ti that have passed after the escape started.Your task is for each of the q plans to determine the Smart Beaver\'s position after the given time." 2600
331D1 "Escaping on Beaveractor" "dfs and similar,implementation" "Don\'t put up with what you\'re sick of! The Smart Beaver decided to escape from the campus of Beaver Science Academy (BSA). BSA is a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b square on a plane. Each point x,\xe2\x80\x89y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) belongs to BSA. To make the path quick and funny, the Beaver constructed a Beaveractor, an effective and comfortable types of transport.The campus obeys traffic rules: there are n arrows, parallel to the coordinate axes. The arrows do not intersect and do not touch each other. When the Beaveractor reaches some arrow, it turns in the arrow\'s direction and moves on until it either reaches the next arrow or gets outside the campus. The Beaveractor covers exactly one unit of space per one unit of time. You can assume that there are no obstacles to the Beaveractor.The BSA scientists want to transport the brand new Beaveractor to the ""Academic Tractor"" research institute and send the Smart Beaver to do his postgraduate studies and sharpen pencils. They have q plans, representing the Beaveractor\'s initial position (xi,\xe2\x80\x89yi), the initial motion vector wi and the time ti that have passed after the escape started.Your task is for each of the q plans to determine the Smart Beaver\'s position after the given time." 2400
331C3 "The Great Julya Calendar" dp "Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: ""May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!""Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero." 2500
331C2 "The Great Julya Calendar" dp "Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: ""May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!""Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero." 2400
331C1 "The Great Julya Calendar" dp "Yet another Armageddon is coming! This time the culprit is the Julya tribe calendar. The beavers in this tribe knew math very well. Smart Beaver, an archaeologist, got a sacred plate with a magic integer on it. The translation from Old Beaverish is as follows: ""May the Great Beaver bless you! May your chacres open and may your third eye never turn blind from beholding the Truth! Take the magic number, subtract a digit from it (the digit must occur in the number) and get a new magic number. Repeat this operation until a magic number equals zero. The Earth will stand on Three Beavers for the time, equal to the number of subtractions you perform!""Distinct subtraction sequences can obviously get you different number of operations. But the Smart Beaver is ready to face the worst and is asking you to count the minimum number of operations he needs to reduce the magic number to zero." 1100
331B2 "Shave Beaver!" "data structures" "The Smart Beaver has recently designed and built an innovative nanotechnologic all-purpose beaver mass shaving machine, ""Beavershave 5000"". Beavershave 5000 can shave beavers by families! How does it work? Very easily!There are n beavers, each of them has a unique id from 1 to n. Consider a permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n these beavers. Beavershave 5000 needs one session to shave beavers with ids from x to y (inclusive) if and only if there are such indices i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik, that ai1\xe2\x80\x89=\xe2\x80\x89x, ai2\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891, ..., aik\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891, aik\xe2\x80\x89=\xe2\x80\x89y. And that is really convenient. For example, it needs one session to shave a permutation of beavers 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n.If we can\'t shave beavers from x to y in one session, then we can split these beavers into groups [x,\xe2\x80\x89p1], [p1\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89p2], ..., [pm\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y] (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pm\xe2\x80\x89<\xe2\x80\x89y), in such a way that the machine can shave beavers in each group in one session. But then Beavershave 5000 needs m\xe2\x80\x89+\xe2\x80\x891 working sessions to shave beavers from x to y.All beavers are restless and they keep trying to swap. So if we consider the problem more formally, we can consider queries of two types:   what is the minimum number of sessions that Beavershave 5000 needs to shave beavers with ids from x to y, inclusive?  two beavers on positions x and y (the beavers ax and ay) swapped. You can assume that any beaver can be shaved any number of times." 1900
331B1 "Shave Beaver!" implementation "The Smart Beaver has recently designed and built an innovative nanotechnologic all-purpose beaver mass shaving machine, ""Beavershave 5000"". Beavershave 5000 can shave beavers by families! How does it work? Very easily!There are n beavers, each of them has a unique id from 1 to n. Consider a permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n these beavers. Beavershave 5000 needs one session to shave beavers with ids from x to y (inclusive) if and only if there are such indices i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik, that ai1\xe2\x80\x89=\xe2\x80\x89x, ai2\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891, ..., aik\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891, aik\xe2\x80\x89=\xe2\x80\x89y. And that is really convenient. For example, it needs one session to shave a permutation of beavers 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n.If we can\'t shave beavers from x to y in one session, then we can split these beavers into groups [x,\xe2\x80\x89p1], [p1\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89p2], ..., [pm\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y] (x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pm\xe2\x80\x89<\xe2\x80\x89y), in such a way that the machine can shave beavers in each group in one session. But then Beavershave 5000 needs m\xe2\x80\x89+\xe2\x80\x891 working sessions to shave beavers from x to y.All beavers are restless and they keep trying to swap. So if we consider the problem more formally, we can consider queries of two types:   what is the minimum number of sessions that Beavershave 5000 needs to shave beavers with ids from x to y, inclusive?  two beavers on positions x and y (the beavers ax and ay) swapped. You can assume that any beaver can be shaved any number of times." 1700
331A2 "Oh Sweet Beaverette" "data structures,sortings" "\xe2\x80\x94 Oh my sweet Beaverette, would you fancy a walk along a wonderful woodland belt with me?   \xe2\x80\x94 Of course, my Smart Beaver! Let us enjoy the splendid view together. How about Friday night? At this point the Smart Beaver got rushing. Everything should be perfect by Friday, so he needed to prepare the belt to the upcoming walk. He needed to cut down several trees.Let\'s consider the woodland belt as a sequence of trees. Each tree i is described by the esthetic appeal ai \xe2\x80\x94 some trees are very esthetically pleasing, others are \'so-so\', and some trees are positively ugly!The Smart Beaver calculated that he needed the following effects to win the Beaverette\'s heart:   The first objective is to please the Beaverette: the sum of esthetic appeal of the remaining trees must be maximum possible;  the second objective is to surprise the Beaverette: the esthetic appeal of the first and the last trees in the resulting belt must be the same;  and of course, the walk should be successful: there must be at least two trees in the woodland belt left. Now help the Smart Beaver! Which trees does he need to cut down to win the Beaverette\'s heart?" 1500
331A1 "Oh Sweet Beaverette" "brute force,implementation" "\xe2\x80\x94 Oh my sweet Beaverette, would you fancy a walk along a wonderful woodland belt with me?   \xe2\x80\x94 Of course, my Smart Beaver! Let us enjoy the splendid view together. How about Friday night? At this point the Smart Beaver got rushing. Everything should be perfect by Friday, so he needed to prepare the belt to the upcoming walk. He needed to cut down several trees.Let\'s consider the woodland belt as a sequence of trees. Each tree i is described by the esthetic appeal ai \xe2\x80\x94 some trees are very esthetically pleasing, others are \'so-so\', and some trees are positively ugly!The Smart Beaver calculated that he needed the following effects to win the Beaverette\'s heart:   The first objective is to please the Beaverette: the sum of esthetic appeal of the remaining trees must be maximum possible;  the second objective is to surprise the Beaverette: the esthetic appeal of the first and the last trees in the resulting belt must be the same;  and of course, the walk should be successful: there must be at least two trees in the woodland belt left. Now help the Smart Beaver! Which trees does he need to cut down to win the Beaverette\'s heart?" 1400
330B "Road Construction" "constructive algorithms,graphs" "A country has n cities. Initially, there is no road in the country. One day, the king decides to construct some roads connecting pairs of cities. Roads can be traversed either way. He wants those roads to be constructed in such a way that it is possible to go from each city to any other city by traversing at most two roads. You are also given m pairs of cities \xe2\x80\x94 roads cannot be constructed between these pairs of cities.Your task is to construct the minimum number of roads that still satisfy the above conditions. The constraints will guarantee that this is always possible." 1300
330A Cakeminator "brute force,implementation" "You are given a rectangular cake, represented as an r\xe2\x80\x89\xc3\x97\xe2\x80\x89c grid. Each cell either has an evil strawberry, or is empty. For example, a 3\xe2\x80\x89\xc3\x97\xe2\x80\x894 cake may look as follows:  The cakeminator is going to eat the cake! Each time he eats, he chooses a row or a column that does not contain any evil strawberries and contains at least one cake cell that has not been eaten before, and eats all the cake cells there. He may decide to eat any number of times.Please output the maximum number of cake cells that the cakeminator can eat." 800
329E Evil math "There are n cities on a two dimensional Cartesian plane. The distance between two cities is equal to the Manhattan distance between them (see the Notes for definition). A Hamiltonian cycle of the cities is defined as a permutation of all n cities. The length of this Hamiltonian cycle is defined as the sum of the distances between adjacent cities in the permutation plus the distance between the first and final city in the permutation. Please compute the longest possible length of a Hamiltonian cycle of the given cities." 3100
329D "The Evil Temple and the Moving Rocks" "constructive algorithms" "Important: All possible tests are in the pretest, so you shouldn\'t hack on this problem. So, if you passed pretests, you will also pass the system test.You are an adventurer currently journeying inside an evil temple. After defeating a couple of weak monsters, you arrived at a square room consisting of tiles forming an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid, surrounded entirely by walls. At the end of the room lies a door locked with evil magical forces. The following inscriptions are written on the door: The sound of clashing rocks will awaken the door! Being a very senior adventurer, you immediately realize what this means. In the room next door lies an infinite number of magical rocks. There are four types of rocks:   \'^\': this rock moves upwards;  \'<\': this rock moves leftwards;  \'>\': this rock moves rightwards;  \'v\': this rock moves downwards. To open the door, you first need to place the rocks on some of the tiles (one tile can be occupied by at most one rock). Then, you select a single rock that you have placed and activate it. The activated rock will then move in its direction until it hits another rock or hits the walls of the room (the rock will not move if something already blocks it in its chosen direction). The rock then deactivates. If it hits the walls, or if there have been already 107 events of rock becoming activated, the movements end. Otherwise, the rock that was hit becomes activated and this procedure is repeated.If a rock moves at least one cell before hitting either the wall or another rock, the hit produces a sound. The door will open once the number of produced sounds is at least x. It is okay for the rocks to continue moving after producing x sounds.The following picture illustrates the four possible scenarios of moving rocks. Moves at least one cell, then hits another rock. A sound is produced, the hit rock becomes activated.   Moves at least one cell, then hits the wall (i.e., the side of the room). A sound is produced, the movements end.   Does not move because a rock is already standing in the path. The blocking rock becomes activated, but no sounds are produced.   Does not move because the wall is in the way. No sounds are produced and the movements end.  Assume there\'s an infinite number of rocks of each type in the neighboring room. You know what to do: place the rocks and open the door!" 2500
329C "Graph Reconstruction" "constructive algorithms" "I have an undirected graph consisting of n nodes, numbered 1 through n. Each node has at most two incident edges. For each pair of nodes, there is at most an edge connecting them. No edge connects a node to itself.I would like to create a new graph in such a way that:   The new graph consists of the same number of nodes and edges as the old graph.  The properties in the first paragraph still hold.  For each two nodes u and v, if there is an edge connecting them in the old graph, there is no edge connecting them in the new graph. Help me construct the new graph, or tell me if it is impossible." 2400
329B "Biridian Forest" "dfs and similar,shortest paths" "You\'re a mikemon breeder currently in the middle of your journey to become a mikemon master. Your current obstacle is go through the infamous Biridian Forest.The forestThe Biridian Forest is a two-dimensional grid consisting of r rows and c columns. Each cell in Biridian Forest may contain a tree, or may be vacant. A vacant cell may be occupied by zero or more mikemon breeders (there may also be breeders other than you in the forest). Mikemon breeders (including you) cannot enter cells with trees. One of the cells is designated as the exit cell.The initial grid, including your initial position, the exit cell, and the initial positions of all other breeders, will be given to you. Here\'s an example of such grid (from the first example):  MovesBreeders (including you) may move in the forest. In a single move, breeders may perform one of the following actions:   Do nothing.  Move from the current cell to one of the four adjacent cells (two cells are adjacent if they share a side). Note that breeders cannot enter cells with trees.  If you are located on the exit cell, you may leave the forest. Only you can perform this move \xe2\x80\x94 all other mikemon breeders will never leave the forest by using this type of movement. After each time you make a single move, each of the other breeders simultaneously make a single move (the choice of which move to make may be different for each of the breeders).Mikemon battleIf you and t (t\xe2\x80\x89>\xe2\x80\x890) mikemon breeders are located on the same cell, exactly t mikemon battles will ensue that time (since you will be battling each of those t breeders once). After the battle, all of those t breeders will leave the forest to heal their respective mikemons.Note that the moment you leave the forest, no more mikemon battles can ensue, even if another mikemon breeder move to the exit cell immediately after that. Also note that a battle only happens between you and another breeders \xe2\x80\x94 there will be no battle between two other breeders (there may be multiple breeders coexisting in a single cell).Your goalYou would like to leave the forest. In order to do so, you have to make a sequence of moves, ending with a move of the final type. Before you make any move, however, you post this sequence on your personal virtual idol Blog. Then, you will follow this sequence of moves faithfully.Goal of other breedersBecause you post the sequence in your Blog, the other breeders will all know your exact sequence of moves even before you make your first move. All of them will move in such way that will guarantee a mikemon battle with you, if possible. The breeders that couldn\'t battle you will do nothing.Your taskPrint the minimum number of mikemon battles that you must participate in, assuming that you pick the sequence of moves that minimize this number. Note that you are not required to minimize the number of moves you make." 1500
329A Purification "constructive algorithms,greedy" "You are an adventurer currently journeying inside an evil temple. After defeating a couple of weak zombies, you arrived at a square room consisting of tiles forming an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid. The rows are numbered 1 through n from top to bottom, and the columns are numbered 1 through n from left to right. At the far side of the room lies a door locked with evil magical forces. The following inscriptions are written on the door: The cleaning of all evil will awaken the door! Being a very senior adventurer, you immediately realize what this means. You notice that every single cell in the grid are initially evil. You should purify all of these cells.The only method of tile purification known to you is by casting the ""Purification"" spell. You cast this spell on a single tile \xe2\x80\x94 then, all cells that are located in the same row and all cells that are located in the same column as the selected tile become purified (including the selected tile)! It is allowed to purify a cell more than once.You would like to purify all n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells while minimizing the number of times you cast the ""Purification"" spell. This sounds very easy, but you just noticed that some tiles are particularly more evil than the other tiles. You cannot cast the ""Purification"" spell on those particularly more evil tiles, not even after they have been purified. They can still be purified if a cell sharing the same row or the same column gets selected by the ""Purification"" spell.Please find some way to purify all the cells with the minimum number of spells cast. Print -1 if there is no such way." 1500
328B "Sheldon and Ice Pieces" greedy "Do you remember how Kai constructed the word ""eternity"" using pieces of ice as components?Little Sheldon plays with pieces of ice, each piece has exactly one digit between 0 and 9. He wants to construct his favourite number t. He realized that digits 6 and 9 are very similar, so he can rotate piece of ice with 6 to use as 9 (and vice versa). Similary, 2 and 5 work the same. There is no other pair of digits with similar effect. He called this effect ""Digital Mimicry"".Sheldon favourite number is t. He wants to have as many instances of t as possible. How many instances he can construct using the given sequence of ice pieces. He can use any piece at most once." 1500
328A "IQ Test" implementation "Petya is preparing for IQ test and he has noticed that there many problems like: you are given a sequence, find the next number. Now Petya can solve only problems with arithmetic or geometric progressions.Arithmetic progression is a sequence a1, a1\xe2\x80\x89+\xe2\x80\x89d, a1\xe2\x80\x89+\xe2\x80\x892d, ..., a1\xe2\x80\x89+\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891)d, where a1 and d are any numbers.Geometric progression is a sequence b1, b2\xe2\x80\x89=\xe2\x80\x89b1q, ..., bn\xe2\x80\x89=\xe2\x80\x89bn\xe2\x80\x89-\xe2\x80\x891q, where b1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890, q\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890, q\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x891. Help Petya and write a program to determine if the given sequence is arithmetic or geometric. Also it should found the next number. If the sequence is neither arithmetic nor geometric, print 42 (he thinks it is impossible to find better answer). You should also print 42 if the next element of progression is not integer. So answer is always integer." 1800
327E "Axis Walking" "bitmasks,combinatorics,constructive algorithms,dp,meet-in-the-middle" "Iahub wants to meet his girlfriend Iahubina. They both live in Ox axis (the horizontal axis). Iahub lives at point 0 and Iahubina at point d.Iahub has n positive integers a1, a2, ..., an. The sum of those numbers is d. Suppose p1, p2, ..., pn is a permutation of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n}. Then, let b1\xe2\x80\x89=\xe2\x80\x89ap1, b2\xe2\x80\x89=\xe2\x80\x89ap2 and so on. The array b is called a ""route"". There are n! different routes, one for each permutation p.Iahub\'s travel schedule is: he walks b1 steps on Ox axis, then he makes a break in point b1. Then, he walks b2 more steps on Ox axis and makes a break in point b1\xe2\x80\x89+\xe2\x80\x89b2. Similarly, at j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) time he walks bj more steps on Ox axis and makes a break in point b1\xe2\x80\x89+\xe2\x80\x89b2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bj.Iahub is very superstitious and has k integers which give him bad luck. He calls a route ""good"" if he never makes a break in a point corresponding to one of those k numbers. For his own curiosity, answer how many good routes he can make, modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2300
327D "Block Tower" "constructive algorithms,dfs and similar,graphs" "After too much playing on paper, Iahub has switched to computer games. The game he plays is called ""Block Towers"". It is played in a rectangular grid with n rows and m columns (it contains n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells). The goal of the game is to build your own city. Some cells in the grid are big holes, where Iahub can\'t build any building. The rest of cells are empty. In some empty cell Iahub can build exactly one tower of two following types:  Blue towers. Each has population limit equal to 100.  Red towers. Each has population limit equal to 200. However, it can be built in some cell only if in that moment at least one of the neighbouring cells has a Blue Tower. Two cells are neighbours is they share a side. Iahub is also allowed to destroy a building from any cell. He can do this operation as much as he wants. After destroying a building, the other buildings are not influenced, and the destroyed cell becomes empty (so Iahub can build a tower in this cell if needed, see the second example for such a case).Iahub can convince as many population as he wants to come into his city. So he needs to configure his city to allow maximum population possible. Therefore he should find a sequence of operations that builds the city in an optimal way, so that total population limit is as large as possible.He says he\'s the best at this game, but he doesn\'t have the optimal solution. Write a program that calculates the optimal one, to show him that he\'s not as good as he thinks." 1900
327C "Magic Five" combinatorics,math "There is a long plate s containing n digits. Iahub wants to delete some digits (possibly none, but he is not allowed to delete all the digits) to form his ""magic number"" on the plate, a number that is divisible by 5. Note that, the resulting number may contain leading zeros.Now Iahub wants to count the number of ways he can obtain magic number, modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). Two ways are different, if the set of deleted positions in s differs.Look at the input part of the statement, s is given in a special form." 1700
327B "Hungry Sequence" math "Iahub and Iahubina went to a date at a luxury restaurant. Everything went fine until paying for the food. Instead of money, the waiter wants Iahub to write a Hungry sequence consisting of n integers. A sequence a1, a2, ..., an, consisting of n integers, is Hungry if and only if:   Its elements are in increasing order. That is an inequality ai\xe2\x80\x89<\xe2\x80\x89aj holds for any two indices i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j).  For any two indices i and j (i\xe2\x80\x89<\xe2\x80\x89j), aj must not be divisible by ai. Iahub is in trouble, so he asks you for help. Find a Hungry sequence with n elements." 1200
327A "Flipping Game" "brute force,dp,implementation" "Iahub got bored, so he invented a game to be played on paper. He writes n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Each of those integers can be either 0 or 1. He\'s allowed to do exactly one move: he chooses two indices i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and flips all values ak for which their positions are in range [i,\xe2\x80\x89j] (that is i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j). Flip the value of x means to apply operation x\xe2\x80\x89=\xe2\x80\x891 - x.The goal of the game is that after exactly one move to obtain the maximum number of ones. Write a program to solve the little game of Iahub." 1200
325E "The Red Button" "combinatorics,dfs and similar,dsu,graphs,greedy" "Piegirl found the red button. You have one last chance to change the inevitable end.The circuit under the button consists of n nodes, numbered from 0 to n - 1. In order to deactivate the button, the n nodes must be disarmed in a particular order. Node 0 must be disarmed first. After disarming node i, the next node to be disarmed must be either node (2\xc2\xb7i) modulo n or node (2\xc2\xb7i)\xe2\x80\x89+\xe2\x80\x891 modulo n. The last node to be disarmed must be node 0. Node 0 must be disarmed twice, but all other nodes must be disarmed exactly once. Your task is to find any such order and print it. If there is no such order, print -1." 2800
325D Reclamation dsu "In a far away land, there exists a planet shaped like a cylinder. There are three regions in this planet: top, bottom, and side as shown in the following picture.  Both the top and the bottom areas consist of big cities. The side area consists entirely of the sea.One day, a city decides that it has too little space and would like to reclamate some of the side area into land. The side area can be represented by a grid with r rows and c columns \xe2\x80\x94 each cell represents a rectangular area in the side area. The rows are numbered 1 through r from top to bottom, while the columns are numbered 1 through c from left to right. Two cells are adjacent if they share a side. In addition, two cells located on the same row \xe2\x80\x94 one in the leftmost column, and the other in the rightmost column \xe2\x80\x94 are also adjacent.Initially, all of the cells are occupied by the sea. The plan is to turn some of those cells into land one by one in a particular order that will be given to you.However, the sea on the side area is also used as a major trade route. More formally, it is not allowed to reclamate the sea cells into land in such way that there does not exist a sequence of cells with the following property:  All cells in the sequence are occupied by the sea (i.e., they are not reclamated).  The first cell in the sequence is in the top row.  The last cell in the sequence is in the bottom row.  Consecutive cells in the sequence are adjacent. Thus, the plan is revised. Each time a cell is going to be turned from sea to land, the city first needs to check whether or not it would violate the above condition by doing that. If it would, then the cell is not turned into land and the plan proceeds into the next cell. Otherwise, the cell is turned into land.Your job is to simulate this and output the number of cells that were successfully turned into land." 2900
325C "Monsters and Diamonds" "dfs and similar,graphs,shortest paths" "Piegirl has found a monster and a book about monsters and pies. When she is reading the book, she found out that there are n types of monsters, each with an ID between 1 and n. If you feed a pie to a monster, the monster will split into some number of monsters (possibly zero), and at least one colorful diamond. Monsters may be able to split in multiple ways.At the begining Piegirl has exactly one monster. She begins by feeding the monster a pie. She continues feeding pies to monsters until no more monsters are left. Then she collects all the diamonds that were created.You will be given a list of split rules describing the way in which the various monsters can split. Every monster can split in at least one way, and if a monster can split in multiple ways then each time when it splits Piegirl can choose the way it splits.For each monster, determine the smallest and the largest number of diamonds Piegirl can possibly collect, if initially she has a single instance of that monster. Piegirl has an unlimited supply of pies." 2600
325B "Stadium and Games" "binary search,math" "Daniel is organizing a football tournament. He has come up with the following tournament format:   In the first several (possibly zero) stages, while the number of teams is even, they split in pairs and play one game for each pair. At each stage the loser of each pair is eliminated (there are no draws). Such stages are held while the number of teams is even.  Eventually there will be an odd number of teams remaining. If there is one team remaining, it will be declared the winner, and the tournament ends. Otherwise each of the remaining teams will play with each other remaining team once in round robin tournament (if there are x teams, there will be  games), and the tournament ends. For example, if there were 20 teams initially, they would begin by playing 10 games. So, 10 teams would be eliminated, and the remaining 10 would play 5 games. Then the remaining 5 teams would play 10 games in a round robin tournament. In total there would be 10+5+10=25 games.Daniel has already booked the stadium for n games. Help him to determine how many teams he should invite so that the tournament needs exactly n games. You should print all possible numbers of teams that will yield exactly n games in ascending order, or -1 if there are no such numbers." 1800
325A "Square and Rectangles" implementation "You are given n rectangles. The corners of rectangles have integer coordinates and their edges are parallel to the Ox and Oy axes. The rectangles may touch each other, but they do not overlap (that is, there are no points that belong to the interior of more than one rectangle). Your task is to determine if the rectangles form a square. In other words, determine if the set of points inside or on the border of at least one rectangle is precisely equal to the set of points inside or on the border of some square." 1500
323C "Two permutations" "data structures" "You are given two permutations p and q, consisting of n elements, and m queries of the form: l1,\xe2\x80\x89r1,\xe2\x80\x89l2,\xe2\x80\x89r2 (l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1; l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2). The response for the query is the number of such integers from 1 to n, that their position in the first permutation is in segment [l1,\xe2\x80\x89r1] (borders included), and position in the second permutation is in segment [l2,\xe2\x80\x89r2] (borders included too).A permutation of n elements is the sequence of n distinct integers, each not less than 1 and not greater than n.Position of number v (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) in permutation g1,\xe2\x80\x89g2,\xe2\x80\x89...,\xe2\x80\x89gn is such number i, that gi\xe2\x80\x89=\xe2\x80\x89v." 2400
323B Tournament-graph "constructive algorithms,graphs" "In this problem you have to build tournament graph, consisting of n vertices, such, that for any oriented pair of vertices (v,\xe2\x80\x89u) (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u) there exists a path from vertex v to vertex u consisting of no more then two edges.A directed graph without self-loops is a tournament, if there is exactly one edge between any two distinct vertices (in one out of two possible directions)." 2200
323A "Black-and-White Cube" "combinatorics,constructive algorithms" "You are given a cube of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k\xe2\x80\x89\xc3\x97\xe2\x80\x89k, which consists of unit cubes. Two unit cubes are considered neighbouring, if they have common face.Your task is to paint each of k3 unit cubes one of two colours (black or white), so that the following conditions must be satisfied:  each white cube has exactly 2 neighbouring cubes of white color;  each black cube has exactly 2 neighbouring cubes of black color." 1600
322B "Ciel and Flowers" combinatorics,math "Fox Ciel has some flowers: r red flowers, g green flowers and b blue flowers. She wants to use these flowers to make several bouquets. There are 4 types of bouquets:  To make a ""red bouquet"", it needs 3 red flowers.  To make a ""green bouquet"", it needs 3 green flowers.  To make a ""blue bouquet"", it needs 3 blue flowers.  To make a ""mixing bouquet"", it needs 1 red, 1 green and 1 blue flower. Help Fox Ciel to find the maximal number of bouquets she can make." 1600
322A "Ciel and Dancing" greedy "Fox Ciel and her friends are in a dancing room. There are n boys and m girls here, and they never danced before. There will be some songs, during each song, there must be exactly one boy and one girl are dancing. Besides, there is a special rule:  either the boy in the dancing pair must dance for the first time (so, he didn\'t dance with anyone before);  or the girl in the dancing pair must dance for the first time. Help Fox Ciel to make a schedule that they can dance as many songs as possible." 1000
321E "Ciel and Gondolas" "data structures,divide and conquer,dp" "Fox Ciel is in the Amusement Park. And now she is in a queue in front of the Ferris wheel. There are n people (or foxes more precisely) in the queue: we use first people to refer one at the head of the queue, and n-th people to refer the last one in the queue.There will be k gondolas, and the way we allocate gondolas looks like this:  When the first gondolas come, the q1 people in head of the queue go into the gondolas.  Then when the second gondolas come, the q2 people in head of the remain queue go into the gondolas.    ... The remain qk people go into the last (k-th) gondolas. Note that q1, q2, ..., qk must be positive. You can get from the statement that  and qi\xe2\x80\x89>\xe2\x80\x890.You know, people don\'t want to stay with strangers in the gondolas, so your task is to find an optimal allocation way (that is find an optimal sequence q) to make people happy. For every pair of people i and j, there exists a value uij denotes a level of unfamiliar. You can assume uij\xe2\x80\x89=\xe2\x80\x89uji for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and uii\xe2\x80\x89=\xe2\x80\x890 for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Then an unfamiliar value of a gondolas is the sum of the levels of unfamiliar between any pair of people that is into the gondolas.A total unfamiliar value is the sum of unfamiliar values for all gondolas. Help Fox Ciel to find the minimal possible total unfamiliar value for some optimal allocation." 2600
321D "Ciel and Flipboard" dp,greedy,math "Fox Ciel has a board with n rows and n columns, there is one integer in each cell.It\'s known that n is an odd number, so let\'s introduce . Fox Ciel can do the following operation many times: she choose a sub-board with size x rows and x columns, then all numbers in it will be multiplied by -1.Return the maximal sum of numbers in the board that she can get by these operations." 2900
321C "Ciel the Commander" "constructive algorithms,dfs and similar,divide and conquer,greedy,trees" "Now Fox Ciel becomes a commander of Tree Land. Tree Land, like its name said, has n cities connected by n\xe2\x80\x89-\xe2\x80\x891 undirected roads, and for any two cities there always exists a path between them.Fox Ciel needs to assign an officer to each city. Each officer has a rank \xe2\x80\x94 a letter from \'A\' to \'Z\'. So there will be 26 different ranks, and \'A\' is the topmost, so \'Z\' is the bottommost.There are enough officers of each rank. But there is a special rule must obey: if x and y are two distinct cities and their officers have the same rank, then on the simple path between x and y there must be a city z that has an officer with higher rank. The rule guarantee that a communications between same rank officers will be monitored by higher rank officer.Help Ciel to make a valid plan, and if it\'s impossible, output ""Impossible!""." 2100
321B "Ciel and Duel" dp,flows,greedy "Fox Ciel is playing a card game with her friend Jiro.Jiro has n cards, each one has two attributes: position (Attack or Defense) and strength. Fox Ciel has m cards, each one has these two attributes too. It\'s known that position of all Ciel\'s cards is Attack.Now is Ciel\'s battle phase, Ciel can do the following operation many times:  Choose one of her cards X. This card mustn\'t be chosen before.  If Jiro has no alive cards at that moment, he gets the damage equal to (X\'s strength). Otherwise, Ciel needs to choose one Jiro\'s alive card Y, then:   If Y\'s position is Attack, then (X\'s strength) \xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89 (Y\'s strength) must hold. After this attack, card Y dies, and Jiro gets the damage equal to (X\'s strength) - (Y\'s strength).  If Y\'s position is Defense, then (X\'s strength) \xe2\x80\x89>\xe2\x80\x89 (Y\'s strength) must hold. After this attack, card Y dies, but Jiro gets no damage.  Ciel can end her battle phase at any moment (so, she can use not all her cards). Help the Fox to calculate the maximal sum of damage Jiro can get." 1900
321A "Ciel and Robot" "binary search,implementation,math" "Fox Ciel has a robot on a 2D plane. Initially it is located in (0, 0). Fox Ciel code a command to it. The command was represented by string s. Each character of s is one move operation. There are four move operations at all:  \'U\': go up, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x, y+1);  \'D\': go down, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x, y-1);  \'L\': go left, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x-1, y);  \'R\': go right, (x, y) \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 (x+1, y). The robot will do the operations in s from left to right, and repeat it infinite times. Help Fox Ciel to determine if after some steps the robot will located in (a,\xe2\x80\x89b)." 1700
320B "Ping-Pong (Easy Version)" "dfs and similar,graphs" "In this problem at each moment you have a set of intervals. You can move from interval (a,\xe2\x80\x89b) from our set to interval (c,\xe2\x80\x89d) from our set if and only if c\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89d or c\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89d. Also there is a path from interval I1 from our set to interval I2 from our set if there is a sequence of successive moves starting from I1 so that we can reach I2.Your program should handle the queries of the following two types:  ""1 x y"" (x\xe2\x80\x89<\xe2\x80\x89y) \xe2\x80\x94 add the new interval (x,\xe2\x80\x89y) to the set of intervals. The length of the new interval is guaranteed to be strictly greater than all the previous intervals. ""2 a b"" (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b) \xe2\x80\x94 answer the question: is there a path from a-th (one-based) added interval to b-th (one-based) added interval? Answer all the queries. Note, that initially you have an empty set of intervals." 1500
320A "Magic Numbers" "brute force,greedy" "A magic number is a number formed by concatenation of numbers 1, 14 and 144. We can use each of these numbers any number of times. Therefore 14144, 141414 and 1411 are magic numbers but 1444, 514 and 414 are not.You\'re given a number. Determine if it is a magic number or not." 900
319E Ping-Pong "data structures" "In this problem at each moment you have a set of intervals. You can move from interval (a,\xe2\x80\x89b) from our set to interval (c,\xe2\x80\x89d) from our set if and only if c\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89d or c\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89d. Also there is a path from interval I1 from our set to interval I2 from our set if there is a sequence of successive moves starting from I1 so that we can reach I2.Your program should handle the queries of the following two types:  ""1 x y"" (x\xe2\x80\x89<\xe2\x80\x89y) \xe2\x80\x94 add the new interval (x,\xe2\x80\x89y) to the set of intervals. The length of the new interval is guaranteed to be strictly greater than all the previous intervals. ""2 a b"" (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b) \xe2\x80\x94 answer the question: is there a path from a-th (one-based) added interval to b-th (one-based) added interval? Answer all the queries. Note, that initially you have an empty set of intervals." 3000
319D "Have You Ever Heard About the Word?" "greedy,hashing,string suffix structures,strings" "A substring of a string is a contiguous subsequence of that string. So, string bca is substring of string abcabc, but string cc is not.A repeating block is a string formed by concatenating some string with itself. So, string abcabc is a repeating block, but strings abcabd, ababab are not.You\'ve got a sequence of Latin characters (string). At each step you find the shortest substring that is a repeating block, if there exists more than one you must choose the leftmost. As the substring is of form XX (X \xe2\x80\x94 some string) you replace this substring with X, in other words you delete one of the X substrings in the substring. You repeat this process until there remains no repeating block in the string. How would the final string looks like? Look at the sample explanation to understand the statement more precise." 2800
319C "Kalila and Dimna in the Logging Industry" dp,geometry "Kalila and Dimna are two jackals living in a huge jungle. One day they decided to join a logging factory in order to make money. The manager of logging factory wants them to go to the jungle and cut n trees with heights a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. They bought a chain saw from a shop. Each time they use the chain saw on the tree number i, they can decrease the height of this tree by one unit. Each time that Kalila and Dimna use the chain saw, they need to recharge it. Cost of charging depends on the id of the trees which have been cut completely (a tree is cut completely if its height equal to 0). If the maximum id of a tree which has been cut completely is i (the tree that have height ai in the beginning), then the cost of charging the chain saw would be bi. If no tree is cut completely, Kalila and Dimna cannot charge the chain saw. The chainsaw is charged in the beginning. We know that for each i < j, ai\xe2\x80\x89<\xe2\x80\x89aj and bi\xe2\x80\x89>\xe2\x80\x89bj and also bn\xe2\x80\x89=\xe2\x80\x890 and a1\xe2\x80\x89=\xe2\x80\x891. Kalila and Dimna want to cut all the trees completely, with minimum cost. They want you to help them! Will you?" 2100
319B "Psychos in a Line" "data structures,implementation" "There are n psychos standing in a line. Each psycho is assigned a unique integer from 1 to n. At each step every psycho who has an id greater than the psycho to his right (if exists) kills his right neighbor in the line. Note that a psycho might kill and get killed at the same step. You\'re given the initial arrangement of the psychos in the line. Calculate how many steps are needed to the moment of time such, that nobody kills his neighbor after that moment. Look notes to understand the statement more precise." 1900
319A "Malek Dance Club" combinatorics,math "As a tradition, every year before IOI all the members of Natalia Fan Club are invited to Malek Dance Club to have a fun night together. Malek Dance Club has 2n members and coincidentally Natalia Fan Club also has 2n members. Each member of MDC is assigned a unique id i from 0 to 2n\xe2\x80\x89-\xe2\x80\x891. The same holds for each member of NFC.One of the parts of this tradition is one by one dance, where each member of MDC dances with a member of NFC. A dance pair is a pair of numbers (a,\xe2\x80\x89b) such that member a from MDC dances with member b from NFC.The complexity of a pairs\' assignment is the number of pairs of dancing pairs (a,\xe2\x80\x89b) and (c,\xe2\x80\x89d) such that a\xe2\x80\x89<\xe2\x80\x89c and b\xe2\x80\x89>\xe2\x80\x89d.You are given a binary number of length n named x. We know that member i from MDC dances with member  from NFC. Your task is to calculate the complexity of this assignment modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Expression  denotes applying \xc2\xabXOR\xc2\xbb to numbers x and y. This operation exists in all modern programming languages, for example, in C++ and Java it denotes as \xc2\xab^\xc2\xbb, in Pascal \xe2\x80\x94 \xc2\xabxor\xc2\xbb." 1600
318B "Strings of Power" "implementation,strings,two pointers" "Volodya likes listening to heavy metal and (occasionally) reading. No wonder Volodya is especially interested in texts concerning his favourite music style.Volodya calls a string powerful if it starts with ""heavy"" and ends with ""metal"". Finding all powerful substrings (by substring Volodya means a subsequence of consecutive characters in a string) in a given text makes our hero especially joyful. Recently he felt an enormous fit of energy while reading a certain text. So Volodya decided to count all powerful substrings in this text and brag about it all day long. Help him in this difficult task. Two substrings are considered different if they appear at the different positions in the text.For simplicity, let us assume that Volodya\'s text can be represented as a single string." 1300
318A "Even Odds" math "Being a nonconformist, Volodya is displeased with the current state of things, particularly with the order of natural numbers (natural number is positive integer number). He is determined to rearrange them. But there are too many natural numbers, so Volodya decided to start with the first n. He writes down the following sequence of numbers: firstly all odd integers from 1 to n (in ascending order), then all even integers from 1 to n (also in ascending order). Help our hero to find out which number will stand at the position number k." 900
317E "Princess and Her Shadow" "constructive algorithms,shortest paths" "Princess Vlada enjoys springing in the meadows and walking in the forest. One day \xe2\x80\x94 wonderful, sunny day \xe2\x80\x94 during her walk Princess found out with astonishment that her shadow was missing! ""Blimey!"", \xe2\x80\x94 she thought and started her search of the shadow in the forest.Normally the Shadow is too lazy and simply sleeps under the Princess. But at this terrifically hot summer day she got bored of such a dull life, so she decided to play with Vlada.The forest, where our characters entertain themselves, may be represented as a set of integer cells in the plane, where the Shadow and the Princess can move only up, down, left and right by 1. Some cells (as it happens in decent forests) are occupied by trees. The Shadow and the Princess are not allowed to enter a cell occupied by a tree. Unfortunately, these are the hard times for the forest, so there are very few trees growing here...At first the Princess was walking within the cell (vx, vy), while the Shadow hid from the Princess in the cell (sx, sy). The Princess, The Shadow and the trees are located in the different cells.The Shadow is playing with the Princess. As soon as the Princess moves by 1 in some direction, the Shadow simultaneously flies by 1 in the same direction, if it is possible (if the cell to fly to is not occupied by some tree); otherwise, the Shadow doesn\'t move. The Shadow is very shadowy, so our characters do not interfere with each other.We say that the Shadow is caught by the Princess if after some move both of them are located in the same cell. Vlada managed to catch her Shadow! Can you?" 3100
317D "Game with Powers" dp,games "Vasya and Petya wrote down all integers from 1 to n to play the ""powers"" game (n can be quite large; however, Vasya and Petya are not confused by this fact).Players choose numbers in turn (Vasya chooses first). If some number x is chosen at the current turn, it is forbidden to choose x or all of its other positive integer powers (that is, x2, x3, ...) at the next turns. For instance, if the number 9 is chosen at the first turn, one cannot choose 9 or 81 later, while it is still allowed to choose 3 or 27. The one who cannot make a move loses.Who wins if both Vasya and Petya play optimally?" 2300
317C Balance "constructive algorithms,dfs and similar,graphs,trees" "A system of n vessels with water is given. Several pairs of vessels are connected by tubes with transfusion mechanisms. One may transfer an integer amount of liters of water between two vessels connected by such tube (tube works in both directions). There might be multiple tubes between two vessels. Total number of tubes equals e. Volume of each vessel equals v liters. Of course, the amount of the water in any vessel cannot exceed v liters in the process of transfusions.Given the initial amounts ai of water in the vessels and the desired amounts bi find a sequence of transfusions that deals with the task. Total number of transfusions must not exceed 2\xc2\xb7n2." 2500
317B Ants "brute force,implementation" "It has been noted that if some ants are put in the junctions of the graphene integer lattice then they will act in the following fashion: every minute at each junction (x, y) containing at least four ants a group of four ants will be formed, and these four ants will scatter to the neighbouring junctions (x\xe2\x80\x89+\xe2\x80\x891, y), (x\xe2\x80\x89-\xe2\x80\x891, y), (x, y\xe2\x80\x89+\xe2\x80\x891), (x, y\xe2\x80\x89-\xe2\x80\x891) \xe2\x80\x94 one ant in each direction. No other ant movements will happen. Ants never interfere with each other.Scientists have put a colony of n ants into the junction (0, 0) and now they wish to know how many ants will there be at some given junctions, when the movement of the ants stops." 2000
317A "Perfect Pair" "brute force" "Let us call a pair of integer numbers m-perfect, if at least one number in the pair is greater than or equal to m. Thus, the pairs (3, 3) and (0, 2) are 2-perfect while the pair (-1, 1) is not.Two integers x, y are written on the blackboard. It is allowed to erase one of them and replace it with the sum of the numbers, (x\xe2\x80\x89+\xe2\x80\x89y).What is the minimum number of such operations one has to perform in order to make the given pair of integers m-perfect?" 1600
316G3 "Good Substrings" "string suffix structures" "Smart Beaver recently got interested in a new word game. The point is as follows: count the number of distinct good substrings of some string s. To determine if a string is good or not the game uses rules. Overall there are n rules. Each rule is described by a group of three (p,\xe2\x80\x89l,\xe2\x80\x89r), where p is a string and l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are integers. We\xe2\x80\x99ll say that string t complies with rule (p,\xe2\x80\x89l,\xe2\x80\x89r), if the number of occurrences of string t in string p lies between l and r, inclusive. For example, string ""ab"", complies with rules (""ab"", 1, 2) and (""aab"", 0, 1), but does not comply with rules (""cd"", 1, 2) and (""abab"", 0, 1).A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is a length of s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.Consider a number of occurrences  of string t in string p as a number of pairs of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|) such that p[l... r]\xe2\x80\x89=\xe2\x80\x89t.We\xe2\x80\x99ll say that string t is good if it complies with all n rules. Smart Beaver asks you to help him to write a program that can calculate the number of distinct good substrings of string s. Two substrings s[x... y] and s[z... w] are cosidered to be distinct iff s[x... y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[z... w]." 2400
316G2 "Good Substrings" "string suffix structures" "Smart Beaver recently got interested in a new word game. The point is as follows: count the number of distinct good substrings of some string s. To determine if a string is good or not the game uses rules. Overall there are n rules. Each rule is described by a group of three (p,\xe2\x80\x89l,\xe2\x80\x89r), where p is a string and l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are integers. We\xe2\x80\x99ll say that string t complies with rule (p,\xe2\x80\x89l,\xe2\x80\x89r), if the number of occurrences of string t in string p lies between l and r, inclusive. For example, string ""ab"", complies with rules (""ab"", 1, 2) and (""aab"", 0, 1), but does not comply with rules (""cd"", 1, 2) and (""abab"", 0, 1).A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is a length of s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.Consider a number of occurrences  of string t in string p as a number of pairs of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|) such that p[l... r]\xe2\x80\x89=\xe2\x80\x89t.We\xe2\x80\x99ll say that string t is good if it complies with all n rules. Smart Beaver asks you to help him to write a program that can calculate the number of distinct good substrings of string s. Two substrings s[x... y] and s[z... w] are cosidered to be distinct iff s[x... y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[z... w]." 2200
316G1 "Good Substrings" hashing,strings "Smart Beaver recently got interested in a new word game. The point is as follows: count the number of distinct good substrings of some string s. To determine if a string is good or not the game uses rules. Overall there are n rules. Each rule is described by a group of three (p,\xe2\x80\x89l,\xe2\x80\x89r), where p is a string and l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are integers. We\xe2\x80\x99ll say that string t complies with rule (p,\xe2\x80\x89l,\xe2\x80\x89r), if the number of occurrences of string t in string p lies between l and r, inclusive. For example, string ""ab"", complies with rules (""ab"", 1, 2) and (""aab"", 0, 1), but does not comply with rules (""cd"", 1, 2) and (""abab"", 0, 1).A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (|s| is a length of s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.Consider a number of occurrences  of string t in string p as a number of pairs of integers l,\xe2\x80\x89r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|p|) such that p[l... r]\xe2\x80\x89=\xe2\x80\x89t.We\xe2\x80\x99ll say that string t is good if it complies with all n rules. Smart Beaver asks you to help him to write a program that can calculate the number of distinct good substrings of string s. Two substrings s[x... y] and s[z... w] are cosidered to be distinct iff s[x... y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[z... w]." 1700
316F3 "Suns and Rays" "constructive algorithms,dfs and similar,implementation" "Smart Beaver became interested in drawing. He draws suns. However, at some point, Smart Beaver realized that simply drawing suns is boring. So he decided to design a program that will process his drawings. You are given a picture drawn by the beaver. It will have two colors: one for the background and one for the suns in the image. Your task will be to count the number of suns in the image and for each of them to count the number of rays.Sun is arbitrarily rotated ellipse with rays. Ray is a segment which connects point on boundary of the ellipse with some point outside ellipse.   An image where all suns are circles.     An image where all suns are ellipses, their axes are parallel to the coordinate axes.     An image where all suns are rotated ellipses.  It is guaranteed that:   No two suns have common points.  The rays\xe2\x80\x99 width is 3 pixels.  The lengths of the ellipsis suns\xe2\x80\x99 axes will lie between 40 and 200 pixels.  No two rays intersect.  The lengths of all rays will lie between 10 and 30 pixels." 2200
316F2 "Suns and Rays" NA "Smart Beaver became interested in drawing. He draws suns. However, at some point, Smart Beaver realized that simply drawing suns is boring. So he decided to design a program that will process his drawings. You are given a picture drawn by the beaver. It will have two colors: one for the background and one for the suns in the image. Your task will be to count the number of suns in the image and for each of them to count the number of rays.Sun is arbitrarily rotated ellipse with rays. Ray is a segment which connects point on boundary of the ellipse with some point outside ellipse.   An image where all suns are circles.     An image where all suns are ellipses, their axes are parallel to the coordinate axes.     An image where all suns are rotated ellipses.  It is guaranteed that:   No two suns have common points.  The rays\xe2\x80\x99 width is 3 pixels.  The lengths of the ellipsis suns\xe2\x80\x99 axes will lie between 40 and 200 pixels.  No two rays intersect.  The lengths of all rays will lie between 10 and 30 pixels." 2300
316F1 "Suns and Rays" "dfs and similar,implementation" "Smart Beaver became interested in drawing. He draws suns. However, at some point, Smart Beaver realized that simply drawing suns is boring. So he decided to design a program that will process his drawings. You are given a picture drawn by the beaver. It will have two colors: one for the background and one for the suns in the image. Your task will be to count the number of suns in the image and for each of them to count the number of rays.Sun is arbitrarily rotated ellipse with rays. Ray is a segment which connects point on boundary of the ellipse with some point outside ellipse.   An image where all suns are circles.     An image where all suns are ellipses, their axes are parallel to the coordinate axes.     An image where all suns are rotated ellipses.  It is guaranteed that:   No two suns have common points.  The rays\xe2\x80\x99 width is 3 pixels.  The lengths of the ellipsis suns\xe2\x80\x99 axes will lie between 40 and 200 pixels.  No two rays intersect.  The lengths of all rays will lie between 10 and 30 pixels." 2200
316E3 "Summer Homework" "data structures,math" "By the age of three Smart Beaver mastered all arithmetic operations and got this summer homework from the amazed teacher:You are given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to perform on it m consecutive operations of the following type:  For given numbers xi and vi assign value vi to element axi.  For given numbers li and ri you\'ve got to calculate sum , where f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and at i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892: fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892.  For a group of three numbers li ri di you should increase value ax by di for all x (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri). Smart Beaver planned a tour around great Canadian lakes, so he asked you to help him solve the given problem." 2300
316E2 "Summer Homework" "data structures,math" "By the age of three Smart Beaver mastered all arithmetic operations and got this summer homework from the amazed teacher:You are given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to perform on it m consecutive operations of the following type:  For given numbers xi and vi assign value vi to element axi.  For given numbers li and ri you\'ve got to calculate sum , where f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and at i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892: fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892.  For a group of three numbers li ri di you should increase value ax by di for all x (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri). Smart Beaver planned a tour around great Canadian lakes, so he asked you to help him solve the given problem." 2300
316E1 "Summer Homework" "brute force,data structures" "By the age of three Smart Beaver mastered all arithmetic operations and got this summer homework from the amazed teacher:You are given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to perform on it m consecutive operations of the following type:  For given numbers xi and vi assign value vi to element axi.  For given numbers li and ri you\'ve got to calculate sum , where f0\xe2\x80\x89=\xe2\x80\x89f1\xe2\x80\x89=\xe2\x80\x891 and at i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892: fi\xe2\x80\x89=\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89fi\xe2\x80\x89-\xe2\x80\x892.  For a group of three numbers li ri di you should increase value ax by di for all x (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri). Smart Beaver planned a tour around great Canadian lakes, so he asked you to help him solve the given problem." 1500
316D3 "PE Lesson" dp,math "Smart Beaver decided to be not only smart, but also a healthy beaver! And so he began to attend physical education classes at school X. In this school, physical education has a very creative teacher. One of his favorite warm-up exercises is throwing balls. Students line up. Each one gets a single ball in the beginning. The balls are numbered from 1 to n (by the demand of the inventory commission).   Figure 1. The initial position for n\xe2\x80\x89=\xe2\x80\x895.  After receiving the balls the students perform the warm-up exercise. The exercise takes place in a few throws. For each throw the teacher chooses any two arbitrary different students who will participate in it. The selected students throw their balls to each other. Thus, after each throw the students remain in their positions, and the two balls are swapped.   Figure 2. The example of a throw.  In this case there was a throw between the students, who were holding the 2-nd and the 4-th balls. Since the warm-up has many exercises, each of them can only continue for little time. Therefore, for each student we know the maximum number of throws he can participate in. For this lessons maximum number of throws will be 1 or 2.Note that after all phases of the considered exercise any ball can end up with any student. Smart Beaver decided to formalize it and introduced the concept of the ""ball order"". The ball order is a sequence of n numbers that correspond to the order of balls in the line. The first number will match the number of the ball of the first from the left student in the line, the second number will match the ball of the second student, and so on. For example, in figure 2 the order of the balls was (1, 2, 3, 4, 5), and after the throw it was (1, 4, 3, 2, 5). Smart beaver knows the number of students and for each student he knows the maximum number of throws in which he can participate. And now he is wondering: what is the number of distinct ways of ball orders by the end of the exercise." 2400
316D2 "PE Lesson" dp "Smart Beaver decided to be not only smart, but also a healthy beaver! And so he began to attend physical education classes at school X. In this school, physical education has a very creative teacher. One of his favorite warm-up exercises is throwing balls. Students line up. Each one gets a single ball in the beginning. The balls are numbered from 1 to n (by the demand of the inventory commission).   Figure 1. The initial position for n\xe2\x80\x89=\xe2\x80\x895.  After receiving the balls the students perform the warm-up exercise. The exercise takes place in a few throws. For each throw the teacher chooses any two arbitrary different students who will participate in it. The selected students throw their balls to each other. Thus, after each throw the students remain in their positions, and the two balls are swapped.   Figure 2. The example of a throw.  In this case there was a throw between the students, who were holding the 2-nd and the 4-th balls. Since the warm-up has many exercises, each of them can only continue for little time. Therefore, for each student we know the maximum number of throws he can participate in. For this lessons maximum number of throws will be 1 or 2.Note that after all phases of the considered exercise any ball can end up with any student. Smart Beaver decided to formalize it and introduced the concept of the ""ball order"". The ball order is a sequence of n numbers that correspond to the order of balls in the line. The first number will match the number of the ball of the first from the left student in the line, the second number will match the ball of the second student, and so on. For example, in figure 2 the order of the balls was (1, 2, 3, 4, 5), and after the throw it was (1, 4, 3, 2, 5). Smart beaver knows the number of students and for each student he knows the maximum number of throws in which he can participate. And now he is wondering: what is the number of distinct ways of ball orders by the end of the exercise." 2300
316D1 "PE Lesson" "brute force,dp" "Smart Beaver decided to be not only smart, but also a healthy beaver! And so he began to attend physical education classes at school X. In this school, physical education has a very creative teacher. One of his favorite warm-up exercises is throwing balls. Students line up. Each one gets a single ball in the beginning. The balls are numbered from 1 to n (by the demand of the inventory commission).   Figure 1. The initial position for n\xe2\x80\x89=\xe2\x80\x895.  After receiving the balls the students perform the warm-up exercise. The exercise takes place in a few throws. For each throw the teacher chooses any two arbitrary different students who will participate in it. The selected students throw their balls to each other. Thus, after each throw the students remain in their positions, and the two balls are swapped.   Figure 2. The example of a throw.  In this case there was a throw between the students, who were holding the 2-nd and the 4-th balls. Since the warm-up has many exercises, each of them can only continue for little time. Therefore, for each student we know the maximum number of throws he can participate in. For this lessons maximum number of throws will be 1 or 2.Note that after all phases of the considered exercise any ball can end up with any student. Smart Beaver decided to formalize it and introduced the concept of the ""ball order"". The ball order is a sequence of n numbers that correspond to the order of balls in the line. The first number will match the number of the ball of the first from the left student in the line, the second number will match the ball of the second student, and so on. For example, in figure 2 the order of the balls was (1, 2, 3, 4, 5), and after the throw it was (1, 4, 3, 2, 5). Smart beaver knows the number of students and for each student he knows the maximum number of throws in which he can participate. And now he is wondering: what is the number of distinct ways of ball orders by the end of the exercise." 2300
316C2 "Tidying Up" "flows,graph matchings" "Smart Beaver is careful about his appearance and pays special attention to shoes so he has a huge number of pairs of shoes from the most famous brands of the forest. He\'s trying to handle his shoes carefully so that each pair stood side by side. But by the end of the week because of his very active lifestyle in his dressing room becomes a mess.Smart Beaver from ABBYY is not only the brightest beaver in the area, but he also is the most domestically oriented. For example, on Mondays the Smart Beaver cleans everything in his home.It\'s Monday morning. Smart Beaver does not want to spend the whole day cleaning, besides, there is much in to do and it\xe2\x80\x99s the gym day, so he wants to clean up as soon as possible. Now the floors are washed, the dust is wiped off \xe2\x80\x94 it\xe2\x80\x99s time to clean up in the dressing room. But as soon as the Smart Beaver entered the dressing room, all plans for the day were suddenly destroyed: chaos reigned there and it seemed impossible to handle, even in a week. Give our hero some hope: tell him what is the minimum number of shoes need to change the position to make the dressing room neat.The dressing room is rectangular and is divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m equal squares, each square contains exactly one shoe. Each pair of shoes has a unique number that is integer from 1 to , more formally, a square with coordinates (i,\xe2\x80\x89j) contains an integer number of the pair which is lying on it. The Smart Beaver believes that the dressing room is neat only when each pair of sneakers lies together. We assume that the pair of sneakers in squares (i1,\xe2\x80\x89j1) and (i2,\xe2\x80\x89j2) lies together if |i1\xe2\x80\x89-\xe2\x80\x89i2|\xe2\x80\x89+\xe2\x80\x89|j1\xe2\x80\x89-\xe2\x80\x89j2|\xe2\x80\x89=\xe2\x80\x891." 2300
316C1 "Tidying Up" flows "Smart Beaver is careful about his appearance and pays special attention to shoes so he has a huge number of pairs of shoes from the most famous brands of the forest. He\'s trying to handle his shoes carefully so that each pair stood side by side. But by the end of the week because of his very active lifestyle in his dressing room becomes a mess.Smart Beaver from ABBYY is not only the brightest beaver in the area, but he also is the most domestically oriented. For example, on Mondays the Smart Beaver cleans everything in his home.It\'s Monday morning. Smart Beaver does not want to spend the whole day cleaning, besides, there is much in to do and it\xe2\x80\x99s the gym day, so he wants to clean up as soon as possible. Now the floors are washed, the dust is wiped off \xe2\x80\x94 it\xe2\x80\x99s time to clean up in the dressing room. But as soon as the Smart Beaver entered the dressing room, all plans for the day were suddenly destroyed: chaos reigned there and it seemed impossible to handle, even in a week. Give our hero some hope: tell him what is the minimum number of shoes need to change the position to make the dressing room neat.The dressing room is rectangular and is divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m equal squares, each square contains exactly one shoe. Each pair of shoes has a unique number that is integer from 1 to , more formally, a square with coordinates (i,\xe2\x80\x89j) contains an integer number of the pair which is lying on it. The Smart Beaver believes that the dressing room is neat only when each pair of sneakers lies together. We assume that the pair of sneakers in squares (i1,\xe2\x80\x89j1) and (i2,\xe2\x80\x89j2) lies together if |i1\xe2\x80\x89-\xe2\x80\x89i2|\xe2\x80\x89+\xe2\x80\x89|j1\xe2\x80\x89-\xe2\x80\x89j2|\xe2\x80\x89=\xe2\x80\x891." 2200
316B2 EKG "dfs and similar,dp" "In the rush of modern life, people often forget how beautiful the world is. The time to enjoy those around them is so little that some even stand in queues to several rooms at the same time in the clinic, running from one queue to another.(Cultural note: standing in huge and disorganized queues for hours is a native tradition in Russia, dating back to the Soviet period. Queues can resemble crowds rather than lines. Not to get lost in such a queue, a person should follow a strict survival technique: you approach the queue and ask who the last person is, somebody answers and you join the crowd. Now you\'re the last person in the queue till somebody else shows up. You keep an eye on the one who was last before you as he is your only chance to get to your destination) I\'m sure many people have had the problem when a stranger asks who the last person in the queue is and even dares to hint that he will be the last in the queue and then bolts away to some unknown destination. These are the representatives of the modern world, in which the ratio of lack of time is so great that they do not even watch foreign top-rated TV series. Such people often create problems in queues, because the newcomer does not see the last person in the queue and takes a place after the ""virtual"" link in this chain, wondering where this legendary figure has left.The Smart Beaver has been ill and he\'s made an appointment with a therapist. The doctor told the Beaver the sad news in a nutshell: it is necessary to do an electrocardiogram. The next day the Smart Beaver got up early, put on the famous TV series on download (three hours till the download\'s complete), clenched his teeth and bravely went to join a queue to the electrocardiogram room, which is notorious for the biggest queues at the clinic.Having stood for about three hours in the queue, the Smart Beaver realized that many beavers had not seen who was supposed to stand in the queue before them and there was a huge mess. He came up to each beaver in the ECG room queue and asked who should be in front of him in the queue. If the beaver did not know his correct position in the queue, then it might be his turn to go get an ECG, or maybe he should wait for a long, long time...As you\'ve guessed, the Smart Beaver was in a hurry home, so he gave you all the necessary information for you to help him to determine what his number in the queue can be." 1600
316B1 EKG "brute force,dfs and similar" "In the rush of modern life, people often forget how beautiful the world is. The time to enjoy those around them is so little that some even stand in queues to several rooms at the same time in the clinic, running from one queue to another.(Cultural note: standing in huge and disorganized queues for hours is a native tradition in Russia, dating back to the Soviet period. Queues can resemble crowds rather than lines. Not to get lost in such a queue, a person should follow a strict survival technique: you approach the queue and ask who the last person is, somebody answers and you join the crowd. Now you\'re the last person in the queue till somebody else shows up. You keep an eye on the one who was last before you as he is your only chance to get to your destination) I\'m sure many people have had the problem when a stranger asks who the last person in the queue is and even dares to hint that he will be the last in the queue and then bolts away to some unknown destination. These are the representatives of the modern world, in which the ratio of lack of time is so great that they do not even watch foreign top-rated TV series. Such people often create problems in queues, because the newcomer does not see the last person in the queue and takes a place after the ""virtual"" link in this chain, wondering where this legendary figure has left.The Smart Beaver has been ill and he\'s made an appointment with a therapist. The doctor told the Beaver the sad news in a nutshell: it is necessary to do an electrocardiogram. The next day the Smart Beaver got up early, put on the famous TV series on download (three hours till the download\'s complete), clenched his teeth and bravely went to join a queue to the electrocardiogram room, which is notorious for the biggest queues at the clinic.Having stood for about three hours in the queue, the Smart Beaver realized that many beavers had not seen who was supposed to stand in the queue before them and there was a huge mess. He came up to each beaver in the ECG room queue and asked who should be in front of him in the queue. If the beaver did not know his correct position in the queue, then it might be his turn to go get an ECG, or maybe he should wait for a long, long time...As you\'ve guessed, the Smart Beaver was in a hurry home, so he gave you all the necessary information for you to help him to determine what his number in the queue can be." 1500
316A2 "Special Task" math "Special Agent Smart Beaver works in a secret research department of ABBYY. He\'s been working there for a long time and is satisfied with his job, as it allows him to eat out in the best restaurants and order the most expensive and exotic wood types there. The content special agent has got an important task: to get the latest research by British scientists on the English Language. These developments are encoded and stored in a large safe. The Beaver\'s teeth are strong enough, so the authorities assured that upon arriving at the place the beaver won\'t have any problems with opening the safe.And he finishes his aspen sprig and leaves for this important task. Of course, the Beaver arrived at the location without any problems, but alas. He can\'t open the safe with his strong and big teeth. At this point, the Smart Beaver get a call from the headquarters and learns that opening the safe with the teeth is not necessary, as a reliable source has sent the following information: the safe code consists of digits and has no leading zeroes. There also is a special hint, which can be used to open the safe. The hint is string s with the following structure:  if si = ""?"", then the digit that goes i-th in the safe code can be anything (between 0 to 9, inclusively);  if si is a digit (between 0 to 9, inclusively), then it means that there is digit si on position i in code;  if the string contains letters from ""A"" to ""J"", then all positions with the same letters must contain the same digits and the positions with distinct letters must contain distinct digits.  The length of the safe code coincides with the length of the hint. For example, hint ""?JGJ9"" has such matching safe code variants: ""51919"", ""55959"", ""12329"", ""93539"" and so on, and has wrong variants such as: ""56669"", ""00111"", ""03539"" and ""13666"".After receiving such information, the authorities change the plan and ask the special agents to work quietly and gently and not to try to open the safe by mechanical means, and try to find the password using the given hint.At a special agent school the Smart Beaver was the fastest in his platoon finding codes for such safes, but now he is not in that shape: the years take their toll ... Help him to determine the number of possible variants of the code to the safe, matching the given hint. After receiving this information, and knowing his own speed of entering codes, the Smart Beaver will be able to determine whether he will have time for tonight\'s show ""Beavers are on the trail"" on his favorite TV channel, or he should work for a sleepless night..." 1400
316A1 "Special Task" greedy "Special Agent Smart Beaver works in a secret research department of ABBYY. He\'s been working there for a long time and is satisfied with his job, as it allows him to eat out in the best restaurants and order the most expensive and exotic wood types there. The content special agent has got an important task: to get the latest research by British scientists on the English Language. These developments are encoded and stored in a large safe. The Beaver\'s teeth are strong enough, so the authorities assured that upon arriving at the place the beaver won\'t have any problems with opening the safe.And he finishes his aspen sprig and leaves for this important task. Of course, the Beaver arrived at the location without any problems, but alas. He can\'t open the safe with his strong and big teeth. At this point, the Smart Beaver get a call from the headquarters and learns that opening the safe with the teeth is not necessary, as a reliable source has sent the following information: the safe code consists of digits and has no leading zeroes. There also is a special hint, which can be used to open the safe. The hint is string s with the following structure:  if si = ""?"", then the digit that goes i-th in the safe code can be anything (between 0 to 9, inclusively);  if si is a digit (between 0 to 9, inclusively), then it means that there is digit si on position i in code;  if the string contains letters from ""A"" to ""J"", then all positions with the same letters must contain the same digits and the positions with distinct letters must contain distinct digits.  The length of the safe code coincides with the length of the hint. For example, hint ""?JGJ9"" has such matching safe code variants: ""51919"", ""55959"", ""12329"", ""93539"" and so on, and has wrong variants such as: ""56669"", ""00111"", ""03539"" and ""13666"".After receiving such information, the authorities change the plan and ask the special agents to work quietly and gently and not to try to open the safe by mechanical means, and try to find the password using the given hint.At a special agent school the Smart Beaver was the fastest in his platoon finding codes for such safes, but now he is not in that shape: the years take their toll ... Help him to determine the number of possible variants of the code to the safe, matching the given hint. After receiving this information, and knowing his own speed of entering codes, the Smart Beaver will be able to determine whether he will have time for tonight\'s show ""Beavers are on the trail"" on his favorite TV channel, or he should work for a sleepless night..." 1100
315B "Sereja and Array" implementation "Sereja has got an array, consisting of n integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Sereja is an active boy, so he is now going to complete m operations. Each operation will have one of the three forms:  Make vi-th array element equal to xi. In other words, perform the assignment avi\xe2\x80\x89=\xe2\x80\x89xi.  Increase each array element by yi. In other words, perform n assignments ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89yi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  Take a piece of paper and write out the qi-th array element. That is, the element aqi. Help Sereja, complete all his operations." 1200
315A "Sereja and Bottles" "brute force" "Sereja and his friends went to a picnic. The guys had n soda bottles just for it. Sereja forgot the bottle opener as usual, so the guys had to come up with another way to open bottles.Sereja knows that the i-th bottle is from brand ai, besides, you can use it to open other bottles of brand bi. You can use one bottle to open multiple other bottles. Sereja can open bottle with opened bottle or closed bottle.Knowing this, Sereja wants to find out the number of bottles they\'ve got that they won\'t be able to open in any way. Help him and find this number." 1400
314E "Sereja and Squares" dp "Sereja painted n points on the plane, point number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) has coordinates (i,\xe2\x80\x890). Then Sereja marked each point with a small or large English letter. Sereja don\'t like letter ""x"", so he didn\'t use it to mark points. Sereja thinks that the points are marked beautifully if the following conditions holds:  all points can be divided into pairs so that each point will belong to exactly one pair;  in each pair the point with the lesser abscissa will be marked with a small English letter and the point with the larger abscissa will be marked with the same large English letter;  if we built a square on each pair, the pair\'s points will be the square\'s opposite points and the segment between them will be the square\'s diagonal, then among the resulting squares there won\'t be any intersecting or touching ones. Little Petya erased some small and all large letters marking the points. Now Sereja wonders how many ways are there to return the removed letters so that the points were marked beautifully." 2900
314D "Sereja and Straight Lines" "binary search,data structures,geometry,sortings,two pointers" "Sereja placed n points on a plane. Now Sereja wants to place on the plane two straight lines, intersecting at a right angle, so that one of the straight lines intersect the Ox axis at an angle of 45 degrees and the maximum distance from the points to the straight lines were minimum. In this problem we consider the distance between points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) equal |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|. The distance between the point and the straight lines is the minimum distance from the point to some point belonging to one of the lines.Help Sereja, find the maximum distance from the points to the optimally located straight lines." 2500
314C "Sereja and Subsequences" "data structures,dp" "Sereja has a sequence that consists of n positive integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. First Sereja took a piece of squared paper and wrote all distinct non-empty non-decreasing subsequences of sequence a. Then for each sequence written on the squared paper, Sereja wrote on a piece of lines paper all sequences that do not exceed it.A sequence of positive integers x\xe2\x80\x89=\xe2\x80\x89x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xr doesn\'t exceed a sequence of positive integers y\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yr, if the following inequation holds: x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89xr\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yr.Now Sereja wonders, how many sequences are written on the lines piece of paper. Help Sereja, find the required quantity modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000
314B "Sereja and Periods" "binary search,dfs and similar,strings" "Let\'s introduce the designation , where x is a string, n is a positive integer and operation ""\xe2\x80\x89+\xe2\x80\x89"" is the string concatenation operation. For example, [abc,\xe2\x80\x892]\xe2\x80\x89=\xe2\x80\x89abcabc.We\'ll say that string s can be obtained from string t, if we can remove some characters from string t and obtain string s. For example, strings ab and a\xd1\x81ba can be obtained from string xacbac, and strings bx and aaa cannot be obtained from it.Sereja has two strings, w\xe2\x80\x89=\xe2\x80\x89[a,\xe2\x80\x89b] and q\xe2\x80\x89=\xe2\x80\x89[c,\xe2\x80\x89d]. He wants to find such maximum integer p (p\xe2\x80\x89>\xe2\x80\x890), that [q,\xe2\x80\x89p] can be obtained from string w." 2000
314A "Sereja and Contest" implementation "During the last Sereja\'s Codesecrof round the server crashed many times, so the round was decided to be made unrated for some participants. Let\'s assume that n people took part in the contest. Let\'s assume that the participant who got the first place has rating a1, the second place participant has rating a2, ..., the n-th place participant has rating an. Then changing the rating on the Codesecrof site is calculated by the formula .After the round was over, the Codesecrof management published the participants\' results table. They decided that if for a participant di\xe2\x80\x89<\xe2\x80\x89k, then the round can be considered unrated for him. But imagine the management\'s surprise when they found out that the participants\' rating table is dynamic. In other words, when some participant is removed from the rating, he is removed from the results\' table and the rating is recalculated according to the new table. And of course, all applications for exclusion from the rating are considered in view of the current table.We know that among all the applications for exclusion from the rating the first application to consider is from the participant with the best rank (the rank with the minimum number), for who di\xe2\x80\x89<\xe2\x80\x89k. We also know that the applications for exclusion from rating were submitted by all participants.Now Sereja wonders, what is the number of participants to be excluded from the contest rating, and the numbers of the participants in the original table in the order of their exclusion from the rating. Pay attention to the analysis of the first test case for a better understanding of the statement." 1600
313E "Ilya and Two Numbers" "constructive algorithms,data structures,dsu,greedy" "Ilya has recently taken up archaeology. He\'s recently found two numbers, written in the m-based notation. Each of the found numbers consisted of exactly n digits. Ilya immediately started looking for information about those numbers. He learned that the numbers are part of a cyphered code and the one who can decypher it can get the greatest treasure.After considerable research Ilya understood that to decypher the code, he should do the following:  Rearrange digits in the first number in some manner. Similarly, rearrange digits in the second number in some manner. As a result of this operation, the numbers can get leading zeroes.  Add numbers, digit by digit, modulo m. In other words, we need to get the third number of length n, each digit of the number is the sum of the respective numbers of the found numbers. For example, suppose there are two numbers recorded in the ternary notation, 001210 and 012111, then if you add them to each other digit by digit modulo 3, you will get number 010021.  The key to the code is the maximum possible number that can be obtained in the previous step. Help Ilya, find the key to the code." 2300
313D "Ilya and Roads" dp "Everything is great about Ilya\'s city, except the roads. The thing is, the only ZooVille road is represented as n holes in a row. We will consider the holes numbered from 1 to n, from left to right.Ilya is really keep on helping his city. So, he wants to fix at least k holes (perharps he can fix more) on a single ZooVille road. The city has m building companies, the i-th company needs ci money units to fix a road segment containing holes with numbers of at least li and at most ri. The companies in ZooVille are very greedy, so, if they fix a segment containing some already fixed holes, they do not decrease the price for fixing the segment. Determine the minimum money Ilya will need to fix at least k holes." 2100
313C "Ilya and Matrix" "constructive algorithms,greedy,implementation,sortings" "Ilya is a very good-natured lion. He likes maths. Of all mathematical objects, his favourite one is matrices. Now he\'s faced a complicated matrix problem he needs to solve.He\'s got a square 2n\xe2\x80\x89\xc3\x97\xe2\x80\x892n-sized matrix and 4n integers. You need to arrange all these numbers in the matrix (put each number in a single individual cell) so that the beauty of the resulting matrix with numbers is maximum.The beauty of a 2n\xe2\x80\x89\xc3\x97\xe2\x80\x892n-sized matrix is an integer, obtained by the following algorithm:  Find the maximum element in the matrix. Let\'s denote it as m.  If n\xe2\x80\x89=\xe2\x80\x890, then the beauty of the matrix equals m. Otherwise, a matrix can be split into 4 non-intersecting 2n\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x892n\xe2\x80\x89-\xe2\x80\x891-sized submatrices, then the beauty of the matrix equals the sum of number m and other four beauties of the described submatrices. As you can see, the algorithm is recursive.Help Ilya, solve the problem and print the resulting maximum beauty of the matrix." 1400
313B "Ilya and Queries" dp,implementation "Ilya the Lion wants to help all his friends with passing exams. They need to solve the following problem to pass the IT exam.You\'ve got string s\xe2\x80\x89=\xe2\x80\x89s1s2... sn (n is the length of the string), consisting only of characters ""."" and ""#"" and m queries. Each query is described by a pair of integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89<\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The answer to the query li,\xe2\x80\x89ri is the number of such integers i (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89ri), that si\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891.Ilya the Lion wants to help his friends but is there anyone to help him? Help Ilya, solve the problem." 1100
313A "Ilya and Bank Account" "implementation,number theory" "Ilya is a very clever lion, he lives in an unusual city ZooVille. In this city all the animals have their rights and obligations. Moreover, they even have their own bank accounts. The state of a bank account is an integer. The state of a bank account can be a negative number. This means that the owner of the account owes the bank money.Ilya the Lion has recently had a birthday, so he got a lot of gifts. One of them (the gift of the main ZooVille bank) is the opportunity to delete the last digit or the digit before last from the state of his bank account no more than once. For example, if the state of Ilya\'s bank account is -123, then Ilya can delete the last digit and get his account balance equal to -12, also he can remove its digit before last and get the account balance equal to -13. Of course, Ilya is permitted not to use the opportunity to delete a digit from the balance.Ilya is not very good at math, and that\'s why he asks you to help him maximize his bank account. Find the maximum state of the bank account that can be obtained using the bank\'s gift." 900
312B Archer math,probabilities "SmallR is an archer. SmallR is taking a match of archer with Zanoes. They try to shoot in the target in turns, and SmallR shoots first. The probability of shooting the target each time is  for SmallR while  for Zanoes. The one who shoots in the target first should be the winner.Output the probability that SmallR will win the match." 1300
312A "Whose sentence is it?" implementation,strings "One day, liouzhou_101 got a chat record of Freda and Rainbow. Out of curiosity, he wanted to know which sentences were said by Freda, and which were said by Rainbow. According to his experience, he thought that Freda always said ""lala."" at the end of her sentences, while Rainbow always said ""miao."" at the beginning of his sentences. For each sentence in the chat record, help liouzhou_101 find whose sentence it is." 1100
311E Biologist flows "SmallR is a biologist. Her latest research finding is how to change the sex of dogs. In other words, she can change female dogs into male dogs and vice versa.She is going to demonstrate this technique. Now SmallR has n dogs, the costs of each dog\'s change may be different. The dogs are numbered from 1 to n. The cost of change for dog i is vi RMB. By the way, this technique needs a kind of medicine which can be valid for only one day. So the experiment should be taken in one day and each dog can be changed at most once.This experiment has aroused extensive attention from all sectors of society. There are m rich folks which are suspicious of this experiment. They all want to bet with SmallR forcibly. If SmallR succeeds, the i-th rich folk will pay SmallR wi RMB. But it\'s strange that they have a special method to determine whether SmallR succeeds. For i-th rich folk, in advance, he will appoint certain ki dogs and certain one gender. He will think SmallR succeeds if and only if on some day the ki appointed dogs are all of the appointed gender. Otherwise, he will think SmallR fails.If SmallR can\'t satisfy some folk that isn\'t her friend, she need not pay him, but if someone she can\'t satisfy is her good friend, she must pay g RMB to him as apologies for her fail.Then, SmallR hope to acquire money as much as possible by this experiment. Please figure out the maximum money SmallR can acquire. By the way, it is possible that she can\'t obtain any money, even will lose money. Then, please give out the minimum money she should lose." 2300
311D "Interval Cubing" "data structures,math" "While learning Computational Geometry, Tiny is simultaneously learning a useful data structure called segment tree or interval tree. He has scarcely grasped it when comes out a strange problem:Given an integer sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You should run q queries of two types:  Given two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), ask the sum of all elements in the sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar.  Given two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), let each element x in the sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar becomes x3. In other words, apply an assignments al\xe2\x80\x89=\xe2\x80\x89al3,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x8913,\xe2\x80\x89...,\xe2\x80\x89ar\xe2\x80\x89=\xe2\x80\x89ar3. For every query of type 1, output the answer to it.Tiny himself surely cannot work it out, so he asks you for help. In addition, Tiny is a prime lover. He tells you that because the answer may be too huge, you should only output it modulo 95542721 (this number is a prime number)." 2600
311C "Fetch the Treasure" "brute force,data structures,graphs,shortest paths" "Rainbow built h cells in a row that are numbered from 1 to h from left to right. There are n cells with treasure. We call each of these n cells ""Treasure Cell"". The i-th ""Treasure Cell"" is the ai-th cell and the value of treasure in it is ci dollars.Then, Freda went in the first cell. For now, she can go just k cells forward, or return to the first cell. That means Freda was able to reach the 1st, (k\xe2\x80\x89+\xe2\x80\x891)-th, (2\xc2\xb7k\xe2\x80\x89+\xe2\x80\x891)-th, (3\xc2\xb7k\xe2\x80\x89+\xe2\x80\x891)-th cells and so on.Then Rainbow gave Freda m operations. Each operation is one of the following three types:  Add another method x: she can also go just x cells forward at any moment. For example, initially she has only one method k. If at some moment she has methods a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ar then she can reach all the cells with number in form , where vi \xe2\x80\x94 some non-negative integer.  Reduce the value of the treasure in the x-th ""Treasure Cell"" by y dollars. In other words, to apply assignment cx\xe2\x80\x89=\xe2\x80\x89cx\xe2\x80\x89-\xe2\x80\x89y.  Ask the value of the most valuable treasure among the cells Freda can reach. If Freda cannot reach any cell with the treasure then consider the value of the most valuable treasure equal to 0, and do nothing. Otherwise take the most valuable treasure away. If several ""Treasure Cells"" have the most valuable treasure, take the ""Treasure Cell"" with the minimum number (not necessarily with the minimum number of cell). After that the total number of cells with a treasure is decreased by one. As a programmer, you are asked by Freda to write a program to answer each query." 2500
311B "Cats Transport" "data structures,dp" "Zxr960115 is owner of a large farm. He feeds m cute cats and employs p feeders. There\'s a straight road across the farm and n hills along the road, numbered from 1 to n from left to right. The distance between hill i and (i\xe2\x80\x89-\xe2\x80\x891) is di meters. The feeders live in hill 1.One day, the cats went out to play. Cat i went on a trip to hill hi, finished its trip at time ti, and then waited at hill hi for a feeder. The feeders must take all the cats. Each feeder goes straightly from hill 1 to n without waiting at a hill and takes all the waiting cats at each hill away. Feeders walk at a speed of 1 meter per unit time and are strong enough to take as many cats as they want.For example, suppose we have two hills (d2\xe2\x80\x89=\xe2\x80\x891) and one cat that finished its trip at time 3 at hill 2 (h1\xe2\x80\x89=\xe2\x80\x892). Then if the feeder leaves hill 1 at time 2 or at time 3, he can take this cat, but if he leaves hill 1 at time 1 he can\'t take it. If the feeder leaves hill 1 at time 2, the cat waits him for 0 time units, if the feeder leaves hill 1 at time 3, the cat waits him for 1 time units.Your task is to schedule the time leaving from hill 1 for each feeder so that the sum of the waiting time of all cats is minimized." 2400
311A "The Closest Pair" "constructive algorithms,implementation" "Currently Tiny is learning Computational Geometry. When trying to solve a problem called ""The Closest Pair Of Points In The Plane"", he found that a code which gave a wrong time complexity got Accepted instead of Time Limit Exceeded.The problem is the follows. Given n points in the plane, find a pair of points between which the distance is minimized. Distance between (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) is .The pseudo code of the unexpected code is as follows:input nfor i from 1 to n    input the i-th point\'s coordinates into p[i]sort array p[] by increasing of x coordinate first and increasing of y coordinate secondd=INF        //here INF is a number big enoughtot=0for i from 1 to n    for j from (i+1) to n        ++tot        if (p[j].x-p[i].x>=d) then break    //notice that ""break"" is only to be                                            //out of the loop ""for j""        d=min(d,distance(p[i],p[j]))output dHere, tot can be regarded as the running time of the code. Due to the fact that a computer can only run a limited number of operations per second, tot should not be more than k in order not to get Time Limit Exceeded.You are a great hacker. Would you please help Tiny generate a test data and let the code get Time Limit Exceeded?" 1300
309E Sheep "binary search,greedy" "Information technologies are developing and are increasingly penetrating into all spheres of human activity. Incredible as it is, the most modern technology are used in farming!A large farm has a meadow with grazing sheep. Overall there are n sheep and each of them contains a unique number from 1 to n \xe2\x80\x94 because the sheep need to be distinguished and you need to remember information about each one, and they are so much alike! The meadow consists of infinite number of regions numbered from 1 to infinity. It\'s known that sheep i likes regions from li to ri.There are two shepherds taking care of the sheep: First and Second. First wakes up early in the morning and leads the sheep graze on the lawn. Second comes in the evening and collects all the sheep.One morning, First woke up a little later than usual, and had no time to lead the sheep graze on the lawn. So he tied together every two sheep if there is a region they both like. First thought that it would be better \xe2\x80\x94 Second would have less work in the evening, because sheep won\'t scatter too much, being tied to each other!In the evening Second came on the lawn, gathered the sheep and tried to line them up in a row. But try as he might, the sheep wouldn\'t line up as Second want! Second had neither the strength nor the ability to untie the sheep so he left them as they are, but with one condition: he wanted to line up the sheep so that the maximum distance between two tied sheep was as small as possible. The distance between the sheep is the number of sheep in the ranks that are between these two.Help Second find the right arrangement." 2900
309D "Tennis Rackets" "brute force,geometry" "Professional sport is more than hard work. It also is the equipment, designed by top engineers. As an example, let\'s take tennis. Not only should you be in great shape, you also need an excellent racket! In this problem your task is to contribute to the development of tennis and to help to design a revolutionary new concept of a racket!The concept is a triangular racket. Ant it should be not just any triangle, but a regular one. As soon as you\'ve chosen the shape, you need to stretch the net. By the time you came the rocket had n holes drilled on each of its sides. The holes divide each side into equal n\xe2\x80\x89+\xe2\x80\x891 parts. At that, the m closest to each apex holes on each side are made for better ventilation only and you cannot stretch the net through them. The next revolutionary idea as to stretch the net as obtuse triangles through the holes, so that for each triangle all apexes lay on different sides. Moreover, you need the net to be stretched along every possible obtuse triangle. That\'s where we need your help \xe2\x80\x94 help us to count the number of triangles the net is going to consist of.Two triangles are considered to be different if their pictures on the fixed at some position racket are different." 2700
309C "Memory for Arrays" "binary search,bitmasks,greedy" "You get to work and turn on the computer. You start coding and give little thought to the RAM role in the whole process. In this problem your task is to solve one of the problems you encounter in your computer routine.We\'ll consider the RAM as a sequence of cells that can contain data. Some cells already contain some data, some are empty. The empty cells form the so-called memory clusters. Thus, a memory cluster is a sequence of some consecutive empty memory cells. You have exactly n memory clusters, the i-th cluster consists of ai cells. You need to find memory for m arrays in your program. The j-th array takes 2bj consecutive memory cells. There possibly isn\'t enough memory for all m arrays, so your task is to determine what maximum number of arrays can be located in the available memory clusters. Of course, the arrays cannot be divided between the memory clusters. Also, no cell can belong to two arrays." 1900
309B "Context Advertising" "dp,two pointers" "Advertising has become part of our routine. And now, in the era of progressive technologies, we need your ideas to make advertising better!In this problem we\'ll look at a simplified version of context advertising. You\'ve got a text, consisting of exactly n words. A standard advertising banner has exactly r lines, each line can contain at most c characters. The potential customer always likes it when they can see lots of advertising, so you should determine which maximum number of consecutive words from the text can be written on the banner. Single words in one line of the banner should be separated by spaces. You are allowed to insert more than one space at once. Note that you are not allowed to break the words, that is, each word in the text must occupy exactly one line in the banner. Besides, you cannot change the word order, that is, if you read the banner text consecutively, from top to bottom and from left to right, you should get some consecutive part of the advertisement text.More formally, the statement can be written like that. Let\'s say that all words are indexed from 1 to n in the order in which they occur in the advertisement text. Then you have to choose all words, starting from some i-th one and ending with some j-th one (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), so that all of them could be written on the banner. There must be as many words as possible. See the samples for clarifications." 2100
309A "Morning run" "binary search,math,two pointers" "People like to be fit. That\'s why many of them are ready to wake up at dawn, go to the stadium and run. In this problem your task is to help a company design a new stadium. The city of N has a shabby old stadium. Many people like it and every morning thousands of people come out to this stadium to run. The stadium can be represented as a circle, its length is exactly l meters with a marked start line. However, there can\'t be simultaneous start in the morning, so exactly at 7, each runner goes to his favorite spot on the stadium and starts running from there. Note that not everybody runs in the same manner as everybody else. Some people run in the clockwise direction, some of them run in the counter-clockwise direction. It mostly depends on the runner\'s mood in the morning, so you can assume that each running direction is equiprobable for each runner in any fixed morning. The stadium is tiny and is in need of major repair, for right now there only is one running track! You can\'t get too playful on a single track, that\'s why all runners keep the same running speed \xe2\x80\x94 exactly 1 meter per a time unit. Nevertheless, the runners that choose different directions bump into each other as they meet. The company wants to design a new stadium, but they first need to know how bad the old one is. For that they need the expectation of the number of bumpings by t time units after the running has begun. Help the company count the required expectation. Note that each runner chooses a direction equiprobably, independently from the others and then all runners start running simultaneously at 7 a.m. Assume that each runner runs for t time units without stopping. Consider the runners to bump at a certain moment if at that moment they found themselves at the same point in the stadium. A pair of runners can bump more than once." 2000
306D Polygon "constructive algorithms,geometry" "Polycarpus loves convex polygons, especially if all their angles are the same and all their sides are different. Draw for him any such polygon with the given number of vertexes." 2300
306C "White, Black and White Again" "combinatorics,number theory" "Polycarpus is sure that his life fits the description: ""first there is a white stripe, then a black one, then a white one again"". So, Polycarpus is sure that this rule is going to fulfill during the next n days. Polycarpus knows that he is in for w good events and b not-so-good events. At least one event is going to take place during each day. As each day is unequivocally characterizes as a part of a white or a black stripe, then each day is going to have events of the same type only (ether good or not-so-good).What is the number of distinct ways this scenario can develop over the next n days if Polycarpus is in for a white stripe (a stripe that has good events only, the stripe\'s length is at least 1 day), the a black stripe (a stripe that has not-so-good events only, the stripe\'s length is at least 1 day) and a white stripe again (a stripe that has good events only, the stripe\'s length is at least 1 day). Each of n days will belong to one of the three stripes only.Note that even the events of the same type are distinct from each other. Even if some events occur on the same day, they go in some order (there are no simultaneous events).Write a code that prints the number of possible configurations to sort the events into days. See the samples for clarifications on which scenarios should be considered distinct. Print the answer modulo 1000000009 (109\xe2\x80\x89+\xe2\x80\x899)." 2100
306B Optimizer "data structures,greedy,sortings" "A process RAM is a sequence of bytes that are indexed from 1 to n. Polycarpus\'s program contains such instructions as ""memset"", that is, the operations of filling memory cells on a segment with some value. The details are: the code only contains m instructions that look like ""set13 a_i l_i"". Instruction i fills a continuous memory segment of length li, starting from cell number ai, (that it cells with numbers ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89li\xe2\x80\x89-\xe2\x80\x891) with values 13.In Polycarpus\'s code, the optimizer\'s task is to remove the maximum number of instructions from his code in such a way that the remaining instructions set value 13 in all the memory bytes that got this value from the code before the optimization. Also, the value 13 should be set only in the memory bytes that got this value from the code before the optimization. Your task is to implement the optimizer for such program." 2100
306A Candies implementation "Polycarpus has got n candies and m friends (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89m). He wants to make a New Year present with candies to each friend. Polycarpus is planning to present all candies and he wants to do this in the fairest (that is, most equal) manner. He wants to choose such ai, where ai is the number of candies in the i-th friend\'s present, that the maximum ai differs from the least ai as little as possible.For example, if n is divisible by m, then he is going to present the same number of candies to all his friends, that is, the maximum ai won\'t differ from the minimum one." 800
305E "Playing with String" games "Two people play the following string game. Initially the players have got some string s. The players move in turns, the player who cannot make a move loses. Before the game began, the string is written on a piece of paper, one letter per cell.  An example of the initial situation at s = ""abacaba"" A player\'s move is the sequence of actions:  The player chooses one of the available pieces of paper with some string written on it. Let\'s denote it is t. Note that initially, only one piece of paper is available.  The player chooses in the string t\xe2\x80\x89=\xe2\x80\x89t1t2... t|t| character in position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|t|) such that for some positive integer l (0\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89-\xe2\x80\x89l; i\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|t|) the following equations hold: ti\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891, ti\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x892, ..., ti\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89=\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x89l.  Player cuts the cell with the chosen character. As a result of the operation, he gets three new pieces of paper, the first one will contain string t1t2... ti\xe2\x80\x89-\xe2\x80\x891, the second one will contain a string consisting of a single character ti, the third one contains string ti\xe2\x80\x89+\xe2\x80\x891ti\xe2\x80\x89+\xe2\x80\x892... t|t|.   An example of making action (i\xe2\x80\x89=\xe2\x80\x894) with string s = \xc2\xababacaba\xc2\xbb Your task is to determine the winner provided that both players play optimally well. If the first player wins, find the position of character that is optimal to cut in his first move. If there are multiple positions, print the minimal possible one." 2300
305D "Olya and Graph" combinatorics,math "Olya has got a directed non-weighted graph, consisting of n vertexes and m edges. We will consider that the graph vertexes are indexed from 1 to n in some manner. Then for any graph edge that goes from vertex v to vertex u the following inequation holds: v\xe2\x80\x89<\xe2\x80\x89u.Now Olya wonders, how many ways there are to add an arbitrary (possibly zero) number of edges to the graph so as the following conditions were met:  You can reach vertexes number i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n from any vertex number i (i\xe2\x80\x89<\xe2\x80\x89n).  For any graph edge going from vertex v to vertex u the following inequation fulfills: v\xe2\x80\x89<\xe2\x80\x89u.  There is at most one edge between any two vertexes.  The shortest distance between the pair of vertexes i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j), for which j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k holds, equals j\xe2\x80\x89-\xe2\x80\x89i edges.  The shortest distance between the pair of vertexes i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j), for which j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89>\xe2\x80\x89k holds, equals either j\xe2\x80\x89-\xe2\x80\x89i or j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89-\xe2\x80\x89k edges.  We will consider two ways distinct, if there is the pair of vertexes i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j), such that first resulting graph has an edge from i to j and the second one doesn\'t have it.Help Olya. As the required number of ways can be rather large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2200
305C "Ivan and Powers of Two" greedy,implementation "Ivan has got an array of n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Ivan knows that the array is sorted in the non-decreasing order. Ivan wrote out integers 2a1,\xe2\x80\x892a2,\xe2\x80\x89...,\xe2\x80\x892an on a piece of paper. Now he wonders, what minimum number of integers of form 2b (b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) need to be added to the piece of paper so that the sum of all integers written on the paper equalled 2v\xe2\x80\x89-\xe2\x80\x891 for some integer v (v\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890). Help Ivan, find the required quantity of numbers." 1600
305B "Continued Fractions" "brute force,implementation,math" "A continued fraction of height n is a fraction of form . You are given two rational numbers, one is represented as  and the other one is represented as a finite fraction of height n. Check if they are equal." 1700
305A "Strange Addition" "brute force,constructive algorithms,implementation" "Unfortunately, Vasya can only sum pairs of integers (a, b), such that for any decimal place at least one number has digit 0 in this place. For example, Vasya can sum numbers 505 and 50, but he cannot sum 1 and 4.Vasya has a set of k distinct non-negative integers d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dk.Vasya wants to choose some integers from this set so that he could sum any two chosen numbers. What maximal number of integers can he choose in the required manner?" 1600
304B Calendar "brute force,implementation" "Calendars in widespread use today include the Gregorian calendar, which is the de facto international standard, and is used almost everywhere in the world for civil purposes. The Gregorian reform modified the Julian calendar\'s scheme of leap years as follows: Every year that is exactly divisible by four is a leap year, except for years that are exactly divisible by 100; the centurial years that are exactly divisible by 400 are still leap years. For example, the year 1900 is not a leap year; the year 2000 is a leap year.   In this problem, you have been given two dates and your task is to calculate how many days are between them. Note, that leap years have unusual number of days in February.Look at the sample to understand what borders are included in the aswer." 1300
304A "Pythagorean Theorem II" "brute force,math" "In mathematics, the Pythagorean theorem \xe2\x80\x94 is a relation in Euclidean geometry among the three sides of a right-angled triangle. In terms of areas, it states: \x7fIn any right-angled triangle, the area of the square whose side is the hypotenuse (the side opposite the right angle) is equal to the sum of the areas of the squares whose sides are the two legs (the two sides that meet at a right angle). The theorem can be written as an equation relating the lengths of the sides a, b and c, often called the Pythagorean equation:a2\xe2\x80\x89+\xe2\x80\x89b2\xe2\x80\x89=\xe2\x80\x89c2where c represents the length of the hypotenuse, and a and b represent the lengths of the other two sides.  Given n, your task is to count how many right-angled triangles with side-lengths a, b and c that satisfied an inequality 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 1200
303E "Random Ranking" dp,math,probabilities "Imagine a real contest or exam of n participants. Every participant will get a particular score. We can predict the standings board more or less, if we do some statistics on their previous performance.  Let\'s say the score of the participants will be uniformly distributed in interval [li,\xe2\x80\x89ri] (the score can be a real number). Can you predict the standings board according to these data? In other words you should say for each participant the probability that he gets some fixed place in the scoreboard. The participants are sorted by increasing of their scores in the scoreboard. So, the participant with the largest score gets the last place." 3000
303D "Rotatable Number" "math,number theory" "Bike is a smart boy who loves math very much. He invented a number called ""Rotatable Number"" inspired by 142857. As you can see, 142857 is a magic number because any of its rotatings can be got by multiplying that number by 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x896 (numbers from one to number\'s length). Rotating a number means putting its last several digit into first. For example, by rotating number 12345 you can obtain any numbers: 12345,\xe2\x80\x8951234,\xe2\x80\x8945123,\xe2\x80\x8934512,\xe2\x80\x8923451. It\'s worth mentioning that leading-zeroes are allowed. So both 4500123 and 0123450 can be obtained by rotating 0012345. You can see why 142857 satisfies the condition. All of the 6 equations are under base 10.  142857\xc2\xb71\xe2\x80\x89=\xe2\x80\x89142857;  142857\xc2\xb72\xe2\x80\x89=\xe2\x80\x89285714;  142857\xc2\xb73\xe2\x80\x89=\xe2\x80\x89428571;  142857\xc2\xb74\xe2\x80\x89=\xe2\x80\x89571428;  142857\xc2\xb75\xe2\x80\x89=\xe2\x80\x89714285;  142857\xc2\xb76\xe2\x80\x89=\xe2\x80\x89857142. Now, Bike has a problem. He extends ""Rotatable Number"" under any base b. As is mentioned above, 142857 is a ""Rotatable Number"" under base 10. Another example is 0011 under base 2. All of the 4 equations are under base 2.  0011\xc2\xb71\xe2\x80\x89=\xe2\x80\x890011;  0011\xc2\xb710\xe2\x80\x89=\xe2\x80\x890110;  0011\xc2\xb711\xe2\x80\x89=\xe2\x80\x891001;  0011\xc2\xb7100\xe2\x80\x89=\xe2\x80\x891100. So, he wants to find the largest b (1\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89x) so that there is a positive ""Rotatable Number"" (leading-zeroes allowed) of length n under base b.Note that any time you multiply a rotatable number by numbers from 1 to its length you should get a rotating of that number." 2600
303C "Minimum Modular" "brute force,graphs,math,number theory" "You have been given n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You can remove at most k of them. Find the minimum modular m (m\xe2\x80\x89>\xe2\x80\x890), so that for every pair of the remaining integers (ai,\xe2\x80\x89aj), the following unequality holds: ." 2400
303B "Rectangle Puzzle II" implementation,math "You are given a rectangle grid. That grid\'s size is n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Let\'s denote the coordinate system on the grid. So, each point on the grid will have coordinates \xe2\x80\x94 a pair of integers (x,\xe2\x80\x89y) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m).Your task is to find a maximum sub-rectangle on the grid (x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2) so that it contains the given point (x,\xe2\x80\x89y), and its length-width ratio is exactly (a,\xe2\x80\x89b). In other words the following conditions must hold: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, .The sides of this sub-rectangle should be parallel to the axes. And values x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 should be integers.  If there are multiple solutions, find the rectangle which is closest to (x,\xe2\x80\x89y). Here ""closest"" means the Euclid distance between (x,\xe2\x80\x89y) and the center of the rectangle is as small as possible. If there are still multiple solutions, find the lexicographically minimum one. Here ""lexicographically minimum"" means that we should consider the sub-rectangle as sequence of integers (x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2), so we can choose the lexicographically minimum one." 1700
303A "Lucky Permutation Triple" "constructive algorithms,implementation,math" "Bike is interested in permutations. A permutation of length n is an integer sequence such that each integer from 0 to (n\xe2\x80\x89-\xe2\x80\x891) appears exactly once in it. For example, [0,\xe2\x80\x892,\xe2\x80\x891] is a permutation of length 3 while both [0,\xe2\x80\x892,\xe2\x80\x892] and [1,\xe2\x80\x892,\xe2\x80\x893] is not.A permutation triple of permutations of length n (a,\xe2\x80\x89b,\xe2\x80\x89c) is called a Lucky Permutation Triple if and only if . The sign ai denotes the i-th element of permutation a. The modular equality described above denotes that the remainders after dividing ai\xe2\x80\x89+\xe2\x80\x89bi by n and dividing ci by n are equal.Now, he has an integer n and wants to find a Lucky Permutation Triple. Could you please help him?" 1300
302B "Eugeny and Play List" "binary search,implementation,two pointers" "Eugeny loves listening to music. He has n songs in his play list. We know that song number i has the duration of ti minutes. Eugeny listens to each song, perhaps more than once. He listens to song number i ci times. Eugeny\'s play list is organized as follows: first song number 1 plays c1 times, then song number 2 plays c2 times, ..., in the end the song number n plays cn times.Eugeny took a piece of paper and wrote out m moments of time when he liked a song. Now for each such moment he wants to know the number of the song that played at that moment. The moment x means that Eugeny wants to know which song was playing during the x-th minute of his listening to the play list.Help Eugeny and calculate the required numbers of songs." 1200
302A "Eugeny and Array" implementation "Eugeny has array a\xe2\x80\x89=\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, consisting of n integers. Each integer ai equals to -1, or to 1. Also, he has m queries:  Query number i is given as a pair of integers li, ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  The response to the query will be integer 1, if the elements of array a can be rearranged so as the sum ali\xe2\x80\x89+\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ari\xe2\x80\x89=\xe2\x80\x890, otherwise the response to the query will be integer 0. Help Eugeny, answer all his queries." 800
301E "Yaroslav and Arrangements" dp "Yaroslav calls an array of r integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ar good, if it meets the following conditions: |a1\xe2\x80\x89-\xe2\x80\x89a2|\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89|a2\xe2\x80\x89-\xe2\x80\x89a3|\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89|ar\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89ar|\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89|ar\xe2\x80\x89-\xe2\x80\x89a1|\xe2\x80\x89=\xe2\x80\x891, at that . An array of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89br is called great, if it meets the following conditions:  The elements in it do not decrease (bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891).  If the inequalities 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m hold.  If we can rearrange its elements and get at least one and at most k distinct good arrays. Yaroslav has three integers n,\xe2\x80\x89m,\xe2\x80\x89k. He needs to count the number of distinct great arrays. Help Yaroslav! As the answer may be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Two arrays are considered distinct if there is a position in which they have distinct numbers." 2800
301D "Yaroslav and Divisors" "data structures" "Yaroslav has an array p\xe2\x80\x89=\xe2\x80\x89p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), consisting of n distinct integers. Also, he has m queries:  Query number i is represented as a pair of integers li, ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  The answer to the query li,\xe2\x80\x89ri is the number of pairs of integers q, w (li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q,\xe2\x80\x89w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri) such that pq is the divisor of pw. Help Yaroslav, answer all his queries." 2200
301C "Yaroslav and Algorithm" "constructive algorithms" "Yaroslav likes algorithms. We\'ll describe one of his favorite algorithms.  The algorithm receives a string as the input. We denote this input string as a.  The algorithm consists of some number of command. \xd0\xa1ommand number i looks either as si >> wi, or as si <> wi, where si and wi are some possibly empty strings of length at most 7, consisting of digits and characters ""?"".  At each iteration, the algorithm looks for a command with the minimum index i, such that si occurs in a as a substring. If this command is not found the algorithm terminates.  Let\'s denote the number of the found command as k. In string a the first occurrence of the string sk is replaced by string wk. If the found command at that had form sk >> wk, then the algorithm continues its execution and proceeds to the next iteration. Otherwise, the algorithm terminates.  The value of string a after algorithm termination is considered to be the output of the algorithm. Yaroslav has a set of n positive integers, he needs to come up with his favorite algorithm that will increase each of the given numbers by one. More formally, if we consider each number as a string representing the decimal representation of the number, then being run on each of these strings separately, the algorithm should receive the output string that is a recording of the corresponding number increased by one.Help Yaroslav." 2500
301B "Yaroslav and Time" "binary search,graphs,shortest paths" "Yaroslav is playing a game called ""Time"". The game has a timer showing the lifespan he\'s got left. As soon as the timer shows 0, Yaroslav\'s character dies and the game ends. Also, the game has n clock stations, station number i is at point (xi,\xe2\x80\x89yi) of the plane. As the player visits station number i, he increases the current time on his timer by ai. The stations are for one-time use only, so if the player visits some station another time, the time on his timer won\'t grow.A player spends d\xc2\xb7dist time units to move between stations, where dist is the distance the player has covered and d is some constant. The distance between stations i and j is determined as |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89|yi\xe2\x80\x89-\xe2\x80\x89yj|.Initially, the player is at station number 1, and the player has strictly more than zero and strictly less than one units of time. At station number 1 one unit of money can increase the time on the timer by one time unit (you can buy only integer number of time units).Now Yaroslav is wondering, how much money he needs to get to station n. Help Yaroslav. Consider the time to buy and to increase the timer value negligibly small." 2100
301A "Yaroslav and Sequence" "constructive algorithms" "Yaroslav has an array, consisting of (2\xc2\xb7n\xe2\x80\x89-\xe2\x80\x891) integers. In a single operation Yaroslav can change the sign of exactly n elements in the array. In other words, in one operation Yaroslav can select exactly n array elements, and multiply each of them by -1.Yaroslav is now wondering: what maximum sum of array elements can be obtained if it is allowed to perform any number of described operations?Help Yaroslav." 1800
300E "Empire Strikes Back" "binary search,math,number theory" "In a far away galaxy there is war again. The treacherous Republic made k precision strikes of power ai on the Empire possessions. To cope with the republican threat, the Supreme Council decided to deal a decisive blow to the enemy forces. To successfully complete the conflict, the confrontation balance after the blow should be a positive integer. The balance of confrontation is a number that looks like , where p\xe2\x80\x89=\xe2\x80\x89n! (n is the power of the Imperial strike), . After many years of war the Empire\'s resources are low. So to reduce the costs, n should be a minimum positive integer that is approved by the commanders.Help the Empire, find the minimum positive integer n, where the described fraction is a positive integer." 2300
300D "Painting Square" dp,fft "Vasily the bear has got a large square white table of n rows and n columns. The table has got a black border around this table.  The example of the initial table at n = 5. Vasily the bear wants to paint his square table in exactly k moves. Each move is sequence of actions:  The bear chooses some square inside his table. At that the square must have a black border painted around it. Also, the square shouldn\'t contain a black cell. The number of cells in the square shouldn\'t be less than 2.  The bear chooses some row and some column inside the chosen square. Then he paints each cell of this row and this column inside the chosen square. After that the rectangles, formed by the square\'s border and the newly painted cells, must be squares of a non-zero area.      An example of correct painting at n = 7 \xd0\xb8 k = 2. The bear already knows numbers n and k. Help him \xe2\x80\x94 find the number of ways to paint the square in exactly k moves. Two ways to paint are called distinct if the resulting tables will differ in at least one cell. As the answer can be rather large, print the remainder after dividing it by 7340033." 2300
300C "Beautiful Numbers" "brute force,combinatorics" "Vitaly is a very weird man. He\'s got two favorite digits a and b. Vitaly calls a positive integer good, if the decimal representation of this integer only contains digits a and b. Vitaly calls a good number excellent, if the sum of its digits is a good number.For example, let\'s say that Vitaly\'s favourite digits are 1 and 3, then number 12 isn\'t good and numbers 13 or 311 are. Also, number 111 is excellent and number 11 isn\'t. Now Vitaly is wondering, how many excellent numbers of length exactly n are there. As this number can be rather large, he asks you to count the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).A number\'s length is the number of digits in its decimal representation without leading zeroes." 1800
300B Coach "brute force,dfs and similar,graphs" "A programming coach has n students to teach. We know that n is divisible by 3. Let\'s assume that all students are numbered from 1 to n, inclusive.Before the university programming championship the coach wants to split all students into groups of three. For some pairs of students we know that they want to be on the same team. Besides, if the i-th student wants to be on the same team with the j-th one, then the j-th student wants to be on the same team with the i-th one. The coach wants the teams to show good results, so he wants the following condition to hold: if the i-th student wants to be on the same team with the j-th, then the i-th and the j-th students must be on the same team. Also, it is obvious that each student must be on exactly one team.Help the coach and divide the teams the way he wants." 1500
300A Array "brute force,constructive algorithms,implementation" "Vitaly has an array of n distinct integers. Vitaly wants to divide this array into three non-empty sets so as the following conditions hold:   The product of all numbers in the first set is less than zero (\xe2\x80\x89<\xe2\x80\x890).  The product of all numbers in the second set is greater than zero (\xe2\x80\x89>\xe2\x80\x890).  The product of all numbers in the third set is equal to zero.  Each number from the initial array must occur in exactly one set. Help Vitaly. Divide the given array." 1100
299B "Ksusha the Squirrel" "brute force,implementation" "Ksusha the Squirrel is standing at the beginning of a straight road, divided into n sectors. The sectors are numbered 1 to n, from left to right. Initially, Ksusha stands in sector 1. Ksusha wants to walk to the end of the road, that is, get to sector n. Unfortunately, there are some rocks on the road. We know that Ksusha hates rocks, so she doesn\'t want to stand in sectors that have rocks.Ksusha the squirrel keeps fit. She can jump from sector i to any of the sectors i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89k. Help Ksusha! Given the road description, say if she can reach the end of the road (note, she cannot stand on a rock)?" 900
299A "Ksusha and Array" "brute force,number theory,sortings" "Ksusha is a beginner coder. Today she starts studying arrays. She has array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, consisting of n positive integers.Her university teacher gave her a task. Find such number in the array, that all array elements are divisible by it. Help her and find the number!" 1000
298B Sail "brute force,greedy,implementation" "The polar bears are going fishing. They plan to sail from (sx,\xe2\x80\x89sy) to (ex,\xe2\x80\x89ey). However, the boat can only sail by wind. At each second, the wind blows in one of these directions: east, south, west or north. Assume the boat is currently at (x,\xe2\x80\x89y).  If the wind blows to the east, the boat will move to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y).  If the wind blows to the south, the boat will move to (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891).  If the wind blows to the west, the boat will move to (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y).  If the wind blows to the north, the boat will move to (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891). Alternatively, they can hold the boat by the anchor. In this case, the boat stays at (x,\xe2\x80\x89y). Given the wind direction for t seconds, what is the earliest time they sail to (ex,\xe2\x80\x89ey)?" 1200
298A "Snow Footprints" greedy,implementation "There is a straight snowy road, divided into n blocks. The blocks are numbered from 1 to n from left to right. If one moves from the i-th block to the (i\xe2\x80\x89+\xe2\x80\x891)-th block, he will leave a right footprint on the i-th block. Similarly, if one moves from the i-th block to the (i\xe2\x80\x89-\xe2\x80\x891)-th block, he will leave a left footprint on the i-th block. If there already is a footprint on the i-th block, the new footprint will cover the old one.  At the beginning, there were no footprints. Then polar bear Alice starts from the s-th block, makes a sequence of moves and ends in the t-th block. It is known that Alice never moves outside of the road. You are given the description of Alice\'s footprints. Your task is to find a pair of possible values of s,\xe2\x80\x89t by looking at the footprints." 1300
297E "Mystic Carvings" "data structures" "The polar bears have discovered a gigantic circular piece of floating ice with some mystic carvings on it. There are n lines carved on the ice. Each line connects two points on the boundary of the ice (we call these points endpoints). The endpoints are numbered 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x892n counter-clockwise along the circumference. No two lines share an endpoint.Now a group of 6 polar bears (Alice, Bob, Carol, Dave, Eve, Frank) are going to build caves on the endpoints. Each polar bear would build a cave and live in it. No two polar bears can build a cave on the same endpoints. Alice and Bob is a pair of superstitious lovers. They believe the lines are carved by aliens (or humans, which are pretty much the same thing to polar bears), and have certain spiritual power. Therefore they want to build their caves on two endpoints which are connected by a line. The same for Carol and Dave, Eve and Frank.The distance between two caves X and Y is defined as one plus minimum number of other caves one need to pass through in order to travel from X to Y along the boundary of the ice (endpoints without caves are not counted).To ensure fairness, the distances between the three pairs of lovers have to be the same (that is, the distance between Alice and Bob, the distance between Carol and Dave, and the distance between Eve and Frank are the same).The figures below show two different configurations, where the dots on the circle are the endpoints. The configuration on the left is not valid. Although each pair of lovers (A and B, C and D, E and F) is connected a line, the distance requirement is not satisfied. The distance between A and B is 2 (one can go from A to B in the clockwise direction passing through F). The distance between E and F is also 2. However, the distance between C and D is 1 (one can go from C to D in the counter-clockwise direction without passing through any other caves). The configuration on the right is valid. All three pairs have the same distance 1.  Count the number of ways to build the caves under the requirements. Two configurations are considered the same if the same set of 6 endpoints are used." 3000
297D "Color the Carpet" "constructive algorithms" "Even polar bears feel cold when lying on the ice. Therefore, a polar bear Alice is going to make a carpet. The carpet can be viewed as a grid with height h and width w. Then the grid is divided into h\xe2\x80\x89\xc3\x97\xe2\x80\x89w squares. Alice is going to assign one of k different colors to each square. The colors are numbered from 1 to k. She may choose not to use all of the colors.However, there are some restrictions. For every two adjacent squares (squares that shares an edge) x and y, there is a color constraint in one of the forms:   color(x)\xe2\x80\x89=\xe2\x80\x89color(y), or  color(x)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89color(y). Example of the color constraints:  Ideally, Alice wants to satisfy all color constraints. But again, life in the Arctic is hard. It is not always possible to satisfy all color constraints. Fortunately, she will still be happy if at least  of the color constraints are satisfied. If she has 4 colors she can color the carpet in the following way:  And she is happy because  of the color constraints are satisfied, and . Your task is to help her color the carpet." 2500
297C "Splitting the Uniqueness" "constructive algorithms" "Polar bears like unique arrays \xe2\x80\x94 that is, arrays without repeated elements. You have got a unique array s with length n containing non-negative integers. Since you are good friends with Alice and Bob, you decide to split the array in two. Precisely, you need to construct two arrays a and b that are also of length n, with the following conditions for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n):  ai,\xe2\x80\x89bi are non-negative integers;  si\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89bi . Ideally, a and b should also be unique arrays. However, life in the Arctic is hard and this is not always possible. Fortunately, Alice and Bob are still happy if their arrays are almost unique. We define an array of length n to be almost unique, if and only if it can be turned into a unique array by removing no more than  entries.For example, the array [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892] is almost unique because after removing the first two entries, it becomes [1,\xe2\x80\x893,\xe2\x80\x892]. The array [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892] is not almost unique because we need to remove at least 3 entries to turn it into a unique array.So, your task is to split the given unique array s into two almost unique arrays a and b." 2400
297B "Fish Weight" "constructive algorithms,greedy" "It is known that there are k fish species in the polar ocean, numbered from 1 to k. They are sorted by non-decreasing order of their weight, which is a positive number. Let the weight of the i-th type of fish be wi, then 0\xe2\x80\x89<\xe2\x80\x89w1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89wk holds.Polar bears Alice and Bob each have caught some fish, and they are guessing who has the larger sum of weight of the fish he/she\'s caught. Given the type of the fish they\'ve caught, determine whether it is possible that the fish caught by Alice has a strictly larger total weight than Bob\'s. In other words, does there exist a sequence of weights wi (not necessary integers), such that the fish caught by Alice has a strictly larger total weight?" 1600
297A "Parity Game" "constructive algorithms" "You are fishing with polar bears Alice and Bob. While waiting for the fish to bite, the polar bears get bored. They come up with a game. First Alice and Bob each writes a 01-string (strings that only contain character ""0"" and ""1"") a and b. Then you try to turn a into b using two types of operations:  Write parity(a) to the end of a. For example, .  Remove the first character of a. For example, . You cannot perform this operation if a is empty. You can use as many operations as you want. The problem is, is it possible to turn a into b?The parity of a 01-string is 1 if there is an odd number of ""1""s in the string, and 0 otherwise." 1700
296B "Yaroslav and Two Strings" combinatorics,dp "Yaroslav thinks that two strings s and w, consisting of digits and having length n are non-comparable if there are two numbers, i and j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that si\xe2\x80\x89>\xe2\x80\x89wi and sj\xe2\x80\x89<\xe2\x80\x89wj. Here sign si represents the i-th digit of string s, similarly, wj represents the j-th digit of string w.A string\'s template is a string that consists of digits and question marks (""?"").Yaroslav has two string templates, each of them has length n. Yaroslav wants to count the number of ways to replace all question marks by some integers in both templates, so as to make the resulting strings incomparable. Note that the obtained strings can contain leading zeroes and that distinct question marks can be replaced by distinct or the same integers.Help Yaroslav, calculate the remainder after dividing the described number of ways by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000
296A "Yaroslav and Permutations" greedy,math "Yaroslav has an array that consists of n integers. In one second Yaroslav can swap two neighboring array elements. Now Yaroslav is wondering if he can obtain an array where any two neighboring elements would be distinct in a finite time.Help Yaroslav." 1100
295E "Yaroslav and Points" "data structures" "Yaroslav has n points that lie on the Ox axis. The coordinate of the first point is x1, the coordinate of the second point is x2, ..., the coordinate of the n-th point is \xe2\x80\x94 xn. Now Yaroslav wants to execute m queries, each of them is of one of the two following types:  Move the pj-th point from position xpj to position xpj\xe2\x80\x89+\xe2\x80\x89dj. At that, it is guaranteed that after executing such query all coordinates of the points will be distinct.  Count the sum of distances between all pairs of points that lie on the segment [lj,\xe2\x80\x89rj] (lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj). In other words, you should count the sum of: . Help Yaroslav." 2500
295D "Greg and Caves" combinatorics,dp "Greg has a pad. The pad\'s screen is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle, each cell can be either black or white. We\'ll consider the pad rows to be numbered with integers from 1 to n from top to bottom. Similarly, the pad\'s columns are numbered with integers from 1 to m from left to right.Greg thinks that the pad\'s screen displays a cave if the following conditions hold:  There is a segment [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that each of the rows l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r has exactly two black cells and all other rows have only white cells.  There is a row number t (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), such that for all pairs of rows with numbers i and j (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t) the set of columns between the black cells in row i (with the columns where is these black cells) is the subset of the set of columns between the black cells in row j (with the columns where is these black cells). Similarly, for all pairs of rows with numbers i and j (t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) the set of columns between the black cells in row j (with the columns where is these black cells) is the subset of the set of columns between the black cells in row i (with the columns where is these black cells). Greg wondered, how many ways there are to paint a cave on his pad. Two ways can be considered distinct if there is a cell that has distinct colors on the two pictures.Help Greg." 2400
295C "Greg and Friends" "combinatorics,dp,graphs,shortest paths" "One day Greg and his friends were walking in the forest. Overall there were n people walking, including Greg. Soon he found himself in front of a river. The guys immediately decided to get across the river. Luckily, there was a boat by the river bank, just where the guys were standing. We know that the boat can hold people with the total weight of at most k kilograms.Greg immediately took a piece of paper and listed there the weights of all people in his group (including himself). It turned out that each person weights either 50 or 100 kilograms. Now Greg wants to know what minimum number of times the boat needs to cross the river to transport the whole group to the other bank. The boat needs at least one person to navigate it from one bank to the other. As the boat crosses the river, it can have any non-zero number of passengers as long as their total weight doesn\'t exceed k.Also Greg is wondering, how many ways there are to transport everybody to the other side in the minimum number of boat rides. Two ways are considered distinct if during some ride they have distinct sets of people on the boat.Help Greg with this problem." 2100
295B "Greg and Graph" "dp,graphs,shortest paths" "Greg has a weighed directed graph, consisting of n vertices. In this graph any pair of distinct vertices has an edge between them in both directions. Greg loves playing with the graph and now he has invented a new game:  The game consists of n steps.  On the i-th step Greg removes vertex number xi from the graph. As Greg removes a vertex, he also removes all the edges that go in and out of this vertex.  Before executing each step, Greg wants to know the sum of lengths of the shortest paths between all pairs of the remaining vertices. The shortest path can go through any remaining vertex. In other words, if we assume that d(i,\xe2\x80\x89v,\xe2\x80\x89u) is the shortest path between vertices v and u in the graph that formed before deleting vertex xi, then Greg wants to know the value of the following sum: . Help Greg, print the value of the required sum before each step." 1700
295A "Greg and Array" "data structures,implementation" "Greg has an array a\xe2\x80\x89=\xe2\x80\x89a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and m operations. Each operation looks as: li, ri, di, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). To apply operation i to the array means to increase all array elements with numbers li,\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ri by value di.Greg wrote down k queries on a piece of paper. Each query has the following form: xi, yi, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). That means that one should apply operations with numbers xi,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89yi to the array.Now Greg is wondering, what the array a will be after all the queries are executed. Help Greg." 1400
294E "Shaass the Great" dp,trees "The great Shaass is the new king of the Drakht empire. The empire has n cities which are connected by n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads. Each road has an specific length and connects a pair of cities. There\'s a unique simple path connecting each pair of cities.His majesty the great Shaass has decided to tear down one of the roads and build another road with the same length between some pair of cities. He should build such road that it\'s still possible to travel from each city to any other city. He might build the same road again.You as his advisor should help him to find a way to make the described action. You should find the way that minimize the total sum of pairwise distances between cities after the action. So calculate the minimum sum." 2300
294D "Shaass and Painter Robot" "brute force,implementation,number theory" "Shaass thinks a kitchen with all white floor tiles is so boring. His kitchen floor is made of n\xc2\xb7m square tiles forming a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangle. Therefore he\'s decided to color some of the tiles in black so that the floor looks like a checkerboard, which is no two side-adjacent tiles should have the same color.Shaass wants to use a painter robot to color the tiles. In the beginning the robot is standing in a border tile (xs,\xe2\x80\x89ys) facing a diagonal direction (i.e. upper-left, upper-right, down-left or down-right). As the robot walks in the kitchen he paints every tile he passes even if it\'s painted before. Painting each tile consumes one unit of black paint. If at any moment the robot hits a wall of the kitchen he changes his direction according the reflection rules. Note that a tile gets painted when the robot enters the tile from another tile, in other words changing direction in the same tile doesn\'t lead to any painting. The first tile the robot is standing on, is also painted.The robot stops painting the first moment the floor is checkered. Given the dimensions of the kitchen and the position of the robot, find out the amount of paint the robot consumes before it stops painting the floor.Let\'s consider an examples depicted below.  If the robot starts at tile number 1 (the tile (1,\xe2\x80\x891)) of the left grid heading to down-right it\'ll pass tiles 1354236 and consumes 7 units of black paint on his way until he stops at tile number 6. But if it starts at tile number 1 in the right grid heading to down-right it will get stuck in a loop painting tiles 1, 2, and 3." 2500
294C "Shaass and Lights" "combinatorics,number theory" "There are n lights aligned in a row. These lights are numbered 1 to n from left to right. Initially some of the lights are switched on. Shaass wants to switch all the lights on. At each step he can switch a light on (this light should be switched off at that moment) if there\'s at least one adjacent light which is already switched on. He knows the initial state of lights and he\'s wondering how many different ways there exist to switch all the lights on. Please find the required number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900
294B "Shaass and Bookshelf" dp,greedy "Shaass has n books. He wants to make a bookshelf for all his books. He wants the bookshelf\'s dimensions to be as small as possible. The thickness of the i-th book is ti and its pages\' width is equal to wi. The thickness of each book is either 1 or 2. All books have the same page heights.  Shaass puts the books on the bookshelf in the following way. First he selects some of the books and put them vertically. Then he puts the rest of the books horizontally above the vertical books. The sum of the widths of the horizontal books must be no more than the total thickness of the vertical books. A sample arrangement of the books is depicted in the figure.  Help Shaass to find the minimum total thickness of the vertical books that we can achieve." 1700
294A "Shaass and Oskols" implementation,math "Shaass has decided to hunt some birds. There are n horizontal electricity wires aligned parallel to each other. Wires are numbered 1 to n from top to bottom. On each wire there are some oskols sitting next to each other. Oskol is the name of a delicious kind of birds in Shaass\'s territory. Supposed there are ai oskols sitting on the i-th wire.  Sometimes Shaass shots one of the birds and the bird dies (suppose that this bird sat at the i-th wire). Consequently all the birds on the i-th wire to the left of the dead bird get scared and jump up on the wire number i\xe2\x80\x89-\xe2\x80\x891, if there exists no upper wire they fly away. Also all the birds to the right of the dead bird jump down on wire number i\xe2\x80\x89+\xe2\x80\x891, if there exists no such wire they fly away. Shaass has shot m birds. You\'re given the initial number of birds on each wire, tell him how many birds are sitting on each wire after the shots." 800
293E "Close Vertices" "data structures,divide and conquer,trees" "You\'ve got a weighted tree, consisting of n vertices. Each edge has a non-negative weight. The length of the path between any two vertices of the tree is the number of edges in the path. The weight of the path is the total weight of all edges it contains. Two vertices are close if there exists a path of length at most l between them and a path of weight at most w between them. Count the number of pairs of vertices v,\xe2\x80\x89u (v\xe2\x80\x89<\xe2\x80\x89u), such that vertices v and u are close." 2700
293D "Ksusha and Square" "geometry,math,probabilities,two pointers" "Ksusha is a vigorous mathematician. She is keen on absolutely incredible mathematical riddles. Today Ksusha came across a convex polygon of non-zero area. She is now wondering: if she chooses a pair of distinct points uniformly among all integer points (points with integer coordinates) inside or on the border of the polygon and then draws a square with two opposite vertices lying in the chosen points, what will the expectation of this square\'s area be?A pair of distinct points is chosen uniformly among all pairs of distinct points, located inside or on the border of the polygon. Pairs of points p,\xe2\x80\x89q (p\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89q) and q,\xe2\x80\x89p are considered the same.Help Ksusha! Count the required expectation." 2700
293C "Cube Problem" "brute force,math,number theory" "Yaroslav, Andrey and Roman love playing cubes. Sometimes they get together and play cubes for hours and hours! Today they got together again and they are playing cubes. Yaroslav took unit cubes and composed them into an a\xe2\x80\x89\xc3\x97\xe2\x80\x89a\xe2\x80\x89\xc3\x97\xe2\x80\x89a cube, Andrey made a b\xe2\x80\x89\xc3\x97\xe2\x80\x89b\xe2\x80\x89\xc3\x97\xe2\x80\x89b cube and Roman made a c\xe2\x80\x89\xc3\x97\xe2\x80\x89c\xe2\x80\x89\xc3\x97\xe2\x80\x89c cube. After that the game was finished and the guys left. But later, Vitaly entered the room. He saw the cubes and wanted to make a cube as well. But what size should the cube be? Of course it should be a large cube with the side of length a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89c. Besides, Vitaly decided to decompose the cubes built by Yaroslav, Andrey and Roman and compose his own large cube out of them. However, it turned out that the unit cubes he got from destroying the three cubes just weren\'t enough to make a large cube. We know that Vitaly was short of exactly n cubes. Vitaly got upset, demolished everything and left. As he was leaving, he met Petya and told him that there had been three cubes in the room and that he needed another n unit cubes to make his own large cube.Petya entered the room and saw the messily scattered cubes. He wanted to make it neat and orderly again. But he only knows that there had been three cubes, made of small unit cubes and that Vitaly needed n more unit cubes to make a large one! Help Petya understand, how many ways of sizes a, b, c are there to restore Yaroslav\'s, Andrey\'s and Roman\'s cubes." 2400
293B "Distinct Paths" "brute force,combinatorics" "You have a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m-cell board. Some cells are already painted some of k colors. You need to paint each uncolored cell one of the k colors so that any path from the upper left square to the lower right one doesn\'t contain any two cells of the same color. The path can go only along side-adjacent cells and can only go down or right.Print the number of possible paintings modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700
293A "Weird Game" games,greedy "Yaroslav, Andrey and Roman can play cubes for hours and hours. But the game is for three, so when Roman doesn\'t show up, Yaroslav and Andrey play another game. Roman leaves a word for each of them. Each word consists of 2\xc2\xb7n binary characters ""0"" or ""1"". After that the players start moving in turns. Yaroslav moves first. During a move, a player must choose an integer from 1 to 2\xc2\xb7n, which hasn\'t been chosen by anybody up to that moment. Then the player takes a piece of paper and writes out the corresponding character from his string. Let\'s represent Yaroslav\'s word as s\xe2\x80\x89=\xe2\x80\x89s1s2... s2n. Similarly, let\'s represent Andrey\'s word as t\xe2\x80\x89=\xe2\x80\x89t1t2... t2n. Then, if Yaroslav choose number k during his move, then he is going to write out character sk on the piece of paper. Similarly, if Andrey choose number r during his move, then he is going to write out character tr on the piece of paper.The game finishes when no player can make a move. After the game is over, Yaroslav makes some integer from the characters written on his piece of paper (Yaroslav can arrange these characters as he wants). Andrey does the same. The resulting numbers can contain leading zeroes. The person with the largest number wins. If the numbers are equal, the game ends with a draw.You are given two strings s and t. Determine the outcome of the game provided that Yaroslav and Andrey play optimally well." 1500
292E "Copying Data" "data structures" "We often have to copy large volumes of information. Such operation can take up many computer resources. Therefore, in this problem you are advised to come up with a way to copy some part of a number array into another one, quickly.More formally, you\'ve got two arrays of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn of length n. Also, you\'ve got m queries of two types:  Copy the subsegment of array a of length k, starting from position x, into array b, starting from position y, that is, execute by\xe2\x80\x89+\xe2\x80\x89q\xe2\x80\x89=\xe2\x80\x89ax\xe2\x80\x89+\xe2\x80\x89q for all integer q (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q\xe2\x80\x89<\xe2\x80\x89k). The given operation is correct \xe2\x80\x94 both subsegments do not touch unexistent elements.  Determine the value in position x of array b, that is, find value bx. For each query of the second type print the result \xe2\x80\x94 the value of the corresponding element of array b." 1900
292D "Connected Components" "data structures,dfs and similar,dp,dsu" "We already know of the large corporation where Polycarpus works as a system administrator. The computer network there consists of n computers and m cables that connect some pairs of computers. In other words, the computer network can be represented as some non-directed graph with n nodes and m edges. Let\'s index the computers with integers from 1 to n, let\'s index the cables with integers from 1 to m.Polycarpus was given an important task \xe2\x80\x94 check the reliability of his company\'s network. For that Polycarpus decided to carry out a series of k experiments on the computer network, where the i-th experiment goes as follows:  Temporarily disconnect the cables with indexes from li to ri, inclusive (the other cables remain connected).  Count the number of connected components in the graph that is defining the computer network at that moment.  Re-connect the disconnected cables with indexes from li to ri (that is, restore the initial network). Help Polycarpus carry out all experiments and for each print the number of connected components in the graph that defines the computer network through the given experiment. Isolated vertex should be counted as single component." 1900
292C "Beautiful IP Addresses" "brute force" "The problem uses a simplified TCP/IP address model, please read the statement carefully.An IP address is a 32-bit integer, represented as a group of four decimal 8-bit integers (without leading zeroes), separated by commas. For example, record 0.255.1.123 shows a correct IP address and records 0.256.1.123 and 0.255.1.01 do not. In the given problem an arbitrary group of four 8-bit integers is a correct IP address.Our hero Polycarpus still works as a system administrator in some large corporation. He likes beautiful IP addresses. To check if some IP address is beautiful, he should do the following:  write out in a line four 8-bit numbers of the IP address, without the commas;  check if the resulting string is a palindrome. Let us remind you that a palindrome is a string that reads the same from right to left and from left to right.For example, IP addresses 12.102.20.121 and 0.3.14.130 are beautiful (as strings ""1210220121"" and ""0314130"" are palindromes), and IP addresses 1.20.20.1 and 100.4.4.1 are not.Polycarpus wants to find all beautiful IP addresses that have the given set of digits. Each digit from the set must occur in the IP address at least once. IP address must not contain any other digits. Help him to cope with this difficult task." 2000
292B "Network Topology" graphs,implementation "This problem uses a simplified network topology model, please read the problem statement carefully and use it as a formal document as you develop the solution.Polycarpus continues working as a system administrator in a large corporation. The computer network of this corporation consists of n computers, some of them are connected by a cable. The computers are indexed by integers from 1 to n. It\'s known that any two computers connected by cable directly or through other computersPolycarpus decided to find out the network\'s topology. A network topology is the way of describing the network configuration, the scheme that shows the location and the connections of network devices.Polycarpus knows three main network topologies: bus, ring and star. A bus is the topology that represents a shared cable with all computers connected with it. In the ring topology the cable connects each computer only with two other ones. A star is the topology where all computers of a network are connected to the single central node.Let\'s represent each of these network topologies as a connected non-directed graph. A bus is a connected graph that is the only path, that is, the graph where all nodes are connected with two other ones except for some two nodes that are the beginning and the end of the path. A ring is a connected graph, where all nodes are connected with two other ones. A star is a connected graph, where a single central node is singled out and connected with all other nodes. For clarifications, see the picture.  (1) \xe2\x80\x94 bus, (2) \xe2\x80\x94 ring, (3) \xe2\x80\x94 star You\'ve got a connected non-directed graph that characterizes the computer network in Polycarpus\' corporation. Help him find out, which topology type the given network is. If that is impossible to do, say that the network\'s topology is unknown." 1200
292A SMSC implementation "Some large corporation where Polycarpus works has its own short message service center (SMSC). The center\'s task is to send all sorts of crucial information. Polycarpus decided to check the efficiency of the SMSC. For that, he asked to give him the statistics of the performance of the SMSC for some period of time. In the end, Polycarpus got a list of n tasks that went to the SMSC of the corporation. Each task was described by the time it was received by the SMSC and the number of text messages to send. More formally, the i-th task was described by two integers ti and ci \xe2\x80\x94 the receiving time (the second) and the number of the text messages, correspondingly.Polycarpus knows that the SMSC cannot send more than one text message per second. The SMSC uses a queue to organize its work. Consider a time moment x, the SMSC work at that moment as follows:  If at the time moment x the queue is not empty, then SMSC sends one message from the queue (SMSC gets the message from the head of the queue). Otherwise it doesn\'t send messages at the time moment x.  If at the time moment x SMSC receives a task, then it adds to the queue all the messages from this task (SMSC adds messages to the tail of the queue). Note, that the messages from the task cannot be send at time moment x. That\'s because the decision about sending message or not is made at point 1 before adding these messages to the queue. Given the information about all n tasks, Polycarpus wants to count two values: the time when the last text message was sent and the maximum size of the queue at some time. Help him count these two characteristics he needs to evaluate the efficiency of the SMSC." 1100
291E "Tree-String Problem" "*special problem,dfs and similar,hashing,strings" "A rooted tree is a non-directed connected graph without any cycles with a distinguished vertex, which is called the tree root. Consider the vertices of a rooted tree, that consists of n vertices, numbered from 1 to n. In this problem the tree root is the vertex number 1.Let\'s represent the length of the shortest by the number of edges path in the tree between vertices v and u as d(v,\xe2\x80\x89u).A parent of vertex v in the rooted tree with the root in vertex r (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r) is vertex pv, such that d(r,\xe2\x80\x89pv)\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89d(r,\xe2\x80\x89v) and d(pv,\xe2\x80\x89v)\xe2\x80\x89=\xe2\x80\x891. For example, on the picture the parent of vertex v\xe2\x80\x89=\xe2\x80\x895 is vertex p5\xe2\x80\x89=\xe2\x80\x892.One day Polycarpus came across a rooted tree, consisting of n vertices. The tree wasn\'t exactly ordinary: it had strings written on its edges. Polycarpus positioned the tree on the plane so as to make all edges lead from top to bottom if you go from the vertex parent to the vertex (see the picture). For any edge that lead from vertex pv to vertex v (1\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), he knows string sv that is written on it. All strings are written on the edges from top to bottom. For example, on the picture s7=""ba"". The characters in the strings are numbered starting from 0.  An example of Polycarpus\'s tree (corresponds to the example from the statement) Polycarpus defines the position in this tree as a specific letter on a specific string. The position is written as a pair of integers (v,\xe2\x80\x89x) that means that the position is the x-th letter of the string sv (1\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89|sv|), where |sv| is the length of string sv. For example, the highlighted letters are positions (2,\xe2\x80\x891) and (3,\xe2\x80\x891).Let\'s consider the pair of positions (v,\xe2\x80\x89x) and (u,\xe2\x80\x89y) in Polycarpus\' tree, such that the way from the first position to the second goes down on each step. We will consider that the pair of such positions defines string z. String z consists of all letters on the way from (v,\xe2\x80\x89x) to (u,\xe2\x80\x89y), written in the order of this path. For example, in the picture the highlighted positions define string ""bacaba"".Polycarpus has a string t, he wants to know the number of pairs of positions that define string t. Note that the way from the first position to the second in the pair must go down everywhere. Help him with this challenging tree-string problem!" 2000
291D "Parallel Programming" "*special problem,greedy" "Polycarpus has a computer with n processors. Also, his computer has n memory cells. We\'ll consider the processors numbered by integers from 1 to n and that the memory cells are consecutively numbered by integers from 1 to n.Polycarpus needs to come up with a parallel program model. For each memory cell number i this program must record the value n\xe2\x80\x89-\xe2\x80\x89i to this cell. In other words, for each cell you\'ve got to find the distance to cell n.Let\'s denote the value that is written in the i-th cell as ai. Initially, ai\xe2\x80\x89=\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) and an\xe2\x80\x89=\xe2\x80\x890. We will consider that only processor i can write values in the memory cell number i. All processors can read an information from some cell (several processors can read an information from some cell simultaneously).The parallel program is executed in several steps. During each step we execute the parallel version of the increment operation. Executing the parallel version of the increment operation goes as follows:  Each processor independently of the other ones chooses some memory cell. Let\'s say that processor i has chosen a cell with number ci (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).  All processors simultaneously execute operation ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89aci. Help Polycarpus come up with the parallel program model that is executed in exactly k steps. Calculate the operations that need to be executed. Note that after k steps for all i\'s value ai must be equal n\xe2\x80\x89-\xe2\x80\x89i." 1600
291C "Network Mask" "*special problem,bitmasks,brute force,implementation" "The problem uses a simplified TCP/IP address model, please make sure you\'ve read the statement attentively.Polycarpus has found a job, he is a system administrator. One day he came across n IP addresses. Each IP address is a 32 bit number, represented as a group of four 8-bit numbers (without leading zeroes), separated by dots. For example, the record 0.255.1.123 shows a correct IP address and records 0.256.1.123 and 0.255.1.01 do not. In this problem an arbitrary group of four 8-bit numbers is a correct IP address.Having worked as an administrator for some time, Polycarpus learned that if you know the IP address, you can use the subnet mask to get the address of the network that has this IP addess.The subnet mask is an IP address that has the following property: if we write this IP address as a 32 bit string, that it is representable as ""11...11000..000"". In other words, the subnet mask first has one or more one bits, and then one or more zero bits (overall there are 32 bits). For example, the IP address 2.0.0.0 is not a correct subnet mask as its 32-bit record looks as 00000010000000000000000000000000.To get the network address of the IP address, you need to perform the operation of the bitwise ""and"" of the IP address and the subnet mask. For example, if the subnet mask is 255.192.0.0, and the IP address is 192.168.1.2, then the network address equals 192.128.0.0. In the bitwise ""and"" the result has a bit that equals 1 if and only if both operands have corresponding bits equal to one.Now Polycarpus wants to find all networks to which his IP addresses belong. Unfortunately, Polycarpus lost subnet mask. Fortunately, Polycarpus remembers that his IP addresses belonged to exactly k distinct networks. Help Polycarpus find the subnet mask, such that his IP addresses will belong to exactly k distinct networks. If there are several such subnet masks, find the one whose bit record contains the least number of ones. If such subnet mask do not exist, say so." 1600
291B "Command Line Arguments" "*special problem,implementation,strings" "The problem describes the properties of a command line. The description somehow resembles the one you usually see in real operating systems. However, there are differences in the behavior. Please make sure you\'ve read the statement attentively and use it as a formal document.In the Pindows operating system a strings are the lexemes of the command line \xe2\x80\x94 the first of them is understood as the name of the program to run and the following lexemes are its arguments. For example, as we execute the command "" run.exe one, two . "", we give four lexemes to the Pindows command line: ""run.exe"", ""one,"", ""two"", ""."". More formally, if we run a command that can be represented as string s (that has no quotes), then the command line lexemes are maximal by inclusion substrings of string s that contain no spaces.To send a string with spaces or an empty string as a command line lexeme, we can use double quotes. The block of characters that should be considered as one lexeme goes inside the quotes. Embedded quotes are prohibited \xe2\x80\x94 that is, for each occurrence of character """""" we should be able to say clearly that the quotes are opening or closing. For example, as we run the command """"run.exe o"" """" "" ne, "" two . "" "" "", we give six lexemes to the Pindows command line: ""run.exe o"", """" (an empty string), "" ne, "", ""two"", ""."", "" "" (a single space).It is guaranteed that each lexeme of the command line is either surrounded by spaces on both sides or touches the corresponding command border. One of its consequences is: the opening brackets are either the first character of the string or there is a space to the left of them.You have a string that consists of uppercase and lowercase English letters, digits, characters "".,?!"""" and spaces. It is guaranteed that this string is a correct OS Pindows command line string. Print all lexemes of this command line string. Consider the character """""" to be used only in order to denote a single block of characters into one command line lexeme. In particular, the consequence is that the given string has got an even number of such characters." 1300
291A "Spyke Talks" "*special problem,implementation,sortings" "Polycarpus is the director of a large corporation. There are n secretaries working for the corporation, each of them corresponds via the famous Spyke VoIP system during the day. We know that when two people call each other via Spyke, the Spyke network assigns a unique ID to this call, a positive integer session number.One day Polycarpus wondered which secretaries are talking via the Spyke and which are not. For each secretary, he wrote out either the session number of his call or a 0 if this secretary wasn\'t talking via Spyke at that moment.Help Polycarpus analyze these data and find out the number of pairs of secretaries that are talking. If Polycarpus has made a mistake in the data and the described situation could not have taken place, say so.Note that the secretaries can correspond via Spyke not only with each other, but also with the people from other places. Also, Spyke conferences aren\'t permitted \xe2\x80\x94 that is, one call connects exactly two people." 800
290F "Greedy Petya" "*special problem,dfs and similar,graphs,greedy" "Petya is an unexperienced programming contestant. Recently he has come across the following problem:You are given a non-directed graph which consists of n nodes and m edges. Your task is to determine whether the graph contains a Hamiltonian path.Petya wrote a quick bug-free code which he believes solves this problem. After that Petya decided to give this problem for April Fools Day contest. Unfortunately, Petya might have made a mistake, and it\'s quite possible that his algorithm is wrong. But this isn\'t a good excuse to leave the contest without submitting this problem, is it?" 2800
290E HQ "*special problem,constructive algorithms" "The famous joke programming language HQ9+ has only 4 commands. In this problem we will explore its subset \xe2\x80\x94 a language called HQ..." 2500
290D Orange "*special problem,implementation"  1400
290C WTF? "*special problem,graph matchings,implementation,trees" "HAII HAS A TUXGIMMEH TUXI HAS A FOO ITS 0I HAS A BAR ITS 0I HAS A BAZ ITS 0I HAS A QUZ ITS 1TUX IS NOW A NUMBRIM IN YR LOOP NERFIN YR TUX TIL BOTH SAEM TUX AN 0I HAS A PURGIMMEH PURPUR IS NOW A NUMBRFOO R SUM OF FOO AN PURBAR R SUM OF BAR AN 1BOTH SAEM BIGGR OF PRODUKT OF FOO AN QUZ AN PRODUKT OF BAR BAZ AN PRODUKT OF FOO AN QUZO RLY?YA RLYBAZ R FOOQUZ R BAROICIM OUTTA YR LOOPBAZ IS NOW A NUMBARVISIBLE SMOOSH QUOSHUNT OF BAZ QUZKTHXBYE" 1700
290B "QR code" "*special problem,implementation"  1500
290A "Mysterious strings" "*special problem,implementation" "InputThe input contains a single integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8940).OutputOutput a single string.ExamplesInputCopy2OutputCopyAdamsInputCopy8OutputCopyVan BurenInputCopy29OutputCopyHarding" 1400
289B "Polo the Penguin and Matrix" "brute force,dp,implementation,sortings,ternary search" "Little penguin Polo has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix, consisting of integers. Let\'s index the matrix rows from 1 to n from top to bottom and let\'s index the columns from 1 to m from left to right. Let\'s represent the matrix element on the intersection of row i and column j as aij.In one move the penguin can add or subtract number d from some matrix element. Find the minimum number of moves needed to make all matrix elements equal. If the described plan is impossible to carry out, say so." 1400
289A "Polo the Penguin and Segments" "brute force,implementation" "Little penguin Polo adores integer segments, that is, pairs of integers [l; r] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). He has a set that consists of n integer segments: [l1; r1],\xe2\x80\x89[l2; r2],\xe2\x80\x89...,\xe2\x80\x89[ln; rn]. We know that no two segments of this set intersect. In one move Polo can either widen any segment of the set 1 unit to the left or 1 unit to the right, that is transform [l; r] to either segment [l\xe2\x80\x89-\xe2\x80\x891; r], or to segment [l; r\xe2\x80\x89+\xe2\x80\x891].The value of a set of segments that consists of n segments [l1; r1],\xe2\x80\x89[l2; r2],\xe2\x80\x89...,\xe2\x80\x89[ln; rn] is the number of integers x, such that there is integer j, for which the following inequality holds, lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj.Find the minimum number of moves needed to make the value of the set of Polo\'s segments divisible by k." 1100
288E "Polo the Penguin and Lucky Numbers" dp,implementation,math "Everybody knows that lucky numbers are positive integers that contain only lucky digits 4 and 7 in their decimal representation. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Polo the Penguin have two positive integers l and r (l\xe2\x80\x89<\xe2\x80\x89r), both of them are lucky numbers. Moreover, their lengths (that is, the number of digits in the decimal representation without the leading zeroes) are equal to each other.Let\'s assume that n is the number of distinct lucky numbers, each of them cannot be greater than r or less than l, and ai is the i-th (in increasing order) number of them. Find a1\xc2\xb7a2\xe2\x80\x89+\xe2\x80\x89a2\xc2\xb7a3\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891\xc2\xb7an. As the answer can be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2800
288D "Polo the Penguin and Trees" "combinatorics,dfs and similar,trees" "Little penguin Polo has got a tree \xe2\x80\x94 a non-directed connected acyclic graph, containing n nodes and n\xe2\x80\x89-\xe2\x80\x891 edges. We will consider the tree nodes numbered by integers from 1 to n.Today Polo wonders, how to find the number of pairs of paths that don\'t have common nodes. More formally, he should find the number of groups of four integers a,\xe2\x80\x89b,\xe2\x80\x89c and d such that:  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89<\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;  there\'s no such node that lies on both the shortest path from node a to node b and from node c to node d. The shortest path betweem two nodes is the path that is shortest in the number of edges.Help Polo solve this problem." 2400
288C "Polo the Penguin and XOR operation" implementation,math "Little penguin Polo likes permutations. But most of all he likes permutations of integers from 0 to n, inclusive.For permutation p\xe2\x80\x89=\xe2\x80\x89p0,\xe2\x80\x89p1,\xe2\x80\x89...,\xe2\x80\x89pn, Polo has defined its beauty \xe2\x80\x94 number .Expression  means applying the operation of bitwise excluding ""OR"" to numbers x and y. This operation exists in all modern programming languages, for example, in language C++ and Java it is represented as ""^"" and in Pascal \xe2\x80\x94 as ""xor"".Help him find among all permutations of integers from 0 to n the permutation with the maximum beauty." 1700
288B "Polo the Penguin and Houses" combinatorics "Little penguin Polo loves his home village. The village has n houses, indexed by integers from 1 to n. Each house has a plaque containing an integer, the i-th house has a plaque containing integer pi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).Little penguin Polo loves walking around this village. The walk looks like that. First he stands by a house number x. Then he goes to the house whose number is written on the plaque of house x (that is, to house px), then he goes to the house whose number is written on the plaque of house px (that is, to house ppx), and so on.We know that:  When the penguin starts walking from any house indexed from 1 to k, inclusive, he can walk to house number 1.  When the penguin starts walking from any house indexed from k\xe2\x80\x89+\xe2\x80\x891 to n, inclusive, he definitely cannot walk to house number 1.  When the penguin starts walking from house number 1, he can get back to house number 1 after some non-zero number of walks from a house to a house. You need to find the number of ways you may write the numbers on the houses\' plaques so as to fulfill the three above described conditions. Print the remainder after dividing this number by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1500
288A "Polo the Penguin and Strings" greedy "Little penguin Polo adores strings. But most of all he adores strings of length n.One day he wanted to find a string that meets the following conditions:  The string consists of n lowercase English letters (that is, the string\'s length equals n), exactly k of these letters are distinct.  No two neighbouring letters of a string coincide; that is, if we represent a string as s\xe2\x80\x89=\xe2\x80\x89s1s2... sn, then the following inequality holds, si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891(1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n).  Among all strings that meet points 1 and 2, the required string is lexicographically smallest. Help him find such string or state that such string doesn\'t exist.String x\xe2\x80\x89=\xe2\x80\x89x1x2... xp is lexicographically less than string y\xe2\x80\x89=\xe2\x80\x89y1y2... yq, if either p\xe2\x80\x89<\xe2\x80\x89q and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xp\xe2\x80\x89=\xe2\x80\x89yp, or there is such number r (r\xe2\x80\x89<\xe2\x80\x89p,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89q), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. The characters of the strings are compared by their ASCII codes." 1300
287B Pipeline "binary search,math" "Vova, the Ultimate Thule new shaman, wants to build a pipeline. As there are exactly n houses in Ultimate Thule, Vova wants the city to have exactly n pipes, each such pipe should be connected to the water supply. A pipe can be connected to the water supply if there\'s water flowing out of it. Initially Vova has only one pipe with flowing water. Besides, Vova has several splitters.A splitter is a construction that consists of one input (it can be connected to a water pipe) and x output pipes. When a splitter is connected to a water pipe, water flows from each output pipe. You can assume that the output pipes are ordinary pipes. For example, you can connect water supply to such pipe if there\'s water flowing out from it. At most one splitter can be connected to any water pipe.  The figure shows a 4-output splitter Vova has one splitter of each kind: with 2, 3, 4, ..., k outputs. Help Vova use the minimum number of splitters to build the required pipeline or otherwise state that it\'s impossible.Vova needs the pipeline to have exactly n pipes with flowing out water. Note that some of those pipes can be the output pipes of the splitters." 1700
287A "IQ Test" "brute force,implementation" "In the city of Ultima Thule job applicants are often offered an IQ test. The test is as follows: the person gets a piece of squared paper with a 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 square painted on it. Some of the square\'s cells are painted black and others are painted white. Your task is to repaint at most one cell the other color so that the picture has a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, completely consisting of cells of the same color. If the initial picture already has such a square, the person should just say so and the test will be completed. Your task is to write a program that determines whether it is possible to pass the test. You cannot pass the test if either repainting any cell or no action doesn\'t result in a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, consisting of cells of the same color." 1100
286E "Ladies\' Shop" "constructive algorithms,fft,math" "A ladies\' shop has recently opened in the city of Ultima Thule. To get ready for the opening, the shop bought n bags. Each bag is characterised by the total weight ai of the items you can put there. The weird thing is, you cannot use these bags to put a set of items with the total weight strictly less than ai. However the weights of the items that will be sold in the shop haven\'t yet been defined. That\'s what you should determine right now.Your task is to find the set of the items\' weights p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pk), such that:  Any bag will be used. That is, for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) there will be such set of items that their total weight will equal ai. We assume that there is the infinite number of items of any weight. You can put multiple items of the same weight in one bag.  For any set of items that have total weight less than or equal to m, there is a bag into which you can put this set. Similarly, a set of items can contain multiple items of the same weight.  Of all sets of the items\' weights that satisfy points 1 and 2, find the set with the minimum number of weights. In other words, value k should be as small as possible. Find and print the required set." 2800
286D Tourists "data structures,sortings" "A double tourist path, located at a park in Ultima Thule, is working by the following principle:  We introduce the Cartesian coordinate system.  At some points of time there are two tourists going (for a walk) from points (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890) and (1,\xe2\x80\x890) simultaneously. The first one is walking from (\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890), the second one is walking from (1,\xe2\x80\x890).  Both tourists in a pair move at the same speed 1 (distance unit per second), the first one moves along line x\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891, the second one moves along line x\xe2\x80\x89=\xe2\x80\x891, both of them are moving in the positive direction of the Oy axis.  At some points of time walls appear. Wall (li,\xe2\x80\x89ri) is a segment between points (0,\xe2\x80\x89li) and (0,\xe2\x80\x89ri). Each wall appears immediately. The Ultima Thule government wants to learn this for each pair of tourists that walk simultaneously: for how long (in seconds) will they not see each other? Two tourists don\'t see each other if the segment that connects their positions on the plane intersects at least one wall. Two segments intersect if they share at least one point. We assume that the segments\' ends belong to the segments.Help the government count the required time. Note that the walls can intersect (in any way) or coincide." 2600
286C "Main Sequence" greedy,implementation "As you know, Vova has recently become a new shaman in the city of Ultima Thule. So, he has received the shaman knowledge about the correct bracket sequences. The shamans of Ultima Thule have been using lots of different types of brackets since prehistoric times. A bracket type is a positive integer. The shamans define a correct bracket sequence as follows:  An empty sequence is a correct bracket sequence.  If {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al} and {b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk} are correct bracket sequences, then sequence {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al,\xe2\x80\x89b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk} (their concatenation) also is a correct bracket sequence.  If {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al} \xe2\x80\x94 is a correct bracket sequence, then sequence  also is a correct bracket sequence, where v (v\xe2\x80\x89>\xe2\x80\x890) is an integer. For example, sequences {1,\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891} and {3,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x893} are correct bracket sequences, and {2,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x893} is not.Moreover, after Vova became a shaman, he learned the most important correct bracket sequence {x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn}, consisting of n integers. As sequence x is the most important, Vova decided to encrypt it just in case.Encrypting consists of two sequences. The first sequence {p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn} contains types of brackets, that is, pi\xe2\x80\x89=\xe2\x80\x89|xi| (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). The second sequence {q1,\xe2\x80\x89q2,\xe2\x80\x89...,\xe2\x80\x89qt} contains t integers \xe2\x80\x94 some positions (possibly, not all of them), which had negative numbers in sequence {x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn}.Unfortunately, Vova forgot the main sequence. But he was lucky enough to keep the encryption: sequences {p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn} and {q1,\xe2\x80\x89q2,\xe2\x80\x89...,\xe2\x80\x89qt}. Help Vova restore sequence x by the encryption. If there are multiple sequences that correspond to the encryption, restore any of them. If there are no such sequences, you should tell so." 2100
286B Shifting implementation "John Doe has found the beautiful permutation formula.Let\'s take permutation p\xe2\x80\x89=\xe2\x80\x89p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Let\'s define transformation f of this permutation: where k (k\xe2\x80\x89>\xe2\x80\x891) is an integer, the transformation parameter, r is such maximum integer that rk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. If rk\xe2\x80\x89=\xe2\x80\x89n, then elements prk\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89prk\xe2\x80\x89+\xe2\x80\x892 and so on are omitted. In other words, the described transformation of permutation p cyclically shifts to the left each consecutive block of length k and the last block with the length equal to the remainder after dividing n by k. John Doe thinks that permutation f(f( ... f(p\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n],\xe2\x80\x892) ... ,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89n) is beautiful. Unfortunately, he cannot quickly find the beautiful permutation he\'s interested in. That\'s why he asked you to help him.Your task is to find a beautiful permutation for the given n. For clarifications, see the notes to the third sample." 2200
286A "Lucky Permutation" "constructive algorithms,math" "A permutation p of size n is the sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, consisting of n distinct integers, each of them is from 1 to n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).A lucky permutation is such permutation p, that any integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) meets this condition ppi\xe2\x80\x89=\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891.You have integer n. Find some lucky permutation p of size n." 1400
285E "Positions in Permutations" combinatorics,dp,math "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.We\'ll call position i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) in permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn good, if |p[i]\xe2\x80\x89-\xe2\x80\x89i|\xe2\x80\x89=\xe2\x80\x891. Count the number of permutations of size n with exactly k good positions. Print the answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2600
285D "Permutation Sum" bitmasks,combinatorics,dp,implementation,meet-in-the-middle "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.Petya decided to introduce the sum operation on the set of permutations of length n. Let\'s assume that we are given two permutations of length n: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Petya calls the sum of permutations a and b such permutation c of length n, where ci\xe2\x80\x89=\xe2\x80\x89((ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x891) mod n)\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).Operation  means taking the remainder after dividing number x by number y.Obviously, not for all permutations a and b exists permutation c that is sum of a and b. That\'s why Petya got sad and asked you to do the following: given n, count the number of such pairs of permutations a and b of length n, that exists permutation c that is sum of a and b. The pair of permutations x,\xe2\x80\x89y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y) and the pair of permutations y,\xe2\x80\x89x are considered distinct pairs.As the answer can be rather large, print the remainder after dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900
285C "Building Permutation" greedy,implementation,sortings "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.You have a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. In one move, you are allowed to decrease or increase any number by one. Count the minimum number of moves, needed to build a permutation from this sequence." 1200
285B "Find Marble" implementation "Petya and Vasya are playing a game. Petya\'s got n non-transparent glasses, standing in a row. The glasses\' positions are indexed with integers from 1 to n from left to right. Note that the positions are indexed but the glasses are not.First Petya puts a marble under the glass in position s. Then he performs some (possibly zero) shuffling operations. One shuffling operation means moving the glass from the first position to position p1, the glass from the second position to position p2 and so on. That is, a glass goes from position i to position pi. Consider all glasses are moving simultaneously during one shuffling operation. When the glasses are shuffled, the marble doesn\'t travel from one glass to another: it moves together with the glass it was initially been put in.After all shuffling operations Petya shows Vasya that the ball has moved to position t. Vasya\'s task is to say what minimum number of shuffling operations Petya has performed or determine that Petya has made a mistake and the marble could not have got from position s to position t." 1200
285A "Slightly Decreasing Permutations" greedy,implementation "Permutation p is an ordered set of integers p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. We\'ll denote the i-th element of permutation p as pi. We\'ll call number n the size or the length of permutation p1,\xe2\x80\x89\xe2\x80\x89p2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89pn.The decreasing coefficient of permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn is the number of such i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), that pi\xe2\x80\x89>\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891.You have numbers n and k. Your task is to print the permutation of length n with decreasing coefficient k." 1100
284B "Cows and Poker Game" "brute force,implementation" "There are n cows playing poker at a table. For the current betting phase, each player\'s status is either ""ALLIN"", ""IN"", or ""FOLDED"", and does not change throughout the phase. To increase the suspense, a player whose current status is not ""FOLDED"" may show his/her hand to the table. However, so as not to affect any betting decisions, he/she may only do so if all other players have a status of either ""ALLIN"" or ""FOLDED"". The player\'s own status may be either ""ALLIN"" or ""IN"".Find the number of cows that can currently show their hands without affecting any betting decisions." 1000
284A "Cows and Primitive Roots" "implementation,math,number theory" "The cows have just learned what a primitive root is! Given a prime p, a primitive root  is an integer x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89p) such that none of integers x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89x2\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89xp\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x891 are divisible by p, but xp\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x891 is. Unfortunately, computing primitive roots can be time consuming, so the cows need your help. Given a prime p, help the cows find the number of primitive roots ." 1400
283E "Cow Tennis Tournament" "combinatorics,data structures,math" "Farmer John is hosting a tennis tournament with his n cows. Each cow has a skill level si, and no two cows having the same skill level. Every cow plays every other cow exactly once in the tournament, and each cow beats every cow with skill level lower than its own.However, Farmer John thinks the tournament will be demoralizing for the weakest cows who lose most or all of their matches, so he wants to flip some of the results. In particular, at k different instances, he will take two integers ai,\xe2\x80\x89bi (ai\xe2\x80\x89<\xe2\x80\x89bi) and flip all the results between cows with skill level between ai and bi inclusive. That is, for any pair x,\xe2\x80\x89y  he will change the result of the match on the final scoreboard (so if x won the match, the scoreboard will now display that y won the match, and vice versa). It is possible that Farmer John will change the result of a match multiple times. It is not guaranteed that ai and bi are equal to some cow\'s skill level.Farmer John wants to determine how balanced he made the tournament results look. In particular, he wants to count the number of triples of cows (p,\xe2\x80\x89q,\xe2\x80\x89r) for which the final leaderboard shows that cow p beats cow q, cow q beats cow r, and cow r beats cow p. Help him determine this number.Note that two triples are considered different if they do not contain the same set of cows (i.e. if there is a cow in one triple that is not in the other)." 2800
283D "Cows and Cool Sequences" "dp,math,number theory" "Bessie and the cows have recently been playing with ""cool"" sequences and are trying to construct some. Unfortunately they are bad at arithmetic, so they need your help!A pair (x,\xe2\x80\x89y) of positive integers is ""cool"" if x can be expressed as the sum of y consecutive integers (not necessarily positive). A sequence (a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an) is ""cool"" if the pairs (a1,\xe2\x80\x89a2),\xe2\x80\x89(a2,\xe2\x80\x89a3),\xe2\x80\x89...,\xe2\x80\x89(an\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89an) are all cool. The cows have a sequence of n positive integers, a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. In one move, they may replace some ai with any other positive integer (there are no other limits on the new value of ai). Determine the smallest number of moves needed to make the resulting sequence cool." 2400
283C "Coin Troubles" dp "In the Isle of Guernsey there are n different types of coins. For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), coin of type i is worth ai cents. It is possible that ai\xe2\x80\x89=\xe2\x80\x89aj for some i and j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j). Bessie has some set of these coins totaling t cents. She tells Jessie q pairs of integers. For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q), the pair bi,\xe2\x80\x89ci tells Jessie that Bessie has a strictly greater number of coins of type bi than coins of type ci. It is known that all bi are distinct and all ci are distinct. Help Jessie find the number of possible combinations of coins Bessie could have. Two combinations are considered different if there is some i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that the number of coins Bessie has of type i is different in the two combinations. Since the answer can be very large, output it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). If there are no possible combinations of coins totaling t cents that satisfy Bessie\'s conditions, output 0." 2100
283B "Cow Program" "dfs and similar,dp,graphs" "Farmer John has just given the cows a program to play with! The program contains two integer variables, x and y, and performs the following operations on a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of positive integers:  Initially, x\xe2\x80\x89=\xe2\x80\x891 and y\xe2\x80\x89=\xe2\x80\x890. If, after any step, x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x890 or x\xe2\x80\x89>\xe2\x80\x89n, the program immediately terminates.  The program increases both x and y by a value equal to ax simultaneously.  The program now increases y by ax while decreasing x by ax.  The program executes steps 2 and 3 (first step 2, then step 3) repeatedly until it terminates (it may never terminate). So, the sequence of executed steps may start with: step 2, step 3, step 2, step 3, step 2 and so on. The cows are not very good at arithmetic though, and they want to see how the program works. Please help them!You are given the sequence a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89an. Suppose for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) we run the program on the sequence i,\xe2\x80\x89a2,\xe2\x80\x89a3,\xe2\x80\x89...,\xe2\x80\x89an. For each such run output the final value of y if the program terminates or -1 if it does not terminate." 1700
283A "Cows and Sequence" "constructive algorithms,data structures,implementation" "Bessie and the cows are playing with sequences and need your help. They start with a sequence, initially containing just the number 0, and perform n operations. Each operation is one of the following:  Add the integer xi to the first ai elements of the sequence.  Append an integer ki to the end of the sequence. (And hence the size of the sequence increases by 1)  Remove the last element of the sequence. So, the size of the sequence decreases by one. Note, that this operation can only be done if there are at least two elements in the sequence. After each operation, the cows would like to know the average of all the numbers in the sequence. Help them!" 1600
282E "Sausage Maximization" "bitmasks,data structures,trees" "The Bitlandians are quite weird people. They have their own problems and their own solutions. They have their own thoughts and their own beliefs, they have their own values and their own merits. They have their own dishes and their own sausages!In Bitland a sausage is an array of integers! A sausage\'s deliciousness is equal to the bitwise excluding OR (the xor operation) of all integers in that sausage. One day, when Mr. Bitkoch (the local cook) was going to close his BitRestaurant, BitHaval and BitAryo, the most famous citizens of Bitland, entered the restaurant and each ordered a sausage.But Mr. Bitkoch had only one sausage left. So he decided to cut a prefix (several, may be zero, first array elements) of the sausage and give it to BitHaval and a postfix (several, may be zero, last array elements) of the sausage and give it to BitAryo. Note that one or both pieces of the sausage can be empty. Of course, the cut pieces mustn\'t intersect (no array element can occur in both pieces).The pleasure of BitHaval and BitAryo is equal to the bitwise XOR of their sausages\' deliciousness. An empty sausage\'s deliciousness equals zero.Find a way to cut a piece of sausage for BitHaval and BitAryo that maximizes the pleasure of these worthy citizens." 2200
282D "Yet Another Number Game" dp,games "Since most contestants do not read this part, I have to repeat that Bitlandians are quite weird. They have their own jobs, their own working method, their own lives, their own sausages and their own games!Since you are so curious about Bitland, I\'ll give you the chance of peeking at one of these games.BitLGM and BitAryo are playing yet another of their crazy-looking genius-needed Bitlandish games. They\'ve got a sequence of n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. The players make moves in turns. BitLGM moves first. Each player can and must do one of the two following actions in his turn:  Take one of the integers (we\'ll denote it as ai). Choose integer x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai). And then decrease ai by x, that is, apply assignment: ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89x.  Choose integer x . And then decrease all ai by x, that is, apply assignment: ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89x, for all i. The player who cannot make a move loses.You\'re given the initial sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Determine who wins, if both players plays optimally well and if BitLGM and BitAryo start playing the described game in this sequence." 2100
282C "XOR and OR" "constructive algorithms,implementation,math" "The Bitlandians are quite weird people. They do everything differently. They have a different alphabet so they have a different definition for a string.A Bitlandish string is a string made only of characters ""0"" and ""1"".BitHaval (the mayor of Bitland) loves to play with Bitlandish strings. He takes some Bitlandish string a, and applies several (possibly zero) operations to it. In one operation the mayor may take any two adjacent characters of a string, define one of them as x and the other one as y. Then he calculates two values p and q: p\xe2\x80\x89=\xe2\x80\x89x xor y, q\xe2\x80\x89=\xe2\x80\x89x or y. Then he replaces one of the two taken characters by p and the other one by q.The xor operation means the bitwise excluding OR operation. The or operation is the bitwise OR operation.So for example one operation can transform string 11 to string 10 or to string 01. String 1 cannot be transformed into any other string.You\'ve got two Bitlandish strings a and b. Your task is to check if it is possible for BitHaval to transform string a to string b in several (possibly zero) described operations." 1500
282B "Painting Eggs" greedy,math "The Bitlandians are quite weird people. They have very peculiar customs.As is customary, Uncle J. wants to have n eggs painted for Bitruz (an ancient Bitland festival). He has asked G. and A. to do the work.The kids are excited because just as is customary, they\'re going to be paid for the job! Overall uncle J. has got n eggs. G. named his price for painting each egg. Similarly, A. named his price for painting each egg. It turns out that for each egg the sum of the money both A. and G. want for the painting equals 1000.Uncle J. wants to distribute the eggs between the children so as to give each egg to exactly one child. Also, Uncle J. wants the total money paid to A. to be different from the total money paid to G. by no more than 500.Help Uncle J. Find the required distribution of eggs or otherwise say that distributing the eggs in the required manner is impossible." 1500
282A Bit++ implementation "The classic programming language of Bitland is Bit++. This language is so peculiar and complicated.The language is that peculiar as it has exactly one variable, called x. Also, there are two operations:  Operation ++ increases the value of variable x by 1.  Operation -- decreases the value of variable x by 1. A statement in language Bit++ is a sequence, consisting of exactly one operation and one variable x. The statement is written without spaces, that is, it can only contain characters ""+"", ""-"", ""X"". Executing a statement means applying the operation it contains.A programme in Bit++ is a sequence of statements, each of them needs to be executed. Executing a programme means executing all the statements it contains.You\'re given a programme in language Bit++. The initial value of x is 0. Execute the programme and find its final value (the value of the variable when this programme is executed)." 800
281B "Nearest Fraction" "brute force,implementation,two pointers" "You are given three positive integers x,\xe2\x80\x89y,\xe2\x80\x89n. Your task is to find the nearest fraction to fraction  whose denominator is no more than n. Formally, you should find such pair of integers a,\xe2\x80\x89b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a) that the value  is as minimal as possible.If there are multiple ""nearest"" fractions, choose the one with the minimum denominator. If there are multiple ""nearest"" fractions with the minimum denominator, choose the one with the minimum numerator." 1700
281A "Word Capitalization" implementation,strings "Capitalization is writing a word with its first letter as a capital letter. Your task is to capitalize the given word.Note, that during capitalization all the letters except the first one remains unchanged." 800
280E "Sequence Transformation" "brute force,data structures,dp,implementation,math" "You\'ve got a non-decreasing sequence x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xn\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q). You\'ve also got two integers a and b (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b; a\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89<\xe2\x80\x89q).Your task is to transform sequence x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn into some sequence y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q; a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89yi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b). The transformation price is the following sum: . Your task is to choose such sequence y that minimizes the described transformation price." 3000
280D "k-Maximum Subsequence Sum" "data structures,flows,graphs,implementation" "Consider integer sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You should run queries of two types:  The query format is ""0 i val"". In reply to this query you should make the following assignment: ai\xe2\x80\x89=\xe2\x80\x89val.  The query format is ""1 l r k"". In reply to this query you should print the maximum sum of at most k non-intersecting subsegments of sequence al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar. Formally, you should choose at most k pairs of integers (x1,\xe2\x80\x89y1),\xe2\x80\x89(x2,\xe2\x80\x89y2),\xe2\x80\x89...,\xe2\x80\x89(xt,\xe2\x80\x89yt) (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89xt\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89yt\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r; t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) such that the sum ax1\xe2\x80\x89+\xe2\x80\x89ax1\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ay1\xe2\x80\x89+\xe2\x80\x89ax2\xe2\x80\x89+\xe2\x80\x89ax2\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ay2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89axt\xe2\x80\x89+\xe2\x80\x89axt\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ayt is as large as possible. Note that you should choose at most k subsegments. Particularly, you can choose 0 subsegments. In this case the described sum considered equal to zero." 2800
280C "Game on Tree" implementation,math,probabilities,trees "Momiji has got a rooted tree, consisting of n nodes. The tree nodes are numbered by integers from 1 to n. The root has number 1. Momiji decided to play a game on this tree.The game consists of several steps. On each step, Momiji chooses one of the remaining tree nodes (let\'s denote it by v) and removes all the subtree nodes with the root in node v from the tree. Node v gets deleted as well. The game finishes when the tree has no nodes left. In other words, the game finishes after the step that chooses the node number 1.Each time Momiji chooses a new node uniformly among all the remaining nodes. Your task is to find the expectation of the number of steps in the described game." 2200
280B "Maximum Xor Secondary" "data structures,implementation,two pointers" "Bike loves looking for the second maximum element in the sequence. The second maximum element in the sequence of distinct numbers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk (k\xe2\x80\x89>\xe2\x80\x891) is such maximum element xj, that the following inequality holds: .The lucky number of the sequence of distinct positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk (k\xe2\x80\x89>\xe2\x80\x891) is the number that is equal to the bitwise excluding OR of the maximum element of the sequence and the second maximum element of the sequence.You\'ve got a sequence of distinct positive integers s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn (n\xe2\x80\x89>\xe2\x80\x891). Let\'s denote sequence sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr as s[l..r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Your task is to find the maximum number among all lucky numbers of sequences s[l..r].Note that as all numbers in sequence s are distinct, all the given definitions make sence." 1800
280A "Rectangle Puzzle" geometry "You are given two rectangles on a plane. The centers of both rectangles are located in the origin of coordinates (meaning the center of the rectangle\'s symmetry). The first rectangle\'s sides are parallel to the coordinate axes: the length of the side that is parallel to the Ox axis, equals w, the length of the side that is parallel to the Oy axis, equals h. The second rectangle can be obtained by rotating the first rectangle relative to the origin of coordinates by angle \xce\xb1.  Your task is to find the area of the region which belongs to both given rectangles. This region is shaded in the picture." 2000
279E "Beautiful Decomposition" "dp,games,greedy,number theory" "Valera considers a number beautiful, if it equals 2k or -2k for some integer k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890). Recently, the math teacher asked Valera to represent number n as the sum of beautiful numbers. As Valera is really greedy, he wants to complete the task using as few beautiful numbers as possible. Help Valera and find, how many numbers he is going to need. In other words, if you look at all decompositions of the number n into beautiful summands, you need to find the size of the decomposition which has the fewest summands." 1900
279D "The Minimum Number of Variables" bitmasks,dp "You\'ve got a positive integer sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. All numbers in the sequence are distinct. Let\'s fix the set of variables b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm. Initially each variable bi (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) contains the value of zero. Consider the following sequence, consisting of n operations.The first operation is assigning the value of a1 to some variable bx (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Each of the following n\xe2\x80\x89-\xe2\x80\x891 operations is assigning to some variable by the value that is equal to the sum of values that are stored in the variables bi and bj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). At that, the value that is assigned on the t-th operation, must equal at. For each operation numbers y,\xe2\x80\x89i,\xe2\x80\x89j are chosen anew.Your task is to find the minimum number of variables m, such that those variables can help you perform the described sequence of operations." 2200
279C Ladder "dp,implementation,two pointers" "You\'ve got an array, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Also, you\'ve got m queries, the i-th query is described by two integers li,\xe2\x80\x89ri. Numbers li,\xe2\x80\x89ri define a subsegment of the original array, that is, the sequence of numbers ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ari. For each query you should check whether the corresponding segment is a ladder. A ladder is a sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk, such that it first doesn\'t decrease, then doesn\'t increase. In other words, there is such integer x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that the following inequation fulfills: b1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bx\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bx\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bx\xe2\x80\x89+\xe2\x80\x892...\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89bk. Note that the non-decreasing and the non-increasing sequences are also considered ladders." 1700
279B Books "binary search,brute force,implementation,two pointers" "When Valera has got some free time, he goes to the library to read some books. Today he\'s got t free minutes to read. That\'s why Valera took n books in the library and for each book he estimated the time he is going to need to read it. Let\'s number the books by integers from 1 to n. Valera needs ai minutes to read the i-th book.Valera decided to choose an arbitrary book with number i and read the books one by one, starting from this book. In other words, he will first read book number i, then book number i\xe2\x80\x89+\xe2\x80\x891, then book number i\xe2\x80\x89+\xe2\x80\x892 and so on. He continues the process until he either runs out of the free time or finishes reading the n-th book. Valera reads each book up to the end, that is, he doesn\'t start reading the book if he doesn\'t have enough free time to finish reading it. Print the maximum number of books Valera can read." 1400
279A "Point on Spiral" "brute force,geometry,implementation" "Valera the horse lives on a plane. The Cartesian coordinate system is defined on this plane. Also an infinite spiral is painted on the plane. The spiral consists of segments: [(0,\xe2\x80\x890),\xe2\x80\x89(1,\xe2\x80\x890)], [(1,\xe2\x80\x890),\xe2\x80\x89(1,\xe2\x80\x891)], [(1,\xe2\x80\x891),\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891)], [(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x891),\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891)], [(\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89(2,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891)], [(2,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89(2,\xe2\x80\x892)] and so on. Thus, this infinite spiral passes through each integer point of the plane.Valera the horse lives on the plane at coordinates (0,\xe2\x80\x890). He wants to walk along the spiral to point (x,\xe2\x80\x89y). Valera the horse has four legs, so he finds turning very difficult. Count how many times he will have to turn if he goes along a spiral from point (0,\xe2\x80\x890) to point (x,\xe2\x80\x89y)." 1400
278B "New Problem" "brute force,strings" "Coming up with a new problem isn\'t as easy as many people think. Sometimes it is hard enough to name it. We\'ll consider a title original if it doesn\'t occur as a substring in any titles of recent Codeforces problems. You\'ve got the titles of n last problems \xe2\x80\x94 the strings, consisting of lowercase English letters. Your task is to find the shortest original title for the new problem. If there are multiple such titles, choose the lexicographically minimum one. Note, that title of the problem can\'t be an empty string.A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (where |s| is the length of string s) is string slsl\xe2\x80\x89+\xe2\x80\x891... sr.String x\xe2\x80\x89=\xe2\x80\x89x1x2... xp is lexicographically smaller than string y\xe2\x80\x89=\xe2\x80\x89y1y2... yq, if either p\xe2\x80\x89<\xe2\x80\x89q and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xp\xe2\x80\x89=\xe2\x80\x89yp, or there exists such number r (r\xe2\x80\x89<\xe2\x80\x89p,\xe2\x80\x89r\xe2\x80\x89<\xe2\x80\x89q), that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89... ,\xe2\x80\x89xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yr\xe2\x80\x89+\xe2\x80\x891. The string characters are compared by their ASCII codes." 1500
278A "Circle Line" implementation "The circle line of the Berland subway has n stations. We know the distances between all pairs of neighboring stations: d1 is the distance between the 1-st and the 2-nd station; d2 is the distance between the 2-nd and the 3-rd station;... dn\xe2\x80\x89-\xe2\x80\x891 is the distance between the n\xe2\x80\x89-\xe2\x80\x891-th and the n-th station; dn is the distance between the n-th and the 1-st station.The trains go along the circle line in both directions. Find the shortest distance between stations with numbers s and t." 800
277E "Binary Tree on Plane" flows,trees "A root tree is a directed acyclic graph that contains one node (root), from which there is exactly one path to any other node.A root tree is binary if each node has at most two outgoing arcs.When a binary tree is painted on the plane, all arcs should be directed from top to bottom. That is, each arc going from u to v must meet the condition yu\xe2\x80\x89>\xe2\x80\x89yv.You\'ve been given the coordinates of all tree nodes. Your task is to connect these nodes by arcs so as to get the binary root tree and make the total length of the arcs minimum. All arcs of the built tree must be directed from top to bottom." 2400
277D "Google Code Jam" dp,probabilities "Many of you must be familiar with the Google Code Jam round rules. Let us remind you of some key moments that are crucial to solving this problem. During the round, the participants are suggested to solve several problems, each divided into two subproblems: an easy one with small limits (Small input), and a hard one with large limits (Large input). You can submit a solution for Large input only after you\'ve solved the Small input for this problem. There are no other restrictions on the order of solving inputs. In particular, the participant can first solve the Small input, then switch to another problem, and then return to the Large input. Solving each input gives the participant some number of points (usually different for each problem). This takes into account only complete solutions that work correctly on all tests of the input. The participant gets the test result of a Small input right after he submits it, but the test result of a Large input are out only after the round\'s over. In the final results table the participants are sorted by non-increasing of received points. If the points are equal, the participants are sorted by ascending of time penalty. By the Google Code Jam rules the time penalty is the time when the last correct solution was submitted.Vasya decided to check out a new tactics on another round. As soon as the round begins, the boy quickly read all the problems and accurately evaluated the time it takes to solve them. Specifically, for each one of the n problems Vasya knows five values: Solving the Small input of the i-th problem gives to the participant scoreSmalli points, and solving the Large input gives scoreLargei more points. That is, the maximum number of points you can get for the i-th problem equals scoreSmalli\xe2\x80\x89+\xe2\x80\x89scoreLargei. Writing the solution for the Small input of the i-th problem takes exactly timeSmalli minutes for Vasya. Improving this code and turning it into the solution of the Large input takes another timeLargei minutes. Vasya\'s had much practice, so he solves all Small inputs from the first attempt. But it\'s not so easy with the Large input: there is the probFaili probability that the solution to the Large input will turn out to be wrong at the end of the round. Please keep in mind that these solutions do not affect the participants\' points and the time penalty.A round lasts for t minutes. The time for reading problems and submitting solutions can be considered to equal zero. Vasya is allowed to submit a solution exactly at the moment when the round ends.Vasya wants to choose a set of inputs and the order of their solution so as to make the expectation of the total received points maximum possible. If there are multiple ways to do this, he needs to minimize the expectation of the time penalty. Help Vasya to cope with this problem." 2800
277C Game games,implementation "Two players play the following game. Initially, the players have a knife and a rectangular sheet of paper, divided into equal square grid cells of unit size. The players make moves in turn, the player who can\'t make a move loses. In one move, a player can take the knife and cut the paper along any segment of the grid line (not necessarily from border to border). The part of the paper, that touches the knife at least once, is considered cut. There is one limit not to turn the game into an infinite cycle: each move has to cut the paper, that is the knife has to touch the part of the paper that is not cut before.Obviously, the game ends when the entire sheet is cut into 1\xe2\x80\x89\xc3\x97\xe2\x80\x891 blocks. During the game, the pieces of the sheet are not allowed to move. It is also prohibited to cut along the border. The coordinates of the ends of each cut must be integers.You are given an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m piece of paper, somebody has already made k cuts there. Your task is to determine who will win if the players start to play on this sheet. You can consider that both players play optimally well. If the first player wins, you also need to find the winning first move." 2400
277B "Set of Points" "constructive algorithms,geometry" "Convexity of a set of points on the plane is the size of the largest subset of points that form a convex polygon. Your task is to build a set of n points with the convexity of exactly m. Your set of points should not contain three points that lie on a straight line." 2300
277A "Learning Languages" "dfs and similar,dsu" "The ""BerCorp"" company has got n employees. These employees can use m approved official languages for the formal correspondence. The languages are numbered with integers from 1 to m. For each employee we have the list of languages, which he knows. This list could be empty, i. e. an employee may know no official languages. But the employees are willing to learn any number of official languages, as long as the company pays their lessons. A study course in one language for one employee costs 1 berdollar.Find the minimum sum of money the company needs to spend so as any employee could correspond to any other one (their correspondence can be indirect, i. e. other employees can help out translating)." 1400
276E "Little Girl and Problem on Trees" "data structures,graphs,trees" "A little girl loves problems on trees very much. Here\'s one of them.A tree is an undirected connected graph, not containing cycles. The degree of node x in the tree is the number of nodes y of the tree, such that each of them is connected with node x by some edge of the tree. Let\'s consider a tree that consists of n nodes. We\'ll consider the tree\'s nodes indexed from 1 to n. The cosidered tree has the following property: each node except for node number 1 has the degree of at most 2.Initially, each node of the tree contains number 0. Your task is to quickly process the requests of two types:  Request of form: 0 v x d. In reply to the request you should add x to all numbers that are written in the nodes that are located at the distance of at most d from node v. The distance between two nodes is the number of edges on the shortest path between them.  Request of form: 1 v. In reply to the request you should print the current number that is written in node v." 2100
276D "Little Girl and Maximum XOR" bitmasks,dp,greedy,implementation,math "A little girl loves problems on bitwise operations very much. Here\'s one of them.You are given two integers l and r. Let\'s consider the values of  for all pairs of integers a and b (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). Your task is to find the maximum value among all considered ones.Expression  means applying bitwise excluding or operation to integers x and y. The given operation exists in all modern programming languages, for example, in languages C++ and Java it is represented as ""^"", in Pascal \xe2\x80\x94 as ""xor""." 1700
276C "Little Girl and Maximum Sum" "data structures,greedy,implementation,sortings" "The little girl loves the problems on array queries very much.One day she came across a rather well-known problem: you\'ve got an array of n elements (the elements of the array are indexed starting from 1); also, there are q queries, each one is defined by a pair of integers li, ri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n). You need to find for each query the sum of elements of the array with indexes from li to ri, inclusive.The little girl found the problem rather boring. She decided to reorder the array elements before replying to the queries in a way that makes the sum of query replies maximum possible. Your task is to find the value of this maximum sum." 1500
276B "Little Girl and Game" games,greedy "The Little Girl loves problems on games very much. Here\'s one of them.Two players have got a string s, consisting of lowercase English letters. They play a game that is described by the following rules:  The players move in turns; In one move the player can remove an arbitrary letter from string s.  If the player before his turn can reorder the letters in string s so as to get a palindrome, this player wins. A palindrome is a string that reads the same both ways (from left to right, and vice versa). For example, string ""abba"" is a palindrome and string ""abc"" isn\'t. Determine which player will win, provided that both sides play optimally well \xe2\x80\x94 the one who moves first or the one who moves second." 1300
276A "Lunch Rush" implementation "Having written another programming contest, three Rabbits decided to grab some lunch. The coach gave the team exactly k time units for the lunch break.The Rabbits have a list of n restaurants to lunch in: the i-th restaurant is characterized by two integers fi and ti. Value ti shows the time the Rabbits need to lunch in the i-th restaurant. If time ti exceeds the time k that the coach has given for the lunch break, then the Rabbits\' joy from lunching in this restaurant will equal fi\xe2\x80\x89-\xe2\x80\x89(ti\xe2\x80\x89-\xe2\x80\x89k). Otherwise, the Rabbits get exactly fi units of joy.Your task is to find the value of the maximum joy the Rabbits can get from the lunch, depending on the restaurant. The Rabbits must choose exactly one restaurant to lunch in. Note that the joy value isn\'t necessarily a positive value." 900
275B "Convex Shape" "constructive algorithms,implementation" "Consider an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid. Initially all the cells of the grid are colored white. Lenny has painted some of the cells (at least one) black. We call a painted grid convex if one can walk from any black cell to any another black cell using a path of side-adjacent black cells changing his direction at most once during the path. In the figure below, the left grid is convex while the right one is not convex, because there exist two cells which need more than one time to change direction in their path.  You\'re given a painted grid in the input. Tell Lenny if the grid is convex or not." 1700
275A "Lights Out" implementation "Lenny is playing a game on a 3\xe2\x80\x89\xc3\x97\xe2\x80\x893 grid of lights. In the beginning of the game all lights are switched on. Pressing any of the lights will toggle it and all side-adjacent lights. The goal of the game is to switch all the lights off. We consider the toggling as follows: if the light was switched on then it will be switched off, if it was switched off then it will be switched on.Lenny has spent some time playing with the grid and by now he has pressed each light a certain number of times. Given the number of times each light is pressed, you have to print the current state of each light." 900
274E "Mirror Room" "data structures,implementation" "Imagine an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m grid with some blocked cells. The top left cell in the grid has coordinates (1,\xe2\x80\x891) and the bottom right cell has coordinates (n,\xe2\x80\x89m). There are k blocked cells in the grid and others are empty. You flash a laser beam from the center of an empty cell (xs,\xe2\x80\x89ys) in one of the diagonal directions (i.e. north-east, north-west, south-east or south-west). If the beam hits a blocked cell or the border of the grid it will reflect. The behavior of the beam reflection in different situations is depicted in the figure below.   After a while the beam enters an infinite cycle. Count the number of empty cells that the beam goes through at least once. We consider that the beam goes through cell if it goes through its center." 3000
274D "Lovely Matrix" "dfs and similar,graphs,greedy,sortings" "Lenny had an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix of positive integers. He loved the matrix so much, because each row of the matrix was sorted in non-decreasing order. For the same reason he calls such matrices of integers lovely.One day when Lenny was at school his little brother was playing with Lenny\'s matrix in his room. He erased some of the entries of the matrix and changed the order of some of its columns. When Lenny got back home he was very upset. Now Lenny wants to recover his matrix.Help him to find an order for the columns of the matrix so that it\'s possible to fill in the erased entries of the matrix to achieve a lovely matrix again. Note, that you can fill the erased entries of the matrix with any integers." 2200
274C "The Last Hole!" "brute force,geometry" "Luyi has n circles on the plane. The i-th circle is centered at (xi,\xe2\x80\x89yi). At the time zero circles start to grow simultaneously. In other words, the radius of each circle at time t (t\xe2\x80\x89>\xe2\x80\x890) is equal to t. The circles are drawn as black discs on an infinite white plane. So at each moment the plane consists of several black and white regions. Note that the circles may overlap while growing.  We define a hole as a closed, connected white region. For instance, the figure contains two holes shown by red border. During growing some holes may be created and it is easy to see that each created hole will disappear eventually. Luyi asks you to find moment of time such that the last hole disappears. In other words, you should find the first moment such that no hole can be seen after that." 2600
274B "Zero Tree" "dfs and similar,dp,greedy,trees" "A tree is a graph with n vertices and exactly n\xe2\x80\x89-\xe2\x80\x891 edges; this graph should meet the following condition: there exists exactly one shortest (by number of edges) path between any pair of its vertices.A subtree of a tree T is a tree with both vertices and edges as subsets of vertices and edges of T.You\'re given a tree with n vertices. Consider its vertices numbered with integers from 1 to n. Additionally an integer is written on every vertex of this tree. Initially the integer written on the i-th vertex is equal to vi. In one move you can apply the following operation:  Select the subtree of the given tree that includes the vertex with number 1.  Increase (or decrease) by one all the integers which are written on the vertices of that subtree. Calculate the minimum number of moves that is required to make all the integers written on the vertices of the given tree equal to zero." 1800
274A "k-Multiple Free Set" "binary search,greedy,sortings" "A k-multiple free set is a set of integers where there is no pair of integers where one is equal to another integer multiplied by k. That is, there are no two integers x and y (x\xe2\x80\x89<\xe2\x80\x89y) from the set, such that y\xe2\x80\x89=\xe2\x80\x89x\xc2\xb7k.You\'re given a set of n distinct positive integers. Your task is to find the size of it\'s largest k-multiple free subset." 1500
273E "Dima and Game" dp,games "Dima and Anya love playing different games. Now Dima has imagined a new game that he wants to play with Anya.Dima writes n pairs of integers on a piece of paper (li,\xe2\x80\x89ri) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89<\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p). Then players take turns. On his turn the player can do the following actions:  choose the number of the pair i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), such that ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89>\xe2\x80\x892;  replace pair number i by pair  or by pair . Notation \xe2\x8c\x8ax\xe2\x8c\x8b means rounding down to the closest integer. The player who can\'t make a move loses.Of course, Dima wants Anya, who will move first, to win. That\'s why Dima should write out such n pairs of integers (li,\xe2\x80\x89ri) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89<\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p), that if both players play optimally well, the first one wins. Count the number of ways in which Dima can do it. Print the remainder after dividing the answer by number 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Two ways are considered distinct, if the ordered sequences of the written pairs are distinct." 2600
273D "Dima and Figure" dp "Dima loves making pictures on a piece of squared paper. And yet more than that Dima loves the pictures that depict one of his favorite figures. A piece of squared paper of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m is represented by a table, consisting of n rows and m columns. All squares are white on blank squared paper. Dima defines a picture as an image on a blank piece of paper, obtained by painting some squares black.The picture portrays one of Dima\'s favorite figures, if the following conditions hold:  The picture contains at least one painted cell;  All painted cells form a connected set, that is, you can get from any painted cell to any other one (you can move from one cell to a side-adjacent one);  The minimum number of moves needed to go from the painted cell at coordinates (x1,\xe2\x80\x89y1) to the painted cell at coordinates (x2,\xe2\x80\x89y2), moving only through the colored cells, equals |x1\xe2\x80\x89-\xe2\x80\x89x2|\xe2\x80\x89+\xe2\x80\x89|y1\xe2\x80\x89-\xe2\x80\x89y2|. Now Dima is wondering: how many paintings are on an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m piece of paper, that depict one of his favorite figures? Count this number modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2400
272E "Dima and Horses" "combinatorics,constructive algorithms,graphs" "Dima came to the horse land. There are n horses living in the land. Each horse in the horse land has several enemies (enmity is a symmetric relationship). The horse land isn\'t very hostile, so the number of enemies of each horse is at most 3.Right now the horse land is going through an election campaign. So the horses trusted Dima to split them into two parts. At that the horses want the following condition to hold: a horse shouldn\'t have more than one enemy in its party.Help Dima split the horses into parties. Note that one of the parties can turn out to be empty." 2200
272D "Dima and Two Sequences" combinatorics,math,sortings "Little Dima has two sequences of points with integer coordinates: sequence (a1,\xe2\x80\x891),\xe2\x80\x89(a2,\xe2\x80\x892),\xe2\x80\x89...,\xe2\x80\x89(an,\xe2\x80\x89n) and sequence (b1,\xe2\x80\x891),\xe2\x80\x89(b2,\xe2\x80\x892),\xe2\x80\x89...,\xe2\x80\x89(bn,\xe2\x80\x89n).Now Dima wants to count the number of distinct sequences of points of length 2\xc2\xb7n that can be assembled from these sequences, such that the x-coordinates of points in the assembled sequence will not decrease. Help him with that. Note that each element of the initial sequences should be used exactly once in the assembled sequence.Dima considers two assembled sequences (p1,\xe2\x80\x89q1),\xe2\x80\x89(p2,\xe2\x80\x89q2),\xe2\x80\x89...,\xe2\x80\x89(p2\xc2\xb7n,\xe2\x80\x89q2\xc2\xb7n) and (x1,\xe2\x80\x89y1),\xe2\x80\x89(x2,\xe2\x80\x89y2),\xe2\x80\x89...,\xe2\x80\x89(x2\xc2\xb7n,\xe2\x80\x89y2\xc2\xb7n) distinct, if there is such i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7n), that (pi,\xe2\x80\x89qi)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89(xi,\xe2\x80\x89yi).As the answer can be rather large, print the remainder from dividing the answer by number m." 1600
272C "Dima and Staircase" "data structures,implementation" "Dima\'s got a staircase that consists of n stairs. The first stair is at height a1, the second one is at a2, the last one is at an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89an). Dima decided to play with the staircase, so he is throwing rectangular boxes at the staircase from above. The i-th box has width wi and height hi. Dima throws each box vertically down on the first wi stairs of the staircase, that is, the box covers stairs with numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89wi. Each thrown box flies vertically down until at least one of the two following events happen:  the bottom of the box touches the top of a stair;  the bottom of the box touches the top of a box, thrown earlier. We only consider touching of the horizontal sides of stairs and boxes, at that touching with the corners isn\'t taken into consideration. Specifically, that implies that a box with width wi cannot touch the stair number wi\xe2\x80\x89+\xe2\x80\x891.You are given the description of the staircase and the sequence in which Dima threw the boxes at it. For each box, determine how high the bottom of the box after landing will be. Consider a box to fall after the previous one lands." 1500
272B "Dima and Sequence" implementation,math "Dima got into number sequences. Now he\'s got sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, consisting of n positive integers. Also, Dima has got a function f(x), which can be defined with the following recurrence:  f(0)\xe2\x80\x89=\xe2\x80\x890;  f(2\xc2\xb7x)\xe2\x80\x89=\xe2\x80\x89f(x);  f(2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89f(x)\xe2\x80\x89+\xe2\x80\x891. Dima wonders, how many pairs of indexes (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are there, such that f(ai)\xe2\x80\x89=\xe2\x80\x89f(aj). Help him, count the number of such pairs." 1400
272A "Dima and Friends" implementation,math "Dima and his friends have been playing hide and seek at Dima\'s place all night. As a result, Dima\'s place got messy. In the morning they decided that they need to clean the place.To decide who exactly would clean the apartment, the friends want to play a counting-out game. First, all the guys stand in a circle, and then each of them shows some number of fingers on one hand (one to five), and then the boys count in a circle, starting from Dima, the number of people, respective to the total number of fingers shown. The person on who the countdown stops will clean the apartment.For example, if Dima and one of his friends played hide and seek, and 7 fingers were shown during the counting-out, then Dima would clean the place. If there were 2 or say, 8 fingers shown, then his friend would clean the place.Dima knows how many fingers each of his friends will show during the counting-out. Now he is interested in the number of ways to show some number of fingers on one hand (one to five), so that he did not have to clean the place. Help Dima." 1000
271E "Three Horses" "constructive algorithms,math,number theory" "There are three horses living in a horse land: one gray, one white and one gray-and-white. The horses are really amusing animals, which is why they adore special cards. Each of those cards must contain two integers, the first one on top, the second one in the bottom of the card. Let\'s denote a card with a on the top and b in the bottom as (a,\xe2\x80\x89b).Each of the three horses can paint the special cards. If you show an (a,\xe2\x80\x89b) card to the gray horse, then the horse can paint a new (a\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x891) card. If you show an (a,\xe2\x80\x89b) card, such that a and b are even integers, to the white horse, then the horse can paint a new  card. If you show two cards (a,\xe2\x80\x89b) and (b,\xe2\x80\x89c) to the gray-and-white horse, then he can paint a new (a,\xe2\x80\x89c) card.Polycarpus really wants to get n special cards (1,\xe2\x80\x89a1), (1,\xe2\x80\x89a2), ..., (1,\xe2\x80\x89an). For that he is going to the horse land. He can take exactly one (x,\xe2\x80\x89y) card to the horse land, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. How many ways are there to choose the card so that he can perform some actions in the horse land and get the required cards?Polycarpus can get cards from the horses only as a result of the actions that are described above. Polycarpus is allowed to get additional cards besides the cards that he requires." 2200
271D "Good Substrings" "data structures,strings" "You\'ve got string s, consisting of small English letters. Some of the English letters are good, the rest are bad.A substring s[l...r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89s1s2...s|s| (where |s| is the length of string s) is string \xe2\x80\x89slsl\xe2\x80\x89+\xe2\x80\x891...sr.The substring s[l...r] is good, if among the letters \xe2\x80\x89sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr there are at most k bad ones (look at the sample\'s explanation to understand it more clear).Your task is to find the number of distinct good substrings of the given string s. Two substrings s[x...y] and s[p...q] are considered distinct if their content is different, i.e. s[x...y]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s[p...q]." 1800
271C Secret "constructive algorithms,implementation" "The Greatest Secret Ever consists of n words, indexed by positive integers from 1 to n. The secret needs dividing between k Keepers (let\'s index them by positive integers from 1 to k), the i-th Keeper gets a non-empty set of words with numbers from the set Ui\xe2\x80\x89=\xe2\x80\x89(ui,\xe2\x80\x891,\xe2\x80\x89ui,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ui,\xe2\x80\x89|Ui|). Here and below we\'ll presuppose that the set elements are written in the increasing order.We\'ll say that the secret is safe if the following conditions are hold:  for any two indexes i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) the intersection of sets Ui and Uj is an empty set;  the union of sets U1,\xe2\x80\x89U2,\xe2\x80\x89...,\xe2\x80\x89Uk is set (1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n);  in each set Ui, its elements ui,\xe2\x80\x891,\xe2\x80\x89ui,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89ui,\xe2\x80\x89|Ui| do not form an arithmetic progression (in particular, |Ui|\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893 should hold). Let us remind you that the elements of set (u1,\xe2\x80\x89u2,\xe2\x80\x89...,\xe2\x80\x89us) form an arithmetic progression if there is such number d, that for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89s) fulfills ui\xe2\x80\x89+\xe2\x80\x89d\xe2\x80\x89=\xe2\x80\x89ui\xe2\x80\x89+\xe2\x80\x891. For example, the elements of sets (5), (1,\xe2\x80\x8910) and (1,\xe2\x80\x895,\xe2\x80\x899) form arithmetic progressions and the elements of sets (1,\xe2\x80\x892,\xe2\x80\x894) and (3,\xe2\x80\x896,\xe2\x80\x898) don\'t.Your task is to find any partition of the set of words into subsets U1,\xe2\x80\x89U2,\xe2\x80\x89...,\xe2\x80\x89Uk so that the secret is safe. Otherwise indicate that there\'s no such partition." 1500
271B "Prime Matrix" "binary search,brute force,math,number theory" "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix. The matrix consists of integers. In one move, you can apply a single transformation to the matrix: choose an arbitrary element of the matrix and increase it by 1. Each element can be increased an arbitrary number of times.You are really curious about prime numbers. Let us remind you that a prime number is a positive integer that has exactly two distinct positive integer divisors: itself and number one. For example, numbers 2, 3, 5 are prime and numbers 1, 4, 6 are not. A matrix is prime if at least one of the two following conditions fulfills:  the matrix has a row with prime numbers only;  the matrix has a column with prime numbers only; Your task is to count the minimum number of moves needed to get a prime matrix from the one you\'ve got." 1300
271A "Beautiful Year" "brute force" "It seems like the year of 2013 came only yesterday. Do you know a curious fact? The year of 2013 is the first year after the old 1987 with only distinct digits.Now you are suggested to solve the following problem: given a year number, find the minimum year number which is strictly larger than the given one and has only distinct digits." 800
270B Multithreading "data structures,greedy,implementation" "Emuskald is addicted to Codeforces, and keeps refreshing the main page not to miss any changes in the ""recent actions"" list. He likes to read thread conversations where each thread consists of multiple messages.Recent actions shows a list of n different threads ordered by the time of the latest message in the thread. When a new message is posted in a thread that thread jumps on the top of the list. No two messages of different threads are ever posted at the same time.Emuskald has just finished reading all his opened threads and refreshes the main page for some more messages to feed his addiction. He notices that no new threads have appeared in the list and at the i-th place in the list there is a thread that was at the ai-th place before the refresh. He doesn\'t want to waste any time reading old messages so he wants to open only threads with new messages.Help Emuskald find out the number of threads that surely have new messages. A thread x surely has a new message if there is no such sequence of thread updates (posting messages) that both conditions hold:   thread x is not updated (it has no new messages);  the list order 1, 2, ..., n changes to a1, a2, ..., an." 1400
270A "Fancy Fence" geometry,implementation,math "Emuskald needs a fence around his farm, but he is too lazy to build it himself. So he purchased a fence-building robot.He wants the fence to be a regular polygon. The robot builds the fence along a single path, but it can only make fence corners at a single angle a.Will the robot be able to build the fence Emuskald wants? In other words, is there a regular polygon which angles are equal to a?" 1100
269E "String Theory" geometry,math,strings "Emuskald is an innovative musician and always tries to push the boundaries of music production. Now he has come up with an idea for a revolutionary musical instrument \xe2\x80\x94 a rectangular harp.A rectangular harp is a rectangle n\xe2\x80\x89\xc3\x97\xe2\x80\x89m consisting of n rows and m columns. The rows are numbered 1 to n from top to bottom. Similarly the columns are numbered 1 to m from left to right. String pins are spaced evenly across every side, one per unit. Thus there are n pins on the left and right sides of the harp and m pins on its top and bottom. The harp has exactly n\xe2\x80\x89+\xe2\x80\x89m different strings, each string connecting two different pins, each on a different side of the harp.Emuskald has ordered his apprentice to construct the first ever rectangular harp. However, he didn\'t mention that no two strings can cross, otherwise it would be impossible to play the harp. Two strings cross if the segments connecting their pins intersect. To fix the harp, Emuskald can perform operations of two types:   pick two different columns and swap their pins on each side of the harp, not changing the pins that connect each string;  pick two different rows and swap their pins on each side of the harp, not changing the pins that connect each string; In the following example, he can fix the harp by swapping two columns:   Help Emuskald complete his creation and find the permutations how the rows and columns of the harp need to be rearranged, or tell that it is impossible to do so. He can detach and reattach each string to its pins, so the physical layout of the strings doesn\'t matter." 3100
269D "Maximum Waterfall" "data structures,dp,graphs,sortings" "Emuskald was hired to design an artificial waterfall according to the latest trends in landscape architecture. A modern artificial waterfall consists of multiple horizontal panels affixed to a wide flat wall. The water flows down the top of the wall from panel to panel until it reaches the bottom of the wall.The wall has height t and has n panels on the wall. Each panel is a horizontal segment at height hi which begins at li and ends at ri. The i-th panel connects the points (li,\xe2\x80\x89hi) and (ri,\xe2\x80\x89hi) of the plane. The top of the wall can be considered a panel connecting the points (\xe2\x80\x89-\xe2\x80\x89109,\xe2\x80\x89t) and (109,\xe2\x80\x89t). Similarly, the bottom of the wall can be considered a panel connecting the points (\xe2\x80\x89-\xe2\x80\x89109,\xe2\x80\x890) and (109,\xe2\x80\x890). No two panels share a common point.Emuskald knows that for the waterfall to be aesthetically pleasing, it can flow from panel i to panel j () only if the following conditions hold:   max(li,\xe2\x80\x89lj)\xe2\x80\x89<\xe2\x80\x89min(ri,\xe2\x80\x89rj) (horizontal projections of the panels overlap);  hj\xe2\x80\x89<\xe2\x80\x89hi (panel j is below panel i);  there is no such panel k (hj\xe2\x80\x89<\xe2\x80\x89hk\xe2\x80\x89<\xe2\x80\x89hi) that the first two conditions hold for the pairs (i,\xe2\x80\x89k) and (k,\xe2\x80\x89j). Then the flow for  is equal to min(ri,\xe2\x80\x89rj)\xe2\x80\x89-\xe2\x80\x89max(li,\xe2\x80\x89lj), the length of their horizontal projection overlap.Emuskald has decided that in his waterfall the water will flow in a single path from top to bottom. If water flows to a panel (except the bottom of the wall), the water will fall further to exactly one lower panel. The total amount of water flow in the waterfall is then defined as the minimum horizontal projection overlap between two consecutive panels in the path of the waterfall. Formally:   the waterfall consists of a single path of panels ;  the flow of the waterfall is the minimum flow in the path .  To make a truly great waterfall Emuskald must maximize this water flow, but there are too many panels and he is having a hard time planning his creation. Below is an example of a waterfall Emuskald wants:  Help Emuskald maintain his reputation and find the value of the maximum possible water flow." 2600
269C "Flawed Flow" "constructive algorithms,flows,graphs,greedy" "Emuskald considers himself a master of flow algorithms. Now he has completed his most ingenious program yet \xe2\x80\x94 it calculates the maximum flow in an undirected graph. The graph consists of n vertices and m edges. Vertices are numbered from 1 to n. Vertices 1 and n being the source and the sink respectively.However, his max-flow algorithm seems to have a little flaw \xe2\x80\x94 it only finds the flow volume for each edge, but not its direction. Help him find for each edge the direction of the flow through this edges. Note, that the resulting flow should be correct maximum flow.More formally. You are given an undirected graph. For each it\'s undirected edge (ai, bi) you are given the flow volume ci. You should direct all edges in such way that the following conditions hold:  for each vertex v (1\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89<\xe2\x80\x89n), sum of ci of incoming edges is equal to the sum of ci of outcoming edges;  vertex with number 1 has no incoming edges;  the obtained directed graph does not have cycles." 2100
269B "Greenhouse Effect" dp "Emuskald is an avid horticulturist and owns the world\'s longest greenhouse \xe2\x80\x94 it is effectively infinite in length.Over the years Emuskald has cultivated n plants in his greenhouse, of m different plant species numbered from 1 to m. His greenhouse is very narrow and can be viewed as an infinite line, with each plant occupying a single point on that line.Emuskald has discovered that each species thrives at a different temperature, so he wants to arrange m\xe2\x80\x89-\xe2\x80\x891 borders that would divide the greenhouse into m sections numbered from 1 to m from left to right with each section housing a single species. He is free to place the borders, but in the end all of the i-th species plants must reside in i-th section from the left.Of course, it is not always possible to place the borders in such way, so Emuskald needs to replant some of his plants. He can remove each plant from its position and place it anywhere in the greenhouse (at any real coordinate) with no plant already in it. Since replanting is a lot of stress for the plants, help Emuskald find the minimum number of plants he has to replant to be able to place the borders." 1700
269A "Magical Boxes" greedy,math "Emuskald is a well-known illusionist. One of his trademark tricks involves a set of magical boxes. The essence of the trick is in packing the boxes inside other boxes.From the top view each magical box looks like a square with side length equal to 2k (k is an integer, k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890) units. A magical box v can be put inside a magical box u, if side length of v is strictly less than the side length of u. In particular, Emuskald can put 4 boxes of side length 2k\xe2\x80\x89-\xe2\x80\x891 into one box of side length 2k, or as in the following figure:  Emuskald is about to go on tour performing around the world, and needs to pack his magical boxes for the trip. He has decided that the best way to pack them would be inside another magical box, but magical boxes are quite expensive to make. Help him find the smallest magical box that can fit all his boxes." 1600
268E Playlist math,probabilities,sortings "Manao\'s friends often send him new songs. He never listens to them right away. Instead, he compiles them into a playlist. When he feels that his mind is open to new music, he opens the playlist and starts to listen to the songs.Of course, there are some songs that Manao doesn\'t particuarly enjoy. To get more pleasure from the received songs, he invented the following procedure of listening to the playlist:  If after listening to some song Manao realizes that he liked it, then he remembers it and starts to listen to the next unlistened song.  If after listening to some song Manao realizes that he did not like it, he listens to all the songs he liked up to this point and then begins to listen to the next unlistened song. For example, if Manao has four songs in the playlist, A, B, C, D (in the corresponding order) and he is going to like songs A and C in the end, then the order of listening is the following:  Manao listens to A, he likes it, he remembers it.  Manao listens to B, he does not like it, so he listens to A, again.  Manao listens to C, he likes the song and he remembers it, too.  Manao listens to D, but does not enjoy it and re-listens to songs A and C. That is, in the end Manao listens to song A three times, to song C twice and songs B and D once. Note that if Manao once liked a song, he will never dislike it on a subsequent listening.Manao has received n songs: the i-th of them is li seconds long and Manao may like it with a probability of pi percents. The songs could get on Manao\'s playlist in any order, so Manao wants to know the maximum expected value of the number of seconds after which the listening process will be over, for all possible permutations of the songs in the playlist." 2100
268D "Wall Bars" dp "Manao is working for a construction company. Recently, an order came to build wall bars in a children\'s park. Manao was commissioned to develop a plan of construction, which will enable the company to save the most money.After reviewing the formal specifications for the wall bars, Manao discovered a number of controversial requirements and decided to treat them to the company\'s advantage. His resulting design can be described as follows:  Let\'s introduce some unit of length. The construction center is a pole of height n.  At heights 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n exactly one horizontal bar sticks out from the pole. Each bar sticks in one of four pre-fixed directions.  A child can move from one bar to another if the distance between them does not exceed h and they stick in the same direction. If a child is on the ground, he can climb onto any of the bars at height between 1 and h. In Manao\'s construction a child should be able to reach at least one of the bars at heights n\xe2\x80\x89-\xe2\x80\x89h\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89h\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n if he begins at the ground.   The figure to the left shows what a common set of wall bars looks like. The figure to the right shows Manao\'s construction Manao is wondering how many distinct construction designs that satisfy his requirements exist. As this number can be rather large, print the remainder after dividing it by 1000000009 (109\xe2\x80\x89+\xe2\x80\x899). Two designs are considered distinct if there is such height i, that the bars on the height i in these designs don\'t stick out in the same direction." 2300
268C "Beautiful Sets of Points" "constructive algorithms,implementation" "Manao has invented a new mathematical term \xe2\x80\x94 a beautiful set of points. He calls a set of points on a plane beautiful if it meets the following conditions:  The coordinates of each point in the set are integers.  For any two points from the set, the distance between them is a non-integer. Consider all points (x,\xe2\x80\x89y) which satisfy the inequations: 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m; x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89>\xe2\x80\x890. Choose their subset of maximum size such that it is also a beautiful set of points." 1500
268B Buttons implementation,math "Manao is trying to open a rather challenging lock. The lock has n buttons on it and to open it, you should press the buttons in a certain order to open the lock. When you push some button, it either stays pressed into the lock (that means that you\'ve guessed correctly and pushed the button that goes next in the sequence), or all pressed buttons return to the initial position. When all buttons are pressed into the lock at once, the lock opens.Consider an example with three buttons. Let\'s say that the opening sequence is: {2, 3, 1}. If you first press buttons 1 or 3, the buttons unpress immediately. If you first press button 2, it stays pressed. If you press 1 after 2, all buttons unpress. If you press 3 after 2, buttons 3 and 2 stay pressed. As soon as you\'ve got two pressed buttons, you only need to press button 1 to open the lock.Manao doesn\'t know the opening sequence. But he is really smart and he is going to act in the optimal way. Calculate the number of times he\'s got to push a button in order to open the lock in the worst-case scenario." 1000
268A Games "brute force" "Manao works on a sports TV. He\'s spent much time watching the football games of some country. After a while he began to notice different patterns. For example, each team has two sets of uniforms: home uniform and guest uniform. When a team plays a game at home, the players put on the home uniform. When a team plays as a guest on somebody else\'s stadium, the players put on the guest uniform. The only exception to that rule is: when the home uniform color of the host team matches the guests\' uniform, the host team puts on its guest uniform as well. For each team the color of the home and guest uniform is different.There are n teams taking part in the national championship. The championship consists of n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891) games: each team invites each other team to its stadium. At this point Manao wondered: how many times during the championship is a host team going to put on the guest uniform? Note that the order of the games does not affect this number.You know the colors of the home and guest uniform for each team. For simplicity, the colors are numbered by integers in such a way that no two distinct colors have the same number. Help Manao find the answer to his question." 800
267C "Berland Traffic" math,matrices "Berland traffic is very different from traffic in other countries. The capital of Berland consists of n junctions and m roads. Each road connects a pair of junctions. There can be multiple roads between a pair of junctions. For each road we know its capacity: value ci is the maximum number of cars that can drive along a road in any direction per a unit of time. For each road, the cars can drive along it in one of two direction. That it, the cars can\'t simultaneously move in both directions. A road\'s traffic is the number of cars that goes along it per a unit of time. For road (ai,\xe2\x80\x89bi) this value is negative, if the traffic moves from bi to ai. A road\'s traffic can be a non-integer number.The capital has two special junctions \xe2\x80\x94 the entrance to the city (junction 1) and the exit from the city (junction n). For all other junctions it is true that the traffic is not lost there. That is, for all junctions except for 1 and n the incoming traffic sum equals the outgoing traffic sum.Traffic has an unusual peculiarity in the capital of Berland \xe2\x80\x94 for any pair of junctions (x,\xe2\x80\x89y) the sum of traffics along any path from x to y doesn\'t change depending on the choice of the path. Such sum includes traffic along all roads on the path (possible with the ""minus"" sign, if the traffic along the road is directed against the direction of the road on the path from x to y).Your task is to find the largest traffic that can pass trough the city per one unit of time as well as the corresponding traffic for each road." 2700
267B Dominoes "dfs and similar,graphs" "You have a set of dominoes. Each domino is a rectangular tile with a line dividing its face into two square ends. Can you put all dominoes in a line one by one from left to right so that any two dominoes touched with the sides that had the same number of points? You can rotate the dominoes, changing the left and the right side (domino ""1-4"" turns into ""4-1"")." 2000
267A Subtractions "math,number theory" "You\'ve got two numbers. As long as they are both larger than zero, they go through the same operation: subtract the lesser number from the larger one. If they equal substract one number from the another. For example, one operation transforms pair (4,17) to pair (4,13), it transforms (5,5) to (0,5).You\'ve got some number of pairs (ai,\xe2\x80\x89bi). How many operations will be performed for each of them?" 900
266E "More Queries to Array..." "data structures,math" "You\'ve got an array, consisting of n integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to quickly run the queries of two types: Assign value x to all elements from l to r inclusive. After such query the values of the elements of array al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar become equal to x. Calculate and print sum , where k doesn\'t exceed 5. As the value of the sum can be rather large, you should print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2500
266D BerDonalds "graphs,math,shortest paths" "BerDonalds, a well-known fast food restaurant, is going to open a cafe in Bertown. The important thing is to choose the new restaurant\'s location so that it would be easy to get there. The Bertown road system is represented by n junctions, connected by m bidirectional roads. For each road we know its length. We also know that we can get from any junction to any other one, moving along the roads.Your task is to find such location of the restaurant, that the shortest distance along the roads from the cafe to the farthest junction would be minimum. Note that the restaurant can be located not only on the junction, but at any point of any road." 2400
266C "Below the Diagonal" "constructive algorithms,greedy,math" "You are given a square matrix consisting of n rows and n columns. We assume that the rows are numbered from 1 to n from top to bottom and the columns are numbered from 1 to n from left to right. Some cells (n\xe2\x80\x89-\xe2\x80\x891 cells in total) of the the matrix are filled with ones, the remaining cells are filled with zeros. We can apply the following operations to the matrix:  Swap i-th and j-th rows of the matrix;  Swap i-th and j-th columns of the matrix. You are asked to transform the matrix into a special form using these operations. In that special form all the ones must be in the cells that lie below the main diagonal. Cell of the matrix, which is located on the intersection of the i-th row and of the j-th column, lies below the main diagonal if i\xe2\x80\x89>\xe2\x80\x89j." 2100
266B "Queue at the School" "constructive algorithms,graph matchings,implementation,shortest paths" "During the break the schoolchildren, boys and girls, formed a queue of n people in the canteen. Initially the children stood in the order they entered the canteen. However, after a while the boys started feeling awkward for standing in front of the girls in the queue and they started letting the girls move forward each second. Let\'s describe the process more precisely. Let\'s say that the positions in the queue are sequentially numbered by integers from 1 to n, at that the person in the position number 1 is served first. Then, if at time x a boy stands on the i-th position and a girl stands on the (i\xe2\x80\x89+\xe2\x80\x891)-th position, then at time x\xe2\x80\x89+\xe2\x80\x891 the i-th position will have a girl and the (i\xe2\x80\x89+\xe2\x80\x891)-th position will have a boy. The time is given in seconds.You\'ve got the initial position of the children, at the initial moment of time. Determine the way the queue is going to look after t seconds." 800
266A "Stones on the Table" implementation "There are n stones on the table in a row, each of them can be red, green or blue. Count the minimum number of stones to take from the table so that any two neighboring stones had different colors. Stones in a row are considered neighboring if there are no other stones between them." 800
265B "Roadside Trees (Simplified Edition)" greedy,implementation "Squirrel Liss loves nuts. There are n trees (numbered 1 to n from west to east) along a street and there is a delicious nut on the top of each tree. The height of the tree i is hi. Liss wants to eat all nuts.Now Liss is on the root of the tree with the number 1. In one second Liss can perform one of the following actions:  Walk up or down one unit on a tree.  Eat a nut on the top of the current tree.  Jump to the next tree. In this action the height of Liss doesn\'t change. More formally, when Liss is at height h of the tree i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891), she jumps to height h of the tree i\xe2\x80\x89+\xe2\x80\x891. This action can\'t be performed if h\xe2\x80\x89>\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891. Compute the minimal time (in seconds) required to eat all nuts." 1000
265A "Colorful Stones (Simplified Edition)" implementation "There is a sequence of colorful stones. The color of each stone is one of red, green, or blue. You are given a string s. The i-th (1-based) character of s represents the color of the i-th stone. If the character is ""R"", ""G"", or ""B"", the color of the corresponding stone is red, green, or blue, respectively.Initially Squirrel Liss is standing on the first stone. You perform instructions one or more times.Each instruction is one of the three types: ""RED"", ""GREEN"", or ""BLUE"". After an instruction c, if Liss is standing on a stone whose colors is c, Liss will move one stone forward, else she will not move.You are given a string t. The number of instructions is equal to the length of t, and the i-th character of t represents the i-th instruction.Calculate the final position of Liss (the number of the stone she is going to stand on in the end) after performing all the instructions, and print its 1-based position. It is guaranteed that Liss don\'t move out of the sequence." 800
264E "Roadside Trees" "data structures,dp" "Squirrel Liss loves nuts. Liss asks you to plant some nut trees.There are n positions (numbered 1 to n from west to east) to plant a tree along a street. Trees grow one meter per month. At the beginning of each month you should process one query. The query is one of the following types:  Plant a tree of height h at position p.  Cut down the x-th existent (not cut) tree from the west (where x is 1-indexed). When we cut the tree it drops down and takes all the available place at the position where it has stood. So no tree can be planted at this position anymore. After processing each query, you should print the length of the longest increasing subsequence. A subset of existent trees is called an increasing subsequence if the height of the trees in the set is strictly increasing from west to east (for example, the westmost tree in the set must be the shortest in the set). The length of the increasing subsequence is the number of trees in it.Note that Liss don\'t like the trees with the same heights, so it is guaranteed that at any time no two trees have the exactly same heights." 3000
264D "Colorful Stones" "dp,two pointers" "There are two sequences of colorful stones. The color of each stone is one of red, green, or blue. You are given two strings s and t. The i-th (1-based) character of s represents the color of the i-th stone of the first sequence. Similarly, the i-th (1-based) character of t represents the color of the i-th stone of the second sequence. If the character is ""R"", ""G"", or ""B"", the color of the corresponding stone is red, green, or blue, respectively.Initially Squirrel Liss is standing on the first stone of the first sequence and Cat Vasya is standing on the first stone of the second sequence. You can perform the following instructions zero or more times.Each instruction is one of the three types: ""RED"", ""GREEN"", or ""BLUE"". After an instruction c, the animals standing on stones whose colors are c will move one stone forward. For example, if you perform an instruction \xc2\xabRED\xc2\xbb, the animals standing on red stones will move one stone forward. You are not allowed to perform instructions that lead some animals out of the sequences. In other words, if some animals are standing on the last stones, you can\'t perform the instructions of the colors of those stones.A pair of positions (position of Liss, position of Vasya) is called a state. A state is called reachable if the state is reachable by performing instructions zero or more times from the initial state (1, 1). Calculate the number of distinct reachable states." 2500
264C "Choosing Balls" dp "There are n balls. They are arranged in a row. Each ball has a color (for convenience an integer) and an integer value. The color of the i-th ball is ci and the value of the i-th ball is vi.Squirrel Liss chooses some balls and makes a new sequence without changing the relative order of the balls. She wants to maximize the value of this sequence.The value of the sequence is defined as the sum of following values for each ball (where a and b are given constants):  If the ball is not in the beginning of the sequence and the color of the ball is same as previous ball\'s color, add (the value of the ball) \xe2\x80\x89\xc3\x97\xe2\x80\x89 a.  Otherwise, add (the value of the ball) \xe2\x80\x89\xc3\x97\xe2\x80\x89 b. You are given q queries. Each query contains two integers ai and bi. For each query find the maximal value of the sequence she can make when a\xe2\x80\x89=\xe2\x80\x89ai and b\xe2\x80\x89=\xe2\x80\x89bi.Note that the new sequence can be empty, and the value of an empty sequence is defined as zero." 2000
264B "Good Sequences" "dp,number theory" "Squirrel Liss is interested in sequences. She also has preferences of integers. She thinks n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an are good.Now she is interested in good sequences. A sequence x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk is called good if it satisfies the following three conditions:  The sequence is strictly increasing, i.e. xi\xe2\x80\x89<\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891 for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891).  No two adjacent elements are coprime, i.e. gcd(xi,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89>\xe2\x80\x891 for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891) (where gcd(p,\xe2\x80\x89q) denotes the greatest common divisor of the integers p and q).  All elements of the sequence are good integers. Find the length of the longest good sequence." 1500
264A "Escape from Stones" "constructive algorithms,data structures,implementation,two pointers" "Squirrel Liss lived in a forest peacefully, but unexpected trouble happens. Stones fall from a mountain. Initially Squirrel Liss occupies an interval [0,\xe2\x80\x891]. Next, n stones will fall and Liss will escape from the stones. The stones are numbered from 1 to n in order.The stones always fall to the center of Liss\'s interval. When Liss occupies the interval [k\xe2\x80\x89-\xe2\x80\x89d,\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x89d] and a stone falls to k, she will escape to the left or to the right. If she escapes to the left, her new interval will be [k\xe2\x80\x89-\xe2\x80\x89d,\xe2\x80\x89k]. If she escapes to the right, her new interval will be [k,\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x89d].You are given a string s of length n. If the i-th character of s is ""l"" or ""r"", when the i-th stone falls Liss will escape to the left or to the right, respectively. Find the sequence of stones\' numbers from left to right after all the n stones falls." 1200
263E Rhombus "brute force,data structures,dp" "You\'ve got a table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. On the intersection of the i-th row (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and the j-th column (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) there is a non-negative integer ai,\xe2\x80\x89j. Besides, you\'ve got a non-negative integer k.Your task is to find such pair of integers (a,\xe2\x80\x89b) that meets these conditions:   k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891;  k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891;  let\'s denote the maximum of the function  among all integers x and y, that satisfy the inequalities k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 and k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891, as mval; for the required pair of numbers the following equation must hold f(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x89mval." 2500
263D "Cycle in Graph" "dfs and similar,graphs" "You\'ve got a undirected graph G, consisting of n nodes. We will consider the nodes of the graph indexed by integers from 1 to n. We know that each node of graph G is connected by edges with at least k other nodes of this graph. Your task is to find in the given graph a simple cycle of length of at least k\xe2\x80\x89+\xe2\x80\x891.A simple cycle of length d (d\xe2\x80\x89>\xe2\x80\x891) in graph G is a sequence of distinct graph nodes v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vd such, that nodes v1 and vd are connected by an edge of the graph, also for any integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89d) nodes vi and vi\xe2\x80\x89+\xe2\x80\x891 are connected by an edge of the graph." 1800
263C "Circle of Numbers" "brute force,dfs and similar,implementation" "One day Vasya came up to the blackboard and wrote out n distinct integers from 1 to n in some order in a circle. Then he drew arcs to join the pairs of integers (a,\xe2\x80\x89b) (a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b), that are either each other\'s immediate neighbors in the circle, or there is number c, such that a and \xd1\x81 are immediate neighbors, and b and c are immediate neighbors. As you can easily deduce, in the end Vasya drew 2\xc2\xb7n arcs.For example, if the numbers are written in the circle in the order 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895 (in the clockwise direction), then the arcs will join pairs of integers (1,\xe2\x80\x892), (2,\xe2\x80\x893), (3,\xe2\x80\x894), (4,\xe2\x80\x895), (5,\xe2\x80\x891), (1,\xe2\x80\x893), (2,\xe2\x80\x894), (3,\xe2\x80\x895), (4,\xe2\x80\x891) and (5,\xe2\x80\x892).Much time has passed ever since, the numbers we wiped off the blackboard long ago, but recently Vasya has found a piece of paper with 2\xc2\xb7n written pairs of integers that were joined with the arcs on the board. Vasya asks you to find the order of numbers in the circle by these pairs." 2000
263B Squares greedy,implementation,sortings "Vasya has found a piece of paper with a coordinate system written on it. There are n distinct squares drawn in this coordinate system. Let\'s number the squares with integers from 1 to n. It turned out that points with coordinates (0,\xe2\x80\x890) and (ai,\xe2\x80\x89ai) are the opposite corners of the i-th square.Vasya wants to find such integer point (with integer coordinates) of the plane, that belongs to exactly k drawn squares. We\'ll say that a point belongs to a square, if the point is located either inside the square, or on its boundary. Help Vasya find a point that would meet the described limits." 900
263A "Beautiful Matrix" implementation "You\'ve got a 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 matrix, consisting of 24 zeroes and a single number one. Let\'s index the matrix rows by numbers from 1 to 5 from top to bottom, let\'s index the matrix columns by numbers from 1 to 5 from left to right. In one move, you are allowed to apply one of the two following transformations to the matrix:  Swap two neighboring matrix rows, that is, rows with indexes i and i\xe2\x80\x89+\xe2\x80\x891 for some integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x895).  Swap two neighboring matrix columns, that is, columns with indexes j and j\xe2\x80\x89+\xe2\x80\x891 for some integer j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x895). You think that a matrix looks beautiful, if the single number one of the matrix is located in its middle (in the cell that is on the intersection of the third row and the third column). Count the minimum number of moves needed to make the matrix beautiful." 800
262B "Roma and Changing Signs" greedy "Roma works in a company that sells TVs. Now he has to prepare a report for the last year.Roma has got a list of the company\'s incomes. The list is a sequence that consists of n integers. The total income of the company is the sum of all integers in sequence. Roma decided to perform exactly k changes of signs of several numbers in the sequence. He can also change the sign of a number one, two or more times.The operation of changing a number\'s sign is the operation of multiplying this number by -1.Help Roma perform the changes so as to make the total income of the company (the sum of numbers in the resulting sequence) maximum. Note that Roma should perform exactly k changes." 1200
262A "Roma and Lucky Numbers" implementation "Roma (a popular Russian name that means \'Roman\') loves the Little Lvov Elephant\'s lucky numbers.Let us remind you that lucky numbers are positive integers whose decimal representation only contains lucky digits 4 and 7. For example, numbers 47, 744, 4 are lucky and 5, 17, 467 are not.Roma\'s got n positive integers. He wonders, how many of those integers have not more than k lucky digits? Help him, write the program that solves the problem." 800
261E "Maxim and Calculator" "brute force,dp,two pointers" "Maxim has got a calculator. The calculator has two integer cells. Initially, the first cell contains number 1, and the second cell contains number 0. In one move you can perform one of the following operations:  Let\'s assume that at the current time the first cell contains number a, and the second cell contains number b. Write to the second cell number b\xe2\x80\x89+\xe2\x80\x891;  Let\'s assume that at the current time the first cell contains number a, and the second cell contains number b. Write to the first cell number a\xc2\xb7b. Maxim is wondering, how many integers x (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) are there, such that we can write the number x to the first cell of the calculator, having performed at most p moves." 2800
261D "Maxim and Increasing Subsequence" dp "Maxim loves sequences, especially those that strictly increase. He is wondering, what is the length of the longest increasing subsequence of the given sequence a?Sequence a is given as follows:   the length of the sequence equals n\xe2\x80\x89\xc3\x97\xe2\x80\x89t;   (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xc3\x97\xe2\x80\x89t), where operation  means taking the remainder after dividing number x by number y. Sequence s1,\xe2\x80\x89\xe2\x80\x89s2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89sr of length r is a subsequence of sequence a1,\xe2\x80\x89\xe2\x80\x89a2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89an, if there is such increasing sequence of indexes i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ir (1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89i1\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89i2\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89... \xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89ir\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89n), that aij\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89sj. In other words, the subsequence can be obtained from the sequence by crossing out some elements.Sequence s1,\xe2\x80\x89\xe2\x80\x89s2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89sr is increasing, if the following inequality holds: s1\xe2\x80\x89<\xe2\x80\x89s2\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89sr.Maxim have k variants of the sequence a. Help Maxim to determine for each sequence the length of the longest increasing subsequence." 2600
261C "Maxim and Matrix" "constructive algorithms,dp,math" "Maxim loves to fill in a matrix in a special manner. Here is a pseudocode of filling in a matrix of size (m\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89(m\xe2\x80\x89+\xe2\x80\x891):Maxim asks you to count, how many numbers m (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are there, such that the sum of values in the cells in the row number m\xe2\x80\x89+\xe2\x80\x891 of the resulting matrix equals t.Expression (x xor y) means applying the operation of bitwise excluding ""OR"" to numbers x and y. The given operation exists in all modern programming languages. For example, in languages C++ and Java it is represented by character ""^"", in Pascal \xe2\x80\x94 by ""xor""." 2000
261B "Maxim and Restaurant" dp,math,probabilities "Maxim has opened his own restaurant! The restaurant has got a huge table, the table\'s length is p meters.Maxim has got a dinner party tonight, n guests will come to him. Let\'s index the guests of Maxim\'s restaurant from 1 to n. Maxim knows the sizes of all guests that are going to come to him. The i-th guest\'s size (ai) represents the number of meters the guest is going to take up if he sits at the restaurant table.Long before the dinner, the guests line up in a queue in front of the restaurant in some order. Then Maxim lets the guests in, one by one. Maxim stops letting the guests in when there is no place at the restaurant table for another guest in the queue. There is no place at the restaurant table for another guest in the queue, if the sum of sizes of all guests in the restaurant plus the size of this guest from the queue is larger than p. In this case, not to offend the guest who has no place at the table, Maxim doesn\'t let any other guest in the restaurant, even if one of the following guests in the queue would have fit in at the table.Maxim is now wondering, what is the average number of visitors who have come to the restaurant for all possible n! orders of guests in the queue. Help Maxim, calculate this number." 1900
261A "Maxim and Discounts" greedy,sortings "Maxim always goes to the supermarket on Sundays. Today the supermarket has a special offer of discount systems.There are m types of discounts. We assume that the discounts are indexed from 1 to m. To use the discount number i, the customer takes a special basket, where he puts exactly qi items he buys. Under the terms of the discount system, in addition to the items in the cart the customer can receive at most two items from the supermarket for free. The number of the ""free items"" (0, 1 or 2) to give is selected by the customer. The only condition imposed on the selected ""free items"" is as follows: each of them mustn\'t be more expensive than the cheapest item out of the qi items in the cart.Maxim now needs to buy n items in the shop. Count the minimum sum of money that Maxim needs to buy them, if he use the discount system optimally well.Please assume that the supermarket has enough carts for any actions. Maxim can use the same discount multiple times. Of course, Maxim can buy items without any discounts." 1400
260E "Dividing Kingdom" "binary search,brute force,data structures" "A country called Flatland is an infinite two-dimensional plane. Flatland has n cities, each of them is a point on the plane.Flatland is ruled by king Circle IV. Circle IV has 9 sons. He wants to give each of his sons part of Flatland to rule. For that, he wants to draw four distinct straight lines, such that two of them are parallel to the Ox axis, and two others are parallel to the Oy axis. At that, no straight line can go through any city. Thus, Flatland will be divided into 9 parts, and each son will be given exactly one of these parts. Circle IV thought a little, evaluated his sons\' obedience and decided that the i-th son should get the part of Flatland that has exactly ai cities.Help Circle find such four straight lines that if we divide Flatland into 9 parts by these lines, the resulting parts can be given to the sons so that son number i got the part of Flatland which contains ai cities." 2500
260D "Black and White Tree" "constructive algorithms,dsu,graphs,greedy,trees" "The board has got a painted tree graph, consisting of n nodes. Let us remind you that a non-directed graph is called a tree if it is connected and doesn\'t contain any cycles.Each node of the graph is painted black or white in such a manner that there aren\'t two nodes of the same color, connected by an edge. Each edge contains its value written on it as a non-negative integer.A bad boy Vasya came up to the board and wrote number sv near each node v \xe2\x80\x94 the sum of values of all edges that are incident to this node. Then Vasya removed the edges and their values from the board.Your task is to restore the original tree by the node colors and numbers sv." 2100
260C "Balls and Boxes" "constructive algorithms,greedy,implementation" "Little Vasya had n boxes with balls in the room. The boxes stood in a row and were numbered with numbers from 1 to n from left to right.Once Vasya chose one of the boxes, let\'s assume that its number is i, took all balls out from it (it is guaranteed that this box originally had at least one ball), and began putting balls (one at a time) to the boxes with numbers i\xe2\x80\x89+\xe2\x80\x891, i\xe2\x80\x89+\xe2\x80\x892, i\xe2\x80\x89+\xe2\x80\x893 and so on. If Vasya puts a ball into the box number n, then the next ball goes to box 1, the next one goes to box 2 and so on. He did it until he had no balls left in his hands. It is possible that Vasya puts multiple balls to the same box, and it is also possible that one or more balls will go to the box number i. If i\xe2\x80\x89=\xe2\x80\x89n, Vasya puts the first ball into the box number 1, then the next ball goes to box 2 and so on. For example, let\'s suppose that initially Vasya had four boxes, and the first box had 3 balls, the second one had 2, the third one had 5 and the fourth one had 4 balls. Then, if i\xe2\x80\x89=\xe2\x80\x893, then Vasya will take all five balls out of the third box and put them in the boxes with numbers: 4,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894. After all Vasya\'s actions the balls will lie in the boxes as follows: in the first box there are 4 balls, 3 in the second one, 1 in the third one and 6 in the fourth one.At this point Vasya has completely forgotten the original arrangement of the balls in the boxes, but he knows how they are arranged now, and the number x \xe2\x80\x94 the number of the box, where he put the last of the taken out balls.He asks you to help to find the initial arrangement of the balls in the boxes." 1700
260B "Ancient Prophesy" "brute force,implementation,strings" "A recently found Ancient Prophesy is believed to contain the exact Apocalypse date. The prophesy is a string that only consists of digits and characters ""-"".We\'ll say that some date is mentioned in the Prophesy if there is a substring in the Prophesy that is the date\'s record in the format ""dd-mm-yyyy"". We\'ll say that the number of the date\'s occurrences is the number of such substrings in the Prophesy. For example, the Prophesy ""0012-10-2012-10-2012"" mentions date 12-10-2012 twice (first time as ""0012-10-2012-10-2012"", second time as ""0012-10-2012-10-2012"").The date of the Apocalypse is such correct date that the number of times it is mentioned in the Prophesy is strictly larger than that of any other correct date.A date is correct if the year lies in the range from 2013 to 2015, the month is from 1 to 12, and the number of the day is strictly more than a zero and doesn\'t exceed the number of days in the current month. Note that a date is written in the format ""dd-mm-yyyy"", that means that leading zeroes may be added to the numbers of the months or days if needed. In other words, date ""1-1-2013"" isn\'t recorded in the format ""dd-mm-yyyy"", and date ""01-01-2013"" is recorded in it.Notice, that any year between 2013 and 2015 is not a leap year." 1600
260A "Adding Digits" implementation,math "Vasya has got two number: a and b. However, Vasya finds number a too short. So he decided to repeat the operation of lengthening number a n times.One operation of lengthening a number means adding exactly one digit to the number (in the decimal notation) to the right provided that the resulting number is divisible by Vasya\'s number b. If it is impossible to obtain the number which is divisible by b, then the lengthening operation cannot be performed.Your task is to help Vasya and print the number he can get after applying the lengthening operation to number a n times." 1400
259B "Little Elephant and Magic Square" "brute force,implementation" "Little Elephant loves magic squares very much.A magic square is a 3\xe2\x80\x89\xc3\x97\xe2\x80\x893 table, each cell contains some positive integer. At that the sums of integers in all rows, columns and diagonals of the table are equal. The figure below shows the magic square, the sum of integers in all its rows, columns and diagonals equals 15.  The Little Elephant remembered one magic square. He started writing this square on a piece of paper, but as he wrote, he forgot all three elements of the main diagonal of the magic square. Fortunately, the Little Elephant clearly remembered that all elements of the magic square did not exceed 105. Help the Little Elephant, restore the original magic square, given the Elephant\'s notes." 1100
259A "Little Elephant and Chess" "brute force,strings" "The Little Elephant loves chess very much. One day the Little Elephant and his friend decided to play chess. They\'ve got the chess pieces but the board is a problem. They\'ve got an 8\xe2\x80\x89\xc3\x97\xe2\x80\x898 checkered board, each square is painted either black or white. The Little Elephant and his friend know that a proper chessboard doesn\'t have any side-adjacent cells with the same color and the upper left cell is white. To play chess, they want to make the board they have a proper chessboard. For that the friends can choose any row of the board and cyclically shift the cells of the chosen row, that is, put the last (rightmost) square on the first place in the row and shift the others one position to the right. You can run the described operation multiple times (or not run it at all).For example, if the first line of the board looks like that ""BBBBBBWW"" (the white cells of the line are marked with character ""W"", the black cells are marked with character ""B""), then after one cyclic shift it will look like that ""WBBBBBBW"".Help the Little Elephant and his friend to find out whether they can use any number of the described operations to turn the board they have into a proper chessboard." 1000
258E "Little Elephant and Tree" "data structures,dfs and similar,trees" "The Little Elephant loves trees very much, he especially loves root trees.He\'s got a tree consisting of n nodes (the nodes are numbered from 1 to n), with root at node number 1. Each node of the tree contains some list of numbers which initially is empty. The Little Elephant wants to apply m operations. On the i-th operation (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) he first adds number i to lists of all nodes of a subtree with the root in node number ai, and then he adds number i to lists of all nodes of the subtree with root in node bi.After applying all operations the Little Elephant wants to count for each node i number ci \xe2\x80\x94 the number of integers j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; j\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i), such that the lists of the i-th and the j-th nodes contain at least one common number.Help the Little Elephant, count numbers ci for him." 2400
258D "Little Elephant and Broken Sorting" dp,math,probabilities "The Little Elephant loves permutations of integers from 1 to n very much. But most of all he loves sorting them. To sort a permutation, the Little Elephant repeatedly swaps some elements. As a result, he must receive a permutation 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n.This time the Little Elephant has permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Its sorting program needs to make exactly m moves, during the i-th move it swaps elements that are at that moment located at the ai-th and the bi-th positions. But the Little Elephant\'s sorting program happened to break down and now on every step it can equiprobably either do nothing or swap the required elements.Now the Little Elephant doesn\'t even hope that the program will sort the permutation, but he still wonders: if he runs the program and gets some permutation, how much will the result of sorting resemble the sorted one? For that help the Little Elephant find the mathematical expectation of the number of permutation inversions after all moves of the program are completed.We\'ll call a pair of integers i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) an inversion in permutatuon p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, if the following inequality holds: pi\xe2\x80\x89>\xe2\x80\x89pj." 2600
258C "Little Elephant and LCM" "binary search,combinatorics,dp,math" "The Little Elephant loves the LCM (least common multiple) operation of a non-empty set of positive integers. The result of the LCM operation of k positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk is the minimum positive integer that is divisible by each of numbers xi.Let\'s assume that there is a sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Let\'s denote their LCMs as lcm(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn) and the maximum of them as max(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn). The Little Elephant considers a sequence b good, if lcm(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn)\xe2\x80\x89=\xe2\x80\x89max(b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn).The Little Elephant has a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Help him find the number of good sequences of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, such that for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the following condition fulfills: 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai. As the answer can be rather large, print the remainder from dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2000
258B "Little Elephant and Elections" "brute force,combinatorics,dp" "There have recently been elections in the zoo. Overall there were 7 main political parties: one of them is the Little Elephant Political Party, 6 other parties have less catchy names.Political parties find their number in the ballot highly important. Overall there are m possible numbers: 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m. Each of these 7 parties is going to be assigned in some way to exactly one number, at that, two distinct parties cannot receive the same number.The Little Elephant Political Party members believe in the lucky digits 4 and 7. They want to evaluate their chances in the elections. For that, they need to find out, how many correct assignments are there, such that the number of lucky digits in the Little Elephant Political Party ballot number is strictly larger than the total number of lucky digits in the ballot numbers of 6 other parties. Help the Little Elephant Political Party, calculate this number. As the answer can be rather large, print the remainder from dividing it by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1900
258A "Little Elephant and Bits" greedy,math "The Little Elephant has an integer a, written in the binary notation. He wants to write this number on a piece of paper.To make sure that the number a fits on the piece of paper, the Little Elephant ought to delete exactly one any digit from number a in the binary record. At that a new number appears. It consists of the remaining binary digits, written in the corresponding order (possible, with leading zeroes).The Little Elephant wants the number he is going to write on the paper to be as large as possible. Help him find the maximum number that he can obtain after deleting exactly one binary digit and print it in the binary notation." 1100
257E "Greedy Elevator" "data structures,implementation" "The m-floor (m\xe2\x80\x89>\xe2\x80\x891) office of international corporation CodeForces has the advanced elevator control system established. It works as follows.All office floors are sequentially numbered with integers from 1 to m. At time t\xe2\x80\x89=\xe2\x80\x890, the elevator is on the first floor, the elevator is empty and nobody is waiting for the elevator on other floors. Next, at times ti (ti\xe2\x80\x89>\xe2\x80\x890) people come to the elevator. For simplicity, we assume that one person uses the elevator only once during the reported interval. For every person we know three parameters: the time at which the person comes to the elevator, the floor on which the person is initially, and the floor to which he wants to go.The movement of the elevator between the floors is as follows. At time t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890, t is an integer) the elevator is always at some floor. First the elevator releases all people who are in the elevator and want to get to the current floor. Then it lets in all the people waiting for the elevator on this floor. If a person comes to the elevator exactly at time t, then he has enough time to get into it. We can assume that all of these actions (going in or out from the elevator) are made instantly. After that the elevator decides, which way to move and at time (t\xe2\x80\x89+\xe2\x80\x891) the elevator gets to the selected floor.The elevator selects the direction of moving by the following algorithm.   If the elevator is empty and at the current time no one is waiting for the elevator on any floor, then the elevator remains at the current floor.  Otherwise, let\'s assume that the elevator is on the floor number x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Then elevator calculates the directions\' ""priorities"" pup and pdown: pup is the sum of the number of people waiting for the elevator on the floors with numbers greater than x, and the number of people in the elevator, who want to get to the floors with the numbers greater than x; pdown is the sum of the number of people waiting for the elevator on the floors with numbers less than x, and the number of people in the elevator, who want to get to the floors with the numbers less than x. If pup\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89pdown, then the elevator goes one floor above the current one (that is, from floor x to floor x\xe2\x80\x89+\xe2\x80\x891), otherwise the elevator goes one floor below the current one (that is, from floor x to floor x\xe2\x80\x89-\xe2\x80\x891). Your task is to simulate the work of the elevator and for each person to tell the time when the elevator will get to the floor this person needs. Please note that the elevator is large enough to accommodate all the people at once." 2200
257D Sum greedy,math "Vasya has found a piece of paper with an array written on it. The array consists of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Vasya noticed that the following condition holds for the array ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7ai for any positive integer i (i\xe2\x80\x89<\xe2\x80\x89n).Vasya wants to add either a ""+"" or a ""-"" before each number of array. Thus, Vasya will get an expression consisting of n summands. The value of the resulting expression is the sum of all its elements. The task is to add signs ""+"" and ""-"" before each number so that the value of expression s meets the limits 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1. Print a sequence of signs ""+"" and ""-"", satisfying the given limits. It is guaranteed that the solution for the problem exists." 1900
257C "View Angle" "brute force,geometry,math" "Flatland has recently introduced a new type of an eye check for the driver\'s licence. The check goes like that: there is a plane with mannequins standing on it. You should tell the value of the minimum angle with the vertex at the origin of coordinates and with all mannequins standing inside or on the boarder of this angle. As you spend lots of time ""glued to the screen"", your vision is impaired. So you have to write a program that will pass the check for you." 1800
257B "Playing Cubes" games,greedy,implementation "Petya and Vasya decided to play a little. They found n red cubes and m blue cubes. The game goes like that: the players take turns to choose a cube of some color (red or blue) and put it in a line from left to right (overall the line will have n\xe2\x80\x89+\xe2\x80\x89m cubes). Petya moves first. Petya\'s task is to get as many pairs of neighbouring cubes of the same color as possible. Vasya\'s task is to get as many pairs of neighbouring cubes of different colors as possible. The number of Petya\'s points in the game is the number of pairs of neighboring cubes of the same color in the line, the number of Vasya\'s points in the game is the number of neighbouring cubes of the different color in the line. Your task is to calculate the score at the end of the game (Petya\'s and Vasya\'s points, correspondingly), if both boys are playing optimally well. To ""play optimally well"" first of all means to maximize the number of one\'s points, and second \xe2\x80\x94 to minimize the number of the opponent\'s points." 1300
257A Sockets greedy,implementation,sortings "Vasya has got many devices that work on electricity. He\'s got n supply-line filters to plug the devices, the i-th supply-line filter has ai sockets.Overall Vasya has got m devices and k electrical sockets in his flat, he can plug the devices or supply-line filters directly. Of course, he can plug the supply-line filter to any other supply-line filter. The device (or the supply-line filter) is considered plugged to electricity if it is either plugged to one of k electrical sockets, or if it is plugged to some supply-line filter that is in turn plugged to electricity. What minimum number of supply-line filters from the given set will Vasya need to plug all the devices he has to electricity? Note that all devices and supply-line filters take one socket for plugging and that he can use one socket to plug either one device or one supply-line filter." 1100
256E "Lucky Arrays" "data structures" "Little Maxim loves interesting problems. He decided to share one such problem with you. Initially there is an array a, consisting of n zeroes. The elements of the array are indexed, starting from 1. Then follow queries to change array a. Each query is characterized by two integers vi,\xe2\x80\x89ti. In the answer to the query we should make the vi-th array element equal ti (avi\xe2\x80\x89=\xe2\x80\x89ti; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89vi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).Maxim thinks that some pairs of integers (x,\xe2\x80\x89y) are good and some are not. Maxim thinks that array a, consisting of n integers, is lucky, if for all integer i, (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) the pair of integers (ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 is good. Note that the order of numbers in the pairs is important, that is, specifically, (1,\xe2\x80\x892)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89(2,\xe2\x80\x891).After each query to change array a Maxim wants to know, how many ways there are to replace all zeroes in array a with integers from one to three so as to make the resulting array (without zeroes) lucky. Of course, distinct zeroes can be replaced by distinct integers.Maxim told you the sequence of queries and all pairs of integers he considers lucky. Help Maxim, solve this problem for him." 2400
256D "Liars and Serge" dp "There are n people, sitting in a line at the table. For each person we know that he always tells either the truth or lies.Little Serge asked them: how many of you always tell the truth? Each of the people at the table knows everything (who is an honest person and who is a liar) about all the people at the table. The honest people are going to say the correct answer, the liars are going to say any integer from 1 to n, which is not the correct answer. Every liar chooses his answer, regardless of the other liars, so two distinct liars may give distinct answer.Serge does not know any information about the people besides their answers to his question. He took a piece of paper and wrote n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the answer of the i-th person in the row. Given this sequence, Serge determined that exactly k people sitting at the table apparently lie.Serge wonders, how many variants of people\'s answers (sequences of answers a of length n) there are where one can say that exactly k people sitting at the table apparently lie. As there can be rather many described variants of answers, count the remainder of dividing the number of the variants by 777777777." 2700
255E "Furlo and Rublo and Game" games,implementation,math "Furlo and Rublo play a game. The table has n piles of coins lying on it, the i-th pile has ai coins. Furlo and Rublo move in turns, Furlo moves first. In one move you are allowed to:  choose some pile, let\'s denote the current number of coins in it as x;  choose some integer y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89<\xe2\x80\x89x; x1\xe2\x80\x89/\xe2\x80\x894\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89/\xe2\x80\x892) and decrease the number of coins in this pile to y. In other words, after the described move the pile will have y coins left. The player who can\'t make a move, loses. Your task is to find out, who wins in the given game if both Furlo and Rublo play optimally well." 2200
255D "Mr. Bender and Square" "binary search,implementation,math" "Mr. Bender has a digital table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n, each cell can be switched on or off. He wants the field to have at least c switched on squares. When this condition is fulfilled, Mr Bender will be happy.We\'ll consider the table rows numbered from top to bottom from 1 to n, and the columns \xe2\x80\x94 numbered from left to right from 1 to n. Initially there is exactly one switched on cell with coordinates (x,\xe2\x80\x89y) (x is the row number, y is the column number), and all other cells are switched off. Then each second we switch on the cells that are off but have the side-adjacent cells that are on.For a cell with coordinates (x,\xe2\x80\x89y) the side-adjacent cells are cells with coordinates (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891), (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891).In how many seconds will Mr. Bender get happy?" 1800
255C "Almost Arithmetical Progression" "brute force,dp" "Gena loves sequences of numbers. Recently, he has discovered a new type of sequences which he called an almost arithmetical progression. A sequence is an almost arithmetical progression, if its elements can be represented as:  a1\xe2\x80\x89=\xe2\x80\x89p, where p is some integer;  ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x891)i\xe2\x80\x89+\xe2\x80\x891\xc2\xb7q (i\xe2\x80\x89>\xe2\x80\x891), where q is some integer. Right now Gena has a piece of paper with sequence b, consisting of n integers. Help Gena, find there the longest subsequence of integers that is an almost arithmetical progression.Sequence s1,\xe2\x80\x89\xe2\x80\x89s2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89sk is a subsequence of sequence b1,\xe2\x80\x89\xe2\x80\x89b2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89bn, if there is such increasing sequence of indexes i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik (1\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89i1\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89i2\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89... \xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89ik\xe2\x80\x89\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89\xe2\x80\x89n), that bij\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89sj. In other words, sequence s can be obtained from b by crossing out some elements." 1500
255B "Code Parsing" implementation "Little Vitaly loves different algorithms. Today he has invented a new algorithm just for you. Vitaly\'s algorithm works with string s, consisting of characters ""x"" and ""y"", and uses two following operations at runtime:  Find two consecutive characters in the string, such that the first of them equals ""y"", and the second one equals ""x"" and swap them. If there are several suitable pairs of characters, we choose the pair of characters that is located closer to the beginning of the string.  Find in the string two consecutive characters, such that the first of them equals ""x"" and the second one equals ""y"". Remove these characters from the string. If there are several suitable pairs of characters, we choose the pair of characters that is located closer to the beginning of the string. The input for the new algorithm is string s, and the algorithm works as follows:  If you can apply at least one of the described operations to the string, go to step 2 of the algorithm. Otherwise, stop executing the algorithm and print the current string.  If you can apply operation 1, then apply it. Otherwise, apply operation 2. After you apply the operation, go to step 1 of the algorithm. Now Vitaly wonders, what is going to be printed as the result of the algorithm\'s work, if the input receives string s." 1200
255A "Greg\'s Workout" implementation "Greg is a beginner bodybuilder. Today the gym coach gave him the training plan. All it had was n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. These numbers mean that Greg needs to do exactly n exercises today. Besides, Greg should repeat the i-th in order exercise ai times.Greg now only does three types of exercises: ""chest"" exercises, ""biceps"" exercises and ""back"" exercises. Besides, his training is cyclic, that is, the first exercise he does is a ""chest"" one, the second one is ""biceps"", the third one is ""back"", the fourth one is ""chest"", the fifth one is ""biceps"", and so on to the n-th exercise.Now Greg wonders, which muscle will get the most exercise during his training. We know that the exercise Greg repeats the maximum number of times, trains the corresponding muscle the most. Help Greg, determine which muscle will get the most training." 800
254E Dormitory dp,implementation "Student Vasya came to study in Berland State University from the country, so he is living in a dormitory. A semester has n days, and in each of those days his parents send him some food. In the morning of the i-th day he receives ai kilograms of food that can be eaten on that day and on the next one (then the food goes bad and becomes unfit for consumption).Every day Vasya eats v kilograms of food. It is known that Vasya\'s parents do not allow him to starve, so there always is enough food for Vasya. Vasya has m friends who sometimes live with him. Let\'s index the friends from 1 to m. Friend number j lives with Vasya from day lj to day rj, inclusive. Also, the j-th friend requires fj kilograms of food per day. Usually Vasya\'s friends eat in the canteen, but sometimes generous Vasya feeds some of them. Every day Vasya can feed some friends who live with him this day (or may feed nobody).Every time Vasya feeds his friend, he gives him as much food as the friend needs for the day, and Vasya\'s popularity rating at the University increases by one. Vasya cannot feed the same friend multiple times in one day. In addition, he knows that eating habits must be regular, so he always eats v kilograms of food per day.Vasya wants so choose whom he will feed each day of the semester to make his rating as high as possible. Originally Vasya\'s rating is 0 because he is a freshman." 2100
254D Rats "brute force,dfs and similar,graphs,implementation,shortest paths" "Rats have bred to hundreds and hundreds in the basement of the store, owned by Vasily Petrovich. Vasily Petrovich may have not noticed their presence, but they got into the habit of sneaking into the warehouse and stealing food from there. Vasily Petrovich cannot put up with it anymore, he has to destroy the rats in the basement. Since mousetraps are outdated and do not help, and rat poison can poison inattentive people as well as rats, he chose a radical way: to blow up two grenades in the basement (he does not have more).In this problem, we will present the shop basement as a rectangular table of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Some of the cells are occupied by walls, and the rest of them are empty. Vasily has been watching the rats and he found out that at a certain time they go to sleep, and all the time they sleep in the same places. He wants to blow up a grenade when this convenient time comes. On the plan of his basement, he marked cells with sleeping rats in them. Naturally, these cells are not occupied by walls.Grenades can only blow up in a cell that is not occupied by a wall. The blast wave from a grenade distributes as follows. We assume that the grenade blast occurs at time 0. During this initial time only the cell where the grenade blew up gets \'clear\'. If at time t some cell is clear, then at time t\xe2\x80\x89+\xe2\x80\x891 those side-neighbouring cells which are not occupied by the walls get clear too (some of them could have been cleared before). The blast wave distributes for exactly d seconds, then it dies immediately.  An example of a distributing blast wave: Picture 1 shows the situation before the blast, and the following pictures show ""clear"" cells by time 0,1,2,3 and 4. Thus, the blast wave on the picture distributes for d\xe2\x80\x89=\xe2\x80\x894 seconds. Vasily Petrovich wonders, whether he can choose two cells to blast the grenades so as to clear all cells with sleeping rats. Write the program that finds it out." 2300
254C Anagram greedy,strings "String x is an anagram of string y, if we can rearrange the letters in string x and get exact string y. For example, strings ""DOG"" and ""GOD"" are anagrams, so are strings ""BABA"" and ""AABB"", but strings ""ABBAC"" and ""CAABA"" are not.You are given two strings s and t of the same length, consisting of uppercase English letters. You need to get the anagram of string t from string s. You are permitted to perform the replacing operation: every operation is replacing some character from the string s by any other character. Get the anagram of string t in the least number of replacing operations. If you can get multiple anagrams of string t in the least number of operations, get the lexicographically minimal one.The lexicographic order of strings is the familiar to us ""dictionary"" order. Formally, the string p of length n is lexicographically smaller than string q of the same length, if p1\xe2\x80\x89=\xe2\x80\x89q1, p2\xe2\x80\x89=\xe2\x80\x89q2, ..., pk\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89qk\xe2\x80\x89-\xe2\x80\x891, pk\xe2\x80\x89<\xe2\x80\x89qk for some k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Here characters in the strings are numbered from 1. The characters of the strings are compared in the alphabetic order." 1800
254B "Jury Size" "brute force,implementation" "In 2013, the writers of Berland State University should prepare problems for n Olympiads. We will assume that the Olympiads are numbered with consecutive integers from 1 to n. For each Olympiad we know how many members of the jury must be involved in its preparation, as well as the time required to prepare the problems for her. Namely, the Olympiad number i should be prepared by pi people for ti days, the preparation for the Olympiad should be a continuous period of time and end exactly one day before the Olympiad. On the day of the Olympiad the juries who have prepared it, already do not work on it.For example, if the Olympiad is held on December 9th and the preparation takes 7 people and 6 days, all seven members of the jury will work on the problems of the Olympiad from December, 3rd to December, 8th (the jury members won\'t be working on the problems of this Olympiad on December 9th, that is, some of them can start preparing problems for some other Olympiad). And if the Olympiad is held on November 3rd and requires 5 days of training, the members of the jury will work from October 29th to November 2nd.In order not to overload the jury the following rule was introduced: one member of the jury can not work on the same day on the tasks for different Olympiads. Write a program that determines what the minimum number of people must be part of the jury so that all Olympiads could be prepared in time." 1500
254A "Cards with Numbers" "constructive algorithms,sortings" "Petya has got 2n cards, each card contains some integer. The numbers on the cards can be the same. Let\'s index all cards by consecutive integers from 1 to 2n. We\'ll denote the number that is written on a card with number i, as ai. In order to play one entertaining game with his friends, Petya needs to split the cards into pairs so that each pair had equal numbers on the cards. Help Petya do that." 1200
253E Printer "binary search,data structures,implementation,sortings" "Let\'s consider a network printer that functions like that. It starts working at time 0. In each second it can print one page of a text. At some moments of time the printer receives printing tasks. We know that a printer received n tasks. Let\'s number the tasks by consecutive integers from 1 to n. Then the task number i is characterised by three integers: ti is the time when the task came, si is the task\'s volume (in pages) and pi is the task\'s priority. The priorities of all tasks are distinct.When the printer receives a task, the task goes to the queue and remains there until all pages from this task are printed. The printer chooses a page to print each time when it either stops printing some page or when it is free and receives a new task. Among all tasks that are in the queue at this moment, the printer chooses the task with the highest priority and next second prints an unprinted page from this task. You can assume that a task goes to the queue immediately, that\'s why if a task has just arrived by time t, the printer can already choose it for printing.You are given full information about all tasks except for one: you don\'t know this task\'s priority. However, we know the time when the last page from this task was finished printing. Given this information, find the unknown priority value and determine the moments of time when the printer finished printing each task." 2200
253D "Table with Letters - 2" "brute force,two pointers" "Vasya has recently started to learn English. Now he needs to remember how to write English letters. He isn\'t sure about some of them, so he decided to train a little.He found a sheet of squared paper and began writing arbitrary English letters there. In the end Vasya wrote n lines containing m characters each. Thus, he got a rectangular n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table, each cell of the table contained some English letter. Let\'s number the table rows from top to bottom with integers from 1 to n, and columns \xe2\x80\x94 from left to right with integers from 1 to m.After that Vasya looked at the resulting rectangular table and wondered, how many subtables are there, that matches both following conditions:  the subtable contains at most k cells with ""a"" letter;  all letters, located in all four corner cells of the subtable, are equal.  Formally, a subtable\'s definition is as follows. It is defined by four integers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1\xe2\x80\x89<\xe2\x80\x89x2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1\xe2\x80\x89<\xe2\x80\x89y2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m. Then the subtable contains all such cells (x,\xe2\x80\x89y) (x is the row number, y is the column number), for which the following inequality holds x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2,\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2. The corner cells of the table are cells (x1,\xe2\x80\x89y1), (x1,\xe2\x80\x89y2), (x2,\xe2\x80\x89y1), (x2,\xe2\x80\x89y2).Vasya is already too tired after he\'s been writing letters to a piece of paper. That\'s why he asks you to count the value he is interested in." 2000
253C "Text Editor" "data structures,dfs and similar,graphs,greedy,shortest paths" "Vasya is pressing the keys on the keyboard reluctantly, squeezing out his ideas on the classical epos depicted in Homer\'s Odysseus... How can he explain to his literature teacher that he isn\'t going to become a writer? In fact, he is going to become a programmer. So, he would take great pleasure in writing a program, but none \xe2\x80\x94 in writing a composition.As Vasya was fishing for a sentence in the dark pond of his imagination, he suddenly wondered: what is the least number of times he should push a key to shift the cursor from one position to another one?Let\'s describe his question more formally: to type a text, Vasya is using the text editor. He has already written n lines, the i-th line contains ai characters (including spaces). If some line contains k characters, then this line overall contains (k\xe2\x80\x89+\xe2\x80\x891) positions where the cursor can stand: before some character or after all characters (at the end of the line). Thus, the cursor\'s position is determined by a pair of integers (r,\xe2\x80\x89c), where r is the number of the line and c is the cursor\'s position in the line (the positions are indexed starting from one from the beginning of the line).Vasya doesn\'t use the mouse to move the cursor. He uses keys ""Up"", ""Down"", ""Right"" and ""Left"". When he pushes each of these keys, the cursor shifts in the needed direction. Let\'s assume that before the corresponding key is pressed, the cursor was located in the position (r,\xe2\x80\x89c), then Vasya pushed key: ""Up"": if the cursor was located in the first line (r\xe2\x80\x89=\xe2\x80\x891), then it does not move. Otherwise, it moves to the previous line (with number r\xe2\x80\x89-\xe2\x80\x891), to the same position. At that, if the previous line was short, that is, the cursor couldn\'t occupy position c there, the cursor moves to the last position of the line with number r\xe2\x80\x89-\xe2\x80\x891; ""Down"": if the cursor was located in the last line (r\xe2\x80\x89=\xe2\x80\x89n), then it does not move. Otherwise, it moves to the next line (with number r\xe2\x80\x89+\xe2\x80\x891), to the same position. At that, if the next line was short, that is, the cursor couldn\'t occupy position c there, the cursor moves to the last position of the line with number r\xe2\x80\x89+\xe2\x80\x891; ""Right"": if the cursor can move to the right in this line (c\xe2\x80\x89<\xe2\x80\x89ar\xe2\x80\x89+\xe2\x80\x891), then it moves to the right (to position c\xe2\x80\x89+\xe2\x80\x891). Otherwise, it is located at the end of the line and doesn\'t move anywhere when Vasya presses the ""Right"" key; ""Left"": if the cursor can move to the left in this line (c\xe2\x80\x89>\xe2\x80\x891), then it moves to the left (to position c\xe2\x80\x89-\xe2\x80\x891). Otherwise, it is located at the beginning of the line and doesn\'t move anywhere when Vasya presses the ""Left"" key.You\'ve got the number of lines in the text file and the number of characters, written in each line of this file. Find the least number of times Vasya should push the keys, described above, to shift the cursor from position (r1,\xe2\x80\x89c1) to position (r2,\xe2\x80\x89c2)." 1600
253B "Physics Practical" "binary search,dp,sortings,two pointers" "One day Vasya was on a physics practical, performing the task on measuring the capacitance. He followed the teacher\'s advice and did as much as n measurements, and recorded the results in the notebook. After that he was about to show the results to the teacher, but he remembered that at the last lesson, the teacher had made his friend Petya redo the experiment because the largest and the smallest results differed by more than two times. Vasya is lazy, and he does not want to redo the experiment. He wants to do the task and go home play computer games. So he decided to cheat: before Vasya shows the measurements to the teacher, he will erase some of them, so as to make the largest and the smallest results of the remaining measurements differ in no more than two times. In other words, if the remaining measurements have the smallest result x, and the largest result y, then the inequality y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7x must fulfill. Of course, to avoid the teacher\'s suspicion, Vasya wants to remove as few measurement results as possible from his notes.Help Vasya, find what minimum number of measurement results he will have to erase from his notes so that the largest and the smallest of the remaining results of the measurements differed in no more than two times." 1400
253A "Boys and Girls" greedy "There are n boys and m girls studying in the class. They should stand in a line so that boys and girls alternated there as much as possible. Let\'s assume that positions in the line are indexed from left to right by numbers from 1 to n\xe2\x80\x89+\xe2\x80\x89m. Then the number of integers i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n\xe2\x80\x89+\xe2\x80\x89m) such that positions with indexes i and i\xe2\x80\x89+\xe2\x80\x891 contain children of different genders (position i has a girl and position i\xe2\x80\x89+\xe2\x80\x891 has a boy or vice versa) must be as large as possible. Help the children and tell them how to form the line." 1100
252B "Unsorting Array" "brute force,sortings" "Little Petya likes arrays of integers a lot. Recently his mother has presented him one such array consisting of n elements. Petya is now wondering whether he can swap any two distinct integers in the array so that the array got unsorted. Please note that Petya can not swap equal integers even if they are in distinct positions in the array. Also note that Petya must swap some two integers even if the original array meets all requirements.Array a (the array elements are indexed from 1) consisting of n elements is called sorted if it meets at least one of the following two conditions:  a1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89an;  a1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89a2\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89an. Help Petya find the two required positions to swap or else say that they do not exist." 1800
252A "Little Xor" "brute force,implementation" "Little Petya likes arrays that consist of non-negative integers a lot. Recently his mom has presented him one such array consisting of n elements. Petya immediately decided to find there a segment of consecutive elements, such that the xor of all numbers from this segment was maximal possible. Help him with that.The xor operation is the bitwise exclusive ""OR"", that is denoted as ""xor"" in Pascal and ""^"" in C/C++/Java." 1100
251E "Tree and Table" "dfs and similar,dp,implementation,trees" "Little Petya likes trees a lot. Recently his mother has presented him a tree with 2n nodes. Petya immediately decided to place this tree on a rectangular table consisting of 2 rows and n columns so as to fulfill the following conditions:  Each cell of the table corresponds to exactly one tree node and vice versa, each tree node corresponds to exactly one table cell.  If two tree nodes are connected by an edge, then the corresponding cells have a common side. Now Petya wonders how many ways are there to place his tree on the table. He calls two placements distinct if there is a tree node which corresponds to distinct table cells in these two placements. Since large numbers can scare Petya, print the answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 3000
251D "Two Sets" bitmasks,math "Little Petya likes numbers a lot. Recently his mother has presented him a collection of n non-negative integers. There\'s only one thing Petya likes more than numbers: playing with little Masha. He immediately decided to give a part of his new collection to her. To make the game even more interesting, Petya decided to give Masha such collection of numbers for which the following conditions fulfill:  Let\'s introduce x1 to denote the xor of all numbers Petya has got left; and let\'s introduce x2 to denote the xor of all numbers he gave to Masha. Value (x1\xe2\x80\x89+\xe2\x80\x89x2) must be as large as possible.  If there are multiple ways to divide the collection so that the previous condition fulfilled, then Petya minimizes the value x1. The xor operation is a bitwise excluding ""OR"", that is denoted as ""xor"" in the Pascal language and ""^"" in C/C++/Java.Help Petya divide the collection as described above. If there are multiple suitable ways to divide it, find any of them. Please note that after Petya gives a part of his numbers to Masha, he may have no numbers left. The reverse situation is also possible, when Petya gives nothing to Masha. In both cases we must assume that the xor of an empty set of numbers equals 0." 2700
251C "Number Transformation" "dp,greedy,number theory" "Little Petya likes positive integers a lot. Recently his mom has presented him a positive integer a. There\'s only one thing Petya likes more than numbers: playing with little Masha. It turned out that Masha already has a positive integer b. Petya decided to turn his number a into the number b consecutively performing the operations of the following two types:  Subtract 1 from his number.  Choose any integer x from 2 to k, inclusive. Then subtract number (a mod x) from his number a. Operation a mod x means taking the remainder from division of number a by number x. Petya performs one operation per second. Each time he chooses an operation to perform during the current move, no matter what kind of operations he has performed by that moment. In particular, this implies that he can perform the same operation any number of times in a row.Now he wonders in what minimum number of seconds he could transform his number a into number b. Please note that numbers x in the operations of the second type are selected anew each time, independently of each other." 2000
251B "Playing with Permutations" implementation,math "Little Petya likes permutations a lot. Recently his mom has presented him permutation q1,\xe2\x80\x89q2,\xe2\x80\x89...,\xe2\x80\x89qn of length n.A permutation a of length n is a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), all integers there are distinct. There is only one thing Petya likes more than permutations: playing with little Masha. As it turns out, Masha also has a permutation of length n. Petya decided to get the same permutation, whatever the cost may be. For that, he devised a game with the following rules:  Before the beginning of the game Petya writes permutation 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n on the blackboard. After that Petya makes exactly k moves, which are described below.  During a move Petya tosses a coin. If the coin shows heads, he performs point 1, if the coin shows tails, he performs point 2.  Let\'s assume that the board contains permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn at the given moment. Then Petya removes the written permutation p from the board and writes another one instead: pq1,\xe2\x80\x89pq2,\xe2\x80\x89...,\xe2\x80\x89pqn. In other words, Petya applies permutation q (which he has got from his mother) to permutation p.  All actions are similar to point 1, except that Petya writes permutation t on the board, such that: tqi\xe2\x80\x89=\xe2\x80\x89pi for all i from 1 to n. In other words, Petya applies a permutation that is inverse to q to permutation p. We know that after the k-th move the board contained Masha\'s permutation s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn. Besides, we know that throughout the game process Masha\'s permutation never occurred on the board before the k-th move. Note that the game has exactly k moves, that is, throughout the game the coin was tossed exactly k times.Your task is to determine whether the described situation is possible or else state that Petya was mistaken somewhere. See samples and notes to them for a better understanding." 1800
251A "Points on Line" "binary search,combinatorics,two pointers" "Little Petya likes points a lot. Recently his mom has presented him n points lying on the line OX. Now Petya is wondering in how many ways he can choose three distinct points so that the distance between the two farthest of them doesn\'t exceed d.Note that the order of the points inside the group of three chosen points doesn\'t matter." 1300
250E "Mad Joe" "brute force" "Joe has been hurt on the Internet. Now he is storming around the house, destroying everything in his path.Joe\'s house has n floors, each floor is a segment of m cells. Each cell either contains nothing (it is an empty cell), or has a brick or a concrete wall (always something one of three). It is believed that each floor is surrounded by a concrete wall on the left and on the right.Now Joe is on the n-th floor and in the first cell, counting from left to right. At each moment of time, Joe has the direction of his gaze, to the right or to the left (always one direction of the two). Initially, Joe looks to the right.Joe moves by a particular algorithm. Every second he makes one of the following actions:   If the cell directly under Joe is empty, then Joe falls down. That is, he moves to this cell, the gaze direction is preserved.  Otherwise consider the next cell in the current direction of the gaze.   If the cell is empty, then Joe moves into it, the gaze direction is preserved.  If this cell has bricks, then Joe breaks them with his forehead (the cell becomes empty), and changes the direction of his gaze to the opposite.  If this cell has a concrete wall, then Joe just changes the direction of his gaze to the opposite (concrete can withstand any number of forehead hits).  Joe calms down as soon as he reaches any cell of the first floor.The figure below shows an example Joe\'s movements around the house.  Determine how many seconds Joe will need to calm down." 2000
250D "Building Bridge" "geometry,ternary search,two pointers" "Two villages are separated by a river that flows from the north to the south. The villagers want to build a bridge across the river to make it easier to move across the villages.The river banks can be assumed to be vertical straight lines x\xe2\x80\x89=\xe2\x80\x89a and x\xe2\x80\x89=\xe2\x80\x89b (0\xe2\x80\x89<\xe2\x80\x89a\xe2\x80\x89<\xe2\x80\x89b).The west village lies in a steppe at point O\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x890). There are n pathways leading from the village to the river, they end at points Ai\xe2\x80\x89=\xe2\x80\x89(a,\xe2\x80\x89yi). The villagers there are plain and simple, so their pathways are straight segments as well.The east village has reserved and cunning people. Their village is in the forest on the east bank of the river, but its exact position is not clear. There are m twisted paths leading from this village to the river and ending at points Bi\xe2\x80\x89=\xe2\x80\x89(b,\xe2\x80\x89y\'i). The lengths of all these paths are known, the length of the path that leads from the eastern village to point Bi, equals li.The villagers want to choose exactly one point on the left bank of river Ai, exactly one point on the right bank Bj and connect them by a straight-line bridge so as to make the total distance between the villages (the sum of |OAi|\xe2\x80\x89+\xe2\x80\x89|AiBj|\xe2\x80\x89+\xe2\x80\x89lj, where |XY| is the Euclidean distance between points X and Y) were minimum. The Euclidean distance between points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) equals .Help them and find the required pair of points." 1900
250C "Movie Critics" greedy "A film festival is coming up in the city N. The festival will last for exactly n days and each day will have a premiere of exactly one film. Each film has a genre \xe2\x80\x94 an integer from 1 to k.On the i-th day the festival will show a movie of genre ai. We know that a movie of each of k genres occurs in the festival programme at least once. In other words, each integer from 1 to k occurs in the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an at least once.Valentine is a movie critic. He wants to watch some movies of the festival and then describe his impressions on his site.As any creative person, Valentine is very susceptive. After he watched the movie of a certain genre, Valentine forms the mood he preserves until he watches the next movie. If the genre of the next movie is the same, it does not change Valentine\'s mood. If the genres are different, Valentine\'s mood changes according to the new genre and Valentine has a stress.Valentine can\'t watch all n movies, so he decided to exclude from his to-watch list movies of one of the genres. In other words, Valentine is going to choose exactly one of the k genres and will skip all the movies of this genre. He is sure to visit other movies.Valentine wants to choose such genre x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k), that the total number of after-movie stresses (after all movies of genre x are excluded) were minimum." 1600
250B "Restoring IPv6" implementation,strings "An IPv6-address is a 128-bit number. For convenience, this number is recorded in blocks of 16 bits in hexadecimal record, the blocks are separated by colons \xe2\x80\x94 8 blocks in total, each block has four hexadecimal digits. Here is an example of the correct record of a IPv6 address: ""0124:5678:90ab:cdef:0124:5678:90ab:cdef"". We\'ll call such format of recording an IPv6-address full.Besides the full record of an IPv6 address there is a short record format. The record of an IPv6 address can be shortened by removing one or more leading zeroes at the beginning of each block. However, each block should contain at least one digit in the short format. For example, the leading zeroes can be removed like that: ""a56f:00d3:0000:0124:0001:f19a:1000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:d3:0:0124:01:f19a:1000:00"". There are more ways to shorten zeroes in this IPv6 address.Some IPv6 addresses contain long sequences of zeroes. Continuous sequences of 16-bit zero blocks can be shortened to ""::"". A sequence can consist of one or several consecutive blocks, with all 16 bits equal to 0. You can see examples of zero block shortenings below:  ""a56f:00d3:0000:0124:0001:0000:0000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:00d3:0000:0124:0001::"";  ""a56f:0000:0000:0124:0001:0000:1234:0ff0"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f::0124:0001:0000:1234:0ff0"";  ""a56f:0000:0000:0000:0001:0000:1234:0ff0"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:0000::0000:0001:0000:1234:0ff0"";  ""a56f:00d3:0000:0124:0001:0000:0000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""a56f:00d3:0000:0124:0001::0000"";  ""0000:0000:0000:0000:0000:0000:0000:0000"" \xe2\x80\x89\xe2\x86\x92\xe2\x80\x89 ""::"". It is not allowed to shorten zero blocks in the address more than once. This means that the short record can\'t contain the sequence of characters ""::"" more than once. Otherwise, it will sometimes be impossible to determine the number of zero blocks, each represented by a double colon.The format of the record of the IPv6 address after removing the leading zeroes and shortening the zero blocks is called short.You\'ve got several short records of IPv6 addresses. Restore their full record." 1500
250A "Paper Work" greedy "Polycarpus has been working in the analytic department of the ""F.R.A.U.D."" company for as much as n days. Right now his task is to make a series of reports about the company\'s performance for the last n days. We know that the main information in a day report is value ai, the company\'s profit on the i-th day. If ai is negative, then the company suffered losses on the i-th day.Polycarpus should sort the daily reports into folders. Each folder should include data on the company\'s performance for several consecutive days. Of course, the information on each of the n days should be exactly in one folder. Thus, Polycarpus puts information on the first few days in the first folder. The information on the several following days goes to the second folder, and so on.It is known that the boss reads one daily report folder per day. If one folder has three or more reports for the days in which the company suffered losses (ai\xe2\x80\x89<\xe2\x80\x890), he loses his temper and his wrath is terrible.Therefore, Polycarpus wants to prepare the folders so that none of them contains information on three or more days with the loss, and the number of folders is minimal.Write a program that, given sequence ai, will print the minimum number of folders." 1000
249E "Endless Matrix" math "A Russian space traveller Alisa Selezneva, like any other schoolgirl of the late 21 century, is interested in science. She has recently visited the MIT (Moscow Institute of Time), where its chairman and the co-inventor of the time machine academician Petrov told her about the construction of a time machine.During the demonstration of the time machine performance Alisa noticed that the machine does not have high speed and the girl got interested in the reason for such disadvantage. As it turns out on closer examination, one of the problems that should be solved for the time machine isn\'t solved by an optimal algorithm. If you find a way to solve this problem optimally, the time machine will run faster and use less energy.A task that none of the staff can solve optimally is as follows. There exists a matrix a, which is filled by the following rule:The cells are consecutive positive integers, starting with one. Besides, ai,\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89at,\xe2\x80\x89k (i,\xe2\x80\x89j,\xe2\x80\x89t,\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891), if:  max(i,\xe2\x80\x89j)\xe2\x80\x89<\xe2\x80\x89max(t,\xe2\x80\x89k);  max(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89max(t,\xe2\x80\x89k) and j\xe2\x80\x89<\xe2\x80\x89k;  max(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89max(t,\xe2\x80\x89k), j\xe2\x80\x89=\xe2\x80\x89k and i\xe2\x80\x89>\xe2\x80\x89t. So, after the first 36 numbers are inserted, matrix a will look as follows:  To solve the problem, you should learn to find rather quickly for the given values of x1,\xe2\x80\x89y1,\xe2\x80\x89x2 and y2 (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2,\xe2\x80\x89y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2) the meaning of expression:As the meaning of this expression can be large enough, it is sufficient to know only the last 10 digits of the sought value.So, no one in MTI can solve the given task. Alice was brave enough to use the time machine and travel the past to help you.Your task is to write a program that uses the given values x1,\xe2\x80\x89y1,\xe2\x80\x89x2 and y2 finds the last 10 digits of the given expression." 2600
249D "Donkey and Stars" "data structures,dp,geometry,math,sortings" "In the evenings Donkey would join Shrek to look at the stars. They would sit on a log, sipping tea and they would watch the starry sky. The sky hung above the roof, right behind the chimney. Shrek\'s stars were to the right of the chimney and the Donkey\'s stars were to the left. Most days the Donkey would just count the stars, so he knew that they are exactly n. This time he wanted a challenge. He imagined a coordinate system: he put the origin of the coordinates at the intersection of the roof and the chimney, directed the OX axis to the left along the roof and the OY axis \xe2\x80\x94 up along the chimney (see figure). The Donkey imagined two rays emanating from he origin of axes at angles \xce\xb11 and \xce\xb12 to the OX axis.  Now he chooses any star that lies strictly between these rays. After that he imagines more rays that emanate from this star at the same angles \xce\xb11 and \xce\xb12 to the OX axis and chooses another star that lies strictly between the new rays. He repeats the operation as long as there still are stars he can choose between the rays that emanate from a star.   As a result, the Donkey gets a chain of stars. He can consecutively get to each star if he acts by the given rules.Your task is to find the maximum number of stars m that the Donkey\'s chain can contain.Note that the chain must necessarily start in the point of the origin of the axes, that isn\'t taken into consideration while counting the number m of stars in the chain." 2700
248E "Piglet\'s Birthday" dp,math,probabilities "Piglet has got a birthday today. His friend Winnie the Pooh wants to make the best present for him \xe2\x80\x94 a honey pot. Of course Winnie realizes that he won\'t manage to get the full pot to Piglet. In fact, he is likely to eat all the honey from the pot. And as soon as Winnie planned a snack on is way, the pot should initially have as much honey as possible. The day before Winnie the Pooh replenished his honey stocks. Winnie-the-Pooh has n shelves at home, each shelf contains some, perhaps zero number of honey pots. During the day Winnie came to the honey shelves q times; on the i-th time he came to some shelf ui, took from it some pots ki, tasted the honey from each pot and put all those pots on some shelf vi. As Winnie chose the pots, he followed his intuition. And that means that among all sets of ki pots on shelf ui, he equiprobably chooses one.Now Winnie remembers all actions he performed with the honey pots. He wants to take to the party the pot he didn\'t try the day before. For that he must know the mathematical expectation of the number m of shelves that don\'t have a single untasted pot. To evaluate his chances better, Winnie-the-Pooh wants to know the value m after each action he performs.Your task is to write a program that will find those values for him." 2600
248D "Sweets for Everyone!" "binary search,greedy,implementation" "For he knew every Who down in Whoville beneath, Was busy now, hanging a mistletoe wreath. ""And they\'re hanging their stockings!"" he snarled with a sneer, ""Tomorrow is Christmas! It\'s practically here!""Dr. Suess, How The Grinch Stole ChristmasChristmas celebrations are coming to Whoville. Cindy Lou Who and her parents Lou Lou Who and Betty Lou Who decided to give sweets to all people in their street. They decided to give the residents of each house on the street, one kilogram of sweets. So they need as many kilos of sweets as there are homes on their street.The street, where the Lou Who family lives can be represented as n consecutive sections of equal length. You can go from any section to a neighbouring one in one unit of time. Each of the sections is one of three types: an empty piece of land, a house or a shop. Cindy Lou and her family can buy sweets in a shop, but no more than one kilogram of sweets in one shop (the vendors care about the residents of Whoville not to overeat on sweets).After the Lou Who family leave their home, they will be on the first section of the road. To get to this section of the road, they also require one unit of time. We can assume that Cindy and her mom and dad can carry an unlimited number of kilograms of sweets. Every time they are on a house section, they can give a kilogram of sweets to the inhabitants of the house, or they can simply move to another section. If the family have already given sweets to the residents of a house, they can\'t do it again. Similarly, if they are on the shop section, they can either buy a kilo of sweets in it or skip this shop. If they\'ve bought a kilo of sweets in a shop, the seller of the shop remembered them and the won\'t sell them a single candy if they come again. The time to buy and give sweets can be neglected. The Lou Whos do not want the people of any house to remain without food.The Lou Whos want to spend no more than t time units of time to give out sweets, as they really want to have enough time to prepare for the Christmas celebration. In order to have time to give all the sweets, they may have to initially bring additional k kilos of sweets.Cindy Lou wants to know the minimum number of k kilos of sweets they need to take with them, to have time to give sweets to the residents of each house in their street.Your task is to write a program that will determine the minimum possible value of k." 2300
248C Robo-Footballer "binary search,geometry" "It\'s a beautiful April day and Wallace is playing football with his friends. But his friends do not know that Wallace actually stayed home with Gromit and sent them his robotic self instead. Robo-Wallace has several advantages over the other guys. For example, he can hit the ball directly to the specified point. And yet, the notion of a giveaway is foreign to him. The combination of these features makes the Robo-Wallace the perfect footballer \xe2\x80\x94 as soon as the ball gets to him, he can just aim and hit the goal. He followed this tactics in the first half of the match, but he hit the goal rarely. The opposing team has a very good goalkeeper who catches most of the balls that fly directly into the goal. But Robo-Wallace is a quick thinker, he realized that he can cheat the goalkeeper. After all, they are playing in a football box with solid walls. Robo-Wallace can kick the ball to the other side, then the goalkeeper will not try to catch the ball. Then, if the ball bounces off the wall and flies into the goal, the goal will at last be scored.Your task is to help Robo-Wallace to detect a spot on the wall of the football box, to which the robot should kick the ball, so that the ball bounces once and only once off this wall and goes straight to the goal. In the first half of the match Robo-Wallace got a ball in the head and was severely hit. As a result, some of the schemes have been damaged. Because of the damage, Robo-Wallace can only aim to his right wall (Robo-Wallace is standing with his face to the opposing team\'s goal).The football box is rectangular. Let\'s introduce a two-dimensional coordinate system so that point (0, 0) lies in the lower left corner of the field, if you look at the box above. Robo-Wallace is playing for the team, whose goal is to the right. It is an improvised football field, so the gate of Robo-Wallace\'s rivals may be not in the middle of the left wall.  In the given coordinate system you are given:   y1, y2 \xe2\x80\x94 the y-coordinates of the side pillars of the goalposts of robo-Wallace\'s opponents;  yw \xe2\x80\x94 the y-coordinate of the wall to which Robo-Wallace is aiming;  xb, yb \xe2\x80\x94 the coordinates of the ball\'s position when it is hit;  r \xe2\x80\x94 the radius of the ball. A goal is scored when the center of the ball crosses the OY axis in the given coordinate system between (0, y1) and (0, y2). The ball moves along a straight line. The ball\'s hit on the wall is perfectly elastic (the ball does not shrink from the hit), the angle of incidence equals the angle of reflection. If the ball bounces off the wall not to the goal, that is, if it hits the other wall or the goal post, then the opposing team catches the ball and Robo-Wallace starts looking for miscalculation and gets dysfunctional. Such an outcome, if possible, should be avoided. We assume that the ball touches an object, if the distance from the center of the ball to the object is no greater than the ball radius r." 2000
248B "Chilly Willy" "math,number theory" "Chilly Willy loves playing with numbers. He only knows prime numbers that are digits yet. These numbers are 2, 3, 5 and 7. But Willy grew rather bored of such numbers, so he came up with a few games that were connected with them.Chilly Willy wants to find the minimum number of length n, such that it is simultaneously divisible by all numbers Willy already knows (2, 3, 5 and 7). Help him with that.A number\'s length is the number of digits in its decimal representation without leading zeros." 1400
248A Cupboards implementation "One foggy Stockholm morning, Karlsson decided to snack on some jam in his friend Lillebror Svantenson\'s house. Fortunately for Karlsson, there wasn\'t anybody in his friend\'s house. Karlsson was not going to be hungry any longer, so he decided to get some food in the house.Karlsson\'s gaze immediately fell on n wooden cupboards, standing in the kitchen. He immediately realized that these cupboards have hidden jam stocks. Karlsson began to fly greedily around the kitchen, opening and closing the cupboards\' doors, grab and empty all the jars of jam that he could find.And now all jars of jam are empty, Karlsson has had enough and does not want to leave traces of his stay, so as not to let down his friend. Each of the cupboards has two doors: the left one and the right one. Karlsson remembers that when he rushed to the kitchen, all the cupboards\' left doors were in the same position (open or closed), similarly, all the cupboards\' right doors were in the same position (open or closed). Karlsson wants the doors to meet this condition as well by the time the family returns. Karlsson does not remember the position of all the left doors, also, he cannot remember the position of all the right doors. Therefore, it does not matter to him in what position will be all left or right doors. It is important to leave all the left doors in the same position, and all the right doors in the same position. For example, all the left doors may be closed, and all the right ones may be open.Karlsson needs one second to open or close a door of a cupboard. He understands that he has very little time before the family returns, so he wants to know the minimum number of seconds t, in which he is able to bring all the cupboard doors in the required position.Your task is to write a program that will determine the required number of seconds t." 800
246E "Blood Cousins Return" "binary search,data structures,dfs and similar,dp,sortings" "Polycarpus got hold of a family tree. The found tree describes the family relations of n people, numbered from 1 to n. Every person in this tree has at most one direct ancestor. Also, each person in the tree has a name, the names are not necessarily unique.We call the man with a number a a 1-ancestor of the man with a number b, if the man with a number a is a direct ancestor of the man with a number b.We call the man with a number a a k-ancestor (k\xe2\x80\x89>\xe2\x80\x891) of the man with a number b, if the man with a number b has a 1-ancestor, and the man with a number a is a (k\xe2\x80\x89-\xe2\x80\x891)-ancestor of the 1-ancestor of the man with a number b.In the tree the family ties do not form cycles. In other words there isn\'t a person who is his own direct or indirect ancestor (that is, who is an x-ancestor of himself, for some x, x\xe2\x80\x89>\xe2\x80\x890).We call a man with a number a the k-son of the man with a number b, if the man with a number b is a k-ancestor of the man with a number a.Polycarpus is very much interested in how many sons and which sons each person has. He took a piece of paper and wrote m pairs of numbers vi, ki. Help him to learn for each pair vi, ki the number of distinct names among all names of the ki-sons of the man with number vi." 2400
246D "Colorful Graph" "brute force,dfs and similar,graphs" "You\'ve got an undirected graph, consisting of n vertices and m edges. We will consider the graph\'s vertices numbered with integers from 1 to n. Each vertex of the graph has a color. The color of the i-th vertex is an integer ci.Let\'s consider all vertices of the graph, that are painted some color k. Let\'s denote a set of such as V(k). Let\'s denote the value of the neighbouring color diversity for color k as the cardinality of the set Q(k)\xe2\x80\x89=\xe2\x80\x89{cu :\xe2\x80\x89 cu\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89k and there is vertex v belonging to set V(k) such that nodes v and u are connected by an edge of the graph}.Your task is to find such color k, which makes the cardinality of set Q(k) maximum. In other words, you want to find the color that has the most diverse neighbours. Please note, that you want to find such color k, that the graph has at least one vertex with such color." 1600
246C "Beauty Pageant" "brute force,constructive algorithms,greedy" "General Payne has a battalion of n soldiers. The soldiers\' beauty contest is coming up, it will last for k days. Payne decided that his battalion will participate in the pageant. Now he has choose the participants.All soldiers in the battalion have different beauty that is represented by a positive integer. The value ai represents the beauty of the i-th soldier.On each of k days Generals has to send a detachment of soldiers to the pageant. The beauty of the detachment is the sum of the beauties of the soldiers, who are part of this detachment. Payne wants to surprise the jury of the beauty pageant, so each of k days the beauty of the sent detachment should be unique. In other words, all k beauties of the sent detachments must be distinct numbers.Help Payne choose k detachments of different beauties for the pageant. Please note that Payne cannot just forget to send soldiers on one day, that is, the detachment of soldiers he sends to the pageant should never be empty." 1600
246B "Increase and Decrease" greedy,math "Polycarpus has an array, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Polycarpus likes it when numbers in an array match. That\'s why he wants the array to have as many equal numbers as possible. For that Polycarpus performs the following operation multiple times:  he chooses two elements of the array ai, aj (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j);  he simultaneously increases number ai by 1 and decreases number aj by 1, that is, executes ai\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 and aj\xe2\x80\x89=\xe2\x80\x89aj\xe2\x80\x89-\xe2\x80\x891. The given operation changes exactly two distinct array elements. Polycarpus can apply the described operation an infinite number of times. Now he wants to know what maximum number of equal array elements he can get if he performs an arbitrary number of such operation. Help Polycarpus." 1300
246A "Buggy Sorting" "constructive algorithms,greedy,sortings" "Little boy Valera studies an algorithm of sorting an integer array. After studying the theory, he went on to the practical tasks. As a result, he wrote a program that sorts an array of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an in the non-decreasing order. The pseudocode of the program, written by Valera, is given below. The input of the program gets number n and array a.loop integer variable i from 1 to n\xe2\x80\x89-\xe2\x80\x891    loop integer variable j from i to n\xe2\x80\x89-\xe2\x80\x891        if (aj\xe2\x80\x89>\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x891), then swap the values of elements aj and aj\xe2\x80\x89+\xe2\x80\x891But Valera could have made a mistake, because he hasn\'t yet fully learned the sorting algorithm. If Valera made a mistake in his program, you need to give a counter-example that makes his program work improperly (that is, the example that makes the program sort the array not in the non-decreasing order). If such example for the given value of n doesn\'t exist, print -1." 900
245H "Queries for Number of Palindromes" dp,hashing,strings "You\'ve got a string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| of length |s|, consisting of lowercase English letters. There also are q queries, each query is described by two integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). The answer to the query is the number of substrings of string s[li... ri], which are palindromes.String s[l... r]\xe2\x80\x89=\xe2\x80\x89slsl\xe2\x80\x89+\xe2\x80\x891... sr (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) is a substring of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|.String t is called a palindrome, if it reads the same from left to right and from right to left. Formally, if t\xe2\x80\x89=\xe2\x80\x89t1t2... t|t|\xe2\x80\x89=\xe2\x80\x89t|t|t|t|\xe2\x80\x89-\xe2\x80\x891... t1." 1800
245G "Suggested Friends" "brute force,graphs" "Polycarpus works as a programmer in a start-up social network. His boss gave his a task to develop a mechanism for determining suggested friends. Polycarpus thought much about the task and came to the folowing conclusion. Let\'s say that all friendship relationships in a social network are given as m username pairs ai,\xe2\x80\x89bi (ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi). Each pair ai,\xe2\x80\x89bi means that users ai and bi are friends. Friendship is symmetric, that is, if ai is friends with bi, then bi is also friends with ai. User y is a suggested friend for user x, if the following conditions are met:  x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y;  x and y aren\'t friends;  among all network users who meet the first two conditions, user y has most of all common friends with user x. User z is a common friend of user x and user y (z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x,\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y), if x and z are friends, and y and z are also friends. Your task is to help Polycarpus to implement a mechanism for determining suggested friends." 2200
245F "Log Stream Analysis" "binary search,brute force,implementation,strings" "You\'ve got a list of program warning logs. Each record of a log stream is a string in this format:  ""2012-MM-DD HH:MM:SS:MESSAGE"" (without the quotes). String ""MESSAGE"" consists of spaces, uppercase and lowercase English letters and characters ""!"", ""."", "","", ""?"". String ""2012-MM-DD"" determines a correct date in the year of 2012. String ""HH:MM:SS"" determines a correct time in the 24 hour format.The described record of a log stream means that at a certain time the record has got some program warning (string ""MESSAGE"" contains the warning\'s description).Your task is to print the first moment of time, when the number of warnings for the last n seconds was not less than m." 2000
245E "Mishap in Club" greedy,implementation "Polycarpus just has been out of luck lately! As soon as he found a job in the ""Binary Cat"" cafe, the club got burgled. All ice-cream was stolen.On the burglary night Polycarpus kept a careful record of all club visitors. Each time a visitor entered the club, Polycarpus put down character ""+"" in his notes. Similarly, each time a visitor left the club, Polycarpus put character ""-"" in his notes. We know that all cases of going in and out happened consecutively, that is, no two events happened at the same time. Polycarpus doesn\'t remember whether there was somebody in the club at the moment when his shift begun and at the moment when it ended.Right now the police wonders what minimum number of distinct people Polycarpus could have seen. Assume that he sees anybody coming in or out of the club. Each person could have come in or out an arbitrary number of times." 1400
245D "Restoring Table" "constructive algorithms,greedy" "Recently Polycarpus has learned the ""bitwise AND"" operation (which is also called ""AND"") of non-negative integers. Now he wants to demonstrate the school IT teacher his superb manipulation with the learned operation.For that Polycarpus came to school a little earlier and wrote on the board a sequence of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He also wrote a square matrix b of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n. The element of matrix b that sits in the i-th row in the j-th column (we\'ll denote it as bij) equals:  the ""bitwise AND"" of numbers ai and aj (that is, bij\xe2\x80\x89=\xe2\x80\x89ai & aj), if i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j;  -1, if i\xe2\x80\x89=\xe2\x80\x89j. Having written out matrix b, Polycarpus got very happy and wiped a off the blackboard. But the thing is, the teacher will want this sequence to check whether Polycarpus\' calculations were correct. Polycarus urgently needs to restore the removed sequence of integers, or else he won\'t prove that he can count correctly.Help Polycarpus, given matrix b, restore the sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, that he has removed from the board. Polycarpus doesn\'t like large numbers, so any number in the restored sequence mustn\'t exceed 109." 1500
245C "Game with Coins" greedy "Two pirates Polycarpus and Vasily play a very interesting game. They have n chests with coins, the chests are numbered with integers from 1 to n. Chest number i has ai coins. Polycarpus and Vasily move in turns. Polycarpus moves first. During a move a player is allowed to choose a positive integer x (2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and take a coin from each chest with numbers x, 2\xc2\xb7x, 2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891. It may turn out that some chest has no coins, in this case the player doesn\'t take a coin from this chest. The game finishes when all chests get emptied.Polycarpus isn\'t a greedy scrooge. Polycarpys is a lazy slob. So he wonders in what minimum number of moves the game can finish. Help Polycarpus, determine the minimum number of moves in which the game can finish. Note that Polycarpus counts not only his moves, he also counts Vasily\'s moves." 1700
245B "Internet Address" implementation,strings "Vasya is an active Internet user. One day he came across an Internet resource he liked, so he wrote its address in the notebook. We know that the address of the written resource has format: <protocol>://<domain>.ru[/<context>] where:  <protocol> can equal either ""http"" (without the quotes) or ""ftp"" (without the quotes),  <domain> is a non-empty string, consisting of lowercase English letters,  the /<context> part may not be present. If it is present, then <context> is a non-empty string, consisting of lowercase English letters. If string <context> isn\'t present in the address, then the additional character ""/"" isn\'t written. Thus, the address has either two characters ""/"" (the ones that go before the domain), or three (an extra one in front of the context).When the boy came home, he found out that the address he wrote in his notebook had no punctuation marks. Vasya must have been in a lot of hurry and didn\'t write characters "":"", ""/"", ""."".Help Vasya to restore the possible address of the recorded Internet resource." 1100
245A "System Administrator" implementation "Polycarpus is a system administrator. There are two servers under his strict guidance \xe2\x80\x94 a and b. To stay informed about the servers\' performance, Polycarpus executes commands ""ping a"" and ""ping b"". Each ping command sends exactly ten packets to the server specified in the argument of the command. Executing a program results in two integers x and y (x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89=\xe2\x80\x8910; x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890). These numbers mean that x packets successfully reached the corresponding server through the network and y packets were lost.Today Polycarpus has performed overall n ping commands during his workday. Now for each server Polycarpus wants to know whether the server is ""alive"" or not. Polycarpus thinks that the server is ""alive"", if at least half of the packets that we send to this server reached it successfully along the network.Help Polycarpus, determine for each server, whether it is ""alive"" or not by the given commands and their results." 800
244B "Undoubtedly Lucky Numbers" "bitmasks,brute force,dfs and similar" "Polycarpus loves lucky numbers. Everybody knows that lucky numbers are positive integers, whose decimal representation (without leading zeroes) contain only the lucky digits x and y. For example, if x\xe2\x80\x89=\xe2\x80\x894, and y\xe2\x80\x89=\xe2\x80\x897, then numbers 47, 744, 4 are lucky.Let\'s call a positive integer a undoubtedly lucky, if there are such digits x and y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899), that the decimal representation of number a (without leading zeroes) contains only digits x and y.Polycarpus has integer n. He wants to know how many positive integers that do not exceed n, are undoubtedly lucky. Help him, count this number." 1600
244A "Dividing Orange" implementation "One day Ms Swan bought an orange in a shop. The orange consisted of n\xc2\xb7k segments, numbered with integers from 1 to n\xc2\xb7k. There were k children waiting for Ms Swan at home. The children have recently learned about the orange and they decided to divide it between them. For that each child took a piece of paper and wrote the number of the segment that he would like to get: the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) child wrote the number ai (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xc2\xb7k). All numbers ai accidentally turned out to be different.Now the children wonder, how to divide the orange so as to meet these conditions:  each child gets exactly n orange segments;  the i-th child gets the segment with number ai for sure;  no segment goes to two children simultaneously. Help the children, divide the orange and fulfill the requirements, described above." 900
243E Matrix "data structures" "Let\'s consider an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square matrix, consisting of digits one and zero.We\'ll consider a matrix good, if it meets the following condition: in each row of the matrix all ones go in one group. That is, each row of the matrix looks like that 00...0011...1100...00 (or simply consists of zeroes if it has no ones).You are given matrix a of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n, consisting of zeroes and ones. Your task is to determine whether you can get a good matrix b from it by rearranging the columns or not." 3000
243D Cubes "data structures,dp,geometry,two pointers" "One day Petya got a set of wooden cubes as a present from his mom. Petya immediately built a whole city from these cubes.The base of the city is an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n square, divided into unit squares. The square\'s sides are parallel to the coordinate axes, the square\'s opposite corners have coordinates (0,\xe2\x80\x890) and (n,\xe2\x80\x89n). On each of the unit squares Petya built a tower of wooden cubes. The side of a wooden cube also has a unit length.After that Petya went an infinitely large distance away from his masterpiece and looked at it in the direction of vector v\xe2\x80\x89=\xe2\x80\x89(vx,\xe2\x80\x89vy,\xe2\x80\x890). Petya wonders, how many distinct cubes are visible from this position. Help him, find this number.Each cube includes the border. We think that a cube is visible if there is a ray emanating from some point p, belonging to the cube, in the direction of vector \xe2\x80\x89-\xe2\x80\x89v, that doesn\'t contain any points, belonging to other cubes." 2700
243C "Colorado Potato Beetle" "dfs and similar,implementation" "Old MacDonald has a farm and a large potato field, (1010\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89\xc3\x97\xe2\x80\x89(1010\xe2\x80\x89+\xe2\x80\x891) square meters in size. The field is divided into square garden beds, each bed takes up one square meter.Old McDonald knows that the Colorado potato beetle is about to invade his farm and can destroy the entire harvest. To fight the insects, Old McDonald wants to spray some beds with insecticides.So Old McDonald went to the field, stood at the center of the central field bed and sprayed this bed with insecticides. Now he\'s going to make a series of movements and spray a few more beds. During each movement Old McDonald moves left, right, up or down the field some integer number of meters. As Old McDonald moves, he sprays all the beds he steps on. In other words, the beds that have any intersection at all with Old McDonald\'s trajectory, are sprayed with insecticides.When Old McDonald finished spraying, he wrote out all his movements on a piece of paper. Now he wants to know how many beds won\'t be infected after the invasion of the Colorado beetles.It is known that the invasion of the Colorado beetles goes as follows. First some bed on the field border gets infected. Than any bed that hasn\'t been infected, hasn\'t been sprayed with insecticides and has a common side with an infected bed, gets infected as well. Help Old McDonald and determine the number of beds that won\'t be infected by the Colorado potato beetle." 2200
243B Hydra graphs,sortings "One day Petya got a birthday present from his mom: a book called ""The Legends and Myths of Graph Theory"". From this book Petya learned about a hydra graph.A non-oriented graph is a hydra, if it has a structure, shown on the figure below. Namely, there are two nodes u and v connected by an edge, they are the hydra\'s chest and stomach, correspondingly. The chest is connected with h nodes, which are the hydra\'s heads. The stomach is connected with t nodes, which are the hydra\'s tails. Note that the hydra is a tree, consisting of h\xe2\x80\x89+\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x892 nodes.  Also, Petya\'s got a non-directed graph G, consisting of n nodes and m edges. Petya got this graph as a last year birthday present from his mom. Graph G contains no self-loops or multiple edges.Now Petya wants to find a hydra in graph G. Or else, to make sure that the graph doesn\'t have a hydra." 2000
243A "The Brand New Function" bitmasks "Polycarpus has a sequence, consisting of n non-negative integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Let\'s define function f(l,\xe2\x80\x89r) (l,\xe2\x80\x89r are integer, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) for sequence a as an operation of bitwise OR of all the sequence elements with indexes from l to r. Formally: f(l,\xe2\x80\x89r)\xe2\x80\x89=\xe2\x80\x89al | al\xe2\x80\x89+\xe2\x80\x891 | ...  | ar. Polycarpus took a piece of paper and wrote out the values of function f(l,\xe2\x80\x89r) for all l,\xe2\x80\x89r (l,\xe2\x80\x89r are integer, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). Now he wants to know, how many distinct values he\'s got in the end. Help Polycarpus, count the number of distinct values of function f(l,\xe2\x80\x89r) for the given sequence a.Expression x | y means applying the operation of bitwise OR to numbers x and y. This operation exists in all modern programming languages, for example, in language C++ and Java it is marked as ""|"", in Pascal \xe2\x80\x94 as ""or""." 1600
242E "XOR on Segment" "bitmasks,data structures" "You\'ve got an array a, consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You are allowed to perform two operations on this array:  Calculate the sum of current array elements on the segment [l,\xe2\x80\x89r], that is, count value al\xe2\x80\x89+\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89ar.  Apply the xor operation with a given number x to each array element on the segment [l,\xe2\x80\x89r], that is, execute . This operation changes exactly r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891 array elements. Expression  means applying bitwise xor operation to numbers x and y. The given operation exists in all modern programming languages, for example in language C++ and Java it is marked as ""^"", in Pascal \xe2\x80\x94 as ""xor"".You\'ve got a list of m operations of the indicated type. Your task is to perform all given operations, for each sum query you should print the result you get." 2000
242D Dispute "dfs and similar,graphs,greedy" "Valera has n counters numbered from 1 to n. Some of them are connected by wires, and each of the counters has a special button.Initially, all the counters contain number 0. When you press a button on a certain counter, the value it has increases by one. Also, the values recorded in all the counters, directly connected to it by a wire, increase by one.Valera and Ignat started having a dispute, the dispute is as follows. Ignat thought of a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Valera should choose some set of distinct counters and press buttons on each of them exactly once (on other counters the buttons won\'t be pressed). If after that there is a counter with the number i, which has value ai, then Valera loses the dispute, otherwise he wins the dispute.Help Valera to determine on which counters he needs to press a button to win the dispute." 2100
242C "King\'s Path" "dfs and similar,graphs,hashing,shortest paths" "The black king is standing on a chess field consisting of 109 rows and 109 columns. We will consider the rows of the field numbered with integers from 1 to 109 from top to bottom. The columns are similarly numbered with integers from 1 to 109 from left to right. We will denote a cell of the field that is located in the i-th row and j-th column as (i,\xe2\x80\x89j).You know that some squares of the given chess field are allowed. All allowed cells of the chess field are given as n segments. Each segment is described by three integers ri,\xe2\x80\x89ai,\xe2\x80\x89bi (ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi), denoting that cells in columns from number ai to number bi inclusive in the ri-th row are allowed.Your task is to find the minimum number of moves the king needs to get from square (x0,\xe2\x80\x89y0) to square (x1,\xe2\x80\x89y1), provided that he only moves along the allowed cells. In other words, the king can be located only on allowed cells on his way.Let us remind you that a chess king can move to any of the neighboring cells in one move. Two cells of a chess field are considered neighboring if they share at least one point." 1800
242B "Big Segment" implementation,sortings "A coordinate line has n segments, the i-th segment starts at the position li and ends at the position ri. We will denote such a segment as [li,\xe2\x80\x89ri].You have suggested that one of the defined segments covers all others. In other words, there is such segment in the given set, which contains all other ones. Now you want to test your assumption. Find in the given set the segment which covers all other segments, and print its number. If such a segment doesn\'t exist, print -1.Formally we will assume that segment [a,\xe2\x80\x89b] covers segment [c,\xe2\x80\x89d], if they meet this condition a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b." 1100
242A "Heads or Tails" "brute force,implementation" "Petya and Vasya are tossing a coin. Their friend Valera is appointed as a judge. The game is very simple. First Vasya tosses a coin x times, then Petya tosses a coin y times. If the tossing player gets head, he scores one point. If he gets tail, nobody gets any points. The winner is the player with most points by the end of the game. If boys have the same number of points, the game finishes with a draw.At some point, Valera lost his count, and so he can not say exactly what the score is at the end of the game. But there are things he remembers for sure. He remembers that the entire game Vasya got heads at least a times, and Petya got heads at least b times. Moreover, he knows that the winner of the game was Vasya. Valera wants to use this information to know every possible outcome of the game, which do not contradict his memories." 1100
241G "Challenging Balloons" "constructive algorithms" "Martha \xe2\x80\x94 as a professional problemsetter \xe2\x80\x94 proposed a problem for a world-class contest. This is the problem statement:Tomorrow is Nadia\'s birthday, and Bardia (her brother) is assigned to make the balloons ready!There are n balloons (initially empty) that are tied to a straight line on certain positions x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. Bardia inflates the balloons from left to right. As a result, i-th balloon gets bigger and bigger until its radius reaches the pressure endurance pi or it touches another previously-inflated balloon.  While Bardia was busy with the balloons, he wondered ""What will be the sum of radius of balloons after all of the balloons are inflated?"". Being a nerdy type of guy, he is now thinking about the problem instead of preparing his sister\'s birthday. Calculate the answer to Bardia\'s problem so that Nadia\'s birthday won\'t be balloon-less.Artha \xe2\x80\x94 Martha\'s student \xe2\x80\x94 claimed his solution got accepted. Martha (being his teacher for a long time!) knew he couldn\'t have solved the problem for real and thus thinks there is something wrong with the testcases. Artha isn\'t anyhow logical, which means there is no way for Martha to explain the wrong point in his algorithm. So, the only way is to find a testcase to prove him wrong!Artha\'s pseudo-code is shown below:  You should output a small testcase for the problem such that Artha\'s algorithm is incorrect. The algorithm\'s output is considered correct if it differs from the correct value by no more than 1." 1900
241F Race "brute force,implementation" "The Old City is a rectangular city represented as an m\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid of blocks. This city contains many buildings, straight two-way streets and junctions. Each junction and each building is exactly one block. All the streets have width of one block and are either vertical or horizontal. There is a junction on both sides of each street. We call two blocks adjacent if and only if they share a common side. No two blocks of different streets are adjacent and no two junctions are adjacent. There is an annual festival and as a part of it, The Old Peykan follows a special path in the city. This path starts from a block in a street, continues with many junctions and ends in a block of some street. For each street block, we know how much time it takes for the Old Peykan to go from this block to an adjacent block. Also the Old Peykan can go from each junction to its adjacent street blocks in one minute. Of course Old Peykan can\'t go to building blocks.We know the initial position of the Old Peykan and the sequence of junctions that it passes to reach its destination. After passing all the junctions and reaching the destination, it will stay there forever. Your task is to find out where will the Old Peykan be k minutes after it starts moving. Consider that The Old Peykan always follows the shortest path that passes through the given sequence of junctions and reaches the destination.Note that the Old Peykan may visit some blocks more than once." 2300
241E Flights "graphs,shortest paths" "LiLand is a country, consisting of n cities. The cities are numbered from 1 to n. The country is well known because it has a very strange transportation system. There are many one-way flights that make it possible to travel between the cities, but the flights are arranged in a way that once you leave a city you will never be able to return to that city again.Previously each flight took exactly one hour, but recently Lily has become the new manager of transportation system and she wants to change the duration of some flights. Specifically, she wants to change the duration of some flights to exactly 2 hours in such a way that all trips from city 1 to city n take the same time regardless of their path.Your task is to help Lily to change the duration of flights." 2600
241D Numbers NA "You have a sequence of n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). You want to remove some integers in such a way that the resulting sequence of integers satisfies the following three conditions:  the resulting sequence is not empty;  the exclusive or (xor operation) of all the integers in the resulting sequence equals 0;  if you write all the integers of the resulting sequence (from beginning to the end) in a row in the decimal numeral system and without any spaces, the written number is divisible by p. You are given the sequence of n integers a and a prime number p, find a way to satisfy the described conditions." 2900
241C "Mirror Box" geometry,implementation "Mirror Box is a name of a popular game in the Iranian National Amusement Park (INAP). There is a wooden box, 105 cm long and 100 cm high in this game. Some parts of the box\'s ceiling and floor are covered by mirrors. There are two negligibly small holes in the opposite sides of the box at heights hl and hr centimeters above the floor. The picture below shows what the box looks like.  In the game, you will be given a laser gun to shoot once. The laser beam must enter from one hole and exit from the other one. Each mirror has a preset number vi, which shows the number of points players gain if their laser beam hits that mirror. Also \xe2\x80\x94 to make things even funnier \xe2\x80\x94 the beam must not hit any mirror more than once.Given the information about the box, your task is to find the maximum score a player may gain. Please note that the reflection obeys the law ""the angle of incidence equals the angle of reflection""." 2000
241B Friends "binary search,bitmasks,data structures,math" "You have n friends and you want to take m pictures of them. Exactly two of your friends should appear in each picture and no two pictures should contain the same pair of your friends. So if you have n\xe2\x80\x89=\xe2\x80\x893 friends you can take 3 different pictures, each containing a pair of your friends.Each of your friends has an attractiveness level which is specified by the integer number ai for the i-th friend. You know that the attractiveness of a picture containing the i-th and the j-th friends is equal to the exclusive-or (xor operation) of integers ai and aj.You want to take pictures in a way that the total sum of attractiveness of your pictures is maximized. You have to calculate this value. Since the result may not fit in a 32-bit integer number, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2700
241A "Old Peykan" greedy "There are n cities in the country where the Old Peykan lives. These cities are located on a straight line, we\'ll denote them from left to right as c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn. The Old Peykan wants to travel from city c1 to cn using roads. There are (n\xe2\x80\x89-\xe2\x80\x891) one way roads, the i-th road goes from city ci to city ci\xe2\x80\x89+\xe2\x80\x891 and is di kilometers long.The Old Peykan travels 1 kilometer in 1 hour and consumes 1 liter of fuel during this time.Each city ci (except for the last city cn) has a supply of si liters of fuel which immediately transfers to the Old Peykan if it passes the city or stays in it. This supply refreshes instantly k hours after it transfers. The Old Peykan can stay in a city for a while and fill its fuel tank many times. Initially (at time zero) the Old Peykan is at city c1 and s1 liters of fuel is transferred to it\'s empty tank from c1\'s supply. The Old Peykan\'s fuel tank capacity is unlimited. Old Peykan can not continue its travel if its tank is emptied strictly between two cities.Find the minimum time the Old Peykan needs to reach city cn." 1300
240F TorCoder "data structures" "A boy named Leo doesn\'t miss a single TorCoder contest round. On the last TorCoder round number 100666 Leo stumbled over the following problem. He was given a string s, consisting of n lowercase English letters, and m queries. Each query is characterised by a pair of integers li,\xe2\x80\x89ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). We\'ll consider the letters in the string numbered from 1 to n from left to right, that is, s\xe2\x80\x89=\xe2\x80\x89s1s2... sn. After each query he must swap letters with indexes from li to ri inclusive in string s so as to make substring (li,\xe2\x80\x89ri) a palindrome. If there are multiple such letter permutations, you should choose the one where string (li,\xe2\x80\x89ri) will be lexicographically minimum. If no such permutation exists, you should ignore the query (that is, not change string s).Everybody knows that on TorCoder rounds input line and array size limits never exceed 60, so Leo solved this problem easily. Your task is to solve the problem on a little bit larger limits. Given string s and m queries, print the string that results after applying all m queries to string s." 2600
240E "Road Repairs" "dfs and similar,graphs,greedy" "A country named Berland has n cities. They are numbered with integers from 1 to n. City with index 1 is the capital of the country. Some pairs of cities have monodirectional roads built between them. However, not all of them are in good condition. For each road we know whether it needs repairing or not. If a road needs repairing, then it is forbidden to use it. However, the Berland government can repair the road so that it can be used.Right now Berland is being threatened by the war with the neighbouring state. So the capital officials decided to send a military squad to each city. The squads can move only along the existing roads, as there\'s no time or money to build new roads. However, some roads will probably have to be repaired in order to get to some cities.Of course the country needs much resources to defeat the enemy, so you want to be careful with what you\'re going to throw the forces on. That\'s why the Berland government wants to repair the minimum number of roads that is enough for the military troops to get to any city from the capital, driving along good or repaired roads. Your task is to help the Berland government and to find out, which roads need to be repaired." 2800
239B "Easy Tape Programming" "brute force,implementation" "There is a programming language in which every program is a non-empty sequence of ""<"" and "">"" signs and digits. Let\'s explain how the interpreter of this programming language works. A program is interpreted using movement of instruction pointer (IP) which consists of two parts.  Current character pointer (CP);  Direction pointer (DP) which can point left or right; Initially CP points to the leftmost character of the sequence and DP points to the right.We repeat the following steps until the first moment that CP points to somewhere outside the sequence.  If CP is pointing to a digit the interpreter prints that digit then CP moves one step according to the direction of DP. After that the value of the printed digit in the sequence decreases by one. If the printed digit was 0 then it cannot be decreased therefore it\'s erased from the sequence and the length of the sequence decreases by one.  If CP is pointing to ""<"" or "">"" then the direction of DP changes to ""left"" or ""right"" correspondingly. Then CP moves one step according to DP. If the new character that CP is pointing to is ""<"" or "">"" then the previous character will be erased from the sequence. If at any moment the CP goes outside of the sequence the execution is terminated.It\'s obvious the every program in this language terminates after some steps.We have a sequence s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn of ""<"", "">"" and digits. You should answer q queries. Each query gives you l and r and asks how many of each digit will be printed if we run the sequence sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr as an independent program in this language." 1500
239A "Two Bags of Potatoes" greedy,implementation,math "Valera had two bags of potatoes, the first of these bags contains x (x\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) potatoes, and the second \xe2\x80\x94 y (y\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) potatoes. Valera \xe2\x80\x94 very scattered boy, so the first bag of potatoes (it contains x potatoes) Valera lost. Valera remembers that the total amount of potatoes (x\xe2\x80\x89+\xe2\x80\x89y) in the two bags, firstly, was not gerater than n, and, secondly, was divisible by k.Help Valera to determine how many potatoes could be in the first bag. Print all such possible numbers in ascending order." 1200
238E "Meeting Her" "dp,graphs,shortest paths" "Urpal lives in a big city. He has planned to meet his lover tonight. The city has n junctions numbered from 1 to n. The junctions are connected by m directed streets, all the roads have equal length. Urpal lives in junction a and the date is planned in a restaurant in junction b. He wants to use public transportation to get to junction b. There are k bus transportation companies. At the beginning of every second, a bus from the i-th company chooses a random shortest path between junction si and junction ti and passes through it. There might be no path from si to ti. In that case no bus will leave from si to ti. If a bus passes through a junction where Urpal stands, he can get on the bus. He can also get o\x1bff the bus at any junction along the path. Now Urpal wants to know if it\'s possible to go to the date using public transportation in a \x1cfinite amount of time (the time of travel is the sum of length of the traveled roads) and what is the minimum number of buses he should take in the worst case.At any moment Urpal knows only his own position and the place where the date will be. When he gets on the bus he knows only the index of the company of this bus. Of course Urpal knows the city map and the the pairs (si,\xe2\x80\x89ti) for each company.Note that Urpal doesn\'t know buses velocity." 2600
238D "Tape Programming" "data structures,implementation" "There is a programming language in which every program is a non-empty sequence of ""<"" and "">"" signs and digits. Let\'s explain how the interpreter of this programming language works. A program is interpreted using movement of instruction pointer (IP) which consists of two parts.  Current character pointer (CP);  Direction pointer (DP) which can point left or right; Initially CP points to the leftmost character of the sequence and DP points to the right.We repeat the following steps until the first moment that CP points to somewhere outside the sequence.  If CP is pointing to a digit the interpreter prints that digit then CP moves one step according to the direction of DP. After that the value of the printed digit in the sequence decreases by one. If the printed digit was 0 then it cannot be decreased therefore it\'s erased from the sequence and the length of the sequence decreases by one.  If CP is pointing to ""<"" or "">"" then the direction of DP changes to ""left"" or ""right"" correspondingly. Then CP moves one step according to DP. If the new character that CP is pointing to is ""<"" or "">"" then the previous character will be erased from the sequence. If at any moment the CP goes outside of the sequence the execution is terminated.It\'s obvious the every program in this language terminates after some steps.We have a sequence s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn of ""<"", "">"" and digits. You should answer q queries. Each query gives you l and r and asks how many of each digit will be printed if we run the sequence sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89sr as an independent program in this language." 2900
238C "World Eater Brothers" "dfs and similar,dp,greedy,trees" "You must have heard of the two brothers dreaming of ruling the world. With all their previous plans failed, this time they decided to cooperate with each other in order to rule the world. As you know there are n countries in the world. These countries are connected by n\xe2\x80\x89-\xe2\x80\x891 directed roads. If you don\'t consider direction of the roads there is a unique path between every pair of countries in the world, passing through each road at most once. Each of the brothers wants to establish his reign in some country, then it\'s possible for him to control the countries that can be reached from his country using directed roads. The brothers can rule the world if there exists at most two countries for brothers to choose (and establish their reign in these countries) so that any other country is under control of at least one of them. In order to make this possible they want to change the direction of minimum number of roads. Your task is to calculate this minimum number of roads." 2100
238B "Boring Partition" "constructive algorithms" "This problem is the most boring one you\'ve ever seen. Given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and a non-negative integer h, our goal is to partition the sequence into two subsequences (not necessarily consist of continuous elements). Each element of the original sequence should be contained in exactly one of the result subsequences. Note, that one of the result subsequences can be empty.Let\'s define function f(ai,\xe2\x80\x89aj) on pairs of distinct elements (that is i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) in the original sequence. If ai and aj are in the same subsequence in the current partition then f(ai,\xe2\x80\x89aj)\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89aj otherwise f(ai,\xe2\x80\x89aj)\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89aj\xe2\x80\x89+\xe2\x80\x89h. Consider all possible values of the function f for some partition. We\'ll call the goodness of this partiotion the difference between the maximum value of function f and the minimum value of function f.Your task is to find a partition of the given sequence a that have the minimal possible goodness among all possible partitions." 1800
238A "Not Wool Sequences" "constructive algorithms,math" "A sequence of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of length n is called a wool sequence if and only if there exists two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that . In other words each wool sequence contains a subsequence of consecutive elements with xor equal to 0.The expression  means applying the operation of a bitwise xor to numbers x and y. The given operation exists in all modern programming languages, for example, in languages C++ and Java it is marked as ""^"", in Pascal \xe2\x80\x94 as ""xor"".In this problem you are asked to compute the number of sequences made of n integers from 0 to 2m\xe2\x80\x89-\xe2\x80\x891 that are not a wool sequence. You should print this number modulo 1000000009 (109\xe2\x80\x89+\xe2\x80\x899)." 1300
237E "Build String" flows,graphs "You desperately need to build some string t. For that you\'ve got n more strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn. To build string t, you are allowed to perform exactly |t| (|t| is the length of string t) operations on these strings. Each operation looks like that:  choose any non-empty string from strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn;  choose an arbitrary character from the chosen string and write it on a piece of paper;  remove the chosen character from the chosen string. Note that after you perform the described operation, the total number of characters in strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn decreases by 1. We are assumed to build string t, if the characters, written on the piece of paper, in the order of performed operations form string t.There are other limitations, though. For each string si you know number ai \xe2\x80\x94 the maximum number of characters you are allowed to delete from string si. You also know that each operation that results in deleting a character from string si, costs i rubles. That is, an operation on string s1 is the cheapest (it costs 1 ruble), and the operation on string sn is the most expensive one (it costs n rubles).Your task is to count the minimum amount of money (in rubles) you will need to build string t by the given rules. Consider the cost of building string t to be the sum of prices of the operations you use." 2000
237D T-decomposition "dfs and similar,graphs,greedy,trees" "You\'ve got a undirected tree s, consisting of n nodes. Your task is to build an optimal T-decomposition for it. Let\'s define a T-decomposition as follows.Let\'s denote the set of all nodes s as v. Let\'s consider an undirected tree t, whose nodes are some non-empty subsets of v, we\'ll call them xi . The tree t is a T-decomposition of s, if the following conditions holds:  the union of all xi equals v;  for any edge (a,\xe2\x80\x89b) of tree s exists the tree node t, containing both a and b;  if the nodes of the tree t xi and xj contain the node a of the tree s, then all nodes of the tree t, lying on the path from xi to xj also contain node a. So this condition is equivalent to the following: all nodes of the tree t, that contain node a of the tree s, form a connected subtree of tree t. There are obviously many distinct trees t, that are T-decompositions of the tree s. For example, a T-decomposition is a tree that consists of a single node, equal to set v.Let\'s define the cardinality of node xi as the number of nodes in tree s, containing in the node. Let\'s choose the node with the maximum cardinality in t. Let\'s assume that its cardinality equals w. Then the weight of T-decomposition t is value w. The optimal T-decomposition is the one with the minimum weight.Your task is to find the optimal T-decomposition of the given tree s that has the minimum number of nodes." 2000
237C "Primes on Interval" "binary search,number theory,two pointers" "You\'ve decided to carry out a survey in the theory of prime numbers. Let us remind you that a prime number is a positive integer that has exactly two distinct positive integer divisors.Consider positive integers a, a\xe2\x80\x89+\xe2\x80\x891, ..., b (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b). You want to find the minimum integer l (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891) such that for any integer x (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891) among l integers x, x\xe2\x80\x89+\xe2\x80\x891, ..., x\xe2\x80\x89+\xe2\x80\x89l\xe2\x80\x89-\xe2\x80\x891 there are at least k prime numbers. Find and print the required minimum l. If no value l meets the described limitations, print -1." 1600
237B "Young Table" implementation,sortings "You\'ve got table a, consisting of n rows, numbered from 1 to n. The i-th line of table a contains ci cells, at that for all i (1\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) holds ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89-\xe2\x80\x891. Let\'s denote s as the total number of cells of table a, that is, . We know that each cell of the table contains a single integer from 1 to s, at that all written integers are distinct. Let\'s assume that the cells of the i-th row of table a are numbered from 1 to ci, then let\'s denote the number written in the j-th cell of the i-th row as ai,\xe2\x80\x89j. Your task is to perform several swap operations to rearrange the numbers in the table so as to fulfill the following conditions:  for all i,\xe2\x80\x89j (1\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci) holds ai,\xe2\x80\x89j\xe2\x80\x89>\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j;  for all i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci) holds ai,\xe2\x80\x89j\xe2\x80\x89>\xe2\x80\x89ai,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891. In one swap operation you are allowed to choose two different cells of the table and swap the recorded there numbers, that is the number that was recorded in the first of the selected cells before the swap, is written in the second cell after it. Similarly, the number that was recorded in the second of the selected cells, is written in the first cell after the swap.Rearrange the numbers in the required manner. Note that you are allowed to perform any number of operations, but not more than s. You do not have to minimize the number of operations." 1500
237A "Free Cash" implementation "Valera runs a 24/7 fast food cafe. He magically learned that next day n people will visit his cafe. For each person we know the arrival time: the i-th person comes exactly at hi hours mi minutes. The cafe spends less than a minute to serve each client, but if a client comes in and sees that there is no free cash, than he doesn\'t want to wait and leaves the cafe immediately. Valera is very greedy, so he wants to serve all n customers next day (and get more profit). However, for that he needs to ensure that at each moment of time the number of working cashes is no less than the number of clients in the cafe. Help Valera count the minimum number of cashes to work at his cafe next day, so that they can serve all visitors." 1000
236B "Easy Number Challenge" "implementation,number theory" "Let\'s denote d(n) as the number of divisors of a positive integer n. You are given three integers a, b and c. Your task is to calculate the following sum:Find the sum modulo 1073741824 (230)." 1300
236A "Boy or Girl" "brute force,implementation,strings" "Those days, many boys use beautiful girls\' photos as avatars in forums. So it is pretty hard to tell the gender of a user at the first glance. Last year, our hero went to a forum and had a nice chat with a beauty (he thought so). After that they talked very often and eventually they became a couple in the network. But yesterday, he came to see ""her"" in the real world and found out ""she"" is actually a very strong man! Our hero is very sad and he is too tired to love again now. So he came up with a way to recognize users\' genders by their user names.This is his method: if the number of distinct characters in one\'s user name is odd, then he is a male, otherwise she is a female. You are given the string that denotes the user name, please help our hero to determine the gender of this user by his method." 800
235E "Number Challenge" "combinatorics,dp,implementation,math,number theory" "Let\'s denote d(n) as the number of divisors of a positive integer n. You are given three integers a, b and c. Your task is to calculate the following sum:Find the sum modulo 1073741824 (230)." 2600
235D "Graph Game" graphs "In computer science, there is a method called ""Divide And Conquer By Node"" to solve some hard problems about paths on a tree. Let\'s desribe how this method works by function:solve(t) (t is a tree):   Chose a node x (it\'s common to chose weight-center) in tree t. Let\'s call this step ""Line A"".  Deal with all paths that pass x.  Then delete x from tree t.  After that t becomes some subtrees.  Apply solve on each subtree. This ends when t has only one node because after deleting it, there\'s nothing. Now, WJMZBMR has mistakenly believed that it\'s ok to chose any node in ""Line A"". So he\'ll chose a node at random. To make the situation worse, he thinks a ""tree"" should have the same number of edges and nodes! So this procedure becomes like that.Let\'s define the variable totalCost. Initially the value of totalCost equal to 0. So, solve(t) (now t is a graph):   totalCost\xe2\x80\x89=\xe2\x80\x89totalCost\xe2\x80\x89+\xe2\x80\x89(size of t). The operation ""="" means assignment. (Size of t) means the number of nodes in t.  Choose a node x in graph t at random (uniformly among all nodes of t).  Then delete x from graph t.  After that t becomes some connected components.  Apply solve on each component. He\'ll apply solve on a connected graph with n nodes and n edges. He thinks it will work quickly, but it\'s very slow. So he wants to know the expectation of totalCost of this procedure. Can you help him?" 3000
235C "Cyclical Quest" "data structures,string suffix structures,strings" "Some days ago, WJMZBMR learned how to answer the query ""how many times does a string x occur in a string s"" quickly by preprocessing the string s. But now he wants to make it harder.So he wants to ask ""how many consecutive substrings of s are cyclical isomorphic to a given string x"". You are given string s and n strings xi, for each string xi find, how many consecutive substrings of s are cyclical isomorphic to xi.Two strings are called cyclical isomorphic if one can rotate one string to get the other one. \'Rotate\' here means \'to take some consecutive chars (maybe none) from the beginning of a string and put them back at the end of the string in the same order\'. For example, string ""abcde"" can be rotated to string ""deabc"". We can take characters ""abc"" from the beginning and put them at the end of ""de""." 2700
235B "Let\'s Play Osu!" dp,math,probabilities "You\'re playing a game called Osu! Here\'s a simplified version of it. There are n clicks in a game. For each click there are two outcomes: correct or bad. Let us denote correct as ""O"", bad as ""X"", then the whole play can be encoded as a sequence of n characters ""O"" and ""X"".Using the play sequence you can calculate the score for the play as follows: for every maximal consecutive ""O""s block, add the square of its length (the number of characters ""O"") to the score. For example, if your play can be encoded as ""OOXOOOXXOO"", then there\'s three maximal consecutive ""O""s block ""OO"", ""OOO"", ""OO"", so your score will be 22\xe2\x80\x89+\xe2\x80\x8932\xe2\x80\x89+\xe2\x80\x8922\xe2\x80\x89=\xe2\x80\x8917. If there are no correct clicks in a play then the score for the play equals to 0.You know that the probability to click the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) click correctly is pi. In other words, the i-th character in the play sequence has pi probability to be ""O"", 1\xe2\x80\x89-\xe2\x80\x89pi to be ""X"". You task is to calculate the expected score for your play." 2000
235A "LCM Challenge" "number theory" "Some days ago, I learned the concept of LCM (least common multiple). I\'ve played with it for several times and I want to make a big number with it.But I also don\'t want to use many numbers, so I\'ll choose three positive integers (they don\'t have to be distinct) which are not greater than n. Can you help me to find the maximum possible least common multiple of these three integers?" 1600
234H "Merging Two Decks" "constructive algorithms,greedy" "There are two decks of cards lying on the table in front of you, some cards in these decks lay face up, some of them lay face down. You want to merge them into one deck in which each card is face down. You\'re going to do it in two stages.The first stage is to merge the two decks in such a way that the relative order of the cards from the same deck doesn\'t change. That is, for any two different cards i and j in one deck, if card i lies above card j, then after the merge card i must also be above card j.The second stage is performed on the deck that resulted from the first stage. At this stage, the executed operation is the turning operation. In one turn you can take a few of the top cards, turn all of them, and put them back. Thus, each of the taken cards gets turned and the order of these cards is reversed. That is, the card that was on the bottom before the turn, will be on top after it.Your task is to make sure that all the cards are lying face down. Find such an order of merging cards in the first stage and the sequence of turning operations in the second stage, that make all the cards lie face down, and the number of turns is minimum." 2000
234G Practice "constructive algorithms,divide and conquer,implementation" "Little time is left before Berland annual football championship. Therefore the coach of team ""Losewille Rangers"" decided to resume the practice, that were indefinitely interrupted for uncertain reasons. Overall there are n players in ""Losewille Rangers"". Each player on the team has a number \xe2\x80\x94 a unique integer from 1 to n. To prepare for the championship, the coach Mr. Floppe decided to spend some number of practices.Mr. Floppe spent some long nights of his holiday planning how to conduct the practices. He came to a very complex practice system. Each practice consists of one game, all n players of the team take part in the game. The players are sorted into two teams in some way. In this case, the teams may have different numbers of players, but each team must have at least one player.The coach wants to be sure that after the series of the practice sessions each pair of players had at least one practice, when they played in different teams. As the players\' energy is limited, the coach wants to achieve the goal in the least number of practices.Help him to schedule the practices." 1600
234F Fence dp "Vasya should paint a fence in front of his own cottage. The fence is a sequence of n wooden boards arranged in a single row. Each board is a 1 centimeter wide rectangle. Let\'s number the board fence using numbers 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n from left to right. The height of the i-th board is hi centimeters.Vasya has a 1 centimeter wide brush and the paint of two colors, red and green. Of course, the amount of the paint is limited. Vasya counted the area he can paint each of the colors. It turned out that he can not paint over a square centimeters of the fence red, and he can not paint over b square centimeters green. Each board of the fence should be painted exactly one of the two colors. Perhaps Vasya won\'t need one of the colors.In addition, Vasya wants his fence to look smart. To do this, he should paint the fence so as to minimize the value that Vasya called the fence unattractiveness value. Vasya believes that two consecutive fence boards, painted different colors, look unattractive. The unattractiveness value of a fence is the total length of contact between the neighboring boards of various colors. To make the fence look nice, you need to minimize the value as low as possible. Your task is to find what is the minimum unattractiveness Vasya can get, if he paints his fence completely.  The picture shows the fence, where the heights of boards (from left to right) are 2,3,2,4,3,1. The first and the fifth boards are painted red, the others are painted green. The first and the second boards have contact length 2, the fourth and fifth boards have contact length 3, the fifth and the sixth have contact length 1. Therefore, the unattractiveness of the given painted fence is 2+3+1=6." 1800
234E "Champions\' League" implementation "In the autumn of this year, two Russian teams came into the group stage of the most prestigious football club competition in the world \xe2\x80\x94 the UEFA Champions League. Now, these teams have already started to play in the group stage and are fighting for advancing to the playoffs. In this problem we are interested in the draw stage, the process of sorting teams into groups.The process of the draw goes as follows (the rules that are described in this problem, are somehow simplified compared to the real life). Suppose n teams will take part in the group stage (n is divisible by four). The teams should be divided into groups of four. Let\'s denote the number of groups as m (). Each team has a rating \xe2\x80\x94 an integer characterizing the team\'s previous achievements. The teams are sorted by the rating\'s decreasing (no two teams have the same rating).After that four ""baskets"" are formed, each of which will contain m teams: the first m teams with the highest rating go to the first basket, the following m teams go to the second one, and so on.Then the following procedure repeats m\xe2\x80\x89-\xe2\x80\x891 times. A team is randomly taken from each basket, first from the first basket, then from the second, then from the third, and at last, from the fourth. The taken teams form another group. After that, they are removed from their baskets.The four teams remaining in the baskets after (m\xe2\x80\x89-\xe2\x80\x891) such procedures are performed, form the last group.In the real draw the random selection of teams from the basket is performed by people \xe2\x80\x94 as a rule, the well-known players of the past. As we have none, we will use a random number generator, which is constructed as follows. Its parameters are four positive integers x,\xe2\x80\x89a,\xe2\x80\x89b,\xe2\x80\x89c. Every time there is a call to the random number generator, it produces the following actions:  calculates ;  replaces parameter x by value y (assigns );  returns x as another random number. Operation  means taking the remainder after division: , .A random number generator will be used in the draw as follows: each time we need to randomly choose a team from the basket, it will generate a random number k. The teams that yet remain in the basket are considered numbered with consecutive integers from 0 to s\xe2\x80\x89-\xe2\x80\x891, in the order of decreasing rating, where s is the current size of the basket. Then a team number  is taken from the basket.Given a list of teams and the parameters of the random number generator, determine the result of the draw." 1600
234D Cinema implementation "Overall there are m actors in Berland. Each actor has a personal identifier \xe2\x80\x94 an integer from 1 to m (distinct actors have distinct identifiers). Vasya likes to watch Berland movies with Berland actors, and he has k favorite actors. He watched the movie trailers for the next month and wrote the following information for every movie: the movie title, the number of actors who starred in it, and the identifiers of these actors. Besides, he managed to copy the movie titles and how many actors starred there, but he didn\'t manage to write down the identifiers of some actors. Vasya looks at his records and wonders which movies may be his favourite, and which ones may not be. Once Vasya learns the exact cast of all movies, his favorite movies will be determined as follows: a movie becomes favorite movie, if no other movie from Vasya\'s list has more favorite actors.Help the boy to determine the following for each movie: whether it surely will be his favourite movie; whether it surely won\'t be his favourite movie;  can either be favourite or not." 1600
234C Weather dp,implementation "Scientists say a lot about the problems of global warming and cooling of the Earth. Indeed, such natural phenomena strongly influence all life on our planet.Our hero Vasya is quite concerned about the problems. He decided to try a little experiment and observe how outside daily temperature changes. He hung out a thermometer on the balcony every morning and recorded the temperature. He had been measuring the temperature for the last n days. Thus, he got a sequence of numbers t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn, where the i-th number is the temperature on the i-th day.Vasya analyzed the temperature statistics in other cities, and came to the conclusion that the city has no environmental problems, if first the temperature outside is negative for some non-zero number of days, and then the temperature is positive for some non-zero number of days. More formally, there must be a positive integer k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) such that t1\xe2\x80\x89<\xe2\x80\x890,\xe2\x80\x89t2\xe2\x80\x89<\xe2\x80\x890,\xe2\x80\x89...,\xe2\x80\x89tk\xe2\x80\x89<\xe2\x80\x890 and tk\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x890,\xe2\x80\x89tk\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89>\xe2\x80\x890,\xe2\x80\x89...,\xe2\x80\x89tn\xe2\x80\x89>\xe2\x80\x890. In particular, the temperature should never be zero. If this condition is not met, Vasya decides that his city has environmental problems, and gets upset.You do not want to upset Vasya. Therefore, you want to select multiple values of temperature and modify them to satisfy Vasya\'s condition. You need to know what the least number of temperature values needs to be changed for that." 1300
234B Reading sortings "Vasya is going to the Olympics in the city Ntown by train. The boy wants to read the textbook to prepare for the Olympics. He counted that he needed k hours for this. He also found that the light in the train changes every hour. The light is measured on a scale from 0 to 100, where 0 is very dark, and 100 is very light.Vasya has a train lighting schedule for all n hours of the trip \xe2\x80\x94 n numbers from 0 to 100 each (the light level in the first hour, the second hour and so on). During each of those hours he will either read the whole time, or not read at all. He wants to choose k hours to read a book, not necessarily consecutive, so that the minimum level of light among the selected hours were maximum. Vasya is very excited before the upcoming contest, help him choose reading hours." 1000
234A "Lefthanders and Righthanders" implementation "One fine October day a mathematics teacher Vasily Petrov went to a class and saw there n pupils who sat at the  desks, two people at each desk. Vasily quickly realized that number n is even. Like all true mathematicians, Vasily has all students numbered from 1 to n.But Vasily Petrov did not like the way the children were seated at the desks. According to him, the students whose numbers differ by 1, can not sit together, as they talk to each other all the time, distract others and misbehave.On the other hand, if a righthanded student sits at the left end of the desk and a lefthanded student sits at the right end of the desk, they hit elbows all the time and distract each other. In other cases, the students who sit at the same desk, do not interfere with each other.Vasily knows very well which students are lefthanders and which ones are righthanders, and he asks you to come up with any order that meets these two uncomplicated conditions (students do not talk to each other and do not bump their elbows). It is guaranteed that the input is such that at least one way to seat the students always exists." 1200
233B "Non-square Equation" "binary search,brute force,math" "Let\'s consider equation:x2\xe2\x80\x89+\xe2\x80\x89s(x)\xc2\xb7x\xe2\x80\x89-\xe2\x80\x89n\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89 where x,\xe2\x80\x89n are positive integers, s(x) is the function, equal to the sum of digits of number x in the decimal number system.You are given an integer n, find the smallest positive integer root of equation x, or else determine that there are no such roots." 1400
233A "Perfect Permutation" implementation,math "A permutation is a sequence of integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, consisting of n distinct positive integers, each of them doesn\'t exceed n. Let\'s denote the i-th element of permutation p as pi. We\'ll call number n the size of permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn.Nickolas adores permutations. He likes some permutations more than the others. He calls such permutations perfect. A perfect permutation is such permutation p that for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) (n is the permutation size) the following equations hold ppi\xe2\x80\x89=\xe2\x80\x89i and pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i. Nickolas asks you to print any perfect permutation of size n for the given n." 800
232E "Quick Tortoise" "bitmasks,divide and conquer,dp" "John Doe has a field, which is a rectangular table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. We assume that the field rows are numbered from 1 to n from top to bottom, and the field columns are numbered from 1 to m from left to right. Then the cell of the field at the intersection of the x-th row and the y-th column has coordinates (x; y).We know that some cells of John\'s field are painted white, and some are painted black. Also, John has a tortoise, which can move along the white cells of the field. The tortoise can get from a white cell with coordinates (x; y) into cell (x\xe2\x80\x89+\xe2\x80\x891; y) or (x; y\xe2\x80\x89+\xe2\x80\x891), if the corresponding cell is painted white. In other words, the turtle can move only along the white cells of the field to the right or down. The turtle can not go out of the bounds of the field.In addition, John has q queries, each of them is characterized by four numbers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2 (x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2, y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2). For each query John wants to know whether the tortoise can start from the point with coordinates (x1; y1), and reach the point with coordinates (x2; y2), moving only along the white squares of the field." 3000
232D Fence "binary search,data structures,string suffix structures" "John Doe has a crooked fence, consisting of n rectangular planks, lined up from the left to the right: the plank that goes i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) (from left to right) has width 1 and height hi. We will assume that the plank that goes i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) (from left to right) has index i.A piece of the fence from l to r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is a sequence of planks of wood with indices from l to r inclusive, that is, planks with indices l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r. The width of the piece of the fence from l to r is value r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891.Two pieces of the fence from l1 to r1 and from l2 to r2 are called matching, if the following conditions hold:  the pieces do not intersect, that is, there isn\'t a single plank, such that it occurs in both pieces of the fence;  the pieces are of the same width;  for all i (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1\xe2\x80\x89-\xe2\x80\x89l1) the following condition holds: hl1\xe2\x80\x89+\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89hl2\xe2\x80\x89+\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x89hl1\xe2\x80\x89+\xe2\x80\x89hl2. John chose a few pieces of the fence and now wants to know how many distinct matching pieces are for each of them. Two pieces of the fence are distinct if there is a plank, which belongs to one of them and does not belong to the other one." 2900
232C "Doe Graphs" "constructive algorithms,divide and conquer,dp,graphs,shortest paths" "John Doe decided that some mathematical object must be named after him. So he invented the Doe graphs. The Doe graphs are a family of undirected graphs, each of them is characterized by a single non-negative number \xe2\x80\x94 its order. We\'ll denote a graph of order k as D(k), and we\'ll denote the number of vertices in the graph D(k) as |D(k)|. Then let\'s define the Doe graphs as follows:  D(0) consists of a single vertex, that has number 1.  D(1) consists of two vertices with numbers 1 and 2, connected by an edge.  D(n) for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 is obtained from graphs D(n\xe2\x80\x89-\xe2\x80\x891) and D(n\xe2\x80\x89-\xe2\x80\x892). D(n\xe2\x80\x89-\xe2\x80\x891) and D(n\xe2\x80\x89-\xe2\x80\x892) are joined in one graph, at that numbers of all vertices of graph D(n\xe2\x80\x89-\xe2\x80\x892) increase by |D(n\xe2\x80\x89-\xe2\x80\x891)| (for example, vertex number 1 of graph D(n\xe2\x80\x89-\xe2\x80\x892) becomes vertex number 1\xe2\x80\x89+\xe2\x80\x89|D(n\xe2\x80\x89-\xe2\x80\x891)|). After that two edges are added to the graph: the first one goes between vertices with numbers |D(n\xe2\x80\x89-\xe2\x80\x891)| and |D(n\xe2\x80\x89-\xe2\x80\x891)|\xe2\x80\x89+\xe2\x80\x891, the second one goes between vertices with numbers |D(n\xe2\x80\x89-\xe2\x80\x891)|\xe2\x80\x89+\xe2\x80\x891 and 1. Note that the definition of graph D(n) implies, that D(n) is a connected graph, its vertices are numbered from 1 to |D(n)|.   The picture shows the Doe graphs of order 1, 2, 3 and 4, from left to right. John thinks that Doe graphs are that great because for them exists a polynomial algorithm for the search of Hamiltonian path. However, your task is to answer queries of finding the shortest-length path between the vertices ai and bi in the graph D(n).A path between a pair of vertices u and v in the graph is a sequence of vertices x1, x2, ..., xk (k\xe2\x80\x89>\xe2\x80\x891) such, that x1\xe2\x80\x89=\xe2\x80\x89u, xk\xe2\x80\x89=\xe2\x80\x89v, and for any i (i\xe2\x80\x89<\xe2\x80\x89k) vertices xi and xi\xe2\x80\x89+\xe2\x80\x891 are connected by a graph edge. The length of path x1, x2, ..., xk is number (k\xe2\x80\x89-\xe2\x80\x891)." 2600
232B Table bitmasks,combinatorics,dp,math "John Doe has an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table. John Doe can paint points in some table cells, not more than one point in one table cell. John Doe wants to use such operations to make each square subtable of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n have exactly k points.John Doe wondered, how many distinct ways to fill the table with points are there, provided that the condition must hold. As this number can be rather large, John Doe asks to find its remainder after dividing by 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).You should assume that John always paints a point exactly in the center of some cell. Two ways to fill a table are considered distinct, if there exists a table cell, that has a point in one way and doesn\'t have it in the other." 1900
232A Cycles "binary search,constructive algorithms,graphs,greedy" "John Doe started thinking about graphs. After some thought he decided that he wants to paint an undirected graph, containing exactly k cycles of length 3. A cycle of length 3 is an unordered group of three distinct graph vertices a, b and c, such that each pair of them is connected by a graph edge. John has been painting for long, but he has not been a success. Help him find such graph. Note that the number of vertices there shouldn\'t exceed 100, or else John will have problems painting it." 1600
231E Cactus "data structures,dfs and similar,dp,graphs,trees" "A connected undirected graph is called a vertex cactus, if each vertex of this graph belongs to at most one simple cycle.A simple cycle in a undirected graph is a sequence of distinct vertices v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vt (t\xe2\x80\x89>\xe2\x80\x892), such that for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89t) exists an edge between vertices vi and vi\xe2\x80\x89+\xe2\x80\x891, and also exists an edge between vertices v1 and vt.A simple path in a undirected graph is a sequence of not necessarily distinct vertices v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vt (t\xe2\x80\x89>\xe2\x80\x890), such that for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89t) exists an edge between vertices vi and vi\xe2\x80\x89+\xe2\x80\x891 and furthermore each edge occurs no more than once. We\'ll say that a simple path v1,\xe2\x80\x89v2,\xe2\x80\x89...,\xe2\x80\x89vt starts at vertex v1 and ends at vertex vt.You\'ve got a graph consisting of n vertices and m edges, that is a vertex cactus. Also, you\'ve got a list of k pairs of interesting vertices xi,\xe2\x80\x89yi, for which you want to know the following information \xe2\x80\x94 the number of distinct simple paths that start at vertex xi and end at vertex yi. We will consider two simple paths distinct if the sets of edges of the paths are distinct.For each pair of interesting vertices count the number of distinct simple paths between them. As this number can be rather large, you should calculate it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2100
231D "Magic Box" "brute force,geometry" "One day Vasya was going home when he saw a box lying on the road. The box can be represented as a rectangular parallelepiped. Vasya needed no time to realize that the box is special, as all its edges are parallel to the coordinate axes, one of its vertices is at point (0,\xe2\x80\x890,\xe2\x80\x890), and the opposite one is at point (x1,\xe2\x80\x89y1,\xe2\x80\x89z1). The six faces of the box contain some numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89a6, exactly one number right in the center of each face.  The numbers are located on the box like that:   number a1 is written on the face that lies on the ZOX plane;  a2 is written on the face, parallel to the plane from the previous point;  a3 is written on the face that lies on the XOY plane;  a4 is written on the face, parallel to the plane from the previous point;  a5 is written on the face that lies on the YOZ plane;  a6 is written on the face, parallel to the plane from the previous point. At the moment Vasya is looking at the box from point (x,\xe2\x80\x89y,\xe2\x80\x89z). Find the sum of numbers that Vasya sees. Note that all faces of the box are not transparent and Vasya can\'t see the numbers through the box. The picture contains transparent faces just to make it easier to perceive. You can consider that if Vasya is looking from point, lying on the plane of some face, than he can not see the number that is written on this face. It is enough to see the center of a face to see the corresponding number for Vasya. Also note that Vasya always reads correctly the ai numbers that he sees, independently of their rotation, angle and other factors (that is, for example, if Vasya sees some ai\xe2\x80\x89=\xe2\x80\x896, then he can\'t mistake this number for 9 and so on)." 1600
231C "To Add or Not to Add" "binary search,sortings,two pointers" "A piece of paper contains an array of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to find a number that occurs the maximum number of times in this array.However, before looking for such number, you are allowed to perform not more than k following operations \xe2\x80\x94 choose an arbitrary element from the array and add 1 to it. In other words, you are allowed to increase some array element by 1 no more than k times (you are allowed to increase the same element of the array multiple times).Your task is to find the maximum number of occurrences of some number in the array after performing no more than k allowed operations. If there are several such numbers, your task is to find the minimum one." 1600
231B "Magic, Wizardry and Wonders" "constructive algorithms,greedy" "Vasya the Great Magician and Conjurer loves all kinds of miracles and wizardry. In one wave of a magic wand he can turn an object into something else. But, as you all know, there is no better magic in the Universe than the magic of numbers. That\'s why Vasya adores math and spends a lot of time turning some numbers into some other ones.This morning he has n cards with integers lined up in front of him. Each integer is not less than 1, but not greater than l. When Vasya waves his magic wand, two rightmost cards vanish from the line and a new card magically appears in their place. It contains the difference between the left and the right numbers on the two vanished cards. Vasya was very interested to know what would happen next, and so he waved with his magic wand on and on, until the table had a single card left.Suppose that Vasya originally had the following cards: 4, 1, 1, 3 (listed from left to right). Then after the first wave the line would be: 4, 1, -2, and after the second one: 4, 3, and after the third one the table would have a single card with number 1.Please note that in spite of the fact that initially all the numbers on the cards were not less than 1 and not greater than l, the numbers on the appearing cards can be anything, no restrictions are imposed on them.It is now evening. Vasya is very tired and wants to return everything back, but does not remember which cards he had in the morning. He only remembers that there were n cards, they contained integers from 1 to l, and after all magical actions he was left with a single card containing number d.Help Vasya to recover the initial set of cards with numbers." 1500
231A Team "brute force,greedy" "One day three best friends Petya, Vasya and Tonya decided to form a team and take part in programming contests. Participants are usually offered several problems during programming contests. Long before the start the friends decided that they will implement a problem if at least two of them are sure about the solution. Otherwise, the friends won\'t write the problem\'s solution.This contest offers n problems to the participants. For each problem we know, which friend is sure about the solution. Help the friends find the number of problems for which they will write a solution." 800
230B T-primes "binary search,implementation,math,number theory" "We know that prime numbers are positive integers that have exactly two distinct positive divisors. Similarly, we\'ll call a positive integer t \xd0\xa2-prime, if t has exactly three distinct positive divisors.You are given an array of n positive integers. For each of them determine whether it is \xd0\xa2-prime or not." 1300
230A Dragons greedy,sortings "Kirito is stuck on a level of the MMORPG he is playing now. To move on in the game, he\'s got to defeat all n dragons that live on this level. Kirito and the dragons have strength, which is represented by an integer. In the duel between two opponents the duel\'s outcome is determined by their strength. Initially, Kirito\'s strength equals s.If Kirito starts duelling with the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) dragon and Kirito\'s strength is not greater than the dragon\'s strength xi, then Kirito loses the duel and dies. But if Kirito\'s strength is greater than the dragon\'s strength, then he defeats the dragon and gets a bonus strength increase by yi.Kirito can fight the dragons in any order. Determine whether he can move on to the next level of the game, that is, defeat all dragons without a single loss." 1000
229E Gifts combinatorics,dp,math,probabilities "Once upon a time an old man and his wife lived by the great blue sea. One day the old man went fishing and caught a real live gold fish. The fish said: ""Oh ye, old fisherman! Pray set me free to the ocean and I will grant you with n gifts, any gifts you wish!"". Then the fish gave the old man a list of gifts and their prices. Some gifts on the list can have the same names but distinct prices. However, there can\'t be two gifts with the same names and the same prices. Also, there can be gifts with distinct names and the same prices. The old man can ask for n names of items from the list. If the fish\'s list has p occurrences of the given name, then the old man can\'t ask for this name of item more than p times.The old man knows that if he asks for s gifts of the same name, the fish will randomly (i.e. uniformly amongst all possible choices) choose s gifts of distinct prices with such name from the list. The old man wants to please his greedy wife, so he will choose the n names in such a way that he can get n gifts with the maximum price. Besides, he isn\'t the brightest of fishermen, so if there are several such ways, he chooses one of them uniformly.The old man wondered, what is the probability that he can get n most expensive gifts. As the old man isn\'t good at probability theory, he asks you to help him." 2600
229D Towers "dp,greedy,two pointers" "The city of D consists of n towers, built consecutively on a straight line. The height of the tower that goes i-th (from left to right) in the sequence equals hi. The city mayor decided to rebuild the city to make it beautiful. In a beautiful city all towers are are arranged in non-descending order of their height from left to right.The rebuilding consists of performing several (perhaps zero) operations. An operation constitutes using a crane to take any tower and put it altogether on the top of some other neighboring tower. In other words, we can take the tower that stands i-th and put it on the top of either the (i\xe2\x80\x89-\xe2\x80\x891)-th tower (if it exists), or the (i\xe2\x80\x89+\xe2\x80\x891)-th tower (of it exists). The height of the resulting tower equals the sum of heights of the two towers that were put together. After that the two towers can\'t be split by any means, but more similar operations can be performed on the resulting tower. Note that after each operation the total number of towers on the straight line decreases by 1.Help the mayor determine the minimum number of operations required to make the city beautiful." 2100
229C Triangles combinatorics,graphs,math "Alice and Bob don\'t play games anymore. Now they study properties of all sorts of graphs together. Alice invented the following task: she takes a complete undirected graph with n vertices, chooses some m edges and keeps them. Bob gets the  remaining edges.Alice and Bob are fond of ""triangles"" in graphs, that is, cycles of length 3. That\'s why they wonder: what total number of triangles is there in the two graphs formed by Alice and Bob\'s edges, correspondingly?" 1900
229B Planets "binary search,data structures,graphs,shortest paths" "Goa\'uld Apophis captured Jack O\'Neill\'s team again! Jack himself was able to escape, but by that time Apophis\'s ship had already jumped to hyperspace. But Jack knows on what planet will Apophis land. In order to save his friends, Jack must repeatedly go through stargates to get to this planet.Overall the galaxy has n planets, indexed with numbers from 1 to n. Jack is on the planet with index 1, and Apophis will land on the planet with index n. Jack can move between some pairs of planets through stargates (he can move in both directions); the transfer takes a positive, and, perhaps, for different pairs of planets unequal number of seconds. Jack begins his journey at time 0.It can be that other travellers are arriving to the planet where Jack is currently located. In this case, Jack has to wait for exactly 1 second before he can use the stargate. That is, if at time t another traveller arrives to the planet, Jack can only pass through the stargate at time t\xe2\x80\x89+\xe2\x80\x891, unless there are more travellers arriving at time t\xe2\x80\x89+\xe2\x80\x891 to the same planet.Knowing the information about travel times between the planets, and the times when Jack would not be able to use the stargate on particular planets, determine the minimum time in which he can get to the planet with index n." 1700
229A Shifts "brute force,two pointers" "You are given a table consisting of n rows and m columns. Each cell of the table contains a number, 0 or 1. In one move we can choose some row of the table and cyclically shift its values either one cell to the left, or one cell to the right.To cyclically shift a table row one cell to the right means to move the value of each cell, except for the last one, to the right neighboring cell, and to move the value of the last cell to the first cell. A cyclical shift of a row to the left is performed similarly, but in the other direction. For example, if we cyclically shift a row ""00110"" one cell to the right, we get a row ""00011"", but if we shift a row ""00110"" one cell to the left, we get a row ""01100"".Determine the minimum number of moves needed to make some table column consist only of numbers 1." 1500
228E "The Road to Berland is Paved With Good Intentions" "2-sat,dfs and similar,dsu,graphs" "Berland has n cities, some of them are connected by bidirectional roads. For each road we know whether it is asphalted or not.The King of Berland Valera II wants to asphalt all roads of Berland, for that he gathered a group of workers. Every day Valera chooses exactly one city and orders the crew to asphalt all roads that come from the city. The valiant crew fulfilled the King\'s order in a day, then workers went home.Unfortunately, not everything is as great as Valera II would like. The main part of the group were gastarbeiters \xe2\x80\x94 illegal immigrants who are enthusiastic but not exactly good at understanding orders in Berlandian. Therefore, having received orders to asphalt the roads coming from some of the city, the group asphalted all non-asphalted roads coming from the city, and vice versa, took the asphalt from the roads that had it.Upon learning of this progress, Valera II was very upset, but since it was too late to change anything, he asked you to make a program that determines whether you can in some way asphalt Berlandian roads in at most n days. Help the king." 1900
228D Zigzag "data structures" "The court wizard Zigzag wants to become a famous mathematician. For that, he needs his own theorem, like the Cauchy theorem, or his sum, like the Minkowski sum. But most of all he wants to have his sequence, like the Fibonacci sequence, and his function, like the Euler\'s totient function.The Zigag\'s sequence with the zigzag factor z is an infinite sequence Siz (i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891; z\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892), that is determined as follows:  Siz\xe2\x80\x89=\xe2\x80\x892, when ;  , when ;  , when . Operation  means taking the remainder from dividing number x by number y. For example, the beginning of sequence Si3 (zigzag factor 3) looks as follows: 1, 2, 3, 2, 1, 2, 3, 2, 1.Let\'s assume that we are given an array a, consisting of n integers. Let\'s define element number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of the array as ai. The Zigzag function is function , where l,\xe2\x80\x89r,\xe2\x80\x89z satisfy the inequalities 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, z\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892.To become better acquainted with the Zigzag sequence and the Zigzag function, the wizard offers you to implement the following operations on the given array a.  The assignment operation. The operation parameters are (p,\xe2\x80\x89v). The operation denotes assigning value v to the p-th array element. After the operation is applied, the value of the array element ap equals v.  The Zigzag operation. The operation parameters are (l,\xe2\x80\x89r,\xe2\x80\x89z). The operation denotes calculating the Zigzag function Z(l,\xe2\x80\x89r,\xe2\x80\x89z). Explore the magical powers of zigzags, implement the described operations." 2100
228C "Fractal Detector" dp,hashing "Little Vasya likes painting fractals very much.He does it like this. First the boy cuts out a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892-cell square out of squared paper. Then he paints some cells black. The boy calls the cut out square a fractal pattern. Then he takes a clean square sheet of paper and paints a fractal by the following algorithm:  He divides the sheet into four identical squares. A part of them is painted black according to the fractal pattern.  Each square that remained white, is split into 4 lesser white squares, some of them are painted according to the fractal pattern. Each square that remained black, is split into 4 lesser black squares.  In each of the following steps step 2 repeats. To draw a fractal, the boy can make an arbitrary positive number of steps of the algorithm. But he need to make at least two steps. In other words step 2 of the algorithm must be done at least once. The resulting picture (the square with painted cells) will be a fractal. The figure below shows drawing a fractal (here boy made three steps of the algorithm).  One evening Vasya got very tired, so he didn\'t paint the fractal, he just took a sheet of paper, painted a n\xe2\x80\x89\xc3\x97\xe2\x80\x89m-cell field. Then Vasya paint some cells black. Now he wonders, how many squares are on the field, such that there is a fractal, which can be obtained as described above, and which is equal to that square. Square is considered equal to some fractal if they consist of the same amount of elementary not divided cells and for each elementary cell of the square corresponding elementary cell of the fractal have the same color." 2000
228B "Two Tables" "brute force,implementation" "You\'ve got two rectangular tables with sizes na\xe2\x80\x89\xc3\x97\xe2\x80\x89ma and nb\xe2\x80\x89\xc3\x97\xe2\x80\x89mb cells. The tables consist of zeroes and ones. We will consider the rows and columns of both tables indexed starting from 1. Then we will define the element of the first table, located at the intersection of the i-th row and the j-th column, as ai,\xe2\x80\x89j; we will define the element of the second table, located at the intersection of the i-th row and the j-th column, as bi,\xe2\x80\x89j. We will call the pair of integers (x,\xe2\x80\x89y) a shift of the second table relative to the first one. We\'ll call the overlap factor of the shift (x,\xe2\x80\x89y) value:where the variables i,\xe2\x80\x89j take only such values, in which the expression ai,\xe2\x80\x89j\xc2\xb7bi\xe2\x80\x89+\xe2\x80\x89x,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89y makes sense. More formally, inequalities 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89na,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ma,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89nb,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89mb must hold. If there are no values of variables i,\xe2\x80\x89j, that satisfy the given inequalities, the value of the sum is considered equal to 0. Your task is to find the shift with the maximum overlap factor among all possible shifts." 1400
228A "Is your horseshoe on the other hoof?" implementation "Valera the Horse is going to the party with friends. He has been following the fashion trends for a while, and he knows that it is very popular to wear all horseshoes of different color. Valera has got four horseshoes left from the last year, but maybe some of them have the same color. In this case he needs to go to the store and buy some few more horseshoes, not to lose face in front of his stylish comrades.Fortunately, the store sells horseshoes of all colors under the sun and Valera has enough money to buy any four of them. However, in order to save the money, he would like to spend as little money as possible, so you need to help Valera and determine what is the minimum number of horseshoes he needs to buy to wear four horseshoes of different colors to a party." 800
227B "Effective Approach" implementation "Once at a team training Vasya, Petya and Sasha got a problem on implementing linear search in an array.According to the boys, linear search works as follows. The array elements in a pre-selected order are in turn compared with the number that you need to find. Once you find the array element that is equal to the required one, the search ends. The efficiency of the algorithm is the number of performed comparisons. The fewer comparisons the linear search has made, the more effective it is.Vasya believes that a linear search would work better if it sequentially iterates through the elements, starting with the 1-st one (in this problem we consider the elements of the array indexed from 1 to n) and ending with the n-th one. And Petya says that Vasya is wrong: the search will need less comparisons if it sequentially iterates the elements starting from the n-th and ending with the 1-st one. Sasha argues that the two approaches are equivalent.To finally begin the task, the teammates decided to settle the debate and compare the two approaches on an example. For this, they took an array that is a permutation of integers from 1 to n, and generated m queries of the form: find element with value bi in the array. They want to calculate for both approaches how many comparisons in total the linear search will need to respond to all queries. If the first search needs fewer comparisons, then the winner of the dispute is Vasya. If the second one does, then the winner is Petya. If both approaches make the same number of comparisons, then Sasha\'s got the upper hand.But the problem is, linear search is too slow. That\'s why the boys aren\'t going to find out who is right before the end of the training, unless you come in here. Help them to determine who will win the dispute." 1100
227A "Where do I Turn?" geometry "Trouble came from the overseas lands: a three-headed dragon Gorynych arrived. The dragon settled at point C and began to terrorize the residents of the surrounding villages.A brave hero decided to put an end to the dragon. He moved from point A to fight with Gorynych. The hero rode from point A along a straight road and met point B on his way. The hero knows that in this land for every pair of roads it is true that they are either parallel to each other, or lie on a straight line, or are perpendicular to each other. He also knows well that points B and C are connected by a road. So the hero must either turn 90 degrees to the left or continue riding straight ahead or turn 90 degrees to the right. But he forgot where the point C is located.Fortunately, a Brave Falcon flew right by. It can see all three points from the sky. The hero asked him what way to go to get to the dragon\'s lair.If you have not got it, you are the falcon. Help the hero and tell him how to get him to point C: turn left, go straight or turn right.At this moment the hero is believed to stand at point B, turning his back to point A." 1300
226E "Noble Knight\'s Path" "data structures,trees" "In Berland each feudal owns exactly one castle and each castle belongs to exactly one feudal.Each feudal, except one (the King) is subordinate to another feudal. A feudal can have any number of vassals (subordinates).Some castles are connected by roads, it is allowed to move along the roads in both ways. Two castles have a road between them if and only if the owner of one of these castles is a direct subordinate to the other owner.Each year exactly one of these two events may happen in Berland.  The barbarians attacked castle c. The interesting fact is, the barbarians never attacked the same castle twice throughout the whole Berlandian history.  A noble knight sets off on a journey from castle a to castle b (provided that on his path he encounters each castle not more than once). Let\'s consider the second event in detail. As the journey from a to b is not short, then the knight might want to stop at a castle he encounters on his way to have some rest. However, he can\'t stop at just any castle: his nobility doesn\'t let him stay in the castle that has been desecrated by the enemy\'s stench. A castle is desecrated if and only if it has been attacked after the year of y. So, the knight chooses the k-th castle he encounters, starting from a (castles a and b aren\'t taken into consideration), that hasn\'t been attacked in years from y\xe2\x80\x89+\xe2\x80\x891 till current year.The knights don\'t remember which castles were attacked on what years, so he asked the court scholar, aka you to help them. You\'ve got a sequence of events in the Berland history. Tell each knight, in what city he should stop or else deliver the sad news \xe2\x80\x94 that the path from city a to city b has less than k cities that meet his requirements, so the knight won\'t be able to rest." 2900
226D "The table" "constructive algorithms,greedy" "Harry Potter has a difficult homework. Given a rectangular table, consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells. Each cell of the table contains the integer. Harry knows how to use two spells: the first spell change the sign of the integers in the selected row, the second \xe2\x80\x94 in the selected column. Harry\'s task is to make non-negative the sum of the numbers in each row and each column using these spells.Alone, the boy can not cope. Help the young magician!" 2100
226C Anniversary "data structures,implementation,math,matrices,number theory" "There are less than 60 years left till the 900-th birthday anniversary of a famous Italian mathematician Leonardo Fibonacci. Of course, such important anniversary needs much preparations.Dima is sure that it\'ll be great to learn to solve the following problem by the Big Day: You\'re given a set A, consisting of numbers l, l\xe2\x80\x89+\xe2\x80\x891, l\xe2\x80\x89+\xe2\x80\x892, ..., r; let\'s consider all its k-element subsets; for each such subset let\'s find the largest common divisor of Fibonacci numbers with indexes, determined by the subset elements. Among all found common divisors, Dima is interested in the largest one.Dima asked to remind you that Fibonacci numbers are elements of a numeric sequence, where F1\xe2\x80\x89=\xe2\x80\x891, F2\xe2\x80\x89=\xe2\x80\x891, Fn\xe2\x80\x89=\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89Fn\xe2\x80\x89-\xe2\x80\x892 for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893.Dima has more than half a century ahead to solve the given task, but you only have two hours. Count the residue from dividing the sought largest common divisor by m." 2400
226B "Naughty Stone Piles" greedy "There are n piles of stones of sizes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an lying on the table in front of you.During one move you can take one pile and add it to the other. As you add pile i to pile j, the size of pile j increases by the current size of pile i, and pile i stops existing. The cost of the adding operation equals the size of the added pile.Your task is to determine the minimum cost at which you can gather all stones in one pile. To add some challenge, the stone piles built up conspiracy and decided that each pile will let you add to it not more than k times (after that it can only be added to another pile). Moreover, the piles decided to puzzle you completely and told you q variants (not necessarily distinct) of what k might equal. Your task is to find the minimum cost for each of q variants." 1900
226A "Flying Saucer Segments" math "An expedition group flew from planet ACM-1 to Earth in order to study the bipedal species (its representatives don\'t even have antennas on their heads!).The flying saucer, on which the brave pioneers set off, consists of three sections. These sections are connected by a chain: the 1-st section is adjacent only to the 2-nd one, the 2-nd one \xe2\x80\x94 to the 1-st and the 3-rd ones, the 3-rd one \xe2\x80\x94 only to the 2-nd one. The transitions are possible only between the adjacent sections.The spacecraft team consists of n aliens. Each of them is given a rank \xe2\x80\x94 an integer from 1 to n. The ranks of all astronauts are distinct. The rules established on the Saucer, state that an alien may move from section a to section b only if it is senior in rank to all aliens who are in the segments a and b (besides, the segments a and b are of course required to be adjacent). Any alien requires exactly 1 minute to make a move. Besides, safety regulations require that no more than one alien moved at the same minute along the ship.Alien A is senior in rank to alien B, if the number indicating rank A, is more than the corresponding number for B.At the moment the whole saucer team is in the 3-rd segment. They all need to move to the 1-st segment. One member of the crew, the alien with the identification number CFR-140, decided to calculate the minimum time (in minutes) they will need to perform this task.Help CFR-140, figure out the minimum time (in minutes) that all the astronauts will need to move from the 3-rd segment to the 1-st one. Since this number can be rather large, count it modulo m." 1400
225E Unsolvable "math,number theory" "Consider the following equation:  where sign [a] represents the integer part of number a.Let\'s find all integer z (z\xe2\x80\x89>\xe2\x80\x890), for which this equation is unsolvable in positive integers. The phrase ""unsolvable in positive integers"" means that there are no such positive integers x and y (x,\xe2\x80\x89y\xe2\x80\x89>\xe2\x80\x890), for which the given above equation holds.Let\'s write out all such z in the increasing order: z1,\xe2\x80\x89z2,\xe2\x80\x89z3, and so on (zi\xe2\x80\x89<\xe2\x80\x89zi\xe2\x80\x89+\xe2\x80\x891). Your task is: given the number n, find the number zn." 2100
225D Snake "bitmasks,dfs and similar,graphs,implementation" "Let us remind you the rules of a very popular game called ""Snake"" (or sometimes ""Boa"", ""Python"" or ""Worm"").The game field is represented by an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rectangular table. Some squares of the field are considered impassable (walls), all other squares of the fields are passable.You control a snake, the snake consists of segments. Each segment takes up exactly one passable square of the field, but any passable square contains at most one segment. All segments are indexed by integers from 1 to k, where k is the snake\'s length. The 1-th segment is the head and the k-th segment is the tail. For any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k), segments with indexes i and i\xe2\x80\x89+\xe2\x80\x891 are located in the adjacent squares of the field, that is, these squares share a common side.One of the passable field squares contains an apple. The snake\'s aim is to reach the apple and eat it (that is, to position its head in the square with the apple).The snake moves throughout the game. During one move the snake can move its head to an adjacent field square. All other segments follow the head. That is, each segment number i (1\xe2\x80\x89<\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) moves to the square that has just had segment number i\xe2\x80\x89-\xe2\x80\x891. Consider that all segments including the head move simultaneously (see the second test sample). If the snake\'s head moves to an unpassable square or to the square, occupied by its other segment, the snake dies. That\'s why we will consider such moves unvalid.Your task is to determine the minimum number of valid moves that the snake needs to reach the apple." 2200
225C Barcode dp,matrices "You\'ve got an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m pixel picture. Each pixel can be white or black. Your task is to change the colors of as few pixels as possible to obtain a barcode picture.A picture is a barcode if the following conditions are fulfilled:   All pixels in each column are of the same color.  The width of each monochrome vertical line is at least x and at most y pixels. In other words, if we group all neighbouring columns of the pixels with equal color, the size of each group can not be less than x or greater than y." 1700
225B "Well-known Numbers" "binary search,greedy,number theory" "Numbers k-bonacci (k is integer, k\xe2\x80\x89>\xe2\x80\x891) are a generalization of Fibonacci numbers and are determined as follows:  F(k,\xe2\x80\x89n)\xe2\x80\x89=\xe2\x80\x890, for integer n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89<\xe2\x80\x89k;  F(k,\xe2\x80\x89k)\xe2\x80\x89=\xe2\x80\x891;  F(k,\xe2\x80\x89n)\xe2\x80\x89=\xe2\x80\x89F(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89F(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89F(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k), for integer n, n\xe2\x80\x89>\xe2\x80\x89k. Note that we determine the k-bonacci numbers, F(k,\xe2\x80\x89n), only for integer values of n and k.You\'ve got a number s, represent it as a sum of several (at least two) distinct k-bonacci numbers." 1600
225A "Dice Tower" "constructive algorithms,greedy" "A dice is a cube, its faces contain distinct integers from 1 to 6 as black points. The sum of numbers at the opposite dice faces always equals 7. Please note that there are only two dice (these dices are mirror of each other) that satisfy the given constraints (both of them are shown on the picture on the left).  Alice and Bob play dice. Alice has built a tower from n dice. We know that in this tower the adjacent dice contact with faces with distinct numbers. Bob wants to uniquely identify the numbers written on the faces of all dice, from which the tower is built. Unfortunately, Bob is looking at the tower from the face, and so he does not see all the numbers on the faces. Bob sees the number on the top of the tower and the numbers on the two adjacent sides (on the right side of the picture shown what Bob sees).Help Bob, tell whether it is possible to uniquely identify the numbers on the faces of all the dice in the tower, or not." 1100
224B Array "bitmasks,implementation,two pointers" "You\'ve got an array a, consisting of n integers: a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Your task is to find a minimal by inclusion segment [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such, that among numbers al,\xe2\x80\x89 al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89 ...,\xe2\x80\x89 ar there are exactly k distinct numbers.Segment [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; l,\xe2\x80\x89r are integers) of length m\xe2\x80\x89=\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891, satisfying the given property, is called minimal by inclusion, if there is no segment [x,\xe2\x80\x89y] satisfying the property and less then m in length, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Note that the segment [l,\xe2\x80\x89r] doesn\'t have to be minimal in length among all segments, satisfying the given property." 1500
224A Parallelepiped "brute force,geometry,math" "You\'ve got a rectangular parallelepiped with integer edge lengths. You know the areas of its three faces that have a common vertex. Your task is to find the sum of lengths of all 12 edges of this parallelepiped." 1100
223E "Planar Graph" flows,geometry,graphs "A graph is called planar, if it can be drawn in such a way that its edges intersect only at their vertexes.An articulation point is such a vertex of an undirected graph, that when removed increases the number of connected components of the graph.A bridge is such an edge of an undirected graph, that when removed increases the number of connected components of the graph.You\'ve got a connected undirected planar graph consisting of n vertexes, numbered from 1 to n, drawn on the plane. The graph has no bridges, articulation points, loops and multiple edges. You are also given q queries. Each query is a cycle in the graph. The query response is the number of graph vertexes, which (if you draw a graph and the cycle on the plane) are located either inside the cycle, or on it. Write a program that, given the graph and the queries, will answer each query." 3000
223D Spider geometry,graphs "A plane contains a not necessarily convex polygon without self-intersections, consisting of n vertexes, numbered from 1 to n. There is a spider sitting on the border of the polygon, the spider can move like that:  Transfer. The spider moves from the point p1 with coordinates (x1,\xe2\x80\x89y1), lying on the polygon border, to the point p2 with coordinates (x2,\xe2\x80\x89y2), also lying on the border. The spider can\'t go beyond the polygon border as it transfers, that is, the spider\'s path from point p1 to point p2 goes along the polygon border. It\'s up to the spider to choose the direction of walking round the polygon border (clockwise or counterclockwise).  Descend. The spider moves from point p1 with coordinates (x1,\xe2\x80\x89y1) to point p2 with coordinates (x2,\xe2\x80\x89y2), at that points p1 and p2 must lie on one vertical straight line (x1\xe2\x80\x89=\xe2\x80\x89x2), point p1 must be not lower than point p2 (y1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89y2) and segment p1p2 mustn\'t have points, located strictly outside the polygon (specifically, the segment can have common points with the border). Initially the spider is located at the polygon vertex with number s. Find the length of the shortest path to the vertex number t, consisting of transfers and descends. The distance is determined by the usual Euclidean metric ." 3000
223C "Partial Sums" "combinatorics,math,number theory" "You\'ve got an array a, consisting of n integers. The array elements are indexed from 1 to n. Let\'s determine a two step operation like that:  First we build by the array a an array s of partial sums, consisting of n elements. Element number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of array s equals . The operation x mod y means that we take the remainder of the division of number x by number y.  Then we write the contents of the array s to the array a. Element number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of the array s becomes the i-th element of the array a (ai\xe2\x80\x89=\xe2\x80\x89si). You task is to find array a after exactly k described operations are applied." 1900
223B "Two Strings" "data structures,dp,strings" "A subsequence of length |x| of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (where |s| is the length of string s) is a string x\xe2\x80\x89=\xe2\x80\x89sk1sk2... sk|x| (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k1\xe2\x80\x89<\xe2\x80\x89k2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89k|x|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|).You\'ve got two strings \xe2\x80\x94 s and t. Let\'s consider all subsequences of string s, coinciding with string t. Is it true that each character of string s occurs in at least one of these subsequences? In other words, is it true that for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|), there is such subsequence x\xe2\x80\x89=\xe2\x80\x89sk1sk2... sk|x| of string s, that x\xe2\x80\x89=\xe2\x80\x89t and for some j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|x|) kj\xe2\x80\x89=\xe2\x80\x89i." 1900
223A "Bracket Sequence" "data structures,expression parsing,implementation" "A bracket sequence is a string, containing only characters ""("", "")"", ""["" and ""]"".A correct bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()[]"", ""([])"" are correct (the resulting expressions are: ""(1)+[1]"", ""([1+1]+1)""), and ""]("" and ""["" are not. The empty string is a correct bracket sequence by definition.A substring s[l... r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s| (where |s| is the length of string s) is the string slsl\xe2\x80\x89+\xe2\x80\x891... sr. The empty string is a substring of any string by definition.You are given a bracket sequence, not necessarily correct. Find its substring which is a correct bracket sequence and contains as many opening square brackets \xc2\xab[\xc2\xbb as possible." 1700
222E "Decoding Genome" dp,matrices "Recently a top secret mission to Mars has taken place. As a result, scientists managed to obtain some information about the Martian DNA. Now we know that any Martian DNA contains at most m different nucleotides, numbered from 1 to m. Special characteristics of the Martian DNA prevent some nucleotide pairs from following consecutively in this chain. For example, if the nucleotide 1 and nucleotide 2 can not follow consecutively in the Martian DNA, then the chain of nucleotides [1, 2] is not a valid chain of Martian DNA, but the chain of nucleotides [2, 1] can be a valid chain (if there is no corresponding restriction). The number of nucleotide pairs that can\'t follow in the DNA chain consecutively, is k. The needs of gene research required information about the quantity of correct n-long chains of the Martian DNA. Your task is to write a program that will calculate this value." 1900
222D Olympiad "binary search,greedy,sortings,two pointers" "A boy named Vasya has taken part in an Olympiad. His teacher knows that in total Vasya got at least x points for both tours of the Olympiad. The teacher has the results of the first and the second tour of the Olympiad but the problem is, the results have only points, no names. The teacher has to know Vasya\'s chances.Help Vasya\'s teacher, find two numbers \xe2\x80\x94 the best and the worst place Vasya could have won. Note that the total results\' table sorts the participants by the sum of points for both tours (the first place has the participant who has got the most points). If two or more participants have got the same number of points, it\'s up to the jury to assign places to them according to their choice. It is guaranteed that each participant of the Olympiad participated in both tours of the Olympiad." 1900
222C "Reducing Fractions" "implementation,math,number theory,sortings" "To confuse the opponents, the Galactic Empire represents fractions in an unusual format. The fractions are represented as two sets of integers. The product of numbers from the first set gives the fraction numerator, the product of numbers from the second set gives the fraction denominator. However, it turned out that the programs that work with fractions in this representations aren\'t complete, they lack supporting the operation of reducing fractions. Implement this operation and the Empire won\'t forget you." 1800
222B "Cosmic Tables" "data structures,implementation" "The Free Meteor Association (FMA) has got a problem: as meteors are moving, the Universal Cosmic Descriptive Humorous Program (UCDHP) needs to add a special module that would analyze this movement. UCDHP stores some secret information about meteors as an n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table with integers in its cells. The order of meteors in the Universe is changing. That\'s why the main UCDHP module receives the following queries:  The query to swap two table rows;  The query to swap two table columns;  The query to obtain a secret number in a particular table cell. As the main UCDHP module is critical, writing the functional of working with the table has been commissioned to you." 1300
222A "Shooshuns and Sequence" "brute force,implementation" "One day shooshuns found a sequence of n integers, written on a blackboard. The shooshuns can perform one operation with it, the operation consists of two steps:  Find the number that goes k-th in the current sequence and add the same number to the end of the sequence;  Delete the first number of the current sequence. The shooshuns wonder after how many operations all numbers on the board will be the same and whether all numbers will ever be the same." 1200
221B "Little Elephant and Numbers" implementation "The Little Elephant loves numbers. He has a positive integer x. The Little Elephant wants to find the number of positive integers d, such that d is the divisor of x, and x and d have at least one common (the same) digit in their decimal representations. Help the Little Elephant to find the described number." 1300
221A "Little Elephant and Function" implementation,math "The Little Elephant enjoys recursive functions.This time he enjoys the sorting function. Let a is a permutation of an integers from 1 to n, inclusive, and ai denotes the i-th element of the permutation. The Little Elephant\'s recursive function f(x), that sorts the first x permutation\'s elements, works as follows:  If x\xe2\x80\x89=\xe2\x80\x891, exit the function.  Otherwise, call f(x\xe2\x80\x89-\xe2\x80\x891), and then make swap(ax\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ax) (swap the x-th and (x\xe2\x80\x89-\xe2\x80\x891)-th elements of a). The Little Elephant\'s teacher believes that this function does not work correctly. But that-be do not get an F, the Little Elephant wants to show the performance of its function. Help him, find a permutation of numbers from 1 to n, such that after performing the Little Elephant\'s function (that is call f(n)), the permutation will be sorted in ascending order." 1000
220E "Little Elephant and Inversions" "data structures,two pointers" "The Little Elephant has array a, consisting of n positive integers, indexed from 1 to n. Let\'s denote the number with index i as ai.The Little Elephant wants to count, how many pairs of integers l and r are there, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and sequence b\xe2\x80\x89=\xe2\x80\x89a1a2... alarar\xe2\x80\x89+\xe2\x80\x891... an has no more than k inversions. An inversion in sequence b is a pair of elements of the sequence b, that change their relative order after a stable sorting of the sequence. In other words, an inversion is a pair of integers i and j, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|b| and bi\xe2\x80\x89>\xe2\x80\x89bj, where |b| is the length of sequence b, and bj is its j-th element.Help the Little Elephant and count the number of the described pairs." 2400
220D "Little Elephant and Triangle" geometry,math "The Little Elephant is playing with the Cartesian coordinates\' system. Most of all he likes playing with integer points. The Little Elephant defines an integer point as a pair of integers (x; y), such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89w and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h. Thus, the Little Elephant knows only (w\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(h\xe2\x80\x89+\xe2\x80\x891) distinct integer points.The Little Elephant wants to paint a triangle with vertexes at integer points, the triangle\'s area must be a positive integer. For that, he needs to find the number of groups of three points that form such triangle. At that, the order of points in a group matters, that is, the group of three points (0;0), (0;2), (2;2) isn\'t equal to the group (0;2), (0;0), (2;2).Help the Little Elephant to find the number of groups of three integer points that form a nondegenerate triangle with integer area." 2500
220C "Little Elephant and Shifts" "data structures" "The Little Elephant has two permutations a and b of length n, consisting of numbers from 1 to n, inclusive. Let\'s denote the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) element of the permutation a as ai, the j-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) element of the permutation b \xe2\x80\x94 as bj.The distance between permutations a and b is the minimum absolute value of the difference between the positions of the occurrences of some number in a and in b. More formally, it\'s such minimum |i\xe2\x80\x89-\xe2\x80\x89j|, that ai\xe2\x80\x89=\xe2\x80\x89bj.A cyclic shift number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of permutation b consisting from n elements is a permutation bibi\xe2\x80\x89+\xe2\x80\x891... bnb1b2... bi\xe2\x80\x89-\xe2\x80\x891. Overall a permutation has n cyclic shifts.The Little Elephant wonders, for all cyclic shifts of permutation b, what is the distance between the cyclic shift and permutation a?" 2100
220B "Little Elephant and Array" "constructive algorithms,data structures" "The Little Elephant loves playing with arrays. He has array a, consisting of n positive integers, indexed from 1 to n. Let\'s denote the number with index i as ai. Additionally the Little Elephant has m queries to the array, each query is characterised by a pair of integers lj and rj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89lj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). For each query lj,\xe2\x80\x89rj the Little Elephant has to count, how many numbers x exist, such that number x occurs exactly x times among numbers alj,\xe2\x80\x89alj\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89arj.Help the Little Elephant to count the answers to all queries." 1800
220A "Little Elephant and Problem" implementation,sortings "The Little Elephant has got a problem \xe2\x80\x94 somebody has been touching his sorted by non-decreasing array a of length n and possibly swapped some elements of the array.The Little Elephant doesn\'t want to call the police until he understands if he could have accidentally changed the array himself. He thinks that he could have accidentally changed array a, only if array a can be sorted in no more than one operation of swapping elements (not necessarily adjacent). That is, the Little Elephant could have accidentally swapped some two elements.Help the Little Elephant, determine if he could have accidentally changed the array a, sorted by non-decreasing, himself." 1300
219E "Parking Lot" "data structures" "A parking lot in the City consists of n parking spaces, standing in a line. The parking spaces are numbered from 1 to n from left to right. When a car arrives at the lot, the operator determines an empty parking space for it. For the safety\'s sake the chosen place should be located as far from the already occupied places as possible. That is, the closest occupied parking space must be as far away as possible. If there are several such places, then the operator chooses the place with the minimum index from them. If all parking lot places are empty, then the car gets place number 1.We consider the distance between the i-th and the j-th parking spaces equal to 4\xc2\xb7|i\xe2\x80\x89-\xe2\x80\x89j| meters.You are given the parking lot records of arriving and departing cars in the chronological order. For each record of an arriving car print the number of the parking lot that was given to this car." 2200
219D "Choosing Capital for Treeland" "dfs and similar,dp,graphs,trees" "The country Treeland consists of n cities, some pairs of them are connected with unidirectional roads. Overall there are n\xe2\x80\x89-\xe2\x80\x891 roads in the country. We know that if we don\'t take the direction of the roads into consideration, we can get from any city to any other one.The council of the elders has recently decided to choose the capital of Treeland. Of course it should be a city of this country. The council is supposed to meet in the capital and regularly move from the capital to other cities (at this stage nobody is thinking about getting back to the capital from these cities). For that reason if city a is chosen a capital, then all roads must be oriented so that if we move along them, we can get from city a to any other city. For that some roads may have to be inversed.Help the elders to choose the capital so that they have to inverse the minimum number of roads in the country." 1700
219C "Color Stripe" "brute force,dp,greedy" "A colored stripe is represented by a horizontal row of n square cells, each cell is pained one of k colors. Your task is to repaint the minimum number of cells so that no two neighbouring cells are of the same color. You can use any color from 1 to k to repaint the cells." 1600
219B "Special Offer! Super Price 999 Bourles!" implementation "Polycarpus is an amateur businessman. Recently he was surprised to find out that the market for paper scissors is completely free! Without further ado, Polycarpus decided to start producing and selling such scissors.Polycaprus calculated that the optimal celling price for such scissors would be p bourles. However, he read somewhere that customers are attracted by prices that say something like ""Special Offer! Super price 999 bourles!"". So Polycarpus decided to lower the price a little if it leads to the desired effect.Polycarpus agrees to lower the price by no more than d bourles so that the number of nines at the end of the resulting price is maximum. If there are several ways to do it, he chooses the maximum possible price.Note, Polycarpus counts only the trailing nines in a price." 1400
219A k-String implementation,strings "A string is called a k-string if it can be represented as k concatenated copies of some string. For example, the string ""aabaabaabaab"" is at the same time a 1-string, a 2-string and a 4-string, but it is not a 3-string, a 5-string, or a 6-string and so on. Obviously any string is a 1-string.You are given a string s, consisting of lowercase English letters and a positive integer k. Your task is to reorder the letters in the string s in such a way that the resulting string is a k-string." 1000
218B Airport implementation "Lolek and Bolek are about to travel abroad by plane. The local airport has a special ""Choose Your Plane"" offer. The offer\'s conditions are as follows:  it is up to a passenger to choose a plane to fly on;  if the chosen plane has x (x\xe2\x80\x89>\xe2\x80\x890) empty seats at the given moment, then the ticket for such a plane costs x zlotys (units of Polish currency). The only ticket office of the airport already has a queue of n passengers in front of it. Lolek and Bolek have not stood in the queue yet, but they are already wondering what is the maximum and the minimum number of zlotys the airport administration can earn if all n passengers buy tickets according to the conditions of this offer?The passengers buy tickets in turn, the first person in the queue goes first, then goes the second one, and so on up to n-th person." 1100
218A "Mountain Scenery" "brute force,constructive algorithms,implementation" "Little Bolek has found a picture with n mountain peaks painted on it. The n painted peaks are represented by a non-closed polyline, consisting of 2n segments. The segments go through 2n\xe2\x80\x89+\xe2\x80\x891 points with coordinates (1,\xe2\x80\x89y1), (2,\xe2\x80\x89y2), ..., (2n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y2n\xe2\x80\x89+\xe2\x80\x891), with the i-th segment connecting the point (i,\xe2\x80\x89yi) and the point (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891). For any even i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n) the following condition holds: yi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89yi and yi\xe2\x80\x89>\xe2\x80\x89yi\xe2\x80\x89+\xe2\x80\x891. We shall call a vertex of a polyline with an even x coordinate a mountain peak.   The figure to the left shows the initial picture, the figure to the right shows what the picture looks like after Bolek\'s actions. The affected peaks are marked red, k = 2.  Bolek fancied a little mischief. He chose exactly k mountain peaks, rubbed out the segments that went through those peaks and increased each peak\'s height by one (that is, he increased the y coordinate of the corresponding points). Then he painted the missing segments to get a new picture of mountain peaks. Let us denote the points through which the new polyline passes on Bolek\'s new picture as (1,\xe2\x80\x89r1), (2,\xe2\x80\x89r2), ..., (2n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89r2n\xe2\x80\x89+\xe2\x80\x891).Given Bolek\'s final picture, restore the initial one." 1100
217E "Alien DNA" "data structures,dsu,trees" "Professor Bajtocy is conducting experiments on alien DNA. He has discovered that it is subject to repetitive mutations \xe2\x80\x94 each mutation happens in the same way: some continuous subsequence of the alien DNA becomes active, copies itself, the copy gets mangled and inserts itself right after the original subsequence. The mangled copy of the activated continuous subsequence is formed by first joining all the elements at the even positions in that subsequence, and then joining all the elements at the odd ones at the end. That is, if the activated subsequence consists of 11 elements and represented as s1s2... s11, its mangled copy is s2s4s6s8s10s1s3s5s7s9s11.For example, if the original sequence was ""ACTGG"" and the mutation happened on the segment [2,\xe2\x80\x894] (that is the activated subsequence is ""CTG""), the mutated DNA is: ""ACTGTCGG"". The mangled copy of the activated subsequence is marked with bold font.Professor Bajtocy has written down the original DNA sequence and the mutations that sequentially happened to it, and he now asks you to recover the first k elements of the DNA sequence after all the mutations." 2800
217D "Bitonix\' Patrol" "bitmasks,brute force,combinatorics,dfs and similar,math" "Byteland is trying to send a space mission onto the Bit-X planet. Their task is complicated by the fact that the orbit of the planet is regularly patrolled by Captain Bitonix, the leader of the space forces of Bit-X.There are n stations around Bit-X numbered clockwise from 1 to n. The stations are evenly placed on a circular orbit, so the stations number i and i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), and the stations number 1 and n, are neighboring. The distance between every pair of adjacent stations is equal to m space miles. To go on a patrol, Captain Bitonix jumps in his rocket at one of the stations and flies in a circle, covering a distance of at least one space mile, before finishing in some (perhaps the starting) station.Bitonix\' rocket moves by burning fuel tanks. After Bitonix attaches an x-liter fuel tank and chooses the direction (clockwise or counter-clockwise), the rocket flies exactly x space miles along a circular orbit in the chosen direction. Note that the rocket has no brakes; it is not possible for the rocket to stop before depleting a fuel tank.For example, assume that n\xe2\x80\x89=\xe2\x80\x893 and m\xe2\x80\x89=\xe2\x80\x8960 and Bitonix has fuel tanks with volumes of 10, 60, 90 and 100 liters. If Bitonix starts from station 1, uses the 100-liter fuel tank to go clockwise, then uses the 90-liter fuel tank to go clockwise, and then uses the 10-liter fuel tank to go counterclockwise, he will finish back at station 1. This constitutes a valid patrol. Note that Bitonix does not have to use all available fuel tanks. Another valid option for Bitonix in this example would be to simply use the 60-liter fuel tank to fly to either station 2 or 3.However, if n was equal to 3, m was equal to 60 and the only fuel tanks available to Bitonix were one 10-liter tank and one 100-liter tank, he would have no way of completing a valid patrol (he wouldn\'t be able to finish any patrol exactly at the station).The Byteland space agency wants to destroy some of Captain Bitonix\' fuel tanks so that he cannot to complete any valid patrol. Find how many different subsets of the tanks the agency can destroy to prevent Captain Bitonix from completing a patrol and output the answer modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2900
217C Formurosa "divide and conquer,dp,expression parsing" "The Bytelandian Institute for Biological Research (BIBR) is investigating the properties of two species of bacteria, named simply 0 and 1. Even under a microscope, bacteria of those two species are very difficult to distinguish. In fact, the only thing the scientists possess that is able to differentiate between them is a plant called Formurosa.If the scientists place a sample of colonies of bacteria on each on Formurosa\'s leaves, it will activate a complicated nutrition process. During that process color of Formurosa changes to reflect the result of a \xe2\x80\x94 possibly very complicated \xe2\x80\x94 logical formula on the species of bacteria, involving constants and the operators | (OR), & (AND) and ^ (XOR). If it is 0, the plant will turn red, otherwise \xe2\x80\x94 it will turn blue.For example, if the nutrition process of Formurosa is described by the formula: (((?^?)|?)&(1^?)); then Formurosa has four leaves (the ""?"" signs denote the leaves). If we place 0,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x890 on the respective leaves, the result of the nutrition process will be (((0^1)|0)&(1^0))\xe2\x80\x89=\xe2\x80\x891, therefore the plant will turn blue.The scientists have n colonies of bacteria. They do not know their types; the only thing they know for sure is that not all colonies are of the same type. They want to attempt to determine the bacteria\'s species by repeated evaluations with Formurosa. During each evaluation they must place exactly one sample on every leaf of the plant. However, they may use multiple samples of one colony during a single evaluation; they can even cover the whole plant with bacteria from one colony!Is it possible for them to always determine the species of each colony, no matter what they are (assuming they are not all the same)?" 2600
217B "Blackboard Fibonacci" "brute force,math" "Fibonacci numbers are the sequence of integers: f0\xe2\x80\x89=\xe2\x80\x890, f1\xe2\x80\x89=\xe2\x80\x891, f2\xe2\x80\x89=\xe2\x80\x891, f3\xe2\x80\x89=\xe2\x80\x892, f4\xe2\x80\x89=\xe2\x80\x893, f5\xe2\x80\x89=\xe2\x80\x895, ..., fn\xe2\x80\x89=\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x891. So every next number is the sum of the previous two.Bajtek has developed a nice way to compute Fibonacci numbers on a blackboard. First, he writes a 0. Then, below it, he writes a 1. Then he performs the following two operations:  operation ""T"": replace the top number with the sum of both numbers;  operation ""B"": replace the bottom number with the sum of both numbers. If he performs n operations, starting with ""T"" and then choosing operations alternately (so that the sequence of operations looks like ""TBTBTBTB...""), the last number written will be equal to fn\xe2\x80\x89+\xe2\x80\x891.Unfortunately, Bajtek sometimes makes mistakes and repeats an operation two or more times in a row. For example, if Bajtek wanted to compute f7, then he would want to do n\xe2\x80\x89=\xe2\x80\x896 operations: ""TBTBTB"". If he instead performs the sequence of operations ""TTTBBT"", then he will have made 3 mistakes, and he will incorrectly compute that the seventh Fibonacci number is 10. The number of mistakes in the sequence of operations is the number of neighbouring equal operations (\xc2\xabTT\xc2\xbb or \xc2\xabBB\xc2\xbb).You are given the number n of operations that Bajtek has made in an attempt to compute fn\xe2\x80\x89+\xe2\x80\x891 and the number r that is the result of his computations (that is last written number). Find the minimum possible number of mistakes that Bajtek must have made and any possible sequence of n operations resulting in r with that number of mistakes.Assume that Bajtek always correctly starts with operation ""T""." 2100
217A "Ice Skating" "brute force,dfs and similar,dsu,graphs" "Bajtek is learning to skate on ice. He\'s a beginner, so his only mode of transportation is pushing off from a snow drift to the north, east, south or west and sliding until he lands in another snow drift. He has noticed that in this way it\'s impossible to get from some snow drifts to some other by any sequence of moves. He now wants to heap up some additional snow drifts, so that he can get from any snow drift to any other one. He asked you to find the minimal number of snow drifts that need to be created.We assume that Bajtek can only heap up snow drifts at integer coordinates." 1200
216E "Martian Luck" "math,number theory" "You know that the Martians use a number system with base k. Digit b (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89k) is considered lucky, as the first contact between the Martians and the Earthlings occurred in year b (by Martian chronology).A digital root d(x) of number x is a number that consists of a single digit, resulting after cascading summing of all digits of number x. Word ""cascading"" means that if the first summing gives us a number that consists of several digits, then we sum up all digits again, and again, until we get a one digit number.For example, d(35047)\xe2\x80\x89=\xe2\x80\x89d((3\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89+\xe2\x80\x894)7)\xe2\x80\x89=\xe2\x80\x89d(157)\xe2\x80\x89=\xe2\x80\x89d((1\xe2\x80\x89+\xe2\x80\x895)7)\xe2\x80\x89=\xe2\x80\x89d(67)\xe2\x80\x89=\xe2\x80\x8967. In this sample the calculations are performed in the 7-base notation.If a number\'s digital root equals b, the Martians also call this number lucky.You have string s, which consists of n digits in the k-base notation system. Your task is to find, how many distinct substrings of the given string are lucky numbers. Leading zeroes are permitted in the numbers.Note that substring s[i... j] of the string s\xe2\x80\x89=\xe2\x80\x89a1a2... an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is the string aiai\xe2\x80\x89+\xe2\x80\x891... aj. Two substrings s[i1... j1] and s[i2... j2] of the string s are different if either i1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i2 or j1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j2." 2000
216D "Spider\'s Web" "binary search,sortings,two pointers" "Paw the Spider is making a web. Web-making is a real art, Paw has been learning to do it his whole life. Let\'s consider the structure of the web.  There are n main threads going from the center of the web. All main threads are located in one plane and divide it into n equal infinite sectors. The sectors are indexed from 1 to n in the clockwise direction. Sectors i and i\xe2\x80\x89+\xe2\x80\x891 are adjacent for every i, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n. In addition, sectors 1 and n are also adjacent.Some sectors have bridge threads. Each bridge connects the two main threads that make up this sector. The points at which the bridge is attached to the main threads will be called attachment points. Both attachment points of a bridge are at the same distance from the center of the web. At each attachment point exactly one bridge is attached. The bridges are adjacent if they are in the same sector, and there are no other bridges between them.A cell of the web is a trapezoid, which is located in one of the sectors and is bounded by two main threads and two adjacent bridges. You can see that the sides of the cell may have the attachment points of bridges from adjacent sectors. If the number of attachment points on one side of the cell is not equal to the number of attachment points on the other side, it creates an imbalance of pulling forces on this cell and this may eventually destroy the entire web. We\'ll call such a cell unstable. The perfect web does not contain unstable cells.Unstable cells are marked red in the figure. Stable cells are marked green.Paw the Spider isn\'t a skillful webmaker yet, he is only learning to make perfect webs. Help Paw to determine the number of unstable cells in the web he has just spun." 1700
216C "Hiring Staff" greedy "A new Berland businessman Vitaly is going to open a household appliances\' store. All he\'s got to do now is to hire the staff.The store will work seven days a week, but not around the clock. Every day at least k people must work in the store.Berland has a law that determines the order of working days and non-working days. Namely, each employee must work for exactly n consecutive days, then rest for exactly m days, then work for n more days and rest for m more, and so on. Vitaly doesn\'t want to break the law. Fortunately, there is a loophole: the law comes into force on the day when the employee is hired. For example, if an employee is hired on day x, then he should work on days [x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891], [x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x89n,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x89n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x892n\xe2\x80\x89-\xe2\x80\x891], and so on. Day x can be chosen arbitrarily by Vitaly.There is one more thing: the key to the store. Berland law prohibits making copies of keys, so there is only one key. Vitaly is planning to entrust the key to the store employees. At the same time on each day the key must be with an employee who works that day \xe2\x80\x94 otherwise on this day no one can get inside the store. During the day the key holder can give the key to another employee, if he also works that day. The key will handed to the first hired employee at his first working day.Each employee has to be paid salary. Therefore, Vitaly wants to hire as few employees as possible provided that the store can operate normally on each day from 1 to infinity. In other words, on each day with index from 1 to infinity, the store must have at least k working employees, and one of the working employees should have the key to the store.Help Vitaly and determine the minimum required number of employees, as well as days on which they should be hired." 1800
216B "Forming Teams" "dfs and similar,implementation" "One day n students come to the stadium. They want to play football, and for that they need to split into teams, the teams must have an equal number of people.We know that this group of people has archenemies. Each student has at most two archenemies. Besides, if student A is an archenemy to student B, then student B is an archenemy to student A.The students want to split so as no two archenemies were in one team. If splitting in the required manner is impossible, some students will have to sit on the bench.Determine the minimum number of students you will have to send to the bench in order to form the two teams in the described manner and begin the game at last." 1700
216A "Tiling with Hexagons" implementation,math "Several ages ago Berland was a kingdom. The King of Berland adored math. That\'s why, when he first visited one of his many palaces, he first of all paid attention to the floor in one hall. The floor was tiled with hexagonal tiles.The hall also turned out hexagonal in its shape. The King walked along the perimeter of the hall and concluded that each of the six sides has a, b, c, a, b and c adjacent tiles, correspondingly.To better visualize the situation, look at the picture showing a similar hexagon for a\xe2\x80\x89=\xe2\x80\x892, b\xe2\x80\x89=\xe2\x80\x893 and c\xe2\x80\x89=\xe2\x80\x894.  According to the legend, as the King of Berland obtained the values a, b and c, he almost immediately calculated the total number of tiles on the hall floor. Can you do the same?" 1200
215E "Periodical Numbers" "combinatorics,dp,number theory" "A non-empty string s is called binary, if it consists only of characters ""0"" and ""1"". Let\'s number the characters of binary string s from 1 to the string\'s length and let\'s denote the i-th character in string s as si.Binary string s with length n is periodical, if there is an integer 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n such that:   k is a divisor of number n  for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k, the following condition fulfills: si\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89k For example, binary strings ""101010"" and ""11"" are periodical and ""10"" and ""10010"" are not.A positive integer x is periodical, if its binary representation (without leading zeroes) is a periodic string.Your task is to calculate, how many periodic numbers are in the interval from l to r (both ends are included)." 2100
215D "Hot Days" greedy "The official capital and the cultural capital of Berland are connected by a single road running through n regions. Each region has a unique climate, so the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) region has a stable temperature of ti degrees in summer.This summer a group of m schoolchildren wants to get from the official capital to the cultural capital to visit museums and sights. The trip organizers transport the children between the cities in buses, but sometimes it is very hot. Specifically, if the bus is driving through the i-th region and has k schoolchildren, then the temperature inside the bus is ti\xe2\x80\x89+\xe2\x80\x89k degrees.Of course, nobody likes it when the bus is hot. So, when the bus drives through the i-th region, if it has more than Ti degrees inside, each of the schoolchild in the bus demands compensation for the uncomfortable conditions. The compensation is as large as xi rubles and it is charged in each region where the temperature in the bus exceeds the limit.To save money, the organizers of the trip may arbitrarily add or remove extra buses in the beginning of the trip, and between regions (of course, they need at least one bus to pass any region). The organizers can also arbitrarily sort the children into buses, however, each of buses in the i-th region will cost the organizers costi rubles. Please note that sorting children into buses takes no money.Your task is to find the minimum number of rubles, which the organizers will have to spend to transport all schoolchildren." 1900
215C Crosses "brute force,implementation" "There is a board with a grid consisting of n rows and m columns, the rows are numbered from 1 from top to bottom and the columns are numbered from 1 from left to right. In this grid we will denote the cell that lies on row number i and column number j as (i,\xe2\x80\x89j).A group of six numbers (a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89x0,\xe2\x80\x89y0), where 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d, is a cross, and there is a set of cells that are assigned to it. Cell (x,\xe2\x80\x89y) belongs to this set if at least one of two conditions are fulfilled:  |x0\xe2\x80\x89-\xe2\x80\x89x|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a and |y0\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b  |x0\xe2\x80\x89-\xe2\x80\x89x|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c and |y0\xe2\x80\x89-\xe2\x80\x89y|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d    The picture shows the cross (0,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x892,\xe2\x80\x893) on the grid 3\xe2\x80\x89\xc3\x97\xe2\x80\x894.  Your task is to find the number of different groups of six numbers, (a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89x0,\xe2\x80\x89y0) that determine the crosses of an area equal to s, which are placed entirely on the grid. The cross is placed entirely on the grid, if any of its cells is in the range of the grid (that is for each cell (x,\xe2\x80\x89y) of the cross 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m holds). The area of the cross is the number of cells it has.Note that two crosses are considered distinct if the ordered groups of six numbers that denote them are distinct, even if these crosses coincide as sets of points." 2100
215B "Olympic Medal" greedy,math "The World Programming Olympics Medal is a metal disk, consisting of two parts: the first part is a ring with outer radius of r1 cm, inner radius of r2 cm, (0\xe2\x80\x89<\xe2\x80\x89r2\xe2\x80\x89<\xe2\x80\x89r1) made of metal with density p1 g/cm3. The second part is an inner disk with radius r2 cm, it is made of metal with density p2 g/cm3. The disk is nested inside the ring.The Olympic jury decided that r1 will take one of possible values of x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. It is up to jury to decide which particular value r1 will take. Similarly, the Olympic jury decided that p1 will take one of possible value of y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89ym, and p2 will take a value from list z1,\xe2\x80\x89z2,\xe2\x80\x89...,\xe2\x80\x89zk.According to most ancient traditions the ratio between the outer ring mass mout and the inner disk mass min must equal , where A,\xe2\x80\x89B are constants taken from ancient books. Now, to start making medals, the jury needs to take values for r1, p1, p2 and calculate the suitable value of r2.The jury wants to choose the value that would maximize radius r2. Help the jury find the sought value of r2. Value r2 doesn\'t have to be an integer.Medal has a uniform thickness throughout the area, the thickness of the inner disk is the same as the thickness of the outer ring." 1300
215A "Bicycle Chain" "brute force,implementation" "Vasya\'s bicycle chain drive consists of two parts: n stars are attached to the pedal axle, m stars are attached to the rear wheel axle. The chain helps to rotate the rear wheel by transmitting the pedal rotation.We know that the i-th star on the pedal axle has ai (0\xe2\x80\x89<\xe2\x80\x89a1\xe2\x80\x89<\xe2\x80\x89a2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89an) teeth, and the j-th star on the rear wheel axle has bj (0\xe2\x80\x89<\xe2\x80\x89b1\xe2\x80\x89<\xe2\x80\x89b2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89bm) teeth. Any pair (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n; 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) is called a gear and sets the indexes of stars to which the chain is currently attached. Gear (i,\xe2\x80\x89j) has a gear ratio, equal to the value .Since Vasya likes integers, he wants to find such gears (i,\xe2\x80\x89j), that their ratios are integers. On the other hand, Vasya likes fast driving, so among all ""integer"" gears (i,\xe2\x80\x89j) he wants to choose a gear with the maximum ratio. Help him to find the number of such gears.In the problem, fraction  denotes division in real numbers, that is, no rounding is performed." 900
214B Hometask "brute force,constructive algorithms,greedy,math" "Furik loves math lessons very much, so he doesn\'t attend them, unlike Rubik. But now Furik wants to get a good mark for math. For that Ms. Ivanova, his math teacher, gave him a new task. Furik solved the task immediately. Can you?You are given a set of digits, your task is to find the maximum integer that you can make from these digits. The made number must be divisible by 2, 3, 5 without a residue. It is permitted to use not all digits from the set, it is forbidden to use leading zeroes.Each digit is allowed to occur in the number the same number of times it occurs in the set." 1600
214A "System of Equations" "brute force" "Furik loves math lessons very much, so he doesn\'t attend them, unlike Rubik. But now Furik wants to get a good mark for math. For that Ms. Ivanova, his math teacher, gave him a new task. Furik solved the task immediately. Can you?You are given a system of equations:   You should count, how many there are pairs of integers (a,\xe2\x80\x89b) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b) which satisfy the system." 800
213E "Two Permutations" "data structures,hashing,strings" "Rubik is very keen on number permutations. A permutation a with length n is a sequence, consisting of n different numbers from 1 to n. Element number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) of this permutation will be denoted as ai.Furik decided to make a present to Rubik and came up with a new problem on permutations. Furik tells Rubik two number permutations: permutation a with length n and permutation b with length m. Rubik must give an answer to the problem: how many distinct integers d exist, such that sequence c (c1\xe2\x80\x89=\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89d,\xe2\x80\x89c2\xe2\x80\x89=\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89d,\xe2\x80\x89...,\xe2\x80\x89cn\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89+\xe2\x80\x89d) of length n is a subsequence of b.Sequence a is a subsequence of sequence b, if there are such indices i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89in (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89in\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), that a1\xe2\x80\x89=\xe2\x80\x89bi1, a2\xe2\x80\x89=\xe2\x80\x89bi2, ..., an\xe2\x80\x89=\xe2\x80\x89bin, where n is the length of sequence a, and m is the length of sequence b. You are given permutations a and b, help Rubik solve the given problem." 2700
213D Stars "constructive algorithms,geometry" "Furik loves painting stars. A star is a shape that results if we take a regular pentagon and paint all diagonals in it.   Recently he decided to teach Rubik to paint stars. After many years of training Rubik could paint stars easily. But now Furik decided to test Rubik and complicated the task. Rubik must paint n stars, observing the following rules:  all stars must be painted in a single move (i.e. it is forbidden to take the pen away from the paper);  it is forbidden to paint the same segment of non-zero length more than once;  the stars can intersect only in their vertexes;  the length of a side of the regular pentagon, in which Rubik paints each star, must equal 10. Help Rubik to cope with this hard task." 2300
213C "Relay Race" dp "Furik and Rubik take part in a relay race. The race will be set up on a large square with the side of n meters. The given square is split into n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells (represented as unit squares), each cell has some number.At the beginning of the race Furik stands in a cell with coordinates (1,\xe2\x80\x891), and Rubik stands in a cell with coordinates (n,\xe2\x80\x89n). Right after the start Furik runs towards Rubik, besides, if Furik stands at a cell with coordinates (i,\xe2\x80\x89j), then he can move to cell (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j) or (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891). After Furik reaches Rubik, Rubik starts running from cell with coordinates (n,\xe2\x80\x89n) to cell with coordinates (1,\xe2\x80\x891). If Rubik stands in cell (i,\xe2\x80\x89j), then he can move to cell (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j) or (i,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891). Neither Furik, nor Rubik are allowed to go beyond the boundaries of the field; if a player goes beyond the boundaries, he will be disqualified. To win the race, Furik and Rubik must earn as many points as possible. The number of points is the sum of numbers from the cells Furik and Rubik visited. Each cell counts only once in the sum.Print the maximum number of points Furik and Rubik can earn on the relay race." 2000
213B Numbers combinatorics,dp "Furik loves writing all sorts of problems, especially such that he can\'t solve himself. You\'ve got one of his problems, the one Furik gave to Rubik. And Rubik asks you to solve it.There is integer n and array a, consisting of ten integers, indexed by numbers from 0 to 9. Your task is to count the number of positive integers with the following properties:  the number\'s length does not exceed n;  the number doesn\'t have leading zeroes;  digit i (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899) occurs in the number at least a[i] times." 1900
213A Game "dfs and similar,greedy" "Furik and Rubik love playing computer games. Furik has recently found a new game that greatly interested Rubik. The game consists of n parts and to complete each part a player may probably need to complete some other ones. We know that the game can be fully completed, that is, its parts do not form cyclic dependencies. Rubik has 3 computers, on which he can play this game. All computers are located in different houses. Besides, it has turned out that each part of the game can be completed only on one of these computers. Let\'s number the computers with integers from 1 to 3. Rubik can perform the following actions:   Complete some part of the game on some computer. Rubik spends exactly 1 hour on completing any part on any computer.  Move from the 1-st computer to the 2-nd one. Rubik spends exactly 1 hour on that.  Move from the 1-st computer to the 3-rd one. Rubik spends exactly 2 hours on that.  Move from the 2-nd computer to the 1-st one. Rubik spends exactly 2 hours on that.  Move from the 2-nd computer to the 3-rd one. Rubik spends exactly 1 hour on that.  Move from the 3-rd computer to the 1-st one. Rubik spends exactly 1 hour on that.  Move from the 3-rd computer to the 2-nd one. Rubik spends exactly 2 hours on that. Help Rubik to find the minimum number of hours he will need to complete all parts of the game. Initially Rubik can be located at the computer he considers necessary." 1700
212E "IT Restaurants" "dfs and similar,dp,trees" "\xd0\xa1ity N. has a huge problem with roads, food and IT-infrastructure. In total the city has n junctions, some pairs of them are connected by bidirectional roads. The road network consists of n\xe2\x80\x89-\xe2\x80\x891 roads, you can get from any junction to any other one by these roads. Yes, you\'re right \xe2\x80\x94 the road network forms an undirected tree.Recently, the Mayor came up with a way that eliminates the problems with the food and the IT-infrastructure at the same time! He decided to put at the city junctions restaurants of two well-known cafe networks for IT professionals: ""iMac D0naldz"" and ""Burger Bing"". Since the network owners are not friends, it is strictly prohibited to place two restaurants of different networks on neighboring junctions. There are other requirements. Here\'s the full list:  each junction must have at most one restaurant;  each restaurant belongs either to ""iMac D0naldz"", or to ""Burger Bing"";  each network should build at least one restaurant;  there is no pair of junctions that are connected by a road and contains restaurants of different networks. The Mayor is going to take a large tax from each restaurant, so he is interested in making the total number of the restaurants as large as possible.Help the Mayor to analyze the situation. Find all such pairs of (a,\xe2\x80\x89b) that a restaurants can belong to ""iMac D0naldz"", b restaurants can belong to ""Burger Bing"", and the sum of a\xe2\x80\x89+\xe2\x80\x89b is as large as possible." 1500
212D "Cutting a Fence" "binary search,data structures,dsu" "Vasya the carpenter has an estate that is separated from the wood by a fence. The fence consists of n planks put in a line. The fence is not closed in a circle. The planks are numbered from left to right from 1 to n, the i-th plank is of height ai. All planks have the same width, the lower edge of each plank is located at the ground level.Recently a local newspaper ""Malevich and Life"" wrote that the most fashionable way to decorate a fence in the summer is to draw a fuchsia-colored rectangle on it, the lower side of the rectangle must be located at the lower edge of the fence.Vasya is delighted with this idea! He immediately bought some fuchsia-colored paint and began to decide what kind of the rectangle he should paint. Vasya is sure that the rectangle should cover k consecutive planks. In other words, he will paint planks number x, x\xe2\x80\x89+\xe2\x80\x891, ..., x\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891 for some x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891). He wants to paint the rectangle of maximal area, so the rectangle height equals min ai for x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891, x is the number of the first colored plank.Vasya has already made up his mind that the rectangle width can be equal to one of numbers of the sequence k1,\xe2\x80\x89k2,\xe2\x80\x89...,\xe2\x80\x89km. For each ki he wants to know the expected height of the painted rectangle, provided that he selects x for such fence uniformly among all n\xe2\x80\x89-\xe2\x80\x89ki\xe2\x80\x89+\xe2\x80\x891 possible values. Help him to find the expected heights." 2500
212C Cowboys combinatorics,dp,math "A very tense moment: n cowboys stand in a circle and each one points his colt at a neighbor. Each cowboy can point the colt to the person who follows or precedes him in clockwise direction. Human life is worthless, just like in any real western.The picture changes each second! Every second the cowboys analyse the situation and, if a pair of cowboys realize that they aim at each other, they turn around. In a second all such pairs of neighboring cowboys aiming at each other turn around. All actions happen instantaneously and simultaneously in a second.We\'ll use character ""A"" to denote a cowboy who aims at his neighbour in the clockwise direction, and character ""B"" for a cowboy who aims at his neighbour in the counter clockwise direction. Then a string of letters ""A"" and ""B"" will denote the circle of cowboys, the record is made from the first of them in a clockwise direction.For example, a circle that looks like ""ABBBABBBA"" after a second transforms into ""BABBBABBA"" and a circle that looks like ""BABBA"" transforms into ""ABABB"".   This picture illustrates how the circle ""BABBA"" transforms into ""ABABB""  A second passed and now the cowboys\' position is described by string s. Your task is to determine the number of possible states that lead to s in a second. Two states are considered distinct if there is a cowboy who aims at his clockwise neighbor in one state and at his counter clockwise neighbor in the other state." 2100
212B "Polycarpus is Looking for Good Substrings" bitmasks,hashing,implementation "We\'ll call string s[a,\xe2\x80\x89b]\xe2\x80\x89=\xe2\x80\x89sasa\xe2\x80\x89+\xe2\x80\x891... sb (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) a substring of string s\xe2\x80\x89=\xe2\x80\x89s1s2... s|s|, where |s| is the length of string s.The trace of a non-empty string t is a set of characters that the string consists of. For example, the trace of string ""aab"" equals {\'a\', \'b\'}.Let\'s consider an arbitrary string s and the set of its substrings with trace equal to C. We will denote the number of substrings from this set that are maximal by inclusion by r(C,\xe2\x80\x89s). Substring s[a,\xe2\x80\x89b] of length n\xe2\x80\x89=\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891 belonging to some set is called maximal by inclusion, if there is no substring s[x,\xe2\x80\x89y] in this set with length greater than n, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|. Two substrings of string s are considered different even if they are equal but they are located at different positions of s.Polycarpus got a challenging practical task on a stringology exam. He must do the following: given string s and non-empty sets of characters C1, C2, ..., Cm, find r(Ci,\xe2\x80\x89s) for each set Ci. Help Polycarpus to solve the problem as he really doesn\'t want to be expelled from the university and go to the army!" 2300
212A Privatization flows,graphs "There is a developed network of flights between Berland and Beerland. All of them belong to the Berland state company BerAvia. Each flight connects some Berland city with some Beerland city. For each flight airplanes fly in both directions.Changes are coming to Berland \xe2\x80\x94 the state decided to privatize BerAvia, namely, to sell out all flights to t private companies. Each of these companies wants to get the maximal number of flights, so if the Berland flights are sold unevenly, Berland can be accused of partiality. Berland Government decided to sell the flights as evenly as possible between the t companies.The unevenness of the distribution of flights between companies is calculated as follows. For each city i (both Berland and Beerland) we\'ll calculate the value of  where aij is the number of flights from city i, which belong to company j. The sum of wi for all cities in both countries is called the unevenness of the distribution. The distribution with the minimal unevenness is the most even one.Help the Berland government come up with the most even distribution plan of selling flights." 3000
209C "Trails and Glades" "constructive algorithms,dsu,graphs,greedy" "Vasya went for a walk in the park. The park has n glades, numbered from 1 to n. There are m trails between the glades. The trails are numbered from 1 to m, where the i-th trail connects glades xi and yi. The numbers of the connected glades may be the same (xi\xe2\x80\x89=\xe2\x80\x89yi), which means that a trail connects a glade to itself. Also, two glades may have several non-intersecting trails between them.Vasya is on glade 1, he wants to walk on all trails of the park exactly once, so that he can eventually return to glade 1. Unfortunately, Vasya does not know whether this walk is possible or not. Help Vasya, determine whether the walk is possible or not. If such walk is impossible, find the minimum number of trails the authorities need to add to the park in order to make the described walk possible.Vasya can shift from one trail to another one only on glades. He can move on the trails in both directions. If Vasya started going on the trail that connects glades a and b, from glade a, then he must finish this trail on glade b." 2400
209B Pixels "constructive algorithms,math" "Flatland is inhabited by pixels of three colors: red, green and blue. We know that if two pixels of different colors meet in a violent fight, only one of them survives the fight (that is, the total number of pixels decreases by one). Besides, if pixels of colors x and y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y) meet in a violent fight, then the pixel that survives the fight immediately changes its color to z (z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x; z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y). Pixels of the same color are friends, so they don\'t fight.The King of Flatland knows that his land will be peaceful and prosperous when the pixels are of the same color. For each of the three colors you know the number of pixels of this color that inhabit Flatland. Help the king and determine whether fights can bring peace and prosperity to the country and if it is possible, find the minimum number of fights needed to make the land peaceful and prosperous." 2100
209A "Multicolored Marbles" dp,math "Polycarpus plays with red and blue marbles. He put n marbles from the left to the right in a row. As it turned out, the marbles form a zebroid.A non-empty sequence of red and blue marbles is a zebroid, if the colors of the marbles in this sequence alternate. For example, sequences (red; blue; red) and (blue) are zebroids and sequence (red; red) is not a zebroid.Now Polycarpus wonders, how many ways there are to pick a zebroid subsequence from this sequence. Help him solve the problem, find the number of ways modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 1600
208E "Blood Cousins" "binary search,data structures,dfs and similar,trees" "Polycarpus got hold of a family relationship tree. The tree describes family relationships of n people, numbered 1 through n. Each person in the tree has no more than one parent.Let\'s call person a a 1-ancestor of person b, if a is the parent of b.Let\'s call person a a k-ancestor (k\xe2\x80\x89>\xe2\x80\x891) of person b, if person b has a 1-ancestor, and a is a (k\xe2\x80\x89-\xe2\x80\x891)-ancestor of b\'s 1-ancestor. Family relationships don\'t form cycles in the found tree. In other words, there is no person who is his own ancestor, directly or indirectly (that is, who is an x-ancestor for himself, for some x, x\xe2\x80\x89>\xe2\x80\x890).Let\'s call two people x and y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y) p-th cousins (p\xe2\x80\x89>\xe2\x80\x890), if there is person z, who is a p-ancestor of x and a p-ancestor of y.Polycarpus wonders how many counsins and what kinds of them everybody has. He took a piece of paper and wrote m pairs of integers vi, pi. Help him to calculate the number of pi-th cousins that person vi has, for each pair vi, pi." 2100
208D "Prizes, Prizes, more Prizes" implementation "Vasya, like many others, likes to participate in a variety of sweepstakes and lotteries. Now he collects wrappings from a famous chocolate bar ""Jupiter"". According to the sweepstake rules, each wrapping has an integer written on it \xe2\x80\x94 the number of points that the participant adds to his score as he buys the bar. After a participant earns a certain number of points, he can come to the prize distribution center and exchange the points for prizes. When somebody takes a prize, the prize\'s cost is simply subtracted from the number of his points.Vasya didn\'t only bought the bars, he also kept a record of how many points each wrapping cost. Also, he remembers that he always stucks to the greedy strategy \xe2\x80\x94 as soon as he could take at least one prize, he went to the prize distribution centre and exchanged the points for prizes. Moreover, if he could choose between multiple prizes, he chose the most expensive one. If after an exchange Vasya had enough points left to get at least one more prize, then he continued to exchange points.The sweepstake has the following prizes (the prizes are sorted by increasing of their cost):   a mug (costs a points),  a towel (costs b points),  a bag (costs c points),  a bicycle (costs d points),  a car (costs e points). Now Vasya wants to recollect what prizes he has received. You know sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, where pi is the number of points Vasya got for the i-th bar. The sequence of points is given in the chronological order. You also know numbers a, b, c, d, e. Your task is to find, how many prizes Vasya received, what prizes they are and how many points he\'s got left after all operations are completed." 1200
208C "Police Station" "dp,graphs,shortest paths" "The Berland road network consists of n cities and of m bidirectional roads. The cities are numbered from 1 to n, where the main capital city has number n, and the culture capital \xe2\x80\x94 number 1. The road network is set up so that it is possible to reach any city from any other one by the roads. Moving on each road in any direction takes the same time.All residents of Berland are very lazy people, and so when they want to get from city v to city u, they always choose one of the shortest paths (no matter which one).The Berland government wants to make this country\'s road network safer. For that, it is going to put a police station in one city. The police station has a rather strange property: when a citizen of Berland is driving along the road with a police station at one end of it, the citizen drives more carefully, so all such roads are considered safe. The roads, both ends of which differ from the city with the police station, are dangerous.Now the government wonders where to put the police station so that the average number of safe roads for all the shortest paths from the cultural capital to the main capital would take the maximum value." 1900
208B Solitaire "dfs and similar,dp" "A boy named Vasya wants to play an old Russian solitaire called ""Accordion"". In this solitaire, the player must observe the following rules:  A deck of n cards is carefully shuffled, then all n cards are put on the table in a line from left to right;  Before each move the table has several piles of cards lying in a line (initially there are n piles, each pile has one card). Let\'s number the piles from left to right, from 1 to x. During one move, a player can take the whole pile with the maximum number x (that is the rightmost of remaining) and put it on the top of pile x\xe2\x80\x89-\xe2\x80\x891 (if it exists) or on the top of pile x\xe2\x80\x89-\xe2\x80\x893 (if it exists). The player can put one pile on top of another one only if the piles\' top cards have the same suits or values. Please note that if pile x goes on top of pile y, then the top card of pile x becomes the top card of the resulting pile. Also note that each move decreases the total number of piles by 1;  The solitaire is considered completed if all cards are in the same pile. Vasya has already shuffled the cards and put them on the table, help him understand whether completing this solitaire is possible or not." 1900
208A Dubstep strings "Vasya works as a DJ in the best Berland nightclub, and he often uses dubstep music in his performance. Recently, he has decided to take a couple of old songs and make dubstep remixes from them.Let\'s assume that a song consists of some number of words. To make the dubstep remix of this song, Vasya inserts a certain number of words ""WUB"" before the first word of the song (the number may be zero), after the last word (the number may be zero), and between words (at least one between any pair of neighbouring words), and then the boy glues together all the words, including ""WUB"", in one string and plays the song at the club.For example, a song with words ""I AM X"" can transform into a dubstep remix as ""WUBWUBIWUBAMWUBWUBX"" and cannot transform into ""WUBWUBIAMWUBX"".Recently, Petya has heard Vasya\'s new dubstep track, but since he isn\'t into modern music, he decided to find out what was the initial song that Vasya remixed. Help Petya restore the original song." 900
207D9 "The Beaver\'s Problem - 3" NA "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 1800
207D8 "The Beaver\'s Problem - 3" NA "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 2300
207D7 "The Beaver\'s Problem - 3" NA "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 1600
207D6 "The Beaver\'s Problem - 3" NA "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 2100
207D5 "The Beaver\'s Problem - 3" NA "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 1600
207D4 "The Beaver\'s Problem - 3" NA "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 2100
207D3 "The Beaver\'s Problem - 3" NA "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 2000
207D2 "The Beaver\'s Problem - 3" NA "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 2000
207D10 "The Beaver\'s Problem - 3" NA "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 2100
207D1 "The Beaver\'s Problem - 3" NA "The Smart Beaver from ABBYY came up with another splendid problem for the ABBYY Cup participants! This time the Beaver invites the contest participants to check out a problem on sorting documents by their subjects. Let\'s describe the problem:You\'ve got some training set of documents. For each document you know its subject. The subject in this problem is an integer from 1 to 3. Each of these numbers has a physical meaning. For instance, all documents with subject 3 are about trade.You can download the training set of documents at the following link: http://download4.abbyy.com/a2/X2RZ2ZWXBG5VYWAL61H76ZQM/train.zip. The archive contains three directories with names ""1"", ""2"", ""3"". Directory named ""1"" contains documents on the 1-st subject, directory ""2"" contains documents on the 2-nd subject, and directory ""3"" contains documents on the 3-rd subject. Each document corresponds to exactly one file from some directory.All documents have the following format: the first line contains the document identifier, the second line contains the name of the document, all subsequent lines contain the text of the document. The document identifier is used to make installing the problem more convenient and has no useful information for the participants.You need to write a program that should indicate the subject for a given document. It is guaranteed that all documents given as input to your program correspond to one of the three subjects of the training set." 1800
207C3 "Game with Two Trees" "data structures" "The Smart Beaver from ABBYY has come up with a new developing game for children. The Beaver thinks that this game will help children to understand programming better.The main object of the game is finite rooted trees, each of their edges contains some lowercase English letter. Vertices on any tree are always numbered sequentially from 1 to m, where m is the number of vertices in the tree. Before describing the actual game, let\'s introduce some definitions.We\'ll assume that the sequence of vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a forward path, if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is a direct ancestor of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all letters from the the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to forward path v1, v2, ..., vk.We\'ll assume that the sequence of tree vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a backward path if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is the direct descendant of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all the letters from the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to backward path v1, v2, ..., vk.Now let\'s describe the game that the Smart Beaver from ABBYY has come up with. The game uses two rooted trees, each of which initially consists of one vertex with number 1. The player is given some sequence of operations. Each operation is characterized by three values (t, v, c) where:   t is the number of the tree on which the operation is executed (1 or 2);  v is the vertex index in this tree (it is guaranteed that the tree contains a vertex with this index);  c is a lowercase English letter. The actual operation is as follows: vertex v of tree t gets a new descendant with number m\xe2\x80\x89+\xe2\x80\x891 (where m is the current number of vertices in tree t), and there should be letter c put on the new edge from vertex v to vertex m\xe2\x80\x89+\xe2\x80\x891.We\'ll say that an ordered group of three integers (i, j, q) is a good combination if:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m1, where m1 is the number of vertices in the first tree;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m2, where m2 is the number of vertices in the second tree;  there exists a forward path v1, v2, ..., vk such that v1\xe2\x80\x89=\xe2\x80\x89j and vk\xe2\x80\x89=\xe2\x80\x89q in the second tree;  the string that corresponds to the forward path in the second tree from vertex j to vertex q equals the string that corresponds to the backward path in the first tree from vertex i to vertex 1 (note that both paths are determined uniquely). Your task is to calculate the number of existing good combinations after each operation on the trees." 2700
207C2 "Game with Two Trees" NA "The Smart Beaver from ABBYY has come up with a new developing game for children. The Beaver thinks that this game will help children to understand programming better.The main object of the game is finite rooted trees, each of their edges contains some lowercase English letter. Vertices on any tree are always numbered sequentially from 1 to m, where m is the number of vertices in the tree. Before describing the actual game, let\'s introduce some definitions.We\'ll assume that the sequence of vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a forward path, if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is a direct ancestor of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all letters from the the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to forward path v1, v2, ..., vk.We\'ll assume that the sequence of tree vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a backward path if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is the direct descendant of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all the letters from the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to backward path v1, v2, ..., vk.Now let\'s describe the game that the Smart Beaver from ABBYY has come up with. The game uses two rooted trees, each of which initially consists of one vertex with number 1. The player is given some sequence of operations. Each operation is characterized by three values (t, v, c) where:   t is the number of the tree on which the operation is executed (1 or 2);  v is the vertex index in this tree (it is guaranteed that the tree contains a vertex with this index);  c is a lowercase English letter. The actual operation is as follows: vertex v of tree t gets a new descendant with number m\xe2\x80\x89+\xe2\x80\x891 (where m is the current number of vertices in tree t), and there should be letter c put on the new edge from vertex v to vertex m\xe2\x80\x89+\xe2\x80\x891.We\'ll say that an ordered group of three integers (i, j, q) is a good combination if:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m1, where m1 is the number of vertices in the first tree;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m2, where m2 is the number of vertices in the second tree;  there exists a forward path v1, v2, ..., vk such that v1\xe2\x80\x89=\xe2\x80\x89j and vk\xe2\x80\x89=\xe2\x80\x89q in the second tree;  the string that corresponds to the forward path in the second tree from vertex j to vertex q equals the string that corresponds to the backward path in the first tree from vertex i to vertex 1 (note that both paths are determined uniquely). Your task is to calculate the number of existing good combinations after each operation on the trees." 2200
207C1 "Game with Two Trees" NA "The Smart Beaver from ABBYY has come up with a new developing game for children. The Beaver thinks that this game will help children to understand programming better.The main object of the game is finite rooted trees, each of their edges contains some lowercase English letter. Vertices on any tree are always numbered sequentially from 1 to m, where m is the number of vertices in the tree. Before describing the actual game, let\'s introduce some definitions.We\'ll assume that the sequence of vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a forward path, if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is a direct ancestor of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all letters from the the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to forward path v1, v2, ..., vk.We\'ll assume that the sequence of tree vertices with numbers v1, v2, ..., vk (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) is a backward path if for any integer i from 1 to k\xe2\x80\x89-\xe2\x80\x891 vertex vi is the direct descendant of vertex vi\xe2\x80\x89+\xe2\x80\x891. If we sequentially write out all the letters from the edges of the given path from v1 to vk, we get some string (k\xe2\x80\x89=\xe2\x80\x891 gives us an empty string). We\'ll say that such string corresponds to backward path v1, v2, ..., vk.Now let\'s describe the game that the Smart Beaver from ABBYY has come up with. The game uses two rooted trees, each of which initially consists of one vertex with number 1. The player is given some sequence of operations. Each operation is characterized by three values (t, v, c) where:   t is the number of the tree on which the operation is executed (1 or 2);  v is the vertex index in this tree (it is guaranteed that the tree contains a vertex with this index);  c is a lowercase English letter. The actual operation is as follows: vertex v of tree t gets a new descendant with number m\xe2\x80\x89+\xe2\x80\x891 (where m is the current number of vertices in tree t), and there should be letter c put on the new edge from vertex v to vertex m\xe2\x80\x89+\xe2\x80\x891.We\'ll say that an ordered group of three integers (i, j, q) is a good combination if:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m1, where m1 is the number of vertices in the first tree;  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j,\xe2\x80\x89q\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m2, where m2 is the number of vertices in the second tree;  there exists a forward path v1, v2, ..., vk such that v1\xe2\x80\x89=\xe2\x80\x89j and vk\xe2\x80\x89=\xe2\x80\x89q in the second tree;  the string that corresponds to the forward path in the second tree from vertex j to vertex q equals the string that corresponds to the backward path in the first tree from vertex i to vertex 1 (note that both paths are determined uniquely). Your task is to calculate the number of existing good combinations after each operation on the trees." 2100
207B3 "Military Trainings" NA "The Smart Beaver from ABBYY started cooperating with the Ministry of Defence. Now they train soldiers to move armoured columns. The training involves testing a new type of tanks that can transmit information. To test the new type of tanks, the training has a special exercise, its essence is as follows.Initially, the column consists of n tanks sequentially numbered from 1 to n in the order of position in the column from its beginning to its end. During the whole exercise, exactly n messages must be transferred from the beginning of the column to its end.Transferring one message is as follows. The tank that goes first in the column transmits the message to some tank in the column. The tank which received the message sends it further down the column. The process is continued until the last tank receives the message. It is possible that not all tanks in the column will receive the message \xe2\x80\x94 it is important that the last tank in the column should receive the message.After the last tank (tank number n) receives the message, it moves to the beginning of the column and sends another message to the end of the column in the same manner. When the message reaches the last tank (tank number n\xe2\x80\x89-\xe2\x80\x891), that tank moves to the beginning of the column and sends the next message to the end of the column, and so on. Thus, the exercise is completed when the tanks in the column return to their original order, that is, immediately after tank number 1 moves to the beginning of the column.If the tanks were initially placed in the column in the order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, then after the first message their order changes to n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, after the second message it changes to n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892, and so on.The tanks are constructed in a very peculiar way. The tank with number i is characterized by one integer ai, which is called the message receiving radius of this tank.Transferring a message between two tanks takes one second, however, not always one tank can transmit a message to another one. Let\'s consider two tanks in the column such that the first of them is the i-th in the column counting from the beginning, and the second one is the j-th in the column, and suppose the second tank has number x. Then the first tank can transmit a message to the second tank if i\xe2\x80\x89<\xe2\x80\x89j and i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x89ax.The Ministry of Defense (and soon the Smart Beaver) faced the question of how to organize the training efficiently. The exercise should be finished as quickly as possible. We\'ll neglect the time that the tanks spend on moving along the column, since improving the tanks\' speed is not a priority for this training.You are given the number of tanks, as well as the message receiving radii of all tanks. You must help the Smart Beaver and organize the transferring of messages in a way that makes the total transmission time of all messages as small as possible." 1700
207B2 "Military Trainings" NA "The Smart Beaver from ABBYY started cooperating with the Ministry of Defence. Now they train soldiers to move armoured columns. The training involves testing a new type of tanks that can transmit information. To test the new type of tanks, the training has a special exercise, its essence is as follows.Initially, the column consists of n tanks sequentially numbered from 1 to n in the order of position in the column from its beginning to its end. During the whole exercise, exactly n messages must be transferred from the beginning of the column to its end.Transferring one message is as follows. The tank that goes first in the column transmits the message to some tank in the column. The tank which received the message sends it further down the column. The process is continued until the last tank receives the message. It is possible that not all tanks in the column will receive the message \xe2\x80\x94 it is important that the last tank in the column should receive the message.After the last tank (tank number n) receives the message, it moves to the beginning of the column and sends another message to the end of the column in the same manner. When the message reaches the last tank (tank number n\xe2\x80\x89-\xe2\x80\x891), that tank moves to the beginning of the column and sends the next message to the end of the column, and so on. Thus, the exercise is completed when the tanks in the column return to their original order, that is, immediately after tank number 1 moves to the beginning of the column.If the tanks were initially placed in the column in the order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, then after the first message their order changes to n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, after the second message it changes to n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892, and so on.The tanks are constructed in a very peculiar way. The tank with number i is characterized by one integer ai, which is called the message receiving radius of this tank.Transferring a message between two tanks takes one second, however, not always one tank can transmit a message to another one. Let\'s consider two tanks in the column such that the first of them is the i-th in the column counting from the beginning, and the second one is the j-th in the column, and suppose the second tank has number x. Then the first tank can transmit a message to the second tank if i\xe2\x80\x89<\xe2\x80\x89j and i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x89ax.The Ministry of Defense (and soon the Smart Beaver) faced the question of how to organize the training efficiently. The exercise should be finished as quickly as possible. We\'ll neglect the time that the tanks spend on moving along the column, since improving the tanks\' speed is not a priority for this training.You are given the number of tanks, as well as the message receiving radii of all tanks. You must help the Smart Beaver and organize the transferring of messages in a way that makes the total transmission time of all messages as small as possible." 1900
207B1 "Military Trainings" NA "The Smart Beaver from ABBYY started cooperating with the Ministry of Defence. Now they train soldiers to move armoured columns. The training involves testing a new type of tanks that can transmit information. To test the new type of tanks, the training has a special exercise, its essence is as follows.Initially, the column consists of n tanks sequentially numbered from 1 to n in the order of position in the column from its beginning to its end. During the whole exercise, exactly n messages must be transferred from the beginning of the column to its end.Transferring one message is as follows. The tank that goes first in the column transmits the message to some tank in the column. The tank which received the message sends it further down the column. The process is continued until the last tank receives the message. It is possible that not all tanks in the column will receive the message \xe2\x80\x94 it is important that the last tank in the column should receive the message.After the last tank (tank number n) receives the message, it moves to the beginning of the column and sends another message to the end of the column in the same manner. When the message reaches the last tank (tank number n\xe2\x80\x89-\xe2\x80\x891), that tank moves to the beginning of the column and sends the next message to the end of the column, and so on. Thus, the exercise is completed when the tanks in the column return to their original order, that is, immediately after tank number 1 moves to the beginning of the column.If the tanks were initially placed in the column in the order 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n, then after the first message their order changes to n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, after the second message it changes to n\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89n,\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x892, and so on.The tanks are constructed in a very peculiar way. The tank with number i is characterized by one integer ai, which is called the message receiving radius of this tank.Transferring a message between two tanks takes one second, however, not always one tank can transmit a message to another one. Let\'s consider two tanks in the column such that the first of them is the i-th in the column counting from the beginning, and the second one is the j-th in the column, and suppose the second tank has number x. Then the first tank can transmit a message to the second tank if i\xe2\x80\x89<\xe2\x80\x89j and i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x89ax.The Ministry of Defense (and soon the Smart Beaver) faced the question of how to organize the training efficiently. The exercise should be finished as quickly as possible. We\'ll neglect the time that the tanks spend on moving along the column, since improving the tanks\' speed is not a priority for this training.You are given the number of tanks, as well as the message receiving radii of all tanks. You must help the Smart Beaver and organize the transferring of messages in a way that makes the total transmission time of all messages as small as possible." 1600
207A3 "Beaver\'s Calculator 1.0" greedy "The Smart Beaver from ABBYY has once again surprised us! He has developed a new calculating device, which he called the ""Beaver\'s Calculator 1.0"". It is very peculiar and it is planned to be used in a variety of scientific problems.To test it, the Smart Beaver invited n scientists, numbered from 1 to n. The i-th scientist brought ki calculating problems for the device developed by the Smart Beaver from ABBYY. The problems of the i-th scientist are numbered from 1 to ki, and they must be calculated sequentially in the described order, since calculating each problem heavily depends on the results of calculating of the previous ones.Each problem of each of the n scientists is described by one integer ai,\xe2\x80\x89j, where i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is the number of the scientist, j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ki) is the number of the problem, and ai,\xe2\x80\x89j is the number of resource units the calculating device needs to solve this problem.The calculating device that is developed by the Smart Beaver is pretty unusual. It solves problems sequentially, one after another. After some problem is solved and before the next one is considered, the calculating device allocates or frees resources.The most expensive operation for the calculating device is freeing resources, which works much slower than allocating them. It is therefore desirable that each next problem for the calculating device requires no less resources than the previous one.You are given the information about the problems the scientists offered for the testing. You need to arrange these problems in such an order that the number of adjacent ""bad"" pairs of problems in this list is minimum possible. We will call two consecutive problems in this list a ""bad pair"" if the problem that is performed first requires more resources than the one that goes after it. Do not forget that the problems of the same scientist must be solved in a fixed order." 2000
207A2 "Beaver\'s Calculator 1.0" greedy "The Smart Beaver from ABBYY has once again surprised us! He has developed a new calculating device, which he called the ""Beaver\'s Calculator 1.0"". It is very peculiar and it is planned to be used in a variety of scientific problems.To test it, the Smart Beaver invited n scientists, numbered from 1 to n. The i-th scientist brought ki calculating problems for the device developed by the Smart Beaver from ABBYY. The problems of the i-th scientist are numbered from 1 to ki, and they must be calculated sequentially in the described order, since calculating each problem heavily depends on the results of calculating of the previous ones.Each problem of each of the n scientists is described by one integer ai,\xe2\x80\x89j, where i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is the number of the scientist, j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ki) is the number of the problem, and ai,\xe2\x80\x89j is the number of resource units the calculating device needs to solve this problem.The calculating device that is developed by the Smart Beaver is pretty unusual. It solves problems sequentially, one after another. After some problem is solved and before the next one is considered, the calculating device allocates or frees resources.The most expensive operation for the calculating device is freeing resources, which works much slower than allocating them. It is therefore desirable that each next problem for the calculating device requires no less resources than the previous one.You are given the information about the problems the scientists offered for the testing. You need to arrange these problems in such an order that the number of adjacent ""bad"" pairs of problems in this list is minimum possible. We will call two consecutive problems in this list a ""bad pair"" if the problem that is performed first requires more resources than the one that goes after it. Do not forget that the problems of the same scientist must be solved in a fixed order." 1800
207A1 "Beaver\'s Calculator 1.0" greedy "The Smart Beaver from ABBYY has once again surprised us! He has developed a new calculating device, which he called the ""Beaver\'s Calculator 1.0"". It is very peculiar and it is planned to be used in a variety of scientific problems.To test it, the Smart Beaver invited n scientists, numbered from 1 to n. The i-th scientist brought ki calculating problems for the device developed by the Smart Beaver from ABBYY. The problems of the i-th scientist are numbered from 1 to ki, and they must be calculated sequentially in the described order, since calculating each problem heavily depends on the results of calculating of the previous ones.Each problem of each of the n scientists is described by one integer ai,\xe2\x80\x89j, where i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is the number of the scientist, j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ki) is the number of the problem, and ai,\xe2\x80\x89j is the number of resource units the calculating device needs to solve this problem.The calculating device that is developed by the Smart Beaver is pretty unusual. It solves problems sequentially, one after another. After some problem is solved and before the next one is considered, the calculating device allocates or frees resources.The most expensive operation for the calculating device is freeing resources, which works much slower than allocating them. It is therefore desirable that each next problem for the calculating device requires no less resources than the previous one.You are given the information about the problems the scientists offered for the testing. You need to arrange these problems in such an order that the number of adjacent ""bad"" pairs of problems in this list is minimum possible. We will call two consecutive problems in this list a ""bad pair"" if the problem that is performed first requires more resources than the one that goes after it. Do not forget that the problems of the same scientist must be solved in a fixed order." 1600
205B "Little Elephant and Sorting" "brute force,greedy" "The Little Elephant loves sortings.He has an array a consisting of n integers. Let\'s number the array elements from 1 to n, then the i-th element will be denoted as ai. The Little Elephant can make one move to choose an arbitrary pair of integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and increase ai by 1 for all i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r.Help the Little Elephant find the minimum number of moves he needs to convert array a to an arbitrary array sorted in the non-decreasing order. Array a, consisting of n elements, is sorted in the non-decreasing order if for any i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 holds." 1400
205A "Little Elephant and Rozdil" "brute force,implementation" "The Little Elephant loves Ukraine very much. Most of all he loves town Rozdol (ukr. ""Rozdil"").However, Rozdil is dangerous to settle, so the Little Elephant wants to go to some other town. The Little Elephant doesn\'t like to spend much time on travelling, so for his journey he will choose a town that needs minimum time to travel to. If there are multiple such cities, then the Little Elephant won\'t go anywhere.For each town except for Rozdil you know the time needed to travel to this town. Find the town the Little Elephant will go to or print ""Still Rozdil"", if he stays in Rozdil." 900
204E "Little Elephant and Strings" "data structures,implementation,string suffix structures,two pointers" "The Little Elephant loves strings very much. He has an array a from n strings, consisting of lowercase English letters. Let\'s number the elements of the array from 1 to n, then let\'s denote the element number i as ai. For each string ai (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) the Little Elephant wants to find the number of pairs of integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|ai|) such that substring ai[l... r] is a substring to at least k strings from array a (including the i-th string).Help the Little Elephant solve this problem.If you are not familiar with the basic notation in string problems, you can find the corresponding definitions in the notes." 2800
204D "Little Elephant and Retro Strings" dp "The Little Elephant has found a ragged old black-and-white string s on the attic.The characters of string s are numbered from the left to the right from 1 to |s|, where |s| is the length of the string. Let\'s denote the i-th character of string s as si. As the string is black-and-white, each character of the string is either letter ""B"", or letter ""W"". Unfortunately, the string is very old and some characters are damaged. The damaged positions are denoted as ""X"".The Little Elephant in determined to restore the string and hang it on the wall. For that he needs to replace each character ""X"" by a ""B"" or a ""W"". The string must look good on the wall, so it must be beautiful. The Little Elephant considers a string beautiful if it has two non-intersecting substrings of a given length k, such that the left one fully consists of characters ""B"", and the right one fully consists of characters ""W"". More formally, there are four integers a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89<\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|; b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89d\xe2\x80\x89-\xe2\x80\x89c\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89k) such that si = ""B"" (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) and sj = ""W"" (c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d). Help the Little Elephant find the number of different beautiful strings he can obtain from string s. Two strings are considered different if there is such position, where the character in the first string differs from the corresponding character in the second string. If this string doesn\'t contain characters \xc2\xabX\xc2\xbb and it is already beautiful \xe2\x80\x94 the answer is 1.As the answer can be rather large, print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897)." 2400
204C "Little Elephant and Furik and Rubik" math,probabilities "Little Elephant loves Furik and Rubik, who he met in a small city Kremenchug.The Little Elephant has two strings of equal length a and b, consisting only of uppercase English letters. The Little Elephant selects a pair of substrings of equal length \xe2\x80\x94 the first one from string a, the second one from string b. The choice is equiprobable among all possible pairs. Let\'s denote the substring of a as x, and the substring of b \xe2\x80\x94 as y. The Little Elephant gives string x to Furik and string y \xe2\x80\x94 to Rubik.Let\'s assume that f(x,\xe2\x80\x89y) is the number of such positions of i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|x|), that xi\xe2\x80\x89=\xe2\x80\x89yi (where |x| is the length of lines x and y, and xi, yi are the i-th characters of strings x and y, correspondingly). Help Furik and Rubik find the expected value of f(x,\xe2\x80\x89y)." 2000
204B "Little Elephant and Cards" "binary search,data structures" "The Little Elephant loves to play with color cards.He has n cards, each has exactly two colors (the color of the front side and the color of the back side). Initially, all the cards lay on the table with the front side up. In one move the Little Elephant can turn any card to the other side. The Little Elephant thinks that a set of cards on the table is funny if at least half of the cards have the same color (for each card the color of the upper side is considered).Help the Little Elephant to find the minimum number of moves needed to make the set of n cards funny." 1500
204A "Little Elephant and Interval" "binary search,combinatorics,dp" "The Little Elephant very much loves sums on intervals.This time he has a pair of integers l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r). The Little Elephant has to find the number of such integers x (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), that the first digit of integer x equals the last one (in decimal notation). For example, such numbers as 101, 477474 or 9 will be included in the answer and 47, 253 or 1020 will not.Help him and count the number of described numbers x for a given pair l and r." 1500
203E Transportation "greedy,sortings,two pointers" "Valera came to Japan and bought many robots for his research. He\'s already at the airport, the plane will fly very soon and Valera urgently needs to bring all robots to the luggage compartment.The robots are self-propelled (they can potentially move on their own), some of them even have compartments to carry other robots. More precisely, for the i-th robot we know value ci \xe2\x80\x94 the number of robots it can carry. In this case, each of ci transported robots can additionally carry other robots.However, the robots need to be filled with fuel to go, so Valera spent all his last money and bought S liters of fuel. He learned that each robot has a restriction on travel distances. Thus, in addition to features ci, the i-th robot has two features fi and li \xe2\x80\x94 the amount of fuel (in liters) needed to move the i-th robot, and the maximum distance that the robot can go.Due to the limited amount of time and fuel, Valera wants to move the maximum number of robots to the luggage compartment. He operates as follows.   First Valera selects some robots that will travel to the luggage compartment on their own. In this case the total amount of fuel required to move all these robots must not exceed S.  Then Valera seats the robots into the compartments, so as to transport as many robots as possible. Note that if a robot doesn\'t move by itself, you can put it in another not moving robot that is moved directly or indirectly by a moving robot.  After that all selected and seated robots along with Valera go to the luggage compartment and the rest robots will be lost. There are d meters to the luggage compartment. Therefore, the robots that will carry the rest, must have feature li of not less than d. During the moving Valera cannot stop or change the location of the robots in any way.Help Valera calculate the maximum number of robots that he will be able to take home, and the minimum amount of fuel he will have to spend, because the remaining fuel will come in handy in Valera\'s research." 2300
203D "Hit Ball" geometry,implementation,math "When Valera was playing football on a stadium, it suddenly began to rain. Valera hid in the corridor under the grandstand not to get wet. However, the desire to play was so great that he decided to train his hitting the ball right in this corridor. Valera went back far enough, put the ball and hit it. The ball bounced off the walls, the ceiling and the floor corridor and finally hit the exit door. As the ball was wet, it left a spot on the door. Now Valera wants to know the coordinates for this spot.Let\'s describe the event more formally. The ball will be considered a point in space. The door of the corridor will be considered a rectangle located on plane xOz, such that the lower left corner of the door is located at point (0,\xe2\x80\x890,\xe2\x80\x890), and the upper right corner is located at point (a,\xe2\x80\x890,\xe2\x80\x89b) . The corridor will be considered as a rectangular parallelepiped, infinite in the direction of increasing coordinates of y. In this corridor the floor will be considered as plane xOy, and the ceiling as plane, parallel to xOy and passing through point (a,\xe2\x80\x890,\xe2\x80\x89b). We will also assume that one of the walls is plane yOz, and the other wall is plane, parallel to yOz and passing through point (a,\xe2\x80\x890,\xe2\x80\x89b).We\'ll say that the ball hit the door when its coordinate y was equal to 0. Thus the coordinates of the spot are point (x0,\xe2\x80\x890,\xe2\x80\x89z0), where 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x890\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89z0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b. To hit the ball, Valera steps away from the door at distance m and puts the ball in the center of the corridor at point . After the hit the ball flies at speed (vx,\xe2\x80\x89vy,\xe2\x80\x89vz). This means that if the ball has coordinates (x,\xe2\x80\x89y,\xe2\x80\x89z), then after one second it will have coordinates (x\xe2\x80\x89+\xe2\x80\x89vx,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89vy,\xe2\x80\x89z\xe2\x80\x89+\xe2\x80\x89vz).See image in notes for clarification.When the ball collides with the ceiling, the floor or a wall of the corridor, it bounces off in accordance with the laws of reflection (the angle of incidence equals the angle of reflection). In the problem we consider the ideal physical model, so we can assume that there is no air resistance, friction force, or any loss of energy." 1700
203C Photographer greedy,sortings "Valera\'s lifelong ambition was to be a photographer, so he bought a new camera. Every day he got more and more clients asking for photos, and one day Valera needed a program that would determine the maximum number of people he can serve.The camera\'s memory is d megabytes. Valera\'s camera can take photos of high and low quality. One low quality photo takes a megabytes of memory, one high quality photo take b megabytes of memory. For unknown reasons, each client asks him to make several low quality photos and several high quality photos. More formally, the i-th client asks to make xi low quality photos and yi high quality photos.Valera wants to serve as many clients per day as possible, provided that they will be pleased with his work. To please the i-th client, Valera needs to give him everything he wants, that is, to make xi low quality photos and yi high quality photos. To make one low quality photo, the camera must have at least a megabytes of free memory space. Similarly, to make one high quality photo, the camera must have at least b megabytes of free memory space. Initially the camera\'s memory is empty. Valera also does not delete photos from the camera so that the camera\'s memory gradually fills up.Calculate the maximum number of clients Valera can successfully serve and print the numbers of these clients." 1400
203B "Game on Paper" "brute force,implementation" "One not particularly beautiful evening Valera got very bored. To amuse himself a little bit, he found the following game.He took a checkered white square piece of paper, consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n cells. After that, he started to paint the white cells black one after the other. In total he painted m different cells on the piece of paper. Since Valera was keen on everything square, he wondered, how many moves (i.e. times the boy paints a square black) he should make till a black square with side 3 can be found on the piece of paper. But Valera does not know the answer to this question, so he asks you to help him.Your task is to find the minimum number of moves, till the checkered piece of paper has at least one black square with side of 3. Otherwise determine that such move does not exist." 1300
203A "Two Problems" "brute force,implementation" "A boy Valera registered on site Codeforces as Valera, and wrote his first Codeforces Round #300. He boasted to a friend Arkady about winning as much as x points for his first contest. But Arkady did not believe his friend\'s words and decided to check whether Valera could have shown such a result.He knows that the contest number 300 was unusual because there were only two problems. The contest lasted for t minutes, the minutes are numbered starting from zero. The first problem had the initial cost of a points, and every minute its cost reduced by da points. The second problem had the initial cost of b points, and every minute this cost reduced by db points. Thus, as soon as the zero minute of the contest is over, the first problem will cost a\xe2\x80\x89-\xe2\x80\x89da points, and the second problem will cost b\xe2\x80\x89-\xe2\x80\x89db points. It is guaranteed that at any moment of the contest each problem has a non-negative cost.Arkady asks you to find out whether Valera could have got exactly x points for this contest. You should assume that Valera could have solved any number of the offered problems. You should also assume that for each problem Valera made no more than one attempt, besides, he could have submitted both problems at the same minute of the contest, starting with minute 0 and ending with minute number t\xe2\x80\x89-\xe2\x80\x891. Please note that Valera can\'t submit a solution exactly t minutes after the start of the contest or later." 1200
202B "Brand New Easy Problem" "brute force" "A widely known among some people Belarusian sport programmer Lesha decided to make some money to buy a one square meter larger flat. To do this, he wants to make and carry out a Super Rated Match (SRM) on the site Torcoder.com. But there\'s a problem \xe2\x80\x94 a severe torcoder coordinator Ivan does not accept any Lesha\'s problem, calling each of them an offensive word ""duped"" (that is, duplicated). And one day they nearely quarrelled over yet another problem Ivan wouldn\'t accept.You are invited to act as a fair judge and determine whether the problem is indeed brand new, or Ivan is right and the problem bears some resemblance to those used in the previous SRMs.You are given the descriptions of Lesha\'s problem and each of Torcoder.com archive problems. The description of each problem is a sequence of words. Besides, it is guaranteed that Lesha\'s problem has no repeated words, while the description of an archive problem may contain any number of repeated words.The ""similarity"" between Lesha\'s problem and some archive problem can be found as follows. Among all permutations of words in Lesha\'s problem we choose the one that occurs in the archive problem as a subsequence. If there are multiple such permutations, we choose the one with the smallest number of inversions. Then the ""similarity"" of a problem can be written as , where n is the number of words in Lesha\'s problem and x is the number of inversions in the chosen permutation. Note that the ""similarity"" p is always a positive integer.The problem is called brand new if there is not a single problem in Ivan\'s archive which contains a permutation of words from Lesha\'s problem as a subsequence.Help the boys and determine whether the proposed problem is new, or specify the problem from the archive which resembles Lesha\'s problem the most, otherwise." 1700
202A LLPS "binary search,bitmasks,brute force,greedy,implementation,strings" "This problem\'s actual name, ""Lexicographically Largest Palindromic Subsequence"" is too long to fit into the page headline.You are given string s consisting of lowercase English letters only. Find its lexicographically largest palindromic subsequence.We\'ll call a non-empty string s[p1p2... pk] = sp1sp2... spk (1 \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89 p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pk \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89 |s|) a subsequence of string s = s1s2... s|s|, where |s| is the length of string s. For example, strings ""abcb"", ""b"" and ""abacaba"" are subsequences of string ""abacaba"".String x = x1x2... x|x| is lexicographically larger than string y = y1y2... y|y| if either |x| > |y| and x1\xe2\x80\x89=\xe2\x80\x89y1, x2\xe2\x80\x89=\xe2\x80\x89y2, ...,\xe2\x80\x89x|y|\xe2\x80\x89=\xe2\x80\x89y|y|, or there exists such number r (r\xe2\x80\x89<\xe2\x80\x89|x|, r\xe2\x80\x89<\xe2\x80\x89|y|) that x1\xe2\x80\x89=\xe2\x80\x89y1, x2\xe2\x80\x89=\xe2\x80\x89y2, ..., xr\xe2\x80\x89=\xe2\x80\x89yr and xr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89yr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891. Characters in the strings are compared according to their ASCII codes. For example, string ""ranger"" is lexicographically larger than string ""racecar"" and string ""poster"" is lexicographically larger than string ""post"".String s = s1s2... s|s| is a palindrome if it matches string rev(s) = s|s|s|s|\xe2\x80\x89-\xe2\x80\x891... s1. In other words, a string is a palindrome if it reads the same way from left to right and from right to left. For example, palindromic strings are ""racecar"", ""refer"" and ""z""." 800
201E "Thoroughly Bureaucratic Organization" "binary search,combinatorics" "Once n people simultaneously signed in to the reception at the recently opened, but already thoroughly bureaucratic organization (abbreviated TBO). As the organization is thoroughly bureaucratic, it can accept and cater for exactly one person per day. As a consequence, each of n people made an appointment on one of the next n days, and no two persons have an appointment on the same day.However, the organization workers are very irresponsible about their job, so none of the signed in people was told the exact date of the appointment. The only way to know when people should come is to write some requests to TBO.The request form consists of m empty lines. Into each of these lines the name of a signed in person can be written (it can be left blank as well). Writing a person\'s name in the same form twice is forbidden, such requests are ignored. TBO responds very quickly to written requests, but the reply format is of very poor quality \xe2\x80\x94 that is, the response contains the correct appointment dates for all people from the request form, but the dates are in completely random order. Responds to all requests arrive simultaneously at the end of the day (each response specifies the request that it answers).Fortunately, you aren\'t among these n lucky guys. As an observer, you have the following task \xe2\x80\x94 given n and m, determine the minimum number of requests to submit to TBO to clearly determine the appointment date for each person." 2600
201D "Brand New Problem" "bitmasks,brute force,dp" "A widely known among some people Belarusian sport programmer Lesha decided to make some money to buy a one square meter larger flat. To do this, he wants to make and carry out a Super Rated Match (SRM) on the site Torcoder.com. But there\'s a problem \xe2\x80\x94 a severe torcoder coordinator Ivan does not accept any Lesha\'s problem, calling each of them an offensive word ""duped"" (that is, duplicated). And one day they nearely quarrelled over yet another problem Ivan wouldn\'t accept.You are invited to act as a fair judge and determine whether the problem is indeed brand new, or Ivan is right and the problem bears some resemblance to those used in the previous SRMs.You are given the descriptions of Lesha\'s problem and each of Torcoder.com archive problems. The description of each problem is a sequence of words. Besides, it is guaranteed that Lesha\'s problem has no repeated words, while the description of an archive problem may contain any number of repeated words.The ""similarity"" between Lesha\'s problem and some archive problem can be found as follows. Among all permutations of words in Lesha\'s problem we choose the one that occurs in the archive problem as a subsequence. If there are multiple such permutations, we choose the one with the smallest number of inversions. Then the ""similarity"" of a problem can be written as , where n is the number of words in Lesha\'s problem and x is the number of inversions in the chosen permutation. Note that the ""similarity"" p is always a positive integer.The problem is called brand new if there is not a single problem in Ivan\'s archive which contains a permutation of words from Lesha\'s problem as a subsequence.Help the boys and determine whether the proposed problem is new, or specify the problem from the archive which resembles Lesha\'s problem the most, otherwise." 2600
201C "Fragile Bridges" dp "You are playing a video game and you have just reached the bonus level, where the only possible goal is to score as many points as possible. Being a perfectionist, you\'ve decided that you won\'t leave this level until you\'ve gained the maximum possible number of points there.The bonus level consists of n small platforms placed in a line and numbered from 1 to n from left to right and (n\xe2\x80\x89-\xe2\x80\x891) bridges connecting adjacent platforms. The bridges between the platforms are very fragile, and for each bridge the number of times one can pass this bridge from one of its ends to the other before it collapses forever is known in advance.The player\'s actions are as follows. First, he selects one of the platforms to be the starting position for his hero. After that the player can freely move the hero across the platforms moving by the undestroyed bridges. As soon as the hero finds himself on a platform with no undestroyed bridge attached to it, the level is automatically ended. The number of points scored by the player at the end of the level is calculated as the number of transitions made by the hero between the platforms. Note that if the hero started moving by a certain bridge, he has to continue moving in the same direction until he is on a platform.Find how many points you need to score to be sure that nobody will beat your record, and move to the next level with a quiet heart." 2000
201B "Guess That Car!" "math,ternary search" "A widely known among some people Belarusian sport programmer Yura possesses lots of information about cars. That is why he has been invited to participate in a game show called ""Guess That Car!"".The game show takes place on a giant parking lot, which is 4n meters long from north to south and 4m meters wide from west to east. The lot has n\xe2\x80\x89+\xe2\x80\x891 dividing lines drawn from west to east and m\xe2\x80\x89+\xe2\x80\x891 dividing lines drawn from north to south, which divide the parking lot into n\xc2\xb7m 4 by 4 meter squares. There is a car parked strictly inside each square. The dividing lines are numbered from 0 to n from north to south and from 0 to m from west to east. Each square has coordinates (i,\xe2\x80\x89j) so that the square in the north-west corner has coordinates (1,\xe2\x80\x891) and the square in the south-east corner has coordinates (n,\xe2\x80\x89m). See the picture in the notes for clarifications.Before the game show the organizers offer Yura to occupy any of the (n\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(m\xe2\x80\x89+\xe2\x80\x891) intersection points of the dividing lines. After that he can start guessing the cars. After Yura chooses a point, he will be prohibited to move along the parking lot before the end of the game show. As Yura is a car expert, he will always guess all cars he is offered, it\'s just a matter of time. Yura knows that to guess each car he needs to spend time equal to the square of the euclidean distance between his point and the center of the square with this car, multiplied by some coefficient characterizing the machine\'s ""rarity"" (the rarer the car is, the harder it is to guess it). More formally, guessing a car with ""rarity"" c placed in a square whose center is at distance d from Yura takes c\xc2\xb7d2 seconds. The time Yura spends on turning his head can be neglected.It just so happened that Yura knows the ""rarity"" of each car on the parking lot in advance. Help him choose his point so that the total time of guessing all cars is the smallest possible." 1800
