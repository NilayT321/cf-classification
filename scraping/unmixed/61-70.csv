92105 Labyrinth-5 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92104 Labyrinth-4 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92103 Labyrinth-3 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92102 Labyrinth-2 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92101 Labyrinth-1 NA "You have a robot in a two-dimensional labyrinth which consists of N\xe2\x80\x89\xc3\x97\xe2\x80\x89M cells. Some pairs of cells adjacent by side are separated by a wall or a door. The labyrinth itself is separated from the outside with walls around it. Some labyrinth cells are the exits. In order to leave the labyrinth the robot should reach any exit. There are keys in some cells. Any key can open any door but after the door is opened the key stays in the lock. Thus every key can be used only once. There are no labyrinth cells that contain both a key and an exit. Also there can not be both a wall and a door between the pair of adjacent cells.Your need to write a program in abc language (see the language description below) that will lead the robot to one of the exits. Lets numerate the labyrinth rows from 0 to N\xe2\x80\x89-\xe2\x80\x891 top to bottom and the columns \xe2\x80\x93 from 0 to M\xe2\x80\x89-\xe2\x80\x891 left to right.In abc language the following primary commands are available:  move-DIR \xe2\x80\x93 move to the adjacent cell in the  direction. down increases the number of the row by 1, right increases the number of the column by 1. In case there\xe2\x80\x99s a wall or a closed door in this direction, nothing\xe2\x80\x99s happening.  open-DIR \xe2\x80\x93 open the door between the current cell and the adjacent one in DIR direction. In case there isn\xe2\x80\x99t any door in this direction or it\xe2\x80\x99s already been opened or the robot doesn\xe2\x80\x99t have a key, nothing\xe2\x80\x99s happening. take \xe2\x80\x93 take the key in the current cell. In case there isn\xe2\x80\x99t any key or the robot has already picked it up, nothing\xe2\x80\x99s happening. The robot is able to carry any number of keys. terminate \xe2\x80\x93 terminate the program. This command is not obligatory to use. In case it\xe2\x80\x99s absent the command is added at the end of the program automatically. Also, there are the following control commands in abc language:   for-N OPS end \xe2\x80\x93 repeat the sequence of the OPS commands N times, 0\xe2\x80\x89<\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89100000. Each loop counter check counts as a command fulfilled by the robot.  if-ok  OPS1  else  OPS2  endif \xe2\x80\x93 carries out the sequence of the OPS1 commands, if the previous command of moving, taking the key or opening the door was successful, otherwise the sequence of the OPS2 commands is being carried out. Should there be no previous command run, the sequence OPS1 will be carried out. If-ok check counts as a command fulfilled by the robot.  break \xe2\x80\x93 stops the current for loop.  continue \xe2\x80\x93 finishes the current for loop iterations. Note that the control and the primary commands can be fit into each other arbitrarily.The robot will fulfill your commands sequentially until it exits the labyrinth, or it runs out of the commands, or the terminate command is run, or the quantity of the fulfilled commands exceeds the bound number 5\xc2\xb7106.In abc language each command is a separate word and should be separated from other commands with at least one space symbol.You should write a program that prints the sequence of commands leading the robot out of the labyrinth. Of course, as you are a good programmer, you should optimize these sequence.The number of the non-space symbols in the sequence should not exceed 107. If you succeed in finding the way out of the labyrinth i you\xe2\x80\x99ll be granted the number of points equal to:  where:   Wi \xe2\x80\x93 labyrinth\xe2\x80\x99s weight, some fixed constant.  Gi \xe2\x80\x93 number of robots moves.  Oi \xe2\x80\x93 number of fulfilled commands. Note that this number includes commands like take executed in the cells with no key, as well as opening commands applied to the already opened doors.  Li \xe2\x80\x93 sequence length in symbols, excluding space symbols and line breaks.  Q\xe2\x80\x89=\xe2\x80\x8910\xc2\xb7N\xc2\xb7M. In case your sequence doesn\xe2\x80\x99t lead the robot to the exit you\xe2\x80\x99ll be granted 0 points. Your programs result will be the sum of all Si. You should maximize this total sum.All labyrinths will be known and available to you. You can download the archive with labyrinths by any of the given links, password to extract files is aimtechiscool:  https://drive.google.com/file/d/1dkIBfW_Gy6c3FJtXjMXZPMsGKRyn3pzp  https://www.dropbox.com/s/77jrplnjgmviiwt/aimmaze.zip?dl=0  https://yadi.sk/d/JNXDLeH63RzaCi In order to make local testing of your programs more convenient, the program calculating your results (checker) and the labyrinth visualizer will be available. This program is written in python3 programming language, that\xe2\x80\x99s why you\xe2\x80\x99re going to need python3 interpreter, as well as pillow library, which you can install with the following command pip3 install pillow. pip3 is a utility program for python3 package (library) installation. It will be installed automatically with the python3 interpreter.Example command to run checker and visualizer: python3 aimmaze.py maze.in robot.abc --image maze.png. The checker can be run separately of visualization: python3 aimmaze.py maze.in robot.abc. Flag --output-log will let you see the information of robots each step: python3 aimmaze.py maze.in robot.abc --output-log. Note python3 can be installed as python on your computer.To adjust image settings, you can edit constants at the beginning of the program aimmaze.py." 3200
920G "List Of Integers" "binary search,bitmasks,brute force,combinatorics,math,number theory" "Let\'s denote as L(x,\xe2\x80\x89p) an infinite sequence of integers y such that gcd(p,\xe2\x80\x89y)\xe2\x80\x89=\xe2\x80\x891 and y\xe2\x80\x89>\xe2\x80\x89x (where gcd is the greatest common divisor of two integer numbers), sorted in ascending order. The elements of L(x,\xe2\x80\x89p) are 1-indexed; for example, 9, 13 and 15 are the first, the second and the third elements of L(7,\xe2\x80\x8922), respectively.You have to process t queries. Each query is denoted by three integers x, p and k, and the answer to this query is k-th element of L(x,\xe2\x80\x89p)." 2200
920F "SUM and REPLACE" "brute force,data structures,dsu,number theory" "Let D(x) be the number of positive divisors of a positive integer x. For example, D(2)\xe2\x80\x89=\xe2\x80\x892 (2 is divisible by 1 and 2), D(6)\xe2\x80\x89=\xe2\x80\x894 (6 is divisible by 1, 2, 3 and 6).You are given an array a of n integers. You have to process two types of queries:  REPLACE l r \xe2\x80\x94 for every  replace ai with D(ai);  SUM l r \xe2\x80\x94 calculate . Print the answer for each SUM query." 2000
920E "Connected Components?" "data structures,dfs and similar,dsu,graphs" "You are given an undirected graph consisting of n vertices and  edges. Instead of giving you the edges that exist in the graph, we give you m unordered pairs (x,\xe2\x80\x89y) such that there is no edge between x and y, and if some pair of vertices is not listed in the input, then there is an edge between these vertices.You have to find the number of connected components in the graph and the size of each component. A connected component is a set of vertices X such that for every two vertices from this set there exists at least one path in the graph connecting these vertices, but adding any other vertex to X violates this rule." 2100
920D Tanks dp,greedy,implementation "Petya sometimes has to water his field. To water the field, Petya needs a tank with exactly V ml of water.Petya has got N tanks, i-th of them initially containing ai ml of water. The tanks are really large, any of them can contain any amount of water (no matter how large this amount is).Also Petya has got a scoop that can contain up to K ml of water (initially the scoop is empty). This scoop can be used to get some water from some tank, and after that pour it all into some tank (it is impossible to get water from multiple tanks without pouring it, or leave some water in the scoop when pouring it). When Petya tries to get some water from a tank, he gets min(v,\xe2\x80\x89K) water, where v is the current volume of water in the tank.Is it possible to obtain a tank with exactly V ml of water using these operations? If it is possible, print a sequence of operations that allows to do it. If there are multiple ways to obtain needed amount of water in some tank, print any of them." 2400
920C "Swap Adjacent Elements" "dfs and similar,greedy,math,sortings,two pointers" "You have an array a consisting of n integers. Each integer from 1 to n appears exactly once in this array.For some indices i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) it is possible to swap i-th element with (i\xe2\x80\x89+\xe2\x80\x891)-th, for other indices it is not possible. You may perform any number of swapping operations any order. There is no limit on the number of times you swap i-th element with (i\xe2\x80\x89+\xe2\x80\x891)-th (if the position is not forbidden).Can you make this array sorted in ascending order performing some sequence of swapping operations?" 1400
920B "Tea Queue" implementation "Recently n students from city S moved to city P to attend a programming camp.They moved there by train. In the evening, all students in the train decided that they want to drink some tea. Of course, no two people can use the same teapot simultaneously, so the students had to form a queue to get their tea.i-th student comes to the end of the queue at the beginning of li-th second. If there are multiple students coming to the queue in the same moment, then the student with greater index comes after the student with lesser index. Students in the queue behave as follows: if there is nobody in the queue before the student, then he uses the teapot for exactly one second and leaves the queue with his tea; otherwise the student waits for the people before him to get their tea. If at the beginning of ri-th second student i still cannot get his tea (there is someone before him in the queue), then he leaves the queue without getting any tea. For each student determine the second he will use the teapot and get his tea (if he actually gets it)." 1200
920A "Water The Garden" implementation "It is winter now, and Max decided it\'s about time he watered the garden.The garden can be represented as n consecutive garden beds, numbered from 1 to n. k beds contain water taps (i-th tap is located in the bed xi), which, if turned on, start delivering water to neighbouring beds. If the tap on the bed xi is turned on, then after one second has passed, the bed xi will be watered; after two seconds have passed, the beds from the segment [xi\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891] will be watered (if they exist); after j seconds have passed (j is an integer number), the beds from the segment [xi\xe2\x80\x89-\xe2\x80\x89(j\xe2\x80\x89-\xe2\x80\x891),\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x89(j\xe2\x80\x89-\xe2\x80\x891)] will be watered (if they exist). Nothing changes during the seconds, so, for example, we can\'t say that the segment [xi\xe2\x80\x89-\xe2\x80\x892.5,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x892.5] will be watered after 2.5 seconds have passed; only the segment [xi\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x892] will be watered at that moment.  The garden from test 1. White colour denotes a garden bed without a tap, red colour \xe2\x80\x94 a garden bed with a tap.   The garden from test 1 after 2 seconds have passed after turning on the tap. White colour denotes an unwatered garden bed, blue colour \xe2\x80\x94 a watered bed. Max wants to turn on all the water taps at the same moment, and now he wonders, what is the minimum number of seconds that have to pass after he turns on some taps until the whole garden is watered. Help him to find the answer!" 1000
919F "A Game With Numbers" "games,graphs,shortest paths" "Imagine that Alice is playing a card game with her friend Bob. They both have exactly 8 cards and there is an integer on each card, ranging from 0 to 4. In each round, Alice or Bob in turns choose two cards from different players, let them be a and b, where a is the number on the player\'s card, and b is the number on the opponent\'s card. It is necessary that a\xe2\x8b\x85b\xe2\x89\xa00. Then they calculate c=(a+b)mod5 and replace the number a with c. The player who ends up with numbers on all 8 cards being 0, wins.Now Alice wants to know who wins in some situations. She will give you her cards\' numbers, Bob\'s cards\' numbers and the person playing the first round. Your task is to determine who wins if both of them choose the best operation in their rounds." 2600
919E "Congruence Equation" "chinese remainder theorem,math,number theory" "Given an integer x. Your task is to find out how many positive integers n (1\xe2\x89\xa4n\xe2\x89\xa4x) satisfy n\xe2\x8b\x85an\xe2\x89\xa1b(modp), where a,b,p are all known constants." 2100
919D Substring "dfs and similar,dp,graphs" "You are given a graph with n nodes and m directed edges. One lowercase letter is assigned to each node. We define a path\'s value as the number of the most frequently occurring letter. For example, if letters on a path are ""abaca"", then the value of that path is 3. Your task is find a path whose value is the largest." 1700
919C "Seat Arrangements" "brute force,implementation" "Suppose that you are in a campus and have to go for classes day by day. As you may see, when you hurry to a classroom, you surprisingly find that many seats there are already occupied. Today you and your friends went for class, and found out that some of the seats were occupied.The classroom contains n rows of seats and there are m seats in each row. Then the classroom can be represented as an n\xc3\x97m matrix. The character \'.\' represents an empty seat, while \'*\' means that the seat is occupied. You need to find k consecutive empty seats in the same row or column and arrange those seats for you and your friends. Your task is to find the number of ways to arrange the seats. Two ways are considered different if sets of places that students occupy differs." 1300
919B "Perfect Number" "binary search,brute force,dp,implementation,number theory" "We consider a positive integer perfect, if and only if the sum of its digits is exactly 10. Given a positive integer k, your task is to find the k-th smallest perfect positive integer." 1100
919A Supermarket "brute force,greedy,implementation" "We often go to supermarkets to buy some fruits or vegetables, and on the tag there prints the price for a kilo. But in some supermarkets, when asked how much the items are, the clerk will say that a yuan for b kilos (You don\'t need to care about what ""yuan"" is), the same as a/b yuan for a kilo.Now imagine you\'d like to buy m kilos of apples. You\'ve asked n supermarkets and got the prices. Find the minimum cost for those apples.You can assume that there are enough apples in all supermarkets." 800
918B "Radio Station" implementation,strings "As the guys fried the radio station facilities, the school principal gave them tasks as a punishment. Dustin\'s task was to add comments to nginx configuration for school\'s website. The school has n servers. Each server has a name and an ip (names aren\'t necessarily unique, but ips are). Dustin knows the ip and name of each server. For simplicity, we\'ll assume that an nginx command is of form ""command ip;"" where command is a string consisting of English lowercase letter only, and ip is the ip of one of school servers.  Each ip is of form ""a.b.c.d"" where a, b, c and d are non-negative integers less than or equal to 255 (with no leading zeros). The nginx configuration file Dustin has to add comments to has m commands. Nobody ever memorizes the ips of servers, so to understand the configuration better, Dustin has to comment the name of server that the ip belongs to at the end of each line (after each command). More formally, if a line is ""command ip;"" Dustin has to replace it with ""command ip; #name"" where name is the name of the server with ip equal to ip.Dustin doesn\'t know anything about nginx, so he panicked again and his friends asked you to do his task for him." 900
918A Eleven "brute force,implementation" "Eleven wants to choose a new name for herself. As a bunch of geeks, her friends suggested an algorithm to choose a name for her. Eleven wants her name to have exactly n characters.   Her friend suggested that her name should only consist of uppercase and lowercase letters \'O\'. More precisely, they suggested that the i-th letter of her name should be \'O\' (uppercase) if i is a member of Fibonacci sequence, and \'o\' (lowercase) otherwise. The letters in the name are numbered from 1 to n. Fibonacci sequence is the sequence f where  f1\xe2\x80\x89=\xe2\x80\x891,  f2\xe2\x80\x89=\xe2\x80\x891,  fn\xe2\x80\x89=\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x891 (n\xe2\x80\x89>\xe2\x80\x892). As her friends are too young to know what Fibonacci sequence is, they asked you to help Eleven determine her new name." 800
917E "Upside Down" "data structures,string suffix structures,strings,trees" "As we all know, Eleven has special abilities. Thus, Hopper convinced her to close the gate to the Upside Down World with her mind. Upside down monsters like to move between the worlds, so they are going to attack Hopper and Eleven in order to make them stop. The monsters live in the vines. The vines form a tree with n vertices, numbered from 1 through n. There\'s a lowercase English letter written in each tunnel (edge).  Upside down is a magical world. There are m types of monsters in upside down, numbered from 1 through m. Each type of monster has a special word that gives them powers. The special word of type i is si. There are q monsters in upside down. Each one is at a junction (vertex) and is going to some other junction. If monster of type k goes from junction i to junction j, the power it gains is the number of times it sees its special world (sk) consecutively in the tunnels. More formally: If f(i,\xe2\x80\x89j) is the string we get when we concatenate the letters written in the tunnels on the shortest path from i to j, then the power the monster gains is the number of occurrences of sk in f(i,\xe2\x80\x89j).Hopper and Eleven want to get prepared, so for each monster, they want to know the power the monster gains after moving." 3400
917D "Stranger Trees" dp,math,matrices,trees "Will shares a psychic connection with the Upside Down Monster, so everything the monster knows, Will knows. Suddenly, he started drawing, page after page, non-stop. Joyce, his mom, and Chief Hopper put the drawings together, and they realized, it\'s a labeled tree!  A tree is a connected acyclic graph. Will\'s tree has n vertices. Joyce and Hopper don\'t know what that means, so they\'re investigating this tree and similar trees. For each k such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, they\'re going to investigate all labeled trees with n vertices that share exactly k edges with Will\'s tree. Two labeled trees are different if and only if there\'s a pair of vertices (v,\xe2\x80\x89u) such that there\'s an edge between v and u in one tree and not in the other one.Hopper and Joyce want to know how much work they have to do, so they asked you to tell them the number of labeled trees with n vertices that share exactly k edges with Will\'s tree, for each k. The answer could be very large, so they only asked you to tell them the answers modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897." 2600
917C Pollywog combinatorics,dp,matrices "As we all know, Dart is some kind of creature from Upside Down world. For simplicity, we call their kind pollywogs. Dart and x\xe2\x80\x89-\xe2\x80\x891 other pollywogs are playing a game. There are n stones in a row, numbered from 1 through n from left to right. At most 1 pollywog may be sitting on each stone at a time. Initially, the pollywogs are sitting on the first x stones (one pollywog on each stone).  Dart and his friends want to end up on the last x stones. At each second, the leftmost pollywog should jump to the right. A pollywog can jump at most k stones; more specifically, a pollywog can jump from stone number i to stones i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89... i\xe2\x80\x89+\xe2\x80\x89k. A pollywog can\'t jump on an occupied stone. Jumping a distance i takes ci amounts of energy from the pollywog. Also, q stones are special Each time landing on a special stone p, takes wp amounts of energy (in addition to the energy for jump) from the pollywog. wp could be negative, in this case, it means the pollywog absorbs |wp| amounts of energy.Pollywogs want to spend as little energy as possible (this value could be negative). They\'re just pollywogs, so they asked for your help. Tell them the total change in their energy, in case they move optimally." 2900
917B MADMAX "dfs and similar,dp,games,graphs" "As we all know, Max is the best video game player among her friends. Her friends were so jealous of hers, that they created an actual game just to prove that she\'s not the best at games. The game is played on a directed acyclic graph (a DAG) with n vertices and m edges. There\'s a character written on each edge, a lowercase English letter.  Max and Lucas are playing the game. Max goes first, then Lucas, then Max again and so on. Each player has a marble, initially located at some vertex. Each player in his/her turn should move his/her marble along some edge (a player can move the marble from vertex v to vertex u if there\'s an outgoing edge from v to u). If the player moves his/her marble from vertex v to vertex u, the ""character"" of that round is the character written on the edge from v to u. There\'s one additional rule; the ASCII code of character of round i should be greater than or equal to the ASCII code of character of round i\xe2\x80\x89-\xe2\x80\x891 (for i\xe2\x80\x89>\xe2\x80\x891). The rounds are numbered for both players together, i. e. Max goes in odd numbers, Lucas goes in even numbers. The player that can\'t make a move loses the game. The marbles may be at the same vertex at the same time.Since the game could take a while and Lucas and Max have to focus on finding Dart, they don\'t have time to play. So they asked you, if they both play optimally, who wins the game?You have to determine the winner of the game for all initial positions of the marbles." 1700
917A "The Monster" dp,greedy,implementation,math "As Will is stuck in the Upside Down, he can still communicate with his mom, Joyce, through the Christmas lights (he can turn them on and off with his mind). He can\'t directly tell his mom where he is, because the monster that took him to the Upside Down will know and relocate him.   Thus, he came up with a puzzle to tell his mom his coordinates. His coordinates are the answer to the following problem.A string consisting only of parentheses (\'(\' and \')\') is called a bracket sequence. Some bracket sequence are called correct bracket sequences. More formally:  Empty string is a correct bracket sequence.  if s is a correct bracket sequence, then (s) is also a correct bracket sequence.  if s and t are correct bracket sequences, then st (concatenation of s and t) is also a correct bracket sequence. A string consisting of parentheses and question marks (\'?\') is called pretty if and only if there\'s a way to replace each question mark with either \'(\' or \')\' such that the resulting string is a non-empty correct bracket sequence.Will gave his mom a string s consisting of parentheses and question marks (using Morse code through the lights) and his coordinates are the number of pairs of integers (l,\xe2\x80\x89r) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s| and the string slsl\xe2\x80\x89+\xe2\x80\x891... sr is pretty, where si is i-th character of s.Joyce doesn\'t know anything about bracket sequences, so she asked for your help." 1800
916E "Jamie and Tree" "data structures,trees" "To your surprise, Jamie is the final boss! Ehehehe.Jamie has given you a tree with n vertices, numbered from 1 to n. Initially, the root of the tree is the vertex with number 1. Also, each vertex has a value on it.Jamie also gives you three types of queries on the tree:1 v \xe2\x80\x94 Change the tree\'s root to vertex with number v.2 u v x \xe2\x80\x94 For each vertex in the subtree of smallest size that contains u and v, add x to its value.3 v \xe2\x80\x94 Find sum of values of vertices in the subtree of vertex with number v.A subtree of vertex v is a set of vertices such that v lies on shortest path from this vertex to root of the tree. Pay attention that subtree of a vertex can change after changing the tree\'s root.Show your strength in programming to Jamie by performing the queries accurately!" 2400
916D "Jamie and To-do List" "data structures,interactive,trees" "Why I have to finish so many assignments???Jamie is getting very busy with his school life. He starts to forget the assignments that he has to do. He decided to write the things down on a to-do list. He assigns a value priority for each of his assignment (lower value means more important) so he can decide which he needs to spend more time on.After a few days, Jamie finds out the list is too large that he can\'t even manage the list by himself! As you are a good friend of Jamie, help him write a program to support the following operations on the to-do list:  set ai xi \xe2\x80\x94 Add assignment ai to the to-do list if it is not present, and set its priority to xi. If assignment ai is already in the to-do list, its priority is changed to xi.  remove ai \xe2\x80\x94 Remove assignment ai from the to-do list if it is present in it.  query ai \xe2\x80\x94 Output the number of assignments that are more important (have a smaller priority value) than assignment ai, so Jamie can decide a better schedule. Output \xe2\x80\x89-\xe2\x80\x891 if ai is not in the to-do list.  undo di \xe2\x80\x94 Undo all changes that have been made in the previous di days (not including the day of this operation) At day 0, the to-do list is empty. In each of the following q days, Jamie will do exactly one out of the four operations. If the operation is a query, you should output the result of the query before proceeding to the next day, or poor Jamie cannot make appropriate decisions." 2200
916C "Jamie and Interesting Graph" "constructive algorithms,graphs,shortest paths" "Jamie has recently found undirected weighted graphs with the following properties very interesting:  The graph is connected and contains exactly n vertices and m edges.  All edge weights are integers and are in range [1,\xe2\x80\x89109] inclusive.  The length of shortest path from 1 to n is a prime number.  The sum of edges\' weights in the minimum spanning tree (MST) of the graph is a prime number.  The graph contains no loops or multi-edges. If you are not familiar with some terms from the statement you can find definitions of them in notes section. Help Jamie construct any graph with given number of vertices and edges that is interesting!" 1600
916B "Jamie and Binary Sequence (changed after round)" bitmasks,greedy,math "Jamie is preparing a Codeforces round. He has got an idea for a problem, but does not know how to solve it. Help him write a solution to the following problem:Find k integers such that the sum of two to the power of each number equals to the number n and the largest integer in the answer is as small as possible. As there may be multiple answers, you are asked to output the lexicographically largest one. To be more clear, consider all integer sequence with length k (a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak) with . Give a value  to each sequence. Among all sequence(s) that have the minimum y value, output the one that is the lexicographically largest.For definitions of powers and lexicographical order see notes." 2000
916A "Jamie and Alarm Snooze" "brute force,implementation,math" "Jamie loves sleeping. One day, he decides that he needs to wake up at exactly hh:\xe2\x80\x89mm. However, he hates waking up, so he wants to make waking up less painful by setting the alarm at a lucky time. He will then press the snooze button every x minutes until hh:\xe2\x80\x89mm is reached, and only then he will wake up. He wants to know what is the smallest number of times he needs to press the snooze button.A time is considered lucky if it contains a digit \'7\'. For example, 13:\xe2\x80\x8907 and 17:\xe2\x80\x8927 are lucky, while 00:\xe2\x80\x8948 and 21:\xe2\x80\x8934 are not lucky.Note that it is not necessary that the time set for the alarm and the wake-up time are on the same day. It is guaranteed that there is a lucky time Jamie can set so that he can wake at hh:\xe2\x80\x89mm.Formally, find the smallest possible non-negative integer y such that the time representation of the time x\xc2\xb7y minutes before hh:\xe2\x80\x89mm contains the digit \'7\'.Jamie uses 24-hours clock, so after 23:\xe2\x80\x8959 comes 00:\xe2\x80\x8900." 900
915G "Coprime Arrays" "math,number theory" "Let\'s call an array a of size n coprime iff gcd(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an)\xe2\x80\x89=\xe2\x80\x891, where gcd is the greatest common divisor of the arguments.You are given two numbers n and k. For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) you have to determine the number of coprime arrays a of size n such that for every j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i. Since the answers can be very large, you have to calculate them modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300
915F "Imbalance Value of a Tree" "data structures,dsu,graphs,trees" "You are given a tree T consisting of n vertices. A number is written on each vertex; the number written on vertex i is ai. Let\'s denote the function I(x,\xe2\x80\x89y) as the difference between maximum and minimum value of ai on a simple path connecting vertices x and y.Your task is to calculate ." 2400
915E "Physical Education Lessons" "data structures,implementation,sortings" "This year Alex has finished school, and now he is a first-year student of Berland State University. For him it was a total surprise that even though he studies programming, he still has to attend physical education lessons. The end of the term is very soon, but, unfortunately, Alex still hasn\'t attended a single lesson!Since Alex doesn\'t want to get expelled, he wants to know the number of working days left until the end of the term, so he can attend physical education lessons during these days. But in BSU calculating the number of working days is a complicated matter:There are n days left before the end of the term (numbered from 1 to n), and initially all of them are working days. Then the university staff sequentially publishes q orders, one after another. Each order is characterised by three numbers l, r and k:  If k\xe2\x80\x89=\xe2\x80\x891, then all days from l to r (inclusive) become non-working days. If some of these days are made working days by some previous order, then these days still become non-working days;  If k\xe2\x80\x89=\xe2\x80\x892, then all days from l to r (inclusive) become working days. If some of these days are made non-working days by some previous order, then these days still become working days. Help Alex to determine the number of working days left after each order!" 2300
915D "Almost Acyclic Graph" "dfs and similar,graphs" "You are given a directed graph consisting of n vertices and m edges (each edge is directed, so it can be traversed in only one direction). You are allowed to remove at most one edge from it.Can you make this graph acyclic by removing at most one edge from it? A directed graph is called acyclic iff it doesn\'t contain any cycle (a non-empty path that starts and ends in the same vertex)." 2200
915C "Permute Digits" dp,greedy "You are given two positive integer numbers a and b. Permute (change order) of the digits of a to construct maximal number not exceeding b. No number in input and/or output can start with the digit 0.It is allowed to leave a as it is." 1700
915B Browser implementation "Luba is surfing the Internet. She currently has n opened tabs in her browser, indexed from 1 to n from left to right. The mouse cursor is currently located at the pos-th tab. Luba needs to use the tabs with indices from l to r (inclusive) for her studies, and she wants to close all the tabs that don\'t belong to this segment as fast as possible.Each second Luba can either try moving the cursor to the left or to the right (if the cursor is currently at the tab i, then she can move it to the tab max(i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89a) or to the tab min(i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89b)) or try closing all the tabs to the left or to the right of the cursor (if the cursor is currently at the tab i, she can close all the tabs with indices from segment [a,\xe2\x80\x89i\xe2\x80\x89-\xe2\x80\x891] or from segment [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89b]). In the aforementioned expressions a and b denote the minimum and maximum index of an unclosed tab, respectively. For example, if there were 7 tabs initially and tabs 1, 2 and 7 are closed, then a\xe2\x80\x89=\xe2\x80\x893, b\xe2\x80\x89=\xe2\x80\x896.What is the minimum number of seconds Luba has to spend in order to leave only the tabs with initial indices from l to r inclusive opened?" 1300
915A Garden implementation "Luba thinks about watering her garden. The garden can be represented as a segment of length k. Luba has got n buckets, the i-th bucket allows her to water some continuous subsegment of garden of length exactly ai each hour. Luba can\'t water any parts of the garden that were already watered, also she can\'t water the ground outside the garden.Luba has to choose one of the buckets in order to water the garden as fast as possible (as mentioned above, each hour she will water some continuous subsegment of length ai if she chooses the i-th bucket). Help her to determine the minimum number of hours she has to spend watering the garden. It is guaranteed that Luba can always choose a bucket so it is possible water the garden.See the examples for better understanding." 900
914H "Ember and Storm\'s Tree Game" combinatorics,dp,games,trees "Ember and Storm play a game. First, Ember picks a labelled tree T of n vertices, such that the degree of every vertex is at most d. Then, Storm picks two distinct vertices u and v in this tree and writes down the labels of the vertices in the path from u to v in a sequence a1,\xe2\x80\x89a2... ak. Finally, Ember picks any index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k) in the array. Now he performs one of the following two operations exactly once:  flip the subrange [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89k] and add ai to it. After this, the sequence becomes a1,\xe2\x80\x89... ai,\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89ak\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89... ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai  negate the subrange [i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89k] and add ai to it. i.e., the array becomes a1,\xe2\x80\x89... ai,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89ai,\xe2\x80\x89...\xe2\x80\x89-\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x89ai Ember wins if the array is monotonically increasing or decreasing after this. Otherwise Storm wins.The game can be described by the tuple (T,\xe2\x80\x89u,\xe2\x80\x89v,\xe2\x80\x89i,\xe2\x80\x89op) where op is \xc2\xabflip\xc2\xbb or \xc2\xabnegate\xc2\xbb depending on the action Ember chose in the last turn. Find the number of tuples that can occur if Ember and Storm play optimally. When they play optimally, if there are multiple moves by which they are guaranteed to win, then they may play any of the winning moves. Otherwise, if someone loses no matter what they play, then they may play any of the possible moves.Report the answer modulo m." 3400
914G "Sum the Fibonacci" "bitmasks,divide and conquer,dp,fft,math" "You are given an array s of n non-negative integers.A 5-tuple of integers (a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89e) is said to be valid if it satisfies the following conditions:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89e\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n  (sa | sb) & sc & (sd ^ se)\xe2\x80\x89=\xe2\x80\x892i for some integer i  sa & sb\xe2\x80\x89=\xe2\x80\x890 Here, \'|\' is the bitwise OR, \'&\' is the bitwise AND and \'^\' is the bitwise XOR operation.Find the sum of f(sa|sb)\xe2\x80\x89*\xe2\x80\x89f(sc)\xe2\x80\x89*\xe2\x80\x89f(sd^se) over all valid 5-tuples (a,\xe2\x80\x89b,\xe2\x80\x89c,\xe2\x80\x89d,\xe2\x80\x89e), where f(i) is the i-th Fibonnaci number (f(0)\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89f(1)\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89f(i)\xe2\x80\x89=\xe2\x80\x89f(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89f(i\xe2\x80\x89-\xe2\x80\x892)).Since answer can be is huge output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2600
914F "Substrings in a String" "bitmasks,brute force,data structures,string suffix structures,strings" "Given a string s, process q queries, each having one of the following forms:  1\xe2\x80\x89i\xe2\x80\x89c \xe2\x80\x94 Change the i-th character in the string to c.  2\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89y \xe2\x80\x94 Consider the substring of s starting at position l and ending at position r. Output the number of times y occurs as a substring in it." 3000
914E "Palindromes in a Tree" "bitmasks,data structures,divide and conquer,trees" "You are given a tree (a connected acyclic undirected graph) of n vertices. Vertices are numbered from 1 to n and each vertex is assigned a character from a to t.A path in the tree is said to be palindromic if at least one permutation of the labels in the path is a palindrome.For each vertex, output the number of palindromic paths passing through it. Note: The path from vertex u to vertex v is considered to be the same as the path from vertex v to vertex u, and this path will be counted only once for each of the vertices it passes through." 2400
914D "Bash and a Tough Math Puzzle" "data structures,number theory" "Bash likes playing with arrays. He has an array a1,\xe2\x80\x89a2,\xe2\x80\x89... an of n integers. He likes to guess the greatest common divisor (gcd) of different segments of the array. Of course, sometimes the guess is not correct. However, Bash will be satisfied if his guess is almost correct.Suppose he guesses that the gcd of the elements in the range [l,\xe2\x80\x89r] of a is x. He considers the guess to be almost correct if he can change at most one element in the segment such that the gcd of the segment is x after making the change. Note that when he guesses, he doesn\'t actually change the array \xe2\x80\x94 he just wonders if the gcd of the segment can be made x. Apart from this, he also sometimes makes changes to the array itself.Since he can\'t figure it out himself, Bash wants you to tell him which of his guesses are almost correct. Formally, you have to process q queries of one of the following forms:  1\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89x \xe2\x80\x94 Bash guesses that the gcd of the range [l,\xe2\x80\x89r] is x. Report if this guess is almost correct.  2\xe2\x80\x89i\xe2\x80\x89y \xe2\x80\x94 Bash sets ai to y. Note: The array is 1-indexed." 1900
914C "Travelling Salesman and Special Numbers" "brute force,combinatorics,dp" "The Travelling Salesman spends a lot of time travelling so he tends to get bored. To pass time, he likes to perform operations on numbers. One such operation is to take a positive integer x and reduce it to the number of bits set to 1 in the binary representation of x. For example for number 13 it\'s true that 1310\xe2\x80\x89=\xe2\x80\x8911012, so it has 3 bits set and 13 will be reduced to 3 in one operation.He calls a number special if the minimum number of operations to reduce it to 1 is k.He wants to find out how many special numbers exist which are not greater than n. Please help the Travelling Salesman, as he is about to reach his destination!Since the answer can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 1800
914B "Conan and Agasa play a Card Game" games,greedy,implementation "Edogawa Conan got tired of solving cases, and invited his friend, Professor Agasa, over. They decided to play a game of cards. Conan has n cards, and the i-th card has a number ai written on it.They take turns playing, starting with Conan. In each turn, the player chooses a card and removes it. Also, he removes all cards having a number strictly lesser than the number on the chosen card. Formally, if the player chooses the i-th card, he removes that card and removes the j-th card for all j such that aj\xe2\x80\x89<\xe2\x80\x89ai.A player loses if he cannot make a move on his turn, that is, he loses if there are no cards left. Predict the outcome of the game, assuming both players play optimally." 1200
914A "Perfect Squares" "brute force,implementation,math" "Given an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n integers, find the largest number in the array that is not a perfect square.A number x is said to be a perfect square if there exists an integer y such that x\xe2\x80\x89=\xe2\x80\x89y2." 900
913H "Don\'t Exceed" math,probabilities "You generate real numbers s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn as follows:   s0\xe2\x80\x89=\xe2\x80\x890;  si\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89ti, where ti is a real number chosen independently uniformly at random between 0 and 1, inclusive. You are given real numbers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. You are interested in the probability that si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi is true for all i simultaneously.It can be shown that this can be represented as , where P and Q are coprime integers, and . Print the value of P\xc2\xb7Q\xe2\x80\x89-\xe2\x80\x891 modulo 998244353." 3400
913G "Power Substring" "math,number theory" "You are given n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.For every ai you need to find a positive integer ki such that the decimal notation of 2ki contains the decimal notation of ai as a substring among its last min(100,\xe2\x80\x89length(2ki)) digits. Here length(m) is the length of the decimal notation of m.Note that you don\'t have to minimize ki. The decimal notations in this problem do not contain leading zeros." 3200
913F "Strongly Connected Tournament" dp,graphs,math,probabilities "There is a chess tournament in All-Right-City. n players were invited to take part in the competition. The tournament is held by the following rules:  Initially, each player plays one game with every other player. There are no ties;  After that, the organizers build a complete directed graph with players as vertices. For every pair of players there is exactly one directed edge between them: the winner of their game is the startpoint of this edge and the loser is the endpoint;  After that, the organizers build a condensation of this graph. The condensation of this graph is an acyclic complete graph, therefore it has the only Hamiltonian path which consists of strongly connected components of initial graph A1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89A2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89...\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89Ak.  The players from the first component A1 are placed on the first  places, the players from the component A2 are placed on the next  places, and so on.  To determine exact place of each player in a strongly connected component, all the procedures from 1 to 5 are repeated recursively inside each component, i.e. for every i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89k players from the component Ai play games with each other again, and so on;  If a component consists of a single player, then he has no more rivals, his place is already determined and the process stops. The players are enumerated with integers from 1 to n. The enumeration was made using results of a previous tournament. It is known that player i wins player j (i\xe2\x80\x89<\xe2\x80\x89j) with probability p.You need to help to organize the tournament. Find the expected value of total number of games played by all the players. It can be shown that the answer can be represented as , where P and Q are coprime integers and . Print the value of P\xc2\xb7Q\xe2\x80\x89-\xe2\x80\x891 modulo 998244353.If you are not familiar with any of the terms above, you can read about them here." 2800
913E "Logical Expression" "bitmasks,dp,shortest paths" "You are given a boolean function of three variables which is defined by its truth table. You need to find an expression of minimum length that equals to this function. The expression may consist of:   Operation AND (\'&\', ASCII code 38)  Operation OR (\'|\', ASCII code 124)  Operation NOT (\'!\', ASCII code 33)  Variables x, y and z (ASCII codes 120-122)  Parentheses (\'(\', ASCII code 40, and \')\', ASCII code 41) If more than one expression of minimum length exists, you should find the lexicographically smallest one.Operations have standard priority. NOT has the highest priority, then AND goes, and OR has the lowest priority. The expression should satisfy the following grammar:E ::= E \'|\' T | TT ::= T \'&\' F | FF ::= \'!\' F | \'(\' E \')\' | \'x\' | \'y\' | \'z\'" 2400
913D "Too Easy Problems" "binary search,brute force,data structures,greedy,sortings" "You are preparing for an exam on scheduling theory. The exam will last for exactly T milliseconds and will consist of n problems. You can either solve problem i in exactly ti milliseconds or ignore it and spend no time. You don\'t need time to rest after solving a problem, either.Unfortunately, your teacher considers some of the problems too easy for you. Thus, he assigned an integer ai to every problem i meaning that the problem i can bring you a point to the final score only in case you have solved no more than ai problems overall (including problem i).Formally, suppose you solve problems p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk during the exam. Then, your final score s will be equal to the number of values of j between 1 and k such that k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89apj.You have guessed that the real first problem of the exam is already in front of you. Therefore, you want to choose a set of problems to solve during the exam maximizing your final score in advance. Don\'t forget that the exam is limited in time, and you must have enough time to solve all chosen problems. If there exist different sets of problems leading to the maximum final score, any of them will do." 1800
913C "Party Lemonade" bitmasks,dp,greedy "A New Year party is not a New Year party without lemonade! As usual, you are expecting a lot of guests, and buying lemonade has already become a pleasant necessity.Your favorite store sells lemonade in bottles of n different volumes at different costs. A single bottle of type i has volume 2i\xe2\x80\x89-\xe2\x80\x891 liters and costs ci roubles. The number of bottles of each type in the store can be considered infinite.You want to buy at least L liters of lemonade. How many roubles do you have to spend?" 1600
913B "Christmas Spruce" implementation,trees "Consider a rooted tree. A rooted tree has one special vertex called the root. All edges are directed from the root. Vertex u is called a child of vertex v and vertex v is called a parent of vertex u if there exists a directed edge from v to u. A vertex is called a leaf if it doesn\'t have children and has a parent.Let\'s call a rooted tree a spruce if its every non-leaf vertex has at least 3 leaf children. You are given a rooted tree, check whether it\'s a spruce.The definition of a rooted tree can be found here." 1200
913A "Modular Exponentiation" implementation,math "The following problem is well-known: given integers n and m, calculate , where 2n\xe2\x80\x89=\xe2\x80\x892\xc2\xb72\xc2\xb7...\xc2\xb72 (n factors), and  denotes the remainder of division of x by y.You are asked to solve the ""reverse"" problem. Given integers n and m, calculate ." 900
912E "Prime Gift" "binary search,dfs and similar,math,meet-in-the-middle,number theory,two pointers" "Opposite to Grisha\'s nice behavior, Oleg, though he has an entire year at his disposal, didn\'t manage to learn how to solve number theory problems in the past year. That\'s why instead of Ded Moroz he was visited by his teammate Andrew, who solemnly presented him with a set of n distinct prime numbers alongside with a simple task: Oleg is to find the k-th smallest integer, such that all its prime divisors are in this set." 2400
912D Fishes "data structures,graphs,greedy,probabilities,shortest paths" "While Grisha was celebrating New Year with Ded Moroz, Misha gifted Sasha a small rectangular pond of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, divided into cells of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891, inhabited by tiny evil fishes (no more than one fish per cell, otherwise they\'ll strife!).The gift bundle also includes a square scoop of size r\xe2\x80\x89\xc3\x97\xe2\x80\x89r, designed for fishing. If the lower-left corner of the scoop-net is located at cell (x,\xe2\x80\x89y), all fishes inside the square (x,\xe2\x80\x89y)...(x\xe2\x80\x89+\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891) get caught. Note that the scoop-net should lie completely inside the pond when used.Unfortunately, Sasha is not that skilled in fishing and hence throws the scoop randomly. In order to not frustrate Sasha, Misha decided to release k fishes into the empty pond in such a way that the expected value of the number of caught fishes is as high as possible. Help Misha! In other words, put k fishes in the pond into distinct cells in such a way that when the scoop-net is placed into a random position among (n\xe2\x80\x89-\xe2\x80\x89r\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(m\xe2\x80\x89-\xe2\x80\x89r\xe2\x80\x89+\xe2\x80\x891) possible positions, the average number of caught fishes is as high as possible." 2100
912C "Perun, Ult!" "brute force,greedy,sortings" "A lot of students spend their winter holidays productively. Vlad has advanced very well in doing so! For three days already, fueled by salads and tangerines \xe2\x80\x94 the leftovers from New Year celebration \xe2\x80\x94 he has been calibrating his rating in his favorite MOBA game, playing as a hero named Perun.Perun has an ultimate ability called ""Thunderwrath"". At the instant of its activation, each enemy on the map (n of them in total) loses  health points as a single-time effect. It also has a restriction: it can only activated when the moment of time is an integer. The initial bounty for killing an enemy is . Additionally, it increases by  each second. Formally, if at some second t the ability is activated and the i-th enemy is killed as a result (i.e. his health drops to zero or lower), Vlad earns  units of gold.Every enemy can receive damage, as well as be healed. There are multiple ways of doing so, but Vlad is not interested in details. For each of n enemies he knows:    \xe2\x80\x94 maximum number of health points for the i-th enemy;   \xe2\x80\x94 initial health of the enemy (on the 0-th second);   \xe2\x80\x94 the amount of health the i-th enemy can regenerate per second. There also m health updates Vlad knows about:    \xe2\x80\x94 time when the health was updated;   \xe2\x80\x94 the enemy whose health was updated;   \xe2\x80\x94 updated health points for enemyj. Obviously, Vlad wants to maximize his profit. If it\'s necessary, he could even wait for years to activate his ability at the right second. Help him determine the exact second (note that it must be an integer) from 0 (inclusively) to \xe2\x80\x89+\xe2\x80\x89\xe2\x88\x9e so that a single activation of the ability would yield Vlad the maximum possible amount of gold, and print this amount." 2500
912B "New Year\'s Eve" "bitmasks,constructive algorithms,number theory" "Since Grisha behaved well last year, at New Year\'s Eve he was visited by Ded Moroz who brought an enormous bag of gifts with him! The bag contains n sweet candies from the good ol\' bakery, each labeled from 1 to n corresponding to its tastiness. No two candies have the same tastiness.The choice of candies has a direct effect on Grisha\'s happiness. One can assume that he should take the tastiest ones \xe2\x80\x94 but no, the holiday magic turns things upside down. It is the xor-sum of tastinesses that matters, not the ordinary sum!A xor-sum of a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am is defined as the bitwise XOR of all its elements: , here  denotes the bitwise XOR operation; more about bitwise XOR can be found here.Ded Moroz warned Grisha he has more houses to visit, so Grisha can take no more than k candies from the bag. Help Grisha determine the largest xor-sum (largest xor-sum means maximum happiness!) he can obtain." 1300
912A "Tricky Alchemy" implementation "During the winter holidays, the demand for Christmas balls is exceptionally high. Since it\'s already 2018, the advances in alchemy allow easy and efficient ball creation by utilizing magic crystals.Grisha needs to obtain some yellow, green and blue balls. It\'s known that to produce a yellow ball one needs two yellow crystals, green \xe2\x80\x94 one yellow and one blue, and for a blue ball, three blue crystals are enough.Right now there are A yellow and B blue crystals in Grisha\'s disposal. Find out how many additional crystals he should acquire in order to produce the required number of balls." 800
911G "Mass Change Queries" "data structures" "You are given an array a consisting of n integers. You have to process q queries to this array; each query is given as four numbers l, r, x and y, denoting that for every i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and ai\xe2\x80\x89=\xe2\x80\x89x you have to set ai equal to y.Print the array after all queries are processed." 2500
911F "Tree Destruction" "constructive algorithms,dfs and similar,graphs,greedy,trees" "You are given an unweighted tree with n vertices. Then n\xe2\x80\x89-\xe2\x80\x891 following operations are applied to the tree. A single operation consists of the following steps:   choose two leaves;  add the length of the simple path between them to the answer;  remove one of the chosen leaves from the tree. Initial answer (before applying operations) is 0. Obviously after n\xe2\x80\x89-\xe2\x80\x891 such operations the tree will consist of a single vertex. Calculate the maximal possible answer you can achieve, and construct a sequence of operations that allows you to achieve this answer!" 2400
911E "Stack Sorting" "constructive algorithms,data structures,greedy,implementation" "Let\'s suppose you have an array a, a stack s (initially empty) and an array b (also initially empty).You may perform the following operations until both a and s are empty:  Take the first element of a, push it into s and remove it from a (if a is not empty);  Take the top element from s, append it to the end of array b and remove it from s (if s is not empty). You can perform these operations in arbitrary order.If there exists a way to perform the operations such that array b is sorted in non-descending order in the end, then array a is called stack-sortable.For example, [3,\xe2\x80\x891,\xe2\x80\x892] is stack-sortable, because b will be sorted if we perform the following operations:  Remove 3 from a and push it into s;  Remove 1 from a and push it into s;  Remove 1 from s and append it to the end of b;  Remove 2 from a and push it into s;  Remove 2 from s and append it to the end of b;  Remove 3 from s and append it to the end of b. After all these operations b\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893], so [3,\xe2\x80\x891,\xe2\x80\x892] is stack-sortable. [2,\xe2\x80\x893,\xe2\x80\x891] is not stack-sortable.You are given k first elements of some permutation p of size n (recall that a permutation of size n is an array of size n where each integer from 1 to n occurs exactly once). You have to restore the remaining n\xe2\x80\x89-\xe2\x80\x89k elements of this permutation so it is stack-sortable. If there are multiple answers, choose the answer such that p is lexicographically maximal (an array q is lexicographically greater than an array p iff there exists some integer k such that for every i\xe2\x80\x89<\xe2\x80\x89k qi\xe2\x80\x89=\xe2\x80\x89pi, and qk\xe2\x80\x89>\xe2\x80\x89pk). You may not swap or change any of first k elements of the permutation.Print the lexicographically maximal permutation p you can obtain.If there exists no answer then output -1." 2000
911D "Inversion Counting" "brute force,math" "A permutation of size n is an array of size n such that each integer from 1 to n occurs exactly once in this array. An inversion in a permutation p is a pair of indices (i,\xe2\x80\x89j) such that i\xe2\x80\x89>\xe2\x80\x89j and ai\xe2\x80\x89<\xe2\x80\x89aj. For example, a permutation [4,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892] contains 4 inversions: (2,\xe2\x80\x891), (3,\xe2\x80\x891), (4,\xe2\x80\x891), (4,\xe2\x80\x893).You are given a permutation a of size n and m queries to it. Each query is represented by two indices l and r denoting that you have to reverse the segment [l,\xe2\x80\x89r] of the permutation. For example, if a\xe2\x80\x89=\xe2\x80\x89[1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894] and a query l\xe2\x80\x89=\xe2\x80\x892, r\xe2\x80\x89=\xe2\x80\x894 is applied, then the resulting permutation is [1,\xe2\x80\x894,\xe2\x80\x893,\xe2\x80\x892].After each query you have to determine whether the number of inversions is odd or even." 1800
911C "Three Garlands" "brute force,constructive algorithms" "Mishka is decorating the Christmas tree. He has got three garlands, and all of them will be put on the tree. After that Mishka will switch these garlands on.When a garland is switched on, it periodically changes its state \xe2\x80\x94 sometimes it is lit, sometimes not. Formally, if i-th garland is switched on during x-th second, then it is lit only during seconds x, x\xe2\x80\x89+\xe2\x80\x89ki, x\xe2\x80\x89+\xe2\x80\x892ki, x\xe2\x80\x89+\xe2\x80\x893ki and so on.Mishka wants to switch on the garlands in such a way that during each second after switching the garlands on there would be at least one lit garland. Formally, Mishka wants to choose three integers x1, x2 and x3 (not necessarily distinct) so that he will switch on the first garland during x1-th second, the second one \xe2\x80\x94 during x2-th second, and the third one \xe2\x80\x94 during x3-th second, respectively, and during each second starting from max(x1,\xe2\x80\x89x2,\xe2\x80\x89x3) at least one garland will be lit.Help Mishka by telling him if it is possible to do this!" 1400
911B "Two Cakes" "binary search,brute force,implementation" "It\'s New Year\'s Eve soon, so Ivan decided it\'s high time he started setting the table. Ivan has bought two cakes and cut them into pieces: the first cake has been cut into a pieces, and the second one \xe2\x80\x94 into b pieces.Ivan knows that there will be n people at the celebration (including himself), so Ivan has set n plates for the cakes. Now he is thinking about how to distribute the cakes between the plates. Ivan wants to do it in such a way that all following conditions are met:  Each piece of each cake is put on some plate;  Each plate contains at least one piece of cake;  No plate contains pieces of both cakes. To make his guests happy, Ivan wants to distribute the cakes in such a way that the minimum number of pieces on the plate is maximized. Formally, Ivan wants to know the maximum possible number x such that he can distribute the cakes according to the aforementioned conditions, and each plate will contain at least x pieces of cake.Help Ivan to calculate this number x!" 1200
911A "Nearest Minimums" implementation "You are given an array of n integer numbers a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. Find the distance between two closest (nearest) minimums in it. It is guaranteed that in the array a minimum occurs at least two times." 1100
910C "Minimum Sum" "constructive algorithms,greedy,math" "Petya has n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. His friend Vasya decided to joke and replaced all digits in Petya\'s numbers with a letters. He used the lowercase letters of the Latin alphabet from \'a\' to \'j\' and replaced all digits 0 with one letter, all digits 1 with another letter and so on. For any two different digits Vasya used distinct letters from \'a\' to \'j\'.Your task is to restore Petya\'s numbers. The restored numbers should be positive integers without leading zeros. Since there can be multiple ways to do it, determine the minimum possible sum of all Petya\'s numbers after the restoration. It is guaranteed that before Vasya\'s joke all Petya\'s numbers did not have leading zeros." 1700
910B "Door Frames" greedy,implementation "Petya has equal wooden bars of length n. He wants to make a frame for two equal doors. Each frame has two vertical (left and right) sides of length a and one top side of length b. A solid (i.e. continuous without breaks) piece of bar is needed for each side.Determine a minimal number of wooden bars which are needed to make the frames for two doors. Petya can cut the wooden bars into any parts, but each side of each door should be a solid piece of a wooden bar (or a whole wooden bar)." 1600
910A "The Way to Home" "dfs and similar,dp,greedy,implementation" "A frog lives on the axis Ox and needs to reach home which is in the point n. She starts from the point 1. The frog can jump to the right at a distance not more than d. So, after she jumped from the point x she can reach the point x\xe2\x80\x89+\xe2\x80\x89a, where a is an integer from 1 to d.For each point from 1 to n is known if there is a lily flower in it. The frog can jump only in points with a lilies. Guaranteed that there are lilies in the points 1 and n.Determine the minimal number of jumps that the frog needs to reach home which is in the point n from the point 1. Consider that initially the frog is in the point 1. If the frog can not reach home, print -1." 800
909F AND-permutations "constructive algorithms" "Given an integer N, find two permutations:  Permutation p of numbers from 1 to N such that pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i and pi\xe2\x80\x89&\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x890 for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89N.  Permutation q of numbers from 1 to N such that qi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i and qi\xe2\x80\x89&\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890 for all i\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89N. & is the bitwise AND operation." 2500
909E Coprocessor "dfs and similar,dp,graphs,greedy" "You are given a program you want to execute as a set of tasks organized in a dependency graph. The dependency graph is a directed acyclic graph: each task can depend on results of one or several other tasks, and there are no directed circular dependencies between tasks. A task can only be executed if all tasks it depends on have already completed.Some of the tasks in the graph can only be executed on a coprocessor, and the rest can only be executed on the main processor. In one coprocessor call you can send it a set of tasks which can only be executed on it. For each task of the set, all tasks on which it depends must be either already completed or be included in the set. The main processor starts the program execution and gets the results of tasks executed on the coprocessor automatically.Find the minimal number of coprocessor calls which are necessary to execute the given program." 1900
909D "Colorful Points" "data structures,greedy,implementation" "You are given a set of points on a straight line. Each point has a color assigned to it. For point a, its neighbors are the points which don\'t have any other points between them and a. Each point has at most two neighbors - one from the left and one from the right.You perform a sequence of operations on this set of points. In one operation, you delete all points which have a neighbor point of a different color than the point itself. Points are deleted simultaneously, i.e. first you decide which points have to be deleted and then delete them. After that you can perform the next operation etc. If an operation would not delete any points, you can\'t perform it.How many operations will you need to perform until the next operation does not have any points to delete?" 2100
909C "Python Indentation" dp "In Python, code blocks don\'t have explicit begin/end or curly braces to mark beginning and end of the block. Instead, code blocks are defined by indentation.We will consider an extremely simplified subset of Python with only two types of statements.Simple statements are written in a single line, one per line. An example of a simple statement is assignment.For statements are compound statements: they contain one or several other statements. For statement consists of a header written in a separate line which starts with ""for"" prefix, and loop body. Loop body is a block of statements indented one level further than the header of the loop. Loop body can contain both types of statements. Loop body can\'t be empty.You are given a sequence of statements without indentation. Find the number of ways in which the statements can be indented to form a valid Python program." 1800
909B Segments "constructive algorithms,math" "You are given an integer N. Consider all possible segments on the coordinate axis with endpoints at integer points with coordinates between 0 and N, inclusive; there will be  of them.You want to draw these segments in several layers so that in each layer the segments don\'t overlap (they might touch at the endpoints though). You can not move the segments to a different location on the coordinate axis. Find the minimal number of layers you have to use for the given N." 1300
909A "Generate Login" "brute force,greedy,sortings" "The preferred way to generate user login in Polygon is to concatenate a prefix of the user\'s first name and a prefix of their last name, in that order. Each prefix must be non-empty, and any of the prefixes can be the full name. Typically there are multiple possible logins for each person.You are given the first and the last name of a user. Return the alphabetically earliest login they can get (regardless of other potential Polygon users).As a reminder, a prefix of a string s is its substring which occurs at the beginning of s: ""a"", ""ab"", ""abc"" etc. are prefixes of string ""{abcdef}"" but ""b"" and \'bc"" are not. A string a is alphabetically earlier than a string b, if a is a prefix of b, or a and b coincide up to some position, and then a has a letter that is alphabetically earlier than the corresponding letter in b: ""a"" and ""ab"" are alphabetically earlier than ""ac"" but ""b"" and ""ba"" are alphabetically later than ""ac""." 1000
908H "New Year and Boolean Bridges" NA "Your friend has a hidden directed graph with n nodes.Let f(u,\xe2\x80\x89v) be true if there is a directed path from node u to node v, and false otherwise. For each pair of distinct nodes, u,\xe2\x80\x89v, you know at least one of the three statements is true:        Here AND, OR and XOR mean AND, OR and exclusive OR operations, respectively.You are given an n by n matrix saying which one of the three statements holds for each pair of vertices. The entry in the u-th row and v-th column has a single character.   If the first statement holds, this is represented by the character \'A\'.  If the second holds, this is represented by the character \'O\'.  If the third holds, this is represented by the character \'X\'.  The diagonal of this matrix will only contain the character \'-\'. Note that it is possible that a pair of nodes may satisfy multiple statements, in which case, the character given will represent one of the true statements for that pair. This matrix is also guaranteed to be symmetric.You would like to know if there is a directed graph that is consistent with this matrix. If it is impossible, print the integer -1. Otherwise, print the minimum number of edges that could be consistent with this information." 3100
908G "New Year and Original Order" dp,math "Let S(n) denote the number that represents the digits of n in sorted order. For example, S(1)\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89S(5)\xe2\x80\x89=\xe2\x80\x895,\xe2\x80\x89S(50394)\xe2\x80\x89=\xe2\x80\x893459,\xe2\x80\x89S(353535)\xe2\x80\x89=\xe2\x80\x89333555.Given a number X, compute  modulo 109\xe2\x80\x89+\xe2\x80\x897." 2800
908F "New Year and Rainbow Roads" graphs,greedy,implementation "Roy and Biv have a set of n points on the infinite number line.Each point has one of 3 colors: red, green, or blue.Roy and Biv would like to connect all the points with some edges. Edges can be drawn between any of the two of the given points. The cost of an edge is equal to the distance between the two points it connects.They want to do this in such a way that they will both see that all the points are connected (either directly or indirectly).However, there is a catch: Roy cannot see the color red and Biv cannot see the color blue.Therefore, they have to choose the edges in such a way that if all the red points are removed, the remaining blue and green points are connected (and similarly, if all the blue points are removed, the remaining red and green points are connected).Help them compute the minimum cost way to choose edges to satisfy the above constraints." 2400
908E "New Year and Entity Enumeration" bitmasks,combinatorics,dp,math "You are given an integer m.Let M\xe2\x80\x89=\xe2\x80\x892m\xe2\x80\x89-\xe2\x80\x891.You are also given a set of n integers denoted as the set T. The integers will be provided in base 2 as n binary strings of length m.A set of integers S is called ""good"" if the following hold.   If , then .  If , then     All elements of S are less than or equal to M. Here,  and  refer to the bitwise XOR and bitwise AND operators, respectively.Count the number of good sets S, modulo 109\xe2\x80\x89+\xe2\x80\x897." 2500
908D "New Year and Arbitrary Arrangement" dp,math,probabilities "You are given three integers k, pa and pb.You will construct a sequence with the following algorithm: Initially, start with the empty sequence. Each second, you do the following. With probability pa\xe2\x80\x89/\xe2\x80\x89(pa\xe2\x80\x89+\xe2\x80\x89pb), add \'a\' to the end of the sequence. Otherwise (with probability pb\xe2\x80\x89/\xe2\x80\x89(pa\xe2\x80\x89+\xe2\x80\x89pb)), add \'b\' to the end of the sequence.You stop once there are at least k subsequences that form \'ab\'. Determine the expected number of times \'ab\' is a subsequence in the resulting sequence. It can be shown that this can be represented by P\xe2\x80\x89/\xe2\x80\x89Q, where P and Q are coprime integers, and . Print the value of ." 2200
908C "New Year and Curling" "brute force,geometry,implementation,math" "Carol is currently curling.She has n disks each with radius r on the 2D plane. Initially she has all these disks above the line y\xe2\x80\x89=\xe2\x80\x8910100.She then will slide the disks towards the line y\xe2\x80\x89=\xe2\x80\x890 one by one in order from 1 to n. When she slides the i-th disk, she will place its center at the point (xi,\xe2\x80\x8910100). She will then push it so the disk\xe2\x80\x99s y coordinate continuously decreases, and x coordinate stays constant. The disk stops once it touches the line y\xe2\x80\x89=\xe2\x80\x890 or it touches any previous disk. Note that once a disk stops moving, it will not move again, even if hit by another disk. Compute the y-coordinates of centers of all the disks after all disks have been pushed." 1500
908B "New Year and Buggy Bot" "brute force,implementation" "Bob programmed a robot to navigate through a 2d maze.The maze has some obstacles. Empty cells are denoted by the character \'.\', where obstacles are denoted by \'#\'.There is a single robot in the maze. Its start position is denoted with the character \'S\'. This position has no obstacle in it. There is also a single exit in the maze. Its position is denoted with the character \'E\'. This position has no obstacle in it.The robot can only move up, left, right, or down.When Bob programmed the robot, he wrote down a string of digits consisting of the digits 0 to 3, inclusive. He intended for each digit to correspond to a distinct direction, and the robot would follow the directions in order to reach the exit. Unfortunately, he forgot to actually assign the directions to digits.The robot will choose some random mapping of digits to distinct directions. The robot will map distinct digits to distinct directions. The robot will then follow the instructions according to the given string in order and chosen mapping. If an instruction would lead the robot to go off the edge of the maze or hit an obstacle, the robot will crash and break down. If the robot reaches the exit at any point, then the robot will stop following any further instructions.Bob is having trouble debugging his robot, so he would like to determine the number of mappings of digits to directions that would lead the robot to the exit." 1200
908A "New Year and Counting Cards" "brute force,implementation" "Your friend has n cards.You know that each card has a lowercase English letter on one side and a digit on the other.Currently, your friend has laid out the cards on a table so only one side of each card is visible.You would like to know if the following statement is true for cards that your friend owns: ""If a card has a vowel on one side, then it has an even digit on the other side."" More specifically, a vowel is one of \'a\', \'e\', \'i\', \'o\' or \'u\', and even digit is one of \'0\', \'2\', \'4\', \'6\' or \'8\'.For example, if a card has \'a\' on one side, and \'6\' on the other side, then this statement is true for it. Also, the statement is true, for example, for a card with \'b\' and \'4\', and for a card with \'b\' and \'3\' (since the letter is not a vowel). The statement is false, for example, for card with \'e\' and \'5\'. You are interested if the statement is true for all cards. In particular, if no card has a vowel, the statement is true.To determine this, you can flip over some cards to reveal the other side. You would like to know what is the minimum number of cards you need to flip in the worst case in order to verify that the statement is true." 800
907B Tic-Tac-Toe implementation "Two bears are playing tic-tac-toe via mail. It\'s boring for them to play usual tic-tac-toe game, so they are a playing modified version of this game. Here are its rules.The game is played on the following field.  Players are making moves by turns. At first move a player can put his chip in any cell of any small field. For following moves, there are some restrictions: if during last move the opposite player put his chip to cell with coordinates (xl,\xe2\x80\x89yl) in some small field, the next move should be done in one of the cells of the small field with coordinates (xl,\xe2\x80\x89yl). For example, if in the first move a player puts his chip to lower left cell of central field, then the second player on his next move should put his chip into some cell of lower left field (pay attention to the first test case). If there are no free cells in the required field, the player can put his chip to any empty cell on any field.You are given current state of the game and coordinates of cell in which the last move was done. You should find all cells in which the current player can put his chip.A hare works as a postman in the forest, he likes to foul bears. Sometimes he changes the game field a bit, so the current state of the game could be unreachable. However, after his changes the cell where the last move was done is not empty. You don\'t need to find if the state is unreachable or not, just output possible next moves according to the rules." 1400
907A "Masha and Bears" "brute force,implementation" "A family consisting of father bear, mother bear and son bear owns three cars. Father bear can climb into the largest car and he likes it. Also, mother bear can climb into the middle car and she likes it. Moreover, son bear can climb into the smallest car and he likes it. It\'s known that the largest car is strictly larger than the middle car, and the middle car is strictly larger than the smallest car. Masha came to test these cars. She could climb into all cars, but she liked only the smallest car. It\'s known that a character with size a can climb into some car with size b if and only if a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b, he or she likes it if and only if he can climb into this car and 2a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89b.You are given sizes of bears and Masha. Find out some possible integer non-negative sizes of cars." 1300
906E Reverses "dp,string suffix structures,strings" "Hurricane came to Berland and to suburbs Stringsvill. You are going to it to check if it\'s all right with you favorite string. Hurrinace broke it a bit by reversing some of its non-intersecting substrings. You have a photo of this string before hurricane and you want to restore it to original state using reversing minimum possible number of its substrings and find out which substrings you should reverse.You are given a string s \xe2\x80\x94 original state of your string and string t \xe2\x80\x94 state of the string after hurricane. You should select k non-intersecting substrings of t in such a way that after reverse of these substrings string will be equal s and k is minimum possible." 3300
906D "Power Tower" "chinese remainder theorem,math,number theory" "Priests of the Quetzalcoatl cult want to build a tower to represent a power of their god. Tower is usually made of power-charged rocks. It is built with the help of rare magic by levitating the current top of tower and adding rocks at its bottom. If top, which is built from k\xe2\x80\x89-\xe2\x80\x891 rocks, possesses power p and we want to add the rock charged with power wk then value of power of a new tower will be {wk}p. Rocks are added from the last to the first. That is for sequence w1,\xe2\x80\x89...,\xe2\x80\x89wm value of power will beAfter tower is built, its power may be extremely large. But still priests want to get some information about it, namely they want to know a number called cumulative power which is the true value of power taken modulo m. Priests have n rocks numbered from 1 to n. They ask you to calculate which value of cumulative power will the tower possess if they will build it from rocks numbered l,\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89r." 2700
906C Party "bitmasks,brute force,dp,graphs" "Arseny likes to organize parties and invite people to it. However, not only friends come to his parties, but friends of his friends, friends of friends of his friends and so on. That\'s why some of Arseny\'s guests can be unknown to him. He decided to fix this issue using the following procedure.At each step he selects one of his guests A, who pairwise introduces all of his friends to each other. After this action any two friends of A become friends. This process is run until all pairs of guests are friends.Arseny doesn\'t want to spend much time doing it, so he wants to finish this process using the minimum number of steps. Help Arseny to do it." 2400
906B "Seating of Students" "brute force,constructive algorithms,math" "Students went into a class to write a test and sat in some way. The teacher thought: ""Probably they sat in this order to copy works of each other. I need to rearrange them in such a way that students that were neighbors are not neighbors in a new seating.""The class can be represented as a matrix with n rows and m columns with a student in each cell. Two students are neighbors if cells in which they sit have a common side.Let\'s enumerate students from 1 to n\xc2\xb7m in order of rows. So a student who initially sits in the cell in row i and column j has a number (i\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7m\xe2\x80\x89+\xe2\x80\x89j. You have to find a matrix with n rows and m columns in which all numbers from 1 to n\xc2\xb7m appear exactly once and adjacent numbers in the original matrix are not adjacent in it, or determine that there is no such matrix." 2200
906A Shockers implementation,strings "Valentin participates in a show called ""Shockers"". The rules are quite easy: jury selects one letter which Valentin doesn\'t know. He should make a small speech, but every time he pronounces a word that contains the selected letter, he receives an electric shock. He can make guesses which letter is selected, but for each incorrect guess he receives an electric shock too. The show ends when Valentin guesses the selected letter correctly.Valentin can\'t keep in mind everything, so he could guess the selected letter much later than it can be uniquely determined and get excessive electric shocks. Excessive electric shocks are those which Valentin got after the moment the selected letter can be uniquely determined. You should find out the number of excessive electric shocks." 1600
903G "Yet Another Maxflow Problem" "data structures,flows,graphs" "In this problem you will have to deal with a very special network.The network consists of two parts: part A and part B. Each part consists of n vertices; i-th vertex of part A is denoted as Ai, and i-th vertex of part B is denoted as Bi.For each index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) there is a directed edge from vertex Ai to vertex Ai\xe2\x80\x89+\xe2\x80\x891, and from Bi to Bi\xe2\x80\x89+\xe2\x80\x891, respectively. Capacities of these edges are given in the input. Also there might be several directed edges going from part A to part B (but never from B to A).You have to calculate the maximum flow value from A1 to Bn in this network. Capacities of edges connecting Ai to Ai\xe2\x80\x89+\xe2\x80\x891 might sometimes change, and you also have to maintain the maximum flow value after these changes. Apart from that, the network is fixed (there are no changes in part B, no changes of edges going from A to B, and no edge insertions or deletions).Take a look at the example and the notes to understand the structure of the network better." 2700
903F "Clear The Matrix" bitmasks,dp "You are given a matrix f with 4 rows and n columns. Each element of the matrix is either an asterisk (*) or a dot (.).You may perform the following operation arbitrary number of times: choose a square submatrix of f with size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k (where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) and replace each element of the chosen submatrix with a dot. Choosing a submatrix of size k\xe2\x80\x89\xc3\x97\xe2\x80\x89k costs ak coins.What is the minimum number of coins you have to pay to replace all asterisks with dots?" 2200
903E "Swapping Characters" "brute force,hashing,implementation,strings" "We had a string s consisting of n lowercase Latin letters. We made k copies of this string, thus obtaining k identical strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk. After that, in each of these strings we swapped exactly two characters (the characters we swapped could be identical, but they had different indices in the string).You are given k strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk, and you have to restore any string s so that it is possible to obtain these strings by performing aforementioned operations. Note that the total length of the strings you are given doesn\'t exceed 5000 (that is, k\xc2\xb7n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x895000)." 2200
903D "Almost Difference" "data structures,math" "Let\'s denote a function You are given an array a consisting of n integers. You have to calculate the sum of d(ai,\xe2\x80\x89aj) over all pairs (i,\xe2\x80\x89j) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 2200
903C "Boxes Packing" greedy "Mishka has got n empty boxes. For every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), i-th box is a cube with side length ai.Mishka can put a box i into another box j if the following conditions are met:  i-th box is not put into another box;  j-th box doesn\'t contain any other boxes;  box i is smaller than box j (ai\xe2\x80\x89<\xe2\x80\x89aj). Mishka can put boxes into each other an arbitrary number of times. He wants to minimize the number of visible boxes. A box is called visible iff it is not put into some another box.Help Mishka to determine the minimum possible number of visible boxes!" 1200
903B "The Modcrab" greedy,implementation "Vova is again playing some computer game, now an RPG. In the game Vova\'s character received a quest: to slay the fearsome monster called Modcrab.After two hours of playing the game Vova has tracked the monster and analyzed its tactics. The Modcrab has h2 health points and an attack power of a2. Knowing that, Vova has decided to buy a lot of strong healing potions and to prepare for battle.Vova\'s character has h1 health points and an attack power of a1. Also he has a large supply of healing potions, each of which increases his current amount of health points by c1 when Vova drinks a potion. All potions are identical to each other. It is guaranteed that c1\xe2\x80\x89>\xe2\x80\x89a2.The battle consists of multiple phases. In the beginning of each phase, Vova can either attack the monster (thus reducing its health by a1) or drink a healing potion (it increases Vova\'s health by c1; Vova\'s health can exceed h1). Then, if the battle is not over yet, the Modcrab attacks Vova, reducing his health by a2. The battle ends when Vova\'s (or Modcrab\'s) health drops to 0 or lower. It is possible that the battle ends in a middle of a phase after Vova\'s attack.Of course, Vova wants to win the fight. But also he wants to do it as fast as possible. So he wants to make up a strategy that will allow him to win the fight after the minimum possible number of phases.Help Vova to make up a strategy! You may assume that Vova never runs out of healing potions, and that he can always win." 1200
903A "Hungry Student Problem" greedy,implementation "Ivan\'s classes at the university have just finished, and now he wants to go to the local CFK cafe and eat some fried chicken.CFK sells chicken chunks in small and large portions. A small portion contains 3 chunks; a large one \xe2\x80\x94 7 chunks. Ivan wants to eat exactly x chunks. Now he wonders whether he can buy exactly this amount of chicken.Formally, Ivan wants to know if he can choose two non-negative integers a and b in such a way that a small portions and b large ones contain exactly x chunks.Help Ivan to answer this question for several values of x!" 900
902B "Coloring a Tree" "dfs and similar,dsu,greedy" "You are given a rooted tree with n vertices. The vertices are numbered from 1 to n, the root is the vertex number 1.Each vertex has a color, let\'s denote the color of vertex v by cv. Initially cv\xe2\x80\x89=\xe2\x80\x890.You have to color the tree into the given colors using the smallest possible number of steps. On each step you can choose a vertex v and a color x, and then color all vectices in the subtree of v (including v itself) in color x. In other words, for every vertex u, such that the path from root to u passes through v, set cu\xe2\x80\x89=\xe2\x80\x89x.It is guaranteed that you have to color each vertex in a color different from 0.You can learn what a rooted tree is using the link: https://en.wikipedia.org/wiki/Tree_(graph_theory)." 1200
902A "Visiting a Friend" greedy,implementation "Pig is visiting a friend.Pig\'s house is located at point 0, and his friend\'s house is located at point m on an axis.Pig can use teleports to move along the axis.To use a teleport, Pig should come to a certain point (where the teleport is located) and choose where to move: for each teleport there is the rightmost point it can move Pig to, this point is known as the limit of the teleport.Formally, a teleport located at point x with limit y can move Pig from point x to any point within the segment [x;\xe2\x80\x89y], including the bounds.  Determine if Pig can visit the friend using teleports only, or he should use his car." 1100
901E "Cyclic Cipher" fft,math "Senor Vorpal Kickass\'o invented an innovative method to encrypt integer sequences of length n. To encrypt a sequence, one has to choose a secret sequence , that acts as a key.Vorpal is very selective, so the key should be such a sequence bi, that its cyclic shifts are linearly independent, that is, there is no non-zero set of coefficients x0,\xe2\x80\x89x1,\xe2\x80\x89...,\xe2\x80\x89xn\xe2\x80\x89-\xe2\x80\x891, such that  for all k at the same time.After that for a sequence  you should build the following cipher:In other words, you are to compute the quadratic deviation between each cyclic shift of bi and the sequence ai. The resulting sequence is the Kickass\'s cipher. The cipher is in development right now and Vorpal wants to decipher a sequence after it has been encrypted. You are to solve this problem for him. You are given sequences ci and bi. You are to find all suitable sequences ai." 3300
901D "Weighting a Tree" "constructive algorithms,dfs and similar,graphs" "You are given a connected undirected graph with n vertices and m edges. The vertices are enumerated from 1 to n. You are given n integers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn, each of them is between \xe2\x80\x89-\xe2\x80\x89n and n, inclusive. It is also guaranteed that the parity of cv equals the parity of degree of vertex v. The degree of a vertex is the number of edges connected to it.You are to write a weight between \xe2\x80\x89-\xe2\x80\x892\xc2\xb7n2 and 2\xc2\xb7n2 (inclusive) on each edge in such a way, that for each vertex v the sum of weights on edges connected to this vertex is equal to cv, or determine that this is impossible." 2700
901C "Bipartite Segments" "binary search,data structures,dfs and similar,dsu,graphs,two pointers" "You are given an undirected graph with n vertices. There are no edge-simple cycles with the even length in it. In other words, there are no cycles of even length that pass each edge at most once. Let\'s enumerate vertices from 1 to n. You have to answer q queries. Each query is described by a segment of vertices [l;\xe2\x80\x89r], and you have to count the number of its subsegments [x;\xe2\x80\x89y] (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), such that if we delete all vertices except the segment of vertices [x;\xe2\x80\x89y] (including x and y) and edges between them, the resulting graph is bipartite." 2300
901B "GCD of Polynomials" "constructive algorithms,math" "Suppose you have two polynomials  and . Then polynomial  can be uniquely represented in the following way:This can be done using long division. Here,  denotes the degree of polynomial P(x).  is called the remainder of division of polynomial  by polynomial , it is also denoted as . Since there is a way to divide polynomials with remainder, we can define Euclid\'s algorithm of finding the greatest common divisor of two polynomials. The algorithm takes two polynomials . If the polynomial  is zero, the result is , otherwise the result is the value the algorithm returns for pair . On each step the degree of the second argument decreases, so the algorithm works in finite number of steps. But how large that number could be? You are to answer this question. You are given an integer n. You have to build two polynomials with degrees not greater than n, such that their coefficients are integers not exceeding 1 by their absolute value, the leading coefficients (ones with the greatest power of x) are equal to one, and the described Euclid\'s algorithm performs exactly n steps finding their greatest common divisor. Moreover, the degree of the first polynomial should be greater than the degree of the second. By a step of the algorithm we mean the transition from pair  to pair ." 2200
901A "Hashing Trees" "constructive algorithms,trees" "Sasha is taking part in a programming competition. In one of the problems she should check if some rooted trees are isomorphic or not. She has never seen this problem before, but, being an experienced participant, she guessed that she should match trees to some sequences and then compare these sequences instead of trees. Sasha wants to match each tree with a sequence a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89ah, where h is the height of the tree, and ai equals to the number of vertices that are at distance of i edges from root. Unfortunately, this time Sasha\'s intuition was wrong, and there could be several trees matching the same sequence. To show it, you need to write a program that, given the sequence ai, builds two non-isomorphic rooted trees that match that sequence, or determines that there is only one such tree.Two rooted trees are isomorphic, if you can reenumerate the vertices of the first one in such a way, that the index of the root becomes equal the index of the root of the second tree, and these two trees become equal.The height of a rooted tree is the maximum number of edges on a path from the root to any other vertex." 1500
900E "Maximum Questions" "data structures,dp,strings" "Vasya wrote down two strings s of length n and t of length m consisting of small English letters \'a\' and \'b\'. What is more, he knows that string t has a form ""abab..."", namely there are letters \'a\' on odd positions and letters \'b\' on even positions.Suddenly in the morning, Vasya found that somebody spoiled his string. Some letters of the string s were replaced by character \'?\'.Let\'s call a sequence of positions i,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891 as occurrence of string t in s, if 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891 and t1\xe2\x80\x89=\xe2\x80\x89si,\xe2\x80\x89t2\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89tm\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891.The boy defines the beauty of the string s as maximum number of disjoint occurrences of string t in s. Vasya can replace some letters \'?\' with \'a\' or \'b\' (letters on different positions can be replaced with different letter). Vasya wants to make some replacements in such a way that beauty of string s is maximum possible. From all such options, he wants to choose one with the minimum number of replacements. Find the number of replacements he should make." 2100
900D "Unusual Sequences" "bitmasks,combinatorics,dp,math,number theory" "Count the number of distinct sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai) consisting of positive integers such that gcd(a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an)\xe2\x80\x89=\xe2\x80\x89x and . As this number could be large, print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.gcd here means the greatest common divisor." 2000
900C "Remove Extra One" "brute force,data structures,math" "You are given a permutation p of length n. Remove one element from permutation to make the number of records the maximum possible.We remind that in a sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak the element ai is a record if for every integer j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89i) the following holds: aj\xe2\x80\x89<\xe2\x80\x89ai." 1700
900B "Position in Fraction" "math,number theory" "You have a fraction . You need to find the first occurrence of digit c into decimal notation of the fraction after decimal point." 1300
900A "Find Extra One" geometry,implementation "You have n distinct points on a plane, none of them lie on OY axis. Check that there is a point after removal of which the remaining points are located on one side of the OY axis." 800
899F "Letters Removing" "data structures,strings" "Petya has a string of length n consisting of small and large English letters and digits.He performs m operations. Each operation is described with two integers l and r and a character c: Petya removes from the string all characters c on positions between l and r, inclusive. It\'s obvious that the length of the string remains the same or decreases after each operation.Find how the string will look like after Petya performs all m operations." 2100
899E "Segments Removal" "data structures,dsu,flows,implementation,two pointers" "Vasya has an array of integers of length n.Vasya performs the following operations on the array: on each step he finds the longest segment of consecutive equal integers (the leftmost, if there are several such segments) and removes it. For example, if Vasya\'s array is [13,\xe2\x80\x8913,\xe2\x80\x897,\xe2\x80\x897,\xe2\x80\x897,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892], then after one operation it becomes [13,\xe2\x80\x8913,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892].Compute the number of operations Vasya should make until the array becomes empty, i.e. Vasya removes all elements from it." 2000
899D "Shovel Sale" "constructive algorithms,math" "There are n shovels in Polycarp\'s shop. The i-th shovel costs i burles, that is, the first shovel costs 1 burle, the second shovel costs 2 burles, the third shovel costs 3 burles, and so on. Polycarps wants to sell shovels in pairs.Visitors are more likely to buy a pair of shovels if their total cost ends with several 9s. Because of this, Polycarp wants to choose a pair of shovels to sell in such a way that the sum of their costs ends with maximum possible number of nines. For example, if he chooses shovels with costs 12345 and 37454, their total cost is 49799, it ends with two nines.You are to compute the number of pairs of shovels such that their total cost ends with maximum possible number of nines. Two pairs are considered different if there is a shovel presented in one pair, but not in the other." 1800
899C "Dividing the numbers" "constructive algorithms,graphs,math" "Petya has n integers: 1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89n. He wants to split these integers in two non-empty groups in such a way that the absolute difference of sums of integers in each group is as small as possible. Help Petya to split the integers. Each of n integers should be exactly in one group." 1300
899B "Months and Years" implementation "Everybody in Russia uses Gregorian calendar. In this calendar there are 31 days in January, 28 or 29 days in February (depending on whether the year is leap or not), 31 days in March, 30 days in April, 31 days in May, 30 in June, 31 in July, 31 in August, 30 in September, 31 in October, 30 in November, 31 in December.A year is leap in one of two cases: either its number is divisible by 4, but not divisible by 100, or is divisible by 400. For example, the following years are leap: 2000, 2004, but years 1900 and 2018 are not leap.In this problem you are given n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8924) integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and you have to check if these integers could be durations in days of n consecutive months, according to Gregorian calendar. Note that these months could belong to several consecutive years. In other words, check if there is a month in some year, such that its duration is a1 days, duration of the next month is a2 days, and so on." 1200
899A "Splitting in Teams" "constructive algorithms,greedy,math" "There were n groups of students which came to write a training contest. A group is either one person who can write the contest with anyone else, or two people who want to write the contest in the same team.The coach decided to form teams of exactly three people for this training. Determine the maximum number of teams of three people he can form. It is possible that he can\'t use all groups to form teams. For groups of two, either both students should write the contest, or both should not. If two students from a group of two will write the contest, they should be in the same team." 800
898F "Restoring the Expression" "brute force,hashing,math" "A correct expression of the form a+b=c was written; a, b and c are non-negative integers without leading zeros. In this expression, the plus and equally signs were lost. The task is to restore the expression. In other words, one character \'+\' and one character \'=\' should be inserted into given sequence of digits so that:   character\'+\' is placed on the left of character \'=\',  characters \'+\' and \'=\' split the sequence into three non-empty subsequences consisting of digits (let\'s call the left part a, the middle part \xe2\x80\x94 b and the right part \xe2\x80\x94 c),  all the three parts a, b and c do not contain leading zeros,  it is true that a+b=c. It is guaranteed that in given tests answer always exists." 2300
898E "Squares and not squares" "constructive algorithms,greedy" "Ann and Borya have n piles with candies and n is even number. There are ai candies in pile with number i.Ann likes numbers which are square of some integer and Borya doesn\'t like numbers which are square of any integer. During one move guys can select some pile with candies and add one candy to it (this candy is new and doesn\'t belong to any other pile) or remove one candy (if there is at least one candy in this pile). Find out minimal number of moves that is required to make exactly n\xe2\x80\x89/\xe2\x80\x892 piles contain number of candies that is a square of some integer and exactly n\xe2\x80\x89/\xe2\x80\x892 piles contain number of candies that is not a square of any integer." 1600
898D "Alarm Clock" greedy "Every evening Vitalya sets n alarm clocks to wake up tomorrow. Every alarm clock rings during exactly one minute and is characterized by one integer ai \xe2\x80\x94 number of minute after midnight in which it rings. Every alarm clock begins ringing at the beginning of the minute and rings during whole minute. Vitalya will definitely wake up if during some m consecutive minutes at least k alarm clocks will begin ringing. Pay attention that Vitalya considers only alarm clocks which begin ringing during given period of time. He doesn\'t consider alarm clocks which started ringing before given period of time and continues ringing during given period of time.Vitalya is so tired that he wants to sleep all day long and not to wake up. Find out minimal number of alarm clocks Vitalya should turn off to sleep all next day. Now all alarm clocks are turned on." 1600
898C "Phone Numbers" implementation,strings "Vasya has several phone books, in which he recorded the telephone numbers of his friends. Each of his friends can have one or several phone numbers.Vasya decided to organize information about the phone numbers of friends. You will be given n strings \xe2\x80\x94 all entries from Vasya\'s phone books. Each entry starts with a friend\'s name. Then follows the number of phone numbers in the current entry, and then the phone numbers themselves. It is possible that several identical phones are recorded in the same record.Vasya also believes that if the phone number a is a suffix of the phone number b (that is, the number b ends up with a), and both numbers are written by Vasya as the phone numbers of the same person, then a is recorded without the city code and it should not be taken into account.The task is to print organized information about the phone numbers of Vasya\'s friends. It is possible that two different people have the same number. If one person has two numbers x and y, and x is a suffix of y (that is, y ends in x), then you shouldn\'t print number x. If the number of a friend in the Vasya\'s phone books is recorded several times in the same format, it is necessary to take it into account exactly once.Read the examples to understand statement and format of the output better." 1400
898B "Proper Nutrition" "brute force,implementation,number theory" "Vasya has n burles. One bottle of Ber-Cola costs a burles and one Bars bar costs b burles. He can buy any non-negative integer number of bottles of Ber-Cola and any non-negative integer number of Bars bars.Find out if it\'s possible to buy some amount of bottles of Ber-Cola and Bars bars and spend exactly n burles.In other words, you should find two non-negative integers x and y such that Vasya can buy x bottles of Ber-Cola and y Bars bars and x\xc2\xb7a\xe2\x80\x89+\xe2\x80\x89y\xc2\xb7b\xe2\x80\x89=\xe2\x80\x89n or tell that it\'s impossible." 1100
898A Rounding implementation,math "Vasya has a non-negative integer n. He wants to round it to nearest integer, which ends up with 0. If n already ends up with 0, Vasya considers it already rounded.For example, if n\xe2\x80\x89=\xe2\x80\x894722 answer is 4720. If n\xe2\x80\x89=\xe2\x80\x895 Vasya can round it to 0 or to 10. Both ways are correct.For given n find out to which integer will Vasya round it." 800
897B "Chtholly\'s request" "brute force" "\xe2\x80\x94 Thanks a lot for today.\xe2\x80\x94 I experienced so many great things.\xe2\x80\x94 You gave me memories like dreams... But I have to leave now...\xe2\x80\x94 One last request, can you...\xe2\x80\x94 Help me solve a Codeforces problem?\xe2\x80\x94 ......\xe2\x80\x94 What?Chtholly has been thinking about a problem for days:If a number is palindrome and length of its decimal representation without leading zeros is even, we call it a zcy number. A number is palindrome means when written in decimal representation, it contains no leading zeros and reads the same forwards and backwards. For example 12321 and 1221 are palindromes and 123 and 12451 are not. Moreover, 1221 is zcy number and 12321 is not.Given integers k and p, calculate the sum of the k smallest zcy numbers and output this sum modulo p.Unfortunately, Willem isn\'t good at solving this kind of problems, so he asks you for help!" 1300
897A "Scarborough Fair" implementation "Are you going to Scarborough Fair?Parsley, sage, rosemary and thyme.Remember me to one who lives there.He once was the true love of mine.Willem is taking the girl to the highest building in island No.28, however, neither of them knows how to get there.Willem asks his friend, Grick for directions, Grick helped them, and gave them a task.Although the girl wants to help, Willem insists on doing it by himself.Grick gave Willem a string of length n.Willem needs to do m operations, each operation has four parameters l,\xe2\x80\x89r,\xe2\x80\x89c1,\xe2\x80\x89c2, which means that all symbols c1 in range [l,\xe2\x80\x89r] (from l-th to r-th, including l and r) are changed into c2. String is 1-indexed.Grick wants to know the final string after all the m operations." 800
896E "Welcome home, Chtholly" "data structures,dsu" "\xe2\x80\x94 I... I survived.\xe2\x80\x94 Welcome home, Chtholly.\xe2\x80\x94 I kept my promise...\xe2\x80\x94 I made it... I really made it!After several days of fighting, Chtholly Nota Seniorious miraculously returned from the fierce battle.As promised, Willem is now baking butter cake for her.However, although Willem is skilled in making dessert, he rarely bakes butter cake.This time, Willem made a big mistake \xe2\x80\x94 he accidentally broke the oven!Fortunately, Chtholly decided to help him.Willem puts n cakes on a roll, cakes are numbered from 1 to n, the i-th cake needs ai seconds of baking.Willem needs Chtholly to do m operations to bake the cakes.Operation 1: 1 l r xWillem asks Chtholly to check each cake in the range [l,\xe2\x80\x89r], if the cake needs to be baked for more than x seconds, he would bake it for x seconds and put it back in its place. More precisely, for every i in range [l,\xe2\x80\x89r], if ai is strictly more than x, ai becomes equal ai\xe2\x80\x89-\xe2\x80\x89x.Operation 2: 2 l r xWillem asks Chtholly to count the number of cakes in the range [l,\xe2\x80\x89r] that needs to be cooked for exactly x seconds. More formally you should find number of such i in range [l,\xe2\x80\x89r], that ai\xe2\x80\x89=\xe2\x80\x89x." 3100
896D "Nephren Runs a Cinema" "chinese remainder theorem,combinatorics,math,number theory" "Lakhesh loves to make movies, so Nephren helps her run a cinema. We may call it No. 68 Cinema.However, one day, the No. 68 Cinema runs out of changes (they don\'t have 50-yuan notes currently), but Nephren still wants to start their business. (Assume that yuan is a kind of currency in Regulu Ere.)There are three types of customers: some of them bring exactly a 50-yuan note; some of them bring a 100-yuan note and Nephren needs to give a 50-yuan note back to him/her; some of them bring VIP cards so that they don\'t need to pay for the ticket.Now n customers are waiting outside in queue. Nephren wants to know how many possible queues are there that they are able to run smoothly (i.e. every customer can receive his/her change), and that the number of 50-yuan notes they have after selling tickets to all these customers is between l and r, inclusive. Two queues are considered different if there exists a customer whose type is different in two queues. As the number can be large, please output the answer modulo p." 2900
896C "Willem, Chtholly and Seniorious" "data structures,probabilities" "\xe2\x80\x94 Willem...\xe2\x80\x94 What\'s the matter?\xe2\x80\x94 It seems that there\'s something wrong with Seniorious...\xe2\x80\x94 I\'ll have a look...Seniorious is made by linking special talismans in particular order.After over 500 years, the carillon is now in bad condition, so Willem decides to examine it thoroughly.Seniorious has n pieces of talisman. Willem puts them in a line, the i-th of which is an integer ai.In order to maintain it, Willem needs to perform m operations.There are four types of operations: 1 l r x: For each i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, assign ai\xe2\x80\x89+\xe2\x80\x89x to ai. 2 l r x: For each i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, assign x to ai. 3 l r x: Print the x-th smallest number in the index range [l,\xe2\x80\x89r], i.e. the element at the x-th position if all the elements ai such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r are taken and sorted into an array of non-decreasing integers. It\'s guaranteed that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891. 4 l r x y: Print the sum of the x-th power of ai such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, modulo y, i.e. ." 2600
896B "Ithea Plays With Chtholly" "binary search,constructive algorithms,games,greedy,interactive" "This is an interactive problem. Refer to the Interaction section below for better understanding.Ithea and Chtholly want to play a game in order to determine who can use the kitchen tonight.Initially, Ithea puts n clear sheets of paper in a line. They are numbered from 1 to n from left to right.This game will go on for m rounds. In each round, Ithea will give Chtholly an integer between 1 and c, and Chtholly needs to choose one of the sheets to write down this number (if there is already a number before, she will erase the original one and replace it with the new one).Chtholly wins if, at any time, all the sheets are filled with a number and the n numbers are in non-decreasing order looking from left to right from sheet 1 to sheet n, and if after m rounds she still doesn\'t win, she loses the game.Chtholly really wants to win the game as she wants to cook something for Willem. But she doesn\'t know how to win the game. So Chtholly finds you, and your task is to write a program to receive numbers that Ithea gives Chtholly and help her make the decision on which sheet of paper write this number." 2000
896A "Nephren gives a riddle" "binary search,dfs and similar" "What are you doing at the end of the world? Are you busy? Will you save us?Nephren is playing a game with little leprechauns.She gives them an infinite array of strings, f0... \xe2\x88\x9e.f0 is ""What are you doing at the end of the world? Are you busy? Will you save us?"".She wants to let more people know about it, so she defines fi\xe2\x80\x89=\xe2\x80\x89 ""What are you doing while sending ""fi\xe2\x80\x89-\xe2\x80\x891""? Are you busy? Will you send ""fi\xe2\x80\x89-\xe2\x80\x891""?"" for all i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891.For example, f1 is""What are you doing while sending ""What are you doing at the end of the world? Are you busy? Will you save us?""? Are you busy? Will you send ""What are you doing at the end of the world? Are you busy? Will you save us?""?"". Note that the quotes in the very beginning and in the very end are for clarity and are not a part of f1.It can be seen that the characters in fi are letters, question marks, (possibly) quotation marks and spaces.Nephren will ask the little leprechauns q times. Each time she will let them find the k-th character of fn. The characters are indexed starting from 1. If fn consists of less than k characters, output \'.\' (without quotes).Can you answer her queries?" 1700
895E "Eyes Closed" "data structures,probabilities" "Vasya and Petya were tired of studying so they decided to play a game. Before the game begins Vasya looks at array a consisting of n integers. As soon as he remembers all elements of a the game begins. Vasya closes his eyes and Petya does q actions of one of two types:1) Petya says 4 integers l1,\xe2\x80\x89r1,\xe2\x80\x89l2,\xe2\x80\x89r2 \xe2\x80\x94 boundaries of two non-intersecting segments. After that he swaps one random element from the [l1,\xe2\x80\x89r1] segment with another random element from the [l2,\xe2\x80\x89r2] segment.2) Petya asks Vasya the sum of the elements of a in the [l,\xe2\x80\x89r] segment.Vasya is a mathematician so he answers Petya the mathematical expectation of the sum of the elements in the segment.Your task is to write a program which will answer the second type questions as Vasya would do it. In other words your program should print the mathematical expectation of the sum of the elements of a in the [l,\xe2\x80\x89r] segment for every second type query." 2300
895D "String Mark" combinatorics,math,strings "At the Byteland State University marks are strings of the same length. Mark x is considered better than y if string y is lexicographically smaller than x.Recently at the BSU was an important test work on which Vasya recived the mark a. It is very hard for the teacher to remember the exact mark of every student, but he knows the mark b, such that every student recieved mark strictly smaller than b.Vasya isn\'t satisfied with his mark so he decided to improve it. He can swap characters in the string corresponding to his mark as many times as he like. Now he want to know only the number of different ways to improve his mark so that his teacher didn\'t notice something suspicious.More formally: you are given two strings a, b of the same length and you need to figure out the number of different strings c such that:1) c can be obtained from a by swapping some characters, in other words c is a permutation of a.2) String a is lexicographically smaller than c.3) String c is lexicographically smaller than b.For two strings x and y of the same length it is true that x is lexicographically smaller than y if there exists such i, that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89x2\xe2\x80\x89=\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89xi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89yi\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89xi\xe2\x80\x89<\xe2\x80\x89yi.Since the answer can be very large, you need to find answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2100
895C "Square Subsets" bitmasks,combinatorics,dp,math "Petya was late for the lesson too. The teacher gave him an additional task. For some array a Petya should find the number of different ways to select non-empty subset of elements from it in such a way that their product is equal to a square of some integer.Two ways are considered different if sets of indexes of elements chosen by these ways are different.Since the answer can be very large, you should find the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000
895B "XK Segments" "binary search,math,sortings,two pointers" "While Vasya finished eating his piece of pizza, the lesson has already started. For being late for the lesson, the teacher suggested Vasya to solve one interesting problem. Vasya has an array a and integer x. He should find the number of different ordered pairs of indexes (i,\xe2\x80\x89j) such that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj and there are exactly k integers y such that ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj and y is divisible by x.In this problem it is meant that pair (i,\xe2\x80\x89j) is equal to (j,\xe2\x80\x89i) only if i is equal to j. For example pair (1,\xe2\x80\x892) is not the same as (2,\xe2\x80\x891)." 1700
895A "Pizza Separation" "brute force,implementation" "Students Vasya and Petya are studying at the BSU (Byteland State University). At one of the breaks they decided to order a pizza. In this problem pizza is a circle of some radius. The pizza was delivered already cut into n pieces. The i-th piece is a sector of angle equal to ai. Vasya and Petya want to divide all pieces of pizza into two continuous sectors in such way that the difference between angles of these sectors is minimal. Sector angle is sum of angles of all pieces in it. Pay attention, that one of sectors can be empty." 1200
894E "Ralph and Mushrooms" dp,graphs "Ralph is going to collect mushrooms in the Mushroom Forest. There are m directed paths connecting n trees in the Mushroom Forest. On each path grow some mushrooms. When Ralph passes a path, he collects all the mushrooms on the path. The Mushroom Forest has a magical fertile ground where mushrooms grow at a fantastic speed. New mushrooms regrow as soon as Ralph finishes mushroom collection on a path. More specifically, after Ralph passes a path the i-th time, there regrow i mushrooms less than there was before this pass. That is, if there is initially x mushrooms on a path, then Ralph will collect x mushrooms for the first time, x\xe2\x80\x89-\xe2\x80\x891 mushrooms the second time, x\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x892 mushrooms the third time, and so on. However, the number of mushrooms can never be less than 0.For example, let there be 9 mushrooms on a path initially. The number of mushrooms that can be collected from the path is 9, 8, 6 and 3 when Ralph passes by from first to fourth time. From the fifth time and later Ralph can\'t collect any mushrooms from the path (but still can pass it).Ralph decided to start from the tree s. How many mushrooms can he collect using only described paths?" 2100
894D "Ralph And His Tour in Binary Country" "brute force,data structures,trees" "Ralph is in the Binary Country. The Binary Country consists of n cities and (n\xe2\x80\x89-\xe2\x80\x891) bidirectional roads connecting the cities. The roads are numbered from 1 to (n\xe2\x80\x89-\xe2\x80\x891), the i-th road connects the city labeled  (here \xe2\x8c\x8a x\xe2\x8c\x8b denotes the x rounded down to the nearest integer) and the city labeled (i\xe2\x80\x89+\xe2\x80\x891), and the length of the i-th road is Li.Now Ralph gives you m queries. In each query he tells you some city Ai and an integer Hi. He wants to make some tours starting from this city. He can choose any city in the Binary Country (including Ai) as the terminal city for a tour. He gains happiness (Hi\xe2\x80\x89-\xe2\x80\x89L) during a tour, where L is the distance between the city Ai and the terminal city.Ralph is interested in tours from Ai in which he can gain positive happiness. For each query, compute the sum of happiness gains for all such tours.Ralph will never take the same tour twice or more (in one query), he will never pass the same city twice or more in one tour." 2200
894C "Marco and GCD Sequence" "constructive algorithms,math" "In a dream Marco met an elderly man with a pair of black glasses. The man told him the key to immortality and then disappeared with the wind of time.When he woke up, he only remembered that the key was a sequence of positive integers of some length n, but forgot the exact sequence. Let the elements of the sequence be a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He remembered that he calculated gcd(ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89aj) for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and put it into a set S. gcd here means the greatest common divisor.Note that even if a number is put into the set S twice or more, it only appears once in the set.Now Marco gives you the set S and asks you to help him figure out the initial sequence. If there are many solutions, print any of them. It is also possible that there are no sequences that produce the set S, in this case print -1." 1900
894B "Ralph And His Magic Field" "combinatorics,constructive algorithms,math,number theory" "Ralph has a magic field which is divided into n\xe2\x80\x89\xc3\x97\xe2\x80\x89m blocks. That is to say, there are n rows and m columns on the field. Ralph can put an integer in each block. However, the magic field doesn\'t always work properly. It works only if the product of integers in each row and each column equals to k, where k is either 1 or -1.Now Ralph wants you to figure out the number of ways to put numbers in each block in such a way that the magic field works properly. Two ways are considered different if and only if there exists at least one block where the numbers in the first way and in the second way are different. You are asked to output the answer modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897.Note that there is no range of the numbers to put in the blocks, but we can prove that the answer is not infinity." 1800
894A QAQ "brute force,dp" """QAQ"" is a word to denote an expression of crying. Imagine ""Q"" as eyes with tears and ""A"" as a mouth.Now Diamond has given Bort a string consisting of only uppercase English letters of length n. There is a great number of ""QAQ"" in the string (Diamond is so cute!).  illustration by \xe7\x8c\xab\xe5\xb1\x8b https://twitter.com/nekoyaliu Bort wants to know how many subsequences ""QAQ"" are in the string Diamond has given. Note that the letters ""QAQ"" don\'t have to be consecutive, but the order of letters should be exact." 800
893F "Subtree Minimum Query" "data structures,trees" "You are given a rooted tree consisting of n vertices. Each vertex has a number written on it; number ai is written on vertex i.Let\'s denote d(i,\xe2\x80\x89j) as the distance between vertices i and j in the tree (that is, the number of edges in the shortest path from i to j). Also let\'s denote the k-blocked subtree of vertex x as the set of vertices y such that both these conditions are met:  x is an ancestor of y (every vertex is an ancestor of itself);  d(x,\xe2\x80\x89y)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k. You are given m queries to the tree. i-th query is represented by two numbers xi and ki, and the answer to this query is the minimum value of aj among such vertices j such that j belongs to ki-blocked subtree of xi.Write a program that would process these queries quickly!Note that the queries are given in a modified way." 2300
893E "Counting Arrays" "combinatorics,dp,math,number theory" "You are given two positive integer numbers x and y. An array F is called an y-factorization of x iff the following conditions are met:  There are y elements in F, and all of them are integer numbers;  . You have to count the number of pairwise distinct arrays that are y-factorizations of x. Two arrays A and B are considered different iff there exists at least one index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y) such that Ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89Bi. Since the answer can be very large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2000
893D "Credit Card" "data structures,dp,greedy,implementation" "Recenlty Luba got a credit card and started to use it. Let\'s consider n consecutive days Luba uses the card.She starts with 0 money on her account.In the evening of i-th day a transaction ai occurs. If ai\xe2\x80\x89>\xe2\x80\x890, then ai bourles are deposited to Luba\'s account. If ai\xe2\x80\x89<\xe2\x80\x890, then ai bourles are withdrawn. And if ai\xe2\x80\x89=\xe2\x80\x890, then the amount of money on Luba\'s account is checked.In the morning of any of n days Luba can go to the bank and deposit any positive integer amount of burles to her account. But there is a limitation: the amount of money on the account can never exceed d.It can happen that the amount of money goes greater than d by some transaction in the evening. In this case answer will be \xc2\xab-1\xc2\xbb.Luba must not exceed this limit, and also she wants that every day her account is checked (the days when ai\xe2\x80\x89=\xe2\x80\x890) the amount of money on her account is non-negative. It takes a lot of time to go to the bank, so Luba wants to know the minimum number of days she needs to deposit some money to her account (if it is possible to meet all the requirements). Help her!" 1900
893C Rumor "dfs and similar,graphs,greedy" "Vova promised himself that he would never play computer games... But recently Firestorm \xe2\x80\x94 a well-known game developing company \xe2\x80\x94 published their newest game, World of Farcraft, and it became really popular. Of course, Vova started playing it.Now he tries to solve a quest. The task is to come to a settlement named Overcity and spread a rumor in it.Vova knows that there are n characters in Overcity. Some characters are friends to each other, and they share information they got. Also Vova knows that he can bribe each character so he or she starts spreading the rumor; i-th character wants ci gold in exchange for spreading the rumor. When a character hears the rumor, he tells it to all his friends, and they start spreading the rumor to their friends (for free), and so on.The quest is finished when all n characters know the rumor. What is the minimum amount of gold Vova needs to spend in order to finish the quest?Take a look at the notes if you think you haven\'t understood the problem completely." 1300
893B "Beautiful Divisors" "brute force,implementation" "Recently Luba learned about a special kind of numbers that she calls beautiful numbers. The number is called beautiful iff its binary representation consists of k\xe2\x80\x89+\xe2\x80\x891 consecutive ones, and then k consecutive zeroes.Some examples of beautiful numbers:   12 (110);  1102 (610);  11110002 (12010);  1111100002 (49610). More formally, the number is beautiful iff there exists some positive integer k such that the number is equal to (2k\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89*\xe2\x80\x89(2k\xe2\x80\x89-\xe2\x80\x891).Luba has got an integer number n, and she wants to find its greatest beautiful divisor. Help her to find it!" 1000
893A "Chess For Three" implementation "Alex, Bob and Carl will soon participate in a team chess tournament. Since they are all in the same team, they have decided to practise really hard before the tournament. But it\'s a bit difficult for them because chess is a game for two players, not three.So they play with each other according to following rules:  Alex and Bob play the first game, and Carl is spectating;  When the game ends, the one who lost the game becomes the spectator in the next game, and the one who was spectating plays against the winner. Alex, Bob and Carl play in such a way that there are no draws.Today they have played n games, and for each of these games they remember who was the winner. They decided to make up a log of games describing who won each game. But now they doubt if the information in the log is correct, and they want to know if the situation described in the log they made up was possible (that is, no game is won by someone who is spectating if Alex, Bob and Carl play according to the rules). Help them to check it!" 900
892B Wrath "greedy,implementation,two pointers" "Hands that shed innocent blood!There are n guilty people in a line, the i-th of them holds a claw with length Li. The bell rings and every person kills some of people in front of him. All people kill others at the same time. Namely, the i-th person kills the j-th person if and only if j\xe2\x80\x89<\xe2\x80\x89i and j\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89i\xe2\x80\x89-\xe2\x80\x89Li.You are given lengths of the claws. You need to find the total number of alive people after the bell rings." 1200
892A Greed greedy,implementation "Jafar has n cans of cola. Each can is described by two integers: remaining volume of cola ai and can\'s capacity bi (ai \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89 bi).Jafar has decided to pour all remaining cola into just 2 cans, determine if he can do this or not!" 900
891E Lust combinatorics,math,matrices "A false witness that speaketh lies!You are given a sequence containing n integers. There is a variable res that is equal to 0 initially. The following process repeats k times.Choose an index from 1 to n uniformly at random. Name it x. Add to res the multiply of all ai\'s such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, but i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x. Then, subtract ax by 1.You have to find expected value of res at the end of the process. It can be proved that the expected value of res can be represented as an irreducible fraction . You have to find ." 3000
891D Sloth "dfs and similar,dp,graph matchings,trees" "Sloth is bad, mkay? So we decided to prepare a problem to punish lazy guys.You are given a tree, you should count the number of ways to remove an edge from it and then add an edge to it such that the final graph is a tree and has a perfect matching. Two ways of this operation are considered different if their removed edges or their added edges aren\'t the same. The removed edge and the added edge can be equal.A perfect matching is a subset of edges such that each vertex is an endpoint of exactly one of these edges." 3100
891C Envy "data structures,dsu,graphs" "For a connected undirected weighted graph G, MST (minimum spanning tree) is a subgraph of G that contains all of G\'s vertices, is a tree, and sum of its edges is minimum possible.You are given a graph G. If you run a MST algorithm on graph it would give you only one MST and it causes other edges to become jealous. You are given some queries, each query contains a set of edges of graph G, and you should determine whether there is a MST containing all these edges or not." 2300
891B Gluttony "constructive algorithms,greedy" "You are given an array a with n distinct integers. Construct an array b by permuting a such that for every non-empty subset of indices S\xe2\x80\x89=\xe2\x80\x89{x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk} (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 0\xe2\x80\x89<\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n) the sums of elements on that positions in a and b are different, i. e." 2000
891A Pride "brute force,dp,greedy,math,number theory" "You have an array a with length n, you can perform operations. Each operation is like this: choose two adjacent elements from a, say x and y, and replace one of them with gcd(x,\xe2\x80\x89y), where gcd denotes the greatest common divisor.What is the minimum number of operations you need to make all of the elements equal to 1?" 1500
889E "Mod Mod Mod" "binary search,dp,math" "You are given a sequence of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Let , and  for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n. Here,  denotes the modulus operation. Find the maximum value of f(x,\xe2\x80\x891) over all nonnegative integers x." 3000
888G Xor-MST "bitmasks,constructive algorithms,data structures" "You are given a complete undirected graph with n vertices. A number ai is assigned to each vertex, and the weight of an edge between vertices i and j is equal to ai\xe2\x80\x89xor\xe2\x80\x89aj.Calculate the weight of the minimum spanning tree in this graph." 2300
888F "Connecting Vertices" dp,graphs "There are n points marked on the plane. The points are situated in such a way that they form a regular polygon (marked points are its vertices, and they are numbered in counter-clockwise order). You can draw n\xe2\x80\x89-\xe2\x80\x891 segments, each connecting any two marked points, in such a way that all points have to be connected with each other (directly or indirectly).But there are some restrictions. Firstly, some pairs of points cannot be connected directly and have to be connected undirectly. Secondly, the segments you draw must not intersect in any point apart from the marked points (that is, if any two segments intersect and their intersection is not a marked point, then the picture you have drawn is invalid).How many ways are there to connect all vertices with n\xe2\x80\x89-\xe2\x80\x891 segments? Two ways are considered different iff there exist some pair of points such that a segment is drawn between them in the first way of connection, but it is not drawn between these points in the second one. Since the answer might be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2500
888E "Maximum Subsequence" "bitmasks,divide and conquer,meet-in-the-middle" "You are given an array a consisting of n integers, and additionally an integer m. You have to choose some sequence of indices b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bk (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b1\xe2\x80\x89<\xe2\x80\x89b2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89bk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) in such a way that the value of  is maximized. Chosen sequence can be empty.Print the maximum possible value of ." 1800
888D "Almost Identity Permutations" combinatorics,dp,math "A permutation p of size n is an array such that every integer from 1 to n occurs exactly once in this array.Let\'s call a permutation an almost identity permutation iff there exist at least n\xe2\x80\x89-\xe2\x80\x89k indices i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that pi\xe2\x80\x89=\xe2\x80\x89i.Your task is to count the number of almost identity permutations for given numbers n and k." 1600
888C "K-Dominant Character" "binary search,implementation,two pointers" "You are given a string s consisting of lowercase Latin letters. Character c is called k-dominant iff each substring of s with length at least k contains this character c.You have to find minimum k such that there exists at least one k-dominant character." 1400
888B "Buggy Robot" greedy "Ivan has a robot which is situated on an infinite grid. Initially the robot is standing in the starting cell (0,\xe2\x80\x890). The robot can process commands. There are four types of commands it can perform:  U \xe2\x80\x94 move from the cell (x,\xe2\x80\x89y) to (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891);  D \xe2\x80\x94 move from (x,\xe2\x80\x89y) to (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891);  L \xe2\x80\x94 move from (x,\xe2\x80\x89y) to (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y);  R \xe2\x80\x94 move from (x,\xe2\x80\x89y) to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y). Ivan entered a sequence of n commands, and the robot processed it. After this sequence the robot ended up in the starting cell (0,\xe2\x80\x890), but Ivan doubts that the sequence is such that after performing it correctly the robot ends up in the same cell. He thinks that some commands were ignored by robot. To acknowledge whether the robot is severely bugged, he needs to calculate the maximum possible number of commands that were performed correctly. Help Ivan to do the calculations!" 1000
888A "Local Extrema" "brute force,implementation" "You are given an array a. Some element of this array ai is a local minimum iff it is strictly less than both of its neighbours (that is, ai\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891 and ai\xe2\x80\x89<\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891). Also the element can be called local maximum iff it is strictly greater than its neighbours (that is, ai\xe2\x80\x89>\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891 and ai\xe2\x80\x89>\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891). Since a1 and an have only one neighbour each, they are neither local minima nor local maxima.An element is called a local extremum iff it is either local maximum or local minimum. Your task is to calculate the number of local extrema in the given array." 800
887F "Row of Models" greedy,sortings "During the final part of fashion show all models come to the stage and stay in one row and fashion designer stays to right to model on the right. During the rehearsal, Izabella noticed, that row isn\'t nice, but she can\'t figure out how to fix it. Like many other creative people, Izabella has a specific sense of beauty. Evaluating beauty of row of models Izabella looks at heights of models. She thinks that row is nice if for each model distance to nearest model with less height (model or fashion designer) to the right of her doesn\'t exceed k (distance between adjacent people equals 1, the distance between people with exactly one man between them equals 2, etc). She wants to make row nice, but fashion designer has his own sense of beauty, so she can at most one time select two models from the row and swap their positions if the left model from this pair is higher than the right model from this pair.Fashion designer (man to the right of rightmost model) has less height than all models and can\'t be selected for exchange.You should tell if it\'s possible to make at most one exchange in such a way that row becomes nice for Izabella." 2500
887E "Little Brother" "binary search,geometry,sortings" "Masha\'s little brother draw two points on a sheet of paper. After that, he draws some circles and gave the sheet to his sister. Masha has just returned from geometry lesson so she instantly noticed some interesting facts about brother\'s drawing.At first, the line going through two points, that brother drew, doesn\'t intersect or touch any circle.Also, no two circles intersect or touch, and there is no pair of circles such that one circle is located inside another.Moreover, for each circle, Masha drew a square of the minimal area with sides parallel axis such that this circle is located inside the square and noticed that there is no two squares intersect or touch and there is no pair of squares such that one square is located inside other.Now Masha wants to draw circle of minimal possible radius such that it goes through two points that brother drew and doesn\'t intersect any other circle, but other circles can touch Masha\'s circle and can be located inside it.It\'s guaranteed, that answer won\'t exceed 1012. It should be held for hacks as well." 2800
887D "Ratings and Reality Shows" "data structures,two pointers" "There are two main kinds of events in the life of top-model: fashion shows and photo shoots. Participating in any of these events affects the rating of appropriate top-model. After each photo shoot model\'s rating increases by a and after each fashion show decreases by b (designers do too many experiments nowadays). Moreover, sometimes top-models participates in talk shows. After participating in talk show model becomes more popular and increasing of her rating after photo shoots become c and decreasing of her rating after fashion show becomes d.Izabella wants to participate in a talk show, but she wants to do it in such a way that her rating will never become negative. Help her to find a suitable moment for participating in the talk show. Let\'s assume that model\'s career begins in moment 0. At that moment Izabella\'s rating was equal to start. If talk show happens in moment t if will affect all events in model\'s life in interval of time [t..t\xe2\x80\x89+\xe2\x80\x89len) (including t and not including t\xe2\x80\x89+\xe2\x80\x89len), where len is duration of influence.Izabella wants to participate in a talk show, but she wants to do it in such a way that her rating will not become become negative before talk show or during period of influence of talk show. Help her to find a suitable moment for participating in the talk show." 2400
887C "Solution for Cube" "brute force,implementation" "During the breaks between competitions, top-model Izabella tries to develop herself and not to be bored. For example, now she tries to solve Rubik\'s cube 2x2x2.It\'s too hard to learn to solve Rubik\'s cube instantly, so she learns to understand if it\'s possible to solve the cube in some state using 90-degrees rotation of one face of the cube in any direction.To check her answers she wants to use a program which will for some state of cube tell if it\'s possible to solve it using one rotation, described above.Cube is called solved if for each face of cube all squares on it has the same color.https://en.wikipedia.org/wiki/Rubik\'s_Cube" 1500
887B "Cubes for Masha" "brute force,implementation" "Absent-minded Masha got set of n cubes for her birthday.At each of 6 faces of each cube, there is exactly one digit from 0 to 9. Masha became interested what is the largest natural x such she can make using her new cubes all integers from 1 to x.To make a number Masha can rotate her cubes and put them in a row. After that, she looks at upper faces of cubes from left to right and reads the number.The number can\'t contain leading zeros. It\'s not required to use all cubes to build a number.Pay attention: Masha can\'t make digit 6 from digit 9 and vice-versa using cube rotations." 1300
887A "Div. 64" implementation "Top-model Izabella participates in the competition. She wants to impress judges and show her mathematical skills.Her problem is following: for given string, consisting of only 0 and 1, tell if it\'s possible to remove some digits in such a way, that remaining number is a representation of some positive integer, divisible by 64, in the binary numerical system." 1000
886F "Symmetric Projections" geometry "You are given a set of n points on the plane. A line containing the origin is called good, if projection of the given set to this line forms a symmetric multiset of points. Find the total number of good lines.Multiset is a set where equal elements are allowed.Multiset is called symmetric, if there is a point P on the plane such that the multiset is centrally symmetric in respect of point P." 2900
886E "Maximum Element" combinatorics,dp,math "One day Petya was solving a very interesting problem. But although he used many optimization techniques, his solution still got Time limit exceeded verdict. Petya conducted a thorough analysis of his program and found out that his function for finding maximum element in an array of n positive integers was too slow. Desperate, Petya decided to use a somewhat unexpected optimization using parameter k, so now his function contains the following code:int fast_max(int n, int a[]) {     int ans = 0;    int offset = 0;    for (int i = 0; i < n; ++i)        if (ans < a[i]) {            ans = a[i];            offset = 0;        } else {            offset = offset + 1;            if (offset == k)                return ans;        }    return ans;}That way the function iteratively checks array elements, storing the intermediate maximum, and if after k consecutive iterations that maximum has not changed, it is returned as the answer.Now Petya is interested in fault rate of his function. He asked you to find the number of permutations of integers from 1 to n such that the return value of his function on those permutations is not equal to n. Since this number could be very big, output the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2400
886D "Restoration of string" "constructive algorithms,graphs,implementation" "A substring of some string is called the most frequent, if the number of its occurrences is not less than number of occurrences of any other substring.You are given a set of strings. A string (not necessarily from this set) is called good if all elements of the set are the most frequent substrings of this string. Restore the non-empty good string with minimum length. If several such strings exist, restore lexicographically minimum string. If there are no good strings, print ""NO"" (without quotes).A substring of a string is a contiguous subsequence of letters in the string. For example, ""ab"", ""c"", ""abc"" are substrings of string ""abc"", while ""ac"" is not a substring of that string.The number of occurrences of a substring in a string is the number of starting positions in the string where the substring occurs. These occurrences could overlap.String a is lexicographically smaller than string b, if a is a prefix of b, or a has a smaller letter at the first position where a and b differ." 2000
886C "Petya and Catacombs" dsu,greedy,implementation,trees "A very brave explorer Petya once decided to explore Paris catacombs. Since Petya is not really experienced, his exploration is just walking through the catacombs.Catacombs consist of several rooms and bidirectional passages between some pairs of them. Some passages can connect a room to itself and since the passages are built on different depths they do not intersect each other. Every minute Petya arbitrary chooses a passage from the room he is currently in and then reaches the room on the other end of the passage in exactly one minute. When he enters a room at minute i, he makes a note in his logbook with number ti:   If Petya has visited this room before, he writes down the minute he was in this room last time;  Otherwise, Petya writes down an arbitrary non-negative integer strictly less than current minute i. Initially, Petya was in one of the rooms at minute 0, he didn\'t write down number t0.At some point during his wandering Petya got tired, threw out his logbook and went home. Vasya found his logbook and now he is curious: what is the minimum possible number of rooms in Paris catacombs according to Petya\'s logbook?" 1300
886B "Vlad and Cafes" NA "Vlad likes to eat in cafes very much. During his life, he has visited cafes n times. Unfortunately, Vlad started to feel that his last visits are not any different from each other. To fix that Vlad had a small research.First of all, Vlad assigned individual indices to all cafes. Then, he wrote down indices of cafes he visited in a row, in order of visiting them. Now, Vlad wants to find such a cafe that his last visit to that cafe was before his last visits to every other cafe. In other words, he wants to find such a cafe that he hasn\'t been there for as long as possible. Help Vlad to find that cafe." 1000
886A "ACM ICPC" "brute force" "In a small but very proud high school it was decided to win ACM ICPC. This goal requires to compose as many teams of three as possible, but since there were only 6 students who wished to participate, the decision was to build exactly two teams.After practice competition, participant number i got a score of ai. Team score is defined as sum of scores of its participants. High school management is interested if it\'s possible to build two teams with equal scores. Your task is to answer that question." 1000
884F Anti-Palindromize flows,graphs,greedy "A string a of length m is called antipalindromic iff m is even, and for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89am\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891.Ivan has a string s consisting of n lowercase Latin letters; n is even. He wants to form some string t that will be an antipalindromic permutation of s. Also Ivan has denoted the beauty of index i as bi, and the beauty of t as the sum of bi among all indices i such that si\xe2\x80\x89=\xe2\x80\x89ti.Help Ivan to determine maximum possible beauty of t he can get." 2500
884E "Binary Matrix" dsu "You are given a matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each element of the matrix is either 1 or 0. You have to determine the number of connected components consisting of 1\'s. Two cells belong to the same component if they have a common border, and both elements in these cells are 1\'s.Note that the memory limit is unusual!" 2500
884D "Boxes And Balls" "data structures,greedy" "Ivan has n different boxes. The first of them contains some balls of n different colors.Ivan wants to play a strange game. He wants to distribute the balls into boxes in such a way that for every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) i-th box will contain all balls with color i.In order to do this, Ivan will make some turns. Each turn he does the following:  Ivan chooses any non-empty box and takes all balls from this box;  Then Ivan chooses any k empty boxes (the box from the first step becomes empty, and Ivan is allowed to choose it), separates the balls he took on the previous step into k non-empty groups and puts each group into one of the boxes. He should put each group into a separate box. He can choose either k\xe2\x80\x89=\xe2\x80\x892 or k\xe2\x80\x89=\xe2\x80\x893. The penalty of the turn is the number of balls Ivan takes from the box during the first step of the turn. And penalty of the game is the total penalty of turns made by Ivan until he distributes all balls to corresponding boxes.Help Ivan to determine the minimum possible penalty of the game!" 2300
884C "Bertown Subway" "dfs and similar,greedy,math" "The construction of subway in Bertown is almost finished! The President of Berland will visit this city soon to look at the new subway himself.There are n stations in the subway. It was built according to the Bertown Transport Law:  For each station i there exists exactly one train that goes from this station. Its destination station is pi, possibly pi\xe2\x80\x89=\xe2\x80\x89i;  For each station i there exists exactly one station j such that pj\xe2\x80\x89=\xe2\x80\x89i. The President will consider the convenience of subway after visiting it. The convenience is the number of ordered pairs (x,\xe2\x80\x89y) such that person can start at station x and, after taking some subway trains (possibly zero), arrive at station y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n).The mayor of Bertown thinks that if the subway is not convenient enough, then the President might consider installing a new mayor (and, of course, the current mayor doesn\'t want it to happen). Before President visits the city mayor has enough time to rebuild some paths of subway, thus changing the values of pi for not more than two subway stations. Of course, breaking the Bertown Transport Law is really bad, so the subway must be built according to the Law even after changes.The mayor wants to do these changes in such a way that the convenience of the subway is maximized. Help him to calculate the maximum possible convenience he can get!" 1500
884B "Japanese Crosswords Strike Back" implementation "A one-dimensional Japanese crossword can be represented as a binary string of length x. An encoding of this crossword is an array a of size n, where n is the number of segments formed completely of 1\'s, and ai is the length of i-th segment. No two segments touch or intersect.For example:   If x\xe2\x80\x89=\xe2\x80\x896 and the crossword is 111011, then its encoding is an array {3,\xe2\x80\x892};  If x\xe2\x80\x89=\xe2\x80\x898 and the crossword is 01101010, then its encoding is an array {2,\xe2\x80\x891,\xe2\x80\x891};  If x\xe2\x80\x89=\xe2\x80\x895 and the crossword is 11111, then its encoding is an array {5};  If x\xe2\x80\x89=\xe2\x80\x895 and the crossword is 00000, then its encoding is an empty array. Mishka wants to create a new one-dimensional Japanese crossword. He has already picked the length and the encoding for this crossword. And now he needs to check if there is exactly one crossword such that its length and encoding are equal to the length and encoding he picked. Help him to check it!" 1100
884A "Book Reading" implementation "Recently Luba bought a very interesting book. She knows that it will take t seconds to read the book. Luba wants to finish reading as fast as she can.But she has some work to do in each of n next days. The number of seconds that Luba has to spend working during i-th day is ai. If some free time remains, she can spend it on reading.Help Luba to determine the minimum number of day when she finishes reading.It is guaranteed that the answer doesn\'t exceed n.Remember that there are 86400 seconds in a day." 800
883M "Quadcopter Competition" greedy,math "Polycarp takes part in a quadcopter competition. According to the rules a flying robot should:  start the race from some point of a field,  go around the flag,  close cycle returning back to the starting point. Polycarp knows the coordinates of the starting point (x1,\xe2\x80\x89y1) and the coordinates of the point where the flag is situated (x2,\xe2\x80\x89y2). Polycarp\xe2\x80\x99s quadcopter can fly only parallel to the sides of the field each tick changing exactly one coordinate by 1. It means that in one tick the quadcopter can fly from the point (x,\xe2\x80\x89y) to any of four points: (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) or (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891).Thus the quadcopter path is a closed cycle starting and finishing in (x1,\xe2\x80\x89y1) and containing the point (x2,\xe2\x80\x89y2) strictly inside.  The picture corresponds to the first example: the starting (and finishing) point is in (1,\xe2\x80\x895) and the flag is in (5,\xe2\x80\x892). What is the minimal length of the quadcopter path?" 1100
883L Berland.Taxi "data structures" "Berland.Taxi is a new taxi company with k cars which started operating in the capital of Berland just recently. The capital has n houses on a straight line numbered from 1 (leftmost) to n (rightmost), and the distance between any two neighboring houses is the same.You have to help the company schedule all the taxi rides which come throughout the day according to the following rules:   All cars are available for picking up passengers. Initially the j-th car is located next to the house with the number xj at time 0.  All cars have the same speed. It takes exactly 1 minute for any car to travel between neighboring houses i and i\xe2\x80\x89+\xe2\x80\x891.  The i-th request for taxi ride comes at the time ti, asking for a passenger to be picked up at the house ai and dropped off at the house bi. All requests for taxi rides are given in the increasing order of ti. All ti are distinct. When a request for taxi ride is received at time ti, Berland.Taxi operator assigns a car to it as follows:   Out of cars which are currently available, operator assigns the car which is the closest to the pick up spot ai. Needless to say, if a car is already on a ride with a passenger, it won\'t be available for any rides until that passenger is dropped off at the corresponding destination.  If there are several such cars, operator will pick one of them which has been waiting the most since it became available.  If there are several such cars, operator will pick one of them which has the lowest number. After a car gets assigned to the taxi ride request:   The driver immediately starts driving from current position to the house ai.  Once the car reaches house ai, the passenger is immediately picked up and the driver starts driving to house bi.  Once house bi is reached, the passenger gets dropped off and the car becomes available for new rides staying next to the house bi.  It is allowed for multiple cars to be located next to the same house at the same point in time, while waiting for ride requests or just passing by. If there are no available cars at time ti when a request for taxi ride comes, then:   The i-th passenger will have to wait for a car to become available.  When a car becomes available, operator will immediately assign it to this taxi ride request.  If multiple cars become available at once while the passenger is waiting, operator will pick a car out of them according to the rules described above. Operator processes taxi ride requests one by one. So if multiple passengers are waiting for the cars to become available, operator will not move on to processing the (i\xe2\x80\x89+\xe2\x80\x891)-th ride request until the car gets assigned to the i-th ride request.Your task is to write a program that will process the given list of m taxi ride requests. For each request you have to find out which car will get assigned to it, and how long the passenger will have to wait for a car to arrive. Note, if there is already car located at the house ai, then the corresponding wait time will be 0." 2500
883K "Road Widening" "constructive algorithms,greedy,implementation" "Mayor of city S just hates trees and lawns. They take so much space and there could be a road on the place they occupy!The Mayor thinks that one of the main city streets could be considerably widened on account of lawn nobody needs anyway. Moreover, that might help reduce the car jams which happen from time to time on the street.The street is split into n equal length parts from left to right, the i-th part is characterized by two integers: width of road si and width of lawn gi.  For each of n parts the Mayor should decide the size of lawn to demolish. For the i-th part he can reduce lawn width by integer xi (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89xi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89gi). After it new road width of the i-th part will be equal to s\'i\xe2\x80\x89=\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89xi and new lawn width will be equal to g\'i\xe2\x80\x89=\xe2\x80\x89gi\xe2\x80\x89-\xe2\x80\x89xi.On the one hand, the Mayor wants to demolish as much lawn as possible (and replace it with road). On the other hand, he does not want to create a rapid widening or narrowing of the road, which would lead to car accidents. To avoid that, the Mayor decided that width of the road for consecutive parts should differ by at most 1, i.e. for each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) the inequation |s\'i\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89s\'i|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 should hold. Initially this condition might not be true.You need to find the the total width of lawns the Mayor will destroy according to his plan." 1800
883J Renovation "constructive algorithms,greedy,sortings" "The mayor of the Berland city S sees the beauty differently than other city-dwellers. In particular, he does not understand at all, how antique houses can be nice-looking. So the mayor wants to demolish all ancient buildings in the city.The city S is going to host the football championship very soon. In order to make the city beautiful, every month the Berland government provides mayor a money tranche. The money has to be spent on ancient buildings renovation.There are n months before the championship and the i-th month tranche equals to ai burles. The city S has m antique buildings and the renovation cost of the j-th building is bj burles.The mayor has his own plans for spending the money. As he doesn\'t like antique buildings he wants to demolish as much of them as possible. For the j-th building he calculated its demolishing cost pj.The mayor decided to act according to the following plan.Each month he chooses several (possibly zero) of m buildings to demolish in such a way that renovation cost of each of them separately is not greater than the money tranche ai of this month (bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai) \xe2\x80\x94 it will allow to deceive city-dwellers that exactly this building will be renovated.Then the mayor has to demolish all selected buildings during the current month as otherwise the dwellers will realize the deception and the plan will fail. Definitely the total demolishing cost can not exceed amount of money the mayor currently has. The mayor is not obliged to spend all the money on demolishing. If some money is left, the mayor puts it to the bank account and can use it in any subsequent month. Moreover, at any month he may choose not to demolish any buildings at all (in this case all the tranche will remain untouched and will be saved in the bank).Your task is to calculate the maximal number of buildings the mayor can demolish." 2400
883I "Photo Processing" "binary search,dp" "Evlampiy has found one more cool application to process photos. However the application has certain limitations.Each photo i has a contrast vi. In order for the processing to be truly of high quality, the application must receive at least k photos with contrasts which differ as little as possible.Evlampiy already knows the contrast vi for each of his n photos. Now he wants to split the photos into groups, so that each group contains at least k photos. As a result, each photo must belong to exactly one group.He considers a processing time of the j-th group to be the difference between the maximum and minimum values of vi in the group. Because of multithreading the processing time of a division into groups is the maximum processing time among all groups.Split n photos into groups in a such way that the processing time of the division is the minimum possible, i.e. that the the maximum processing time over all groups as least as possible." 1900
883H "Palindromic Cut" "brute force,implementation,strings" "Kolya has a string s of length n consisting of lowercase and uppercase Latin letters and digits.He wants to rearrange the symbols in s and cut it into the minimum number of parts so that each part is a palindrome and all parts have the same lengths. A palindrome is a string which reads the same backward as forward, such as madam or racecar.Your task is to help Kolya and determine the minimum number of palindromes of equal lengths to cut s into, if it is allowed to rearrange letters in s before cuttings." 1800
883G "Orientation of Edges" "dfs and similar,graphs" "Vasya has a graph containing both directed (oriented) and undirected (non-oriented) edges. There can be multiple edges between a pair of vertices.Vasya has picked a vertex s from the graph. Now Vasya wants to create two separate plans:  to orient each undirected edge in one of two possible directions to maximize number of vertices reachable from vertex s;  to orient each undirected edge in one of two possible directions to minimize number of vertices reachable from vertex s. In each of two plans each undirected edge must become directed. For an edge chosen directions can differ in two plans.Help Vasya find the plans." 1900
883F "Lost in Transliteration" implementation "There are some ambiguities when one writes Berland names with the letters of the Latin alphabet.For example, the Berland sound u can be written in the Latin alphabet as ""u"", and can be written as ""oo"". For this reason, two words ""ulyana"" and ""oolyana"" denote the same name.The second ambiguity is about the Berland sound h: one can use both ""h"" and ""kh"" to write it. For example, the words ""mihail"" and ""mikhail"" denote the same name.There are n users registered on the Polycarp\'s website. Each of them indicated a name represented by the Latin letters. How many distinct names are there among them, if two ambiguities described above are taken into account?Formally, we assume that two words denote the same name, if using the replacements ""u""  ""oo"" and ""h""  ""kh"", you can make the words equal. One can make replacements in both directions, in any of the two words an arbitrary number of times. A letter that resulted from the previous replacement can participate in the next replacements.For example, the following pairs of words denote the same name:  ""koouper"" and ""kuooper"". Making the replacements described above, you can make both words to be equal: ""koouper""  ""kuuper"" and ""kuooper""  ""kuuper"".  ""khun"" and ""kkkhoon"". With the replacements described above you can make both words to be equal: ""khun""  ""khoon"" and ""kkkhoon""  ""kkhoon""  ""khoon"". For a given list of words, find the minimal number of groups where the words in each group denote the same name." 1300
883E "Field of Wonders" implementation,strings "Polycarpus takes part in the ""Field of Wonders"" TV show. The participants of the show have to guess a hidden word as fast as possible. Initially all the letters of the word are hidden.The game consists of several turns. At each turn the participant tells a letter and the TV show host responds if there is such letter in the word or not. If there is such letter then the host reveals all such letters. For example, if the hidden word is ""abacaba"" and the player tells the letter ""a"", the host will reveal letters at all positions, occupied by ""a"": 1, 3, 5 and 7 (positions are numbered from left to right starting from 1).Polycarpus knows m words of exactly the same length as the hidden word. The hidden word is also known to him and appears as one of these m words.At current moment a number of turns have already been made and some letters (possibly zero) of the hidden word are already revealed. Previously Polycarp has told exactly the letters which are currently revealed.It is Polycarpus\' turn. He wants to tell a letter in such a way, that the TV show host will assuredly reveal at least one more letter. Polycarpus cannot tell the letters, which are already revealed.Your task is to help Polycarpus and find out the number of letters he can tell so that the show host will assuredly reveal at least one of the remaining letters." 1500
883D "Packmen Strike Back" "binary search,dp,math" "Game field is represented by a line of n square cells. In some cells there are packmen, in some cells there are asterisks and the rest of the cells are empty. Packmen eat asterisks.Before the game starts you can choose a movement direction, left or right, for each packman. Once the game begins all the packmen simultaneously start moving according their directions. A packman can\'t change the given direction.Once a packman enters a cell containing an asterisk, packman immediately eats the asterisk. Once the packman leaves the cell it becomes empty. Each packman moves at speed 1 cell per second. If a packman enters a border cell, the packman stops. Packmen do not interfere with the movement of other packmen; in one cell there can be any number of packmen moving in any directions.Your task is to assign a direction to each packman so that they eat the maximal number of asterisks. If there are multiple ways to assign directions to eat the maximal number of asterisks, you should choose the way which minimizes the time to do that." 2500
883C "Downloading B++" "binary search,implementation" "Only T milliseconds left before the start of well-known online programming contest Codehorses Round 2017.Polycarp needs to download B++ compiler to take part in the contest. The size of the file is f bytes.Polycarp\'s internet tariff allows to download data at the rate of one byte per t0 milliseconds. This tariff is already prepaid, and its use does not incur any expense for Polycarp. In addition, the Internet service provider offers two additional packages:  download a1 bytes at the rate of one byte per t1 milliseconds, paying p1 burles for the package;  download a2 bytes at the rate of one byte per t2 milliseconds, paying p2 burles for the package. Polycarp can buy any package many times. When buying a package, its price (p1 or p2) is prepaid before usage. Once a package is bought it replaces the regular tariff until package data limit is completely used. After a package is consumed Polycarp can immediately buy a new package or switch to the regular tariff without loosing any time. While a package is in use Polycarp can\'t buy another package or switch back to the regular internet tariff.Find the minimum amount of money Polycarp has to spend to download an f bytes file no more than in T milliseconds.Note that because of technical reasons Polycarp can download only integer number of bytes using regular tariff and both packages. I.e. in each of three downloading modes the number of downloaded bytes will be integer. It means that Polycarp can\'t download a byte partially using the regular tariff or/and both packages." 2300
883B "Berland Army" "constructive algorithms,graphs,greedy" "There are n military men in the Berland army. Some of them have given orders to other military men by now. Given m pairs (xi, yi), meaning that the military man xi gave the i-th order to another military man yi.It is time for reform! The Berland Ministry of Defence plans to introduce ranks in the Berland army. Each military man should be assigned a rank \xe2\x80\x94 integer number between 1 and k, inclusive. Some of them have been already assigned a rank, but the rest of them should get a rank soon.Help the ministry to assign ranks to the rest of the army so that:  for each of m orders it is true that the rank of a person giving the order (military man xi) is strictly greater than the rank of a person receiving the order (military man yi);  for each rank from 1 to k there is at least one military man with this rank." 2600
883A "Automatic Door" implementation "There is an automatic door at the entrance of a factory. The door works in the following way:  when one or several people come to the door and it is closed, the door immediately opens automatically and all people immediately come inside,  when one or several people come to the door and it is open, all people immediately come inside,  opened door immediately closes in d seconds after its opening,  if the door is closing and one or several people are coming to the door at the same moment, then all of them will have enough time to enter and only after that the door will close. For example, if d\xe2\x80\x89=\xe2\x80\x893 and four people are coming at four different moments of time t1\xe2\x80\x89=\xe2\x80\x894, t2\xe2\x80\x89=\xe2\x80\x897, t3\xe2\x80\x89=\xe2\x80\x899 and t4\xe2\x80\x89=\xe2\x80\x8913 then the door will open three times: at moments 4, 9 and 13. It will close at moments 7 and 12.It is known that n employees will enter at moments a,\xe2\x80\x892\xc2\xb7a,\xe2\x80\x893\xc2\xb7a,\xe2\x80\x89...,\xe2\x80\x89n\xc2\xb7a (the value a is positive integer). Also m clients will enter at moments t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tm.Write program to find the number of times the automatic door will open. Assume that the door is initially closed." 2200
879B "Table Tennis" "data structures,implementation" "n people are standing in a line to play table tennis. At first, the first two players in the line play a game. Then the loser goes to the end of the line, and the winner plays with the next person from the line, and so on. They play until someone wins k games in a row. This player becomes the winner.For each of the participants, you know the power to play table tennis, and for all players these values are different. In a game the player with greater power always wins. Determine who will be the winner." 1200
879A "Borya\'s Diagnosis" implementation "It seems that Borya is seriously sick. He is going visit n doctors to find out the exact diagnosis. Each of the doctors needs the information about all previous visits, so Borya has to visit them in the prescribed order (i.e. Borya should first visit doctor 1, then doctor 2, then doctor 3 and so on). Borya will get the information about his health from the last doctor.Doctors have a strange working schedule. The doctor i goes to work on the si-th day and works every di day. So, he works on days si,\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89di,\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x892di,\xe2\x80\x89....The doctor\'s appointment takes quite a long time, so Borya can not see more than one doctor per day. What is the minimum time he needs to visit all doctors?" 900
878E "Numbers on the blackboard" combinatorics,dp "A sequence of n integers is written on a blackboard. Soon Sasha will come to the blackboard and start the following actions: let x and y be two adjacent numbers (x before y), then he can remove them and write x\xe2\x80\x89+\xe2\x80\x892y instead of them. He will perform these operations until one number is left. Sasha likes big numbers and will get the biggest possible number.Nikita wants to get to the blackboard before Sasha and erase some of the numbers. He has q options, in the option i he erases all numbers to the left of the li-th number and all numbers to the right of ri-th number, i. e. all numbers between the li-th and the ri-th, inclusive, remain on the blackboard. For each of the options he wants to know how big Sasha\'s final number is going to be. This number can be very big, so output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 3300
878D "Magic Breeding" bitmasks "Nikita and Sasha play a computer game where you have to breed some magical creatures. Initially, they have k creatures numbered from 1 to k. Creatures have n different characteristics.Sasha has a spell that allows to create a new creature from two given creatures. Each of its characteristics will be equal to the maximum of the corresponding characteristics of used creatures. Nikita has a similar spell, but in his spell, each characteristic of the new creature is equal to the minimum of the corresponding characteristics of used creatures. A new creature gets the smallest unused number.They use their spells and are interested in some characteristics of their new creatures. Help them find out these characteristics." 2900
878C Tournament "data structures,graphs" "Recently a tournament in k kinds of sports has begun in Berland. Vasya wants to make money on the bets.The scheme of the tournament is very mysterious and not fully disclosed. Competitions are held back to back, each of them involves two sportsmen who have not left the tournament yet. Each match can be held in any of the k kinds of sport. Loser leaves the tournament. The last remaining sportsman becomes the winner. Apart of this, the scheme can be arbitrary, it is not disclosed in advance.Vasya knows powers of sportsmen in each kind of sport. He believes that the sportsmen with higher power always wins.The tournament is held every year, and each year one new participant joins it. In the first tournament, only one sportsman has participated, in the second there were two sportsmen, and so on. Vasya has been watching the tournament for the last n years. Help him to find the number of possible winners for each of the n tournaments." 2700
878B "Teams Formation" "data structures,implementation" "This time the Berland Team Olympiad in Informatics is held in a remote city that can only be reached by one small bus. Bus has n passenger seats, seat i can be occupied only by a participant from the city ai.Today the bus has completed m trips, each time bringing n participants. The participants were then aligned in one line in the order they arrived, with people from the same bus standing in the order of their seats (i. e. if we write down the cities where the participants came from, we get the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an repeated m times).After that some teams were formed, each consisting of k participants form the same city standing next to each other in the line. Once formed, teams left the line. The teams were formed until there were no k neighboring participants from the same city.Help the organizers determine how many participants have left in the line after that process ended. We can prove that answer doesn\'t depend on the order in which teams were selected." 2300
878A "Short Program" "bitmasks,constructive algorithms" "Petya learned a new programming language CALPAS. A program in this language always takes one non-negative integer and returns one non-negative integer as well.In the language, there are only three commands: apply a bitwise operation AND, OR or XOR with a given constant to the current integer. A program can contain an arbitrary sequence of these operations with arbitrary constants from 0 to 1023. When the program is run, all operations are applied (in the given order) to the argument and in the end the result integer is returned.Petya wrote a program in this language, but it turned out to be too long. Write a program in CALPAS that does the same thing as the Petya\'s program, and consists of no more than 5 lines. Your program should return the same integer as Petya\'s program for all arguments from 0 to 1023." 1600
877F "Ann and Books" "data structures,flows,hashing" "In Ann\'s favorite book shop are as many as n books on math and economics. Books are numbered from 1 to n. Each of them contains non-negative number of problems.Today there is a sale: any subsegment of a segment from l to r can be bought at a fixed price. Ann decided that she wants to buy such non-empty subsegment that the sale operates on it and the number of math problems is greater than the number of economics problems exactly by k. Note that k may be positive, negative or zero.Unfortunately, Ann is not sure on which segment the sale operates, but she has q assumptions. For each of them she wants to know the number of options to buy a subsegment satisfying the condition (because the time she spends on choosing depends on that).Currently Ann is too busy solving other problems, she asks you for help. For each her assumption determine the number of subsegments of the given segment such that the number of math problems is greaten than the number of economics problems on that subsegment exactly by k." 2300
877E "Danil and a Part-time Job" "bitmasks,data structures,trees" "Danil decided to earn some money, so he had found a part-time job. The interview have went well, so now he is a light switcher.Danil works in a rooted tree (undirected connected acyclic graph) with n vertices, vertex 1 is the root of the tree. There is a room in each vertex, light can be switched on or off in each room. Danil\'s duties include switching light in all rooms of the subtree of the vertex. It means that if light is switched on in some room of the subtree, he should switch it off. Otherwise, he should switch it on.Unfortunately (or fortunately), Danil is very lazy. He knows that his boss is not going to personally check the work. Instead, he will send Danil tasks using Workforces personal messages.There are two types of tasks:  pow v describes a task to switch lights in the subtree of vertex v. get v describes a task to count the number of rooms in the subtree of v, in which the light is turned on. Danil should send the answer to his boss using Workforces messages.A subtree of vertex v is a set of vertices for which the shortest path from them to the root passes through v. In particular, the vertex v is in the subtree of v.Danil is not going to perform his duties. He asks you to write a program, which answers the boss instead of him." 2000
877D "Olya and Energy Drinks" "data structures,dfs and similar,graphs,shortest paths" "Olya loves energy drinks. She loves them so much that her room is full of empty cans from energy drinks.Formally, her room can be represented as a field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells, each cell of which is empty or littered with cans.Olya drank a lot of energy drink, so now she can run k meters per second. Each second she chooses one of the four directions (up, down, left or right) and runs from 1 to k meters in this direction. Of course, she can only run through empty cells.Now Olya needs to get from cell (x1,\xe2\x80\x89y1) to cell (x2,\xe2\x80\x89y2). How many seconds will it take her if she moves optimally?It\'s guaranteed that cells (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2) are empty. These cells can coincide." 2100
877C "Slava and tanks" "constructive algorithms" "Slava plays his favorite game ""Peace Lightning"". Now he is flying a bomber on a very specific map.Formally, map is a checkered field of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n, the cells of which are numbered from 1 to n, in each cell there can be one or several tanks. Slava doesn\'t know the number of tanks and their positions, because he flies very high, but he can drop a bomb in any cell. All tanks in this cell will be damaged.If a tank takes damage for the first time, it instantly moves to one of the neighboring cells (a tank in the cell n can only move to the cell n\xe2\x80\x89-\xe2\x80\x891, a tank in the cell 1 can only move to the cell 2). If a tank takes damage for the second time, it\'s counted as destroyed and never moves again. The tanks move only when they are damaged for the first time, they do not move by themselves.Help Slava to destroy all tanks using as few bombs as possible." 1600
877B "Nikita and string" "brute force,dp" "One day Nikita found the string containing letters ""a"" and ""b"" only. Nikita thinks that string is beautiful if it can be cut into 3 strings (possibly empty) without changing the order of the letters, where the 1-st and the 3-rd one contain only letters ""a"" and the 2-nd contains only letters ""b"".Nikita wants to make the string beautiful by removing some (possibly none) of its characters, but without changing their order. What is the maximum length of the string he can get?" 1500
877A "Alex and broken contest" implementation,strings "One day Alex was creating a contest about his friends, but accidentally deleted it. Fortunately, all the problems were saved, but now he needs to find them among other problems.But there are too many problems, to do it manually. Alex asks you to write a program, which will determine if a problem is from this contest by its name.It is known, that problem is from this contest if and only if its name contains one of Alex\'s friends\' name exactly once. His friends\' names are ""Danil"", ""Olya"", ""Slava"", ""Ann"" and ""Nikita"".Names are case sensitive." 1100
876B "Divisiblity of Differences" "implementation,math,number theory" "You are given a multiset of n integers. You should select exactly k of them in a such way that the difference between any two of them is divisible by m, or tell that it is impossible.Numbers can be repeated in the original multiset and in the multiset of selected numbers, but number of occurrences of any number in multiset of selected numbers should not exceed the number of its occurrences in the original multiset." 1300
876A "Trip For Meal" math "Winnie-the-Pooh likes honey very much! That is why he decided to visit his friends. Winnie has got three best friends: Rabbit, Owl and Eeyore, each of them lives in his own house. There are winding paths between each pair of houses. The length of a path between Rabbit\'s and Owl\'s houses is a meters, between Rabbit\'s and Eeyore\'s house is b meters, between Owl\'s and Eeyore\'s house is c meters.For enjoying his life and singing merry songs Winnie-the-Pooh should have a meal n times a day. Now he is in the Rabbit\'s house and has a meal for the first time. Each time when in the friend\'s house where Winnie is now the supply of honey is about to end, Winnie leaves that house. If Winnie has not had a meal the required amount of times, he comes out from the house and goes to someone else of his two friends. For this he chooses one of two adjacent paths, arrives to the house on the other end and visits his friend. You may assume that when Winnie is eating in one of his friend\'s house, the supply of honey in other friend\'s houses recover (most probably, they go to the supply store).Winnie-the-Pooh does not like physical activity. He wants to have a meal n times, traveling minimum possible distance. Help him to find this distance." 900
875F "Royal Questions" dsu,graphs,greedy "In a medieval kingdom, the economic crisis is raging. Milk drops fall, Economic indicators are deteriorating every day, money from the treasury disappear. To remedy the situation, King Charles Sunnyface decided make his n sons-princes marry the brides with as big dowry as possible.In search of candidates, the king asked neighboring kingdoms, and after a while several delegations arrived with m unmarried princesses. Receiving guests, Karl learned that the dowry of the i th princess is wi of golden coins. Although the action takes place in the Middle Ages, progressive ideas are widespread in society, according to which no one can force a princess to marry a prince whom she does not like. Therefore, each princess has an opportunity to choose two princes, for each of which she is ready to become a wife. The princes were less fortunate, they will obey the will of their father in the matter of choosing a bride.Knowing the value of the dowry and the preferences of each princess, Charles wants to play weddings in such a way that the total dowry of the brides of all his sons would be as great as possible. At the same time to marry all the princes or princesses is not necessary. Each prince can marry no more than one princess, and vice versa, each princess can marry no more than one prince.Help the king to organize the marriage of his sons in the most profitable way for the treasury." 2500
875E "Delivery Club" "binary search,data structures,dp" "Petya and Vasya got employed as couriers. During the working day they are to deliver packages to n different points on the line. According to the company\'s internal rules, the delivery of packages must be carried out strictly in a certain order. Initially, Petya is at the point with the coordinate s1, Vasya is at the point with the coordinate s2, and the clients are at the points x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn in the order of the required visit.The guys agree in advance who of them will deliver the package to which of the customers, and then they act as follows. When the package for the i-th client is delivered, the one who delivers the package to the (i\xe2\x80\x89+\xe2\x80\x891)-st client is sent to the path (it can be the same person who went to the point xi, or the other). The friend who is not busy in delivering the current package, is standing still.To communicate with each other, the guys have got walkie-talkies. The walkie-talkies work rather poorly at great distances, so Petya and Vasya want to distribute the orders so that the maximum distance between them during the day is as low as possible. Help Petya and Vasya to minimize the maximum distance between them, observing all delivery rules." 2600
875D "High Cry" "binary search,bitmasks,combinatorics,data structures,divide and conquer" "Disclaimer: there are lots of untranslateable puns in the Russian version of the statement, so there is one more reason for you to learn Russian :)Rick and Morty like to go to the ridge High Cry for crying loudly \xe2\x80\x94 there is an extraordinary echo. Recently they discovered an interesting acoustic characteristic of this ridge: if Rick and Morty begin crying simultaneously from different mountains, their cry would be heard between these mountains up to the height equal the bitwise OR of mountains they\'ve climbed and all the mountains between them. Bitwise OR is a binary operation which is determined the following way. Consider representation of numbers x and y in binary numeric system (probably with leading zeroes) x\xe2\x80\x89=\xe2\x80\x89xk... x1x0 and y\xe2\x80\x89=\xe2\x80\x89yk... y1y0. Then z\xe2\x80\x89=\xe2\x80\x89x | y is defined following way: z\xe2\x80\x89=\xe2\x80\x89zk... z1z0, where zi\xe2\x80\x89=\xe2\x80\x891, if xi\xe2\x80\x89=\xe2\x80\x891 or yi\xe2\x80\x89=\xe2\x80\x891, and zi\xe2\x80\x89=\xe2\x80\x890 otherwise. In the other words, digit of bitwise OR of two numbers equals zero if and only if digits at corresponding positions is both numbers equals zero. For example bitwise OR of numbers 10\xe2\x80\x89=\xe2\x80\x8910102 and 9\xe2\x80\x89=\xe2\x80\x8910012 equals 11\xe2\x80\x89=\xe2\x80\x8910112. In programming languages C/C++/Java/Python this operation is defined as \xc2\xab|\xc2\xbb, and in Pascal as \xc2\xabor\xc2\xbb.Help Rick and Morty calculate the number of ways they can select two mountains in such a way that if they start crying from these mountains their cry will be heard above these mountains and all mountains between them. More formally you should find number of pairs l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that bitwise OR of heights of all mountains between l and r (inclusive) is larger than the height of any mountain at this interval." 2200
875C "National Property" "2-sat,dfs and similar,graphs,implementation" "You all know that the Library of Bookland is the largest library in the world. There are dozens of thousands of books in the library.Some long and uninteresting story was removed...The alphabet of Bookland is so large that its letters are denoted by positive integers. Each letter can be small or large, the large version of a letter x is denoted by x\'. BSCII encoding, which is used everywhere in Bookland, is made in that way so that large letters are presented in the order of the numbers they are denoted by, and small letters are presented in the order of the numbers they are denoted by, but all large letters are before all small letters. For example, the following conditions hold: 2\xe2\x80\x89<\xe2\x80\x893, 2\'\xe2\x80\x89<\xe2\x80\x893\', 3\'\xe2\x80\x89<\xe2\x80\x892.A word x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xa is not lexicographically greater than y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yb if one of the two following conditions holds:   a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b and x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89...,\xe2\x80\x89xa\xe2\x80\x89=\xe2\x80\x89ya, i.e. the first word is the prefix of the second word;  there is a position 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89min(a,\xe2\x80\x89b), such that x1\xe2\x80\x89=\xe2\x80\x89y1,\xe2\x80\x89...,\xe2\x80\x89xj\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89yj\xe2\x80\x89-\xe2\x80\x891 and xj\xe2\x80\x89<\xe2\x80\x89yj, i.e. at the first position where the words differ the first word has a smaller letter than the second word has.  For example, the word ""3\' 7 5"" is before the word ""2 4\' 6"" in lexicographical order. It is said that sequence of words is in lexicographical order if each word is not lexicographically greater than the next word in the sequence.Denis has a sequence of words consisting of small letters only. He wants to change some letters to large (let\'s call this process a capitalization) in such a way that the sequence of words is in lexicographical order. However, he soon realized that for some reason he can\'t change a single letter in a single word. He only can choose a letter and change all of its occurrences in all words to large letters. He can perform this operation any number of times with arbitrary letters of Bookland\'s alphabet.Help Denis to choose which letters he needs to capitalize (make large) in order to make the sequence of words lexicographically ordered, or determine that it is impossible.Note that some words can be equal." 2100
875B "Sorting the Coins" "dsu,implementation,sortings,two pointers" "Recently, Dima met with Sasha in a philatelic store, and since then they are collecting coins together. Their favorite occupation is to sort collections of coins. Sasha likes having things in order, that is why he wants his coins to be arranged in a row in such a way that firstly come coins out of circulation, and then come coins still in circulation. For arranging coins Dima uses the following algorithm. One step of his algorithm looks like the following:  He looks through all the coins from left to right;  If he sees that the i-th coin is still in circulation, and (i\xe2\x80\x89+\xe2\x80\x891)-th coin is already out of circulation, he exchanges these two coins and continues watching coins from (i\xe2\x80\x89+\xe2\x80\x891)-th.  Dima repeats the procedure above until it happens that no two coins were exchanged during this procedure. Dima calls hardness of ordering the number of steps required for him according to the algorithm above to sort the sequence, e.g. the number of times he looks through the coins from the very beginning. For example, for the ordered sequence hardness of ordering equals one.Today Sasha invited Dima and proposed him a game. First he puts n coins in a row, all of them are out of circulation. Then Sasha chooses one of the coins out of circulation and replaces it with a coin in circulation for n times. During this process Sasha constantly asks Dima what is the hardness of ordering of the sequence. The task is more complicated because Dima should not touch the coins and he should determine hardness of ordering in his mind. Help Dima with this task." 1500
875A "Classroom Watch" "brute force,math" "Eighth-grader Vova is on duty today in the class. After classes, he went into the office to wash the board, and found on it the number n. He asked what is this number and the teacher of mathematics Inna Petrovna answered Vova that n is the answer to the arithmetic task for first-graders. In the textbook, a certain positive integer x was given. The task was to add x to the sum of the digits of the number x written in decimal numeral system.Since the number n on the board was small, Vova quickly guessed which x could be in the textbook. Now he wants to get a program which will search for arbitrary values of the number n for all suitable values of x or determine that such x does not exist. Write such a program for Vova." 1200
873F "Forbidden Indices" "dsu,string suffix structures,strings" "You are given a string s consisting of n lowercase Latin letters. Some indices in this string are marked as forbidden.You want to find a string a such that the value of |a|\xc2\xb7f(a) is maximum possible, where f(a) is the number of occurences of a in s such that these occurences end in non-forbidden indices. So, for example, if s is aaaa, a is aa and index 3 is forbidden, then f(a)\xe2\x80\x89=\xe2\x80\x892 because there are three occurences of a in s (starting in indices 1, 2 and 3), but one of them (starting in index 2) ends in a forbidden index.Calculate the maximum possible value of |a|\xc2\xb7f(a) you can get." 2400
873E "Awards For Contestants" "brute force,data structures,dp" "Alexey recently held a programming contest for students from Berland. n students participated in a contest, i-th of them solved ai problems. Now he wants to award some contestants. Alexey can award the students with diplomas of three different degrees. Each student either will receive one diploma of some degree, or won\'t receive any diplomas at all. Let cntx be the number of students that are awarded with diplomas of degree x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893). The following conditions must hold:  For each x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893) cntx\xe2\x80\x89>\xe2\x80\x890;  For any two degrees x and y cntx\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892\xc2\xb7cnty. Of course, there are a lot of ways to distribute the diplomas. Let bi be the degree of diploma i-th student will receive (or \xe2\x80\x89-\xe2\x80\x891 if i-th student won\'t receive any diplomas). Also for any x such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x893 let cx be the maximum number of problems solved by a student that receives a diploma of degree x, and dx be the minimum number of problems solved by a student that receives a diploma of degree x. Alexey wants to distribute the diplomas in such a way that:  If student i solved more problems than student j, then he has to be awarded not worse than student j (it\'s impossible that student j receives a diploma and i doesn\'t receive any, and also it\'s impossible that both of them receive a diploma, but bj\xe2\x80\x89<\xe2\x80\x89bi);  d1\xe2\x80\x89-\xe2\x80\x89c2 is maximum possible;  Among all ways that maximize the previous expression, d2\xe2\x80\x89-\xe2\x80\x89c3 is maximum possible;  Among all ways that correspond to the two previous conditions, d3\xe2\x80\x89-\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891 is maximum possible, where c\xe2\x80\x89-\xe2\x80\x891 is the maximum number of problems solved by a student that doesn\'t receive any diploma (or 0 if each student is awarded with some diploma). Help Alexey to find a way to award the contestants!" 2300
873D "Merge Sort" "constructive algorithms,divide and conquer" "Merge sort is a well-known sorting algorithm. The main function that sorts the elements of array a with indices from [l,\xe2\x80\x89r) can be implemented as follows:  If the segment [l,\xe2\x80\x89r) is already sorted in non-descending order (that is, for any i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x891 a[i]\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a[i\xe2\x80\x89+\xe2\x80\x891]), then end the function call;  Let ;  Call mergesort(a,\xe2\x80\x89l,\xe2\x80\x89mid);  Call mergesort(a,\xe2\x80\x89mid,\xe2\x80\x89r);  Merge segments [l,\xe2\x80\x89mid) and [mid,\xe2\x80\x89r), making the segment [l,\xe2\x80\x89r) sorted in non-descending order. The merge algorithm doesn\'t call any other functions. The array in this problem is 0-indexed, so to sort the whole array, you need to call mergesort(a,\xe2\x80\x890,\xe2\x80\x89n).The number of calls of function mergesort is very important, so Ivan has decided to calculate it while sorting the array. For example, if a\xe2\x80\x89=\xe2\x80\x89{1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894}, then there will be 1 call of mergesort \xe2\x80\x94 mergesort(0,\xe2\x80\x894), which will check that the array is sorted and then end. If a\xe2\x80\x89=\xe2\x80\x89{2,\xe2\x80\x891,\xe2\x80\x893}, then the number of calls is 3: first of all, you call mergesort(0,\xe2\x80\x893), which then sets mid\xe2\x80\x89=\xe2\x80\x891 and calls mergesort(0,\xe2\x80\x891) and mergesort(1,\xe2\x80\x893), which do not perform any recursive calls because segments (0,\xe2\x80\x891) and (1,\xe2\x80\x893) are sorted.Ivan has implemented the program that counts the number of mergesort calls, but now he needs to test it. To do this, he needs to find an array a such that a is a permutation of size n (that is, the number of elements in a is n, and every integer number from [1,\xe2\x80\x89n] can be found in this array), and the number of mergesort calls when sorting the array is exactly k.Help Ivan to find an array he wants!" 1800
873C "Strange Game On Matrix" "greedy,two pointers" "Ivan is playing a strange game.He has a matrix a with n rows and m columns. Each element of the matrix is equal to either 0 or 1. Rows and columns are 1-indexed. Ivan can replace any number of ones in this matrix with zeroes. After that, his score in the game will be calculated as follows:  Initially Ivan\'s score is 0;  In each column, Ivan will find the topmost 1 (that is, if the current column is j, then he will find minimum i such that ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x891). If there are no 1\'s in the column, this column is skipped;  Ivan will look at the next min(k,\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891) elements in this column (starting from the element he found) and count the number of 1\'s among these elements. This number will be added to his score. Of course, Ivan wants to maximize his score in this strange game. Also he doesn\'t want to change many elements, so he will replace the minimum possible number of ones with zeroes. Help him to determine the maximum possible score he can get and the minimum possible number of replacements required to achieve that score." 1600
873B "Balanced Substring" dp,implementation "You are given a string s consisting only of characters 0 and 1. A substring [l,\xe2\x80\x89r] of s is a string slsl\xe2\x80\x89+\xe2\x80\x891sl\xe2\x80\x89+\xe2\x80\x892... sr, and its length equals to r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891. A substring is called balanced if the number of zeroes (0) equals to the number of ones in this substring.You have to determine the length of the longest balanced substring of s." 1500
873A Chores implementation "Luba has to do n chores today. i-th chore takes ai units of time to complete. It is guaranteed that for every  the condition ai\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891 is met, so the sequence is sorted.Also Luba can work really hard on some chores. She can choose not more than k any chores and do each of them in x units of time instead of ai ().Luba is very responsible, so she has to do all n chores, and now she wants to know the minimum time she needs to do everything. Luba cannot do two chores simultaneously." 800
871E "Restore the Tree" graphs,greedy,trees "Petya had a tree consisting of n vertices numbered with integers from 1 to n. Accidentally he lost his tree. Petya remembers information about k vertices: distances from each of them to each of the n tree vertices.Your task is to restore any tree that satisfies the information that Petya remembers or report that such tree doesn\'t exist." 2900
870F Paths "data structures,number theory" "You are given a positive integer n. Let\'s build a graph on vertices 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n in such a way that there is an edge between vertices u and v if and only if . Let d(u,\xe2\x80\x89v) be the shortest distance between u and v, or 0 if there is no path between them. Compute the sum of values d(u,\xe2\x80\x89v) over all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.The gcd (greatest common divisor) of two positive integers is the maximum positive integer that divides both of the integers." 2700
870E "Points, Lines and Ready-made Titles" "dfs and similar,dsu,graphs,trees" "You are given n distinct points on a plane with integral coordinates. For each point you can either draw a vertical line through it, draw a horizontal line through it, or do nothing.You consider several coinciding straight lines as a single one. How many distinct pictures you can get? Print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2300
870D "Something with XOR Queries" "brute force,interactive,probabilities" "This is an interactive problem.Jury has hidden a permutation p of integers from 0 to n\xe2\x80\x89-\xe2\x80\x891. You know only the length n. Remind that in permutation all integers are distinct.Let b be the inverse permutation for p, i.e. pbi\xe2\x80\x89=\xe2\x80\x89i for all i. The only thing you can do is to ask xor of elements pi and bj, printing two indices i and j (not necessarily distinct). As a result of the query with indices i and j you\'ll get the value , where  denotes the xor operation. You can find the description of xor operation in notes.Note that some permutations can remain indistinguishable from the hidden one, even if you make all possible n2 queries. You have to compute the number of permutations indistinguishable from the hidden one, and print one of such permutations, making no more than 2n queries.The hidden permutation does not depend on your queries." 2000
870C "Maximum splitting" "dp,greedy,math,number theory" "You are given several queries. In the i-th query you are given a single positive integer ni. You are to represent ni as a sum of maximum possible number of composite summands and print this maximum number, or print -1, if there are no such splittings.An integer greater than 1 is composite, if it is not prime, i.e. if it has positive divisors not equal to 1 and the integer itself." 1300
870B "Maximum of Maximums of Minimums" greedy "You are given an array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an consisting of n integers, and an integer k. You have to split the array into exactly k non-empty subsegments. You\'ll then compute the minimum integer on each subsegment, and take the maximum integer over the k obtained minimums. What is the maximum possible integer you can get?Definitions of subsegment and array splitting are given in notes." 1200
870A "Search for Pretty Integers" "brute force,implementation" "You are given two lists of non-zero digits.Let\'s call an integer pretty if its (base 10) representation has at least one digit from the first list and at least one digit from the second list. What is the smallest positive pretty integer?" 900
869E "The Untended Antiquity" "data structures,hashing" "Adieu l\'ami.Koyomi is helping Oshino, an acquaintance of his, to take care of an open space around the abandoned Eikou Cram School building, Oshino\'s makeshift residence.The space is represented by a rectangular grid of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m cells, arranged into n rows and m columns. The c-th cell in the r-th row is denoted by (r,\xe2\x80\x89c).Oshino places and removes barriers around rectangular areas of cells. Specifically, an action denoted by ""1 r1 c1 r2 c2"" means Oshino\'s placing barriers around a rectangle with two corners being (r1,\xe2\x80\x89c1) and (r2,\xe2\x80\x89c2) and sides parallel to squares sides. Similarly, ""2 r1 c1 r2 c2"" means Oshino\'s removing barriers around the rectangle. Oshino ensures that no barriers staying on the ground share any common points, nor do they intersect with boundaries of the n\xe2\x80\x89\xc3\x97\xe2\x80\x89m area.Sometimes Koyomi tries to walk from one cell to another carefully without striding over barriers, in order to avoid damaging various items on the ground. ""3 r1 c1 r2 c2"" means that Koyomi tries to walk from (r1,\xe2\x80\x89c1) to (r2,\xe2\x80\x89c2) without crossing barriers.And you\'re here to tell Koyomi the feasibility of each of his attempts." 2400
869D "The Overdosing Ubiquity" "brute force,dfs and similar,graphs" "The fundamental prerequisite for justice is not to be correct, but to be strong. That\'s why justice is always the victor.The Cinderswarm Bee. Koyomi knows it.The bees, according to their nature, live in a tree. To be more specific, a complete binary tree with n nodes numbered from 1 to n. The node numbered 1 is the root, and the parent of the i-th (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) node is . Note that, however, all edges in the tree are undirected.Koyomi adds m extra undirected edges to the tree, creating more complication to trick the bees. And you\'re here to count the number of simple paths in the resulting graph, modulo 109\xe2\x80\x89+\xe2\x80\x897. A simple path is an alternating sequence of adjacent nodes and undirected edges, which begins and ends with nodes and does not contain any node more than once. Do note that a single node is also considered a valid simple path under this definition. Please refer to the examples and notes below for instances." 2800
869C "The Intriguing Obsession" combinatorics,dp,math "\xe2\x80\x94 This is not playing but duty as allies of justice, Nii-chan!\xe2\x80\x94 Not allies but justice itself, Onii-chan!With hands joined, go everywhere at a speed faster than our thoughts! This time, the Fire Sisters \xe2\x80\x94 Karen and Tsukihi \xe2\x80\x94 is heading for somewhere they\'ve never reached \xe2\x80\x94 water-surrounded islands!There are three clusters of islands, conveniently coloured red, blue and purple. The clusters consist of a, b and c distinct islands respectively.Bridges have been built between some (possibly all or none) of the islands. A bridge bidirectionally connects two different islands and has length 1. For any two islands of the same colour, either they shouldn\'t be reached from each other through bridges, or the shortest distance between them is at least 3, apparently in order to prevent oddities from spreading quickly inside a cluster.The Fire Sisters are ready for the unknown, but they\'d also like to test your courage. And you\'re here to figure out the number of different ways to build all bridges under the constraints, and give the answer modulo 998\xe2\x80\x89244\xe2\x80\x89353. Two ways are considered different if a pair of islands exist, such that there\'s a bridge between them in one of them, but not in the other." 1800
869B "The Eternal Immortality" math "Even if the world is full of counterfeits, I still regard it as wonderful.Pile up herbs and incense, and arise again from the flames and ashes of its predecessor \xe2\x80\x94 as is known to many, the phoenix does it like this.The phoenix has a rather long lifespan, and reincarnates itself once every a! years. Here a! denotes the factorial of integer a, that is, a!\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x892\xe2\x80\x89\xc3\x97\xe2\x80\x89...\xe2\x80\x89\xc3\x97\xe2\x80\x89a. Specifically, 0!\xe2\x80\x89=\xe2\x80\x891.Koyomi doesn\'t care much about this, but before he gets into another mess with oddities, he is interested in the number of times the phoenix will reincarnate in a timespan of b! years, that is, . Note that when b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89a this value is always integer.As the answer can be quite large, it would be enough for Koyomi just to know the last digit of the answer in decimal representation. And you\'re here to provide Koyomi with this knowledge." 1100
869A "The Artful Expedient" "brute force,implementation" "Rock... Paper!After Karen have found the deterministic winning (losing?) strategy for rock-paper-scissors, her brother, Koyomi, comes up with a new game as a substitute. The game works as follows.A positive integer n is decided first. Both Koyomi and Karen independently choose n distinct positive integers, denoted by x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn and y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn respectively. They reveal their sequences, and repeat until all of 2n integers become distinct, which is the only final state to be kept and considered.Then they count the number of ordered pairs (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that the value xi xor yj equals to one of the 2n integers. Here xor means the bitwise exclusive or operation on two integers, and is denoted by operators ^ and/or xor in most programming languages.Karen claims a win if the number of such pairs is even, and Koyomi does otherwise. And you\'re here to help determine the winner of their latest game." 1100
868G "El Toll Caves" math "The prehistoric caves of El Toll are located in Moi\xc3\xa0 (Barcelona). You have heard that there is a treasure hidden in one of n possible spots in the caves. You assume that each of the spots has probability 1\xe2\x80\x89/\xe2\x80\x89n to contain a treasure.You cannot get into the caves yourself, so you have constructed a robot that can search the caves for treasure. Each day you can instruct the robot to visit exactly k distinct spots in the caves. If none of these spots contain treasure, then the robot will obviously return with empty hands. However, the caves are dark, and the robot may miss the treasure even when visiting the right spot. Formally, if one of the visited spots does contain a treasure, the robot will obtain it with probability 1\xe2\x80\x89/\xe2\x80\x892, otherwise it will return empty. Each time the robot searches the spot with the treasure, his success probability is independent of all previous tries (that is, the probability to miss the treasure after searching the right spot x times is 1\xe2\x80\x89/\xe2\x80\x892x).What is the expected number of days it will take to obtain the treasure if you choose optimal scheduling for the robot? Output the answer as a rational number modulo 109\xe2\x80\x89+\xe2\x80\x897. Formally, let the answer be an irreducible fraction P\xe2\x80\x89/\xe2\x80\x89Q, then you have to output . It is guaranteed that Q is not divisible by 109\xe2\x80\x89+\xe2\x80\x897." 3300
868F "Yet Another Minimization Problem" "divide and conquer,dp" "You are given an array of n integers a1... an. The cost of a subsegment is the number of unordered pairs of distinct indices within the subsegment that contain equal elements. Split the given array into k non-intersecting non-empty subsegments so that the sum of their costs is minimum possible. Each element should be present in exactly one subsegment." 2500
868E "Policeman and a Tree" dp,graphs,trees "You are given a tree (a connected non-oriented graph without cycles) with vertices numbered from 1 to n, and the length of the i-th edge is wi. In the vertex s there is a policeman, in the vertices x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm (xj\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s) m criminals are located.The policeman can walk along the edges with speed 1, the criminals can move with arbitrary large speed. If a criminal at some moment is at the same point as the policeman, he instantly gets caught by the policeman. Determine the time needed for the policeman to catch all criminals, assuming everybody behaves optimally (i.e. the criminals maximize that time, the policeman minimizes that time). Everybody knows positions of everybody else at any moment of time." 2700
868D "Huge Strings" "bitmasks,brute force,dp,implementation,strings" "You are given n strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn consisting of characters 0 and 1. m operations are performed, on each of them you concatenate two existing strings into a new one. On the i-th operation the concatenation saisbi is saved into a new string sn\xe2\x80\x89+\xe2\x80\x89i (the operations are numbered starting from 1). After each operation you need to find the maximum positive integer k such that all possible strings consisting of 0 and 1 of length k (there are 2k such strings) are substrings of the new string. If there is no such k, print 0." 2200
868C "Qualification Rounds" "bitmasks,brute force,constructive algorithms,dp" "Snark and Philip are preparing the problemset for the upcoming pre-qualification round for semi-quarter-finals. They have a bank of n problems, and they want to select any non-empty subset of it as a problemset.k experienced teams are participating in the contest. Some of these teams already know some of the problems. To make the contest interesting for them, each of the teams should know at most half of the selected problems.Determine if Snark and Philip can make an interesting problemset!" 1500
868B "Race Against Time" implementation "Have you ever tried to explain to the coordinator, why it is eight hours to the contest and not a single problem has been prepared yet? Misha had. And this time he has a really strong excuse: he faced a space-time paradox! Space and time replaced each other.The entire universe turned into an enormous clock face with three hands \xe2\x80\x94 hour, minute, and second. Time froze, and clocks now show the time h hours, m minutes, s seconds.Last time Misha talked with the coordinator at t1 o\'clock, so now he stands on the number t1 on the clock face. The contest should be ready by t2 o\'clock. In the terms of paradox it means that Misha has to go to number t2 somehow. Note that he doesn\'t have to move forward only: in these circumstances time has no direction.Clock hands are very long, and Misha cannot get round them. He also cannot step over as it leads to the collapse of space-time. That is, if hour clock points 12 and Misha stands at 11 then he cannot move to 1 along the top arc. He has to follow all the way round the clock center (of course, if there are no other hands on his way).Given the hands\' positions, t1, and t2, find if Misha can prepare the contest on time (or should we say on space?). That is, find if he can move from t1 to t2 by the clock face." 1400
868A "Bark to Unlock" "brute force,implementation,strings" "As technologies develop, manufacturers are making the process of unlocking a phone as user-friendly as possible. To unlock its new phone, Arkady\'s pet dog Mu-mu has to bark the password once. The phone represents a password as a string of two lowercase English letters.Mu-mu\'s enemy Kashtanka wants to unlock Mu-mu\'s phone to steal some sensible information, but it can only bark n distinct words, each of which can be represented as a string of two lowercase English letters. Kashtanka wants to bark several words (not necessarily distinct) one after another to pronounce a string containing the password as a substring. Tell if it\'s possible to unlock the phone in this way, or not." 900
867A "Between the Offices" implementation "As you may know, MemSQL has American offices in both San Francisco and Seattle. Being a manager in the company, you travel a lot between the two cities, always by plane.You prefer flying from Seattle to San Francisco than in the other direction, because it\'s warmer in San Francisco. You are so busy that you don\'t remember the number of flights you have made in either direction. However, for each of the last n days you know whether you were in San Francisco office or in Seattle office. You always fly at nights, so you never were at both offices on the same day. Given this information, determine if you flew more times from Seattle to San Francisco during the last n days, or not." 800
865G "Flowers and Chocolate" combinatorics,math,matrices "It\'s Piegirl\'s birthday soon, and Pieguy has decided to buy her a bouquet of flowers and a basket of chocolates.The flower shop has F different types of flowers available. The i-th type of flower always has exactly pi petals. Pieguy has decided to buy a bouquet consisting of exactly N flowers. He may buy the same type of flower multiple times. The N flowers are then arranged into a bouquet. The position of the flowers within a bouquet matters. You can think of a bouquet as an ordered list of flower types.The chocolate shop sells chocolates in boxes. There are B different types of boxes available. The i-th type of box contains ci pieces of chocolate. Pieguy can buy any number of boxes, and can buy the same type of box multiple times. He will then place these boxes into a basket. The position of the boxes within the basket matters. You can think of the basket as an ordered list of box types.Pieguy knows that Piegirl likes to pluck a petal from a flower before eating each piece of chocolate. He would like to ensure that she eats the last piece of chocolate from the last box just after plucking the last petal from the last flower. That is, the total number of petals on all the flowers in the bouquet should equal the total number of pieces of chocolate in all the boxes in the basket.How many different bouquet+basket combinations can Pieguy buy? The answer may be very large, so compute it modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897." 3300
865F "Egg Roulette" "bitmasks,brute force,divide and conquer,math,meet-in-the-middle" "The game of Egg Roulette is played between two players. Initially 2R raw eggs and 2C cooked eggs are placed randomly into a carton. The shells are left on so there is no way to distinguish a raw egg from a cooked egg. One at a time, a player will select an egg, and then smash the egg on his/her forehead. If the egg was cooked, not much happens, but if the egg was raw, it will make quite the mess. This continues until one player has broken R raw eggs, at which point that player is declared the loser and the other player wins.The order in which players take turns can be described as a string of \'A\' and \'B\' characters, where the i-th character tells which player should choose the i-th egg. Traditionally, players take turns going one after the other. That is, they follow the ordering ""ABABAB..."". This isn\'t very fair though, because the second player will win more often than the first. We\'d like you to find a better ordering for the players to take their turns. Let\'s define the unfairness of an ordering as the absolute difference between the first player\'s win probability and the second player\'s win probability. We\'re interested in orderings that minimize the unfairness. We only consider an ordering valid if it contains the same number of \'A\'s as \'B\'s.You will also be given a string S of length 2(R\xe2\x80\x89+\xe2\x80\x89C) containing only \'A\', \'B\', and \'?\' characters. An ordering is said to match S if it only differs from S in positions where S contains a \'?\'. Of the valid orderings that minimize unfairness, how many match S?" 3300
865E "Hex Dyslexia" "bitmasks,brute force,dp,graphs" "Copying large hexadecimal (base 16) strings by hand can be error prone, but that doesn\'t stop people from doing it. You\'ve discovered a bug in the code that was likely caused by someone making a mistake when copying such a string. You suspect that whoever copied the string did not change any of the digits in the string, nor the length of the string, but may have permuted the digits arbitrarily. For example, if the original string was 0abc they may have changed it to a0cb or 0bca, but not abc or 0abb.Unfortunately you don\'t have access to the original string nor the copied string, but you do know the length of the strings and their numerical absolute difference. You will be given this difference as a hexadecimal string S, which has been zero-extended to be equal in length to the original and copied strings. Determine the smallest possible numerical value of the original string." 3300
865D "Buy Low Sell High" "constructive algorithms,data structures,greedy" "You can perfectly predict the price of a certain stock for the next N days. You would like to profit on this knowledge, but only want to transact one share of stock per day. That is, each day you will either buy one share, sell one share, or do nothing. Initially you own zero shares, and you cannot sell shares when you don\'t own any. At the end of the N days you would like to again own zero shares, but want to have as much money as possible." 2400
865C "Gotta Go Fast" "binary search,dp" "You\'re trying to set the record on your favorite video game. The game consists of N levels, which must be completed sequentially in order to beat the game. You usually complete each level as fast as possible, but sometimes finish a level slower. Specifically, you will complete the i-th level in either Fi seconds or Si seconds, where Fi\xe2\x80\x89<\xe2\x80\x89Si, and there\'s a Pi percent chance of completing it in Fi seconds. After completing a level, you may decide to either continue the game and play the next level, or reset the game and start again from the first level. Both the decision and the action are instant.Your goal is to complete all the levels sequentially in at most R total seconds. You want to minimize the expected amount of time playing before achieving that goal. If you continue and reset optimally, how much total time can you expect to spend playing?" 2400
865B "Ordering Pizza" "binary search,sortings,ternary search" "It\'s another Start[c]up finals, and that means there is pizza to order for the onsite contestants. There are only 2 types of pizza (obviously not, but let\'s just pretend for the sake of the problem), and all pizzas contain exactly S slices.It is known that the i-th contestant will eat si slices of pizza, and gain ai happiness for each slice of type 1 pizza they eat, and bi happiness for each slice of type 2 pizza they eat. We can order any number of type 1 and type 2 pizzas, but we want to buy the minimum possible number of pizzas for all of the contestants to be able to eat their required number of slices. Given that restriction, what is the maximum possible total happiness that can be achieved?" 1900
865A "Save the problem!" "constructive algorithms" "Attention: we lost all the test cases for this problem, so instead of solving the problem, we need you to generate test cases. We\'re going to give you the answer, and you need to print a test case that produces the given answer. The original problem is in the following paragraph.People don\'t use cash as often as they used to. Having a credit card solves some of the hassles of cash, such as having to receive change when you can\'t form the exact amount of money needed to purchase an item. Typically cashiers will give you as few coins as possible in change, but they don\'t have to. For example, if your change is 30 cents, a cashier could give you a 5 cent piece and a 25 cent piece, or they could give you three 10 cent pieces, or ten 1 cent pieces, two 5 cent pieces, and one 10 cent piece. Altogether there are 18 different ways to make 30 cents using only 1 cent pieces, 5 cent pieces, 10 cent pieces, and 25 cent pieces. Two ways are considered different if they contain a different number of at least one type of coin. Given the denominations of the coins and an amount of change to be made, how many different ways are there to make change?As we mentioned before, we lost all the test cases for this problem, so we\'re actually going to give you the number of ways, and want you to produce a test case for which the number of ways is the given number. There could be many ways to achieve this (we guarantee there\'s always at least one), so you can print any, as long as it meets the constraints described below." 1400
864F "Cities Excursions" "dfs and similar,graphs,trees" "There are n cities in Berland. Some pairs of them are connected with m directed roads. One can use only these roads to move from one city to another. There are no roads that connect a city to itself. For each pair of cities (x,\xe2\x80\x89y) there is at most one road from x to y.A path from city s to city t is a sequence of cities p1, p2, ... , pk, where p1\xe2\x80\x89=\xe2\x80\x89s, pk\xe2\x80\x89=\xe2\x80\x89t, and there is a road from city pi to city pi\xe2\x80\x89+\xe2\x80\x891 for each i from 1 to k\xe2\x80\x89-\xe2\x80\x891. The path can pass multiple times through each city except t. It can\'t pass through t more than once.A path p from s to t is ideal if it is the lexicographically minimal such path. In other words, p is ideal path from s to t if for any other path q from s to t pi\xe2\x80\x89<\xe2\x80\x89qi, where i is the minimum integer such that pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89qi.There is a tourist agency in the country that offers q unusual excursions: the j-th excursion starts at city sj and ends in city tj. For each pair sj, tj help the agency to study the ideal path from sj to tj. Note that it is possible that there is no ideal path from sj to tj. This is possible due to two reasons:   there is no path from sj to tj;  there are paths from sj to tj, but for every such path p there is another path q from sj to tj, such that pi\xe2\x80\x89>\xe2\x80\x89qi, where i is the minimum integer for which pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89qi. The agency would like to know for the ideal path from sj to tj the kj-th city in that path (on the way from sj to tj).For each triple sj, tj, kj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89q) find if there is an ideal path from sj to tj and print the kj-th city in that path, if there is any." 2700
864E Fire dp,sortings "Polycarp is in really serious trouble \xe2\x80\x94 his house is on fire! It\'s time to save the most valuable items. Polycarp estimated that it would take ti seconds to save i-th item. In addition, for each item, he estimated the value of di \xe2\x80\x94 the moment after which the item i will be completely burned and will no longer be valuable for him at all. In particular, if ti\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89di, then i-th item cannot be saved.Given the values pi for each of the items, find a set of items that Polycarp can save such that the total value of this items is maximum possible. Polycarp saves the items one after another. For example, if he takes item a first, and then item b, then the item a will be saved in ta seconds, and the item b \xe2\x80\x94 in ta\xe2\x80\x89+\xe2\x80\x89tb seconds after fire started." 2000
864D "Make a Permutation!" greedy,implementation,math "Ivan has an array consisting of n elements. Each of the elements is an integer from 1 to n.Recently Ivan learned about permutations and their lexicographical order. Now he wants to change (replace) minimum number of elements in his array in such a way that his array becomes a permutation (i.e. each of the integers from 1 to n was encountered in his array exactly once). If there are multiple ways to do it he wants to find the lexicographically minimal permutation among them.Thus minimizing the number of changes has the first priority, lexicographical minimizing has the second priority.In order to determine which of the two permutations is lexicographically smaller, we compare their first elements. If they are equal \xe2\x80\x94 compare the second, and so on. If we have two permutations x and y, then x is lexicographically smaller if xi\xe2\x80\x89<\xe2\x80\x89yi, where i is the first index in which the permutations x and y differ.Determine the array Ivan will obtain after performing all the changes." 1500
864C Bus greedy,implementation,math "A bus moves along the coordinate line Ox from the point x\xe2\x80\x89=\xe2\x80\x890 to the point x\xe2\x80\x89=\xe2\x80\x89a. After starting from the point x\xe2\x80\x89=\xe2\x80\x890, it reaches the point x\xe2\x80\x89=\xe2\x80\x89a, immediately turns back and then moves to the point x\xe2\x80\x89=\xe2\x80\x890. After returning to the point x\xe2\x80\x89=\xe2\x80\x890 it immediately goes back to the point x\xe2\x80\x89=\xe2\x80\x89a and so on. Thus, the bus moves from x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89a and back. Moving from the point x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89a or from the point x\xe2\x80\x89=\xe2\x80\x89a to x\xe2\x80\x89=\xe2\x80\x890 is called a bus journey. In total, the bus must make k journeys.The petrol tank of the bus can hold b liters of gasoline. To pass a single unit of distance the bus needs to spend exactly one liter of gasoline. The bus starts its first journey with a full petrol tank.There is a gas station in point x\xe2\x80\x89=\xe2\x80\x89f. This point is between points x\xe2\x80\x89=\xe2\x80\x890 and x\xe2\x80\x89=\xe2\x80\x89a. There are no other gas stations on the bus route. While passing by a gas station in either direction the bus can stop and completely refuel its tank. Thus, after stopping to refuel the tank will contain b liters of gasoline.What is the minimum number of times the bus needs to refuel at the point x\xe2\x80\x89=\xe2\x80\x89f to make k journeys? The first journey starts in the point x\xe2\x80\x89=\xe2\x80\x890." 1500
864B "Polycarp and Letters" "brute force,implementation,strings" "Polycarp loves lowercase letters and dislikes uppercase ones. Once he got a string s consisting only of lowercase and uppercase Latin letters.Let A be a set of positions in the string. Let\'s call it pretty if following conditions are met:  letters on positions from A in the string are all distinct and lowercase;  there are no uppercase letters in the string which are situated between positions from A (i.e. there is no such j that s[j] is an uppercase letter, and a1\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89a2 for some a1 and a2 from A). Write a program that will determine the maximum number of elements in a pretty set of positions." 1000
864A "Fair Game" implementation,sortings "Petya and Vasya decided to play a game. They have n cards (n is an even number). A single integer is written on each card.Before the game Petya will choose an integer and after that Vasya will choose another integer (different from the number that Petya chose). During the game each player takes all the cards with number he chose. For example, if Petya chose number 5 before the game he will take all cards on which 5 is written and if Vasya chose number 10 before the game he will take all cards on which 10 is written.The game is considered fair if Petya and Vasya can take all n cards, and the number of cards each player gets is the same.Determine whether Petya and Vasya can choose integer numbers before the game so that the game is fair." 1000
863G "Graphic Settings" NA "Recently Ivan bought a new computer. Excited, he unpacked it and installed his favourite game. With his old computer Ivan had to choose the worst possible graphic settings (because otherwise the framerate would be really low), but now he wants to check, maybe his new computer can perform well even with the best possible graphics?There are m graphics parameters in the game. i-th parameter can be set to any positive integer from 1 to ai, and initially is set to bi (bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai). So there are  different combinations of parameters. Ivan can increase or decrease any of these parameters by 1; after that the game will be restarted with new parameters (and Ivan will have the opportunity to check chosen combination of parameters).Ivan wants to try all p possible combinations. Also he wants to return to the initial settings after trying all combinations, because he thinks that initial settings can be somehow best suited for his hardware. But Ivan doesn\'t really want to make a lot of restarts.So he wants you to tell the following:  If there exists a way to make exactly p changes (each change either decreases or increases some parameter by 1) to try all possible combinations and return to initial combination, then Ivan wants to know this way.  Otherwise, if there exists a way to make exactly p\xe2\x80\x89-\xe2\x80\x891 changes to try all possible combinations (including the initial one), then Ivan wants to know this way. Help Ivan by showing him the way to change parameters!" 3200
863F "Almost Permutation" flows "Recently Ivan noticed an array a while debugging his code. Now Ivan can\'t remember this array, but the bug he was trying to fix didn\'t go away, so Ivan thinks that the data from this array might help him to reproduce the bug.Ivan clearly remembers that there were n elements in the array, and each element was not less than 1 and not greater than n. Also he remembers q facts about the array. There are two types of facts that Ivan remembers:  1 li ri vi \xe2\x80\x94 for each x such that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri ax\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89vi;  2 li ri vi \xe2\x80\x94 for each x such that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri ax\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89vi. Also Ivan thinks that this array was a permutation, but he is not so sure about it. He wants to restore some array that corresponds to the q facts that he remembers and is very similar to permutation. Formally, Ivan has denoted the cost of array as follows:, where cnt(i) is the number of occurences of i in the array.Help Ivan to determine minimum possible cost of the array that corresponds to the facts!" 2200
863E "Turn Off The TV" "data structures,sortings" "Luba needs your help again! Luba has n TV sets. She knows that i-th TV set will be working from moment of time li till moment ri, inclusive.Luba wants to switch off one of TV sets in order to free the socket. Let\'s call some TV set redundant if after switching it off the number of integer moments of time when at least one of TV sets is working won\'t decrease. Luba will be very upset if she has to switch off a non-redundant TV set.Help Luba by telling her the index of some redundant TV set. If there is no any, print -1." 2000
863D "Yet Another Array Queries Problem" "data structures,implementation" "You are given an array a of size n, and q queries to it. There are queries of two types:   1 li ri \xe2\x80\x94 perform a cyclic shift of the segment [li,\xe2\x80\x89ri] to the right. That is, for every x such that li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89ri new value of ax\xe2\x80\x89+\xe2\x80\x891 becomes equal to old value of ax, and new value of ali becomes equal to old value of ari;  2 li ri \xe2\x80\x94 reverse the segment [li,\xe2\x80\x89ri].  There are m important indices in the array b1, b2, ..., bm. For each i such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m you have to output the number that will have index bi in the array after all queries are performed." 1800
863C 1-2-3 graphs,implementation "Ilya is working for the company that constructs robots. Ilya writes programs for entertainment robots, and his current project is ""Bob"", a new-generation game robot. Ilya\'s boss wants to know his progress so far. Especially he is interested if Bob is better at playing different games than the previous model, ""Alice"". So now Ilya wants to compare his robots\' performance in a simple game called ""1-2-3"". This game is similar to the ""Rock-Paper-Scissors"" game: both robots secretly choose a number from the set {1,\xe2\x80\x892,\xe2\x80\x893} and say it at the same moment. If both robots choose the same number, then it\'s a draw and noone gets any points. But if chosen numbers are different, then one of the robots gets a point: 3 beats 2, 2 beats 1 and 1 beats 3. Both robots\' programs make them choose their numbers in such a way that their choice in (i\xe2\x80\x89+\xe2\x80\x891)-th game depends only on the numbers chosen by them in i-th game. Ilya knows that the robots will play k games, Alice will choose number a in the first game, and Bob will choose b in the first game. He also knows both robots\' programs and can tell what each robot will choose depending on their choices in previous game. Ilya doesn\'t want to wait until robots play all k games, so he asks you to predict the number of points they will have after the final game." 1800
863B Kayaking "brute force,greedy,sortings" "Vadim is really keen on travelling. Recently he heard about kayaking activity near his town and became very excited about it, so he joined a party of kayakers.Now the party is ready to start its journey, but firstly they have to choose kayaks. There are 2\xc2\xb7n people in the group (including Vadim), and they have exactly n\xe2\x80\x89-\xe2\x80\x891 tandem kayaks (each of which, obviously, can carry two people) and 2 single kayaks. i-th person\'s weight is wi, and weight is an important matter in kayaking \xe2\x80\x94 if the difference between the weights of two people that sit in the same tandem kayak is too large, then it can crash. And, of course, people want to distribute their seats in kayaks in order to minimize the chances that kayaks will crash.Formally, the instability of a single kayak is always 0, and the instability of a tandem kayak is the absolute difference between weights of the people that are in this kayak. Instability of the whole journey is the total instability of all kayaks.Help the party to determine minimum possible total instability!" 1500
863A Quasi-palindrome "brute force,implementation" "Let quasi-palindromic number be such number that adding some leading zeros (possible none) to it produces a palindromic string. String t is called a palindrome, if it reads the same from left to right and from right to left.For example, numbers 131 and 2010200 are quasi-palindromic, they can be transformed to strings ""131"" and ""002010200"", respectively, which are palindromes.You are given some integer number x. Check if it\'s a quasi-palindromic number." 900
862F "Mahmoud and Ehab and the final stage" "data structures,strings" "Mahmoud and Ehab solved Dr. Evil\'s questions so he gave them the password of the door of the evil land. When they tried to open the door using it, the door gave them a final question to solve before they leave (yes, the door is digital, Dr. Evil is modern). If they don\'t solve it, all the work will be useless and they won\'t leave the evil land forever. Will you help them?Mahmoud and Ehab are given n strings s1,\xe2\x80\x89s2,\xe2\x80\x89... ,\xe2\x80\x89sn numbered from 1 to n and q queries, Each query has one of the following forms:  1 a b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), For all the intervals [l;r] where (a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b) find the maximum value of this expression:(r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89*\xe2\x80\x89LCP(sl,\xe2\x80\x89sl\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89sr\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89sr) where LCP(str1,\xe2\x80\x89str2,\xe2\x80\x89str3,\xe2\x80\x89... ) is the length of the longest common prefix of the strings str1,\xe2\x80\x89str2,\xe2\x80\x89str3,\xe2\x80\x89... . 2 x y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) where y is a string, consisting of lowercase English letters. Change the string at position x to y." 2900
862E "Mahmoud and Ehab and the function" "binary search,data structures,sortings" "Dr. Evil is interested in math and functions, so he gave Mahmoud and Ehab array a of length n and array b of length m. He introduced a function f(j) which is defined for integers j, which satisfy 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x89n. Suppose, ci\xe2\x80\x89=\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x89j. Then f(j)\xe2\x80\x89=\xe2\x80\x89|c1\xe2\x80\x89-\xe2\x80\x89c2\xe2\x80\x89+\xe2\x80\x89c3\xe2\x80\x89-\xe2\x80\x89c4... cn|. More formally, . Dr. Evil wants Mahmoud and Ehab to calculate the minimum value of this function over all valid j. They found it a bit easy, so Dr. Evil made their task harder. He will give them q update queries. During each update they should add an integer xi to all elements in a in range [li;ri] i.e. they should add xi to ali,\xe2\x80\x89ali\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89... ,\xe2\x80\x89ari and then they should calculate the minimum value of f(j) for all valid j.Please help Mahmoud and Ehab." 2100
862D "Mahmoud and Ehab and the binary string" "binary search,divide and conquer,interactive" "Mahmoud and Ehab are in the fourth stage now.Dr. Evil has a hidden binary string of length n. He guarantees that there is at least one \'0\' symbol and at least one \'1\' symbol in it. Now he wants Mahmoud and Ehab to find a position of any \'0\' symbol and any \'1\' symbol. In order to do this, Mahmoud and Ehab can ask Dr. Evil up to 15 questions. They tell Dr. Evil some binary string of length n, and Dr. Evil tells the Hamming distance between these two strings. Hamming distance between 2 binary strings of the same length is the number of positions in which they have different symbols. You can find the definition of Hamming distance in the notes section below.Help Mahmoud and Ehab find these two positions.You will get Wrong Answer verdict if   Your queries doesn\'t satisfy interaction protocol described below.  You ask strictly more than 15 questions and your program terminated after exceeding queries limit. Please note, that you can do up to 15 ask queries and one answer query.  Your final answer is not correct.  You will get Idleness Limit Exceeded if you don\'t print anything or if you forget to flush the output, including for the final answer (more info about flushing output below).If you exceed the maximum number of queries, You should terminate with 0, In this case you\'ll get Wrong Answer, If you don\'t terminate you may receive any verdict because you\'ll be reading from a closed stream ." 2000
862C "Mahmoud and Ehab and the xor" "constructive algorithms" "Mahmoud and Ehab are on the third stage of their adventures now. As you know, Dr. Evil likes sets. This time he won\'t show them any set from his large collection, but will ask them to create a new set to replenish his beautiful collection of sets.Dr. Evil has his favorite evil integer x. He asks Mahmoud and Ehab to find a set of n distinct non-negative integers such the bitwise-xor sum of the integers in it is exactly x. Dr. Evil doesn\'t like big numbers, so any number in the set shouldn\'t be greater than 106." 1900
862B "Mahmoud and Ehab and the bipartiteness" "dfs and similar,graphs,trees" "Mahmoud and Ehab continue their adventures! As everybody in the evil land knows, Dr. Evil likes bipartite graphs, especially trees.A tree is a connected acyclic graph. A bipartite graph is a graph, whose vertices can be partitioned into 2 sets in such a way, that for each edge (u,\xe2\x80\x89v) that belongs to the graph, u and v belong to different sets. You can find more formal definitions of a tree and a bipartite graph in the notes section below.Dr. Evil gave Mahmoud and Ehab a tree consisting of n nodes and asked them to add edges to it in such a way, that the graph is still bipartite. Besides, after adding these edges the graph should be simple (doesn\'t contain loops or multiple edges). What is the maximum number of edges they can add?A loop is an edge, which connects a node with itself. Graph doesn\'t contain multiple edges when for each pair of nodes there is no more than one edge between them. A cycle and a loop aren\'t the same ." 1300
862A "Mahmoud and Ehab and the MEX" greedy,implementation "Dr. Evil kidnapped Mahmoud and Ehab in the evil land because of their performance in the Evil Olympiad in Informatics (EOI). He decided to give them some problems to let them go.Dr. Evil is interested in sets, He has a set of n integers. Dr. Evil calls a set of integers evil if the MEX of it is exactly x. the MEX of a set of integers is the minimum non-negative integer that doesn\'t exist in it. For example, the MEX of the set {0,\xe2\x80\x892,\xe2\x80\x894} is 1 and the MEX of the set {1,\xe2\x80\x892,\xe2\x80\x893} is 0 .Dr. Evil is going to make his set evil. To do this he can perform some operations. During each operation he can add some non-negative integer to his set or erase some element from it. What is the minimal number of operations Dr. Evil has to perform to make his set evil?" 1000
860E "Arkady and a Nobody-men" "data structures,dfs and similar,trees" "Arkady words in a large company. There are n employees working in a system of a strict hierarchy. Namely, each employee, with an exception of the CEO, has exactly one immediate manager. The CEO is a manager (through a chain of immediate managers) of all employees.Each employee has an integer rank. The CEO has rank equal to 1, each other employee has rank equal to the rank of his immediate manager plus 1.Arkady has a good post in the company, however, he feels that he is nobody in the company\'s structure, and there are a lot of people who can replace him. He introduced the value of replaceability. Consider an employee a and an employee b, the latter being manager of a (not necessarily immediate). Then the replaceability r(a,\xe2\x80\x89b) of a with respect to b is the number of subordinates (not necessarily immediate) of the manager b, whose rank is not greater than the rank of a. Apart from replaceability, Arkady introduced the value of negligibility. The negligibility za of employee a equals the sum of his replaceabilities with respect to all his managers, i.e. , where the sum is taken over all his managers b.Arkady is interested not only in negligibility of himself, but also in negligibility of all employees in the company. Find the negligibility of each employee for Arkady." 2700
859G "Circle of Numbers" math "n evenly spaced points have been marked around the edge of a circle. There is a number written at each point. You choose a positive real number k. Then you may repeatedly select a set of 2 or more points which are evenly spaced, and either increase all numbers at points in the set by k or decrease all numbers at points in the set by k. You would like to eventually end up with all numbers equal to 0. Is it possible?A set of 2 points is considered evenly spaced if they are diametrically opposed, and a set of 3 or more points is considered evenly spaced if they form a regular polygon." 3000
859F "Ordering T-Shirts" greedy "It\'s another Start[c]up, and that means there are T-shirts to order. In order to make sure T-shirts are shipped as soon as possible, we\'ve decided that this year we\'re going to order all of the necessary T-shirts before the actual competition. The top C contestants are going to be awarded T-shirts, but we obviously don\'t know which contestants that will be. The plan is to get the T-Shirt sizes of all contestants before the actual competition, and then order enough T-shirts so that no matter who is in the top C we\'ll have T-shirts available in order to award them.In order to get the T-shirt sizes of the contestants, we will send out a survey. The survey will allow contestants to either specify a single desired T-shirt size, or two adjacent T-shirt sizes. If a contestant specifies two sizes, it means that they can be awarded either size.As you can probably tell, this plan could require ordering a lot of unnecessary T-shirts. We\'d like your help to determine the minimum number of T-shirts we\'ll need to order to ensure that we\'ll be able to award T-shirts no matter the outcome of the competition." 2800
859E "Desk Disorder" "combinatorics,dfs and similar,dsu,graphs,trees" "A new set of desks just arrived, and it\'s about time! Things were getting quite cramped in the office. You\'ve been put in charge of creating a new seating chart for the engineers. The desks are numbered, and you sent out a survey to the engineering team asking each engineer the number of the desk they currently sit at, and the number of the desk they would like to sit at (which may be the same as their current desk). Each engineer must either remain where they sit, or move to the desired seat they indicated in the survey. No two engineers currently sit at the same desk, nor may any two engineers sit at the same desk in the new seating arrangement.How many seating arrangements can you create that meet the specified requirements? The answer may be very large, so compute it modulo 1000000007\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897." 2100
859D "Third Month Insanity" dp,probabilities,trees "The annual college sports-ball tournament is approaching, which for trademark reasons we\'ll refer to as Third Month Insanity. There are a total of 2N teams participating in the tournament, numbered from 1 to 2N. The tournament lasts N rounds, with each round eliminating half the teams. The first round consists of 2N\xe2\x80\x89-\xe2\x80\x891 games, numbered starting from 1. In game i, team 2\xc2\xb7i\xe2\x80\x89-\xe2\x80\x891 will play against team 2\xc2\xb7i. The loser is eliminated and the winner advances to the next round (there are no ties). Each subsequent round has half as many games as the previous round, and in game i the winner of the previous round\'s game 2\xc2\xb7i\xe2\x80\x89-\xe2\x80\x891 will play against the winner of the previous round\'s game 2\xc2\xb7i.Every year the office has a pool to see who can create the best bracket. A bracket is a set of winner predictions for every game. For games in the first round you may predict either team to win, but for games in later rounds the winner you predict must also be predicted as a winner in the previous round. Note that the bracket is fully constructed before any games are actually played. Correct predictions in the first round are worth 1 point, and correct predictions in each subsequent round are worth twice as many points as the previous, so correct predictions in the final game are worth 2N\xe2\x80\x89-\xe2\x80\x891 points.For every pair of teams in the league, you have estimated the probability of each team winning if they play against each other. Now you want to construct a bracket with the maximum possible expected score." 2100
859C "Pie Rules" dp,games "You may have heard of the pie rule before. It states that if two people wish to fairly share a slice of pie, one person should cut the slice in half, and the other person should choose who gets which slice. Alice and Bob have many slices of pie, and rather than cutting the slices in half, each individual slice will be eaten by just one person.The way Alice and Bob decide who eats each slice is as follows. First, the order in which the pies are to be handed out is decided. There is a special token called the ""decider"" token, initially held by Bob. Until all the pie is handed out, whoever has the decider token will give the next slice of pie to one of the participants, and the decider token to the other participant. They continue until no slices of pie are left.All of the slices are of excellent quality, so each participant obviously wants to maximize the total amount of pie they get to eat. Assuming both players make their decisions optimally, how much pie will each participant receive?" 1500
859B "Lazy Security Guard" "brute force,geometry,math" "Your security guard friend recently got a new job at a new security company. The company requires him to patrol an area of the city encompassing exactly N city blocks, but they let him choose which blocks. That is, your friend must walk the perimeter of a region whose area is exactly N blocks. Your friend is quite lazy and would like your help to find the shortest possible route that meets the requirements. The city is laid out in a square grid pattern, and is large enough that for the sake of the problem it can be considered infinite." 1000
859A "Declined Finalists" greedy,implementation "This year, as in previous years, MemSQL is inviting the top 25 competitors from the Start[c]up qualification round to compete onsite for the final round. Not everyone who is eligible to compete onsite can afford to travel to the office, though. Initially the top 25 contestants are invited to come onsite. Each eligible contestant must either accept or decline the invitation. Whenever a contestant declines, the highest ranked contestant not yet invited is invited to take the place of the one that declined. This continues until 25 contestants have accepted invitations.After the qualifying round completes, you know K of the onsite finalists, as well as their qualifying ranks (which start at 1, there are no ties). Determine the minimum possible number of contestants that declined the invitation to compete onsite in the final round." 800
858F "Wizard\'s Tour" "constructive algorithms,dfs and similar,graphs" "All Berland residents are waiting for an unprecedented tour of wizard in his Blue Helicopter over the cities of Berland!It is well-known that there are n cities in Berland, some pairs of which are connected by bidirectional roads. Each pair of cities is connected by no more than one road. It is not guaranteed that the road network is connected, i.e. it is possible that you can\'t reach some city from some other.The tour will contain several episodes. In each of the episodes:  the wizard will disembark at some city x from the Helicopter;  he will give a performance and show a movie for free at the city x;  he will drive to some neighboring city y using a road;  he will give a performance and show a movie for free at the city y;  he will drive to some neighboring to y city z;  he will give a performance and show a movie for free at the city z;  he will embark the Helicopter and fly away from the city z. It is known that the wizard doesn\'t like to use roads, so he agrees to use each road at most once (regardless of direction). In other words, for road between a and b he only can drive once from a to b, or drive once from b to a, or do not use this road at all.The wizards wants to plan as many episodes as possible without violation the above rules. Help the wizard!Please note that the wizard can visit the same city multiple times, the restriction is on roads only." 2300
858E "Tests Renumeration" greedy,implementation "The All-Berland National Olympiad in Informatics has just ended! Now Vladimir wants to upload the contest from the Olympiad as a gym to a popular Codehorses website.Unfortunately, the archive with Olympiad\'s data is a mess. For example, the files with tests are named arbitrary without any logic.Vladimir wants to rename the files with tests so that their names are distinct integers starting from 1 without any gaps, namely, ""1"", ""2"", ..., ""n\', where n is the total number of tests.Some of the files contain tests from statements (examples), while others contain regular tests. It is possible that there are no examples, and it is possible that all tests are examples. Vladimir wants to rename the files so that the examples are the first several tests, all all the next files contain regular tests only.The only operation Vladimir can perform is the ""move"" command. Vladimir wants to write a script file, each of the lines in which is ""move file_1 file_2"", that means that the file ""file_1"" is to be renamed to ""file_2"". If there is a file ""file_2"" at the moment of this line being run, then this file is to be rewritten. After the line ""move file_1 file_2"" the file ""file_1"" doesn\'t exist, but there is a file ""file_2"" with content equal to the content of ""file_1"" before the ""move"" command.Help Vladimir to write the script file with the minimum possible number of lines so that after this script is run:  all examples are the first several tests having filenames ""1"", ""2"", ..., ""e"", where e is the total number of examples;  all other files contain regular tests with filenames ""e\xe2\x80\x89+\xe2\x80\x891"", ""e\xe2\x80\x89+\xe2\x80\x892"", ..., ""n"", where n is the total number of all tests." 2200
858D "Polycarp\'s phone book" "data structures,implementation,sortings" "There are n phone numbers in Polycarp\'s contacts on his phone. Each number is a 9-digit integer, starting with a digit different from 0. All the numbers are distinct.There is the latest version of Berdroid OS installed on Polycarp\'s phone. If some number is entered, is shows up all the numbers in the contacts for which there is a substring equal to the entered sequence of digits. For example, is there are three phone numbers in Polycarp\'s contacts: 123456789, 100000000 and 100123456, then:  if he enters 00 two numbers will show up: 100000000 and 100123456,  if he enters 123 two numbers will show up 123456789 and 100123456,  if he enters 01 there will be only one number 100123456. For each of the phone numbers in Polycarp\'s contacts, find the minimum in length sequence of digits such that if Polycarp enters this sequence, Berdroid shows this only phone number." 1600
858C "Did you mean..." dp,greedy,implementation "Beroffice text editor has a wide range of features that help working with text. One of the features is an automatic search for typos and suggestions of how to fix them.Beroffice works only with small English letters (i.e. with 26 letters from a to z). Beroffice thinks that a word is typed with a typo if there are three or more consonants in a row in the word. The only exception is that if the block of consonants has all letters the same, then this block (even if its length is greater than three) is not considered a typo. Formally, a word is typed with a typo if there is a block of not less that three consonants in a row, and there are at least two different letters in this block.For example:  the following words have typos: ""hellno"", ""hackcerrs"" and ""backtothefutttture"";  the following words don\'t have typos: ""helllllooooo"", ""tobeornottobe"" and ""oooooo"". When Beroffice editor finds a word with a typo, it inserts as little as possible number of spaces in this word (dividing it into several words) in such a way that each of the resulting words is typed without any typos.Implement this feature of Beroffice editor. Consider the following letters as the only vowels: \'a\', \'e\', \'i\', \'o\' and \'u\'. All the other letters are consonants in this problem." 1500
858B "Which floor?" "brute force,implementation" "In a building where Polycarp lives there are equal number of flats on each floor. Unfortunately, Polycarp don\'t remember how many flats are on each floor, but he remembers that the flats are numbered from 1 from lower to upper floors. That is, the first several flats are on the first floor, the next several flats are on the second and so on. Polycarp don\'t remember the total number of flats in the building, so you can consider the building to be infinitely high (i.e. there are infinitely many floors). Note that the floors are numbered from 1.Polycarp remembers on which floors several flats are located. It is guaranteed that this information is not self-contradictory. It means that there exists a building with equal number of flats on each floor so that the flats from Polycarp\'s memory have the floors Polycarp remembers.Given this information, is it possible to restore the exact floor for flat n?" 1500
858A k-rounding "brute force,math,number theory" "For a given positive integer n denote its k-rounding as the minimum positive integer x, such that x ends with k or more zeros in base 10 and is divisible by n.For example, 4-rounding of 375 is 375\xc2\xb780\xe2\x80\x89=\xe2\x80\x8930000. 30000 is the minimum integer such that it ends with 4 or more zeros and is divisible by 375.Write a program that will perform the k-rounding of n." 1100
856F "To Play or not to Play" greedy "Vasya and Petya are playing an online game. As most online games, it has hero progress system that allows players to gain experience that make their heroes stronger. Of course, Vasya would like to get as many experience points as possible. After careful study of experience points allocation, he found out that if he plays the game alone, he gets one experience point each second. However, if two players are playing together, and their current experience values differ by at most C points, they can boost their progress, and each of them gets 2 experience points each second.Since Vasya and Petya are middle school students, their parents don\'t allow them to play all the day around. Each of the friends has his own schedule: Vasya can only play during intervals [a1;b1],\xe2\x80\x89[a2;b2],\xe2\x80\x89...,\xe2\x80\x89[an;bn], and Petya can only play during intervals [c1;d1],\xe2\x80\x89[c2;d2],\xe2\x80\x89...,\xe2\x80\x89[cm;dm]. All time periods are given in seconds from the current moment. Vasya is good in math, so he has noticed that sometimes it can be profitable not to play alone, because experience difference could become too big, and progress would not be boosted even when played together.Now they would like to create such schedule of playing that Vasya\'s final experience was greatest possible. The current players experience is the same. Petya is not so concerned about his experience, so he is ready to cooperate and play when needed to maximize Vasya\'s experience." 3000
856E Satellites NA "Real Cosmic Communications is the largest telecommunication company on a far far away planet, located at the very edge of the universe. RCC launches communication satellites.The planet is at the very edge of the universe, so its form is half of a circle. Its radius is r, the ends of its diameter are points A and B. The line AB is the edge of the universe, so one of the half-planes contains nothing, neither the planet, nor RCC satellites, nor anything else. Let us introduce coordinates in the following way: the origin is at the center of AB segment, OX axis coincides with line AB, the planet is completely in y\xe2\x80\x89>\xe2\x80\x890 half-plane.The satellite can be in any point of the universe, except the planet points. Satellites are never located beyond the edge of the universe, nor on the edge itself \xe2\x80\x94 that is, they have coordinate y\xe2\x80\x89>\xe2\x80\x890. Satellite antennas are directed in such way that they cover the angle with the vertex in the satellite, and edges directed to points A and B. Let us call this area the satellite coverage area. The picture below shows coordinate system and coverage area of a satellite.  When RCC was founded there were no satellites around the planet. Since then there have been several events of one of the following types:   1 x y \xe2\x80\x94 launch the new satellite and put it to the point (x,\xe2\x80\x89y). Satellites never move and stay at the point they were launched. Let us assign the number i to the i-th satellite in order of launching, starting from one.  2 i \xe2\x80\x94 remove satellite number i.  3 i j \xe2\x80\x94 make an attempt to create a communication channel between satellites i and j. To create a communication channel a repeater is required. It must not be located inside the planet, but can be located at its half-circle border, or above it. Repeater must be in coverage area of both satellites i and j. To avoid signal interference, it must not be located in coverage area of any other satellite. Of course, the repeater must be within the universe, it must have a coordinate y\xe2\x80\x89>\xe2\x80\x890. For each attempt to create a communication channel you must find out whether it is possible.Sample test has the following satellites locations:" 3100
856D "Masha and Cactus" dp,trees "Masha is fond of cacti. When she was a little girl, she decided to plant a tree. Now Masha wants to make a nice cactus out of her tree.Recall that tree is a connected undirected graph that has no cycles. Cactus is a connected undirected graph such that each vertex belongs to at most one cycle.Masha has some additional edges that she can add to a tree. For each edge she knows which vertices it would connect and the beauty of this edge. Masha can add some of these edges to the graph if the resulting graph is a cactus. Beauty of the resulting cactus is sum of beauties of all added edges. Help Masha find out what maximum beauty of the resulting cactus she can achieve." 2400
856C "Eleventh Birthday" combinatorics,dp,math "It is Borya\'s eleventh birthday, and he has got a great present: n cards with numbers. The i-th card has the number ai written on it. Borya wants to put his cards in a row to get one greater number. For example, if Borya has cards with numbers 1, 31, and 12, and he puts them in a row in this order, he would get a number 13112.He is only 11, but he already knows that there are n! ways to put his cards in a row. But today is a special day, so he is only interested in such ways that the resulting big number is divisible by eleven. So, the way from the previous paragraph is good, because 13112\xe2\x80\x89=\xe2\x80\x891192\xe2\x80\x89\xc3\x97\xe2\x80\x8911, but if he puts the cards in the following order: 31, 1, 12, he would get a number 31112, it is not divisible by 11, so this way is not good for Borya. Help Borya to find out how many good ways to put the cards are there.Borya considers all cards different, even if some of them contain the same number. For example, if Borya has two cards with 1 on it, there are two good ways.Help Borya, find the number of good ways to put the cards. This number can be large, so output it modulo 998244353." 2400
856B "Similar Words" dp,hashing,strings,trees "Let us call a non-empty sequence of lowercase English letters a word. Prefix of a word x is a word y that can be obtained from x by removing zero or more last letters of x.Let us call two words similar, if one of them can be obtained from the other by removing its first letter.You are given a set S of words. Find the maximal possible size of set of non-empty words X such that they satisfy the following:   each word of X is prefix of some word from S;  X has no similar words." 2300
856A "Set Theory" "brute force,constructive algorithms" "Masha and Grisha like studying sets of positive integers.One day Grisha has written a set A containing n different integers ai on a blackboard. Now he asks Masha to create a set B containing n different integers bj such that all n2 integers that can be obtained by summing up ai and bj for all possible pairs of i and j are different.Both Masha and Grisha don\'t like big numbers, so all numbers in A are from 1 to 106, and all numbers in B must also be in the same range.Help Masha to create the set B that satisfies Grisha\'s requirement." 1600
855G "Harry Vs Voldemort" "dfs and similar,dp,graphs,trees" "After destroying all of Voldemort\'s Horcruxes, Harry and Voldemort are up for the final battle. They each cast spells from their wands and the spells collide.The battle scene is Hogwarts, which can be represented in the form of a tree. There are, in total, n places in Hogwarts joined using n\xe2\x80\x89-\xe2\x80\x891 undirected roads.Ron, who was viewing this battle between Harry and Voldemort, wondered how many triplets of places (u,\xe2\x80\x89v,\xe2\x80\x89w) are there such that if Harry is standing at place u and Voldemort is standing at place v, their spells collide at a place w. This is possible for a triplet only when u, v and w are distinct, and there exist paths from u to w and from v to w which do not pass through the same roads.Now, due to the battle havoc, new paths are being added all the time. You have to tell Ron the answer after each addition.Formally, you are given a tree with n vertices and n\xe2\x80\x89-\xe2\x80\x891 edges. q new edges are being added between the nodes of the tree. After each addition you need to tell the number of triplets (u,\xe2\x80\x89v,\xe2\x80\x89w) such that u, v and w are distinct and there exist two paths, one between u and w, another between v and w such that these paths do not have an edge in common." 3300
855F Nagini "binary search,data structures" "Nagini, being a horcrux You-know-who created with the murder of Bertha Jorkins, has accumulated its army of snakes and is launching an attack on Hogwarts school. Hogwarts\' entrance can be imagined as a straight line (x-axis) from 1 to 105. Nagini is launching various snakes at the Hogwarts entrance. Each snake lands parallel to the entrance, covering a segment at a distance k from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r. Formally, each snake can be imagined as being a line segment between points (l,\xe2\x80\x89k) and (r,\xe2\x80\x89k). Note that k can be both positive and negative, but not 0.Let, at some x-coordinate x\xe2\x80\x89=\xe2\x80\x89i, there be snakes at point (i,\xe2\x80\x89y1) and point (i,\xe2\x80\x89y2), such that y1\xe2\x80\x89>\xe2\x80\x890 and y2\xe2\x80\x89<\xe2\x80\x890. Then, if for any point (i,\xe2\x80\x89y3) containing a snake such that y3\xe2\x80\x89>\xe2\x80\x890, y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y3 holds and for any point (i,\xe2\x80\x89y4) containing a snake such that y4\xe2\x80\x89<\xe2\x80\x890, |y2|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|y4| holds, then the danger value at coordinate x\xe2\x80\x89=\xe2\x80\x89i is y1\xe2\x80\x89+\xe2\x80\x89|y2|. If no such y1 and y2 exist, danger value is 0. Harry wants to calculate the danger value of various segments of the Hogwarts entrance. Danger value for a segment [l,\xe2\x80\x89r) of the entrance can be calculated by taking the sum of danger values for each integer x-coordinate present in the segment.Formally, you have to implement two types of queries:  1 l r k: a snake is added parallel to entrance from x\xe2\x80\x89=\xe2\x80\x89l to x\xe2\x80\x89=\xe2\x80\x89r at y-coordinate y\xe2\x80\x89=\xe2\x80\x89k (l inclusive, r exclusive).  2 l r: you have to calculate the danger value of segment l to r (l inclusive, r exclusive)." 3100
855E "Salazar Slytherin\'s Locket" bitmasks,dp "Harry came to know from Dumbledore that Salazar Slytherin\'s locket is a horcrux. This locket was present earlier at 12 Grimmauld Place, the home of Sirius Black\'s mother. It was stolen from there and is now present in the Ministry of Magic in the office of Dolorous Umbridge, Harry\'s former Defense Against the Dark Arts teacher. Harry, Ron and Hermione are infiltrating the Ministry. Upon reaching Umbridge\'s office, they observed a code lock with a puzzle asking them to calculate count of magic numbers between two integers l and r (both inclusive). Harry remembered from his detention time with Umbridge that she defined a magic number as a number which when converted to a given base b, all the digits from 0 to b\xe2\x80\x89-\xe2\x80\x891 appear even number of times in its representation without any leading zeros.You have to answer q queries to unlock the office. Each query has three integers bi, li and ri, the base and the range for which you have to find the count of magic numbers." 2200
855D "Rowena Ravenclaw\'s Diadem" trees "Harry, upon inquiring Helena Ravenclaw\'s ghost, came to know that she told Tom Riddle or You-know-who about Rowena Ravenclaw\'s diadem and that he stole it from her. Harry thought that Riddle would have assumed that he was the only one to discover the Room of Requirement and thus, would have hidden it there. So Harry is trying to get inside the Room of Requirement to destroy the diadem as he knows that it is a horcrux.But he has to answer a puzzle in order to enter the room. He is given n objects, numbered from 1 to n. Some of the objects have a parent object, that has a lesser number. Formally, object i may have a parent object parenti such that parenti\xe2\x80\x89<\xe2\x80\x89i.There is also a type associated with each parent relation, it can be either of type 1 or type 2. Type 1 relation means that the child object is like a special case of the parent object. Type 2 relation means that the second object is always a part of the first object and all its special cases.Note that if an object b is a special case of object a, and c is a special case of object b, then c is considered to be a special case of object a as well. The same holds for parts: if object b is a part of a, and object c is a part of b, then we say that object c is a part of a. Also note, that if object b is a part of a, and object c is a special case of a, then b is a part of c as well.An object is considered to be neither a part of itself nor a special case of itself.Now, Harry has to answer two type of queries:  1 u v: he needs to tell if object v is a special case of object u.  2 u v: he needs to tell if object v is a part of object u." 2500
855C "Helga Hufflepuff\'s Cup" dp,trees "Harry, Ron and Hermione have figured out that Helga Hufflepuff\'s cup is a horcrux. Through her encounter with Bellatrix Lestrange, Hermione came to know that the cup is present in Bellatrix\'s family vault in Gringott\'s Wizarding Bank. The Wizarding bank is in the form of a tree with total n vaults where each vault has some type, denoted by a number between 1 to m. A tree is an undirected connected graph with no cycles.The vaults with the highest security are of type k, and all vaults of type k have the highest security.There can be at most x vaults of highest security. Also, if a vault is of the highest security, its adjacent vaults are guaranteed to not be of the highest security and their type is guaranteed to be less than k.Harry wants to consider every possibility so that he can easily find the best path to reach Bellatrix\'s vault. So, you have to tell him, given the tree structure of Gringotts, the number of possible ways of giving each vault a type such that the above conditions hold." 2000
855B "Marvolo Gaunt\'s Ring" "brute force,data structures,dp" "Professor Dumbledore is helping Harry destroy the Horcruxes. He went to Gaunt Shack as he suspected a Horcrux to be present there. He saw Marvolo Gaunt\'s Ring and identified it as a Horcrux. Although he destroyed it, he is still affected by its curse. Professor Snape is helping Dumbledore remove the curse. For this, he wants to give Dumbledore exactly x drops of the potion he made. Value of x is calculated as maximum of p\xc2\xb7ai\xe2\x80\x89+\xe2\x80\x89q\xc2\xb7aj\xe2\x80\x89+\xe2\x80\x89r\xc2\xb7ak for given p,\xe2\x80\x89q,\xe2\x80\x89r and array a1,\xe2\x80\x89a2,\xe2\x80\x89... an such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Help Snape find the value of x. Do note that the value of x may be negative." 1500
855A "Tom Riddle\'s Diary" "brute force,implementation,strings" "Harry Potter is on a mission to destroy You-Know-Who\'s Horcruxes. The first Horcrux that he encountered in the Chamber of Secrets is Tom Riddle\'s diary. The diary was with Ginny and it forced her to open the Chamber of Secrets. Harry wants to know the different people who had ever possessed the diary to make sure they are not under its influence.He has names of n people who possessed the diary in order. You need to tell, for each person, if he/she possessed the diary at some point before or not.Formally, for a name si in the i-th line, output ""YES"" (without quotes) if there exists an index j such that si\xe2\x80\x89=\xe2\x80\x89sj and j\xe2\x80\x89<\xe2\x80\x89i, otherwise, output ""NO"" (without quotes)." 800
854B "Maxim Buys an Apartment" "constructive algorithms,math" "Maxim wants to buy an apartment in a new house at Line Avenue of Metropolis. The house has n apartments that are numbered from 1 to n and are arranged in a row. Two apartments are adjacent if their indices differ by 1. Some of the apartments can already be inhabited, others are available for sale.Maxim often visits his neighbors, so apartment is good for him if it is available for sale and there is at least one already inhabited apartment adjacent to it. Maxim knows that there are exactly k already inhabited apartments, but he doesn\'t know their indices yet.Find out what could be the minimum possible and the maximum possible number of apartments that are good for Maxim." 1200
854A Fraction "brute force,constructive algorithms,math" "Petya is a big fan of mathematics, especially its part related to fractions. Recently he learned that a fraction  is called proper iff its numerator is smaller than its denominator (a\xe2\x80\x89<\xe2\x80\x89b) and that the fraction is called irreducible if its numerator and its denominator are coprime (they do not have positive common divisors except 1).During his free time, Petya thinks about proper irreducible fractions and converts them to decimals using the calculator. One day he mistakenly pressed addition button (\xe2\x80\x89+\xe2\x80\x89) instead of division button (\xc3\xb7) and got sum of numerator and denominator that was equal to n instead of the expected decimal notation. Petya wanted to restore the original fraction, but soon he realized that it might not be done uniquely. That\'s why he decided to determine maximum possible proper irreducible fraction  such that sum of its numerator and denominator equals n. Help Petya deal with this problem." 800
853E "Lada Malina" "data structures,geometry" "After long-term research and lots of experiments leading Megapolian automobile manufacturer \xc2\xabAutoVoz\xc2\xbb released a brand new car model named \xc2\xabLada Malina\xc2\xbb. One of the most impressive features of \xc2\xabLada Malina\xc2\xbb is its highly efficient environment-friendly engines.Consider car as a point in Oxy plane. Car is equipped with k engines numbered from 1 to k. Each engine is defined by its velocity vector whose coordinates are (vxi,\xe2\x80\x89vyi) measured in distance units per day. An engine may be turned on at any level wi, that is a real number between \xe2\x80\x89-\xe2\x80\x891 and \xe2\x80\x89+\xe2\x80\x891 (inclusive) that result in a term of (wi\xc2\xb7vxi,\xe2\x80\x89wi\xc2\xb7vyi) in the final car velocity. Namely, the final car velocity is equal to (w1\xc2\xb7vx1\xe2\x80\x89+\xe2\x80\x89w2\xc2\xb7vx2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89wk\xc2\xb7vxk,\xe2\x80\x89  w1\xc2\xb7vy1\xe2\x80\x89+\xe2\x80\x89w2\xc2\xb7vy2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89wk\xc2\xb7vyk) Formally, if car moves with constant values of wi during the whole day then its x-coordinate will change by the first component of an expression above, and its y-coordinate will change by the second component of an expression above. For example, if all wi are equal to zero, the car won\'t move, and if all wi are equal to zero except w1\xe2\x80\x89=\xe2\x80\x891, then car will move with the velocity of the first engine.There are n factories in Megapolia, i-th of them is located in (fxi,\xe2\x80\x89fyi). On the i-th factory there are ai cars \xc2\xabLada Malina\xc2\xbb that are ready for operation.As an attempt to increase sales of a new car, \xc2\xabAutoVoz\xc2\xbb is going to hold an international exposition of cars. There are q options of exposition location and time, in the i-th of them exposition will happen in a point with coordinates (pxi,\xe2\x80\x89pyi) in ti days. Of course, at the \xc2\xabAutoVoz\xc2\xbb is going to bring as much new cars from factories as possible to the place of exposition. Cars are going to be moved by enabling their engines on some certain levels, such that at the beginning of an exposition car gets exactly to the exposition location. However, for some of the options it may be impossible to bring cars from some of the factories to the exposition location by the moment of an exposition. Your task is to determine for each of the options of exposition location and time how many cars will be able to get there by the beginning of an exposition." 3400
853D "Michael and Charging Stations" "binary search,dp,greedy" "Michael has just bought a new electric car for moving across city. Michael does not like to overwork, so each day he drives to only one of two his jobs.Michael\'s day starts from charging his electric car for getting to the work and back. He spends 1000 burles on charge if he goes to the first job, and 2000 burles if he goes to the second job.On a charging station he uses there is a loyalty program that involves bonus cards. Bonus card may have some non-negative amount of bonus burles. Each time customer is going to buy something for the price of x burles, he is allowed to pay an amount of y (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x) burles that does not exceed the bonus card balance with bonus burles. In this case he pays x\xe2\x80\x89-\xe2\x80\x89y burles with cash, and the balance on the bonus card is decreased by y bonus burles. If customer pays whole price with cash (i.e., y\xe2\x80\x89=\xe2\x80\x890) then 10% of price is returned back to the bonus card. This means that bonus card balance increases by  bonus burles. Initially the bonus card balance is equal to 0 bonus burles.Michael has planned next n days and he knows how much does the charge cost on each of those days. Help Michael determine the minimum amount of burles in cash he has to spend with optimal use of bonus card. Assume that Michael is able to cover any part of the price with cash in any day. It is not necessary to spend all bonus burles at the end of the given period." 2400
853C Boredom "data structures" "Ilya is sitting in a waiting area of Metropolis airport and is bored of looking at time table that shows again and again that his plane is delayed. So he took out a sheet of paper and decided to solve some problems.First Ilya has drawn a grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n and marked n squares on it, such that no two marked squares share the same row or the same column. He calls a rectangle on a grid with sides parallel to grid sides beautiful if exactly two of its corner squares are marked. There are exactly n\xc2\xb7(n\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89/\xe2\x80\x892 beautiful rectangles.Ilya has chosen q query rectangles on a grid with sides parallel to grid sides (not necessarily beautiful ones), and for each of those rectangles he wants to find its beauty degree. Beauty degree of a rectangle is the number of beautiful rectangles that share at least one square with the given one.Now Ilya thinks that he might not have enough time to solve the problem till the departure of his flight. You are given the description of marked cells and the query rectangles, help Ilya find the beauty degree of each of the query rectangles." 2100
853B "Jury Meeting" "greedy,sortings,two pointers" "Country of Metropolia is holding Olympiad of Metrpolises soon. It mean that all jury members of the olympiad should meet together in Metropolis (the capital of the country) for the problem preparation process.There are n\xe2\x80\x89+\xe2\x80\x891 cities consecutively numbered from 0 to n. City 0 is Metropolis that is the meeting point for all jury members. For each city from 1 to n there is exactly one jury member living there. Olympiad preparation is a long and demanding process that requires k days of work. For all of these k days each of the n jury members should be present in Metropolis to be able to work on problems.You know the flight schedule in the country (jury members consider themselves important enough to only use flights for transportation). All flights in Metropolia are either going to Metropolis or out of Metropolis. There are no night flights in Metropolia, or in the other words, plane always takes off at the same day it arrives. On his arrival day and departure day jury member is not able to discuss the olympiad. All flights in Megapolia depart and arrive at the same day.Gather everybody for k days in the capital is a hard objective, doing that while spending the minimum possible money is even harder. Nevertheless, your task is to arrange the cheapest way to bring all of the jury members to Metrpolis, so that they can work together for k days and then send them back to their home cities. Cost of the arrangement is defined as a total cost of tickets for all used flights. It is allowed for jury member to stay in Metropolis for more than k days." 1800
853A Planning greedy "Helen works in Metropolis airport. She is responsible for creating a departure schedule. There are n flights that must depart today, the i-th of them is planned to depart at the i-th minute of the day.Metropolis airport is the main transport hub of Metropolia, so it is difficult to keep the schedule intact. This is exactly the case today: because of technical issues, no flights were able to depart during the first k minutes of the day, so now the new departure schedule must be created.All n scheduled flights must now depart at different minutes between (k\xe2\x80\x89+\xe2\x80\x891)-th and (k\xe2\x80\x89+\xe2\x80\x89n)-th, inclusive. However, it\'s not mandatory for the flights to depart in the same order they were initially scheduled to do so \xe2\x80\x94 their order in the new schedule can be different. There is only one restriction: no flight is allowed to depart earlier than it was supposed to depart in the initial schedule.Helen knows that each minute of delay of the i-th flight costs airport ci burles. Help her find the order for flights to depart in the new schedule that minimizes the total cost for the airport." 1500
852I Dating "brute force,dfs and similar,graphs,trees" "This story is happening in a town named BubbleLand. There are n houses in BubbleLand. In each of these n houses lives a boy or a girl. People there really love numbers and everyone has their favorite number f. That means that the boy or girl that lives in the i-th house has favorite number equal to fi.The houses are numerated with numbers 1 to n.The houses are connected with n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads and you can travel from any house to any other house in the town. There is exactly one path between every pair of houses.A new dating had agency opened their offices in this mysterious town and the citizens were very excited. They immediately sent q questions to the agency and each question was of the following format:   a b \xe2\x80\x94 asking how many ways are there to choose a couple (boy and girl) that have the same favorite number and live in one of the houses on the unique path from house a to house b. Help the dating agency to answer the questions and grow their business." 2300
852H "Bob and stages" dp,geometry "The citizens of BubbleLand are celebrating their 10th anniversary so they decided to organize a big music festival. Bob got a task to invite N famous singers who would sing on the fest. He was too busy placing stages for their performances that he totally forgot to write the invitation e-mails on time, and unfortunately he only found K available singers. Now there are more stages than singers, leaving some of the stages empty. Bob would not like if citizens of BubbleLand noticed empty stages and found out that he was irresponsible.Because of that he decided to choose exactly K stages that form a convex set, make large posters as edges of that convex set and hold festival inside. While those large posters will make it impossible for citizens to see empty stages outside Bob still needs to make sure they don\'t see any of the empty stages inside that area.Since lots of people are coming, he would like that the festival area is as large as possible. Help him calculate the maximum area that he could obtain respecting the conditions. If there is no such area, the festival cannot be organized and the answer is 0.00." 3000
852G "Bathroom terminal" implementation "Smith wakes up at the side of a dirty, disused bathroom, his ankle chained to pipes. Next to him is tape-player with a hand-written message ""Play Me"". He finds a tape in his own back pocket. After putting the tape in the tape-player, he sees a key hanging from a ceiling, chained to some kind of a machine, which is connected to the terminal next to him. After pressing a Play button a rough voice starts playing from the tape:""Listen up Smith. As you can see, you are in pretty tough situation and in order to escape, you have to solve a puzzle. You are given N strings which represent words. Each word is of the maximum length L and consists of characters \'a\'-\'e\'. You are also given M strings which represent patterns. Pattern is a string of length \xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89 L and consists of characters \'a\'-\'e\' as well as the maximum 3 characters \'?\'. Character \'?\' is an unknown character, meaning it can be equal to any character \'a\'-\'e\', or even an empty character. For each pattern find the number of words that matches with the given pattern. After solving it and typing the result in the terminal, the key will drop from the ceiling and you may escape. Let the game begin.""Help Smith escape." 1700
852F "Product transformation" "combinatorics,math,number theory" "Consider an array A with N elements, all being the same integer a.Define the product transformation as a simultaneous update Ai\xe2\x80\x89=\xe2\x80\x89Ai\xc2\xb7Ai\xe2\x80\x89+\xe2\x80\x891, that is multiplying each element to the element right to it for , with the last number AN remaining the same. For example, if we start with an array A with a\xe2\x80\x89=\xe2\x80\x892 and N\xe2\x80\x89=\xe2\x80\x894, then after one product transformation A\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x89 4,\xe2\x80\x89 4,\xe2\x80\x89 2], and after two product transformations A\xe2\x80\x89=\xe2\x80\x89[16,\xe2\x80\x89 16,\xe2\x80\x89 8,\xe2\x80\x89 2].Your simple task is to calculate the array A after M product transformations. Since the numbers can get quite big you should output them modulo Q." 2200
852E "Casinos and travel" dp "John has just bought a new car and is planning a journey around the country. Country has N cities, some of which are connected by bidirectional roads. There are N\xe2\x80\x89-\xe2\x80\x891 roads and every city is reachable from any other city. Cities are labeled from 1 to N.John first has to select from which city he will start his journey. After that, he spends one day in a city and then travels to a randomly choosen city which is directly connected to his current one and which he has not yet visited. He does this until he can\'t continue obeying these rules.To select the starting city, he calls his friend Jack for advice. Jack is also starting a big casino business and wants to open casinos in some of the cities (max 1 per city, maybe nowhere). Jack knows John well and he knows that if he visits a city with a casino, he will gamble exactly once before continuing his journey.He also knows that if John enters a casino in a good mood, he will leave it in a bad mood and vice versa. Since he is John\'s friend, he wants him to be in a good mood at the moment when he finishes his journey. John is in a good mood before starting the journey.In how many ways can Jack select a starting city for John and cities where he will build casinos such that no matter how John travels, he will be in a good mood at the end? Print answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2100
852D "Exploration plan" "binary search,flows,graph matchings,shortest paths" "The competitors of Bubble Cup X gathered after the competition and discussed what is the best way to get to know the host country and its cities.After exploring the map of Serbia for a while, the competitors came up with the following facts: the country has V cities which are indexed with numbers from 1 to V, and there are E bi-directional roads that connect the cites. Each road has a weight (the time needed to cross that road). There are N teams at the Bubble Cup and the competitors came up with the following plan: each of the N teams will start their journey in one of the V cities, and some of the teams share the starting position.They want to find the shortest time T, such that every team can move in these T minutes, and the number of different cities they end up in is at least K (because they will only get to know the cities they end up in). A team doesn\'t have to be on the move all the time, if they like it in a particular city, they can stay there and wait for the time to pass.Please help the competitors to determine the shortest time T so it\'s possible for them to end up in at least K different cities or print -1 if that is impossible no matter how they move.Note that there can exist multiple roads between some cities." 2100
852C Property greedy,sortings "Bill is a famous mathematician in BubbleLand. Thanks to his revolutionary math discoveries he was able to make enough money to build a beautiful house. Unfortunately, for not paying property tax on time, court decided to punish Bill by making him lose a part of his property.Bill\xe2\x80\x99s property can be observed as a convex regular 2n-sided polygon A0 A1... A2n\xe2\x80\x89-\xe2\x80\x891 A2n,\xe2\x80\x89 A2n\xe2\x80\x89=\xe2\x80\x89 A0, with sides of the exactly 1 meter in length. Court rules for removing part of his property are as follows:  Split every edge Ak Ak\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89 k\xe2\x80\x89=\xe2\x80\x890... 2n\xe2\x80\x89-\xe2\x80\x891 in n equal parts of size 1\xe2\x80\x89/\xe2\x80\x89n with points P0,\xe2\x80\x89P1,\xe2\x80\x89...,\xe2\x80\x89Pn\xe2\x80\x89-\xe2\x80\x891  On every edge A2k A2k\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89 k\xe2\x80\x89=\xe2\x80\x890... n\xe2\x80\x89-\xe2\x80\x891 court will choose one point B2k\xe2\x80\x89=\xe2\x80\x89 Pi for some i\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89...,\xe2\x80\x89 n\xe2\x80\x89-\xe2\x80\x891 such that   On every edge A2k\xe2\x80\x89+\xe2\x80\x891A2k\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89 k\xe2\x80\x89=\xe2\x80\x890...n\xe2\x80\x89-\xe2\x80\x891 Bill will choose one point B2k\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89 Pi for some i\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x89...,\xe2\x80\x89 n\xe2\x80\x89-\xe2\x80\x891 such that   Bill gets to keep property inside of 2n-sided polygon B0 B1... B2n\xe2\x80\x89-\xe2\x80\x891 Luckily, Bill found out which B2k points the court chose. Even though he is a great mathematician, his house is very big and he has a hard time calculating. Therefore, he is asking you to help him choose points so he maximizes area of property he can keep." 2100
852B "Neural Network country" dp,matrices "Due to the recent popularity of the Deep learning new countries are starting to look like Neural Networks. That is, the countries are being built deep with many layers, each layer possibly having many cities. They also have one entry, and one exit point.There are exactly L layers, each having N cities. Let us look at the two adjacent layers L1 and L2. Each city from the layer L1 is connected to each city from the layer L2 with the traveling cost cij for , and each pair of adjacent layers has the same cost in between their cities as any other pair (they just stacked the same layers, as usual). Also, the traveling costs to each city from the layer L2 are same for all cities in the L1, that is cij is the same for , and fixed j.Doctor G. needs to speed up his computations for this country so he asks you to find the number of paths he can take from entry to exit point such that his traveling cost is divisible by given number M." 2000
852A Digits "brute force,implementation,math" "John gave Jack a very hard problem. He wrote a very big positive integer A0 on a piece of paper. The number is less than 10200000 . In each step, Jack is allowed to put \'\xe2\x80\x89+\xe2\x80\x89\' signs in between some of the digits (maybe none) of the current number and calculate the sum of the expression. He can perform the same procedure on that sum and so on. The resulting sums can be labeled respectively by A1, A2 etc. His task is to get to a single digit number.The problem is that there is not much blank space on the paper. There are only three lines of space, so he can\'t perform more than three steps. Since he wants to fill up the paper completely, he will perform exactly three steps.Jack must not add leading zeros to intermediate results, but he can put \'\xe2\x80\x89+\xe2\x80\x89\' signs in front of digit 0. For example, if the current number is 1000100, 10\xe2\x80\x89+\xe2\x80\x89001\xe2\x80\x89+\xe2\x80\x8900 is a valid step, resulting in number 11." 2500
851B "Arpa and an exam about geometry" geometry,math "Arpa is taking a geometry exam. Here is the last problem of the exam.You are given three points a,\xe2\x80\x89b,\xe2\x80\x89c.Find a point and an angle such that if we rotate the page around the point by the angle, the new position of a is the same as the old position of b, and the new position of b is the same as the old position of c.Arpa is doubting if the problem has a solution or not (i.e. if there exists a point and an angle satisfying the condition). Help Arpa determine if the question has a solution or not." 1400
851A "Arpa and a research in Mexican wave" implementation,math "Arpa is researching the Mexican wave.There are n spectators in the stadium, labeled from 1 to n. They start the Mexican wave at time 0.   At time 1, the first spectator stands.  At time 2, the second spectator stands.  ...  At time k, the k-th spectator stands.  At time k\xe2\x80\x89+\xe2\x80\x891, the (k\xe2\x80\x89+\xe2\x80\x891)-th spectator stands and the first spectator sits.  At time k\xe2\x80\x89+\xe2\x80\x892, the (k\xe2\x80\x89+\xe2\x80\x892)-th spectator stands and the second spectator sits.  ...  At time n, the n-th spectator stands and the (n\xe2\x80\x89-\xe2\x80\x89k)-th spectator sits.  At time n\xe2\x80\x89+\xe2\x80\x891, the (n\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89k)-th spectator sits.  ...  At time n\xe2\x80\x89+\xe2\x80\x89k, the n-th spectator sits. Arpa wants to know how many spectators are standing at time t." 800
850F "Rainbow Balls" math "You have a bag of balls of n different colors. You have ai balls of the i-th color.While there are at least two different colored balls in the bag, perform the following steps:   Take out two random balls without replacement one by one. These balls might be the same color.  Color the second ball to the color of the first ball. You are not allowed to switch the order of the balls in this step.  Place both balls back in the bag.  All these actions take exactly one second. Let M\xe2\x80\x89=\xe2\x80\x89109\xe2\x80\x89+\xe2\x80\x897. It can be proven that the expected amount of time needed before you stop can be represented as a rational number , where P and Q are coprime integers and where Q is not divisible by M. Return the value ." 2800
850E "Random Elections" "bitmasks,brute force,divide and conquer,fft,math" "The presidential election is coming in Bearland next year! Everybody is so excited about this!So far, there are three candidates, Alice, Bob, and Charlie. There are n citizens in Bearland. The election result will determine the life of all citizens of Bearland for many years. Because of this great responsibility, each of n citizens will choose one of six orders of preference between Alice, Bob and Charlie uniformly at random, independently from other voters.The government of Bearland has devised a function to help determine the outcome of the election given the voters preferences. More specifically, the function is  (takes n boolean numbers and returns a boolean number). The function also obeys the following property: f(1\xe2\x80\x89-\xe2\x80\x89x1,\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89xn)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89f(x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn).Three rounds will be run between each pair of candidates: Alice and Bob, Bob and Charlie, Charlie and Alice. In each round, xi will be equal to 1, if i-th citizen prefers the first candidate to second in this round, and 0 otherwise. After this, y\xe2\x80\x89=\xe2\x80\x89f(x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn) will be calculated. If y\xe2\x80\x89=\xe2\x80\x891, the first candidate will be declared as winner in this round. If y\xe2\x80\x89=\xe2\x80\x890, the second will be the winner, respectively.Define the probability that there is a candidate who won two rounds as p. p\xc2\xb76n is always an integer. Print the value of this integer modulo 109\xe2\x80\x89+\xe2\x80\x897\xe2\x80\x89=\xe2\x80\x891 000 000 007." 2800
850D "Tournament Construction" "constructive algorithms,dp,graphs,greedy,math" "Ivan is reading a book about tournaments. He knows that a tournament is an oriented graph with exactly one oriented edge between each pair of vertices. The score of a vertex is the number of edges going outside this vertex. Yesterday Ivan learned Landau\'s criterion: there is tournament with scores d1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89dn if and only if  for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n and .Now, Ivan wanna solve following problem: given a set of numbers S\xe2\x80\x89=\xe2\x80\x89{a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am}, is there a tournament with given set of scores? I.e. is there tournament with sequence of scores d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dn such that if we remove duplicates in scores, we obtain the required set {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am}? Find a tournament with minimum possible number of vertices." 2800
850C "Arpa and a game with Mojtaba" bitmasks,dp,games "Mojtaba and Arpa are playing a game. They have a list of n numbers in the game.In a player\'s turn, he chooses a number pk (where p is a prime number and k is a positive integer) such that pk divides at least one number in the list. For each number in the list divisible by pk, call it x, the player will delete x and add  to the list. The player who can not make a valid choice of p and k loses.Mojtaba starts the game and the players alternatively make moves. Determine which one of players will be the winner if both players play optimally." 2200
850B "Arpa and a list of numbers" "implementation,number theory" "Arpa has found a list containing n numbers. He calls a list bad if and only if it is not empty and gcd (see notes section for more information) of numbers in the list is 1.Arpa can perform two types of operations:  Choose a number and delete it with cost x.  Choose a number and increase it by 1 with cost y. Arpa can apply these operations to as many numbers as he wishes, and he is allowed to apply the second operation arbitrarily many times on the same number.Help Arpa to find the minimum possible cost to make the list good." 2100
850A "Five Dimensional Points" "brute force,geometry,math" "You are given set of n points in 5-dimensional space. The points are labeled from 1 to n. No two points coincide.We will call point a bad if there are different points b and c, not equal to a, from the given set such that angle between vectors  and  is acute (i.e. strictly less than ). Otherwise, the point is called good.The angle between vectors  and  in 5-dimensional space is defined as , where  is the scalar product and  is length of .Given the list of points, print the indices of the good points in ascending order." 1700
849B "Tell Your World" "brute force,geometry" "Connect the countless points with lines, till we reach the faraway yonder.There are n points on a coordinate plane, the i-th of which being (i,\xe2\x80\x89yi).Determine whether it\'s possible to draw two parallel and non-overlapping lines, such that every point in the set lies on exactly one of them, and each of them passes through at least one point in the set." 1600
849A "Odds and Ends" implementation "Where do odds begin, and where do they end? Where does hope emerge, and will they ever break?Given an integer sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of length n. Decide whether it is possible to divide it into an odd number of non-empty subsegments, the each of which has an odd length and begins and ends with odd numbers.A subsegment is a contiguous slice of the whole sequence. For example, {3,\xe2\x80\x894,\xe2\x80\x895} and {1} are subsegments of sequence {1,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x895,\xe2\x80\x896}, while {1,\xe2\x80\x892,\xe2\x80\x894} and {7} are not." 1000
848E "Days of Floral Colours" "combinatorics,divide and conquer,dp,fft,math" "The Floral Clock has been standing by the side of Mirror Lake for years. Though unable to keep time, it reminds people of the passage of time and the good old days.On the rim of the Floral Clock are 2n flowers, numbered from 1 to 2n clockwise, each of which has a colour among all n possible ones. For each colour, there are exactly two flowers with it, the distance between which either is less than or equal to 2, or equals n. Additionally, if flowers u and v are of the same colour, then flowers opposite to u and opposite to v should be of the same colour as well \xe2\x80\x94 symmetry is beautiful!Formally, the distance between two flowers is 1 plus the number of flowers on the minor arc (or semicircle) between them. Below is a possible arrangement with n\xe2\x80\x89=\xe2\x80\x896 that cover all possibilities.  The beauty of an arrangement is defined to be the product of the lengths of flower segments separated by all opposite flowers of the same colour. In other words, in order to compute the beauty, we remove from the circle all flowers that have the same colour as flowers opposite to them. Then, the beauty is the product of lengths of all remaining segments. Note that we include segments of length 0 in this product. If there are no flowers that have the same colour as flower opposite to them, the beauty equals 0. For instance, the beauty of the above arrangement equals 1\xe2\x80\x89\xc3\x97\xe2\x80\x893\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x899 \xe2\x80\x94 the segments are {2}, {4,\xe2\x80\x895,\xe2\x80\x896}, {8} and {10,\xe2\x80\x8911,\xe2\x80\x8912}.While keeping the constraints satisfied, there may be lots of different arrangements. Find out the sum of beauty over all possible arrangements, modulo 998\xe2\x80\x89244\xe2\x80\x89353. Two arrangements are considered different, if a pair (u,\xe2\x80\x89v) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n) exists such that flowers u and v are of the same colour in one of them, but not in the other." 3400
848D "Shake It!" combinatorics,dp,flows,graphs "A never-ending, fast-changing and dream-like world unfolds, as the secret door opens.A world is an unordered graph G, in whose vertex set V(G) there are two special vertices s(G) and t(G). An initial world has vertex set {s(G),\xe2\x80\x89t(G)} and an edge between them.A total of n changes took place in an initial world. In each change, a new vertex w is added into V(G), an existing edge (u,\xe2\x80\x89v) is chosen, and two edges (u,\xe2\x80\x89w) and (v,\xe2\x80\x89w) are added into E(G). Note that it\'s possible that some edges are chosen in more than one change.It\'s known that the capacity of the minimum s-t cut of the resulting graph is m, that is, at least m edges need to be removed in order to make s(G) and t(G) disconnected.Count the number of non-similar worlds that can be built under the constraints, modulo 109\xe2\x80\x89+\xe2\x80\x897. We define two worlds similar, if they are isomorphic and there is isomorphism in which the s and t vertices are not relabelled. Formally, two worlds G and H are considered similar, if there is a bijection between their vertex sets , such that:   f(s(G))\xe2\x80\x89=\xe2\x80\x89s(H);  f(t(G))\xe2\x80\x89=\xe2\x80\x89t(H);  Two vertices u and v of G are adjacent in G if and only if f(u) and f(v) are adjacent in H." 2900
848C "Goodbye Souvenir" "data structures,divide and conquer" "I won\'t feel lonely, nor will I be sorrowful... not before everything is buried.A string of n beads is left as the message of leaving. The beads are numbered from 1 to n from left to right, each having a shape numbered by integers between 1 and n inclusive. Some beads may have the same shapes.The memory of a shape x in a certain subsegment of beads, is defined to be the difference between the last position and the first position that shape x appears in the segment. The memory of a subsegment is the sum of memories over all shapes that occur in it.From time to time, shapes of beads change as well as the memories. Sometimes, the past secreted in subsegments are being recalled, and you are to find the memory for each of them." 2600
848B "Rooter\'s Song" "constructive algorithms,data structures,geometry,implementation,sortings,two pointers" "Wherever the destination is, whoever we meet, let\'s render this song together.On a Cartesian coordinate plane lies a rectangular stage of size w\xe2\x80\x89\xc3\x97\xe2\x80\x89h, represented by a rectangle with corners (0,\xe2\x80\x890), (w,\xe2\x80\x890), (w,\xe2\x80\x89h) and (0,\xe2\x80\x89h). It can be seen that no collisions will happen before one enters the stage.On the sides of the stage stand n dancers. The i-th of them falls into one of the following groups:   Vertical: stands at (xi,\xe2\x80\x890), moves in positive y direction (upwards);  Horizontal: stands at (0,\xe2\x80\x89yi), moves in positive x direction (rightwards).   According to choreography, the i-th dancer should stand still for the first ti milliseconds, and then start moving in the specified direction at 1 unit per millisecond, until another border is reached. It is guaranteed that no two dancers have the same group, position and waiting time at the same time.When two dancers collide (i.e. are on the same point at some time when both of them are moving), they immediately exchange their moving directions and go on.  Dancers stop when a border of the stage is reached. Find out every dancer\'s stopping position." 1900
848A "From Y to Y" "constructive algorithms" "From beginning till end, this message has been waiting to be conveyed.For a given unordered multiset of n lowercase English letters (""multi"" means that a letter may appear more than once), we treat all letters as strings of length 1, and repeat the following operation n\xe2\x80\x89-\xe2\x80\x891 times:  Remove any two elements s and t from the set, and add their concatenation s\xe2\x80\x89+\xe2\x80\x89t to the set. The cost of such operation is defined to be , where f(s,\xe2\x80\x89c) denotes the number of times character c appears in string s.Given a non-negative integer k, construct any valid non-empty set of no more than 100\xe2\x80\x89000 letters, such that the minimum accumulative cost of the whole process is exactly k. It can be shown that a solution always exists." 1600
847M "Weather Tomorrow" implementation,math "Vasya came up with his own weather forecasting method. He knows the information about the average air temperature for each of the last n days. Assume that the average air temperature for each day is integral.Vasya believes that if the average temperatures over the last n days form an arithmetic progression, where the first term equals to the average temperature on the first day, the second term equals to the average temperature on the second day and so on, then the average temperature of the next (n\xe2\x80\x89+\xe2\x80\x891)-th day will be equal to the next term of the arithmetic progression. Otherwise, according to Vasya\'s method, the temperature of the (n\xe2\x80\x89+\xe2\x80\x891)-th day will be equal to the temperature of the n-th day.Your task is to help Vasya predict the average temperature for tomorrow, i. e. for the (n\xe2\x80\x89+\xe2\x80\x891)-th day." 1000
847L "Berland SU Computer Network" "constructive algorithms,dfs and similar,graphs,hashing,trees" "In the computer network of the Berland State University there are n routers numbered from 1 to n. Some pairs of routers are connected by patch cords. Information can be transmitted over patch cords in both direction. The network is arranged in such a way that communication between any two routers (directly or through other routers) is possible. There are no cycles in the network, so there is only one path between each pair of routers over patch cords.Unfortunately, the exact topology of the network was lost by administrators. In order to restore it, the following auxiliary information was collected.For each patch cord p, directly connected to the router i, list of routers located behind the patch cord p relatively i is known. In other words, all routers path from which to the router i goes through p are known. So for each router i there are ki lists, where ki is the number of patch cords connected to i.For example, let the network consists of three routers connected in chain 1\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x893. Then:  the router 1: for the single patch cord connected to the first router there is a single list containing two routers: 2 and 3;  the router 2: for each of the patch cords connected to the second router there is a list: one list contains the router 1 and the other \xe2\x80\x94 the router 3;  the router 3: for the single patch cord connected to the third router there is a single list containing two routers: 1 and 2. Your task is to help administrators to restore the network topology, i. e. to identify all pairs of routers directly connected by a patch cord." 2400
847K "Travel Cards" greedy,implementation,sortings "In the evening Polycarp decided to analyze his today\'s travel expenses on public transport.The bus system in the capital of Berland is arranged in such a way that each bus runs along the route between two stops. Each bus has no intermediate stops. So each of the buses continuously runs along the route from one stop to the other and back. There is at most one bus running between a pair of stops.Polycarp made n trips on buses. About each trip the stop where he started the trip and the the stop where he finished are known. The trips follow in the chronological order in Polycarp\'s notes.It is known that one trip on any bus costs a burles. In case when passenger makes a transshipment the cost of trip decreases to b burles (b\xe2\x80\x89<\xe2\x80\x89a). A passenger makes a transshipment if the stop on which he boards the bus coincides with the stop where he left the previous bus. Obviously, the first trip can not be made with transshipment.For example, if Polycarp made three consecutive trips: ""BerBank""  ""University"", ""University""  ""BerMall"", ""University""  ""BerBank"", then he payed a\xe2\x80\x89+\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89a\xe2\x80\x89=\xe2\x80\x892a\xe2\x80\x89+\xe2\x80\x89b burles. From the BerBank he arrived to the University, where he made transshipment to the other bus and departed to the BerMall. Then he walked to the University and returned to the BerBank by bus.Also Polycarp can buy no more than k travel cards. Each travel card costs f burles. The travel card for a single bus route makes free of charge any trip by this route (in both directions). Once purchased, a travel card can be used any number of times in any direction.What is the smallest amount of money Polycarp could have spent today if he can buy no more than k travel cards?" 1800
847J "Students Initiation" "binary search,flows,graphs" "Soon the first year students will be initiated into students at the University of Berland. The organizers of the initiation come up with a program for this holiday. In their opinion, it would be good if the first-year students presented small souvenirs to each other. When they voiced this idea to the first-year students, they found out the following:  some pairs of the new students already know each other;  each new student agrees to give souvenirs only to those with whom they are already familiar;  each new student does not want to present too many souvenirs. The organizers have written down all the pairs of first-year friends who are familiar with each other and now want to determine for each new student, whom they should give souvenirs to. In their opinion, in each pair of familiar students exactly one student must present a souvenir to another student.First year students already decided to call the unluckiest the one who will have to present the greatest number of souvenirs. The organizers in return promised that the unluckiest will be unlucky to the minimum possible degree: of course, they will have to present the greatest number of souvenirs compared to the other students, but this number will be as small as possible.Organizers are very busy, and they asked you to determine for each pair of first-year friends who and to whom should present a souvenir." 2400
847I "Noise Level" "dfs and similar,implementation,math" "The Berland\'s capital has the form of a rectangle with sizes n\xe2\x80\x89\xc3\x97\xe2\x80\x89m quarters. All quarters are divided into three types:  regular (labeled with the character \'.\') \xe2\x80\x94 such quarters do not produce the noise but are not obstacles to the propagation of the noise;  sources of noise (labeled with an uppercase Latin letter from \'A\' to \'Z\') \xe2\x80\x94 such quarters are noise sources and are not obstacles to the propagation of the noise;  heavily built-up (labeled with the character \'*\') \xe2\x80\x94 such quarters are soundproofed, the noise does not penetrate into them and they themselves are obstacles to the propagation of noise. A quarter labeled with letter \'A\' produces q units of noise. A quarter labeled with letter \'B\' produces 2\xc2\xb7q units of noise. And so on, up to a quarter labeled with letter \'Z\', which produces 26\xc2\xb7q units of noise. There can be any number of quarters labeled with each letter in the city.When propagating from the source of the noise, the noise level is halved when moving from one quarter to a quarter that shares a side with it (when an odd number is to be halved, it\'s rounded down). The noise spreads along the chain. For example, if some quarter is located at a distance 2 from the noise source, then the value of noise which will reach the quarter is divided by 4. So the noise level that comes from the source to the quarter is determined solely by the length of the shortest path between them. Heavily built-up quarters are obstacles, the noise does not penetrate into them.  The values in the cells of the table on the right show the total noise level in the respective quarters for q\xe2\x80\x89=\xe2\x80\x89100, the first term in each sum is the noise from the quarter \'A\', the second \xe2\x80\x94 the noise from the quarter \'B\'. The noise level in quarter is defined as the sum of the noise from all sources. To assess the quality of life of the population of the capital of Berland, it is required to find the number of quarters whose noise level exceeds the allowed level p." 1900
847H "Load Testing" greedy "Polycarp plans to conduct a load testing of its new project Fakebook. He already agreed with his friends that at certain points in time they will send requests to Fakebook. The load testing will last n minutes and in the i-th minute friends will send ai requests.Polycarp plans to test Fakebook under a special kind of load. In case the information about Fakebook gets into the mass media, Polycarp hopes for a monotone increase of the load, followed by a monotone decrease of the interest to the service. Polycarp wants to test this form of load.Your task is to determine how many requests Polycarp must add so that before some moment the load on the server strictly increases and after that moment strictly decreases. Both the increasing part and the decreasing part can be empty (i. e. absent). The decrease should immediately follow the increase. In particular, the load with two equal neigbouring values is unacceptable.For example, if the load is described with one of the arrays [1, 2, 8, 4, 3], [1, 3, 5] or [10], then such load satisfies Polycarp (in each of the cases there is an increasing part, immediately followed with a decreasing part). If the load is described with one of the arrays [1, 2, 2, 1], [2, 1, 2] or [10, 10], then such load does not satisfy Polycarp.Help Polycarp to make the minimum number of additional requests, so that the resulting load satisfies Polycarp. He can make any number of additional requests at any minute from 1 to n." 1600
847G "University Classes" implementation "There are n student groups at the university. During the study day, each group can take no more than 7 classes. Seven time slots numbered from 1 to 7 are allocated for the classes.The schedule on Monday is known for each group, i. e. time slots when group will have classes are known.Your task is to determine the minimum number of rooms needed to hold classes for all groups on Monday. Note that one room can hold at most one group class in a single time slot." 900
847F "Berland Elections" greedy,sortings "The elections to Berland parliament are happening today. Voting is in full swing!Totally there are n candidates, they are numbered from 1 to n. Based on election results k (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) top candidates will take seats in the parliament.After the end of the voting the number of votes for each candidate is calculated. In the resulting table the candidates are ordered by the number of votes. In case of tie (equal number of votes) they are ordered by the time of the last vote given. The candidate with ealier last vote stands higher in the resulting table.So in the resulting table candidates are sorted by the number of votes (more votes stand for the higher place) and if two candidates have equal number of votes they are sorted by the time of last vote (earlier last vote stands for the higher place).There is no way for a candidate with zero votes to take a seat in the parliament. So it is possible that less than k candidates will take a seat in the parliament.In Berland there are m citizens who can vote. Each of them will vote for some candidate. Each citizen will give a vote to exactly one of n candidates. There is no option ""against everyone"" on the elections. It is not accepted to spoil bulletins or not to go to elections. So each of m citizens will vote for exactly one of n candidates.At the moment a citizens have voted already (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). This is an open election, so for each citizen it is known the candidate for which the citizen has voted. Formally, the j-th citizen voted for the candidate gj. The citizens who already voted are numbered in chronological order; i.e. the (j\xe2\x80\x89+\xe2\x80\x891)-th citizen voted after the j-th.The remaining m\xe2\x80\x89-\xe2\x80\x89a citizens will vote before the end of elections, each of them will vote for one of n candidates.Your task is to determine for each of n candidates one of the three possible outcomes:  a candidate will be elected to the parliament regardless of votes of the remaining m\xe2\x80\x89-\xe2\x80\x89a citizens;  a candidate has chance to be elected to the parliament after all n citizens have voted;  a candidate has no chances to be elected to the parliament regardless of votes of the remaining m\xe2\x80\x89-\xe2\x80\x89a citizens." 2100
847E Packmen "binary search,dp" "A game field is a strip of 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n square cells. In some cells there are Packmen, in some cells \xe2\x80\x94 asterisks, other cells are empty.Packman can move to neighboring cell in 1 time unit. If there is an asterisk in the target cell then Packman eats it. Packman doesn\'t spend any time to eat an asterisk.In the initial moment of time all Packmen begin to move. Each Packman can change direction of its move unlimited number of times, but it is not allowed to go beyond the boundaries of the game field. Packmen do not interfere with the movement of other packmen; in one cell there can be any number of packmen moving in any directions.Your task is to determine minimum possible time after which Packmen can eat all the asterisks." 1800
847D "Dog Show" "constructive algorithms,data structures,greedy" "A new dog show on TV is starting next week. On the show dogs are required to demonstrate bottomless stomach, strategic thinking and self-preservation instinct. You and your dog are invited to compete with other participants and naturally you want to win!On the show a dog needs to eat as many bowls of dog food as possible (bottomless stomach helps here). Dogs compete separately of each other and the rules are as follows:At the start of the show the dog and the bowls are located on a line. The dog starts at position x\xe2\x80\x89=\xe2\x80\x890 and n bowls are located at positions x\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x89x\xe2\x80\x89=\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89=\xe2\x80\x89n. The bowls are numbered from 1 to n from left to right. After the show starts the dog immediately begins to run to the right to the first bowl.The food inside bowls is not ready for eating at the start because it is too hot (dog\'s self-preservation instinct prevents eating). More formally, the dog can eat from the i-th bowl after ti seconds from the start of the show or later.It takes dog 1 second to move from the position x to the position x\xe2\x80\x89+\xe2\x80\x891. The dog is not allowed to move to the left, the dog runs only to the right with the constant speed 1 distance unit per second. When the dog reaches a bowl (say, the bowl i), the following cases are possible:  the food had cooled down (i.e. it passed at least ti seconds from the show start): the dog immediately eats the food and runs to the right without any stop,  the food is hot (i.e. it passed less than ti seconds from the show start): the dog has two options: to wait for the i-th bowl, eat the food and continue to run at the moment ti or to skip the i-th bowl and continue to run to the right without any stop. After T seconds from the start the show ends. If the dog reaches a bowl of food at moment T the dog can not eat it. The show stops before T seconds if the dog had run to the right of the last bowl.You need to help your dog create a strategy with which the maximum possible number of bowls of food will be eaten in T seconds." 2200
847C "Sum of Nestings" "constructive algorithms" "Recall that the bracket sequence is considered regular if it is possible to insert symbols \'+\' and \'1\' into it so that the result is a correct arithmetic expression. For example, a sequence ""(()())"" is regular, because we can get correct arithmetic expression insering symbols \'+\' and \'1\': ""((1+1)+(1+1))"". Also the following sequences are regular: ""()()()"", ""(())"" and ""()"". The following sequences are not regular bracket sequences: "")("", ""(()"" and ""())(()"".In this problem you are given two integers n and k. Your task is to construct a regular bracket sequence consisting of round brackets with length 2\xc2\xb7n with total sum of nesting of all opening brackets equals to exactly k. The nesting of a single opening bracket equals to the number of pairs of brackets in which current opening bracket is embedded.For example, in the sequence ""()(())"" the nesting of first opening bracket equals to 0, the nesting of the second opening bracket equals to 0 and the nesting of the third opening bracket equal to 1. So the total sum of nestings equals to 1." 1800
847B "Preparing for Merge Sort" "binary search,data structures" "Ivan has an array consisting of n different integers. He decided to reorder all elements in increasing order. Ivan loves merge sort so he decided to represent his array with one or several increasing sequences which he then plans to merge into one sorted array.Ivan represent his array with increasing sequences with help of the following algorithm.While there is at least one unused number in array Ivan repeats the following procedure:  iterate through array from the left to the right;  Ivan only looks at unused numbers on current iteration;  if current number is the first unused number on this iteration or this number is greater than previous unused number on current iteration, then Ivan marks the number as used and writes it down. For example, if Ivan\'s array looks like [1, 3, 2, 5, 4] then he will perform two iterations. On first iteration Ivan will use and write numbers [1, 3, 5], and on second one \xe2\x80\x94 [2, 4].Write a program which helps Ivan and finds representation of the given array with one or several increasing sequences in accordance with algorithm described above." 1600
847A "Union of Doubly Linked Lists" implementation "Doubly linked list is one of the fundamental data structures. A doubly linked list is a sequence of elements, each containing information about the previous and the next elements of the list. In this problem all lists have linear structure. I.e. each element except the first has exactly one previous element, each element except the last has exactly one next element. The list is not closed in a cycle.In this problem you are given n memory cells forming one or more doubly linked lists. Each cell contains information about element from some list. Memory cells are numbered from 1 to n.For each cell i you are given two values:   li \xe2\x80\x94 cell containing previous element for the element in the cell i;  ri \xe2\x80\x94 cell containing next element for the element in the cell i. If cell i contains information about the element which has no previous element then li\xe2\x80\x89=\xe2\x80\x890. Similarly, if cell i contains information about the element which has no next element then ri\xe2\x80\x89=\xe2\x80\x890.  Three lists are shown on the picture. For example, for the picture above the values of l and r are the following: l1\xe2\x80\x89=\xe2\x80\x894, r1\xe2\x80\x89=\xe2\x80\x897; l2\xe2\x80\x89=\xe2\x80\x895, r2\xe2\x80\x89=\xe2\x80\x890; l3\xe2\x80\x89=\xe2\x80\x890, r3\xe2\x80\x89=\xe2\x80\x890; l4\xe2\x80\x89=\xe2\x80\x896, r4\xe2\x80\x89=\xe2\x80\x891; l5\xe2\x80\x89=\xe2\x80\x890, r5\xe2\x80\x89=\xe2\x80\x892; l6\xe2\x80\x89=\xe2\x80\x890, r6\xe2\x80\x89=\xe2\x80\x894; l7\xe2\x80\x89=\xe2\x80\x891, r7\xe2\x80\x89=\xe2\x80\x890.Your task is to unite all given lists in a single list, joining them to each other in any order. In particular, if the input data already contains a single list, then there is no need to perform any actions. Print the resulting list in the form of values li, ri.Any other action, other than joining the beginning of one list to the end of another, can not be performed." 1500
846F "Random Query" "data structures,math,probabilities,two pointers" "You are given an array a consisting of n positive integers. You pick two integer numbers l and r from 1 to n, inclusive (numbers are picked randomly, equiprobably and independently). If l\xe2\x80\x89>\xe2\x80\x89r, then you swap values of l and r. You have to calculate the expected value of the number of unique elements in segment of the array from index l to index r, inclusive (1-indexed)." 1800
846E "Chemistry in Berland" "dfs and similar,greedy,trees" "Igor is a post-graduate student of chemistry faculty in Berland State University (BerSU). He needs to conduct a complicated experiment to write his thesis, but laboratory of BerSU doesn\'t contain all the materials required for this experiment.Fortunately, chemical laws allow material transformations (yes, chemistry in Berland differs from ours). But the rules of transformation are a bit strange.Berland chemists are aware of n materials, numbered in the order they were discovered. Each material can be transformed into some other material (or vice versa). Formally, for each i (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) there exist two numbers xi and ki that denote a possible transformation: ki kilograms of material xi can be transformed into 1 kilogram of material i, and 1 kilogram of material i can be transformed into 1 kilogram of material xi. Chemical processing equipment in BerSU allows only such transformation that the amount of resulting material is always an integer number of kilograms.For each i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) Igor knows that the experiment requires ai kilograms of material i, and the laboratory contains bi kilograms of this material. Is it possible to conduct an experiment after transforming some materials (or none)?" 2300
846D Monitor "binary search,data structures" "Recently Luba bought a monitor. Monitor is a rectangular matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. But then she started to notice that some pixels cease to work properly. Luba thinks that the monitor will become broken the first moment when it contains a square k\xe2\x80\x89\xc3\x97\xe2\x80\x89k consisting entirely of broken pixels. She knows that q pixels are already broken, and for each of them she knows the moment when it stopped working. Help Luba to determine when the monitor became broken (or tell that it\'s still not broken even after all q pixels stopped working)." 1900
846C "Four Segments" "brute force,data structures,dp" "You are given an array of n integer numbers. Let sum(l,\xe2\x80\x89r) be the sum of all numbers on positions from l to r non-inclusive (l-th element is counted, r-th element is not counted). For indices l and r holds 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Indices in array are numbered from 0. For example, if a\xe2\x80\x89=\xe2\x80\x89[\xe2\x80\x89-\xe2\x80\x895,\xe2\x80\x893,\xe2\x80\x899,\xe2\x80\x894], then sum(0,\xe2\x80\x891)\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x895, sum(0,\xe2\x80\x892)\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892, sum(1,\xe2\x80\x894)\xe2\x80\x89=\xe2\x80\x8916 and sum(i,\xe2\x80\x89i)\xe2\x80\x89=\xe2\x80\x890 for each i from 0 to 4.Choose the indices of three delimiters delim0, delim1, delim2 (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89delim0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89delim1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89delim2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and divide the array in such a way that the value of res\xe2\x80\x89=\xe2\x80\x89sum(0,\xe2\x80\x89delim0) - sum(delim0,\xe2\x80\x89delim1) + sum(delim1,\xe2\x80\x89delim2) - sum(delim2,\xe2\x80\x89n) is maximal. Note that some of the expressions sum(l,\xe2\x80\x89r) can correspond to empty segments (if l\xe2\x80\x89=\xe2\x80\x89r for some segment)." 1800
846B "Math Show" "brute force,greedy" "Polycarp takes part in a math show. He is given n tasks, each consists of k subtasks, numbered 1 through k. It takes him tj minutes to solve the j-th subtask of any task. Thus, time required to solve a subtask depends only on its index, but not on the task itself. Polycarp can solve subtasks in any order.By solving subtask of arbitrary problem he earns one point. Thus, the number of points for task is equal to the number of solved subtasks in it. Moreover, if Polycarp completely solves the task (solves all k of its subtasks), he recieves one extra point. Thus, total number of points he recieves for the complete solution of the task is k\xe2\x80\x89+\xe2\x80\x891.Polycarp has M minutes of time. What is the maximum number of points he can earn?" 1800
846A "Curriculum Vitae" "brute force,implementation" "Hideo Kojima has just quit his job at Konami. Now he is going to find a new place to work. Despite being such a well-known person, he still needs a CV to apply for a job.During all his career Hideo has produced n games. Some of them were successful, some were not. Hideo wants to remove several of them (possibly zero) from his CV to make a better impression on employers. As a result there should be no unsuccessful game which comes right after successful one in his CV.More formally, you are given an array s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn of zeros and ones. Zero corresponds to an unsuccessful game, one \xe2\x80\x94 to a successful one. Games are given in order they were produced, and Hideo can\'t swap these values. He should remove some elements from this array in such a way that no zero comes right after one.Besides that, Hideo still wants to mention as much games in his CV as possible. Help this genius of a man determine the maximum number of games he can leave in his CV." 1500
845G "Shortest Path Problem?" "dfs and similar,graphs,math" "You are given an undirected graph with weighted edges. The length of some path between two vertices is the bitwise xor of weights of all edges belonging to this path (if some edge is traversed more than once, then it is included in bitwise xor the same number of times). You have to find the minimum length of path between vertex 1 and vertex n.Note that graph can contain multiple edges and loops. It is guaranteed that the graph is connected." 2300
845F "Guards In The Storehouse" bitmasks,dp "Polycarp owns a shop in the capital of Berland. Recently the criminal activity in the capital increased, so Polycarp is thinking about establishing some better security in the storehouse of his shop.The storehouse can be represented as a matrix with n rows and m columns. Each element of the matrix is either . (an empty space) or x (a wall).Polycarp wants to hire some guards (possibly zero) to watch for the storehouse. Each guard will be in some cell of matrix and will protect every cell to the right of his own cell and every cell to the bottom of his own cell, until the nearest wall. More formally, if the guard is standing in the cell (x0,\xe2\x80\x89y0), then he protects cell (x1,\xe2\x80\x89y1) if all these conditions are met:  (x1,\xe2\x80\x89y1) is an empty cell;  either x0\xe2\x80\x89=\xe2\x80\x89x1 and y0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y1, or x0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1 and y0\xe2\x80\x89=\xe2\x80\x89y1;  there are no walls between cells (x0,\xe2\x80\x89y0) and (x1,\xe2\x80\x89y1). There can be a guard between these cells, guards can look through each other. Guards can be placed only in empty cells (and can protect only empty cells). The plan of placing the guards is some set of cells where guards will be placed (of course, two plans are different if there exists at least one cell that is included in the first plan, but not included in the second plan, or vice versa). Polycarp calls a plan suitable if there is not more than one empty cell that is not protected.Polycarp wants to know the number of suitable plans. Since it can be very large, you have to output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2500
845E "Fire in the City" "binary search,data structures" "The capital of Berland looks like a rectangle of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m of the square blocks of same size.Fire!It is known that k\xe2\x80\x89+\xe2\x80\x891 blocks got caught on fire (k\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xc2\xb7m). Those blocks are centers of ignition. Moreover positions of k of these centers are known and one of these stays unknown. All k\xe2\x80\x89+\xe2\x80\x891 positions are distinct.The fire goes the following way: during the zero minute of fire only these k\xe2\x80\x89+\xe2\x80\x891 centers of ignition are burning. Every next minute the fire goes to all neighbouring blocks to the one which is burning. You can consider blocks to burn for so long that this time exceeds the time taken in the problem. The neighbouring blocks are those that touch the current block by a side or by a corner.Berland Fire Deparment wants to estimate the minimal time it takes the fire to lighten up the whole city. Remember that the positions of k blocks (centers of ignition) are known and (k\xe2\x80\x89+\xe2\x80\x891)-th can be positioned in any other block.Help Berland Fire Department to estimate the minimal time it takes the fire to lighten up the whole city." 2400
845D "Driving Test" "data structures,dp,greedy" "Polycarp has just attempted to pass the driving test. He ran over the straight road with the signs of four types.  speed limit: this sign comes with a positive integer number \xe2\x80\x94 maximal speed of the car after the sign (cancel the action of the previous sign of this type);  overtake is allowed: this sign means that after some car meets it, it can overtake any other car;  no speed limit: this sign cancels speed limit if any (car can move with arbitrary speed after this sign);  no overtake allowed: some car can\'t overtake any other car after this sign. Polycarp goes past the signs consequentially, each new sign cancels the action of all the previous signs of it\'s kind (speed limit/overtake). It is possible that two or more ""no overtake allowed"" signs go one after another with zero ""overtake is allowed"" signs between them. It works with ""no speed limit"" and ""overtake is allowed"" signs as well.In the beginning of the ride overtake is allowed and there is no speed limit.You are given the sequence of events in chronological order \xe2\x80\x94 events which happened to Polycarp during the ride. There are events of following types:  Polycarp changes the speed of his car to specified (this event comes with a positive integer number);  Polycarp\'s car overtakes the other car;  Polycarp\'s car goes past the ""speed limit"" sign (this sign comes with a positive integer);  Polycarp\'s car goes past the ""overtake is allowed"" sign;  Polycarp\'s car goes past the ""no speed limit"";  Polycarp\'s car goes past the ""no overtake allowed""; It is guaranteed that the first event in chronological order is the event of type 1 (Polycarp changed the speed of his car to specified).After the exam Polycarp can justify his rule violations by telling the driving instructor that he just didn\'t notice some of the signs. What is the minimal number of signs Polycarp should say he didn\'t notice, so that he would make no rule violations from his point of view?" 1800
845C "Two TVs" "data structures,greedy,sortings" "Polycarp is a great fan of television.He wrote down all the TV programs he is interested in for today. His list contains n shows, i-th of them starts at moment li and ends at moment ri.Polycarp owns two TVs. He can watch two different shows simultaneously with two TVs but he can only watch one show at any given moment on a single TV. If one show ends at the same moment some other show starts then you can\'t watch them on a single TV.Polycarp wants to check out all n shows. Are two TVs enough to do so?" 1500
845B "Luba And The Ticket" "brute force,greedy,implementation" "Luba has a ticket consisting of 6 digits. In one move she can choose digit in any position and replace it with arbitrary digit. She wants to know the minimum number of digits she needs to replace in order to make the ticket lucky.The ticket is considered lucky if the sum of first three digits equals to the sum of last three digits." 1600
845A "Chess Tourney" implementation,sortings "Berland annual chess tournament is coming!Organizers have gathered 2\xc2\xb7n chess players who should be divided into two teams with n people each. The first team is sponsored by BerOil and the second team is sponsored by BerMobile. Obviously, organizers should guarantee the win for the team of BerOil.Thus, organizers should divide all 2\xc2\xb7n players into two teams with n people each in such a way that the first team always wins.Every chess player has its rating ri. It is known that chess player with the greater rating always wins the player with the lower rating. If their ratings are equal then any of the players can win.After teams assignment there will come a drawing to form n pairs of opponents: in each pair there is a player from the first team and a player from the second team. Every chess player should be in exactly one pair. Every pair plays once. The drawing is totally random.Is it possible to divide all 2\xc2\xb7n players into two teams with n people each so that the player from the first team in every pair wins regardless of the results of the drawing?" 1100
844B Rectangles combinatorics,math "You are given n\xe2\x80\x89\xc3\x97\xe2\x80\x89m table. Each cell of the table is colored white or black. Find the number of non-empty sets of cells such that:  All cells in a set have the same color.  Every two cells in a set share row or column." 1300
844A Diversity greedy,implementation,strings "Calculate the minimum number of characters you need to change in the string s, so that it contains at least k different letters, or print that it is impossible.String s consists only of lowercase Latin letters, and it is allowed to change characters only to lowercase Latin letters too." 1000
843E "Maximum Flow" flows,graphs "You are given a directed graph, consisting of n vertices and m edges. The vertices s and t are marked as source and sink correspondingly. Additionally, there are no edges ending at s and there are no edges beginning in t.The graph was constructed in a following way: initially each edge had capacity ci\xe2\x80\x89>\xe2\x80\x890. A maximum flow with source at s and sink at t was constructed in this flow network. Let\'s denote fi as the value of flow passing through edge with index i. Next, all capacities ci and flow value fi were erased. Instead, indicators gi were written on edges \xe2\x80\x94 if flow value passing through edge i was positive, i.e. 1 if fi\xe2\x80\x89>\xe2\x80\x890 and 0 otherwise.Using the graph and values gi, find out what is the minimum possible number of edges in the initial flow network that could be saturated (the passing flow is equal to capacity, i.e. fi\xe2\x80\x89=\xe2\x80\x89ci). Also construct the corresponding flow network with maximum flow in it.A flow in directed graph is described by flow values fi on each of the edges so that the following conditions are satisfied:   for each vertex, except source and sink, total incoming flow and total outcoming flow are equal,  for each edge 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89fi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci A flow is maximum if the difference between the sum of flow values on edges from the source, and the sum of flow values on edges to the source (there are no such in this problem), is maximum possible." 3000
843D "Dynamic Shortest Path" "graphs,shortest paths" "You are given a weighted directed graph, consisting of n vertices and m edges. You should answer q queries of two types:  1 v \xe2\x80\x94 find the length of shortest path from vertex 1 to vertex v.  2 c l1 l2 ... lc \xe2\x80\x94 add 1 to weights of edges with indices l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lc." 3400
843C "Upgrading Tree" "constructive algorithms,dfs and similar,graphs,math,trees" "You are given a tree with n vertices and you are allowed to perform no more than 2n transformations on it. Transformation is defined by three vertices x,\xe2\x80\x89y,\xe2\x80\x89y\' and consists of deleting edge (x,\xe2\x80\x89y) and adding edge (x,\xe2\x80\x89y\'). Transformation x,\xe2\x80\x89y,\xe2\x80\x89y\' could be performed if all the following conditions are satisfied:  There is an edge (x,\xe2\x80\x89y) in the current tree.  After the transformation the graph remains a tree.  After the deletion of edge (x,\xe2\x80\x89y) the tree would consist of two connected components. Let\'s denote the set of nodes in the component containing vertex x by Vx, and the set of nodes in the component containing vertex y by Vy. Then condition |Vx|\xe2\x80\x89>\xe2\x80\x89|Vy| should be satisfied, i.e. the size of the component with x should be strictly larger than the size of the component with y. You should minimize the sum of squared distances between all pairs of vertices in a tree, which you could get after no more than 2n transformations and output any sequence of transformations leading initial tree to such state.Note that you don\'t need to minimize the number of operations. It is necessary to minimize only the sum of the squared distances." 2600
843B "Interactive LowerBound" "brute force,interactive,probabilities" "This is an interactive problem.You are given a sorted in increasing order singly linked list. You should find the minimum integer in the list which is greater than or equal to x.More formally, there is a singly liked list built on an array of n elements. Element with index i contains two integers: valuei is the integer value in this element, and nexti that is the index of the next element of the singly linked list (or -1, if the current element is the last). The list is sorted, i.e. if nexti\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891, then valuenexti\xe2\x80\x89>\xe2\x80\x89valuei.You are given the number of elements in the list n, the index of the first element start, and the integer x.You can make up to 2000 queries of the following two types:  ? i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) \xe2\x80\x94 ask the values valuei and nexti,  ! ans \xe2\x80\x94 give the answer for the problem: the minimum integer, greater than or equal to x, or ! -1, if there are no such integers. Your program should terminate after this query. Write a program that solves this problem." 2000
843A "Sorting by Subsequences" "dfs and similar,dsu,implementation,math,sortings" "You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an consisting of different integers. It is required to split this sequence into the maximum number of subsequences such that after sorting integers in each of them in increasing order, the total sequence also will be sorted in increasing order.Sorting integers in a subsequence is a process such that the numbers included in a subsequence are ordered in increasing order, and the numbers which are not included in a subsequence don\'t change their places.Every element of the sequence must appear in exactly one subsequence." 1400
842E "Nikita and game" "binary search,dfs and similar,divide and conquer,graphs,trees" "Nikita plays a new computer game. There are m levels in this game. In the beginning of each level a new class appears in the game; this class is a child-class of the class yi (and yi is called parent-class for this new class). Thus, the classes form a tree. Initially there is only one class with index 1.Changing the class to its neighbour (child-class or parent-class) in the tree costs 1 coin. You can not change the class back. The cost of changing the class a to the class b is equal to the total cost of class changes on the path from a to b in the class tree.Suppose that at i -th level the maximum cost of changing one class to another is x. For each level output the number of classes such that for each of these classes there exists some other class y, and the distance from this class to y is exactly x." 2800
842D "Vitya and Strange Lesson" "binary search,data structures" "Today at the lesson Vitya learned a very interesting function \xe2\x80\x94 mex. Mex of a sequence of numbers is the minimum non-negative number that is not present in the sequence as element. For example, mex([4,\xe2\x80\x8933,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x895])\xe2\x80\x89=\xe2\x80\x892 and mex([1,\xe2\x80\x892,\xe2\x80\x893])\xe2\x80\x89=\xe2\x80\x890.Vitya quickly understood all tasks of the teacher, but can you do the same?You are given an array consisting of n non-negative integers, and m queries. Each query is characterized by one number x and consists of the following consecutive steps:  Perform the bitwise addition operation modulo 2 (xor) of each array element with the number x.  Find mex of the resulting array. Note that after each query the array changes." 2000
842C "Ilya And The Tree" "dfs and similar,graphs,math,number theory,trees" "Ilya is very fond of graphs, especially trees. During his last trip to the forest Ilya found a very interesting tree rooted at vertex 1. There is an integer number written on each vertex of the tree; the number written on vertex i is equal to ai.Ilya believes that the beauty of the vertex x is the greatest common divisor of all numbers written on the vertices on the path from the root to x, including this vertex itself. In addition, Ilya can change the number in one arbitrary vertex to 0 or leave all vertices unchanged. Now for each vertex Ilya wants to know the maximum possible beauty it can have.For each vertex the answer must be considered independently.The beauty of the root equals to number written on it." 2000
842B "Gleb And Pizza" geometry "Gleb ordered pizza home. When the courier delivered the pizza, he was very upset, because several pieces of sausage lay on the crust, and he does not really like the crust.The pizza is a circle of radius r and center at the origin. Pizza consists of the main part \xe2\x80\x94 circle of radius r\xe2\x80\x89-\xe2\x80\x89d with center at the origin, and crust around the main part of the width d. Pieces of sausage are also circles. The radius of the i -th piece of the sausage is ri, and the center is given as a pair (xi, yi).Gleb asks you to help determine the number of pieces of sausage caught on the crust. A piece of sausage got on the crust, if it completely lies on the crust." 1100
842A "Kirill And The Game" "brute force,two pointers" "Kirill plays a new computer game. He came to the potion store where he can buy any potion. Each potion is characterized by two integers \xe2\x80\x94 amount of experience and cost. The efficiency of a potion is the ratio of the amount of experience to the cost. Efficiency may be a non-integer number.For each two integer numbers a and b such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y there is a potion with experience a and cost b in the store (that is, there are (r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891) potions).Kirill wants to buy a potion which has efficiency k. Will he be able to do this?" 1200
841B Godsend games,math "Leha somehow found an array consisting of n integers. Looking at it, he came up with a task. Two players play the game on the array. Players move one by one. The first player can choose for his move a subsegment of non-zero length with an odd sum of numbers and remove it from the array, after that the remaining parts are glued together into one array and the game continues. The second player can choose a subsegment of non-zero length with an even sum and remove it. Loses the one who can not make a move. Who will win if both play optimally?" 1100
841A "Generous Kefa" "brute force,implementation" "One day Kefa found n baloons. For convenience, we denote color of i-th baloon as si \xe2\x80\x94 lowercase letter of the Latin alphabet. Also Kefa has k friends. Friend will be upset, If he get two baloons of the same color. Kefa want to give out all baloons to his friends. Help Kefa to find out, can he give out all his baloons, such that no one of his friens will be upset \xe2\x80\x94 print \xc2\xabYES\xc2\xbb, if he can, and \xc2\xabNO\xc2\xbb, otherwise. Note, that Kefa\'s friend will not upset, if he doesn\'t get baloons at all." 900
840E "In a Trap" trees "Lech got into a tree consisting of n vertices with a root in vertex number 1. At each vertex i written integer ai. He will not get out until he answers q queries of the form u v. Answer for the query is maximal value  among all vertices i on path from u to v including u and v, where dist(i,\xe2\x80\x89v) is number of edges on path from i to v. Also guaranteed that vertex u is ancestor of vertex v. Leha\'s tastes are very singular: he believes that vertex is ancestor of itself.Help Leha to get out.The expression  means the bitwise exclusive OR to the numbers x and y.Note that vertex u is ancestor of vertex v if vertex u lies on the path from root to the vertex v." 3200
840D Destiny "data structures,probabilities" "Once, Leha found in the left pocket an array consisting of n integers, and in the right pocket q queries of the form l r k. If there are queries, then they must be answered. Answer for the query is minimal x such that x occurs in the interval l r strictly more than  times or \xe2\x80\x89-\xe2\x80\x891 if there is no such number. Help Leha with such a difficult task." 2500
840C "On the Bench" combinatorics,dp "A year ago on the bench in public park Leha found an array of n numbers. Leha believes that permutation p is right if for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n condition, that api\xc2\xb7api\xe2\x80\x89+\xe2\x80\x891 is not perfect square, holds. Leha wants to find number of right permutations modulo 109\xe2\x80\x89+\xe2\x80\x897." 2500
840B "Leha and another game about graph" "constructive algorithms,data structures,dfs and similar,dp,graphs" "Leha plays a computer game, where is on each level is given a connected graph with n vertices and m edges. Graph can contain multiple edges, but can not contain self loops. Each vertex has an integer di, which can be equal to 0, 1 or \xe2\x80\x89-\xe2\x80\x891. To pass the level, he needs to find a \xc2\xabgood\xc2\xbb subset of edges of the graph or say, that it doesn\'t exist. Subset is called \xc2\xabgood\xc2\xbb, if by by leaving only edges from this subset in the original graph, we obtain the following: for every vertex i, di\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891 or it\'s degree modulo 2 is equal to di. Leha wants to pass the game as soon as possible and ask you to help him. In case of multiple correct answers, print any of them." 2100
840A "Leha and Function" "combinatorics,greedy,math,number theory,sortings" "Leha like all kinds of strange things. Recently he liked the function F(n,\xe2\x80\x89k). Consider all possible k-element subsets of the set [1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n]. For subset find minimal element in it. F(n,\xe2\x80\x89k) \xe2\x80\x94 mathematical expectation of the minimal element among all k-element subsets.But only function does not interest him. He wants to do interesting things with it. Mom brought him two arrays A and B, each consists of m integers. For all i,\xe2\x80\x89j such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m the condition Ai\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89Bj holds. Help Leha rearrange the numbers in the array A so that the sum  is maximally possible, where A\' is already rearranged array." 1300
839E "Mother of Dragons" "brute force,graphs,math,meet-in-the-middle" "There are n castles in the Lannister\'s Kingdom and some walls connect two castles, no two castles are connected by more than one wall, no wall connects a castle to itself. Sir Jaime Lannister has discovered that Daenerys Targaryen is going to attack his kingdom soon. Therefore he wants to defend his kingdom. He has k liters of a strange liquid. He wants to distribute that liquid among the castles, so each castle may contain some liquid (possibly zero or non-integer number of liters). After that the stability of a wall is defined as follows: if the wall connects two castles a and b, and they contain x and y liters of that liquid, respectively, then the strength of that wall is x\xc2\xb7y.Your task is to print the maximum possible sum of stabilities of the walls that Sir Jaime Lannister can achieve." 2700
839D "Winter is here" "combinatorics,dp,math,number theory" "Winter is here at the North and the White Walkers are close. John Snow has an army consisting of n soldiers. While the rest of the world is fighting for the Iron Throne, he is going to get ready for the attack of the White Walkers.He has created a method to know how strong his army is. Let the i-th soldier\xe2\x80\x99s strength be ai. For some k he calls i1,\xe2\x80\x89i2,\xe2\x80\x89...,\xe2\x80\x89ik a clan if i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89i3\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ik and gcd(ai1,\xe2\x80\x89ai2,\xe2\x80\x89...,\xe2\x80\x89aik)\xe2\x80\x89>\xe2\x80\x891 . He calls the strength of that clan k\xc2\xb7gcd(ai1,\xe2\x80\x89ai2,\xe2\x80\x89...,\xe2\x80\x89aik). Then he defines the strength of his army by the sum of strengths of all possible clans.Your task is to find the strength of his army. As the number may be very large, you have to print it modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897).Greatest common divisor (gcd) of a sequence of integers is the maximum possible integer so that each element of the sequence is divisible by it." 2200
839C Journey "dfs and similar,dp,graphs,probabilities,trees" "There are n cities and n\xe2\x80\x89-\xe2\x80\x891 roads in the Seven Kingdoms, each road connects two cities and we can reach any city from any other by the roads.Theon and Yara Greyjoy are on a horse in the first city, they are starting traveling through the roads. But the weather is foggy, so they can\xe2\x80\x99t see where the horse brings them. When the horse reaches a city (including the first one), it goes to one of the cities connected to the current city. But it is a strange horse, it only goes to cities in which they weren\'t before. In each such city, the horse goes with equal probabilities and it stops when there are no such cities. Let the length of each road be 1. The journey starts in the city 1. What is the expected length (expected value of length) of their journey? You can read about expected (average) value by the link https://en.wikipedia.org/wiki/Expected_value." 1500
839B "Game of the Rows" "brute force,greedy,implementation" "Daenerys Targaryen has an army consisting of k groups of soldiers, the i-th group contains ai soldiers. She wants to bring her army to the other side of the sea to get the Iron Throne. She has recently bought an airplane to carry her army through the sea. The airplane has n rows, each of them has 8 seats. We call two seats neighbor, if they are in the same row and in seats {1,\xe2\x80\x892}, {3,\xe2\x80\x894}, {4,\xe2\x80\x895}, {5,\xe2\x80\x896} or {7,\xe2\x80\x898}.  A row in the airplane Daenerys Targaryen wants to place her army in the plane so that there are no two soldiers from different groups sitting on neighboring seats.Your task is to determine if there is a possible arranging of her army in the airplane such that the condition above is satisfied." 1900
839A "Arya and Bran" implementation "Bran and his older sister Arya are from the same house. Bran like candies so much, so Arya is going to give him some Candies.At first, Arya and Bran have 0 Candies. There are n days, at the i-th day, Arya finds ai candies in a box, that is given by the Many-Faced God. Every day she can give Bran at most 8 of her candies. If she don\'t give him the candies at the same day, they are saved for her and she can give them to him later.Your task is to find the minimum number of days Arya needs to give Bran k candies before the end of the n-th day. Formally, you need to output the minimum day index to the end of which k candies will be given out (the days are indexed from 1 to n).Print -1 if she can\'t give him k candies during n given days." 900
838F "Expected Earnings" NA "You are playing a game with a bag of red and black balls. Initially, you are told that the bag has n balls total. In addition, you are also told that the bag has probability pi\xe2\x80\x89/\xe2\x80\x89106 of containing exactly i red balls.You now would like to buy balls from this bag. You really like the color red, so red balls are worth a unit of 1, while black balls are worth nothing. To buy a ball, if there are still balls in the bag, you pay a cost c with 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891, and draw a ball randomly from the bag. You can choose to stop buying at any point (and you can even choose to not buy anything at all).Given that you buy optimally to maximize the expected profit (i.e. # red balls - cost needed to obtain them), print the maximum expected profit." 2800
838E "Convex Countour" dp "You are given an strictly convex polygon with n vertices. It is guaranteed that no three points are collinear. You would like to take a maximum non intersecting path on the polygon vertices that visits each point at most once.More specifically your path can be represented as some sequence of distinct polygon vertices. Your path is the straight line segments between adjacent vertices in order. These segments are not allowed to touch or intersect each other except at the vertices in your sequence.Given the polygon, print the maximum length non-intersecting path that visits each point at most once." 2300
838D "Airplane Arrangements" "math,number theory" "There is an airplane which has n rows from front to back. There will be m people boarding this airplane.This airplane has an entrance at the very front and very back of the plane.Each person has some assigned seat. It is possible for multiple people to have the same assigned seat. The people will then board the plane one by one starting with person 1. Each person can independently choose either the front entrance or back entrance to enter the plane.When a person walks into the plane, they walk directly to their assigned seat and will try to sit in it. If it is occupied, they will continue walking in the direction they walked in until they are at empty seat - they will take the earliest empty seat that they can find. If they get to the end of the row without finding a seat, they will be angry.Find the number of ways to assign tickets to the passengers and board the plane without anyone getting angry. Two ways are different if there exists a passenger who chose a different entrance in both ways, or the assigned seat is different. Print this count modulo 109\xe2\x80\x89+\xe2\x80\x897." 2700
838C "Future Failure" dp,games "Alice and Bob are playing a game with a string of characters, with Alice going first. The string consists n characters, each of which is one of the first k letters of the alphabet. On a player\xe2\x80\x99s turn, they can either arbitrarily permute the characters in the words, or delete exactly one character in the word (if there is at least one character). In addition, their resulting word cannot have appeared before throughout the entire game. The player unable to make a valid move loses the game.Given n,\xe2\x80\x89k,\xe2\x80\x89p, find the number of words with exactly n characters consisting of the first k letters of the alphabet such that Alice will win if both Alice and Bob play optimally. Return this number modulo the prime number p." 2800
838B "Diverging Directions" "data structures,dfs and similar,trees" "You are given a directed weighted graph with n nodes and 2n\xe2\x80\x89-\xe2\x80\x892 edges. The nodes are labeled from 1 to n, while the edges are labeled from 1 to 2n\xe2\x80\x89-\xe2\x80\x892. The graph\'s edges can be split into two parts.  The first n\xe2\x80\x89-\xe2\x80\x891 edges will form a rooted spanning tree, with node 1 as the root. All these edges will point away from the root.  The last n\xe2\x80\x89-\xe2\x80\x891 edges will be from node i to node 1, for all 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. You are given q queries. There are two types of queries  1 i w: Change the weight of the i-th edge to w  2 u v: Print the length of the shortest path between nodes u to v Given these queries, print the shortest path lengths." 2100
838A "Binary Blocks" "brute force" "You are given an image, that can be represented with a 2-d n by m grid of pixels. Each pixel of the image is either on or off, denoted by the characters ""0"" or ""1"", respectively. You would like to compress this image. You want to choose an integer k\xe2\x80\x89>\xe2\x80\x891 and split the image into k by k blocks. If n and m are not divisible by k, the image is padded with only zeros on the right and bottom so that they are divisible by k. Each pixel in each individual block must have the same value. The given image may not be compressible in its current state. Find the minimum number of pixels you need to toggle (after padding) in order for the image to be compressible for some k. More specifically, the steps are to first choose k, then the image is padded with zeros, then, we can toggle the pixels so it is compressible for this k. The image must be compressible in that state." 1400
837G "Functions On The Segments" "data structures" "You have an array f of n functions.The function fi(x) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) is characterized by parameters: x1,\xe2\x80\x89x2,\xe2\x80\x89y1,\xe2\x80\x89a,\xe2\x80\x89b,\xe2\x80\x89y2 and take values:   y1, if x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x1.  a\xc2\xb7x\xe2\x80\x89+\xe2\x80\x89b, if x1\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2.  y2, if x\xe2\x80\x89>\xe2\x80\x89x2. There are m queries. Each query is determined by numbers l, r and x. For a query with number i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), you need to calculate the sum of all fj(xi) where l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. The value of xi is calculated as follows: xi\xe2\x80\x89=\xe2\x80\x89(x\xe2\x80\x89+\xe2\x80\x89last) mod 109, where last is the answer to the query with number i\xe2\x80\x89-\xe2\x80\x891. The value of last equals 0 if i\xe2\x80\x89=\xe2\x80\x891." 2500
837F "Prefix Sums" "binary search,brute force,combinatorics,math,matrices" "Consider the function p(x), where x is an array of m integers, which returns an array y consisting of m\xe2\x80\x89+\xe2\x80\x891 integers such that yi is equal to the sum of first i elements of array x (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m).You have an infinite sequence of arrays A0,\xe2\x80\x89A1,\xe2\x80\x89A2..., where A0 is given in the input, and for each i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891 Ai\xe2\x80\x89=\xe2\x80\x89p(Ai\xe2\x80\x89-\xe2\x80\x891). Also you have a positive integer k. You have to find minimum possible i such that Ai contains a number which is larger or equal than k." 2400
837E "Vasya\'s Function" "binary search,implementation,math" "Vasya is studying number theory. He has denoted a function f(a,\xe2\x80\x89b) such that:  f(a,\xe2\x80\x890)\xe2\x80\x89=\xe2\x80\x890;  f(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89f(a,\xe2\x80\x89b\xe2\x80\x89-\xe2\x80\x89gcd(a,\xe2\x80\x89b)), where gcd(a,\xe2\x80\x89b) is the greatest common divisor of a and b. Vasya has two numbers x and y, and he wants to calculate f(x,\xe2\x80\x89y). He tried to do it by himself, but found out that calculating this function the way he wants to do that might take very long time. So he decided to ask you to implement a program that will calculate this function swiftly." 2100
837D "Round Subset" dp,math "Let\'s call the roundness of the number the number of zeros to which it ends.You have an array of n numbers. You need to choose a subset of exactly k numbers so that the roundness of the product of the selected numbers will be maximum possible." 2100
837C "Two Seals" "brute force,implementation" "One very important person has a piece of paper in the form of a rectangle a\xe2\x80\x89\xc3\x97\xe2\x80\x89b.Also, he has n seals. Each seal leaves an impression on the paper in the form of a rectangle of the size xi\xe2\x80\x89\xc3\x97\xe2\x80\x89yi. Each impression must be parallel to the sides of the piece of paper (but seal can be rotated by 90 degrees).A very important person wants to choose two different seals and put them two impressions. Each of the selected seals puts exactly one impression. Impressions should not overlap (but they can touch sides), and the total area occupied by them should be the largest possible. What is the largest area that can be occupied by two seals?" 1500
837B "Flag of Berland" "brute force,implementation" "The flag of Berland is such rectangular field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m that satisfies following conditions:  Flag consists of three colors which correspond to letters \'R\', \'G\' and \'B\'.  Flag consists of three equal in width and height stripes, parralel to each other and to sides of the flag. Each stripe has exactly one color.  Each color should be used in exactly one stripe. You are given a field n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, consisting of characters \'R\', \'G\' and \'B\'. Output ""YES"" (without quotes) if this field corresponds to correct flag of Berland. Otherwise, print ""NO"" (without quotes)." 1600
837A "Text Volume" implementation "You are given a text of single-space separated words, consisting of small and capital Latin letters.Volume of the word is number of capital letters in the word. Volume of the text is maximum volume of all words in the text.Calculate the volume of the given text." 800
835F "Roads in the Kingdom" "dfs and similar,dp,graphs,trees" "In the Kingdom K., there are n towns numbered with integers from 1 to n. The towns are connected by n bi-directional roads numbered with integers from 1 to n. The i-th road connects the towns ui and vi and its length is li. There is no more than one road between two towns. Also, there are no roads that connect the towns with itself.Let\'s call the inconvenience of the roads the maximum of the shortest distances between all pairs of towns.Because of lack of money, it was decided to close down one of the roads so that after its removal it is still possible to reach any town from any other. You have to find the minimum possible inconvenience of the roads after closing down one of the roads." 2500
835E "The penguin\'s game" "binary search,constructive algorithms,interactive" "Pay attention: this problem is interactive.Penguin Xoriy came up with a new game recently. He has n icicles numbered from 1 to n. Each icicle has a temperature \xe2\x80\x94 an integer from 1 to 109. Exactly two of these icicles are special: their temperature is y, while a temperature of all the others is x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y. You have to find those special icicles. You can choose a non-empty subset of icicles and ask the penguin what is the bitwise exclusive OR (XOR) of the temperatures of the icicles in this subset. Note that you can\'t ask more than 19 questions.You are to find the special icicles." 2400
835D "Palindromic characteristics" "brute force,dp,hashing,strings" "Palindromic characteristics of string s with length |s| is a sequence of |s| integers, where k-th number is the total number of non-empty substrings of s which are k-palindromes.A string is 1-palindrome if and only if it reads the same backward as forward.A string is k-palindrome (k\xe2\x80\x89>\xe2\x80\x891) if and only if:   Its left half equals to its right half.  Its left and right halfs are non-empty (k\xe2\x80\x89-\xe2\x80\x891)-palindromes. The left half of string t is its prefix of length \xe2\x8c\x8a|t|\xe2\x80\x89/\xe2\x80\x892\xe2\x8c\x8b, and right half \xe2\x80\x94 the suffix of the same length. \xe2\x8c\x8a|t|\xe2\x80\x89/\xe2\x80\x892\xe2\x8c\x8b denotes the length of string t divided by 2, rounded down.Note that each substring is counted as many times as it appears in the string. For example, in the string ""aaa"" the substring ""a"" appears 3 times." 1900
835C "Star sky" dp,implementation "The Cartesian coordinate system is set in the sky. There you can see n stars, the i-th has coordinates (xi, yi), a maximum brightness c, equal for all stars, and an initial brightness si (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89si\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c).Over time the stars twinkle. At moment 0 the i-th star has brightness si. Let at moment t some star has brightness x. Then at moment (t\xe2\x80\x89+\xe2\x80\x891) this star will have brightness x\xe2\x80\x89+\xe2\x80\x891, if x\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c, and 0, otherwise.You want to look at the sky q times. In the i-th time you will look at the moment ti and you will see a rectangle with sides parallel to the coordinate axes, the lower left corner has coordinates (x1i, y1i) and the upper right \xe2\x80\x94 (x2i, y2i). For each view, you want to know the total brightness of the stars lying in the viewed rectangle.A star lies in a rectangle if it lies on its border or lies strictly inside it." 1600
835B "The number on the board" greedy "Some natural number was written on the board. Its sum of digits was not less than k. But you were distracted a bit, and someone changed this number to n, replacing some digits with others. It\'s known that the length of the number didn\'t change.You have to find the minimum number of digits in which these two numbers can differ." 1100
835A "Key races" math "Two boys decided to compete in text typing on the site ""Key races"". During the competition, they have to type a text consisting of s characters. The first participant types one character in v1 milliseconds and has ping t1 milliseconds. The second participant types one character in v2 milliseconds and has ping t2 milliseconds.If connection ping (delay) is t milliseconds, the competition passes for a participant as follows:   Exactly after t milliseconds after the start of the competition the participant receives the text to be entered.  Right after that he starts to type it.  Exactly t milliseconds after he ends typing all the text, the site receives information about it. The winner is the participant whose information on the success comes earlier. If the information comes from both participants at the same time, it is considered that there is a draw.Given the length of the text and the information about participants, determine the result of the game." 800
834B "The Festive Evening" "data structures,implementation" "It\'s the end of July \xe2\x80\x93 the time when a festive evening is held at Jelly Castle! Guests from all over the kingdom gather here to discuss new trends in the world of confectionery. Yet some of the things discussed here are not supposed to be disclosed to the general public: the information can cause discord in the kingdom of Sweetland in case it turns out to reach the wrong hands. So it\'s a necessity to not let any uninvited guests in.There are 26 entrances in Jelly Castle, enumerated with uppercase English letters from A to Z. Because of security measures, each guest is known to be assigned an entrance he should enter the castle through. The door of each entrance is opened right before the first guest\'s arrival and closed right after the arrival of the last guest that should enter the castle through this entrance. No two guests can enter the castle simultaneously.For an entrance to be protected from possible intrusion, a candy guard should be assigned to it. There are k such guards in the castle, so if there are more than k opened doors, one of them is going to be left unguarded! Notice that a guard can\'t leave his post until the door he is assigned to is closed.Slastyona had a suspicion that there could be uninvited guests at the evening. She knows the order in which the invited guests entered the castle, and wants you to help her check whether there was a moment when more than k doors were opened." 1100
834A "The Useless Toy" implementation "Walking through the streets of Marshmallow City, Slastyona have spotted some merchants selling a kind of useless toy which is very popular nowadays \xe2\x80\x93 caramel spinner! Wanting to join the craze, she has immediately bought the strange contraption.Spinners in Sweetland have the form of V-shaped pieces of caramel. Each spinner can, well, spin around an invisible magic axis. At a specific point in time, a spinner can take 4 positions shown below (each one rotated 90 degrees relative to the previous, with the fourth one followed by the first one):  After the spinner was spun, it starts its rotation, which is described by a following algorithm: the spinner maintains its position for a second then majestically switches to the next position in clockwise or counter-clockwise order, depending on the direction the spinner was spun in.Slastyona managed to have spinner rotating for exactly n seconds. Being fascinated by elegance of the process, she completely forgot the direction the spinner was spun in! Lucky for her, she managed to recall the starting position, and wants to deduct the direction given the information she knows. Help her do this." 900
833E "Caramel Clouds" "data structures,dp,sortings" "It is well-known that the best decoration for a flower bed in Sweetland are vanilla muffins. Seedlings of this plant need sun to grow up. Slastyona has m seedlings, and the j-th seedling needs at least kj minutes of sunlight to grow up.Most of the time it\'s sunny in Sweetland, but sometimes some caramel clouds come, the i-th of which will appear at time moment (minute) li and disappear at time moment ri. Of course, the clouds make shadows, and the seedlings can\'t grow when there is at least one cloud veiling the sun.Slastyona wants to grow up her muffins as fast as possible. She has exactly C candies, which is the main currency in Sweetland. One can dispel any cloud by paying ci candies. However, in order to comply with Sweetland\'s Department of Meteorology regulations, one can\'t dispel more than two clouds.Slastyona hasn\'t decided yet which of the m seedlings will be planted at the princess\' garden, so she needs your help. For each seedling determine the earliest moment it can grow up if Slastyona won\'t break the law and won\'t spend more candies than she has. Note that each of the seedlings is considered independently.The seedlings start to grow at time moment 0." 3400
833D "Red-Black Cobweb" "data structures,divide and conquer,implementation,trees" "Slastyona likes to watch life of nearby grove\'s dwellers. This time she watches a strange red-black spider sitting at the center of a huge cobweb.The cobweb is a set of n nodes connected by threads, each of the treads is either red of black. Using these threads, the spider can move between nodes. No thread connects a node to itself, and between any two nodes there is a unique sequence of threads connecting them.Slastyona decided to study some special qualities of the cobweb. She noticed that each of the threads has a value of clamminess x.However, Slastyona is mostly interested in jelliness of the cobweb. Consider those of the shortest paths between each pair of nodes on which the numbers of red and black threads differ at most twice. For each such path compute the product of the clamminess of threads on the path.The jelliness of the cobweb is the product of all obtained values among all paths. Those paths that differ by direction only are counted only once.Of course, this number can be huge, so Slastyona asks you to compute the jelliness of the given cobweb and print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 2800
833C "Ever-Hungry Krakozyabra" "brute force,combinatorics,greedy,math" "Recently, a wild Krakozyabra appeared at Jelly Castle. It is, truth to be said, always eager to have something for dinner.Its favorite meal is natural numbers (typically served with honey sauce), or, to be more precise, the zeros in their corresponding decimal representations. As for other digits, Krakozyabra dislikes them; moreover, they often cause it indigestion! So, as a necessary precaution, Krakozyabra prefers to sort the digits of a number in non-descending order before proceeding to feast. Then, the leading zeros of the resulting number are eaten and the remaining part is discarded as an inedible tail.For example, if Krakozyabra is to have the number 57040 for dinner, its inedible tail would be the number 457.Slastyona is not really fond of the idea of Krakozyabra living in her castle. Hovewer, her natural hospitality prevents her from leaving her guest without food. Slastyona has a range of natural numbers from L to R, which she is going to feed the guest with. Help her determine how many distinct inedible tails are going to be discarded by Krakozyabra by the end of the dinner." 2700
833B "The Bakery" "binary search,data structures,divide and conquer,dp,two pointers" "Some time ago Slastyona the Sweetmaid decided to open her own bakery! She bought required ingredients and a wonder-oven which can bake several types of cakes, and opened the bakery.Soon the expenses started to overcome the income, so Slastyona decided to study the sweets market. She learned it\'s profitable to pack cakes in boxes, and that the more distinct cake types a box contains (let\'s denote this number as the value of the box), the higher price it has.She needs to change the production technology! The problem is that the oven chooses the cake types on its own and Slastyona can\'t affect it. However, she knows the types and order of n cakes the oven is going to bake today. Slastyona has to pack exactly k boxes with cakes today, and she has to put in each box several (at least one) cakes the oven produced one right after another (in other words, she has to put in a box a continuous segment of cakes).Slastyona wants to maximize the total value of all boxes with cakes. Help her determine this maximum possible total value." 2200
833A "The Meaningless Game" "math,number theory" "Slastyona and her loyal dog Pushok are playing a meaningless game that is indeed very interesting.The game consists of multiple rounds. Its rules are very simple: in each round, a natural number k is chosen. Then, the one who says (or barks) it faster than the other wins the round. After that, the winner\'s score is multiplied by k2, and the loser\'s score is multiplied by k. In the beginning of the game, both Slastyona and Pushok have scores equal to one.Unfortunately, Slastyona had lost her notepad where the history of all n games was recorded. She managed to recall the final results for each games, though, but all of her memories of them are vague. Help Slastyona verify their correctness, or, to put it another way, for each given pair of scores determine whether it was possible for a game to finish with such result or not." 1700
832E "Vasya and Shifts" matrices "Vasya has a set of 4n strings of equal length, consisting of lowercase English letters ""a"", ""b"", ""c"", ""d"" and ""e"". Moreover, the set is split into n groups of 4 equal strings each. Vasya also has one special string a of the same length, consisting of letters ""a"" only.Vasya wants to obtain from string a some fixed string b, in order to do this, he can use the strings from his set in any order. When he uses some string x, each of the letters in string a replaces with the next letter in alphabet as many times as the alphabet position, counting from zero, of the corresponding letter in string x. Within this process the next letter in alphabet after ""e"" is ""a"".For example, if some letter in a equals ""b"", and the letter on the same position in x equals ""c"", then the letter in a becomes equal ""d"", because ""c"" is the second alphabet letter, counting from zero. If some letter in a equals ""e"", and on the same position in x is ""d"", then the letter in a becomes ""c"". For example, if the string a equals ""abcde"", and string x equals ""baddc"", then a becomes ""bbabb"".A used string disappears, but Vasya can use equal strings several times.Vasya wants to know for q given strings b, how many ways there are to obtain from the string a string b using the given set of 4n strings? Two ways are different if the number of strings used from some group of 4 strings is different. Help Vasya compute the answers for these questions modulo 109\xe2\x80\x89+\xe2\x80\x897." 2600
832D "Misha, Grisha and Underground" "dfs and similar,graphs,trees" "Misha and Grisha are funny boys, so they like to use new underground. The underground has n stations connected with n\xe2\x80\x89-\xe2\x80\x891 routes so that each route connects two stations, and it is possible to reach every station from any other.The boys decided to have fun and came up with a plan. Namely, in some day in the morning Misha will ride the underground from station s to station f by the shortest path, and will draw with aerosol an ugly text ""Misha was here"" on every station he will pass through (including s and f). After that on the same day at evening Grisha will ride from station t to station f by the shortest path and will count stations with Misha\'s text. After that at night the underground workers will wash the texts out, because the underground should be clean. The boys have already chosen three stations a, b and c for each of several following days, one of them should be station s on that day, another should be station f, and the remaining should be station t. They became interested how they should choose these stations s, f, t so that the number Grisha will count is as large as possible. They asked you for help." 1900
832C "Strange Radiation" "binary search,implementation,math" "n people are standing on a coordinate axis in points with positive integer coordinates strictly less than 106. For each person we know in which direction (left or right) he is facing, and his maximum speed.You can put a bomb in some point with non-negative integer coordinate, and blow it up. At this moment all people will start running with their maximum speed in the direction they are facing. Also, two strange rays will start propagating from the bomb with speed s: one to the right, and one to the left. Of course, the speed s is strictly greater than people\'s maximum speed.The rays are strange because if at any moment the position and the direction of movement of some ray and some person coincide, then the speed of the person immediately increases by the speed of the ray.You need to place the bomb is such a point that the minimum time moment in which there is a person that has run through point 0, and there is a person that has run through point 106, is as small as possible. In other words, find the minimum time moment t such that there is a point you can place the bomb to so that at time moment t some person has run through 0, and some person has run through point 106." 2500
832B "Petya and Exam" implementation,strings "It\'s hard times now. Today Petya needs to score 100 points on Informatics exam. The tasks seem easy to Petya, but he thinks he lacks time to finish them all, so he asks you to help with one..There is a glob pattern in the statements (a string consisting of lowercase English letters, characters ""?"" and ""*""). It is known that character ""*"" occurs no more than once in the pattern.Also, n query strings are given, it is required to determine for each of them if the pattern matches it or not.Everything seemed easy to Petya, but then he discovered that the special pattern characters differ from their usual meaning.A pattern matches a string if it is possible to replace each character ""?"" with one good lowercase English letter, and the character ""*"" (if there is one) with any, including empty, string of bad lowercase English letters, so that the resulting string is the same as the given string.The good letters are given to Petya. All the others are bad." 1600
832A "Sasha and Sticks" games,math "It\'s one more school day now. Sasha doesn\'t like classes and is always bored at them. So, each day he invents some game and plays in it alone or with friends.Today he invented one simple game to play with Lena, with whom he shares a desk. The rules are simple. Sasha draws n sticks in a row. After that the players take turns crossing out exactly k sticks from left or right in each turn. Sasha moves first, because he is the inventor of the game. If there are less than k sticks on the paper before some turn, the game ends. Sasha wins if he makes strictly more moves than Lena. Sasha wants to know the result of the game before playing, you are to help him." 800
831C "Jury Marks" "brute force,constructive algorithms" "Polycarp watched TV-show where k jury members one by one rated a participant by adding him a certain number of points (may be negative, i. e. points were subtracted). Initially the participant had some score, and each the marks were one by one added to his score. It is known that the i-th jury member gave ai points.Polycarp does not remember how many points the participant had before this k marks were given, but he remembers that among the scores announced after each of the k judges rated the participant there were n (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) values b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn (it is guaranteed that all values bj are distinct). It is possible that Polycarp remembers not all of the scores announced, i. e. n\xe2\x80\x89<\xe2\x80\x89k. Note that the initial score wasn\'t announced.Your task is to determine the number of options for the score the participant could have before the judges rated the participant." 1700
831B "Keyboard Layouts" implementation,strings "There are two popular keyboard layouts in Berland, they differ only in letters positions. All the other keys are the same. In Berland they use alphabet with 26 letters which coincides with English alphabet.You are given two strings consisting of 26 distinct letters each: all keys of the first and the second layouts in the same order. You are also given some text consisting of small and capital English letters and digits. It is known that it was typed in the first layout, but the writer intended to type it in the second layout. Print the text if the same keys were pressed in the second layout.Since all keys but letters are the same in both layouts, the capitalization of the letters should remain the same, as well as all other characters." 800
831A "Unimodal Array" implementation "Array of integers is unimodal, if:  it is strictly increasing in the beginning;  after that it is constant;  after that it is strictly decreasing. The first block (increasing) and the last block (decreasing) may be absent. It is allowed that both of this blocks are absent.For example, the following three arrays are unimodal: [5,\xe2\x80\x897,\xe2\x80\x8911,\xe2\x80\x8911,\xe2\x80\x892,\xe2\x80\x891], [4,\xe2\x80\x894,\xe2\x80\x892], [7], but the following three are not unimodal: [5,\xe2\x80\x895,\xe2\x80\x896,\xe2\x80\x896,\xe2\x80\x891], [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x892], [4,\xe2\x80\x895,\xe2\x80\x895,\xe2\x80\x896].Write a program that checks if an array is unimodal." 1000
830E "Perpetual Motion Machine" "constructive algorithms,dp,graphs,implementation,math,trees" "Developer Petr thinks that he invented a perpetual motion machine. Namely, he has a lot of elements, which work in the following way.Each element has one controller that can be set to any non-negative real value. If a controller is set on some value x, then the controller consumes x2 energy units per second. At the same time, any two elements connected by a wire produce y\xc2\xb7z energy units per second, where y and z are the values set on their controllers.Petr has only a limited number of wires, so he has already built some scheme of elements and wires, and is now interested if it\'s possible to set the controllers in such a way that the system produces at least as much power as it consumes, and at least one controller is set on the value different from 0. Help him check this, and if it\'s possible, find the required integer values that should be set.It is guaranteed that if there exist controllers\' settings satisfying the above conditions, then there exist required integer values not greater than 106." 3100
830D "Singer House" combinatorics,dp,graphs,trees "It is known that passages in Singer house are complex and intertwined. Let\'s define a Singer k-house as a graph built by the following process: take complete binary tree of height k and add edges from each vertex to all its successors, if they are not yet present.  Singer 4-house Count the number of non-empty paths in Singer k-house which do not pass the same vertex twice. Two paths are distinct if the sets or the orders of visited vertices are different. Since the answer can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2800
830C "Bamboo Partition" "brute force,data structures,implementation,math,number theory,sortings,two pointers" "Vladimir wants to modernize partitions in his office. To make the office more comfortable he decided to remove a partition and plant several bamboos in a row. He thinks it would be nice if there are n bamboos in a row, and the i-th from the left is ai meters high. Vladimir has just planted n bamboos in a row, each of which has height 0 meters right now, but they grow 1 meter each day. In order to make the partition nice Vladimir can cut each bamboo once at any height (no greater that the height of the bamboo), and then the bamboo will stop growing.Vladimir wants to check the bamboos each d days (i.e. d days after he planted, then after 2d days and so on), and cut the bamboos that reached the required height. Vladimir wants the total length of bamboo parts he will cut off to be no greater than k meters.What is the maximum value d he can choose so that he can achieve what he wants without cutting off more than k meters of bamboo?" 2300
830B "Cards Sorting" "data structures,implementation,sortings" "Vasily has a deck of cards consisting of n cards. There is an integer on each of the cards, this integer is between 1 and 100\xe2\x80\x89000, inclusive. It is possible that some cards have the same integers on them.Vasily decided to sort the cards. To do this, he repeatedly takes the top card from the deck, and if the number on it equals the minimum number written on the cards in the deck, then he places the card away. Otherwise, he puts it under the deck and takes the next card from the top, and so on. The process ends as soon as there are no cards in the deck. You can assume that Vasily always knows the minimum number written on some card in the remaining deck, but doesn\'t know where this card (or these cards) is.You are to determine the total number of times Vasily takes the top card from the deck." 1600
830A "Office Keys" "binary search,brute force,dp,greedy,sortings" "There are n people and k keys on a straight line. Every person wants to get to the office which is located on the line as well. To do that, he needs to reach some point with a key, take the key and then go to the office. Once a key is taken by somebody, it couldn\'t be taken by anybody else.You are to determine the minimum time needed for all n people to get to the office with keys. Assume that people move a unit distance per 1 second. If two people reach a key at the same time, only one of them can take the key. A person can pass through a point with a key without taking it." 1800
828B "Black Square" implementation "Polycarp has a checkered sheet of paper of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Polycarp painted some of cells with black, the others remained white. Inspired by Malevich\'s ""Black Square"", Polycarp wants to paint minimum possible number of white cells with black so that all black cells form a square.You are to determine the minimum possible number of cells needed to be painted black so that the black cells form a black square with sides parallel to the painting\'s sides. All the cells that do not belong to the square should be white. The square\'s side should have positive length." 1300
828A "Restaurant Tables" implementation "In a small restaurant there are a tables for one person and b tables for two persons. It it known that n groups of people come today, each consisting of one or two people. If a group consist of one person, it is seated at a vacant one-seater table. If there are none of them, it is seated at a vacant two-seater table. If there are none of them, it is seated at a two-seater table occupied by single person. If there are still none of them, the restaurant denies service to this group.If a group consist of two people, it is seated at a vacant two-seater table. If there are none of them, the restaurant denies service to this group.You are given a chronological order of groups coming. You are to determine the total number of people the restaurant denies service to." 1200
827F "Dirty Arkady\'s Kitchen" "data structures,dp,graphs,shortest paths" "Arkady likes to walk around his kitchen. His labyrinthine kitchen consists of several important places connected with passages. Unfortunately it happens that these passages are flooded with milk so that it\'s impossible to pass through them. Namely, it\'s possible to pass through each passage in any direction only during some time interval.The lengths of all passages are equal and Arkady makes through them in one second. For security reasons, Arkady can never stop, also, he can\'t change direction while going through a passage. In other words, if he starts walking in some passage, he should reach its end and immediately leave the end.Today Arkady needs to quickly reach important place n from place 1. He plans to exit the place 1 at time moment 0 and reach the place n as early as he can. Please find the minimum time he should spend on his way." 3200
827E "Rusty String" fft,math,strings "Grigory loves strings. Recently he found a metal strip on a loft. The strip had length n and consisted of letters ""V"" and ""K"". Unfortunately, rust has eaten some of the letters so that it\'s now impossible to understand which letter was written.Grigory couldn\'t understand for a long time what these letters remind him of, so he became interested in the following question: if we put a letter ""V"" or ""K"" on each unreadable position, which values can the period of the resulting string be equal to?A period of a string is such an integer d from 1 to the length of the string that if we put the string shifted by d positions to the right on itself, then all overlapping letters coincide. For example, 3 and 5 are periods of ""VKKVK""." 2700
827D "Best Edge Weight" "data structures,dfs and similar,graphs,trees" "You are given a connected weighted graph with n vertices and m edges. The graph doesn\'t contain loops nor multiple edges. Consider some edge with id i. Let\'s determine for this edge the maximum integer weight we can give to it so that it is contained in all minimum spanning trees of the graph if we don\'t change the other weights.You are to determine this maximum weight described above for each edge. You should calculate the answer for each edge independently, it means there can\'t be two edges with changed weights at the same time." 2700
827C "DNA Evolution" "data structures,strings" "Everyone knows that DNA strands consist of nucleotides. There are four types of nucleotides: ""A"", ""T"", ""G"", ""C"". A DNA strand is a sequence of nucleotides. Scientists decided to track evolution of a rare species, which DNA strand was string s initially. Evolution of the species is described as a sequence of changes in the DNA. Every change is a change of some nucleotide, for example, the following change can happen in DNA strand ""AAGC"": the second nucleotide can change to ""T"" so that the resulting DNA strand is ""ATGC"".Scientists know that some segments of the DNA strand can be affected by some unknown infections. They can represent an infection as a sequence of nucleotides. Scientists are interested if there are any changes caused by some infections. Thus they sometimes want to know the value of impact of some infection to some segment of the DNA. This value is computed as follows:  Let the infection be represented as a string e, and let scientists be interested in DNA strand segment starting from position l to position r, inclusive.  Prefix of the string eee... (i.e. the string that consists of infinitely many repeats of string e) is written under the string s from position l to position r, inclusive.  The value of impact is the number of positions where letter of string s coincided with the letter written under it. Being a developer, Innokenty is interested in bioinformatics also, so the scientists asked him for help. Innokenty is busy preparing VK Cup, so he decided to delegate the problem to the competitors. Help the scientists!" 2100
827B "High Load" "constructive algorithms,greedy,implementation,trees" "Arkady needs your help again! This time he decided to build his own high-speed Internet exchange point. It should consist of n nodes connected with minimum possible number of wires into one network (a wire directly connects two nodes). Exactly k of the nodes should be exit-nodes, that means that each of them should be connected to exactly one other node of the network, while all other nodes should be connected to at least two nodes in order to increase the system stability.Arkady wants to make the system as fast as possible, so he wants to minimize the maximum distance between two exit-nodes. The distance between two nodes is the number of wires a package needs to go through between those two nodes.Help Arkady to find such a way to build the network that the distance between the two most distant exit-nodes is as small as possible." 1800
827A "String Reconstruction" "data structures,greedy,sortings,strings" "Ivan had string s consisting of small English letters. However, his friend Julia decided to make fun of him and hid the string s. Ivan preferred making a new string to finding the old one. Ivan knows some information about the string s. Namely, he remembers, that string ti occurs in string s at least ki times or more, he also remembers exactly ki positions where the string ti occurs in string s: these positions are xi,\xe2\x80\x891,\xe2\x80\x89xi,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89xi,\xe2\x80\x89ki. He remembers n such strings ti.You are to reconstruct lexicographically minimal string s such that it fits all the information Ivan remembers. Strings ti and string s consist of small English letters only." 1700
825G "Tree Queries" "dfs and similar,graphs,trees" "You are given a tree consisting of n vertices (numbered from 1 to n). Initially all vertices are white. You have to process q queries of two different types:  1 x \xe2\x80\x94 change the color of vertex x to black. It is guaranteed that the first query will be of this type.  2 x \xe2\x80\x94 for the vertex x, find the minimum index y such that the vertex with index y belongs to the simple path from x to some black vertex (a simple path never visits any vertex more than once). For each query of type 2 print the answer to it.Note that the queries are given in modified way." 2500
825F "String Compression" "dp,hashing,string suffix structures,strings" "Ivan wants to write a letter to his friend. The letter is a string s consisting of lowercase Latin letters.Unfortunately, when Ivan started writing the letter, he realised that it is very long and writing the whole letter may take extremely long time. So he wants to write the compressed version of string s instead of the string itself.The compressed version of string s is a sequence of strings c1,\xe2\x80\x89s1,\xe2\x80\x89c2,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89ck,\xe2\x80\x89sk, where ci is the decimal representation of number ai (without any leading zeroes) and si is some string consisting of lowercase Latin letters. If Ivan writes string s1 exactly a1 times, then string s2 exactly a2 times, and so on, the result will be string s.The length of a compressed version is |c1|\xe2\x80\x89+\xe2\x80\x89|s1|\xe2\x80\x89+\xe2\x80\x89|c2|\xe2\x80\x89+\xe2\x80\x89|s2|... |ck|\xe2\x80\x89+\xe2\x80\x89|sk|. Among all compressed versions Ivan wants to choose a version such that its length is minimum possible. Help Ivan to determine minimum possible length." 2400
825E "Minimal Labels" "data structures,dfs and similar,graphs,greedy" "You are given a directed acyclic graph with n vertices and m edges. There are no self-loops or multiple edges between any pair of vertices. Graph can be disconnected.You should assign labels to all vertices in such a way that:  Labels form a valid permutation of length n \xe2\x80\x94 an integer sequence such that each integer from 1 to n appears exactly once in it.  If there exists an edge from vertex v to vertex u then labelv should be smaller than labelu.  Permutation should be lexicographically smallest among all suitable. Find such sequence of labels to satisfy all the conditions." 2300
825D "Suitable Replacement" "binary search,greedy,implementation" "You are given two strings s and t consisting of small Latin letters, string s can also contain \'?\' characters. Suitability of string s is calculated by following metric:Any two letters can be swapped positions, these operations can be performed arbitrary number of times over any pair of positions. Among all resulting strings s, you choose the one with the largest number of non-intersecting occurrences of string t. Suitability is this number of occurrences.You should replace all \'?\' characters with small Latin letters in such a way that the suitability of string s is maximal." 1500
825C "Multi-judge Solving" greedy,implementation "Makes solves problems on Decoforces and lots of other different online judges. Each problem is denoted by its difficulty \xe2\x80\x94 a positive integer number. Difficulties are measured the same across all the judges (the problem with difficulty d on Decoforces is as hard as the problem with difficulty d on any other judge). Makes has chosen n problems to solve on Decoforces with difficulties a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. He can solve these problems in arbitrary order. Though he can solve problem i with difficulty ai only if he had already solved some problem with difficulty  (no matter on what online judge was it).Before starting this chosen list of problems, Makes has already solved problems with maximum difficulty k.With given conditions it\'s easy to see that Makes sometimes can\'t solve all the chosen problems, no matter what order he chooses. So he wants to solve some problems on other judges to finish solving problems from his list. For every positive integer y there exist some problem with difficulty y on at least one judge besides Decoforces.Makes can solve problems on any judge at any time, it isn\'t necessary to do problems from the chosen list one right after another.Makes doesn\'t have too much free time, so he asked you to calculate the minimum number of problems he should solve on other judges in order to solve all the chosen problems from Decoforces." 1600
825B Five-In-a-Row "brute force,implementation" "Alice and Bob play 5-in-a-row game. They have a playing field of size 10\xe2\x80\x89\xc3\x97\xe2\x80\x8910. In turns they put either crosses or noughts, one at a time. Alice puts crosses and Bob puts noughts.In current match they have made some turns and now it\'s Alice\'s turn. She wonders if she can put cross in such empty cell that she wins immediately.Alice wins if some crosses in the field form line of length not smaller than 5. This line can be horizontal, vertical and diagonal." 1600
825A "Binary Protocol" implementation "Polycarp has just invented a new binary protocol for data transmission. He is encoding positive integer decimal number to binary string using following algorithm:  Each digit is represented with number of \'1\' characters equal to the value of that digit (for 0 it is zero ones).  Digits are written one by one in order corresponding to number and separated by single \'0\' character. Though Polycarp learnt how to encode the numbers, he has no idea how to decode them back. Help him calculate the decoded number." 1100
822F Madness "constructive algorithms,dfs and similar,trees" "The second semester starts at the University of Pavlopolis. After vacation in Vi\xc4\x8dkopolis Noora needs to return to Pavlopolis and continue her study.Sometimes (or quite often) there are teachers who do not like you. Incidentally Noora also has one such teacher. His name is Yury Dmitrievich and he teaches graph theory. Yury Dmitrievich doesn\'t like Noora, so he always gives the girl the most difficult tasks. So it happened this time.The teacher gives Noora a tree with n vertices. Vertices are numbered with integers from 1 to n. The length of all the edges of this tree is 1. Noora chooses a set of simple paths that pairwise don\'t intersect in edges. However each vertex should belong to at least one of the selected path.For each of the selected paths, the following is done:  We choose exactly one edge (u,\xe2\x80\x89v) that belongs to the path.  On the selected edge (u,\xe2\x80\x89v) there is a point at some selected distance x from the vertex u and at distance 1\xe2\x80\x89-\xe2\x80\x89x from vertex v. But the distance x chosen by Noora arbitrarily, i. e. it can be different for different edges.  One of the vertices u or v is selected. The point will start moving to the selected vertex. Let us explain how the point moves by example. Suppose that the path consists of two edges (v1,\xe2\x80\x89v2) and (v2,\xe2\x80\x89v3), the point initially stands on the edge (v1,\xe2\x80\x89v2) and begins its movement to the vertex v1. Then the point will reach v1, then ""turn around"", because the end of the path was reached, further it will move in another direction to vertex v2, then to vertex v3, then ""turn around"" again, then move to v2 and so on. The speed of the points is 1 edge per second. For example, for 0.5 second the point moves to the length of the half of an edge.A stopwatch is placed at each vertex of the tree. The time that the stopwatches indicate at start time is 0 seconds. Then at the starting moment of time, all points simultaneously start moving from the selected positions to selected directions along the selected paths, and stopwatches are simultaneously started. When one of the points reaches the vertex v, the stopwatch at the vertex v is automatically reset, i.e. it starts counting the time from zero.Denote by resv the maximal time that the stopwatch at the vertex v will show if the point movement continues infinitely. Noora is asked to select paths and points on them so that res1 is as minimal as possible. If there are several solutions to do this, it is necessary to minimize res2, then res3, res4,\xe2\x80\x89...,\xe2\x80\x89resn.Help Noora complete the teacher\'s task.For the better understanding of the statement, see the explanation for the example." 2500
822E Liar "binary search,dp,hashing,string suffix structures" "The first semester ended. You know, after the end of the first semester the holidays begin. On holidays Noora decided to return to Vi\xc4\x8dkopolis. As a modest souvenir for Leha, she brought a sausage of length m from Pavlopolis. Everyone knows that any sausage can be represented as a string of lowercase English letters, the length of which is equal to the length of the sausage.Leha was very pleased with the gift and immediately ate the sausage. But then he realized that it was a quite tactless act, because the sausage was a souvenir! So the hacker immediately went to the butcher shop. Unfortunately, there was only another sausage of length n in the shop. However Leha was not upset and bought this sausage. After coming home, he decided to cut the purchased sausage into several pieces and number the pieces starting from 1 from left to right. Then he wants to select several pieces and glue them together so that the obtained sausage is equal to the sausage that Noora gave. But the hacker can glue two pieces together only when the number of the left piece is less than the number of the right piece. Besides he knows that if he glues more than x pieces, Noora will notice that he has falsified souvenir sausage and will be very upset. Of course Leha doesn\xe2\x80\x99t want to upset the girl. The hacker asks you to find out whether he is able to cut the sausage he bought, and then glue some of the pieces so that Noora doesn\'t notice anything.Formally, you are given two strings s and t. The length of the string s is n, the length of the string t is m. It is required to select several pairwise non-intersecting substrings from s, so that their concatenation in the same order as these substrings appear in s, is equal to the string t. Denote by f(s,\xe2\x80\x89t) the minimal number of substrings to be chosen so that their concatenation is equal to the string t. If it is impossible to choose such substrings, then f(s,\xe2\x80\x89t)\xe2\x80\x89=\xe2\x80\x89\xe2\x88\x9e. Leha really wants to know whether it\xe2\x80\x99s true that f(s,\xe2\x80\x89t)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x." 2400
822D "My pretty girl Noora" "brute force,dp,greedy,math,number theory" "In Pavlopolis University where Noora studies it was decided to hold beauty contest ""Miss Pavlopolis University"". Let\'s describe the process of choosing the most beautiful girl in the university in more detail.The contest is held in several stages. Suppose that exactly n girls participate in the competition initially. All the participants are divided into equal groups, x participants in each group. Furthermore the number x is chosen arbitrarily, i. e. on every stage number x can be different. Within each group the jury of the contest compares beauty of the girls in the format ""each with each"". In this way, if group consists of x girls, then  comparisons occur. Then, from each group, the most beautiful participant is selected. Selected girls enter the next stage of the competition. Thus if n girls were divided into groups, x participants in each group, then exactly  participants will enter the next stage. The contest continues until there is exactly one girl left who will be ""Miss Pavlopolis University""But for the jury this contest is a very tedious task. They would like to divide the girls into groups in each stage so that the total number of pairwise comparisons of the girls is as few as possible. Let f(n) be the minimal total number of comparisons that should be made to select the most beautiful participant, if we admit n girls to the first stage.The organizers of the competition are insane. They give Noora three integers t, l and r and ask the poor girl to calculate the value of the following expression: t0\xc2\xb7f(l)\xe2\x80\x89+\xe2\x80\x89t1\xc2\xb7f(l\xe2\x80\x89+\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89tr\xe2\x80\x89-\xe2\x80\x89l\xc2\xb7f(r). However, since the value of this expression can be quite large the organizers ask her to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897. If Noora can calculate the value of this expression the organizers promise her to help during the beauty contest. But the poor girl is not strong in mathematics, so she turned for help to Leha and he turned to you." 1800
822C "Hacker, pack your bags!" "binary search,greedy,implementation,sortings" "It\'s well known that the best way to distract from something is to do one\'s favourite thing. Job is such a thing for Leha.So the hacker began to work hard in order to get rid of boredom. It means that Leha began to hack computers all over the world. For such zeal boss gave the hacker a vacation of exactly x days. You know the majority of people prefer to go somewhere for a vacation, so Leha immediately went to the travel agency. There he found out that n vouchers left. i-th voucher is characterized by three integers li, ri, costi \xe2\x80\x94 day of departure from Vi\xc4\x8dkopolis, day of arriving back in Vi\xc4\x8dkopolis and cost of the voucher correspondingly. The duration of the i-th voucher is a value ri\xe2\x80\x89-\xe2\x80\x89li\xe2\x80\x89+\xe2\x80\x891.At the same time Leha wants to split his own vocation into two parts. Besides he wants to spend as little money as possible. Formally Leha wants to choose exactly two vouchers i and j (i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j) so that they don\'t intersect, sum of their durations is exactly x and their total cost is as minimal as possible. Two vouchers i and j don\'t intersect if only at least one of the following conditions is fulfilled: ri\xe2\x80\x89<\xe2\x80\x89lj or rj\xe2\x80\x89<\xe2\x80\x89li.Help Leha to choose the necessary vouchers!" 1600
822B "Crossword solving" "brute force,implementation,strings" "Erelong Leha was bored by calculating of the greatest common divisor of two factorials. Therefore he decided to solve some crosswords. It\'s well known that it is a very interesting occupation though it can be very difficult from time to time. In the course of solving one of the crosswords, Leha had to solve a simple task. You are able to do it too, aren\'t you?Leha has two strings s and t. The hacker wants to change the string s at such way, that it can be found in t as a substring. All the changes should be the following: Leha chooses one position in the string s and replaces the symbol in this position with the question mark ""?"". The hacker is sure that the question mark in comparison can play the role of an arbitrary symbol. For example, if he gets string s=""ab?b"" as a result, it will appear in t=""aabrbb"" as a substring.Guaranteed that the length of the string s doesn\'t exceed the length of the string t. Help the hacker to replace in s as few symbols as possible so that the result of the replacements can be found in t as a substring. The symbol ""?"" should be considered equal to any other symbol." 1000
822A "I\'m bored with life" "implementation,math,number theory" "Holidays have finished. Thanks to the help of the hacker Leha, Noora managed to enter the university of her dreams which is located in a town Pavlopolis. It\'s well known that universities provide students with dormitory for the period of university studies. Consequently Noora had to leave Vi\xc4\x8dkopolis and move to Pavlopolis. Thus Leha was left completely alone in a quiet town Vi\xc4\x8dkopolis. He almost even fell into a depression from boredom!Leha came up with a task for himself to relax a little. He chooses two integers A and B and then calculates the greatest common divisor of integers ""A factorial"" and ""B factorial"". Formally the hacker wants to find out GCD(A!,\xe2\x80\x89B!). It\'s well known that the factorial of an integer x is a product of all positive integers less than or equal to x. Thus x!\xe2\x80\x89=\xe2\x80\x891\xc2\xb72\xc2\xb73\xc2\xb7...\xc2\xb7(x\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7x. For example 4!\xe2\x80\x89=\xe2\x80\x891\xc2\xb72\xc2\xb73\xc2\xb74\xe2\x80\x89=\xe2\x80\x8924. Recall that GCD(x,\xe2\x80\x89y) is the largest positive integer q that divides (without a remainder) both x and y.Leha has learned how to solve this task very effective. You are able to cope with it not worse, aren\'t you?" 800
821E "Okabe and El Psy Kongroo" dp,matrices "Okabe likes to take walks but knows that spies from the Organization could be anywhere; that\'s why he wants to know how many different walks he can take in his city safely. Okabe\'s city can be represented as all points (x,\xe2\x80\x89y) such that x and y are non-negative. Okabe starts at the origin (point (0,\xe2\x80\x890)), and needs to reach the point (k,\xe2\x80\x890). If Okabe is currently at the point (x,\xe2\x80\x89y), in one step he can go to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891), (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y), or (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891).Additionally, there are n horizontal line segments, the i-th of which goes from x\xe2\x80\x89=\xe2\x80\x89ai to x\xe2\x80\x89=\xe2\x80\x89bi inclusive, and is at y\xe2\x80\x89=\xe2\x80\x89ci. It is guaranteed that a1\xe2\x80\x89=\xe2\x80\x890, an\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bn, and ai\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x891 for 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. The i-th line segment forces Okabe to walk with y-value in the range 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci when his x value satisfies ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi, or else he might be spied on. This also means he is required to be under two line segments when one segment ends and another begins.Okabe now wants to know how many walks there are from the origin to the point (k,\xe2\x80\x890) satisfying these conditions, modulo 109\xe2\x80\x89+\xe2\x80\x897." 2100
821D "Okabe and City" "dfs and similar,graphs,shortest paths" "Okabe likes to be able to walk through his city on a path lit by street lamps. That way, he doesn\'t get beaten up by schoolchildren.Okabe\'s city is represented by a 2D grid of cells. Rows are numbered from 1 to n from top to bottom, and columns are numbered 1 to m from left to right. Exactly k cells in the city are lit by a street lamp. It\'s guaranteed that the top-left cell is lit.Okabe starts his walk from the top-left cell, and wants to reach the bottom-right cell. Of course, Okabe will only walk on lit cells, and he can only move to adjacent cells in the up, down, left, and right directions. However, Okabe can also temporarily light all the cells in any single row or column at a time if he pays 1 coin, allowing him to walk through some cells not lit initially. Note that Okabe can only light a single row or column at a time, and has to pay a coin every time he lights a new row or column. To change the row or column that is temporarily lit, he must stand at a cell that is lit initially. Also, once he removes his temporary light from a row or column, all cells in that row/column not initially lit are now not lit.Help Okabe find the minimum number of coins he needs to pay to complete his walk!" 2200
821C "Okabe and Boxes" "data structures,greedy,trees" "Okabe and Super Hacker Daru are stacking and removing boxes. There are n boxes numbered from 1 to n. Initially there are no boxes on the stack.Okabe, being a control freak, gives Daru 2n commands: n of which are to add a box to the top of the stack, and n of which are to remove a box from the top of the stack and throw it in the trash. Okabe wants Daru to throw away the boxes in the order from 1 to n. Of course, this means that it might be impossible for Daru to perform some of Okabe\'s remove commands, because the required box is not on the top of the stack.That\'s why Daru can decide to wait until Okabe looks away and then reorder the boxes in the stack in any way he wants. He can do it at any point of time between Okabe\'s commands, but he can\'t add or remove boxes while he does it.Tell Daru the minimum number of times he needs to reorder the boxes so that he can successfully complete all of Okabe\'s commands. It is guaranteed that every box is added before it is required to be removed." 1500
821B "Okabe and Banana Trees" "brute force,math" "Okabe needs bananas for one of his experiments for some strange reason. So he decides to go to the forest and cut banana trees.Consider the point (x,\xe2\x80\x89y) in the 2D plane such that x and y are integers and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y. There is a tree in such a point, and it has x\xe2\x80\x89+\xe2\x80\x89y bananas. There are no trees nor bananas in other points. Now, Okabe draws a line with equation . Okabe can select a single rectangle with axis aligned sides with all points on or under the line and cut all the trees in all points that are inside or on the border of this rectangle and take their bananas. Okabe\'s rectangle can be degenerate; that is, it can be a line segment or even a point.Help Okabe and find the maximum number of bananas he can get if he chooses the rectangle wisely.Okabe is sure that the answer does not exceed 1018. You can trust him." 1300
821A "Okabe and Future Gadget Laboratory" implementation "Okabe needs to renovate the Future Gadget Laboratory after he tried doing some crazy experiments! The lab is represented as an n by n square grid of integers. A good lab is defined as a lab in which every number not equal to 1 can be expressed as the sum of a number in the same row and a number in the same column. In other words, for every x,\xe2\x80\x89y such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and ax,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x891, there should exist two indices s and t so that ax,\xe2\x80\x89y\xe2\x80\x89=\xe2\x80\x89ax,\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x89at,\xe2\x80\x89y, where ai,\xe2\x80\x89j denotes the integer in i-th row and j-th column.Help Okabe determine whether a given lab is good!" 800
820B "Mister B and Angle in Polygon" "constructive algorithms,geometry,math" "On one quiet day all of sudden Mister B decided to draw angle a on his field. Aliens have already visited his field and left many different geometric figures on it. One of the figures is regular convex n-gon (regular convex polygon with n sides).That\'s why Mister B decided to use this polygon. Now Mister B must find three distinct vertices v1, v2, v3 such that the angle  (where v2 is the vertex of the angle, and v1 and v3 lie on its sides) is as close as possible to a. In other words, the value  should be minimum possible.If there are many optimal solutions, Mister B should be satisfied with any of them." 1300
820A "Mister B and Book Reading" implementation "Mister B once received a gift: it was a book about aliens, which he started read immediately. This book had c pages.At first day Mister B read v0 pages, but after that he started to speed up. Every day, starting from the second, he read a pages more than on the previous day (at first day he read v0 pages, at second \xe2\x80\x94 v0\xe2\x80\x89+\xe2\x80\x89a pages, at third \xe2\x80\x94 v0\xe2\x80\x89+\xe2\x80\x892a pages, and so on). But Mister B is just a human, so he physically wasn\'t able to read more than v1 pages per day.Also, to refresh his memory, every day, starting from the second, Mister B had to reread last l pages he read on the previous day. Mister B finished the book when he read the last page for the first time.Help Mister B to calculate how many days he needed to finish the book." 900
819E "Mister B and Flight to the Moon" "constructive algorithms,graphs" "In order to fly to the Moon Mister B just needs to solve the following problem.There is a complete indirected graph with n vertices. You need to cover it with several simple cycles of length 3 and 4 so that each edge is in exactly 2 cycles.We are sure that Mister B will solve the problem soon and will fly to the Moon. Will you?" 2800
819D "Mister B and Astronomers" "number theory" "After studying the beacons Mister B decided to visit alien\'s planet, because he learned that they live in a system of flickering star Moon. Moreover, Mister B learned that the star shines once in exactly T seconds. The problem is that the star is yet to be discovered by scientists.There are n astronomers numerated from 1 to n trying to detect the star. They try to detect the star by sending requests to record the sky for 1 second. The astronomers send requests in cycle: the i-th astronomer sends a request exactly ai second after the (i\xe2\x80\x89-\xe2\x80\x891)-th (i.e. if the previous request was sent at moment t, then the next request is sent at moment t\xe2\x80\x89+\xe2\x80\x89ai); the 1-st astronomer sends requests a1 seconds later than the n-th. The first astronomer sends his first request at moment 0.Mister B doesn\'t know the first moment the star is going to shine, but it\'s obvious that all moments at which the star will shine are determined by the time of its shine moment in the interval [0,\xe2\x80\x89T). Moreover, this interval can be split into T parts of 1 second length each of form [t,\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891), where t\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89(T\xe2\x80\x89-\xe2\x80\x891).Mister B wants to know how lucky each astronomer can be in discovering the star first.For each astronomer compute how many segments of form [t,\xe2\x80\x89t\xe2\x80\x89+\xe2\x80\x891) (t\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89(T\xe2\x80\x89-\xe2\x80\x891)) there are in the interval [0,\xe2\x80\x89T) so that this astronomer is the first to discover the star if the first shine of the star happens in this time interval." 2900
819C "Mister B and Beacons on Field" "number theory" "Mister B has a house in the middle of a giant plain field, which attracted aliens life. For convenience, aliens specified the Cartesian coordinate system on the field in such a way that Mister B\'s house has coordinates (0,\xe2\x80\x890). After that they sent three beacons to the field, but something went wrong. One beacon was completely destroyed, while the other two landed in positions with coordinates (m,\xe2\x80\x890) and (0,\xe2\x80\x89n), respectively, but shut down.Mister B was interested in this devices, so he decided to take them home. He came to the first beacon, placed at (m,\xe2\x80\x890), lifted it up and carried the beacon home choosing the shortest path. After that he came to the other beacon, placed at (0,\xe2\x80\x89n), and also carried it home choosing the shortest path. When first beacon was lifted up, the navigation system of the beacons was activated.Partially destroyed navigation system started to work in following way.At time moments when both survived beacons are at points with integer coordinates the system tries to find a location for the third beacon. It succeeds if and only if there is a point with integer coordinates such that the area of the triangle formed by the two survived beacons and this point is equal to s. In this case the system sends a packet of information with beacon positions to aliens, otherwise it doesn\'t.Compute how many packets of information system sent while Mister B was moving the beacons." 2900
819B "Mister B and PR Shifts" "data structures,implementation,math" "Some time ago Mister B detected a strange signal from the space, which he started to study.After some transformation the signal turned out to be a permutation p of length n or its cyclic shift. For the further investigation Mister B need some basis, that\'s why he decided to choose cyclic shift of this permutation which has the minimum possible deviation.Let\'s define the deviation of a permutation p as .Find a cyclic shift of permutation p with minimum possible deviation. If there are multiple solutions, print any of them.Let\'s denote id k (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89n) of a cyclic shift of permutation p as the number of right shifts needed to reach this shift, for example:  k\xe2\x80\x89=\xe2\x80\x890: shift p1,\xe2\x80\x89p2,\xe2\x80\x89... pn,  k\xe2\x80\x89=\xe2\x80\x891: shift pn,\xe2\x80\x89p1,\xe2\x80\x89... pn\xe2\x80\x89-\xe2\x80\x891,  ...,  k\xe2\x80\x89=\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891: shift p2,\xe2\x80\x89p3,\xe2\x80\x89... pn,\xe2\x80\x89p1." 1900
819A "Mister B and Boring Game" games,greedy "Sometimes Mister B has free evenings when he doesn\'t know what to do. Fortunately, Mister B found a new game, where the player can play against aliens.All characters in this game are lowercase English letters. There are two players: Mister B and his competitor.Initially the players have a string s consisting of the first a English letters in alphabetical order (for example, if a\xe2\x80\x89=\xe2\x80\x895, then s equals to ""abcde"").The players take turns appending letters to string s. Mister B moves first.Mister B must append exactly b letters on each his move. He can arbitrary choose these letters. His opponent adds exactly a letters on each move.Mister B quickly understood that his opponent was just a computer that used a simple algorithm. The computer on each turn considers the suffix of string s of length a and generates a string t of length a such that all letters in the string t are distinct and don\'t appear in the considered suffix. From multiple variants of t lexicographically minimal is chosen (if a\xe2\x80\x89=\xe2\x80\x894 and the suffix is ""bfdd"", the computer chooses string t equal to ""aceg""). After that the chosen string t is appended to the end of s.Mister B soon found the game boring and came up with the following question: what can be the minimum possible number of different letters in string s on the segment between positions l and r, inclusive. Letters of string s are numerated starting from 1." 2200
818G "Four Melodies" flows,graphs "Author note: I think some of you might remember the problem ""Two Melodies"" from Eductational Codeforces Round 22. Now it\'s time to make it a bit more difficult!Alice is a composer, and recently she had recorded two tracks that became very popular. Now she has got a lot of fans who are waiting for new tracks. This time Alice wants to form four melodies for her tracks.Alice has a sheet with n notes written on it. She wants to take four such non-empty non-intersecting subsequences that all of them form a melody and sum of their lengths is maximal.Subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.Subsequence forms a melody when each two adjacent notes either differ by 1 or are congruent modulo 7.You should write a program which will calculate maximum sum of lengths of such four non-empty non-intersecting subsequences that all of them form a melody." 2600
818F "Level Generation" "binary search,math,ternary search" "Ivan is developing his own computer game. Now he tries to create some levels for his game. But firstly for each level he needs to draw a graph representing the structure of the level.Ivan decided that there should be exactly ni vertices in the graph representing level i, and the edges have to be bidirectional. When constructing the graph, Ivan is interested in special edges called bridges. An edge between two vertices u and v is called a bridge if this edge belongs to every path between u and v (and these vertices will belong to different connected components if we delete this edge). For each level Ivan wants to construct a graph where at least half of the edges are bridges. He also wants to maximize the number of edges in each constructed graph.So the task Ivan gave you is: given q numbers n1,\xe2\x80\x89n2,\xe2\x80\x89...,\xe2\x80\x89nq, for each i tell the maximum number of edges in a graph with ni vertices, if at least half of the edges are bridges. Note that the graphs cannot contain multiple edges or self-loops." 2100
818E "Card Game Again" "binary search,data structures,number theory,two pointers" "Vova again tries to play some computer card game.The rules of deck creation in this game are simple. Vova is given an existing deck of n cards and a magic number k. The order of the cards in the deck is fixed. Each card has a number written on it; number ai is written on the i-th card in the deck.After receiving the deck and the magic number, Vova removes x (possibly x\xe2\x80\x89=\xe2\x80\x890) cards from the top of the deck, y (possibly y\xe2\x80\x89=\xe2\x80\x890) cards from the bottom of the deck, and the rest of the deck is his new deck (Vova has to leave at least one card in the deck after removing cards). So Vova\'s new deck actually contains cards x\xe2\x80\x89+\xe2\x80\x891, x\xe2\x80\x89+\xe2\x80\x892, ... n\xe2\x80\x89-\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891, n\xe2\x80\x89-\xe2\x80\x89y from the original deck.Vova\'s new deck is considered valid iff the product of all numbers written on the cards in his new deck is divisible by k. So Vova received a deck (possibly not a valid one) and a number k, and now he wonders, how many ways are there to choose x and y so the deck he will get after removing x cards from the top and y cards from the bottom is valid?" 1900
818D "Multicolored Cars" "data structures,implementation" "Alice and Bob got very bored during a long car trip so they decided to play a game. From the window they can see cars of different colors running past them. Cars are going one after another.The game rules are like this. Firstly Alice chooses some color A, then Bob chooses some color B (A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89B). After each car they update the number of cars of their chosen color that have run past them. Let\'s define this numbers after i-th car cntA(i) and cntB(i).  If cntA(i)\xe2\x80\x89>\xe2\x80\x89cntB(i) for every i then the winner is Alice.  If cntB(i)\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89cntA(i) for every i then the winner is Bob.  Otherwise it\'s a draw. Bob knows all the colors of cars that they will encounter and order of their appearance. Alice have already chosen her color A and Bob now wants to choose such color B that he will win the game (draw is not a win). Help him find this color.If there are multiple solutions, print any of them. If there is no such color then print -1." 1700
818C "Sofa Thief" "brute force,implementation" "Yet another round on DecoForces is coming! Grandpa Maks wanted to participate in it but someone has stolen his precious sofa! And how can one perform well with such a major loss?Fortunately, the thief had left a note for Grandpa Maks. This note got Maks to the sofa storehouse. Still he had no idea which sofa belongs to him as they all looked the same!The storehouse is represented as matrix n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Every sofa takes two neighbouring by some side cells. No cell is covered by more than one sofa. There can be empty cells.Sofa A is standing to the left of sofa B if there exist two such cells a and b that xa\xe2\x80\x89<\xe2\x80\x89xb, a is covered by A and b is covered by B. Sofa A is standing to the top of sofa B if there exist two such cells a and b that ya\xe2\x80\x89<\xe2\x80\x89yb, a is covered by A and b is covered by B. Right and bottom conditions are declared the same way. Note that in all conditions A\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89B. Also some sofa A can be both to the top of another sofa B and to the bottom of it. The same is for left and right conditions.The note also stated that there are cntl sofas to the left of Grandpa Maks\'s sofa, cntr \xe2\x80\x94 to the right, cntt \xe2\x80\x94 to the top and cntb \xe2\x80\x94 to the bottom.Grandpa Maks asks you to help him to identify his sofa. It is guaranteed that there is no more than one sofa of given conditions.Output the number of Grandpa Maks\'s sofa. If there is no such sofa that all the conditions are met for it then output -1." 2000
818B "Permutation Game" implementation "n children are standing in a circle and playing a game. Children\'s numbers in clockwise order form a permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of length n. It is an integer sequence such that each integer from 1 to n appears exactly once in it.The game consists of m steps. On each step the current leader with index i counts out ai people in clockwise order, starting from the next person. The last one to be pointed at by the leader becomes the new leader.You are given numbers l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lm \xe2\x80\x94 indices of leaders in the beginning of each step. Child with number l1 is the first leader in the game. Write a program which will restore a possible permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. If there are multiple solutions then print any of them. If there is no solution then print -1." 1600
818A "Diplomas and Certificates" implementation,math "There are n students who have taken part in an olympiad. Now it\'s time to award the students.Some of them will receive diplomas, some wiil get certificates, and others won\'t receive anything. Students with diplomas and certificates are called winners. But there are some rules of counting the number of diplomas and certificates. The number of certificates must be exactly k times greater than the number of diplomas. The number of winners must not be greater than half of the number of all students (i.e. not be greater than half of n). It\'s possible that there are no winners.You have to identify the maximum possible number of winners, according to these rules. Also for this case you have to calculate the number of students with diplomas, the number of students with certificates and the number of students who are not winners." 800
817F "MEX Queries" "binary search,data structures,trees" "You are given a set of integer numbers, initially it is empty. You should perform n queries.There are three different types of queries:   1 l r \xe2\x80\x94 Add all missing numbers from the interval [l,\xe2\x80\x89r]  2 l r \xe2\x80\x94 Remove all present numbers from the interval [l,\xe2\x80\x89r]  3 l r \xe2\x80\x94 Invert the interval [l,\xe2\x80\x89r] \xe2\x80\x94 add all missing and remove all present numbers from the interval [l,\xe2\x80\x89r] After each query you should output MEX of the set \xe2\x80\x94 the smallest positive (MEX \xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) integer number which is not presented in the set." 2300
817E "Choosing The Commander" "bitmasks,data structures,trees" "As you might remember from the previous round, Vova is currently playing a strategic game known as Rage of Empires.Vova managed to build a large army, but forgot about the main person in the army - the commander. So he tries to hire a commander, and he wants to choose the person who will be respected by warriors.Each warrior is represented by his personality \xe2\x80\x94 an integer number pi. Each commander has two characteristics \xe2\x80\x94 his personality pj and leadership lj (both are integer numbers). Warrior i respects commander j only if  ( is the bitwise excluding OR of x and y).Initially Vova\'s army is empty. There are three different types of events that can happen with the army:  1 pi \xe2\x80\x94 one warrior with personality pi joins Vova\'s army;  2 pi \xe2\x80\x94 one warrior with personality pi leaves Vova\'s army;  3 pi li \xe2\x80\x94 Vova tries to hire a commander with personality pi and leadership li. For each event of the third type Vova wants to know how many warriors (counting only those who joined the army and haven\'t left yet) respect the commander he tries to hire." 2000
817D "Imbalanced Array" "data structures,divide and conquer,dsu,sortings" "You are given an array a consisting of n elements. The imbalance value of some subsegment of this array is the difference between the maximum and minimum element from this segment. The imbalance value of the array is the sum of imbalance values of all subsegments of this array.For example, the imbalance value of array [1,\xe2\x80\x894,\xe2\x80\x891] is 9, because there are 6 different subsegments of this array:   [1] (from index 1 to index 1), imbalance value is 0;  [1,\xe2\x80\x894] (from index 1 to index 2), imbalance value is 3;  [1,\xe2\x80\x894,\xe2\x80\x891] (from index 1 to index 3), imbalance value is 3;  [4] (from index 2 to index 2), imbalance value is 0;  [4,\xe2\x80\x891] (from index 2 to index 3), imbalance value is 3;  [1] (from index 3 to index 3), imbalance value is 0; You have to determine the imbalance value of the array a." 1900
817C "Really Big Numbers" "binary search,brute force,dp,math" "Ivan likes to learn different things about numbers, but he is especially interested in really big numbers. Ivan thinks that a positive integer number x is really big if the difference between x and the sum of its digits (in decimal representation) is not less than s. To prove that these numbers may have different special properties, he wants to know how rare (or not rare) they are \xe2\x80\x94 in fact, he needs to calculate the quantity of really big numbers that are not greater than n.Ivan tried to do the calculations himself, but soon realized that it\'s too difficult for him. So he asked you to help him in calculations." 1600
817B "Makes And The Product" combinatorics,implementation,math,sortings "After returning from the army Makes received a gift \xe2\x80\x94 an array a consisting of n positive integer numbers. He hadn\'t been solving problems for a long time, so he became interested to answer a particular question: how many triples of indices (i,\xe2\x80\x89 j,\xe2\x80\x89 k) (i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89k), such that ai\xc2\xb7aj\xc2\xb7ak is minimum possible, are there in the array? Help him with it!" 1500
817A "Treasure Hunt" "implementation,math,number theory" "Captain Bill the Hummingbird and his crew recieved an interesting challenge offer. Some stranger gave them a map, potion of teleportation and said that only this potion might help them to reach the treasure. Bottle with potion has two values x and y written on it. These values define four moves which can be performed using the potion:         Map shows that the position of Captain Bill the Hummingbird is (x1,\xe2\x80\x89y1) and the position of the treasure is (x2,\xe2\x80\x89y2).You task is to tell Captain Bill the Hummingbird whether he should accept this challenge or decline. If it is possible for Captain to reach the treasure using the potion then output ""YES"", otherwise ""NO"" (without quotes).The potion can be used infinite amount of times." 1200
816B "Karen and Coffee" "binary search,data structures,implementation" "To stay woke and attentive during classes, Karen needs some coffee!  Karen, a coffee aficionado, wants to know the optimal temperature for brewing the perfect cup of coffee. Indeed, she has spent some time reading several recipe books, including the universally acclaimed ""The Art of the Covfefe"".She knows n coffee recipes. The i-th recipe suggests that coffee should be brewed between li and ri degrees, inclusive, to achieve the optimal taste.Karen thinks that a temperature is admissible if at least k recipes recommend it.Karen has a rather fickle mind, and so she asks q questions. In each question, given that she only wants to prepare coffee with a temperature between a and b, inclusive, can you tell her how many admissible integer temperatures fall within the range?" 1400
816A "Karen and Morning" "brute force,implementation" "Karen is getting ready for a new school day!  It is currently hh:mm, given in a 24-hour format. As you know, Karen loves palindromes, and she believes that it is good luck to wake up when the time is a palindrome.What is the minimum number of minutes she should sleep, such that, when she wakes up, the time is a palindrome?Remember that a palindrome is a string that reads the same forwards and backwards. For instance, 05:39 is not a palindrome, because 05:39 backwards is 93:50. On the other hand, 05:50 is a palindrome, because 05:50 backwards is 05:50." 1000
815E "Karen and Neighborhood" "binary search,constructive algorithms,implementation" "It\'s been long after the events of the previous problems, and Karen has now moved on from student life and is looking to relocate to a new neighborhood.  The neighborhood consists of n houses in a straight line, labelled 1 to n from left to right, all an equal distance apart.Everyone in this neighborhood loves peace and quiet. Because of this, whenever a new person moves into the neighborhood, he or she always chooses the house whose minimum distance to any occupied house is maximized. If there are multiple houses with the maximum possible minimum distance, he or she chooses the leftmost one.Note that the first person to arrive always moves into house 1.Karen is the k-th person to enter this neighborhood. If everyone, including herself, follows this rule, which house will she move into?" 2900
815D "Karen and Cards" "binary search,combinatorics,data structures,geometry" "Karen just got home from the supermarket, and is getting ready to go to sleep.  After taking a shower and changing into her pajamas, she looked at her shelf and saw an album. Curious, she opened it and saw a trading card collection.She recalled that she used to play with those cards as a child, and, although she is now grown-up, she still wonders a few things about it.Each card has three characteristics: strength, defense and speed. The values of all characteristics of all cards are positive integers. The maximum possible strength any card can have is p, the maximum possible defense is q and the maximum possible speed is r.There are n cards in her collection. The i-th card has a strength ai, defense bi and speed ci, respectively.A card beats another card if at least two of its characteristics are strictly greater than the corresponding characteristics of the other card.She now wonders how many different cards can beat all the cards in her collection. Two cards are considered different if at least one of their characteristics have different values." 2800
815C "Karen and Supermarket" "brute force,dp,trees" "On the way home, Karen decided to stop by the supermarket to buy some groceries.  She needs to buy a lot of goods, but since she is a student her budget is still quite limited. In fact, she can only spend up to b dollars.The supermarket sells n goods. The i-th good can be bought for ci dollars. Of course, each good can only be bought once.Lately, the supermarket has been trying to increase its business. Karen, being a loyal customer, was given n coupons. If Karen purchases the i-th good, she can use the i-th coupon to decrease its price by di. Of course, a coupon cannot be used without buying the corresponding good.There is, however, a constraint with the coupons. For all i\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892, in order to use the i-th coupon, Karen must also use the xi-th coupon (which may mean using even more coupons to satisfy the requirement for that coupon).Karen wants to know the following. What is the maximum number of goods she can buy, without exceeding her budget b?" 2400
815B "Karen and Test" "brute force,combinatorics,constructive algorithms,math" "Karen has just arrived at school, and she has a math test today!  The test is about basic addition and subtraction. Unfortunately, the teachers were too busy writing tasks for Codeforces rounds, and had no time to make an actual test. So, they just put one question in the test that is worth all the points.There are n integers written on a row. Karen must alternately add and subtract each pair of adjacent integers, and write down the sums or differences on the next row. She must repeat this process on the values on the next row, and so on, until only one integer remains. The first operation should be addition.Note that, if she ended the previous row by adding the integers, she should start the next row by subtracting, and vice versa.The teachers will simply look at the last integer, and then if it is correct, Karen gets a perfect score, otherwise, she gets a zero for the test.Karen has studied well for this test, but she is scared that she might make a mistake somewhere and it will cause her final answer to be wrong. If the process is followed, what number can she expect to be written on the last row?Since this number can be quite large, output only the non-negative remainder after dividing it by 109\xe2\x80\x89+\xe2\x80\x897." 2200
815A "Karen and Game" "brute force,greedy,implementation" "On the way to school, Karen became fixated on the puzzle game on her phone!  The game is played as follows. In each level, you have a grid with n rows and m columns. Each cell originally contains the number 0.One move consists of choosing one row or column, and adding 1 to all of the cells in that row or column.To win the level, after all the moves, the number in the cell at the i-th row and j-th column should be equal to gi,\xe2\x80\x89j.Karen is stuck on one level, and wants to know a way to beat this level using the minimum number of moves. Please, help her with this task!" 1700
814E "An unavoidable detour for home" "combinatorics,dp,graphs,shortest paths" "Those unwilling to return home from a long journey, will be affected by the oddity of the snail and lose their way. Mayoi, the oddity\'s carrier, wouldn\'t like this to happen, but there\'s nothing to do with this before a cure is figured out. For now, she would only like to know the enormous number of possibilities to be faced with if someone gets lost.There are n towns in the region, numbered from 1 to n. The town numbered 1 is called the capital. The traffic network is formed by bidirectional roads connecting pairs of towns. No two roads connect the same pair of towns, and no road connects a town with itself. The time needed to travel through each of the roads is the same. Lost travelers will not be able to find out how the towns are connected, but the residents can help them by providing the following facts:   Starting from each town other than the capital, the shortest path (i.e. the path passing through the minimum number of roads) to the capital exists, and is unique;  Let li be the number of roads on the shortest path from town i to the capital, then li\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89li\xe2\x80\x89-\xe2\x80\x891 holds for all 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;  For town i, the number of roads connected to it is denoted by di, which equals either 2 or 3. You are to count the number of different ways in which the towns are connected, and give the answer modulo 109\xe2\x80\x89+\xe2\x80\x897. Two ways of connecting towns are considered different if a pair (u,\xe2\x80\x89v) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) exists such there is a road between towns u and v in one of them but not in the other." 2600
814D "An overnight dance in discotheque" "dfs and similar,dp,geometry,greedy,trees" "The crowdedness of the discotheque would never stop our friends from having fun, but a bit more spaciousness won\'t hurt, will it?The discotheque can be seen as an infinite xy-plane, in which there are a total of n dancers. Once someone starts moving around, they will move only inside their own movement range, which is a circular area Ci described by a center (xi,\xe2\x80\x89yi) and a radius ri. No two ranges\' borders have more than one common point, that is for every pair (i,\xe2\x80\x89j) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) either ranges Ci and Cj are disjoint, or one of them is a subset of the other. Note that it\'s possible that two ranges\' borders share a single common point, but no two dancers have exactly the same ranges.Tsukihi, being one of them, defines the spaciousness to be the area covered by an odd number of movement ranges of dancers who are moving. An example is shown below, with shaded regions representing the spaciousness if everyone moves at the same time.  But no one keeps moving for the whole night after all, so the whole night\'s time is divided into two halves \xe2\x80\x94 before midnight and after midnight. Every dancer moves around in one half, while sitting down with friends in the other. The spaciousness of two halves are calculated separately and their sum should, of course, be as large as possible. The following figure shows an optimal solution to the example above.  By different plans of who dances in the first half and who does in the other, different sums of spaciousness over two halves are achieved. You are to find the largest achievable value of this sum." 2000
814C "An impassioned circulation of affection" "brute force,dp,strings,two pointers" "Nadeko\'s birthday is approaching! As she decorated the room for the party, a long garland of Dianthus-shaped paper pieces was placed on a prominent part of the wall. Brother Koyomi will like it!Still unsatisfied with the garland, Nadeko decided to polish it again. The garland has n pieces numbered from 1 to n from left to right, and the i-th piece has a colour si, denoted by a lowercase English letter. Nadeko will repaint at most m of the pieces to give each of them an arbitrary new colour (still denoted by a lowercase English letter). After this work, she finds out all subsegments of the garland containing pieces of only colour c \xe2\x80\x94 Brother Koyomi\'s favourite one, and takes the length of the longest among them to be the Koyomity of the garland.For instance, let\'s say the garland is represented by ""kooomo"", and Brother Koyomi\'s favourite colour is ""o"". Among all subsegments containing pieces of ""o"" only, ""ooo"" is the longest, with a length of 3. Thus the Koyomity of this garland equals 3.But problem arises as Nadeko is unsure about Brother Koyomi\'s favourite colour, and has swaying ideas on the amount of work to do. She has q plans on this, each of which can be expressed as a pair of an integer mi and a lowercase letter ci, meanings of which are explained above. You are to find out the maximum Koyomity achievable after repainting the garland according to each plan." 1600
814B "An express train to reveries" "constructive algorithms" "Sengoku still remembers the mysterious ""colourful meteoroids"" she discovered with Lala-chan when they were little. In particular, one of the nights impressed her deeply, giving her the illusion that all her fancies would be realized.On that night, Sengoku constructed a permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn of integers from 1 to n inclusive, with each integer representing a colour, wishing for the colours to see in the coming meteor outburst. Two incredible outbursts then arrived, each with n meteorids, colours of which being integer sequences a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn respectively. Meteoroids\' colours were also between 1 and n inclusive, and the two sequences were not identical, that is, at least one i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) exists, such that ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi holds.Well, she almost had it all \xe2\x80\x94 each of the sequences a and b matched exactly n\xe2\x80\x89-\xe2\x80\x891 elements in Sengoku\'s permutation. In other words, there is exactly one i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89pi, and exactly one j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that bj\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89pj.For now, Sengoku is able to recover the actual colour sequences a and b through astronomical records, but her wishes have been long forgotten. You are to reconstruct any possible permutation Sengoku could have had on that night." 1300
814A "An abandoned sentiment from past" "constructive algorithms,greedy,implementation,sortings" "A few years ago, Hitagi encountered a giant crab, who stole the whole of her body weight. Ever since, she tried to avoid contact with others, for fear that this secret might be noticed.To get rid of the oddity and recover her weight, a special integer sequence is needed. Hitagi\'s sequence has been broken for a long time, but now Kaiki provides an opportunity.Hitagi\'s sequence a has a length of n. Lost elements in it are denoted by zeros. Kaiki provides another sequence b, whose length k equals the number of lost elements in a (i.e. the number of zeros). Hitagi is to replace each zero in a with an element from b so that each element in b should be used exactly once. Hitagi knows, however, that, apart from 0, no integer occurs in a and b more than once in total.If the resulting sequence is not an increasing sequence, then it has the power to recover Hitagi from the oddity. You are to determine whether this is possible, or Kaiki\'s sequence is just another fake. In other words, you should detect whether it is possible to replace each zero in a with an integer from b so that each integer from b is used exactly once, and the resulting sequence is not increasing." 900
813F "Bipartite Checking" "data structures,dsu,graphs" "You are given an undirected graph consisting of n vertices. Initially there are no edges in the graph. Also you are given q queries, each query either adds one undirected edge to the graph or removes it. After each query you have to check if the resulting graph is bipartite (that is, you can paint all vertices of the graph into two colors so that there is no edge connecting two vertices of the same color)." 2500
813E "Army Creation" "binary search,data structures" "As you might remember from our previous rounds, Vova really likes computer games. Now he is playing a strategy game known as Rage of Empires.In the game Vova can hire n different warriors; ith warrior has the type ai. Vova wants to create a balanced army hiring some subset of warriors. An army is called balanced if for each type of warrior present in the game there are not more than k warriors of this type in the army. Of course, Vova wants his army to be as large as possible.To make things more complicated, Vova has to consider q different plans of creating his army. ith plan allows him to hire only warriors whose numbers are not less than li and not greater than ri.Help Vova to determine the largest size of a balanced army for each plan.Be aware that the plans are given in a modified way. See input section for details." 2200
813D "Two Melodies" dp,flows "Alice is a beginner composer and now she is ready to create another masterpiece. And not even the single one but two at the same time! Alice has a sheet with n notes written on it. She wants to take two such non-empty non-intersecting subsequences that both of them form a melody and sum of their lengths is maximal.Subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.Subsequence forms a melody when each two adjacent notes either differs by 1 or are congruent modulo 7.You should write a program which will calculate maximum sum of lengths of such two non-empty non-intersecting subsequences that both of them form a melody." 2600
813C "The Tag Game" "dfs and similar,graphs" "Alice got tired of playing the tag game by the usual rules so she offered Bob a little modification to it. Now the game should be played on an undirected rooted tree of n vertices. Vertex 1 is the root of the tree.Alice starts at vertex 1 and Bob starts at vertex x (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x891). The moves are made in turns, Bob goes first. In one move one can either stay at the current vertex or travel to the neighbouring one.The game ends when Alice goes to the same vertex where Bob is standing. Alice wants to minimize the total number of moves and Bob wants to maximize it.You should write a program which will determine how many moves will the game last." 1700
813B "The Golden Age" "brute force,math" "Unlucky year in Berland is such a year that its number n can be represented as n\xe2\x80\x89=\xe2\x80\x89xa\xe2\x80\x89+\xe2\x80\x89yb, where a and b are non-negative integer numbers. For example, if x\xe2\x80\x89=\xe2\x80\x892 and y\xe2\x80\x89=\xe2\x80\x893 then the years 4 and 17 are unlucky (4\xe2\x80\x89=\xe2\x80\x8920\xe2\x80\x89+\xe2\x80\x8931, 17\xe2\x80\x89=\xe2\x80\x8923\xe2\x80\x89+\xe2\x80\x8932\xe2\x80\x89=\xe2\x80\x8924\xe2\x80\x89+\xe2\x80\x8930) and year 18 isn\'t unlucky as there is no such representation for it.Such interval of years that there are no unlucky years in it is called The Golden Age.You should write a program which will find maximum length of The Golden Age which starts no earlier than the year l and ends no later than the year r. If all years in the interval [l,\xe2\x80\x89r] are unlucky then the answer is 0." 1800
813A "The Contest" implementation "Pasha is participating in a contest on one well-known website. This time he wants to win the contest and will do anything to get to the first place!This contest consists of n problems, and Pasha solves ith problem in ai time units (his solutions are always correct). At any moment of time he can be thinking about a solution to only one of the problems (that is, he cannot be solving two problems at the same time). The time Pasha spends to send his solutions is negligible. Pasha can send any number of solutions at the same moment.Unfortunately, there are too many participants, and the website is not always working. Pasha received the information that the website will be working only during m time periods, jth period is represented by its starting moment lj and ending moment rj. Of course, Pasha can send his solution only when the website is working. In other words, Pasha can send his solution at some moment T iff there exists a period x such that lx\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89T\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rx.Pasha wants to know his best possible result. We need to tell him the minimal moment of time by which he is able to have solutions to all problems submitted, if he acts optimally, or say that it\'s impossible no matter how Pasha solves the problems." 1100
812E "Sagheer and Apple Tree" games,trees "Sagheer is playing a game with his best friend Soliman. He brought a tree with n nodes numbered from 1 to n and rooted at node 1. The i-th node has ai apples. This tree has a special property: the lengths of all paths from the root to any leaf have the same parity (i.e. all paths have even length or all paths have odd length).Sagheer and Soliman will take turns to play. Soliman will make the first move. The player who can\'t make a move loses.In each move, the current player will pick a single node, take a non-empty subset of apples from it and do one of the following two things:  eat the apples, if the node is a leaf.  move the apples to one of the children, if the node is non-leaf. Before Soliman comes to start playing, Sagheer will make exactly one change to the tree. He will pick two different nodes u and v and swap the apples of u with the apples of v.Can you help Sagheer count the number of ways to make the swap (i.e. to choose u and v) after which he will win the game if both players play optimally? (u,\xe2\x80\x89v) and (v,\xe2\x80\x89u) are considered to be the same pair." 2300
812D "Sagheer and Kindergarten" "dfs and similar,graphs,implementation,trees" "Sagheer is working at a kindergarten. There are n children and m different toys. These children use well-defined protocols for playing with the toys:  Each child has a lovely set of toys that he loves to play with. He requests the toys one after another at distinct moments of time. A child starts playing if and only if he is granted all the toys in his lovely set. If a child starts playing, then sooner or later he gives the toys back. No child keeps the toys forever. Children request toys at distinct moments of time. No two children request a toy at the same time. If a child is granted a toy, he never gives it back until he finishes playing with his lovely set. If a child is not granted a toy, he waits until he is granted this toy. He can\'t request another toy while waiting. If two children are waiting for the same toy, then the child who requested it first will take the toy first.Children don\'t like to play with each other. That\'s why they never share toys. When a child requests a toy, then granting the toy to this child depends on whether the toy is free or not. If the toy is free, Sagheer will give it to the child. Otherwise, the child has to wait for it and can\'t request another toy.Children are smart and can detect if they have to wait forever before they get the toys they want. In such case they start crying. In other words, a crying set is a set of children in which each child is waiting for a toy that is kept by another child in the set.Now, we have reached a scenario where all the children made all the requests for their lovely sets, except for one child x that still has one last request for his lovely set. Some children are playing while others are waiting for a toy, but no child is crying, and no one has yet finished playing. If the child x is currently waiting for some toy, he makes his last request just after getting that toy. Otherwise, he makes the request right away. When child x will make his last request, how many children will start crying?You will be given the scenario and q independent queries. Each query will be of the form x y meaning that the last request of the child x is for the toy y. Your task is to help Sagheer find the size of the maximal crying set when child x makes his last request." 2700
812C "Sagheer and Nubian Market" "binary search,sortings" "On his trip to Luxor and Aswan, Sagheer went to a Nubian market to buy some souvenirs for his friends and relatives. The market has some strange rules. It contains n different items numbered from 1 to n. The i-th item has base cost ai Egyptian pounds. If Sagheer buys k items with indices x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk, then the cost of item xj is axj\xe2\x80\x89+\xe2\x80\x89xj\xc2\xb7k for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k. In other words, the cost of an item is equal to its base cost in addition to its index multiplied by the factor k.Sagheer wants to buy as many souvenirs as possible without paying more than S Egyptian pounds. Note that he cannot buy a souvenir more than once. If there are many ways to maximize the number of souvenirs, he will choose the way that will minimize the total cost. Can you help him with this task?" 1500
812B "Sagheer, the Hausmeister" "bitmasks,brute force,dp" "Some people leave the lights at their workplaces on when they leave that is a waste of resources. As a hausmeister of DHBW, Sagheer waits till all students and professors leave the university building, then goes and turns all the lights off.The building consists of n floors with stairs at the left and the right sides. Each floor has m rooms on the same line with a corridor that connects the left and right stairs passing by all the rooms. In other words, the building can be represented as a rectangle with n rows and m\xe2\x80\x89+\xe2\x80\x892 columns, where the first and the last columns represent the stairs, and the m columns in the middle represent rooms.Sagheer is standing at the ground floor at the left stairs. He wants to turn all the lights off in such a way that he will not go upstairs until all lights in the floor he is standing at are off. Of course, Sagheer must visit a room to turn the light there off. It takes one minute for Sagheer to go to the next floor using stairs or to move from the current room/stairs to a neighboring room/stairs on the same floor. It takes no time for him to switch the light off in the room he is currently standing in. Help Sagheer find the minimum total time to turn off all the lights.Note that Sagheer does not have to go back to his starting position, and he does not have to visit rooms where the light is already switched off." 1600
812A "Sagheer and Crossroads" implementation "Sagheer is walking in the street when he comes to an intersection of two roads. Each road can be represented as two parts where each part has 3 lanes getting into the intersection (one for each direction) and 3 lanes getting out of the intersection, so we have 4 parts in total. Each part has 4 lights, one for each lane getting into the intersection (l \xe2\x80\x94 left, s \xe2\x80\x94 straight, r \xe2\x80\x94 right) and a light p for a pedestrian crossing.   An accident is possible if a car can hit a pedestrian. This can happen if the light of a pedestrian crossing of some part and the light of a lane that can get to or from that same part are green at the same time.Now, Sagheer is monitoring the configuration of the traffic lights. Your task is to help him detect whether an accident is possible." 1200
811E "Vladik and Entertaining Flags" "data structures,dsu,graphs" "In his spare time Vladik estimates beauty of the flags.Every flag could be represented as the matrix n\xe2\x80\x89\xc3\x97\xe2\x80\x89m which consists of positive integers.Let\'s define the beauty of the flag as number of components in its matrix. We call component a set of cells with same numbers and between any pair of cells from that set there exists a path through adjacent cells from same component. Here is the example of the partitioning some flag matrix into components:  But this time he decided to change something in the process. Now he wants to estimate not the entire flag, but some segment. Segment of flag can be described as a submatrix of the flag matrix with opposite corners at (1,\xe2\x80\x89l) and (n,\xe2\x80\x89r), where conditions 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m are satisfied.Help Vladik to calculate the beauty for some segments of the given flag." 2600
811D "Vladik and Favorite Game" "constructive algorithms,dfs and similar,graphs,interactive" "This is an interactive problem.Vladik has favorite game, in which he plays all his free time.Game field could be represented as n\xe2\x80\x89\xc3\x97\xe2\x80\x89m matrix which consists of cells of three types:   \xc2\xab.\xc2\xbb \xe2\x80\x94 normal cell, player can visit it.  \xc2\xabF\xc2\xbb \xe2\x80\x94 finish cell, player has to finish his way there to win. There is exactly one cell of this type.  \xc2\xab*\xc2\xbb \xe2\x80\x94 dangerous cell, if player comes to this cell, he loses. Initially player is located in the left top cell with coordinates (1,\xe2\x80\x891). Player has access to 4 buttons ""U"", ""D"", ""L"", ""R"", each of them move player up, down, left and right directions respectively.But it\xe2\x80\x99s not that easy! Sometimes friends play game and change functions of buttons. Function of buttons ""L"" and ""R"" could have been swapped, also functions of buttons ""U"" and ""D"" could have been swapped. Note that functions of buttons can be changed only at the beginning of the game.Help Vladik win the game!" 2100
811C "Vladik and Memorable Trip" dp,implementation "Vladik often travels by trains. He remembered some of his trips especially well and I would like to tell you about one of these trips:Vladik is at initial train station, and now n people (including Vladik) want to get on the train. They are already lined up in some order, and for each of them the city code ai is known (the code of the city in which they are going to).Train chief selects some number of disjoint segments of the original sequence of people (covering entire sequence by segments is not necessary). People who are in the same segment will be in the same train carriage. The segments are selected in such way that if at least one person travels to the city x, then all people who are going to city x should be in the same railway carriage. This means that they can\xe2\x80\x99t belong to different segments. Note, that all people who travel to the city x, either go to it and in the same railway carriage, or do not go anywhere at all.Comfort of a train trip with people on segment from position l to position r is equal to XOR of all distinct codes of cities for people on the segment from position l to position r. XOR operation also known as exclusive OR.Total comfort of a train trip is equal to sum of comfort for each segment.Help Vladik to know maximal possible total comfort." 1900
811B "Vladik and Complicated Book" implementation,sortings "Vladik had started reading a complicated book about algorithms containing n pages. To improve understanding of what is written, his friends advised him to read pages in some order given by permutation P\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn], where pi denotes the number of page that should be read i-th in turn.Sometimes Vladik\xe2\x80\x99s mom sorted some subsegment of permutation P from position l to position r inclusive, because she loves the order. For every of such sorting Vladik knows number x \xe2\x80\x94 what index of page in permutation he should read. He is wondered if the page, which he will read after sorting, has changed. In other words, has px changed? After every sorting Vladik return permutation to initial state, so you can assume that each sorting is independent from each other." 1200
811A "Vladik and Courtesy" "brute force,implementation" "At regular competition Vladik and Valera won a and b candies respectively. Vladik offered 1 his candy to Valera. After that Valera gave Vladik 2 his candies, so that no one thought that he was less generous. Vladik for same reason gave 3 candies to Valera in next turn.More formally, the guys take turns giving each other one candy more than they received in the previous turn.This continued until the moment when one of them couldn\xe2\x80\x99t give the right amount of candy. Candies, which guys got from each other, they don\xe2\x80\x99t consider as their own. You need to know, who is the first who can\xe2\x80\x99t give the right amount of candy." 800
810B "Summer sell-off" greedy,sortings "Summer holidays! Someone is going on trips, someone is visiting grandparents, but someone is trying to get a part-time job. This summer Noora decided that she wants to earn some money, and took a job in a shop as an assistant.Shop, where Noora is working, has a plan on the following n days. For each day sales manager knows exactly, that in i-th day ki products will be put up for sale and exactly li clients will come to the shop that day. Also, the manager is sure, that everyone, who comes to the shop, buys exactly one product or, if there aren\'t any left, leaves the shop without buying anything. Moreover, due to the short shelf-life of the products, manager established the following rule: if some part of the products left on the shelves at the end of the day, that products aren\'t kept on the next day and are sent to the dump.For advertising purposes manager offered to start a sell-out in the shop. He asked Noora to choose any f days from n next for sell-outs. On each of f chosen days the number of products were put up for sale would be doubled. Thus, if on i-th day shop planned to put up for sale ki products and Noora has chosen this day for sell-out, shelves of the shop would keep 2\xc2\xb7ki products. Consequently, there is an opportunity to sell two times more products on days of sell-out.Noora\'s task is to choose f days to maximize total number of sold products. She asks you to help her with such a difficult problem." 1300
810A "Straight <<A>>" implementation,math "Noora is a student of one famous high school. It\'s her final year in school \xe2\x80\x94 she is going to study in university next year. However, she has to get an \xc2\xabA\xc2\xbb graduation certificate in order to apply to a prestigious one.In school, where Noora is studying, teachers are putting down marks to the online class register, which are integers from 1 to k. The worst mark is 1, the best is k. Mark that is going to the certificate, is calculated as an average of all the marks, rounded to the closest integer. If several answers are possible, rounding up is produced. For example, 7.3 is rounded to 7, but 7.5 and 7.8784 \xe2\x80\x94 to 8. For instance, if Noora has marks [8,\xe2\x80\x899], then the mark to the certificate is 9, because the average is equal to 8.5 and rounded to 9, but if the marks are [8,\xe2\x80\x898,\xe2\x80\x899], Noora will have graduation certificate with 8.To graduate with \xc2\xabA\xc2\xbb certificate, Noora has to have mark k.Noora got n marks in register this year. However, she is afraid that her marks are not enough to get final mark k. Noora decided to ask for help in the internet, where hacker Leha immediately responded to her request. He is ready to hack class register for Noora and to add Noora any number of additional marks from 1 to k. At the same time, Leha want his hack be unseen to everyone, so he decided to add as less as possible additional marks. Please help Leha to calculate the minimal number of marks he has to add, so that final Noora\'s mark will become equal to k." 900
809E "Surprise me!" "divide and conquer,math,number theory,trees" "Tired of boring dates, Leha and Noora decided to play a game.Leha found a tree with n vertices numbered from 1 to n. We remind you that tree is an undirected graph without cycles. Each vertex v of a tree has a number av written on it. Quite by accident it turned out that all values written on vertices are distinct and are natural numbers between 1 and n.The game goes in the following way. Noora chooses some vertex u of a tree uniformly at random and passes a move to Leha. Leha, in his turn, chooses (also uniformly at random) some vertex v from remaining vertices of a tree (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u). As you could guess there are n(n\xe2\x80\x89-\xe2\x80\x891) variants of choosing vertices by players. After that players calculate the value of a function f(u,\xe2\x80\x89v)\xe2\x80\x89=\xe2\x80\x89\xcf\x86(au\xc2\xb7av) \xc2\xb7 d(u,\xe2\x80\x89v) of the chosen vertices where \xcf\x86(x) is Euler\'s totient function and d(x,\xe2\x80\x89y) is the shortest distance between vertices x and y in a tree.Soon the game became boring for Noora, so Leha decided to defuse the situation and calculate expected value of function f over all variants of choosing vertices u and v, hoping of at least somehow surprise the girl.Leha asks for your help in calculating this expected value. Let this value be representable in the form of an irreducible fraction . To further surprise Noora, he wants to name her the value . Help Leha!" 3100
809D "Hitchhiking in the Baltic States" "data structures,dp" "Leha and Noora decided to go on a trip in the Baltic States. As you know from the previous problem, Leha has lost his car on the parking of the restaurant. Unfortunately, requests to the watchman didn\'t helped hacker find the car, so friends decided to go hitchhiking.In total, they intended to visit n towns. However it turned out that sights in i-th town are open for visitors only on days from li to ri.What to do? Leha proposed to choose for each town i a day, when they will visit this town, i.e any integer xi in interval [li,\xe2\x80\x89ri]. After that Noora choses some subsequence of towns id1,\xe2\x80\x89id2,\xe2\x80\x89...,\xe2\x80\x89idk, which friends are going to visit, that at first they are strictly increasing, i.e idi\xe2\x80\x89<\xe2\x80\x89idi\xe2\x80\x89+\xe2\x80\x891 is for all integers i from 1 to k\xe2\x80\x89-\xe2\x80\x891, but also the dates of the friends visits are strictly increasing, i.e xidi\xe2\x80\x89<\xe2\x80\x89xidi\xe2\x80\x89+\xe2\x80\x891 is true for all integers i from 1 to k\xe2\x80\x89-\xe2\x80\x891.Please help Leha and Noora in choosing such xi for each town i, and such subsequence of towns id1,\xe2\x80\x89id2,\xe2\x80\x89...,\xe2\x80\x89idk, so that friends can visit maximal number of towns.You may assume, that Leha and Noora can start the trip any day." 2900
809C "Find a car" "combinatorics,divide and conquer,dp" "After a wonderful evening in the restaurant the time to go home came. Leha as a true gentlemen suggested Noora to give her a lift. Certainly the girl agreed with pleasure. Suddenly one problem appeared: Leha cannot find his car on a huge parking near the restaurant. So he decided to turn to the watchman for help.Formally the parking can be represented as a matrix 109\xe2\x80\x89\xc3\x97\xe2\x80\x89109. There is exactly one car in every cell of the matrix. All cars have their own machine numbers represented as a positive integer. Let\'s index the columns of the matrix by integers from 1 to 109 from left to right and the rows by integers from 1 to 109 from top to bottom. By coincidence it turned out, that for every cell (x,\xe2\x80\x89y) the number of the car, which stands in this cell, is equal to the minimum positive integer, which can\'t be found in the cells (i,\xe2\x80\x89y) and (x,\xe2\x80\x89j), 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89x,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89y.  The upper left fragment 5\xe2\x80\x89\xc3\x97\xe2\x80\x895 of the parking Leha wants to ask the watchman q requests, which can help him to find his car. Every request is represented as five integers x1,\xe2\x80\x89y1,\xe2\x80\x89x2,\xe2\x80\x89y2,\xe2\x80\x89k. The watchman have to consider all cells (x,\xe2\x80\x89y) of the matrix, such that x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2 and y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2, and if the number of the car in cell (x,\xe2\x80\x89y) does not exceed k, increase the answer to the request by the number of the car in cell (x,\xe2\x80\x89y). For each request Leha asks the watchman to tell him the resulting sum. Due to the fact that the sum can turn out to be quite large, hacker asks to calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897.However the requests seem to be impracticable for the watchman. Help the watchman to answer all Leha\'s requests." 2600
809B "Glad to see you!" "binary search,interactive" "This is an interactive problem. In the output section below you will see the information about flushing the output.On Sunday Leha the hacker took Nura from the house where she lives and went with her to one of the most luxurious restaurants in Vi\xc4\x8dkopolis. Upon arrival, they left the car in a huge parking lot near the restaurant and hurried inside the building.In the restaurant a polite waiter immediately brought the menu to Leha and Noora, consisting of n dishes. It is interesting that all dishes in the menu are numbered with integers from 1 to n. After a little thought, the girl ordered exactly k different dishes from available in the menu. To pass the waiting time while the chefs prepare ordered dishes, the girl invited the hacker to play a game that will help them get to know each other better.The game itself is very simple: Noora wants Leha to guess any two dishes among all ordered. At the same time, she is ready to answer only one type of questions. Leha can say two numbers x and y (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). After that Noora chooses some dish a for the number x such that, at first, a is among the dishes Noora ordered (x can be equal to a), and, secondly, the value  is the minimum possible. By the same rules the girl chooses dish b for y. After that Noora says \xc2\xabTAK\xc2\xbb to Leha, if , and \xc2\xabNIE\xc2\xbb otherwise. However, the restaurant is preparing quickly, so Leha has enough time to ask no more than 60 questions. After that he should name numbers of any two dishes Noora ordered.Help Leha to solve this problem!" 2200
809A "Do you want a date?" implementation,math,sortings "Leha decided to move to a quiet town Vi\xc4\x8dkopolis, because he was tired by living in Bankopolis. Upon arrival he immediately began to expand his network of hacked computers. During the week Leha managed to get access to n computers throughout the town. Incidentally all the computers, which were hacked by Leha, lie on the same straight line, due to the reason that there is the only one straight street in Vi\xc4\x8dkopolis.Let\'s denote the coordinate system on this street. Besides let\'s number all the hacked computers with integers from 1 to n. So the i-th hacked computer is located at the point xi. Moreover the coordinates of all computers are distinct. Leha is determined to have a little rest after a hard week. Therefore he is going to invite his friend Noora to a restaurant. However the girl agrees to go on a date with the only one condition: Leha have to solve a simple task.Leha should calculate a sum of F(a) for all a, where a is a non-empty subset of the set, that consists of all hacked computers. Formally, let\'s denote A the set of all integers from 1 to n. Noora asks the hacker to find value of the expression . Here F(a) is calculated as the maximum among the distances between all pairs of computers from the set a. Formally, . Since the required sum can be quite large Noora asks to find it modulo 109\xe2\x80\x89+\xe2\x80\x897.Though, Leha is too tired. Consequently he is not able to solve this task. Help the hacker to attend a date." 1500
808G "Anthem of Berland" dp,strings "Berland has a long and glorious history. To increase awareness about it among younger citizens, King of Berland decided to compose an anthem.Though there are lots and lots of victories in history of Berland, there is the one that stand out the most. King wants to mention it in the anthem as many times as possible.He has already composed major part of the anthem and now just needs to fill in some letters. King asked you to help him with this work.The anthem is the string s of no more than 105 small Latin letters and question marks. The most glorious victory is the string t of no more than 105 small Latin letters. You should replace all the question marks with small Latin letters in such a way that the number of occurrences of string t in string s is maximal.Note that the occurrences of string t in s can overlap. Check the third example for clarification." 2300
808F "Card Game" "binary search,flows,graphs" "Digital collectible card games have become very popular recently. So Vova decided to try one of these.Vova has n cards in his collection. Each of these cards is characterised by its power pi, magic number ci and level li. Vova wants to build a deck with total power not less than k, but magic numbers may not allow him to do so \xe2\x80\x94 Vova can\'t place two cards in a deck if the sum of the magic numbers written on these cards is a prime number. Also Vova cannot use a card if its level is greater than the level of Vova\'s character.At the moment Vova\'s character\'s level is 1. Help Vova to determine the minimum level he needs to reach in order to build a deck with the required total power." 2400
808E "Selling Souvenirs" "binary search,dp,greedy,ternary search" "After several latest reforms many tourists are planning to visit Berland, and Berland people understood that it\'s an opportunity to earn money and changed their jobs to attract tourists. Petya, for example, left the IT corporation he had been working for and started to sell souvenirs at the market.This morning, as usual, Petya will come to the market. Petya has n different souvenirs to sell; ith souvenir is characterised by its weight wi and cost ci. Petya knows that he might not be able to carry all the souvenirs to the market. So Petya wants to choose a subset of souvenirs such that its total weight is not greater than m, and total cost is maximum possible.Help Petya to determine maximum possible total cost." 2300
808D "Array Division" "binary search,data structures,implementation" "Vasya has an array a consisting of positive integer numbers. Vasya wants to divide this array into two non-empty consecutive parts (the prefix and the suffix) so that the sum of all elements in the first part equals to the sum of elements in the second part. It is not always possible, so Vasya will move some element before dividing the array (Vasya will erase some element and insert it into an arbitrary position).Inserting an element in the same position he was erased from is also considered moving.Can Vasya divide the array after choosing the right element to move and its new position?" 1900
808C "Tea Party" "constructive algorithms,greedy,sortings" "Polycarp invited all his friends to the tea party to celebrate the holiday. He has n cups, one for each of his n friends, with volumes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. His teapot stores w milliliters of tea (w\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an). Polycarp wants to pour tea in cups in such a way that:  Every cup will contain tea for at least half of its volume  Every cup will contain integer number of milliliters of tea  All the tea from the teapot will be poured into cups  All friends will be satisfied. Friend with cup i won\'t be satisfied, if there exists such cup j that cup i contains less tea than cup j but ai\xe2\x80\x89>\xe2\x80\x89aj.For each cup output how many milliliters of tea should be poured in it. If it\'s impossible to pour all the tea and satisfy all conditions then output -1." 1400
808B "Average Sleep Time" "data structures,implementation,math" "It\'s been almost a week since Polycarp couldn\'t get rid of insomnia. And as you may already know, one week in Berland lasts k days!When Polycarp went to a doctor with his problem, the doctor asked him about his sleeping schedule (more specifically, the average amount of hours of sleep per week). Luckily, Polycarp kept records of sleep times for the last n days. So now he has a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the sleep time on the i-th day.The number of records is so large that Polycarp is unable to calculate the average value by himself. Thus he is asking you to help him with the calculations. To get the average Polycarp is going to consider k consecutive days as a week. So there will be n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 weeks to take into consideration. For example, if k\xe2\x80\x89=\xe2\x80\x892, n\xe2\x80\x89=\xe2\x80\x893 and a\xe2\x80\x89=\xe2\x80\x89[3,\xe2\x80\x894,\xe2\x80\x897], then the result is .You should write a program which will calculate average sleep times of Polycarp over all weeks." 1300
808A "Lucky Year" implementation "Apart from having lots of holidays throughout the year, residents of Berland also have whole lucky years. Year is considered lucky if it has no more than 1 non-zero digit in its number. So years 100, 40000, 5 are lucky and 12, 3001 and 12345 are not.You are given current year in Berland. Your task is to find how long will residents of Berland wait till the next lucky year." 900
807B "T-Shirt Hunt" "brute force,implementation" "Not so long ago the Codecraft-17 contest was held on Codeforces. The top 25 participants, and additionally random 25 participants out of those who got into top 500, will receive a Codeforces T-shirt.Unfortunately, you didn\'t manage to get into top 25, but you got into top 500, taking place p.Now the elimination round of 8VC Venture Cup 2017 is being held. It has been announced that the Codecraft-17 T-shirt winners will be chosen as follows. Let s be the number of points of the winner of the elimination round of 8VC Venture Cup 2017. Then the following pseudocode will be executed: i := (s div 50) mod 475repeat 25 times:    i := (i * 96 + 42) mod 475    print (26 + i)Here ""div"" is the integer division operator, ""mod"" is the modulo (the remainder of division) operator.As the result of pseudocode execution, 25 integers between 26 and 500, inclusive, will be printed. These will be the numbers of places of the participants who get the Codecraft-17 T-shirts. It is guaranteed that the 25 printed integers will be pairwise distinct for any value of s.You\'re in the lead of the elimination round of 8VC Venture Cup 2017, having x points. You believe that having at least y points in the current round will be enough for victory.To change your final score, you can make any number of successful and unsuccessful hacks. A successful hack brings you 100 points, an unsuccessful one takes 50 points from you. It\'s difficult to do successful hacks, though.You want to win the current round and, at the same time, ensure getting a Codecraft-17 T-shirt. What is the smallest number of successful hacks you have to do to achieve that?" 1300
807A "Is it rated?" implementation,sortings "Is it rated?Here it is. The Ultimate Question of Competitive Programming, Codeforces, and Everything. And you are here to answer it.Another Codeforces round has been conducted. No two participants have the same number of points. For each participant, from the top to the bottom of the standings, their rating before and after the round is known.It\'s known that if at least one participant\'s rating has changed, then the round was rated for sure.It\'s also known that if the round was rated and a participant with lower rating took a better place in the standings than a participant with higher rating, then at least one round participant\'s rating has changed.In this problem, you should not make any other assumptions about the rating system.Determine if the current round is rated, unrated, or it\'s impossible to determine whether it is rated of not." 900
805B 3-palindrome "constructive algorithms" "In the beginning of the new year Keivan decided to reverse his name. He doesn\'t like palindromes, so he changed Naviek to Navick.He is too selfish, so for a given n he wants to obtain a string of n characters, each of which is either \'a\', \'b\' or \'c\', with no palindromes of length 3 appearing in the string as a substring. For example, the strings ""abc"" and ""abca"" suit him, while the string ""aba"" doesn\'t. He also want the number of letters \'c\' in his string to be as little as possible." 1000
805A "Fake NP" greedy,math "Tavak and Seyyed are good friends. Seyyed is very funny and he told Tavak to solve the following problem instead of longest-path.You are given l and r. For all integers from l to r, inclusive, we wrote down all of their integer divisors except 1. Find the integer that we wrote down the maximum number of times.Solve the problem to show that it\'s not a NP problem." 1000
804F "Fake bullions" "combinatorics,dfs and similar,dp,graphs,number theory" "In Isart people don\'t die. There are n gangs of criminals. The i-th gang contains si evil people numerated from 0 to si\xe2\x80\x89-\xe2\x80\x891. Some of these people took part in a big mine robbery and picked one gold bullion each (these people are given in the input). That happened 10100 years ago and then all of the gangs escaped to a remote area, far from towns.During the years, they were copying some gold bullions according to an organized plan in order to not get arrested. They constructed a tournament directed graph (a graph where there is exactly one directed edge between every pair of vertices) of gangs (the graph is given in the input). In this graph an edge from u to v means that in the i-th hour the person  of the gang u can send a fake gold bullion to person  of gang v. He sends it if he has some bullion (real or fake), while the receiver doesn\'t have any. Thus, at any moment each of the gangsters has zero or one gold bullion. Some of them have real bullions, and some of them have fake ones.In the beginning of this year, the police has finally found the gangs, but they couldn\'t catch them, as usual. The police decided to open a jewelry store so that the gangsters would sell the bullions. Thus, every gangster that has a bullion (fake or real) will try to sell it. If he has a real gold bullion, he sells it without problems, but if he has a fake one, there is a choice of two events that can happen:   The person sells the gold bullion successfully.  The person is arrested by police. The power of a gang is the number of people in it that successfully sold their bullion. After all selling is done, the police arrests b gangs out of top gangs. Sort the gangs by powers, we call the first a gang top gangs(you can sort the equal powers in each order). Consider all possible results of selling fake gold bullions and all possible choice of b gangs among the top gangs. Count the number of different sets of these b gangs modulo 109\xe2\x80\x89+\xe2\x80\x897. Two sets X and Y are considered different if some gang is in X and isn\'t in Y." 3400
804E "The same permutation" "constructive algorithms" "Seyyed and MoJaK are friends of Sajjad. Sajjad likes a permutation. Seyyed wants to change the permutation in a way that Sajjad won\'t like it. Seyyed thinks more swaps yield more probability to do that, so he makes MoJaK to perform a swap between every pair of positions (i,\xe2\x80\x89j), where i\xe2\x80\x89<\xe2\x80\x89j, exactly once. MoJaK doesn\'t like to upset Sajjad.Given the permutation, determine whether it is possible to swap all pairs of positions so that the permutation stays the same. If it is possible find how to do that." 3100
804D "Expected diameter of a tree" "binary search,brute force,dfs and similar,dp,sortings,trees" "Pasha is a good student and one of MoJaK\'s best friends. He always have a problem to think about. Today they had a talk about the following problem.We have a forest (acyclic undirected graph) with n vertices and m edges. There are q queries we should answer. In each query two vertices v and u are given. Let V be the set of vertices in the connected component of the graph that contains v, and U be the set of vertices in the connected component of the graph that contains u. Let\'s add an edge between some vertex  and some vertex in  and compute the value d of the resulting component. If the resulting component is a tree, the value d is the diameter of the component, and it is equal to -1 otherwise. What is the expected value of d, if we choose vertices a and b from the sets uniformly at random?Can you help Pasha to solve this problem?The diameter of the component is the maximum distance among some pair of vertices in the component. The distance between two vertices is the minimum number of edges on some path between the two vertices.Note that queries don\'t add edges to the initial forest." 2500
804C "Ice cream coloring" "constructive algorithms,dfs and similar,greedy" "Isart and Modsart were trying to solve an interesting problem when suddenly Kasra arrived. Breathless, he asked: ""Can you solve a problem I\'m stuck at all day?""We have a tree T with n vertices and m types of ice cream numerated from 1 to m. Each vertex i has a set of si types of ice cream. Vertices which have the i-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) type of ice cream form a connected subgraph. We build a new graph G with m vertices. We put an edge between the v-th and the u-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u,\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, u\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89v) vertices in G if and only if there exists a vertex in T that has both the v-th and the u-th types of ice cream in its set. The problem is to paint the vertices of G with minimum possible number of colors in a way that no adjacent vertices have the same color.Please note that we consider that empty set of vertices form a connected subgraph in this problem.As usual, Modsart don\'t like to abandon the previous problem, so Isart wants you to solve the new problem." 2200
804B "Minimum number of steps" combinatorics,greedy,implementation,math "We have a string of letters \'a\' and \'b\'. We want to perform some operations on it. On each step we choose one of substrings ""ab"" in the string and replace it with the string ""bba"". If we have no ""ab"" as a substring, our job is done. Print the minimum number of steps we should perform to make our job done modulo 109\xe2\x80\x89+\xe2\x80\x897.The string ""ab"" appears as a substring if there is a letter \'b\' right after the letter \'a\' somewhere in the string." 1400
804A "Find Amir" "constructive algorithms,greedy,math" "A few years ago Sajjad left his school and register to another one due to security reasons. Now he wishes to find Amir, one of his schoolmates and good friends.There are n schools numerated from 1 to n. One can travel between each pair of them, to do so, he needs to buy a ticket. The ticker between schools i and j costs  and can be used multiple times. Help Sajjad to find the minimum cost he needs to pay for tickets to visit all schools. He can start and finish in any school." 1000
803G "Periodic RMQ Problem" "data structures" "You are given an array a consisting of positive integers and q queries to this array. There are two types of queries:   1 l r x \xe2\x80\x94 for each index i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r set ai\xe2\x80\x89=\xe2\x80\x89x.  2 l r \xe2\x80\x94 find the minimum among such ai that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. We decided that this problem is too easy. So the array a is given in a compressed form: there is an array b consisting of n elements and a number k in the input, and before all queries a is equal to the concatenation of k arrays b (so the size of a is n\xc2\xb7k)." 2300
803F "Coprime Subsequences" "bitmasks,combinatorics,number theory" "Let\'s call a non-empty sequence of positive integers a1,\xe2\x80\x89a2... ak coprime if the greatest common divisor of all elements of this sequence is equal to 1.Given an array a consisting of n positive integers, find the number of its coprime subsequences. Since the answer may be very large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897.Note that two subsequences are considered different if chosen indices are different. For example, in the array [1,\xe2\x80\x891] there are 3 different subsequences: [1], [1] and [1,\xe2\x80\x891]." 2000
803E "Roma and Poker" dp,graphs "Each evening Roma plays online poker on his favourite website. The rules of poker on this website are a bit strange: there are always two players in a hand, there are no bets, and the winner takes 1 virtual bourle from the loser.Last evening Roma started to play poker. He decided to spend no more than k virtual bourles \xe2\x80\x94 he will stop immediately if the number of his loses exceeds the number of his wins by k. Also Roma will leave the game if he wins enough money for the evening, i.e. if the number of wins exceeds the number of loses by k.Next morning Roma found a piece of paper with a sequence on it representing his results. Roma doesn\'t remember the results exactly, and some characters in the sequence are written in a way such that it\'s impossible to recognize this character, so Roma can\'t recall whether he won k bourles or he lost.The sequence written by Roma is a string s consisting of characters W (Roma won the corresponding hand), L (Roma lost), D (draw) and ? (unknown result). Roma wants to restore any valid sequence by changing all ? characters to W, L or D. The sequence is called valid if all these conditions are met:   In the end the absolute difference between the number of wins and loses is equal to k;  There is no hand such that the absolute difference before this hand was equal to k. Help Roma to restore any such sequence." 2000
803D "Magazine Ad" "binary search,greedy" "The main city magazine offers its readers an opportunity to publish their ads. The format of the ad should be like this:There are space-separated non-empty words of lowercase and uppercase Latin letters.There are hyphen characters \'-\' in some words, their positions set word wrapping points. Word can include more than one hyphen. It is guaranteed that there are no adjacent spaces and no adjacent hyphens. No hyphen is adjacent to space. There are no spaces and no hyphens before the first word and after the last word. When the word is wrapped, the part of the word before hyphen and the hyphen itself stay on current line and the next part of the word is put on the next line. You can also put line break between two words, in that case the space stays on current line. Check notes for better understanding.The ad can occupy no more that k lines and should have minimal width. The width of the ad is the maximal length of string (letters, spaces and hyphens are counted) in it.You should write a program that will find minimal width of the ad." 1900
803C "Maximal GCD" "constructive algorithms,greedy,math" "You are given positive integer number n. You should create such strictly increasing sequence of k positive numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak, that their sum is equal to n and greatest common divisor is maximal.Greatest common divisor of sequence is maximum of such numbers that every element of sequence is divisible by them.If there is no possible sequence then output -1." 1900
803B "Distances to Zero" "constructive algorithms" "You are given the array of integer numbers a0,\xe2\x80\x89a1,\xe2\x80\x89...,\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x891. For each element find the distance to the nearest zero (to the element which equals to zero). There is at least one zero element in the given array." 1200
803A "Maximal Binary Matrix" "constructive algorithms" "You are given matrix with n rows and n columns filled with zeroes. You should put k ones in it in such a way that the resulting matrix is symmetrical with respect to the main diagonal (the diagonal that goes from the top left to the bottom right corner) and is lexicographically maximal.One matrix is lexicographically greater than the other if the first different number in the first different row from the top in the first matrix is greater than the corresponding number in the second one.If there exists no such matrix then output -1." 1400
802O "April Fools\' Problem (hard)" "binary search,data structures,flows" "The plans for HC2 are rather far-fetched: we are just over 500 000 days away from HC2 3387, for example, and accordingly we are planning to have a couple hundred thousand problems in that edition (we hope that programming contests will become wildly more popular). The marmots need to get to work, and they could use a good plan..." 2900
802N "April Fools\' Problem (medium)" "binary search,flows,graphs" "The marmots need to prepare k problems for HC2 over n days. Each problem, once prepared, also has to be printed.The preparation of a problem on day i (at most one per day) costs ai CHF, and the printing of a problem on day i (also at most one per day) costs bi CHF. Of course, a problem cannot be printed before it has been prepared (but doing both on the same day is fine).What is the minimum cost of preparation and printing?" 2400
802M "April Fools\' Problem (easy)" greedy,sortings "The marmots have prepared a very easy problem for this year\'s HC2 \xe2\x80\x93 this one. It involves numbers n, k and a sequence of n positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. They also came up with a beautiful and riveting story for the problem statement. It explains what the input means, what the program should output, and it also reads like a good criminal.However I, Heidi, will have none of that. As my joke for today, I am removing the story from the statement and replacing it with these two unhelpful paragraphs. Now solve the problem, fools!" 1200
802L "Send the Fool Further! (hard)" "dfs and similar,dp,math,trees" "Heidi is terrified by your estimate and she found it unrealistic that her friends would collaborate to drive her into debt. She expects that, actually, each person will just pick a random friend to send Heidi to. (This randomness assumption implies, however, that she can now visit the same friend an arbitrary number of times...) Moreover, if a person only has one friend in common with Heidi (i.e., if that person is in a leaf of the tree), then that person will not send Heidi back (so that Heidi\'s travel will end at some point).Heidi also found unrealistic the assumption that she can make all the travels in one day. Therefore now she assumes that every time she travels a route between two friends, she needs to buy a new ticket. She wants to know: how much should she expect to spend on the trips?For what it\'s worth, Heidi knows that Jenny has at least two friends." 2400
802K "Send the Fool Further! (medium)" dp,trees "Thank you for helping Heidi! It is now the second of April, but she has been summoned by Jenny again. The pranks do not seem to end...In the meantime, Heidi has decided that she does not trust her friends anymore. Not too much, anyway. Her relative lack of trust is manifested as follows: whereas previously she would not be made to visit the same person twice, now she can only be sure that she will not be made to visit the same person more than k times. (In the case of Jenny, this includes her first visit in the beginning. The situation from the easy version corresponds to setting k\xe2\x80\x89=\xe2\x80\x891.)This is not as bad as it looks, since a single ticket for a route between two friends allows Heidi to travel between this pair of friends the whole day (in both directions). In other words, once she pays for travel between a pair of friends, all further travels between that pair are free.How much money will Heidi waste now, in a worst-case scenario?" 2100
802J "Send the Fool Further! (easy)" "dfs and similar,graphs,trees" "Heidi\'s friend Jenny is asking Heidi to deliver an important letter to one of their common friends. Since Jenny is Irish, Heidi thinks that this might be a prank. More precisely, she suspects that the message she is asked to deliver states: ""Send the fool further!"", and upon reading it the recipient will ask Heidi to deliver the same message to yet another friend (that the recipient has in common with Heidi), and so on.Heidi believes that her friends want to avoid awkward situations, so she will not be made to visit the same person (including Jenny) twice. She also knows how much it costs to travel between any two of her friends who know each other. She wants to know: what is the maximal amount of money she will waste on travel if it really is a prank?Heidi\'s n friends are labeled 0 through n\xe2\x80\x89-\xe2\x80\x891, and their network of connections forms a tree. In other words, every two of her friends a, b know each other, possibly indirectly (there is a sequence of friends starting from a and ending on b and such that each two consecutive friends in the sequence know each other directly), and there are exactly n\xe2\x80\x89-\xe2\x80\x891 pairs of friends who know each other directly.Jenny is given the number 0." 1400
802I "Fake News (hard)" "string suffix structures" "Now that you have proposed a fake post for the HC2 Facebook page, Heidi wants to measure the quality of the post before actually posting it. She recently came across a (possibly fake) article about the impact of fractal structure on multimedia messages and she is now trying to measure the self-similarity of the message, which is defined aswhere the sum is over all nonempty strings p and  is the number of occurences of p in s as a substring. (Note that the sum is infinite, but it only has a finite number of nonzero summands.)Heidi refuses to do anything else until she knows how to calculate this self-similarity. Could you please help her? (If you would like to instead convince Heidi that a finite string cannot be a fractal anyway \xe2\x80\x93 do not bother, we have already tried.)" 2300
802H "Fake News (medium)" "constructive algorithms,strings" "Thanks to your help, Heidi is confident that no one can fool her. She has now decided to post some fake news on the HC2 Facebook page. However, she wants to be able to communicate to the HC2 committee that the post is fake, using some secret phrase hidden in the post as a subsequence. To make this method foolproof, she wants the phrase to appear n times in the post. She is asking you to design a post (string) s and a hidden phrase p such that p appears in s as a subsequence exactly n times." 2200
802G "Fake News (easy)" implementation,strings "As it\'s the first of April, Heidi is suspecting that the news she reads today are fake, and she does not want to look silly in front of all the contestants. She knows that a newspiece is fake if it contains heidi as a subsequence. Help Heidi assess whether the given piece is true, but please be discreet about it..." 800
802F "Marmots (hard)" math,probabilities "Your task is the exact same as for the easy version. But this time, the marmots subtract the village\'s population P from their random number before responding to Heidi\'s request.Also, there are now villages with as few as a single inhabitant, meaning that .Can you help Heidi find out whether a village follows a Poisson or a uniform distribution?" 2800
802E "Marmots (medium)" math "Good job! Now that Heidi is able to distinguish between Poisson and uniform distributions, she is in a good position to actually estimate the populations.Can you help Heidi estimate each village\'s population?" 2200
802D "Marmots (easy)" math "Heidi is a statistician to the core, and she likes to study the evolution of marmot populations in each of V (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89V\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89100) villages! So it comes that every spring, when Heidi sees the first snowdrops sprout in the meadows around her barn, she impatiently dons her snowshoes and sets out to the Alps, to welcome her friends the marmots to a new season of thrilling adventures.Arriving in a village, Heidi asks each and every marmot she comes across for the number of inhabitants of that village. This year, the marmots decide to play an April Fools\' joke on Heidi. Instead of consistently providing the exact number of inhabitants P (10\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89P\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891000) of the village, they respond with a random non-negative integer k, drawn from one of two types of probability distributions:  Poisson (d\'avril) distribution: the probability of getting an answer k is  for k\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,  Uniform distribution: the probability of getting an answer k is  for k\xe2\x80\x89=\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x892P. Heidi collects exactly 250 answers per village. Every village follows either the Poisson or the uniform distribution. Heidi cannot tell marmots apart, so she may query some marmots several times, and each time the marmot will answer with a new number drawn from the village\'s distribution.Can you help Heidi to find out whether a village follows a Poisson or a uniform distribution?" 2100
802C "Heidi and Library (hard)" flows "The good times at Heidi\'s library are over. Marmots finally got their internet connections and stopped coming to the library altogether. Not only that, but the bookstore has begun charging extortionate prices for some books. Namely, whereas in the previous versions each book could be bought for 1 CHF, now the price of book i is ci CHF." 2600
802B "Heidi and Library (medium)" "data structures,greedy" "Whereas humans nowadays read fewer and fewer books on paper, book readership among marmots has surged. Heidi has expanded the library and is now serving longer request sequences." 1800
802A "Heidi and Library (easy)" greedy "Your search for Heidi is over \xe2\x80\x93 you finally found her at a library, dressed up as a human. In fact, she has spent so much time there that she now runs the place! Her job is to buy books and keep them at the library so that people can borrow and read them. There are n different books, numbered 1 through n.We will look at the library\'s operation during n consecutive days. Heidi knows in advance that on the i-th day (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) precisely one person will come to the library, request to borrow the book ai, read it in a few hours, and return the book later on the same day.Heidi desperately wants to please all her guests, so she will make sure to always have the book ai available in the library on the i-th day. During the night before the i-th day, she has the option of going to the bookstore (which operates at nights to avoid competition with the library) and buying any book for the price of 1 CHF. Of course, if she already has a book at the library, she does not need to buy it again. Initially, the library contains no books.There is a problem, though. The capacity of the library is k \xe2\x80\x93 this means that at any time, there can be at most k books at the library. If buying a new book would cause Heidi to have more than k books, she must first get rid of some book that she already has, in order to make room for the new book. If she later needs a book that she got rid of, she will need to buy that book again.You are given k and the sequence of requests for books a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. What is the minimum cost (in CHF) of buying new books to satisfy all the requests?" 1800
801B "Valued Keys" "constructive algorithms,greedy,strings" "You found a mysterious function f. The function takes two strings s1 and s2. These strings must consist only of lowercase English letters, and must be the same length.The output of the function f is another string of the same length. The i-th character of the output is equal to the minimum of the i-th character of s1 and the i-th character of s2.For example, f(""ab"", ""ba"") = ""aa"", and f(""nzwzl"", ""zizez"") = ""niwel"".You found two strings x and y of the same length and consisting of only lowercase English letters. Find any string z such that f(x,\xe2\x80\x89z)\xe2\x80\x89=\xe2\x80\x89y, or print -1 if no such string z exists." 900
801A "Vicious Keyboard" "brute force" "Tonio has a keyboard with only two letters, ""V"" and ""K"".One day, he has typed out a string s with only these two letters. He really likes it when the string ""VK"" appears, so he wishes to change at most one letter in the string (or do no changes) to maximize the number of occurrences of that string. Compute the maximum number of times ""VK"" can appear as a substring (i. e. a letter ""K"" right after a letter ""V"") in the resulting string." 1100
799G "Cut the pie" "binary search,data structures,geometry" "Arkady reached the n-th level in Township game, so Masha decided to bake a pie for him! Of course, the pie has a shape of convex n-gon, i.e. a polygon with n vertices.Arkady decided to cut the pie in two equal in area parts by cutting it by a straight line, so that he can eat one of them and give the other to Masha. There is a difficulty because Arkady has already put a knife at some point of the pie, so he now has to cut the pie by a straight line passing trough this point.Help Arkady: find a line that passes through the point Arkady has put a knife into and cuts the pie into two parts of equal area, or determine that it\'s impossible. Your program has to quickly answer many queries with the same pie, but different points in which Arkady puts a knife." 3500
799F "Beautiful fountains rows" "data structures" "Butler Ostin wants to show Arkady that rows of odd number of fountains are beautiful, while rows of even number of fountains are not.The butler wants to show Arkady n gardens. Each garden is a row of m cells, the i-th garden has one fountain in each of the cells between li and ri inclusive, and there are no more fountains in that garden. The issue is that some of the gardens contain even number of fountains, it is wrong to show them to Arkady.Ostin wants to choose two integers a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b and show only part of each of the gardens that starts at cell a and ends at cell b. Of course, only such segments suit Ostin that each garden has either zero or odd number of fountains on this segment. Also, it is necessary that at least one garden has at least one fountain on the segment from a to b.Help Ostin to find the total length of all such segments, i.e. sum up the value (b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89+\xe2\x80\x891) for each suitable pair (a,\xe2\x80\x89b)." 3500
799E "Aquarium decoration" "data structures,greedy,two pointers" "Arkady and Masha want to choose decorations for thier aquarium in Fishdom game. They have n decorations to choose from, each of them has some cost. To complete a task Arkady and Masha need to choose exactly m decorations from given, and they want to spend as little money as possible.There is one difficulty: Masha likes some a of the given decorations, Arkady likes some b of the given decorations. Some decorations may be liked by both Arkady and Masha, or not be liked by both. The friends want to choose such decorations so that each of them likes at least k decorations among the chosen. Help Masha and Arkady find the minimum sum of money they need to spend." 2500
799D "Field expansion" "brute force,dp,meet-in-the-middle" "In one of the games Arkady is fond of the game process happens on a rectangular field. In the game process Arkady can buy extensions for his field, each extension enlarges one of the field sizes in a particular number of times. Formally, there are n extensions, the i-th of them multiplies the width or the length (by Arkady\'s choice) by ai. Each extension can\'t be used more than once, the extensions can be used in any order.Now Arkady\'s field has size h\xe2\x80\x89\xc3\x97\xe2\x80\x89w. He wants to enlarge it so that it is possible to place a rectangle of size a\xe2\x80\x89\xc3\x97\xe2\x80\x89b on it (along the width or along the length, with sides parallel to the field sides). Find the minimum number of extensions needed to reach Arkady\'s goal." 2100
799C Fountains "binary search,data structures,implementation" "Arkady plays Gardenscapes a lot. Arkady wants to build two new fountains. There are n available fountains, for each fountain its beauty and cost are known. There are two types of money in the game: coins and diamonds, so each fountain cost can be either in coins or diamonds. No money changes between the types are allowed.Help Arkady to find two fountains with maximum total beauty so that he can buy both at the same time." 1800
799B "T-shirt buying" "data structures,implementation" "A new pack of n t-shirts came to a shop. Each of the t-shirts is characterized by three integers pi, ai and bi, where pi is the price of the i-th t-shirt, ai is front color of the i-th t-shirt and bi is back color of the i-th t-shirt. All values pi are distinct, and values ai and bi are integers from 1 to 3.m buyers will come to the shop. Each of them wants to buy exactly one t-shirt. For the j-th buyer we know his favorite color cj.A buyer agrees to buy a t-shirt, if at least one side (front or back) is painted in his favorite color. Among all t-shirts that have colors acceptable to this buyer he will choose the cheapest one. If there are no such t-shirts, the buyer won\'t buy anything. Assume that the buyers come one by one, and each buyer is served only after the previous one is served.You are to compute the prices each buyer will pay for t-shirts." 1400
799A "Carrot Cakes" "brute force,implementation" "In some game by Playrix it takes t minutes for an oven to bake k carrot cakes, all cakes are ready at the same moment t minutes after they started baking. Arkady needs at least n cakes to complete a task, but he currently don\'t have any. However, he has infinitely many ingredients and one oven. Moreover, Arkady can build one more similar oven to make the process faster, it would take d minutes to build the oven. While the new oven is being built, only old one can bake cakes, after the new oven is built, both ovens bake simultaneously. Arkady can\'t build more than one oven.Determine if it is reasonable to build the second oven, i.e. will it decrease the minimum time needed to get n cakes or not. If the time needed with the second oven is the same as with one oven, then it is unreasonable." 1100
798E "Mike and code of a permutation" "constructive algorithms,data structures,graphs,sortings" "Mike has discovered a new way to encode permutations. If he has a permutation P\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn], he will encode it in the following way:Denote by A\xe2\x80\x89=\xe2\x80\x89[a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an] a sequence of length n which will represent the code of the permutation. For each i from 1 to n sequentially, he will choose the smallest unmarked j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that pi\xe2\x80\x89<\xe2\x80\x89pj and will assign to ai the number j (in other words he performs ai\xe2\x80\x89=\xe2\x80\x89j) and will mark j. If there is no such j, he\'ll assign to ai the number \xe2\x80\x89-\xe2\x80\x891 (he performs ai\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891). Mike forgot his original permutation but he remembers its code. Your task is simple: find any permutation such that its code is the same as the code of Mike\'s original permutation.You may assume that there will always be at least one valid permutation." 3000
798D "Mike and distribution" "constructive algorithms,sortings" "Mike has always been thinking about the harshness of social inequality. He\'s so obsessed with it that sometimes it even affects him while solving problems. At the moment, Mike has two sequences of positive integers A\xe2\x80\x89=\xe2\x80\x89[a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an] and B\xe2\x80\x89=\xe2\x80\x89[b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn] of length n each which he uses to ask people some quite peculiar questions.To test you on how good are you at spotting inequality in life, he wants you to find an ""unfair"" subset of the original sequence. To be more precise, he wants you to select k numbers P\xe2\x80\x89=\xe2\x80\x89[p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk] such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k and elements in P are distinct. Sequence P will represent indices of elements that you\'ll select from both sequences. He calls such a subset P ""unfair"" if and only if the following conditions are satisfied: 2\xc2\xb7(ap1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89apk) is greater than the sum of all elements from sequence A, and 2\xc2\xb7(bp1\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bpk) is greater than the sum of all elements from the sequence B. Also, k should be smaller or equal to  because it will be to easy to find sequence P if he allowed you to select too many elements!Mike guarantees you that a solution will always exist given the conditions described above, so please help him satisfy his curiosity!" 2400
798C "Mike and gcd problem" "dp,greedy,number theory" "Mike has a sequence A\xe2\x80\x89=\xe2\x80\x89[a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an] of length n. He considers the sequence B\xe2\x80\x89=\xe2\x80\x89[b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn] beautiful if the gcd of all its elements is bigger than 1, i.e. . Mike wants to change his sequence in order to make it beautiful. In one move he can choose an index i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), delete numbers ai,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 and put numbers ai\xe2\x80\x89-\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 in their place instead, in this order. He wants perform as few operations as possible. Find the minimal number of operations to make sequence A beautiful if it\'s possible, or tell him that it is impossible to do so. is the biggest non-negative number d such that d divides bi for every i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n)." 1700
798B "Mike and strings" "brute force,dp,strings" "Mike has n strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn each consisting of lowercase English letters. In one move he can choose a string si, erase the first character and append it to the end of the string. For example, if he has the string ""coolmike"", in one move he can transform it into the string ""oolmikec"".Now Mike asks himself: what is minimal number of moves that he needs to do in order to make all the strings equal?" 1300
798A "Mike and palindrome" "brute force,constructive algorithms,strings" "Mike has a string s consisting of only lowercase English letters. He wants to change exactly one character from the string so that the resulting one is a palindrome. A palindrome is a string that reads the same backward as forward, for example strings ""z"", ""aaa"", ""aba"", ""abccba"" are palindromes, but strings ""codeforces"", ""reality"", ""ab"" are not." 1000
797F "Mice and Holes" "data structures,dp,greedy,sortings" "One day Masha came home and noticed n mice in the corridor of her flat. Of course, she shouted loudly, so scared mice started to run to the holes in the corridor.The corridor can be represeted as a numeric axis with n mice and m holes on it. ith mouse is at the coordinate xi, and jth hole \xe2\x80\x94 at coordinate pj. jth hole has enough room for cj mice, so not more than cj mice can enter this hole.What is the minimum sum of distances that mice have to go through so that they all can hide in the holes? If ith mouse goes to the hole j, then its distance is |xi\xe2\x80\x89-\xe2\x80\x89pj|.Print the minimum sum of distances." 2600
797E "Array Queries" "brute force,data structures,dp" "a is an array of n positive integers, all of which are not greater than n.You have to process q queries to this array. Each query is represented by two numbers p and k. Several operations are performed in each query; each operation changes p to p\xe2\x80\x89+\xe2\x80\x89ap\xe2\x80\x89+\xe2\x80\x89k. There operations are applied until p becomes greater than n. The answer to the query is the number of performed operations." 2000
797D "Broken BST" "data structures,dfs and similar" "Let T be arbitrary binary tree \xe2\x80\x94 tree, every vertex of which has no more than two children. Given tree is rooted, so there exists only one vertex which doesn\'t have a parent \xe2\x80\x94 it\'s the root of a tree. Every vertex has an integer number written on it. Following algorithm is run on every value from the tree T:  Set pointer to the root of a tree.  Return success if the value in the current vertex is equal to the number you are looking for  Go to the left child of the vertex if the value in the current vertex is greater than the number you are looking for  Go to the right child of the vertex if the value in the current vertex is less than the number you are looking for  Return fail if you try to go to the vertex that doesn\'t exist Here is the pseudo-code of the described algorithm: bool find(TreeNode t, int x) {    if (t == null)        return false;    if (t.value == x)        return true;    if (x < t.value)        return find(t.left, x);    else        return find(t.right, x);}find(root, x);The described algorithm works correctly if the tree is binary search tree (i.e. for each node the values of left subtree are less than the value in the node, the values of right subtree are greater than the value in the node). But it can return invalid result if tree is not a binary search tree.Since the given tree is not necessarily a binary search tree, not all numbers can be found this way. Your task is to calculate, how many times the search will fail being running on every value from the tree.If the tree has multiple vertices with the same values on them then you should run algorithm on every one of them separately." 2100
797C "Minimal string" "data structures,greedy,strings" "Petya recieved a gift of a string s with length up to 105 characters for his birthday. He took two more empty strings t and u and decided to play a game. This game has two possible moves:  Extract the first character of s and append t with this character.  Extract the last character of t and append u with this character. Petya wants to get strings s and t empty and string u lexicographically minimal.You should write a program that will help Petya win the game." 1700
797B "Odd sum" dp,greedy,implementation "You are given sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of integer numbers of length n. Your task is to find such subsequence that its sum is odd and maximum among all such subsequences. It\'s guaranteed that given sequence contains subsequence with odd sum.Subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.You should write a program which finds sum of the best subsequence." 1400
797A k-Factorization "implementation,math,number theory" "Given a positive integer n, find k integers (not necessary distinct) such that all these integers are strictly greater than 1, and their product is equal to n." 1100
796F "Sequence Recovery" "bitmasks,data structures,greedy" "Zane once had a good sequence a consisting of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an \xe2\x80\x94 but he has lost it.A sequence is said to be good if and only if all of its integers are non-negative and do not exceed 109 in value.  However, Zane remembers having played around with his sequence by applying m operations to it.There are two types of operations:1. Find the maximum value of integers with indices i such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r, given l and r.2. Assign d as the value of the integer with index k, given k and d.After he finished playing, he restored his sequence to the state it was before any operations were applied. That is, sequence a was no longer affected by the applied type 2 operations. Then, he lost his sequence at some time between now and then.Fortunately, Zane remembers all the operations and the order he applied them to his sequence, along with the distinct results of all type 1 operations. Moreover, among all good sequences that would produce the same results when the same operations are applied in the same order, he knows that his sequence a has the greatest cuteness.We define cuteness of a sequence as the bitwise OR result of all integers in such sequence. For example, the cuteness of Zane\'s sequence a is a1 OR a2 OR ... OR an.Zane understands that it might not be possible to recover exactly the lost sequence given his information, so he would be happy to get any good sequence b consisting of n integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn that:1. would give the same results when the same operations are applied in the same order, and2. has the same cuteness as that of Zane\'s original sequence a.If there is such a sequence, find it. Otherwise, it means that Zane must have remembered something incorrectly, which is possible." 2800
796E "Exam Cheating" "binary search,dp" "Zane and Zane\'s crush have just decided to date! However, the girl is having a problem with her Physics final exam, and needs your help.There are n questions, numbered from 1 to n. Question i comes before question i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n). Each of the questions cannot be guessed on, due to the huge penalty for wrong answers. The girl luckily sits in the middle of two geniuses, so she is going to cheat.  However, the geniuses have limitations. Each of them may or may not know the answers to some questions. Anyway, it is safe to assume that the answers on their answer sheets are absolutely correct.To make sure she will not get caught by the proctor, the girl will glance at most p times, each time looking at no more than k consecutive questions on one of the two geniuses\' answer sheet. When the girl looks at some question on an answer sheet, she copies the answer to that question if it is on that answer sheet, or does nothing otherwise.Help the girl find the maximum number of questions she can get correct." 2400
796D "Police Stations" "constructive algorithms,dfs and similar,dp,graphs,shortest paths,trees" "Inzane finally found Zane with a lot of money to spare, so they together decided to establish a country of their own.Ruling a country is not an easy job. Thieves and terrorists are always ready to ruin the country\'s peace. To fight back, Zane and Inzane have enacted a very effective law: from each city it must be possible to reach a police station by traveling at most d kilometers along the roads.  There are n cities in the country, numbered from 1 to n, connected only by exactly n\xe2\x80\x89-\xe2\x80\x891 roads. All roads are 1 kilometer long. It is initially possible to travel from a city to any other city using these roads. The country also has k police stations located in some cities. In particular, the city\'s structure satisfies the requirement enforced by the previously mentioned law. Also note that there can be multiple police stations in one city.However, Zane feels like having as many as n\xe2\x80\x89-\xe2\x80\x891 roads is unnecessary. The country is having financial issues, so it wants to minimize the road maintenance cost by shutting down as many roads as possible.Help Zane find the maximum number of roads that can be shut down without breaking the law. Also, help him determine such roads." 2100
796C "Bank Hacking" "constructive algorithms,data structures,dp,trees" "Although Inzane successfully found his beloved bone, Zane, his owner, has yet to return. To search for Zane, he would need a lot of money, of which he sadly has none. To deal with the problem, he has decided to hack the banks.  There are n banks, numbered from 1 to n. There are also n\xe2\x80\x89-\xe2\x80\x891 wires connecting the banks. All banks are initially online. Each bank also has its initial strength: bank i has initial strength ai.Let us define some keywords before we proceed. Bank i and bank j are neighboring if and only if there exists a wire directly connecting them. Bank i and bank j are semi-neighboring if and only if there exists an online bank k such that bank i and bank k are neighboring and bank k and bank j are neighboring.When a bank is hacked, it becomes offline (and no longer online), and other banks that are neighboring or semi-neighboring to it have their strengths increased by 1.To start his plan, Inzane will choose a bank to hack first. Indeed, the strength of such bank must not exceed the strength of his computer. After this, he will repeatedly choose some bank to hack next until all the banks are hacked, but he can continue to hack bank x if and only if all these conditions are met:  Bank x is online. That is, bank x is not hacked yet.  Bank x is neighboring to some offline bank.  The strength of bank x is less than or equal to the strength of Inzane\'s computer. Determine the minimum strength of the computer Inzane needs to hack all the banks." 1900
796B "Find The Bone" implementation "Zane the wizard is going to perform a magic show shuffling the cups.There are n cups, numbered from 1 to n, placed along the x-axis on a table that has m holes on it. More precisely, cup i is on the table at the position x\xe2\x80\x89=\xe2\x80\x89i.The problematic bone is initially at the position x\xe2\x80\x89=\xe2\x80\x891. Zane will confuse the audience by swapping the cups k times, the i-th time of which involves the cups at the positions x\xe2\x80\x89=\xe2\x80\x89ui and x\xe2\x80\x89=\xe2\x80\x89vi. If the bone happens to be at the position where there is a hole at any time, it will fall into the hole onto the ground and will not be affected by future swapping operations.Do not forget that Zane is a wizard. When he swaps the cups, he does not move them ordinarily. Instead, he teleports the cups (along with the bone, if it is inside) to the intended positions. Therefore, for example, when he swaps the cup at x\xe2\x80\x89=\xe2\x80\x894 and the one at x\xe2\x80\x89=\xe2\x80\x896, they will not be at the position x\xe2\x80\x89=\xe2\x80\x895 at any moment during the operation.  Zane\xe2\x80\x99s puppy, Inzane, is in trouble. Zane is away on his vacation, and Inzane cannot find his beloved bone, as it would be too exhausting to try opening all the cups. Inzane knows that the Codeforces community has successfully helped Zane, so he wants to see if it could help him solve his problem too. Help Inzane determine the final position of the bone." 1300
796A "Buying A House" "brute force,implementation" "Zane the wizard had never loved anyone before, until he fell in love with a girl, whose name remains unknown to us.  The girl lives in house m of a village. There are n houses in that village, lining in a straight line from left to right: house 1, house 2, ..., house n. The village is also well-structured: house i and house i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n) are exactly 10 meters away. In this village, some houses are occupied, and some are not. Indeed, unoccupied houses can be purchased.You will be given n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an that denote the availability and the prices of the houses. If house i is occupied, and therefore cannot be bought, then ai equals 0. Otherwise, house i can be bought, and ai represents the money required to buy it, in dollars.As Zane has only k dollars to spare, it becomes a challenge for him to choose the house to purchase, so that he could live as near as possible to his crush. Help Zane determine the minimum distance from his crush\'s house to some house he can afford, to help him succeed in his love." 800
794G "Replace All" combinatorics,dp,math "Igor the analyst is at work. He learned about a feature in his text editor called ""Replace All"". Igor is too bored at work and thus he came up with the following problem:Given two strings x and y which consist of the English letters \'A\' and \'B\' only, a pair of strings (s,\xe2\x80\x89t) is called good if: s and t consist of the characters \'0\' and \'1\' only. 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|,\xe2\x80\x89|t|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, where |z| denotes the length of string z, and n is a fixed positive integer. If we replace all occurrences of \'A\' in x and y with the string s, and replace all occurrences of \'B\' in x and y with the string t, then the two obtained from x and y strings are equal. For example, if x\xe2\x80\x89=\xe2\x80\x89AAB, y\xe2\x80\x89=\xe2\x80\x89BB and n\xe2\x80\x89=\xe2\x80\x894, then (01, 0101) is one of good pairs of strings, because both obtained after replacing strings are ""01010101"".The flexibility of a pair of strings x and y is the number of pairs of good strings (s,\xe2\x80\x89t). The pairs are ordered, for example the pairs (0, 1) and (1, 0) are different.You\'re given two strings c and d. They consist of characters \'A\', \'B\' and \'?\' only. Find the sum of flexibilities of all possible pairs of strings (c\',\xe2\x80\x89d\') such that c\' and d\' can be obtained from c and d respectively by replacing the question marks with either \'A\' or \'B\', modulo 109\xe2\x80\x89+\xe2\x80\x897." 3400
794F "Leha and security system" "data structures" "Bankopolis, the city you already know, finally got a new bank opened! Unfortunately, its security system is not yet working fine... Meanwhile hacker Leha arrived in Bankopolis and decided to test the system!Bank has n cells for clients\' money. A sequence from n numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an describes the amount of money each client has. Leha wants to make requests to the database of the bank, finding out the total amount of money on some subsegments of the sequence and changing values of the sequence on some subsegments. Using a bug in the system, Leha can requests two types of queries to the database:  1 l r x y denoting that Leha changes each digit x to digit y in each element of sequence ai, for which l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r is holds. For example, if we change in number 11984381 digit 8 to 4, we get 11944341. It\'s worth noting that Leha, in order to stay in the shadow, never changes digits in the database to 0, i.e. y\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890.  2 l r denoting that Leha asks to calculate and print the sum of such elements of sequence ai, for which l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r holds. As Leha is a white-hat hacker, he don\'t want to test this vulnerability on a real database. You are to write a similar database for Leha to test." 2800
794E "Choosing Carrot" games,math "Oleg the bank client and Igor the analyst are arguing again. This time, they want to pick a gift as a present for their friend, ZS the coder. After a long thought, they decided that their friend loves to eat carrots the most and thus they want to pick the best carrot as their present.There are n carrots arranged in a line. The i-th carrot from the left has juiciness ai. Oleg thinks ZS loves juicy carrots whereas Igor thinks that he hates juicy carrots. Thus, Oleg would like to maximize the juiciness of the carrot they choose while Igor would like to minimize the juiciness of the carrot they choose.To settle this issue, they decided to play a game again. Oleg and Igor take turns to play the game. In each turn, a player can choose a carrot from either end of the line, and eat it. The game ends when only one carrot remains. Oleg moves first. The last remaining carrot will be the carrot that they will give their friend, ZS.Oleg is a sneaky bank client. When Igor goes to a restroom, he performs k moves before the start of the game. Each move is the same as above (eat a carrot from either end of the line). After Igor returns, they start the game with Oleg still going first. Oleg wonders: for each k such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891, what is the juiciness of the carrot they will give to ZS if he makes k extra moves beforehand and both players play optimally?" 2800
794D "Labelling Cities" "dfs and similar,graphs,hashing" "Oleg the bank client lives in Bankopolia. There are n cities in Bankopolia and some pair of cities are connected directly by bi-directional roads. The cities are numbered from 1 to n. There are a total of m roads in Bankopolia, the i-th road connects cities ui and vi. It is guaranteed that from each city it is possible to travel to any other city using some of the roads.Oleg wants to give a label to each city. Suppose the label of city i is equal to xi. Then, it must hold that for all pairs of cities (u,\xe2\x80\x89v) the condition |xu\xe2\x80\x89-\xe2\x80\x89xv|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 holds if and only if there is a road connecting u and v.Oleg wonders if such a labeling is possible. Find an example of such labeling if the task is possible and state that it is impossible otherwise." 2400
794C "Naming Company" games,greedy,sortings "Oleg the client and Igor the analyst are good friends. However, sometimes they argue over little things. Recently, they started a new company, but they are having trouble finding a name for the company.To settle this problem, they\'ve decided to play a game. The company name will consist of n letters. Oleg and Igor each have a set of n letters (which might contain multiple copies of the same letter, the sets can be different). Initially, the company name is denoted by n question marks. Oleg and Igor takes turns to play the game, Oleg moves first. In each turn, a player can choose one of the letters c in his set and replace any of the question marks with c. Then, a copy of the letter c is removed from his set. The game ends when all the question marks has been replaced by some letter.For example, suppose Oleg has the set of letters {i,\xe2\x80\x89o,\xe2\x80\x89i} and Igor has the set of letters {i,\xe2\x80\x89m,\xe2\x80\x89o}. One possible game is as follows :Initially, the company name is ???.Oleg replaces the second question mark with \'i\'. The company name becomes ?i?. The set of letters Oleg have now is {i,\xe2\x80\x89o}.Igor replaces the third question mark with \'o\'. The company name becomes ?io. The set of letters Igor have now is {i,\xe2\x80\x89m}.Finally, Oleg replaces the first question mark with \'o\'. The company name becomes oio. The set of letters Oleg have now is {i}.In the end, the company name is oio.Oleg wants the company name to be as lexicographically small as possible while Igor wants the company name to be as lexicographically large as possible. What will be the company name if Oleg and Igor always play optimally?A string s\xe2\x80\x89=\xe2\x80\x89s1s2...sm is called lexicographically smaller than a string t\xe2\x80\x89=\xe2\x80\x89t1t2...tm (where s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t) if si\xe2\x80\x89<\xe2\x80\x89ti where i is the smallest index such that si\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ti. (so sj\xe2\x80\x89=\xe2\x80\x89tj for all j\xe2\x80\x89<\xe2\x80\x89i)" 1800
794B "Cutting Carrot" geometry,math "Igor the analyst has adopted n little bunnies. As we all know, bunnies love carrots. Thus, Igor has bought a carrot to be shared between his bunnies. Igor wants to treat all the bunnies equally, and thus he wants to cut the carrot into n pieces of equal area. Formally, the carrot can be viewed as an isosceles triangle with base length equal to 1 and height equal to h. Igor wants to make n\xe2\x80\x89-\xe2\x80\x891 cuts parallel to the base to cut the carrot into n pieces. He wants to make sure that all n pieces have the same area. Can you help Igor determine where to cut the carrot so that each piece have equal area?  Illustration to the first example." 1200
794A "Bank Robbery" "brute force,implementation" "A robber has attempted to rob a bank but failed to complete his task. However, he had managed to open all the safes.Oleg the bank client loves money (who doesn\'t), and decides to take advantage of this failed robbery and steal some money from the safes. There are many safes arranged in a line, where the i-th safe from the left is called safe i. There are n banknotes left in all the safes in total. The i-th banknote is in safe xi. Oleg is now at safe a. There are two security guards, one of which guards the safe b such that b\xe2\x80\x89<\xe2\x80\x89a, i.e. the first guard is to the left of Oleg. The other guard guards the safe c so that c\xe2\x80\x89>\xe2\x80\x89a, i.e. he is to the right of Oleg.The two guards are very lazy, so they do not move. In every second, Oleg can either take all the banknotes from the current safe or move to any of the neighboring safes. However, he cannot visit any safe that is guarded by security guards at any time, becaues he might be charged for stealing. Determine the maximum amount of banknotes Oleg can gather." 800
793G "Oleg and chess" "data structures,divide and conquer,flows,graph matchings" "Oleg the bank client solves an interesting chess problem: place on n\xe2\x80\x89\xc3\x97\xe2\x80\x89n chessboard the maximum number of rooks so that they don\'t beat each other. Of course, no two rooks can share the same cell.Remind that a rook standing in the cell (a,\xe2\x80\x89b) beats a rook standing in the cell (x,\xe2\x80\x89y) if and only if a\xe2\x80\x89=\xe2\x80\x89x or b\xe2\x80\x89=\xe2\x80\x89y.Unfortunately (of fortunately?) for Oleg the answer in this problem was always n, so the task bored Oleg soon. He decided to make it more difficult by removing some cells from the board. If a cell is deleted, Oleg can\'t put a rook there, but rooks do beat each other ""through"" deleted cells.Oleg deletes the cells in groups, namely, he repeatedly choose a rectangle with sides parallel to the board sides and deletes all the cells inside the rectangle. Formally, if he chooses a rectangle, lower left cell of which has coordinates (x1,\xe2\x80\x89y1), and upper right cell of which has coordinates (x2,\xe2\x80\x89y2), then he deletes all such cells with coordinates (x,\xe2\x80\x89y) that x1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x2 and y1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y2. It is guaranteed that no cell is deleted twice, i.e. the chosen rectangles do not intersect.This version of the problem Oleg can\'t solve, and his friend Igor is busy at a conference, so he can\'t help Oleg.You are the last hope for Oleg! Help him: given the size of the board and the deleted rectangles find the maximum possible number of rooks that could be placed on the board so that no two rooks beat each other." 3400
793F "Julia the snail" "data structures,divide and conquer,dp" "After hard work Igor decided to have some rest.He decided to have a snail. He bought an aquarium with a slippery tree trunk in the center, and put a snail named Julia into the aquarium.Igor noticed that sometimes Julia wants to climb onto the trunk, but can\'t do it because the trunk is too slippery. To help the snail Igor put some ropes on the tree, fixing the lower end of the i-th rope on the trunk on the height li above the ground, and the higher end on the height ri above the ground.For some reason no two ropes share the same position of the higher end, i.e. all ri are distinct. Now Julia can move down at any place of the trunk, and also move up from the lower end of some rope to its higher end. Igor is proud of his work, and sometimes think about possible movements of the snail. Namely, he is interested in the following questions: \xc2\xabSuppose the snail is on the trunk at height x now. What is the highest position on the trunk the snail can get on if it would never be lower than x or higher than y?\xc2\xbb Please note that Julia can\'t move from a rope to the trunk before it reaches the higher end of the rope, and Igor is interested in the highest position on the tree trunk.Igor is interested in many questions, and not always can answer them. Help him, write a program that answers these questions." 3000
793E "Problem of offices" "constructive algorithms,dfs and similar,dp,trees" "Earlier, when there was no Internet, each bank had a lot of offices all around Bankopolis, and it caused a lot of problems. Namely, each day the bank had to collect cash from all the offices.Once Oleg the bank client heard a dialogue of two cash collectors. Each day they traveled through all the departments and offices of the bank following the same route every day. The collectors started from the central department and moved between some departments or between some department and some office using special roads. Finally, they returned to the central department. The total number of departments and offices was n, the total number of roads was n\xe2\x80\x89-\xe2\x80\x891. In other words, the special roads system was a rooted tree in which the root was the central department, the leaves were offices, the internal vertices were departments. The collectors always followed the same route in which the number of roads was minimum possible, that is 2n\xe2\x80\x89-\xe2\x80\x892.One of the collectors said that the number of offices they visited between their visits to offices a and then b (in the given order) is equal to the number of offices they visited between their visits to offices b and then a (in this order). The other collector said that the number of offices they visited between their visits to offices c and then d (in this order) is equal to the number of offices they visited between their visits to offices d and then c (in this order). The interesting part in this talk was that the shortest path (using special roads only) between any pair of offices among a, b, c and d passed through the central department.Given the special roads map and the indexes of offices a, b, c and d, determine if the situation described by the collectors was possible, or not." 2900
793D "Presents in Bankopolis" "dp,graphs,shortest paths" "Bankopolis is an incredible city in which all the n crossroads are located on a straight line and numbered from 1 to n along it. On each crossroad there is a bank office.The crossroads are connected with m oriented bicycle lanes (the i-th lane goes from crossroad ui to crossroad vi), the difficulty of each of the lanes is known.Oleg the bank client wants to gift happiness and joy to the bank employees. He wants to visit exactly k offices, in each of them he wants to gift presents to the employees.The problem is that Oleg don\'t want to see the reaction on his gifts, so he can\'t use a bicycle lane which passes near the office in which he has already presented his gifts (formally, the i-th lane passes near the office on the x-th crossroad if and only if min(ui,\xe2\x80\x89vi)\xe2\x80\x89<\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89max(ui,\xe2\x80\x89vi))). Of course, in each of the offices Oleg can present gifts exactly once. Oleg is going to use exactly k\xe2\x80\x89-\xe2\x80\x891 bicycle lane to move between offices. Oleg can start his path from any office and finish it in any office.Oleg wants to choose such a path among possible ones that the total difficulty of the lanes he will use is minimum possible. Find this minimum possible total difficulty." 2100
793C "Mice problem" geometry,implementation,math,sortings "Igor the analyst fell asleep on the work and had a strange dream. In the dream his desk was crowded with computer mice, so he bought a mousetrap to catch them.The desk can be considered as an infinite plane, then the mousetrap is a rectangle which sides are parallel to the axes, and which opposite sides are located in points (x1,\xe2\x80\x89y1) and (x2,\xe2\x80\x89y2).Igor wants to catch all mice. Igor has analysed their behavior and discovered that each mouse is moving along a straight line with constant speed, the speed of the i-th mouse is equal to (vix,\xe2\x80\x89viy), that means that the x coordinate of the mouse increases by vix units per second, while the y coordinates increases by viy units. The mousetrap is open initially so that the mice are able to move freely on the desk. Igor can close the mousetrap at any moment catching all the mice that are strictly inside the mousetrap.Igor works a lot, so he is busy in the dream as well, and he asks you to write a program that by given mousetrap\'s coordinates, the initial coordinates of the mice and their speeds determines the earliest time moment in which he is able to catch all the mice. Please note that Igor can close the mousetrap only once." 2300
793B "Igor and his way to work" "dfs and similar,graphs,implementation,shortest paths" "Woken up by the alarm clock Igor the financial analyst hurried up to the work. He ate his breakfast and sat in his car. Sadly, when he opened his GPS navigator, he found that some of the roads in Bankopolis, the city where he lives, are closed due to road works. Moreover, Igor has some problems with the steering wheel, so he can make no more than two turns on his way to his office in bank.Bankopolis looks like a grid of n rows and m columns. Igor should find a way from his home to the bank that has no more than two turns and doesn\'t contain cells with road works, or determine that it is impossible and he should work from home. A turn is a change in movement direction. Igor\'s car can only move to the left, to the right, upwards and downwards. Initially Igor can choose any direction. Igor is still sleepy, so you should help him." 1600
793A "Oleg and shares" implementation,math "Oleg the bank client checks share prices every day. There are n share prices he is interested in. Today he observed that each second exactly one of these prices decreases by k rubles (note that each second exactly one price changes, but at different seconds different prices can change). Prices can become negative. Oleg found this process interesting, and he asked Igor the financial analyst, what is the minimum time needed for all n prices to become equal, or it is impossible at all? Igor is busy right now, so he asked you to help Oleg. Can you answer this question?" 900
792F "Mages and Monsters" "data structures,geometry" "Vova plays a computer game known as Mages and Monsters. Vova\'s character is a mage. Though as he has just started, his character knows no spells.Vova\'s character can learn new spells during the game. Every spell is characterized by two values xi and yi \xe2\x80\x94 damage per second and mana cost per second, respectively. Vova doesn\'t have to use a spell for an integer amount of seconds. More formally, if he uses a spell with damage x and mana cost y for z seconds, then he will deal x\xc2\xb7z damage and spend y\xc2\xb7z mana (no rounding). If there is no mana left (mana amount is set in the start of the game and it remains the same at the beginning of every fight), then character won\'t be able to use any spells. It is prohibited to use multiple spells simultaneously.Also Vova can fight monsters. Every monster is characterized by two values tj and hj \xe2\x80\x94 monster kills Vova\'s character in tj seconds and has hj health points. Mana refills after every fight (or Vova\'s character revives with full mana reserve), so previous fights have no influence on further ones.Vova\'s character kills a monster, if he deals hj damage to it in no more than tj seconds using his spells (it is allowed to use more than one spell in a fight) and spending no more mana than he had at the beginning of the fight. If monster\'s health becomes zero exactly in tj seconds (it means that the monster and Vova\'s character kill each other at the same time), then Vova wins the fight.You have to write a program which can answer two types of queries:  1 x y \xe2\x80\x94 Vova\'s character learns new spell which deals x damage per second and costs y mana per second.  2 t h \xe2\x80\x94 Vova fights the monster which kills his character in t seconds and has h health points. Note that queries are given in a different form. Also remember that Vova\'s character knows no spells at the beginning of the game.For every query of second type you have to determine if Vova is able to win the fight with corresponding monster." 3100
792E "Colored Balls" "greedy,math,number theory" "There are n boxes with colored balls on the table. Colors are numbered from 1 to n. i-th box contains ai balls, all of which have color i. You have to write a program that will divide all balls into sets such that:  each ball belongs to exactly one of the sets,  there are no empty sets,  there is no set containing two (or more) balls of different colors (each set contains only balls of one color),  there are no two sets such that the difference between their sizes is greater than 1. Print the minimum possible number of sets." 2500
792D "Paths in a Complete Binary Tree" bitmasks,trees "T is a complete binary tree consisting of n vertices. It means that exactly one vertex is a root, and each vertex is either a leaf (and doesn\'t have children) or an inner node (and has exactly two children). All leaves of a complete binary tree have the same depth (distance from the root). So n is a number such that n\xe2\x80\x89+\xe2\x80\x891 is a power of 2.In the picture you can see a complete binary tree with n\xe2\x80\x89=\xe2\x80\x8915.  Vertices are numbered from 1 to n in a special recursive way: we recursively assign numbers to all vertices from the left subtree (if current vertex is not a leaf), then assign a number to the current vertex, and then recursively assign numbers to all vertices from the right subtree (if it exists). In the picture vertices are numbered exactly using this algorithm. It is clear that for each size of a complete binary tree exists exactly one way to give numbers to all vertices. This way of numbering is called symmetric.You have to write a program that for given n answers q queries to the tree.Each query consists of an integer number ui (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ui\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and a string si, where ui is the number of vertex, and si represents the path starting from this vertex. String si doesn\'t contain any characters other than \'L\', \'R\' and \'U\', which mean traverse to the left child, to the right child and to the parent, respectively. Characters from si have to be processed from left to right, considering that ui is the vertex where the path starts. If it\'s impossible to process a character (for example, to go to the left child of a leaf), then you have to skip it. The answer is the number of vertex where the path represented by si ends.For example, if ui\xe2\x80\x89=\xe2\x80\x894 and si\xe2\x80\x89=\xe2\x80\x89\xc2\xabUURL\xc2\xbb, then the answer is 10." 1900
792C "Divide by Three" "dp,greedy,math,number theory" "A positive integer number n is written on a blackboard. It consists of not more than 105 digits. You have to transform it into a beautiful number by erasing some of the digits, and you want to erase as few digits as possible.The number is called beautiful if it consists of at least one digit, doesn\'t have leading zeroes and is a multiple of 3. For example, 0, 99, 10110 are beautiful numbers, and 00, 03, 122 are not.Write a program which for the given n will find a beautiful number such that n can be transformed into this number by erasing as few digits as possible. You can erase an arbitraty set of digits. For example, they don\'t have to go one after another in the number n.If it\'s impossible to obtain a beautiful number, print -1. If there are multiple answers, print any of them." 2000
792B "Counting-out Rhyme" implementation "n children are standing in a circle and playing the counting-out game. Children are numbered clockwise from 1 to n. In the beginning, the first child is considered the leader. The game is played in k steps. In the i-th step the leader counts out ai people in clockwise order, starting from the next person. The last one to be pointed at by the leader is eliminated, and the next player after him becomes the new leader.For example, if there are children with numbers [8,\xe2\x80\x8910,\xe2\x80\x8913,\xe2\x80\x8914,\xe2\x80\x8916] currently in the circle, the leader is child 13 and ai\xe2\x80\x89=\xe2\x80\x8912, then counting-out rhyme ends on child 16, who is eliminated. Child 8 becomes the leader.You have to write a program which prints the number of the child to be eliminated on every step." 1300
792A "New Bus Route" implementation,sortings "There are n cities situated along the main road of Berland. Cities are represented by their coordinates \xe2\x80\x94 integer numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. All coordinates are pairwise distinct.It is possible to get from one city to another only by bus. But all buses and roads are very old, so the Minister of Transport decided to build a new bus route. The Minister doesn\'t want to spend large amounts of money \xe2\x80\x94 he wants to choose two cities in such a way that the distance between them is minimal possible. The distance between two cities is equal to the absolute value of the difference between their coordinates.It is possible that there are multiple pairs of cities with minimal possible distance, so the Minister wants to know the quantity of such pairs. Your task is to write a program that will calculate the minimal possible distance between two pairs of cities and the quantity of pairs which have this distance." 1100
791A "Bear and Big Brother" implementation "Bear Limak wants to become the largest of bears, or at least to become larger than his brother Bob.Right now, Limak and Bob weigh a and b respectively. It\'s guaranteed that Limak\'s weight is smaller than or equal to his brother\'s weight.Limak eats a lot and his weight is tripled after every year, while Bob\'s weight is doubled after every year.After how many full years will Limak become strictly larger (strictly heavier) than Bob?" 800
789B "Masha and geometric depression" "brute force,implementation,math" "Masha really loves algebra. On the last lesson, her strict teacher Dvastan gave she new exercise.You are given geometric progression b defined by two integers b1 and q. Remind that a geometric progression is a sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89b3,\xe2\x80\x89..., where for each i\xe2\x80\x89>\xe2\x80\x891 the respective term satisfies the condition bi\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x891\xc2\xb7q, where q is called the common ratio of the progression. Progressions in Uzhlyandia are unusual: both b1 and q can equal 0. Also, Dvastan gave Masha m ""bad"" integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89am, and an integer l.Masha writes all progression terms one by one onto the board (including repetitive) while condition |bi|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l is satisfied (|x| means absolute value of x). There is an exception: if a term equals one of the ""bad"" integers, Masha skips it (doesn\'t write onto the board) and moves forward to the next term.But the lesson is going to end soon, so Masha has to calculate how many integers will be written on the board. In order not to get into depression, Masha asked you for help: help her calculate how many numbers she will write, or print ""inf"" in case she needs to write infinitely many integers." 1700
789A "Anastasia and pebbles" implementation,math "Anastasia loves going for a walk in Central Uzhlyandian Park. But she became uninterested in simple walking, so she began to collect Uzhlyandian pebbles. At first, she decided to collect all the pebbles she could find in the park.She has only two pockets. She can put at most k pebbles in each pocket at the same time. There are n different pebble types in the park, and there are wi pebbles of the i-th type. Anastasia is very responsible, so she never mixes pebbles of different types in same pocket. However, she can put different kinds of pebbles in different pockets at the same time. Unfortunately, she can\'t spend all her time collecting pebbles, so she can collect pebbles from the park only once a day.Help her to find the minimum number of days needed to collect all the pebbles of Uzhlyandian Central Park, taking into consideration that Anastasia can\'t place pebbles of different types in same pocket." 1100
788E "New task" "data structures" "On the 228-th international Uzhlyandian Wars strategic game tournament teams from each country are called. The teams should consist of 5 participants.The team of Uzhlyandia will consist of soldiers, because there are no gamers.Masha is a new minister of defense and gaming. The prime duty of the minister is to calculate the efficiency of the Uzhlandian army. The army consists of n soldiers standing in a row, enumerated from 1 to n. For each soldier we know his skill in Uzhlyandian Wars: the i-th soldier\'s skill is ai.It was decided that the team will consist of three players and two assistants. The skills of players should be same, and the assistants\' skills should not be greater than the players\' skill. Moreover, it is important for Masha that one of the assistants should stand in the row to the left of the players, and the other one should stand in the row to the right of the players. Formally, a team is five soldiers with indexes i, j, k, l, p, such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89p\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89aj\xe2\x80\x89=\xe2\x80\x89ak\xe2\x80\x89=\xe2\x80\x89al\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89ap. The efficiency of the army is the number of different teams Masha can choose. Two teams are considered different if there is such i such that the i-th soldier is a member of one team, but not a member of the other team.Initially, all players are able to be players. For some reasons, sometimes some soldiers become unable to be players. Sometimes some soldiers, that were unable to be players, become able to be players. At any time any soldier is able to be an assistant. Masha wants to control the efficiency of the army, so she asked you to tell her the number of different possible teams modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897) after each change." 2900
788D "Finding lines" "constructive algorithms,divide and conquer,interactive" "After some programming contest Roma decided to try himself in tourism. His home country Uzhlyandia is a Cartesian plane. He wants to walk along each of the Main Straight Lines in Uzhlyandia. It is known that each of these lines is a straight line parallel to one of the axes (i.e. it is described with the equation x\xe2\x80\x89=\xe2\x80\x89a or y\xe2\x80\x89=\xe2\x80\x89a, where a is integer called the coordinate of this line).Roma lost his own map, so he should find out the coordinates of all lines at first. Uncle Anton agreed to help him, using the following rules:   Initially Roma doesn\'t know the number of vertical and horizontal lines and their coordinates;  Roma can announce integer coordinates of some point in Uzhlandia, and Anton then will tell him the minimum among the distances from the chosen point to each of the lines. However, since the coordinates of the lines don\'t exceed 108 by absolute value, Roma can\'t choose a point with coordinates exceeding 108 by absolute value. Uncle Anton is in a hurry to the UOI (Uzhlandian Olympiad in Informatics), so he can only answer no more than 3\xc2\xb7105 questions.The problem is that Roma doesn\'t know how to find out the coordinates of the lines. Write a program that plays Roma\'s role and finds the coordinates." 3000
788C "The Great Mixing" "dfs and similar,graphs,shortest paths" "Sasha and Kolya decided to get drunk with Coke, again. This time they have k types of Coke. i-th type is characterised by its carbon dioxide concentration . Today, on the party in honour of Sergiy of Vancouver they decided to prepare a glass of Coke with carbon dioxide concentration . The drink should also be tasty, so the glass can contain only integer number of liters of each Coke type (some types can be not presented in the glass). Also, they want to minimize the total volume of Coke in the glass.Carbon dioxide concentration is defined as the volume of carbone dioxide in the Coke divided by the total volume of Coke. When you mix two Cokes, the volume of carbon dioxide sums up, and the total volume of Coke sums up as well.Help them, find the minimal natural number of liters needed to create a glass with carbon dioxide concentration . Assume that the friends have unlimited amount of each Coke type." 2300
788B "Weird journey" "combinatorics,constructive algorithms,dfs and similar,dsu,graphs" "Little boy Igor wants to become a traveller. At first, he decided to visit all the cities of his motherland \xe2\x80\x94 Uzhlyandia.It is widely known that Uzhlyandia has n cities connected with m bidirectional roads. Also, there are no two roads in the country that connect the same pair of cities, but roads starting and ending in the same city can exist. Igor wants to plan his journey beforehand. Boy thinks a path is good if the path goes over m\xe2\x80\x89-\xe2\x80\x892 roads twice, and over the other 2 exactly once. The good path can start and finish in any city of Uzhlyandia.Now he wants to know how many different good paths are in Uzhlyandia. Two paths are considered different if the sets of roads the paths goes over exactly once differ. Help Igor \xe2\x80\x94 calculate the number of good paths." 2100
788A "Functions again" "dp,two pointers" "Something happened in Uzhlyandia again... There are riots on the streets... Famous Uzhlyandian superheroes Shean the Sheep and Stas the Giraffe were called in order to save the situation. Upon the arriving, they found that citizens are worried about maximum values of the Main Uzhlyandian Function f, which is defined as follows:In the above formula, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n must hold, where n is the size of the Main Uzhlyandian Array a, and |x| means absolute value of x. But the heroes skipped their math lessons in school, so they asked you for help. Help them calculate the maximum value of f among all possible values of l and r for the given array a." 1600
787B "Not Afraid" greedy,implementation,math "Since the giant heads have appeared in the sky all humanity is in danger, so all Ricks and Mortys from all parallel universes are gathering in groups to find a solution to get rid of them. There are n parallel universes participating in this event (n Ricks and n Mortys). I. e. each of n universes has one Rick and one Morty. They\'re gathering in m groups. Each person can be in many groups and a group can contain an arbitrary number of members.Ricks and Mortys have registered online in these groups. So, a person can have joined a group more than once (developer of this website hadn\'t considered this possibility).  Summer from universe #1 knows that in each parallel universe (including hers) exactly one of Rick and Morty from that universe is a traitor and is loyal, but no one knows which one. She knows that we are doomed if there\'s a group such that every member in that group is a traitor (they will plan and destroy the world). Summer knows that if there\'s a possibility that world ends (there\'s a group where all members are traitors) she should immediately cancel this event. So she wants to know if she should cancel the event. You have to tell her yes if and only if there\'s at least one scenario (among all 2n possible scenarios, 2 possible scenarios for who a traitor in each universe) such that in that scenario the world will end." 1300
787A "The Monster" "brute force,math,number theory" "A monster is chasing after Rick and Morty on another planet. They\'re so frightened that sometimes they scream. More accurately, Rick screams at times b,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x89a,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x892a,\xe2\x80\x89b\xe2\x80\x89+\xe2\x80\x893a,\xe2\x80\x89... and Morty screams at times d,\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x89c,\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x892c,\xe2\x80\x89d\xe2\x80\x89+\xe2\x80\x893c,\xe2\x80\x89....   The Monster will catch them if at any point they scream at the same time, so it wants to know when it will catch them (the first time they scream at the same time) or that they will never scream at the same time." 1200
786E ALT "data structures,flows,graphs,trees" "ALT is a planet in a galaxy called ""Encore"". Humans rule this planet but for some reason there\'s no dog in their planet, so the people there are sad and depressed. Rick and Morty are universal philanthropists and they want to make people in ALT happy. ALT has n cities numbered from 1 to n and n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads numbered from 1 to n\xe2\x80\x89-\xe2\x80\x891. One can go from any city to any other city using these roads.There are two types of people in ALT:  Guardians. A guardian lives in a house alongside a road and guards the road.  Citizens. A citizen lives in a house inside a city and works in an office in another city. Every person on ALT is either a guardian or a citizen and there\'s exactly one guardian alongside each road.   Rick and Morty talked to all the people in ALT, and here\'s what they got:  There are m citizens living in ALT.  Citizen number i lives in city number xi and works in city number yi.  Every day each citizen will go through all roads along the shortest path from his home to his work.  A citizen will be happy if and only if either he himself has a puppy himself or all of guardians along his path to his work has a puppy (he sees the guardian\'s puppy in each road and will be happy).  A guardian is always happy. You need to tell Rick and Morty the minimum number of puppies they need in order to make all people in ALT happy, and also provide an optimal way to distribute these puppies." 3200
786D "Rap God" "data structures,dfs and similar,hashing,strings,trees" "Rick is in love with Unity. But Mr. Meeseeks also love Unity, so Rick and Mr. Meeseeks are ""love rivals"". Unity loves rap, so it decided that they have to compete in a rap game (battle) in order to choose the best. Rick is too nerds, so instead he\'s gonna make his verse with running his original algorithm on lyrics ""Rap God"" song.  His algorithm is a little bit complicated. He\'s made a tree with n vertices numbered from 1 to n and there\'s a lowercase english letter written on each edge. He denotes str(a,\xe2\x80\x89b) to be the string made by writing characters on edges on the shortest path from a to b one by one (a string of length equal to distance of a to b). Note that str(a,\xe2\x80\x89b) is reverse of str(b,\xe2\x80\x89a) and str(a,\xe2\x80\x89a) is empty. In order to make the best verse he can, he needs to answer some queries, but he\'s not a computer scientist and is not able to answer those queries, so he asked you to help him. Each query is characterized by two vertices x and y (x\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y). Answer to this query is the number of vertices like z such that z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x,\xe2\x80\x89z\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89y and str(x,\xe2\x80\x89y) is lexicographically larger than str(x,\xe2\x80\x89z).String x\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89x1x2...x|x| is lexicographically larger than string y\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y1y2...y|y|, if either |x|\xe2\x80\x89\xe2\x80\x89>\xe2\x80\x89\xe2\x80\x89|y| and x1\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y1,\xe2\x80\x89\xe2\x80\x89x2\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89x|y|\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y|y|, or exists such number r (r\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89|x|,\xe2\x80\x89\xe2\x80\x89r\xe2\x80\x89\xe2\x80\x89<\xe2\x80\x89\xe2\x80\x89|y|), that x1\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y1,\xe2\x80\x89\xe2\x80\x89x2\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89y2,\xe2\x80\x89\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89xr\xe2\x80\x89\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89yr and xr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891\xe2\x80\x89\xe2\x80\x89>\xe2\x80\x89\xe2\x80\x89yr\xe2\x80\x89\xe2\x80\x89+\xe2\x80\x89\xe2\x80\x891. Characters are compared like their ASCII codes (or alphabetic order).Help Rick get the girl (or whatever gender Unity has)." 3400
786C "Till I Collapse" "data structures,divide and conquer" "Rick and Morty want to find MR. PBH and they can\'t do it alone. So they need of Mr. Meeseeks. They Have generated n Mr. Meeseeks, standing in a line numbered from 1 to n. Each of them has his own color. i-th Mr. Meeseeks\' color is ai. Rick and Morty are gathering their army and they want to divide Mr. Meeseeks into some squads. They don\'t want their squads to be too colorful, so each squad should have Mr. Meeseeks of at most k different colors. Also each squad should be a continuous subarray of Mr. Meeseeks in the line. Meaning that for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89e\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, if Mr. Meeseeks number i and Mr. Meeseeks number j are in the same squad then Mr. Meeseeks number e should be in that same squad.  Also, each squad needs its own presidio, and building a presidio needs money, so they want the total number of squads to be minimized.Rick and Morty haven\'t finalized the exact value of k, so in order to choose it, for each k between 1 and n (inclusive) need to know the minimum number of presidios needed." 2400
786B Legacy "data structures,graphs,shortest paths" "Rick and his co-workers have made a new radioactive formula and a lot of bad guys are after them. So Rick wants to give his legacy to Morty before bad guys catch them. There are n planets in their universe numbered from 1 to n. Rick is in planet number s (the earth) and he doesn\'t know where Morty is. As we all know, Rick owns a portal gun. With this gun he can open one-way portal from a planet he is in to any other planet (including that planet). But there are limits on this gun because he\'s still using its free trial.  By default he can not open any portal by this gun. There are q plans in the website that sells these guns. Every time you purchase a plan you can only use it once but you can purchase it again if you want to use it more.Plans on the website have three types:  With a plan of this type you can open a portal from planet v to planet u.  With a plan of this type you can open a portal from planet v to any planet with index in range [l,\xe2\x80\x89r].  With a plan of this type you can open a portal from any planet with index in range [l,\xe2\x80\x89r] to planet v. Rick doesn\'t known where Morty is, but Unity is going to inform him and he wants to be prepared for when he finds and start his journey immediately. So for each planet (including earth itself) he wants to know the minimum amount of money he needs to get from earth to that planet." 2300
786A Berzerk "dfs and similar,dp,games" "Rick and Morty are playing their own version of Berzerk (which has nothing in common with the famous Berzerk game). This game needs a huge space, so they play it with a computer.In this game there are n objects numbered from 1 to n arranged in a circle (in clockwise order). Object number 1 is a black hole and the others are planets. There\'s a monster in one of the planet. Rick and Morty don\'t know on which one yet, only that he\'s not initially in the black hole, but Unity will inform them before the game starts. But for now, they want to be prepared for every possible scenario.  Each one of them has a set of numbers between 1 and n\xe2\x80\x89-\xe2\x80\x891 (inclusive). Rick\'s set is s1 with k1 elements and Morty\'s is s2 with k2 elements. One of them goes first and the player changes alternatively. In each player\'s turn, he should choose an arbitrary number like x from his set and the monster will move to his x-th next object from its current position (clockwise). If after his move the monster gets to the black hole he wins.Your task is that for each of monster\'s initial positions and who plays first determine if the starter wins, loses, or the game will stuck in an infinite loop. In case when player can lose or make game infinity, it more profitable to choose infinity game." 2000
785E "Anton and Permutation" "brute force,data structures" "Anton likes permutations, especially he likes to permute their elements. Note that a permutation of n elements is a sequence of numbers {a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an}, in which every number from 1 to n appears exactly once.One day Anton got a new permutation and started to play with it. He does the following operation q times: he takes two elements of the permutation and swaps these elements. After each operation he asks his friend Vanya, how many inversions there are in the new permutation. The number of inversions in a permutation is the number of distinct pairs (i,\xe2\x80\x89j) such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and ai\xe2\x80\x89>\xe2\x80\x89aj.Vanya is tired of answering Anton\'s silly questions. So he asked you to write a program that would answer these questions instead of him.Initially Anton\'s permutation was {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n}, that is ai\xe2\x80\x89=\xe2\x80\x89i for all i such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 2200
785D "Anton and School - 2" "combinatorics,dp,math,number theory" "As you probably know, Anton goes to school. One of the school subjects that Anton studies is Bracketology. On the Bracketology lessons students usually learn different sequences that consist of round brackets (characters ""("" and "")"" (without quotes)).On the last lesson Anton learned about the regular simple bracket sequences (RSBS). A bracket sequence s of length n is an RSBS if the following conditions are met:  It is not empty (that is n\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x890).  The length of the sequence is even.  First  charactes of the sequence are equal to ""("".  Last  charactes of the sequence are equal to "")"". For example, the sequence ""((()))"" is an RSBS but the sequences ""((())"" and ""(()())"" are not RSBS.Elena Ivanovna, Anton\'s teacher, gave him the following task as a homework. Given a bracket sequence s. Find the number of its distinct subsequences such that they are RSBS. Note that a subsequence of s is a string that can be obtained from s by deleting some of its elements. Two subsequences are considered distinct if distinct sets of positions are deleted.Because the answer can be very big and Anton\'s teacher doesn\'t like big numbers, she asks Anton to find the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Anton thought of this task for a very long time, but he still doesn\'t know how to solve it. Help Anton to solve this task and write a program that finds the answer for it!" 2300
785C "Anton and Fairy Tale" "binary search,math" "Anton likes to listen to fairy tales, especially when Danik, Anton\'s best friend, tells them. Right now Danik tells Anton a fairy tale:""Once upon a time, there lived an emperor. He was very rich and had much grain. One day he ordered to build a huge barn to put there all his grain. Best builders were building that barn for three days and three nights. But they overlooked and there remained a little hole in the barn, from which every day sparrows came through. Here flew a sparrow, took a grain and flew away...""More formally, the following takes place in the fairy tale. At the beginning of the first day the barn with the capacity of n grains was full. Then, every day (starting with the first day) the following happens:  m grains are brought to the barn. If m grains doesn\'t fit to the barn, the barn becomes full and the grains that doesn\'t fit are brought back (in this problem we can assume that the grains that doesn\'t fit to the barn are not taken into account).  Sparrows come and eat grain. In the i-th day i sparrows come, that is on the first day one sparrow come, on the second day two sparrows come and so on. Every sparrow eats one grain. If the barn is empty, a sparrow eats nothing. Anton is tired of listening how Danik describes every sparrow that eats grain from the barn. Anton doesn\'t know when the fairy tale ends, so he asked you to determine, by the end of which day the barn will become empty for the first time. Help Anton and write a program that will determine the number of that day!" 1600
785B "Anton and Classes" greedy,sortings "Anton likes to play chess. Also he likes to do programming. No wonder that he decided to attend chess classes and programming classes.Anton has n variants when he will attend chess classes, i-th variant is given by a period of time (l1,\xe2\x80\x89i,\xe2\x80\x89r1,\xe2\x80\x89i). Also he has m variants when he will attend programming classes, i-th variant is given by a period of time (l2,\xe2\x80\x89i,\xe2\x80\x89r2,\xe2\x80\x89i).Anton needs to choose exactly one of n possible periods of time when he will attend chess classes and exactly one of m possible periods of time when he will attend programming classes. He wants to have a rest between classes, so from all the possible pairs of the periods he wants to choose the one where the distance between the periods is maximal.The distance between periods (l1,\xe2\x80\x89r1) and (l2,\xe2\x80\x89r2) is the minimal possible distance between a point in the first period and a point in the second period, that is the minimal possible |i\xe2\x80\x89-\xe2\x80\x89j|, where l1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r1 and l2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2. In particular, when the periods intersect, the distance between them is 0.Anton wants to know how much time his rest between the classes will last in the best case. Help Anton and find this number!" 1100
785A "Anton and Polyhedrons" implementation,strings "Anton\'s favourite geometric figures are regular polyhedrons. Note that there are five kinds of regular polyhedrons:   Tetrahedron. Tetrahedron has 4 triangular faces.  Cube. Cube has 6 square faces.  Octahedron. Octahedron has 8 triangular faces.  Dodecahedron. Dodecahedron has 12 pentagonal faces.  Icosahedron. Icosahedron has 20 triangular faces. All five kinds of polyhedrons are shown on the picture below:  Anton has a collection of n polyhedrons. One day he decided to know, how many faces his polyhedrons have in total. Help Anton and find this number!" 800
784G "BF Calculator" "*special problem" "In this problem you will write a simple generator of Brainfuck (https://en.wikipedia.org/wiki/Brainfuck) calculators.You are given an arithmetic expression consisting of integers from 0 to 255 and addition/subtraction signs between them. Output a Brainfuck program which, when executed, will print the result of evaluating this expression.We use a fairly standard Brainfuck interpreter for checking the programs: 30000 memory cells. memory cells store integers from 0 to 255 with unsigned 8-bit wraparound. console input (, command) is not supported, but it\'s not needed for this problem." 2000
784F "Crunching Numbers Just for You" "*special problem,implementation" "You are developing a new feature for the website which sells airline tickets: being able to sort tickets by price! You have already extracted the tickets\' prices, so there\'s just the last step to be done...You are given an array of integers. Sort it in non-descending order." 1900
784E "Twisted Circuit" "*special problem,brute force,implementation"  2000
784D "Touchy-Feely Palindromes" "*special problem,implementation" "InputThe only line of the input contains a string of digits. The length of the string is between 1 and 10, inclusive.OutputOutput ""Yes"" or ""No"".ExamplesInputCopy373OutputCopyYesInputCopy121OutputCopyNoInputCopy436OutputCopyYes" 1900
784C INTERCALC "*special problem,implementation" "DO YOU EXPECT ME TO FIND THIS OUT?WHAT BASE AND/XOR LANGUAGE INCLUDES string?DON\'T BYTE OF MORE THAN YOU CAN CHEWYOU CAN ONLY DISTORT THE LARGEST OF MATHEMATICS SO FARSAYING ""ABRACADABRA"" WITHOUT A MAGIC AND WON\'T DO YOU ANY GOODTHE LAST STACK RUPTURES. ALL DIE. OH, THE EMBARRASSMENT!I HAVE NO ARRAY AND I MUST SCREAMELEMENTS MAY NOT BE STORED IN WEST HYPERSPACE" 1800
784B "Kids\' Riddle" "*special problem" "Programmers\' kids solve this riddle in 5-10 minutes. How fast can you do it?" 2000
784A "Numbers Joke" "*special problem" "InputThe input contains a single integer a (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x8930).OutputOutput a single integer.ExampleInputCopy3OutputCopy27" 1700
780H "Intranet of Buses" "binary search,geometry,implementation,two pointers" "A new bus route is opened in the city . The route is a closed polygon line in the place, with all segments parallel to one of the axes. m buses will operate on the route. All buses move in a loop along the route in the same direction with equal constant velocities (stopping times are negligible in this problem).Buses start their movement in the first vertex of the route with equal interval. Suppose that T is the total time for a single bus to travel the whole loop of the route. Then, the bus 1 starts moving at time 0, the bus 2 starts at time T\xe2\x80\x89/\xe2\x80\x89m, the bus 3 starts at time 2T\xe2\x80\x89/\xe2\x80\x89m, and so on; finally, the bus m starts moving at time (m\xe2\x80\x89-\xe2\x80\x891)T\xe2\x80\x89/\xe2\x80\x89m. Thus, all intervals between pairs of consecutive buses (including the interval between the last and the first bus) are equal.Buses can communicate with each other via wireless transmitters of equal power. If the transmitters have power D, then only buses within distance D of each other can communicate.The buses are also equipped with a distributed system of schedule tracking. For all buses to stick to the schedule, the system has to synchronize the necessary data between all buses from time to time. At the moment of synchronization, the bus 1 communicates with the bus 2, the bus 2 \xe2\x80\x94 with bus 3, and so on; also, the bus m communicates with the bus 1.As a research employee, you are tasked with finding the smallest value of D such that it is possible to find a time moment to perform synchronization once all buses have started moving." 3100
780G "Andryusha and Nervous Barriers" "data structures,dp" "Andryusha has found a perplexing arcade machine. The machine is a vertically adjusted board divided into square cells. The board has w columns numbered from 1 to w from left to right, and h rows numbered from 1 to h from the bottom to the top.Further, there are barriers in some of board rows. There are n barriers in total, and i-th of them occupied the cells li through ri of the row ui. Andryusha recollects well that no two barriers share the same row. Furthermore, no row is completely occupied with a barrier, that is, at least one cell in each row is free.The player can throw a marble to any column of the machine from above. A marble falls downwards until it encounters a barrier, or falls through the bottom of the board. A marble disappears once it encounters a barrier but is replaced by two more marbles immediately to the left and to the right of the same barrier. In a situation when the barrier is at an edge of the board, both marbles appear next to the barrier at the side opposite to the edge. More than one marble can occupy the same place of the board, without obstructing each other\'s movement. Ultimately, all marbles are bound to fall from the bottom of the machine.  Examples of marble-barrier interaction. Peculiarly, sometimes marbles can go through barriers as if they were free cells. That is so because the barriers are in fact alive, and frightened when a marble was coming at them from a very high altitude. More specifically, if a marble falls towards the barrier i from relative height more than si (that is, it started its fall strictly higher than ui\xe2\x80\x89+\xe2\x80\x89si), then the barrier evades the marble. If a marble is thrown from the top of the board, it is considered to appear at height (h\xe2\x80\x89+\xe2\x80\x891).Andryusha remembers to have thrown a marble once in each of the columns. Help him find the total number of marbles that came down at the bottom of the machine. Since the answer may be large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2700
780F "Axel and Marston in Bitland" bitmasks,dp,graphs,matrices "A couple of friends, Axel and Marston are travelling across the country of Bitland. There are n towns in Bitland, with some pairs of towns connected by one-directional roads. Each road in Bitland is either a pedestrian road or a bike road. There can be multiple roads between any pair of towns, and may even be a road from a town to itself. However, no pair of roads shares the starting and the destination towns along with their types simultaneously.The friends are now located in the town 1 and are planning the travel route. Axel enjoys walking, while Marston prefers biking. In order to choose a route diverse and equally interesting for both friends, they have agreed upon the following procedure for choosing the road types during the travel: The route starts with a pedestrian route. Suppose that a beginning of the route is written in a string s of letters P (pedestrain road) and B (biking road). Then, the string  is appended to s, where  stands for the string s with each character changed to opposite (that is, all pedestrian roads changed to bike roads, and vice versa).In the first few steps the route will look as follows: P, PB, PBBP, PBBPBPPB, PBBPBPPBBPPBPBBP, and so on.After that the friends start travelling from the town 1 via Bitlandian roads, choosing the next road according to the next character of their route type each time. If it is impossible to choose the next road, the friends terminate their travel and fly home instead.Help the friends to find the longest possible route that can be travelled along roads of Bitland according to the road types choosing procedure described above. If there is such a route with more than 1018 roads in it, print -1 instead." 2400
780E "Underground Lab" "constructive algorithms,dfs and similar,graphs" "The evil Bumbershoot corporation produces clones for gruesome experiments in a vast underground lab. On one occasion, the corp cloned a boy Andryusha who was smarter than his comrades. Immediately Andryusha understood that something fishy was going on there. He rallied fellow clones to go on a feud against the evil corp, and they set out to find an exit from the lab. The corp had to reduce to destroy the lab complex.The lab can be pictured as a connected graph with n vertices and m edges. k clones of Andryusha start looking for an exit in some of the vertices. Each clone can traverse any edge once per second. Any number of clones are allowed to be at any vertex simultaneously. Each clone is allowed to stop looking at any time moment, but he must look at his starting vertex at least. The exit can be located at any vertex of the lab, hence each vertex must be visited by at least one clone.Each clone can visit at most  vertices before the lab explodes.Your task is to choose starting vertices and searching routes for the clones. Each route can have at most  vertices." 2100
780D "Innokenty and a Football League" "2-sat,graphs,greedy,implementation,shortest paths,strings" "Innokenty is a president of a new football league in Byteland. The first task he should do is to assign short names to all clubs to be shown on TV next to the score. Of course, the short names should be distinct, and Innokenty wants that all short names consist of three letters.Each club\'s full name consist of two words: the team\'s name and the hometown\'s name, for example, ""DINAMO BYTECITY"". Innokenty doesn\'t want to assign strange short names, so he wants to choose such short names for each club that:   the short name is the same as three first letters of the team\'s name, for example, for the mentioned club it is ""DIN"",  or, the first two letters of the short name should be the same as the first two letters of the team\'s name, while the third letter is the same as the first letter in the hometown\'s name. For the mentioned club it is ""DIB"". Apart from this, there is a rule that if for some club x the second option of short name is chosen, then there should be no club, for which the first option is chosen which is the same as the first option for the club x. For example, if the above mentioned club has short name ""DIB"", then no club for which the first option is chosen can have short name equal to ""DIN"". However, it is possible that some club have short name ""DIN"", where ""DI"" are the first two letters of the team\'s name, and ""N"" is the first letter of hometown\'s name. Of course, no two teams can have the same short name.Help Innokenty to choose a short name for each of the teams. If this is impossible, report that. If there are multiple answer, any of them will suit Innokenty. If for some team the two options of short name are equal, then Innokenty will formally think that only one of these options is chosen." 1900
780C "Andryusha and Colored Balloons" "dfs and similar,graphs,greedy,trees" "Andryusha goes through a park each day. The squares and paths between them look boring to Andryusha, so he decided to decorate them.The park consists of n squares connected with (n\xe2\x80\x89-\xe2\x80\x891) bidirectional paths in such a way that any square is reachable from any other using these paths. Andryusha decided to hang a colored balloon at each of the squares. The baloons\' colors are described by positive integers, starting from 1. In order to make the park varicolored, Andryusha wants to choose the colors in a special way. More precisely, he wants to use such colors that if a, b and c are distinct squares that a and b have a direct path between them, and b and c have a direct path between them, then balloon colors on these three squares are distinct.Andryusha wants to use as little different colors as possible. Help him to choose the colors!" 1600
780B "The Meeting Place Cannot Be Changed" "binary search" "The main road in Bytecity is a straight line from south to north. Conveniently, there are coordinates measured in meters from the southernmost building in north direction.At some points on the road there are n friends, and i-th of them is standing at the point xi meters and can move with any speed no greater than vi meters per second in any of the two directions along the road: south or north.You are to compute the minimum time needed to gather all the n friends at some point on the road. Note that the point they meet at doesn\'t need to have integer coordinate." 1600
780A "Andryusha and Socks" implementation "Andryusha is an orderly boy and likes to keep things in their place.Today he faced a problem to put his socks in the wardrobe. He has n distinct pairs of socks which are initially in a bag. The pairs are numbered from 1 to n. Andryusha wants to put paired socks together and put them in the wardrobe. He takes the socks one by one from the bag, and for each sock he looks whether the pair of this sock has been already took out of the bag, or not. If not (that means the pair of this sock is still in the bag), he puts the current socks on the table in front of him. Otherwise, he puts both socks from the pair to the wardrobe.Andryusha remembers the order in which he took the socks from the bag. Can you tell him what is the maximum number of socks that were on the table at the same time?" 800
779C "Dishonest Sellers" "constructive algorithms,greedy,sortings" "Igor found out discounts in a shop and decided to buy n items. Discounts at the store will last for a week and Igor knows about each item that its price now is ai, and after a week of discounts its price will be bi.Not all of sellers are honest, so now some products could be more expensive than after a week of discounts.Igor decided that buy at least k of items now, but wait with the rest of the week in order to save money as much as possible. Your task is to determine the minimum money that Igor can spend to buy all n items." 1200
779B "Weird Rounding" "brute force,greedy" "Polycarp is crazy about round numbers. He especially likes the numbers divisible by 10k.In the given number of n Polycarp wants to remove the least number of digits to get a number that is divisible by 10k. For example, if k\xe2\x80\x89=\xe2\x80\x893, in the number 30020 it is enough to delete a single digit (2). In this case, the result is 3000 that is divisible by 103\xe2\x80\x89=\xe2\x80\x891000.Write a program that prints the minimum number of digits to be deleted from the given integer number n, so that the result is divisible by 10k. The result should not start with the unnecessary leading zero (i.e., zero can start only the number 0, which is required to be written as exactly one digit).It is guaranteed that the answer exists." 1100
779A "Pupils Redistribution" "constructive algorithms,math" "In Berland each high school student is characterized by academic performance \xe2\x80\x94 integer value between 1 and 5.In high school 0xFF there are two groups of pupils: the group A and the group B. Each group consists of exactly n students. An academic performance of each student is known \xe2\x80\x94 integer value between 1 and 5.The school director wants to redistribute students between groups so that each of the two groups has the same number of students whose academic performance is equal to 1, the same number of students whose academic performance is 2 and so on. In other words, the purpose of the school director is to change the composition of groups, so that for each value of academic performance the numbers of students in both groups are equal.To achieve this, there is a plan to produce a series of exchanges of students between groups. During the single exchange the director selects one student from the class A and one student of class B. After that, they both change their groups.Print the least number of exchanges, in order to achieve the desired equal numbers of students for each academic performance." 1000
778E "Selling Numbers" dp,sortings "Boris really likes numbers and even owns a small shop selling interesting numbers. He has n decimal numbers Bi. Cost of the number in his shop is equal to the sum of costs of its digits. You are given the values cd, where cd is the cost of the digit d. Of course, Boris is interested in that numbers he owns have the maximum cost possible.Recently Boris got hold of the magical artifact A, which can allow him to increase the cost of his collection. Artifact is a string, consisting of digits and \'?\' symbols. To use the artifact, Boris must replace all \'?\' with digits to get a decimal number without leading zeros (it is also not allowed to get number 0). After that, the resulting number is added to all numbers Bi in Boris\' collection. He uses the artifact exactly once.What is the maximum cost of the collection Boris can achieve after using the artifact?" 3000
778D "Parquet Re-laying" "constructive algorithms" "Peter decided to lay a parquet in the room of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, the parquet consists of tiles of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x892. When the workers laid the parquet, it became clear that the tiles pattern looks not like Peter likes, and workers will have to re-lay it.The workers decided that removing entire parquet and then laying it again is very difficult task, so they decided to make such an operation every hour: remove two tiles, which form a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square, rotate them 90 degrees and put them back on the same place.  They have no idea how to obtain the desired configuration using these operations, and whether it is possible at all.Help Peter to make a plan for the workers or tell that it is impossible. The plan should contain at most 100\xe2\x80\x89000 commands." 2700
778C "Peterson Polyglot" "brute force,dfs and similar,dsu,hashing,strings,trees" "Peterson loves to learn new languages, but his favorite hobby is making new ones. Language is a set of words, and word is a sequence of lowercase Latin letters.Peterson makes new language every morning. It is difficult task to store the whole language, so Peterson have invented new data structure for storing his languages which is called broom. Broom is rooted tree with edges marked with letters. Initially broom is represented by the only vertex \xe2\x80\x94 the root of the broom. When Peterson wants to add new word to the language he stands at the root and processes the letters of new word one by one. Consider that Peterson stands at the vertex u. If there is an edge from u marked with current letter, Peterson goes through this edge. Otherwise Peterson adds new edge from u to the new vertex v, marks it with the current letter and goes through the new edge. Size of broom is the number of vertices in it.In the evening after working day Peterson can\'t understand the language he made this morning. It is too difficult for bored Peterson and he tries to make it simpler. Simplification of the language is the process of erasing some letters from some words of this language. Formally, Peterson takes some positive integer p and erases p-th letter from all the words of this language having length at least p. Letters in words are indexed starting by 1. Peterson considers that simplification should change at least one word, i.e. there has to be at least one word of length at least p. Peterson tries to make his language as simple as possible, so he wants to choose p such that the size of the broom for his simplified language is as small as possible.Peterson is pretty annoyed with this task so he asks you for help. Write a program to find the smallest possible size of the broom and integer p." 2500
778B "Bitwise Formula" "bitmasks,brute force,dfs and similar,expression parsing,implementation" "Bob recently read about bitwise operations used in computers: AND, OR and XOR. He have studied their properties and invented a new game.Initially, Bob chooses integer m, bit depth of the game, which means that all numbers in the game will consist of m bits. Then he asks Peter to choose some m-bit number. After that, Bob computes the values of n variables. Each variable is assigned either a constant m-bit number or result of bitwise operation. Operands of the operation may be either variables defined before, or the number, chosen by Peter. After that, Peter\'s score equals to the sum of all variable values.Bob wants to know, what number Peter needs to choose to get the minimum possible score, and what number he needs to choose to get the maximum possible score. In both cases, if there are several ways to get the same score, find the minimum number, which he can choose." 1800
778A "String Game" "binary search,greedy,strings" "Little Nastya has a hobby, she likes to remove some letters from word, to obtain another word. But it turns out to be pretty hard for her, because she is too young. Therefore, her brother Sergey always helps her.Sergey gives Nastya the word t and wants to get the word p out of it. Nastya removes letters in a certain order (one after another, in this order strictly), which is specified by permutation of letters\' indices of the word t: a1... a|t|. We denote the length of word x as |x|. Note that after removing one letter, the indices of other letters don\'t change. For example, if t\xe2\x80\x89=\xe2\x80\x89""nastya"" and a\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x891,\xe2\x80\x895,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x896] then removals make the following sequence of words ""nastya""  ""nastya""  ""nastya""  ""nastya""  ""nastya""  ""nastya""  ""nastya"".Sergey knows this permutation. His goal is to stop his sister at some point and continue removing by himself to get the word p. Since Nastya likes this activity, Sergey wants to stop her as late as possible. Your task is to determine, how many letters Nastya can remove before she will be stopped by Sergey.It is guaranteed that the word p can be obtained by removing the letters from word t." 1700
777E "Hanoi Factory" "brute force,data structures,dp,greedy,sortings" "Of course you have heard the famous task about Hanoi Towers, but did you know that there is a special factory producing the rings for this wonderful game? Once upon a time, the ruler of the ancient Egypt ordered the workers of Hanoi Factory to create as high tower as possible. They were not ready to serve such a strange order so they had to create this new tower using already produced rings.There are n rings in factory\'s stock. The i-th ring has inner radius ai, outer radius bi and height hi. The goal is to select some subset of rings and arrange them such that the following conditions are satisfied:  Outer radiuses form a non-increasing sequence, i.e. one can put the j-th ring on the i-th ring only if bj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi.  Rings should not fall one into the the other. That means one can place ring j on the ring i only if bj\xe2\x80\x89>\xe2\x80\x89ai.  The total height of all rings used should be maximum possible." 2000
777D "Cloud of Hashtags" "binary search,greedy,implementation,strings" "Vasya is an administrator of a public page of organization ""Mouse and keyboard"" and his everyday duty is to publish news from the world of competitive programming. For each news he also creates a list of hashtags to make searching for a particular topic more comfortable. For the purpose of this problem we define hashtag as a string consisting of lowercase English letters and exactly one symbol \'#\' located at the beginning of the string. The length of the hashtag is defined as the number of symbols in it without the symbol \'#\'.The head administrator of the page told Vasya that hashtags should go in lexicographical order (take a look at the notes section for the definition).Vasya is lazy so he doesn\'t want to actually change the order of hashtags in already published news. Instead, he decided to delete some suffixes (consecutive characters at the end of the string) of some of the hashtags. He is allowed to delete any number of characters, even the whole string except for the symbol \'#\'. Vasya wants to pick such a way to delete suffixes that the total number of deleted symbols is minimum possible. If there are several optimal solutions, he is fine with any of them." 1800
777C "Alyona and Spreadsheet" "binary search,data structures,dp,greedy,implementation,two pointers" "During the lesson small girl Alyona works with one famous spreadsheet computer program and learns how to edit tables.Now she has a table filled with integers. The table consists of n rows and m columns. By ai,\xe2\x80\x89j we will denote the integer located at the i-th row and the j-th column. We say that the table is sorted in non-decreasing order in the column j if ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891.Teacher gave Alyona k tasks. For each of the tasks two integers l and r are given and Alyona has to answer the following question: if one keeps the rows from l to r inclusive and deletes all others, will the table be sorted in non-decreasing order in at least one column? Formally, does there exist such j that ai,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j for all i from l to r\xe2\x80\x89-\xe2\x80\x891 inclusive.Alyona is too small to deal with this task and asks you to help!" 1600
777B "Game of Credit Cards" "data structures,dp,greedy,sortings" "After the fourth season Sherlock and Moriary have realized the whole foolishness of the battle between them and decided to continue their competitions in peaceful game of Credit Cards.Rules of this game are simple: each player bring his favourite n-digit credit card. Then both players name the digits written on their cards one by one. If two digits are not equal, then the player, whose digit is smaller gets a flick (knock in the forehead usually made with a forefinger) from the other player. For example, if n\xe2\x80\x89=\xe2\x80\x893, Sherlock\'s card is 123 and Moriarty\'s card has number 321, first Sherlock names 1 and Moriarty names 3 so Sherlock gets a flick. Then they both digit 2 so no one gets a flick. Finally, Sherlock names 3, while Moriarty names 1 and gets a flick.Of course, Sherlock will play honestly naming digits one by one in the order they are given, while Moriary, as a true villain, plans to cheat. He is going to name his digits in some other order (however, he is not going to change the overall number of occurences of each digit). For example, in case above Moriarty could name 1, 2, 3 and get no flicks at all, or he can name 2, 3 and 1 to give Sherlock two flicks.Your goal is to find out the minimum possible number of flicks Moriarty will get (no one likes flicks) and the maximum possible number of flicks Sherlock can get from Moriarty. Note, that these two goals are different and the optimal result may be obtained by using different strategies." 1300
777A "Shell Game" "constructive algorithms,implementation,math" "Bomboslav likes to look out of the window in his room and watch lads outside playing famous shell game. The game is played by two persons: operator and player. Operator takes three similar opaque shells and places a ball beneath one of them. Then he shuffles the shells by swapping some pairs and the player has to guess the current position of the ball.Bomboslav noticed that guys are not very inventive, so the operator always swaps the left shell with the middle one during odd moves (first, third, fifth, etc.) and always swaps the middle shell with the right one during even moves (second, fourth, etc.).Let\'s number shells from 0 to 2 from left to right. Thus the left shell is assigned number 0, the middle shell is 1 and the right shell is 2. Bomboslav has missed the moment when the ball was placed beneath the shell, but he knows that exactly n movements were made by the operator and the ball was under shell x at the end. Now he wonders, what was the initial position of the ball?" 1000
776G "Sherlock and the Encrypted Data" bitmasks,combinatorics,dp "Sherlock found a piece of encrypted data which he thinks will be useful to catch Moriarty. The encrypted data consists of two integer l and r. He noticed that these integers were in hexadecimal form.He takes each of the integers from l to r, and performs the following operations: He lists the distinct digits present in the given number. For example: for 101416, he lists the digits as 1,\xe2\x80\x890,\xe2\x80\x894.  Then he sums respective powers of two for each digit listed in the step above. Like in the above example sum\xe2\x80\x89=\xe2\x80\x8921\xe2\x80\x89+\xe2\x80\x8920\xe2\x80\x89+\xe2\x80\x8924\xe2\x80\x89=\xe2\x80\x891910.  He changes the initial number by applying bitwise xor of the initial number and the sum. Example: . Note that xor is done in binary notation. One more example: for integer 1e the sum is sum\xe2\x80\x89=\xe2\x80\x8921\xe2\x80\x89+\xe2\x80\x89214. Letters a, b, c, d, e, f denote hexadecimal digits 10, 11, 12, 13, 14, 15, respertively.Sherlock wants to count the numbers in the range from l to r (both inclusive) which decrease on application of the above four steps. He wants you to answer his q queries for different l and r." 2900
776F "Sherlock\'s bet to Moriarty" "constructive algorithms,data structures,divide and conquer,geometry,graphs,implementation,trees" "Sherlock met Moriarty for a final battle of wits. He gave him a regular n sided convex polygon. In addition to it, he gave him certain diagonals to form regions on the polygon. It was guaranteed that the diagonals did not intersect in interior points.He took each of the region and calculated its importance value. Importance value for a region formed by vertices a1,\xe2\x80\x89a2,\xe2\x80\x89... ,\xe2\x80\x89ax of the polygon will be given by 2a1\xe2\x80\x89+\xe2\x80\x892a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x892ax. Then, he sorted these regions on the basis of their importance value in ascending order. After that he assigned each region an index from 1 to k, where k is the number of regions, and index of region is its position in the sorted array calculated above.He wants Moriarty to color the regions using not more than 20 colors, such that two regions have same color only if all the simple paths between these two regions have at least one region with color value less than the color value assigned to these regions. Simple path between two regions f and h is a sequence of regions r1,\xe2\x80\x89r2,\xe2\x80\x89... rt such that r1\xe2\x80\x89=\xe2\x80\x89f, rt\xe2\x80\x89=\xe2\x80\x89h, for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89t regions ri and ri\xe2\x80\x89+\xe2\x80\x891 share an edge, and ri\xe2\x80\x89=\xe2\x80\x89rj if and only if i\xe2\x80\x89=\xe2\x80\x89j.Moriarty couldn\'t answer and asks Sherlock to solve it himself. Help Sherlock in doing so." 2800
776E "The Holmes Children" "math,number theory" "The Holmes children are fighting over who amongst them is the cleverest.Mycroft asked Sherlock and Eurus to find value of f(n), where f(1)\xe2\x80\x89=\xe2\x80\x891 and for n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892, f(n) is the number of distinct ordered positive integer pairs (x,\xe2\x80\x89y) that satisfy x\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89=\xe2\x80\x89n and gcd(x,\xe2\x80\x89y)\xe2\x80\x89=\xe2\x80\x891. The integer gcd(a,\xe2\x80\x89b) is the greatest common divisor of a and b.Sherlock said that solving this was child\'s play and asked Mycroft to instead get the value of . Summation is done over all positive integers d that divide n.Eurus was quietly observing all this and finally came up with her problem to astonish both Sherlock and Mycroft.She defined a k-composite function Fk(n) recursively as follows:She wants them to tell the value of Fk(n) modulo 1000000007." 2100
776D "The Door Problem" "2-sat,dfs and similar,dsu,graphs" "Moriarty has trapped n people in n distinct rooms in a hotel. Some rooms are locked, others are unlocked. But, there is a condition that the people in the hotel can only escape when all the doors are unlocked at the same time. There are m switches. Each switch control doors of some rooms, but each door is controlled by exactly two switches.You are given the initial configuration of the doors. Toggling any switch, that is, turning it ON when it is OFF, or turning it OFF when it is ON, toggles the condition of the doors that this switch controls. Say, we toggled switch 1, which was connected to room 1, 2 and 3 which were respectively locked, unlocked and unlocked. Then, after toggling the switch, they become unlocked, locked and locked.You need to tell Sherlock, if there exists a way to unlock all doors at the same time." 2000
776C "Molly\'s Chemicals" "binary search,brute force,data structures,implementation,math" "Molly Hooper has n different kinds of chemicals arranged in a line. Each of the chemicals has an affection value, The i-th of them has affection value ai.Molly wants Sherlock to fall in love with her. She intends to do this by mixing a contiguous segment of chemicals together to make a love potion with total affection value as a non-negative integer power of k. Total affection value of a continuous segment of chemicals is the sum of affection values of each chemical in that segment.Help her to do so in finding the total number of such segments." 1800
776B "Sherlock and his girlfriend" "constructive algorithms,number theory" "Sherlock has a new girlfriend (so unlike him!). Valentine\'s day is coming and he wants to gift her some jewelry.He bought n pieces of jewelry. The i-th piece has price equal to i\xe2\x80\x89+\xe2\x80\x891, that is, the prices of the jewelry are 2,\xe2\x80\x893,\xe2\x80\x894,\xe2\x80\x89... n\xe2\x80\x89+\xe2\x80\x891.Watson gave Sherlock a challenge to color these jewelry pieces such that two pieces don\'t have the same color if the price of one piece is a prime divisor of the price of the other piece. Also, Watson asked him to minimize the number of different colors used.Help Sherlock complete this trivial task." 1200
776A "A Serial Killer" "brute force,implementation,strings" "Our beloved detective, Sherlock is currently trying to catch a serial killer who kills a person each day. Using his powers of deduction, he came to know that the killer has a strategy for selecting his next victim.The killer starts with two potential victims on his first day, selects one of these two, kills selected victim and replaces him with a new person. He repeats this procedure each day. This way, each day he has two potential victims to choose from. Sherlock knows the initial two potential victims. Also, he knows the murder that happened on a particular day and the new person who replaced this victim.You need to help him get all the pairs of potential victims at each day so that Sherlock can observe some pattern." 900
775A "University Schedule" "*special problem" "In this problem your task is to come up with a week schedule of classes in university for professors and student groups. Consider that there are 6 educational days in week and maximum number of classes per educational day is 7 (classes numerated from 1 to 7 for each educational day).It is known that in university n students study, m professors work and there are a classrooms for conducting classes. Also you have two-dimensional array with n\xe2\x80\x89\xc3\x97\xe2\x80\x89m size which contains the following information. The number which stays in i-th row and j-th column equals to the number of classes which professor j must conduct with the group i in a single week. The schedule which you output must satisfy to array described above.There are several other conditions for schedule. Single professor can not conduct more than one class. Similarly, single student group can not be on more than one class at the same time.Let define a fatigue function for professors and student groups. Call this function f.To single professor fatigue calculated in the following way. Let look on classes which this professor must conduct in each of the 6-th educational days. Let x be the number of class which professor will firstly conduct in day i and let y \xe2\x80\x94 the last class for this professor. Then the value (2\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(2\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891) must be added to professor\'s fatigue. If professor has no classes in day i, nothing is added to professor\'s fatigue. For single student group fatigue is calculated similarly. Lets look at classes of this group in each of the 6 educational days. Let x be the number of first class for this group on day i and let y \xe2\x80\x94 the last class for this group. Then the value (2\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891)\xc2\xb7(2\xe2\x80\x89+\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891) must be added to this group\'s fatigue. If student group has no classes in day i, nothing is added to group\'s fatigue.So the value of function f equals to total {fatigue} for all n student groups and for all m professors.Your task is to come up with such a schedule which minimizes the value of function f.Jury prepared some solution of this problem. For each test you will get a certain number of points. It equals to result of division of the value of function f from the jury solution by the value of function f for schedule which your program output (i. e. the smaller value of {fatigue} function your program find the more points you will get), multiplied by 100. In the other words if the value of f for jury solution equals to p and for your solution \xe2\x80\x94 to q, you will get 100\xc2\xb7p\xe2\x80\x89/\xe2\x80\x89q points (note, that the number of points is a real number). The points will be added together for all tests. The goal is to score as many points as possible." 2900
774L Bars "*special problem,binary search" "Polycarp\'s workday lasts exactly n minutes. He loves chocolate bars and can eat one bar in one minute. Today Polycarp has k bars at the beginning of the workday.In some minutes of the workday Polycarp has important things to do and in such minutes he is not able to eat a chocolate bar. In other minutes he can either eat or not eat one chocolate bar. It is guaranteed, that in the first and in the last minutes of the workday Polycarp has no important things to do and he will always eat bars in this minutes to gladden himself at the begining and at the end of the workday. Also it is guaranteed, that k is strictly greater than 1.Your task is to determine such an order of eating chocolate bars that the maximum break time between eating bars is as minimum as possible.Consider that Polycarp eats a bar in the minute x and the next bar in the minute y (x<y). Then the break time is equal to y\xe2\x88\x92x\xe2\x88\x921 minutes. It is not necessary for Polycarp to eat all bars he has." 2000
774K "Stepan and Vowels" "*special problem,implementation,strings" "Stepan likes to repeat vowel letters when he writes words. For example, instead of the word ""pobeda"" he can write ""pobeeeedaaaaa"".Sergey does not like such behavior, so he wants to write a program to format the words written by Stepan. This program must combine all consecutive equal vowels to a single vowel. The vowel letters are ""a"", ""e"", ""i"", ""o"", ""u"" and ""y"".There are exceptions: if letters ""e"" or ""o"" repeat in a row exactly 2 times, like in words ""feet"" and ""foot"", the program must skip them and do not transform in one vowel. For example, the word ""iiiimpleeemeentatiioon"" must be converted to the word ""implemeentatioon"".Sergey is very busy and asks you to help him and write the required program." 1600
774J "Stepan\'s Series" "*special problem,dp" "Well, the series which Stepan watched for a very long time, ended. In total, the series had n episodes. For each of them, Stepan remembers either that he definitely has watched it, or that he definitely hasn\'t watched it, or he is unsure, has he watched this episode or not. Stepan\'s dissatisfaction is the maximum number of consecutive series that Stepan did not watch.Your task is to determine according to Stepan\'s memories if his dissatisfaction could be exactly equal to k." 2000
774I "Composing Of String" "*special problem,dp" "Stepan has a set of n strings. Also, he has a favorite string s. Stepan wants to do the following. He will take some strings of his set and write them down one after another. It is possible that he will take some strings more than once, and will not take some of them at all.Your task is to determine the minimum number of strings in the set which Stepan needs to take and write so that the string s appears as a subsequence in the resulting written down string. For example, in the string ""abcd"" strings ""ad"", ""acd"", ""abcd"" appear as subsequences, and strings ""ba"", ""abdc"" don\'t appear as subsequences." 2300
774H "Repairing Of String" "*special problem,constructive algorithms" "Stepan had a favorite string s which consisted of the lowercase letters of the Latin alphabet. After graduation, he decided to remember it, but it was a long time ago, so he can\'t now remember it. But Stepan remembers some information about the string, namely the sequence of integers c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn, where n equals the length of the string s, and ci equals the number of substrings in the string s with the length i, consisting of the same letters. The substring is a sequence of consecutive characters in the string s.For example, if the Stepan\'s favorite string is equal to ""tttesst"", the sequence c looks like: c\xe2\x80\x89=\xe2\x80\x89[7,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x890].Stepan asks you to help to repair his favorite string s according to the given sequence c1,\xe2\x80\x89c2,\xe2\x80\x89...,\xe2\x80\x89cn." 2200
774G "Perfectionist Arkadiy" "*special problem,number theory" "Arkadiy has lots square photos with size a\xe2\x80\x89\xc3\x97\xe2\x80\x89a. He wants to put some of them on a rectangular wall with size h\xe2\x80\x89\xc3\x97\xe2\x80\x89w. The photos which Arkadiy will put on the wall must form a rectangular grid and the distances between neighboring vertically and horizontally photos and also the distances between outside rows and columns of photos to the nearest bound of the wall must be equal to x, where x is some non-negative real number. Look on the picture below for better understanding of the statement.  Arkadiy haven\'t chosen yet how many photos he would put on the wall, however, he want to put at least one photo. Your task is to determine the minimum value of x which can be obtained after putting photos, or report that there is no way to put positive number of photos and satisfy all the constraints. Suppose that Arkadiy has enough photos to make any valid arrangement according to the constraints.Note that Arkadiy wants to put at least one photo on the wall. The photos should not overlap, should completely lie inside the wall bounds and should have sides parallel to the wall sides." 2700
774F "Pens And Days Of Week" "*special problem,binary search,number theory" "Stepan has n pens. Every day he uses them, and on the i-th day he uses the pen number i. On the (n\xe2\x80\x89+\xe2\x80\x891)-th day again he uses the pen number 1, on the (n\xe2\x80\x89+\xe2\x80\x892)-th \xe2\x80\x94 he uses the pen number 2 and so on.On every working day (from Monday to Saturday, inclusive) Stepan spends exactly 1 milliliter of ink of the pen he uses that day. On Sunday Stepan has a day of rest, he does not stend the ink of the pen he uses that day. Stepan knows the current volume of ink in each of his pens. Now it\'s the Monday morning and Stepan is going to use the pen number 1 today. Your task is to determine which pen will run out of ink before all the rest (that is, there will be no ink left in it), if Stepan will use the pens according to the conditions described above." 2700
774E "Big Number and Remainder" "*special problem,math,number theory" "Stepan has a very big positive integer.Let\'s consider all cyclic shifts of Stepan\'s integer (if we look at his integer like at a string) which are also integers (i.e. they do not have leading zeros). Let\'s call such shifts as good shifts. For example, for the integer 10203 the good shifts are the integer itself 10203 and integers 20310 and 31020.Stepan wants to know the minimum remainder of the division by the given number m among all good shifts. Your task is to determine the minimum remainder of the division by m." 2300
774D "Lie or Truth" "*special problem,constructive algorithms,implementation,sortings" "Vasya has a sequence of cubes and exactly one integer is written on each cube. Vasya exhibited all his cubes in a row. So the sequence of numbers written on the cubes in the order from the left to the right equals to a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.While Vasya was walking, his little brother Stepan played with Vasya\'s cubes and changed their order, so now the sequence of numbers written on the cubes became equal to b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn. Stepan said that he swapped only cubes which where on the positions between l and r, inclusive, and did not remove or add any other cubes (i. e. he said that he reordered cubes between positions l and r, inclusive, in some way).Your task is to determine if it is possible that Stepan said the truth, or it is guaranteed that Stepan deceived his brother." 1500
774C "Maximum Number" "*special problem,constructive algorithms,greedy,implementation" "Stepan has the newest electronic device with a display. Different digits can be shown on it. Each digit is shown on a seven-section indicator like it is shown on the picture below.  So, for example, to show the digit 3 on the display, 5 sections must be highlighted; and for the digit 6, 6 sections must be highlighted. The battery of the newest device allows to highlight at most n sections on the display. Stepan wants to know the maximum possible integer number which can be shown on the display of his newest device. Your task is to determine this number. Note that this number must not contain leading zeros. Assume that the size of the display is enough to show any integer." 1200
774B "Significant Cups" "*special problem,binary search,data structures,two pointers" "Stepan is a very experienced olympiad participant. He has n cups for Physics olympiads and m cups for Informatics olympiads. Each cup is characterized by two parameters \xe2\x80\x94 its significance ci and width wi.Stepan decided to expose some of his cups on a shelf with width d in such a way, that:  there is at least one Physics cup and at least one Informatics cup on the shelf,  the total width of the exposed cups does not exceed d,  from each subjects (Physics and Informatics) some of the most significant cups are exposed (i. e. if a cup for some subject with significance x is exposed, then all the cups for this subject with significance greater than x must be exposed too). Your task is to determine the maximum possible total significance, which Stepan can get when he exposes cups on the shelf with width d, considering all the rules described above. The total significance is the sum of significances of all the exposed cups." 2100
774A "Amusement Park" "*special problem,ternary search" "Pupils decided to go to amusement park. Some of them were with parents. In total, n people came to the park and they all want to get to the most extreme attraction and roll on it exactly once.Tickets for group of x people are sold on the attraction, there should be at least one adult in each group (it is possible that the group consists of one adult). The ticket price for such group is c1\xe2\x80\x89+\xe2\x80\x89c2\xc2\xb7(x\xe2\x80\x89-\xe2\x80\x891)2 (in particular, if the group consists of one person, then the price is c1). All pupils who came to the park and their parents decided to split into groups in such a way that each visitor join exactly one group, and the total price of visiting the most extreme attraction is as low as possible. You are to determine this minimum possible total price. There should be at least one adult in each group." 2100
773F "Test Data Generation" "combinatorics,divide and conquer,dp,fft,math,number theory" "Test data generation is not an easy task! Often, generating big random test cases is not enough to ensure thorough testing of solutions for correctness.For example, consider a problem from an old Codeforces round. Its input format looks roughly as follows:The first line contains a single integer n (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89maxn) \xe2\x80\x94 the size of the set. The second line contains n distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89maxa) \xe2\x80\x94 the elements of the set in increasing order.If you don\'t pay attention to the problem solution, it looks fairly easy to generate a good test case for this problem. Let n\xe2\x80\x89=\xe2\x80\x89maxn, take random distinct ai from 1 to maxa, sort them... Soon you understand that it\'s not that easy.Here is the actual problem solution. Let g be the greatest common divisor of a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Let x\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89/\xe2\x80\x89g\xe2\x80\x89-\xe2\x80\x89n. Then the correct solution outputs ""Alice"" if x is odd, and ""Bob"" if x is even.Consider two wrong solutions to this problem which differ from the correct one only in the formula for calculating x.The first wrong solution calculates x as x\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89/\xe2\x80\x89g (without subtracting n).The second wrong solution calculates x as x\xe2\x80\x89=\xe2\x80\x89an\xe2\x80\x89-\xe2\x80\x89n (without dividing by g).A test case is interesting if it makes both wrong solutions output an incorrect answer.Given maxn, maxa and q, find the number of interesting test cases satisfying the constraints, and output it modulo q." 3400
773E "Blog Post Rating" "data structures,sortings" "It\'s well-known that blog posts are an important part of Codeforces platform. Every blog post has a global characteristic changing over time \xe2\x80\x94 its community rating. A newly created blog post\'s community rating is 0. Codeforces users may visit the blog post page and rate it, changing its community rating by +1 or -1.Consider the following model of Codeforces users\' behavior. The i-th user has his own estimated blog post rating denoted by an integer ai. When a user visits a blog post page, he compares his estimated blog post rating to its community rating. If his estimated rating is higher, he rates the blog post with +1 (thus, the blog post\'s community rating increases by 1). If his estimated rating is lower, he rates the blog post with -1 (decreasing its community rating by 1). If the estimated rating and the community rating are equal, user doesn\'t rate the blog post at all (in this case we\'ll say that user rates the blog post for 0). In any case, after this procedure user closes the blog post page and never opens it again.Consider a newly created blog post with the initial community rating of 0. For each of n Codeforces users, numbered from 1 to n, his estimated blog post rating ai is known.For each k from 1 to n, inclusive, the following question is asked. Let users with indices from 1 to k, in some order, visit the blog post page, rate the blog post and close the page. Each user opens the blog post only after the previous user closes it. What could be the maximum possible community rating of the blog post after these k visits?" 3000
773D "Perishable Roads" "dp,graphs,shortest paths" "In the country of Never, there are n cities and a well-developed road system. There is exactly one bidirectional road between every pair of cities, thus, there are as many as  roads! No two roads intersect, and no road passes through intermediate cities. The art of building tunnels and bridges has been mastered by Neverians.An independent committee has evaluated each road of Never with a positive integer called the perishability of the road. The lower the road\'s perishability is, the more pleasant it is to drive through this road.It\'s the year of transport in Never. It has been decided to build a museum of transport in one of the cities, and to set a single signpost directing to some city (not necessarily the one with the museum) in each of the other cities. The signposts must satisfy the following important condition: if any Neverian living in a city without the museum starts travelling from that city following the directions of the signposts, then this person will eventually arrive in the city with the museum.Neverians are incredibly positive-minded. If a Neverian travels by a route consisting of several roads, he considers the perishability of the route to be equal to the smallest perishability of all the roads in this route.The government of Never has not yet decided where to build the museum, so they consider all n possible options. The most important is the sum of perishabilities of the routes to the museum city from all the other cities of Never, if the travelers strictly follow the directions of the signposts. The government of Never cares about their citizens, so they want to set the signposts in a way which minimizes this sum. Help them determine the minimum possible sum for all n possible options of the city where the museum can be built." 2700
773C "Prairie Partition" "binary search,constructive algorithms,greedy,math" "It can be shown that any positive integer x can be uniquely represented as x\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x892k\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89r, where k and r are integers, k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890, 0\xe2\x80\x89<\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892k. Let\'s call that representation prairie partition of x.For example, the prairie partitions of 12, 17, 7 and 1 are:  12\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x895,17\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894\xe2\x80\x89+\xe2\x80\x898\xe2\x80\x89+\xe2\x80\x892,7\xe2\x80\x89=\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x894,1\xe2\x80\x89=\xe2\x80\x891. Alice took a sequence of positive integers (possibly with repeating elements), replaced every element with the sequence of summands in its prairie partition, arranged the resulting numbers in non-decreasing order and gave them to Borys. Now Borys wonders how many elements Alice\'s original sequence could contain. Find all possible options!" 2200
773B "Dynamic Problem Scoring" "brute force,greedy" "Vasya and Petya take part in a Codeforces round. The round lasts for two hours and contains five problems.For this round the dynamic problem scoring is used. If you were lucky not to participate in any Codeforces round with dynamic problem scoring, here is what it means. The maximum point value of the problem depends on the ratio of the number of participants who solved the problem to the total number of round participants. Everyone who made at least one submission is considered to be participating in the round.Pay attention to the range bounds. For example, if 40 people are taking part in the round, and 10 of them solve a particular problem, then the solvers fraction is equal to 1\xe2\x80\x89/\xe2\x80\x894, and the problem\'s maximum point value is equal to 1500.If the problem\'s maximum point value is equal to x, then for each whole minute passed from the beginning of the contest to the moment of the participant\'s correct submission, the participant loses x\xe2\x80\x89/\xe2\x80\x89250 points. For example, if the problem\'s maximum point value is 2000, and the participant submits a correct solution to it 40 minutes into the round, this participant will be awarded with 2000\xc2\xb7(1\xe2\x80\x89-\xe2\x80\x8940\xe2\x80\x89/\xe2\x80\x89250)\xe2\x80\x89=\xe2\x80\x891680 points for this problem.There are n participants in the round, including Vasya and Petya. For each participant and each problem, the number of minutes which passed between the beginning of the contest and the submission of this participant to this problem is known. It\'s also possible that this participant made no submissions to this problem.With two seconds until the end of the round, all participants\' submissions have passed pretests, and not a single hack attempt has been made. Vasya believes that no more submissions or hack attempts will be made in the remaining two seconds, and every submission will pass the system testing.Unfortunately, Vasya is a cheater. He has registered 109\xe2\x80\x89+\xe2\x80\x897 new accounts for the round. Now Vasya can submit any of his solutions from these new accounts in order to change the maximum point values of the problems. Vasya can also submit any wrong solutions to any problems. Note that Vasya can not submit correct solutions to the problems he hasn\'t solved.Vasya seeks to score strictly more points than Petya in the current round. Vasya has already prepared the scripts which allow to obfuscate his solutions and submit them into the system from any of the new accounts in just fractions of seconds. However, Vasya doesn\'t want to make his cheating too obvious, so he wants to achieve his goal while making submissions from the smallest possible number of new accounts.Find the smallest number of new accounts Vasya needs in order to beat Petya (provided that Vasya\'s assumptions are correct), or report that Vasya can\'t achieve his goal." 2000
773A "Success Rate" "binary search,math" "You are an experienced Codeforces user. Today you found out that during your activity on Codeforces you have made y submissions, out of which x have been successful. Thus, your current success rate on Codeforces is equal to x\xe2\x80\x89/\xe2\x80\x89y.Your favorite rational number in the [0;1] range is p\xe2\x80\x89/\xe2\x80\x89q. Now you wonder: what is the smallest number of submissions you have to make if you want your success rate to be p\xe2\x80\x89/\xe2\x80\x89q?" 1700
772E "Verifying Kingdom" "binary search,divide and conquer,interactive,trees" "This is an interactive problem.The judge has a hidden rooted full binary tree with n leaves. A full binary tree is one where every node has either 0 or 2 children. The nodes with 0 children are called the leaves of the tree. Since this is a full binary tree, there are exactly 2n\xe2\x80\x89-\xe2\x80\x891 nodes in the tree. The leaves of the judge\'s tree has labels from 1 to n. You would like to reconstruct a tree that is isomorphic to the judge\'s tree. To do this, you can ask some questions.A question consists of printing the label of three distinct leaves a1,\xe2\x80\x89a2,\xe2\x80\x89a3. Let the depth of a node be the shortest distance from the node to the root of the tree. Let LCA(a,\xe2\x80\x89b) denote the node with maximum depth that is a common ancestor of the nodes a and b.Consider X\xe2\x80\x89=\xe2\x80\x89LCA(a1,\xe2\x80\x89a2),\xe2\x80\x89Y\xe2\x80\x89=\xe2\x80\x89LCA(a2,\xe2\x80\x89a3),\xe2\x80\x89Z\xe2\x80\x89=\xe2\x80\x89LCA(a3,\xe2\x80\x89a1). The judge will tell you which one of X,\xe2\x80\x89Y,\xe2\x80\x89Z has the maximum depth. Note, this pair is uniquely determined since the tree is a binary tree; there can\'t be any ties. More specifically, if X (or Y, Z respectively) maximizes the depth, the judge will respond with the string ""X"" (or ""Y"", ""Z"" respectively). You may only ask at most 10\xc2\xb7n questions." 3200
772D "Varying Kibibits" bitmasks,dp "You are given n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Denote this list of integers as T.Let f(L) be a function that takes in a non-empty list of integers L.The function will output another integer as follows:   First, all integers in L are padded with leading zeros so they are all the same length as the maximum length number in L.  We will construct a string where the i-th character is the minimum of the i-th character in padded input numbers.  The output is the number representing the string interpreted in base 10. For example f(10,\xe2\x80\x899)\xe2\x80\x89=\xe2\x80\x890, f(123,\xe2\x80\x89321)\xe2\x80\x89=\xe2\x80\x89121, f(530,\xe2\x80\x89932,\xe2\x80\x8981)\xe2\x80\x89=\xe2\x80\x8930.Define the function  Here,  denotes a subsequence.In other words, G(x) is the sum of squares of sum of elements of nonempty subsequences of T that evaluate to x when plugged into f modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007, then multiplied by x. The last multiplication is not modded. You would like to compute G(0),\xe2\x80\x89G(1),\xe2\x80\x89...,\xe2\x80\x89G(999\xe2\x80\x89999). To reduce the output size, print the value , where  denotes the bitwise XOR operator." 2700
772C "Vulnerable Kerbals" "constructive algorithms,dp,graphs,math,number theory" "You are given an integer m, and a list of n distinct integers between 0 and m\xe2\x80\x89-\xe2\x80\x891.You would like to construct a sequence satisfying the properties:  Each element is an integer between 0 and m\xe2\x80\x89-\xe2\x80\x891, inclusive.  All prefix products of the sequence modulo m are distinct.  No prefix product modulo m appears as an element of the input list.  The length of the sequence is maximized. Construct any sequence satisfying the properties above." 2300
772B "Volatile Kite" geometry "You are given a convex polygon P with n distinct vertices p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Vertex pi has coordinates (xi,\xe2\x80\x89yi) in the 2D plane. These vertices are listed in clockwise order.You can choose a real number D and move each vertex of the polygon a distance of at most D from their original positions.Find the maximum value of D such that no matter how you move the vertices, the polygon does not intersect itself and stays convex." 1800
772A "Voltage Keepsake" "binary search,math" "You have n devices that you want to use simultaneously.The i-th device uses ai units of power per second. This usage is continuous. That is, in \xce\xbb seconds, the device will use \xce\xbb\xc2\xb7ai units of power. The i-th device currently has bi units of power stored. All devices can store an arbitrary amount of power.You have a single charger that can plug to any single device. The charger will add p units of power per second to a device. This charging is continuous. That is, if you plug in a device for \xce\xbb seconds, it will gain \xce\xbb\xc2\xb7p units of power. You can switch which device is charging at any arbitrary unit of time (including real numbers), and the time it takes to switch is negligible.You are wondering, what is the maximum amount of time you can use the devices until one of them hits 0 units of power.If you can use the devices indefinitely, print -1. Otherwise, print the maximum amount of time before any one device hits 0 power." 1800
771F "Bear and Isomorphic Points" "geometry,two pointers" "Bearland is a big square on the plane. It contains all points with coordinates not exceeding 106 by the absolute value.There are n houses in Bearland. The i-th of them is located at the point (xi,\xe2\x80\x89yi). The n points are distinct, but some subsets of them may be collinear.Bear Limak lives in the first house. He wants to destroy his house and build a new one somewhere in Bearland.Bears don\'t like big changes. For every three points (houses) pi, pj and pk, the sign of their cross product (pj\xe2\x80\x89-\xe2\x80\x89pi)\xe2\x80\x89\xc3\x97\xe2\x80\x89(pk\xe2\x80\x89-\xe2\x80\x89pi) should be the same before and after the relocation. If it was negative/positive/zero, it should still be negative/positive/zero respectively. This condition should be satisfied for all triples of indices (i,\xe2\x80\x89j,\xe2\x80\x89k), possibly equal to each other or different than 1. Additionally, Limak isn\'t allowed to build the house at the point where some other house already exists (but it can be the point where his old house was).In the formula above, we define the difference and the cross product of points (ax,\xe2\x80\x89ay) and (bx,\xe2\x80\x89by) as: (ax,\xe2\x80\x89ay)\xe2\x80\x89-\xe2\x80\x89(bx,\xe2\x80\x89by)\xe2\x80\x89=\xe2\x80\x89(ax\xe2\x80\x89-\xe2\x80\x89bx,\xe2\x80\x89ay\xe2\x80\x89-\xe2\x80\x89by),\xe2\x80\x89 (ax,\xe2\x80\x89ay)\xe2\x80\x89\xc3\x97\xe2\x80\x89(bx,\xe2\x80\x89by)\xe2\x80\x89=\xe2\x80\x89ax\xc2\xb7by\xe2\x80\x89-\xe2\x80\x89ay\xc2\xb7bx.Consider a set of possible new placements of Limak\'s house. Your task is to find the area of that set of points.Formally, let\'s say that Limak chooses the new placement randomly (each coordinate is chosen independently uniformly at random from the interval [\xe2\x80\x89-\xe2\x80\x89106,\xe2\x80\x89106]). Let p denote the probability of getting the allowed placement of new house. Let S denote the area of Bearland (S\xe2\x80\x89=\xe2\x80\x894\xc2\xb71012). Your task is to find p\xc2\xb7S." 3300
771E "Bear and Rectangle Strips" dp,greedy "Limak has a grid that consists of 2 rows and n columns. The j-th cell in the i-th row contains an integer ti,\xe2\x80\x89j which can be positive, negative or zero.A non-empty rectangle of cells is called nice if and only if the sum of numbers in its cells is equal to 0.Limak wants to choose some nice rectangles and give them to his friends, as gifts. No two chosen rectangles should share a cell. What is the maximum possible number of nice rectangles Limak can choose?" 3000
771D "Bear and Company" dp "Bear Limak prepares problems for a programming competition. Of course, it would be unprofessional to mention the sponsor name in the statement. Limak takes it seriously and he is going to change some words. To make it still possible to read, he will try to modify each word as little as possible.Limak has a string s that consists of uppercase English letters. In one move he can swap two adjacent letters of the string. For example, he can transform a string ""ABBC"" into ""BABC"" or ""ABCB"" in one move.Limak wants to obtain a string without a substring ""VK"" (i.e. there should be no letter \'V\' immediately followed by letter \'K\'). It can be easily proved that it\'s possible for any initial string s.What is the minimum possible number of moves Limak can do?" 2500
771C "Bear and Tree Jumps" "dfs and similar,dp,trees" "A tree is an undirected connected graph without cycles. The distance between two vertices is the number of edges in a simple path between them.Limak is a little polar bear. He lives in a tree that consists of n vertices, numbered 1 through n.Limak recently learned how to jump. He can jump from a vertex to any vertex within distance at most k.For a pair of vertices (s,\xe2\x80\x89t) we define f(s,\xe2\x80\x89t) as the minimum number of jumps Limak needs to get from s to t. Your task is to find the sum of f(s,\xe2\x80\x89t) over all pairs of vertices (s,\xe2\x80\x89t) such that s\xe2\x80\x89<\xe2\x80\x89t." 2100
771B "Bear and Different Names" "constructive algorithms,greedy" "In the army, it isn\'t easy to form a group of soldiers that will be effective on the battlefield. The communication is crucial and thus no two soldiers should share a name (what would happen if they got an order that Bob is a scouter, if there are two Bobs?).A group of soldiers is effective if and only if their names are different. For example, a group (John, Bob, Limak) would be effective, while groups (Gary, Bob, Gary) and (Alice, Alice) wouldn\'t.You are a spy in the enemy\'s camp. You noticed n soldiers standing in a row, numbered 1 through n. The general wants to choose a group of k consecutive soldiers. For every k consecutive soldiers, the general wrote down whether they would be an effective group or not.You managed to steal the general\'s notes, with n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891, each either ""YES"" or ""NO"".   The string s1 describes a group of soldiers 1 through k (""YES"" if the group is effective, and ""NO"" otherwise).  The string s2 describes a group of soldiers 2 through k\xe2\x80\x89+\xe2\x80\x891.  And so on, till the string sn\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 that describes a group of soldiers n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891 through n. Your task is to find possible names of n soldiers. Names should match the stolen notes. Each name should be a string that consists of between 1 and 10 English letters, inclusive. The first letter should be uppercase, and all other letters should be lowercase. Names don\'t have to be existing names \xe2\x80\x94 it\'s allowed to print ""Xyzzzdj"" or ""T"" for example.Find and print any solution. It can be proved that there always exists at least one solution." 1500
771A "Bear and Friendship Condition" "dfs and similar,dsu,graphs" "Bear Limak examines a social network. Its main functionality is that two members can become friends (then they can talk with each other and share funny pictures).There are n members, numbered 1 through n. m pairs of members are friends. Of course, a member can\'t be a friend with themselves.Let A-B denote that members A and B are friends. Limak thinks that a network is reasonable if and only if the following condition is satisfied: For every three distinct members (X, Y, Z), if X-Y and Y-Z then also X-Z.For example: if Alan and Bob are friends, and Bob and Ciri are friends, then Alan and Ciri should be friends as well.Can you help Limak and check if the network is reasonable? Print ""YES"" or ""NO"" accordingly, without the quotes." 1500
770D "Draw Brackets!" "*special problem,implementation" "A sequence of square brackets is regular if by inserting symbols ""+"" and ""1"" into it, you can get a regular mathematical expression from it. For example, sequences ""[[]][]"", ""[]"" and ""[[][[]]]"" \xe2\x80\x94 are regular, at the same time ""]["", ""[[]"" and ""[[]]]["" \xe2\x80\x94 are irregular. Draw the given sequence using a minimalistic pseudographics in the strip of the lowest possible height \xe2\x80\x94 use symbols \'+\', \'-\' and \'|\'. For example, the sequence ""[[][]][]"" should be represented as: +-        -++- -+    |+- -++- -+||   |||   ||   |||   ||+- -++- -+||   |+-        -++- -+Each bracket should be represented with the hepl of one or more symbols \'|\' (the vertical part) and symbols \'+\' and \'-\' as on the example which is given above.Brackets should be drawn without spaces one by one, only dividing pairs of consecutive pairwise brackets with a single-space bar (so that the two brackets do not visually merge into one symbol). The image should have the minimum possible height. The enclosed bracket is always smaller than the surrounding bracket, but each bracket separately strives to maximize the height of the image. So the pair of final brackets in the example above occupies the entire height of the image.Study carefully the examples below, they adequately explain the condition of the problem. Pay attention that in this problem the answer (the image) is unique." 1400
770C "Online Courses In BSU" "*special problem,dfs and similar,graphs,implementation" "Now you can take online courses in the Berland State University! Polycarp needs to pass k main online courses of his specialty to get a diploma. In total n courses are availiable for the passage.The situation is complicated by the dependence of online courses, for each course there is a list of those that must be passed before starting this online course (the list can be empty, it means that there is no limitation).Help Polycarp to pass the least number of courses in total to get the specialty (it means to pass all main and necessary courses). Write a program which prints the order of courses. Polycarp passes courses consistently, he starts the next course when he finishes the previous one. Each course can\'t be passed more than once." 1500
770B "Maximize Sum of Digits" "*special problem,implementation,math" "Anton has the integer x. He is interested what positive integer, which doesn\'t exceed x, has the maximum sum of digits.Your task is to help Anton and to find the integer that interests him. If there are several such integers, determine the biggest of them." 1300
770A "New Password" "*special problem,implementation" "Innokentiy decides to change the password in the social net ""Contact!"", but he is too lazy to invent a new password by himself. That is why he needs your help. Innokentiy decides that new password should satisfy the following conditions:  the length of the password must be equal to n,  the password should consist only of lowercase Latin letters,  the number of distinct symbols in the password must be equal to k,  any two consecutive symbols in the password must be distinct. Your task is to help Innokentiy and to invent a new password which will satisfy all given conditions." 800
769D "k-Interesting Pairs Of Integers" "*special problem,bitmasks,brute force,meet-in-the-middle" "Vasya has the sequence consisting of n integers. Vasya consider the pair of integers x and y k-interesting, if their binary representation differs from each other exactly in k bits. For example, if k\xe2\x80\x89=\xe2\x80\x892, the pair of integers x\xe2\x80\x89=\xe2\x80\x895 and y\xe2\x80\x89=\xe2\x80\x893 is k-interesting, because their binary representation x=101 and y=011 differs exactly in two bits.Vasya wants to know how many pairs of indexes (i, j) are in his sequence so that i\xe2\x80\x89<\xe2\x80\x89j and the pair of integers ai and aj is k-interesting. Your task is to help Vasya and determine this number." 1700
769C "Cycle In Maze" "*special problem,dfs and similar,graphs,greedy,shortest paths" "The Robot is in a rectangular maze of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. Each cell of the maze is either empty or occupied by an obstacle. The Robot can move between neighboring cells on the side left (the symbol ""L""), right (the symbol ""R""), up (the symbol ""U"") or down (the symbol ""D""). The Robot can move to the cell only if it is empty. Initially, the Robot is in the empty cell.Your task is to find lexicographically minimal Robot\'s cycle with length exactly k, which begins and ends in the cell where the Robot was initially. It is allowed to the Robot to visit any cell many times (including starting).Consider that Robot\'s way is given as a line which consists of symbols ""L"", ""R"", ""U"" and ""D"". For example, if firstly the Robot goes down, then left, then right and up, it means that his way is written as ""DLRU"".In this task you don\'t need to minimize the length of the way. Find the minimum lexicographical (in alphabet order as in the dictionary) line which satisfies requirements above." 1700
769B "News About Credit" "*special problem,greedy,two pointers" "Polycarp studies at the university in the group which consists of n students (including himself). All they are registrated in the social net ""TheContacnt!"".Not all students are equally sociable. About each student you know the value ai \xe2\x80\x94 the maximum number of messages which the i-th student is agree to send per day. The student can\'t send messages to himself. In early morning Polycarp knew important news that the programming credit will be tomorrow. For this reason it is necessary to urgently inform all groupmates about this news using private messages. Your task is to make a plan of using private messages, so that:  the student i sends no more than ai messages (for all i from 1 to n);  all students knew the news about the credit (initially only Polycarp knew it);  the student can inform the other student only if he knows it himself. Let\'s consider that all students are numerated by distinct numbers from 1 to n, and Polycarp always has the number 1.In that task you shouldn\'t minimize the number of messages, the moment of time, when all knew about credit or some other parameters. Find any way how to use private messages which satisfies requirements above." 1200
769A "Year of University Entrance" "*special problem,implementation,sortings" "There is the faculty of Computer Science in Berland. In the social net ""TheContact!"" for each course of this faculty there is the special group whose name equals the year of university entrance of corresponding course of students at the university. Each of students joins the group of his course and joins all groups for which the year of student\'s university entrance differs by no more than x from the year of university entrance of this student, where x \xe2\x80\x94 some non-negative integer. A value x is not given, but it can be uniquely determined from the available data. Note that students don\'t join other groups. You are given the list of groups which the student Igor joined. According to this information you need to determine the year of Igor\'s university entrance." 800
768G "The Winds of Winter" "binary search,data structures" "Given a rooted tree with n nodes. The Night King removes exactly one node from the tree and all the edges associated with it. Doing this splits the tree and forms a forest. The node which is removed is not a part of the forest.The root of a tree in the forest is the node in that tree which does not have a parent. We define the strength of the forest as the size of largest tree in forest.Jon Snow wants to minimize the strength of the forest. To do this he can perform the following operation at most once.He removes the edge between a node and its parent and inserts a new edge between this node and any other node in forest such that the total number of trees in forest remain same.For each node v you need to find the minimum value of strength of the forest formed when node v is removed." 3300
768F "Barrels and boxes" "brute force,combinatorics,math,number theory,probabilities" "Tarly has two different type of items, food boxes and wine barrels. There are f food boxes and w wine barrels. Tarly stores them in various stacks and each stack can consist of either food boxes or wine barrels but not both. The stacks are placed in a line such that no two stacks of food boxes are together and no two stacks of wine barrels are together.The height of a stack is defined as the number of items in the stack. Two stacks are considered different if either their heights are different or one of them contains food and other contains wine.Jon Snow doesn\'t like an arrangement if any stack of wine barrels has height less than or equal to h. What is the probability that Jon Snow will like the arrangement if all arrangement are equiprobably?Two arrangement of stacks are considered different if exists such i, that i-th stack of one arrangement is different from the i-th stack of the other arrangement." 2300
768E "Game of Stones" bitmasks,dp,games "Sam has been teaching Jon the Game of Stones to sharpen his mind and help him devise a strategy to fight the white walkers. The rules of this game are quite simple:  The game starts with n piles of stones indexed from 1 to n. The i-th pile contains si stones. The players make their moves alternatively. A move is considered as removal of some number of stones from a pile. Removal of 0 stones does not count as a move. The player who is unable to make a move loses.Now Jon believes that he is ready for battle, but Sam does not think so. To prove his argument, Sam suggested that they play a modified version of the game.In this modified version, no move can be made more than once on a pile. For example, if 4 stones are removed from a pile, 4 stones cannot be removed from that pile again.Sam sets up the game and makes the first move. Jon believes that Sam is just trying to prevent him from going to battle. Jon wants to know if he can win if both play optimally." 2100
768D "Jon and Orbs" dp,math,probabilities "Jon Snow is on the lookout for some orbs required to defeat the white walkers. There are k different types of orbs and he needs at least one of each. One orb spawns daily at the base of a Weirwood tree north of the wall. The probability of this orb being of any kind is equal. As the north of wall is full of dangers, he wants to know the minimum number of days he should wait before sending a ranger to collect the orbs such that the probability of him getting at least one of each kind of orb is at least , where \xce\xb5\xe2\x80\x89<\xe2\x80\x8910\xe2\x80\x89-\xe2\x80\x897.To better prepare himself, he wants to know the answer for q different values of pi. Since he is busy designing the battle strategy with Sam, he asks you for your help." 2200
768C "Jon Snow and his Favourite Number" "brute force,dp,implementation,sortings" "Jon Snow now has to fight with White Walkers. He has n rangers, each of which has his own strength. Also Jon Snow has his favourite number x. Each ranger can fight with a white walker only if the strength of the white walker equals his strength. He however thinks that his rangers are weak and need to improve. Jon now thinks that if he takes the bitwise XOR of strengths of some of rangers with his favourite number x, he might get soldiers of high strength. So, he decided to do the following operation k times:  Arrange all the rangers in a straight line in the order of increasing strengths. Take the bitwise XOR (is written as ) of the strength of each alternate ranger with x and update it\'s strength. Suppose, Jon has 5 rangers with strengths [9,\xe2\x80\x897,\xe2\x80\x8911,\xe2\x80\x8915,\xe2\x80\x895] and he performs the operation 1 time with x\xe2\x80\x89=\xe2\x80\x892. He first arranges them in the order of their strengths, [5,\xe2\x80\x897,\xe2\x80\x899,\xe2\x80\x8911,\xe2\x80\x8915]. Then he does the following:  The strength of first ranger is updated to , i.e. 7. The strength of second ranger remains the same, i.e. 7. The strength of third ranger is updated to , i.e. 11. The strength of fourth ranger remains the same, i.e. 11. The strength of fifth ranger is updated to , i.e. 13. The new strengths of the 5 rangers are [7,\xe2\x80\x897,\xe2\x80\x8911,\xe2\x80\x8911,\xe2\x80\x8913]Now, Jon wants to know the maximum and minimum strength of the rangers after performing the above operations k times. He wants your help for this task. Can you help him?" 1800
768B "Code For 1" "constructive algorithms,dfs and similar,divide and conquer" "Jon fought bravely to rescue the wildlings who were attacked by the white-walkers at Hardhome. On his arrival, Sam tells him that he wants to go to Oldtown to train at the Citadel to become a maester, so he can return and take the deceased Aemon\'s place as maester of Castle Black. Jon agrees to Sam\'s proposal and Sam sets off his journey to the Citadel. However becoming a trainee at the Citadel is not a cakewalk and hence the maesters at the Citadel gave Sam a problem to test his eligibility. Initially Sam has a list with a single element n. Then he has to perform certain operations on this list. In each operation Sam must remove any element x, such that x\xe2\x80\x89>\xe2\x80\x891, from the list and insert at the same position , ,  sequentially. He must continue with these operations until all the elements in the list are either 0 or 1.Now the masters want the total number of 1s in the range l to r (1-indexed). Sam wants to become a maester but unfortunately he cannot solve this problem. Can you help Sam to pass the eligibility test?" 1600
768A "Oath of the Night\'s Watch" "constructive algorithms,sortings" """Night gathers, and now my watch begins. It shall not end until my death. I shall take no wife, hold no lands, father no children. I shall wear no crowns and win no glory. I shall live and die at my post. I am the sword in the darkness. I am the watcher on the walls. I am the shield that guards the realms of men. I pledge my life and honor to the Night\'s Watch, for this night and all the nights to come."" \xe2\x80\x94 The Night\'s Watch oath.With that begins the watch of Jon Snow. He is assigned the task to support the stewards.This time he has n stewards with him whom he has to provide support. Each steward has his own strength. Jon Snow likes to support a steward only if there exists at least one steward who has strength strictly less than him and at least one steward who has strength strictly greater than him.Can you find how many stewards will Jon support?" 900
767E Change-free greedy "Student Arseny likes to plan his life for n days ahead. He visits a canteen every day and he has already decided what he will order in each of the following n days. Prices in the canteen do not change and that means Arseny will spend ci rubles during the i-th day.There are 1-ruble coins and 100-ruble notes in circulation. At this moment, Arseny has m coins and a sufficiently large amount of notes (you can assume that he has an infinite amount of them). Arseny loves modern technologies, so he uses his credit card everywhere except the canteen, but he has to pay in cash in the canteen because it does not accept cards.Cashier always asks the student to pay change-free. However, it\'s not always possible, but Arseny tries to minimize the dissatisfaction of the cashier. Cashier\'s dissatisfaction for each of the days is determined by the total amount of notes and coins in the change. To be precise, if the cashier gives Arseny x notes and coins on the i-th day, his dissatisfaction for this day equals x\xc2\xb7wi. Cashier always gives change using as little coins and notes as possible, he always has enough of them to be able to do this.  ""Caution! Angry cashier"" Arseny wants to pay in such a way that the total dissatisfaction of the cashier for n days would be as small as possible. Help him to find out how he needs to pay in each of the n days!Note that Arseny always has enough money to pay, because he has an infinite amount of notes. Arseny can use notes and coins he received in change during any of the following days." 2400
767D "Cartons of milk" "binary search,data structures,greedy,sortings,two pointers" "Olya likes milk very much. She drinks k cartons of milk each day if she has at least k and drinks all of them if she doesn\'t. But there\'s an issue \xe2\x80\x94 expiration dates. Each carton has a date after which you can\'t drink it (you still can drink it exactly at the date written on the carton). Due to this, if Olya\'s fridge contains a carton past its expiry date, she throws it away.Olya hates throwing out cartons, so when she drinks a carton, she chooses the one which expires the fastest. It\'s easy to understand that this strategy minimizes the amount of cartons thrown out and lets her avoid it if it\'s even possible.  Milk. Best before: 20.02.2017. The main issue Olya has is the one of buying new cartons. Currently, there are n cartons of milk in Olya\'s fridge, for each one an expiration date is known (how soon does it expire, measured in days). In the shop that Olya visited there are m cartons, and the expiration date is known for each of those cartons as well.Find the maximum number of cartons Olya can buy so that she wouldn\'t have to throw away any cartons. Assume that Olya drank no cartons today." 2100
767C Garland "dfs and similar,graphs,greedy,trees" "Once at New Year Dima had a dream in which he was presented a fairy garland. A garland is a set of lamps, some pairs of which are connected by wires. Dima remembered that each two lamps in the garland were connected directly or indirectly via some wires. Furthermore, the number of wires was exactly one less than the number of lamps.There was something unusual about the garland. Each lamp had its own brightness which depended on the temperature of the lamp. Temperatures could be positive, negative or zero. Dima has two friends, so he decided to share the garland with them. He wants to cut two different wires so that the garland breaks up into three parts. Each part of the garland should shine equally, i. e. the sums of lamps\' temperatures should be equal in each of the parts. Of course, each of the parts should be non-empty, i. e. each part should contain at least one lamp.  Help Dima to find a suitable way to cut the garland, or determine that this is impossible.While examining the garland, Dima lifted it up holding by one of the lamps. Thus, each of the lamps, except the one he is holding by, is now hanging on some wire. So, you should print two lamp ids as the answer which denote that Dima should cut the wires these lamps are hanging on. Of course, the lamp Dima is holding the garland by can\'t be included in the answer." 2000
767B "The Queue" "brute force,greedy" "Finally! Vasya have come of age and that means he can finally get a passport! To do it, he needs to visit the passport office, but it\'s not that simple. There\'s only one receptionist at the passport office and people can queue up long before it actually opens. Vasya wants to visit the passport office tomorrow.He knows that the receptionist starts working after ts minutes have passed after midnight and closes after tf minutes have passed after midnight (so that (tf\xe2\x80\x89-\xe2\x80\x891) is the last minute when the receptionist is still working). The receptionist spends exactly t minutes on each person in the queue. If the receptionist would stop working within t minutes, he stops serving visitors (other than the one he already serves). Vasya also knows that exactly n visitors would come tomorrow. For each visitor Vasya knows the point of time when he would come to the passport office. Each visitor queues up and doesn\'t leave until he was served. If the receptionist is free when a visitor comes (in particular, if the previous visitor was just served and the queue is empty), the receptionist begins to serve the newcomer immediately.  ""Reception 1"" For each visitor, the point of time when he would come to the passport office is positive. Vasya can come to the office at the time zero (that is, at midnight) if he needs so, but he can come to the office only at integer points of time. If Vasya arrives at the passport office at the same time with several other visitors, he yields to them and stand in the queue after the last of them.Vasya wants to come at such point of time that he will be served by the receptionist, and he would spend the minimum possible time in the queue. Help him!" 2100
767A Snacktower "data structures,implementation" "According to an old legeng, a long time ago Ankh-Morpork residents did something wrong to miss Fortune, and she cursed them. She said that at some time n snacks of distinct sizes will fall on the city, and the residents should build a Snacktower of them by placing snacks one on another. Of course, big snacks should be at the bottom of the tower, while small snacks should be at the top.Years passed, and once different snacks started to fall onto the city, and the residents began to build the Snacktower.  However, they faced some troubles. Each day exactly one snack fell onto the city, but their order was strange. So, at some days the residents weren\'t able to put the new stack on the top of the Snacktower: they had to wait until all the bigger snacks fell. Of course, in order to not to anger miss Fortune again, the residents placed each snack on the top of the tower immediately as they could do it.Write a program that models the behavior of Ankh-Morpork residents." 1100
766E "Mahmoud and a xor trip" "bitmasks,constructive algorithms,data structures,dfs and similar,dp,math,trees" "Mahmoud and Ehab live in a country with n cities numbered from 1 to n and connected by n\xe2\x80\x89-\xe2\x80\x891 undirected roads. It\'s guaranteed that you can reach any city from any other using these roads. Each city has a number ai attached to it.We define the distance from city x to city y as the xor of numbers attached to the cities on the path from x to y (including both x and y). In other words if values attached to the cities on the path from x to y form an array p of length l then the distance between them is , where  is bitwise xor operation.Mahmoud and Ehab want to choose two cities and make a journey from one to another. The index of the start city is always less than or equal to the index of the finish city (they may start and finish in the same city and in this case the distance equals the number attached to that city). They can\'t determine the two cities so they try every city as a start and every city with greater index as a finish. They want to know the total distance between all pairs of cities." 2100
766D "Mahmoud and a Dictionary" "data structures,dfs and similar,dp,dsu,graphs" "Mahmoud wants to write a new dictionary that contains n words and relations between them. There are two types of relations: synonymy (i. e. the two words mean the same) and antonymy (i. e. the two words mean the opposite). From time to time he discovers a new relation between two words.He know that if two words have a relation between them, then each of them has relations with the words that has relations with the other. For example, if like means love and love is the opposite of hate, then like is also the opposite of hate. One more example: if love is the opposite of hate and hate is the opposite of like, then love means like, and so on.Sometimes Mahmoud discovers a wrong relation. A wrong relation is a relation that makes two words equal and opposite at the same time. For example if he knows that love means like and like is the opposite of hate, and then he figures out that hate means like, the last relation is absolutely wrong because it makes hate and like opposite and have the same meaning at the same time.After Mahmoud figured out many relations, he was worried that some of them were wrong so that they will make other relations also wrong, so he decided to tell every relation he figured out to his coder friend Ehab and for every relation he wanted to know is it correct or wrong, basing on the previously discovered relations. If it is wrong he ignores it, and doesn\'t check with following relations.After adding all relations, Mahmoud asked Ehab about relations between some words based on the information he had given to him. Ehab is busy making a Codeforces round so he asked you for help." 2000
766C "Mahmoud and a Message" "brute force,dp,greedy,strings" "Mahmoud wrote a message s of length n. He wants to send it as a birthday present to his friend Moaz who likes strings. He wrote it on a magical paper but he was surprised because some characters disappeared while writing the string. That\'s because this magical paper doesn\'t allow character number i in the English alphabet to be written on it in a string of length more than ai. For example, if a1\xe2\x80\x89=\xe2\x80\x892 he can\'t write character \'a\' on this paper in a string of length 3 or more. String ""aa"" is allowed while string ""aaa"" is not.Mahmoud decided to split the message into some non-empty substrings so that he can write every substring on an independent magical paper and fulfill the condition. The sum of their lengths should be n and they shouldn\'t overlap. For example, if a1\xe2\x80\x89=\xe2\x80\x892 and he wants to send string ""aaa"", he can split it into ""a"" and ""aa"" and use 2 magical papers, or into ""a"", ""a"" and ""a"" and use 3 magical papers. He can\'t split it into ""aa"" and ""aa"" because the sum of their lengths is greater than n. He can split the message into single string if it fulfills the conditions.A substring of string s is a string that consists of some consecutive characters from string s, strings ""ab"", ""abc"" and ""b"" are substrings of string ""abc"", while strings ""acb"" and ""ac"" are not. Any string is a substring of itself.While Mahmoud was thinking of how to split the message, Ehab told him that there are many ways to split it. After that Mahmoud asked you three questions:   How many ways are there to split the string into substrings such that every substring fulfills the condition of the magical paper, the sum of their lengths is n and they don\'t overlap? Compute the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.  What is the maximum length of a substring that can appear in some valid splitting?  What is the minimum number of substrings the message can be spit in? Two ways are considered different, if the sets of split positions differ. For example, splitting ""aa|a"" and ""a|aa"" are considered different splittings of message ""aaa""." 1700
766B "Mahmoud and a Triangle" "constructive algorithms,geometry,greedy,math,number theory,sortings" "Mahmoud has n line segments, the i-th of them has length ai. Ehab challenged him to use exactly 3 line segments to form a non-degenerate triangle. Mahmoud doesn\'t accept challenges unless he is sure he can win, so he asked you to tell him if he should accept the challenge. Given the lengths of the line segments, check if he can choose exactly 3 of them to form a non-degenerate triangle.Mahmoud should use exactly 3 line segments, he can\'t concatenate two line segments or change any length. A non-degenerate triangle is a triangle with positive area." 1000
766A "Mahmoud and Longest Uncommon Subsequence" "constructive algorithms,strings" "While Mahmoud and Ehab were practicing for IOI, they found a problem which name was Longest common subsequence. They solved it, and then Ehab challenged Mahmoud with another problem.Given two strings a and b, find the length of their longest uncommon subsequence, which is the longest string that is a subsequence of one of them and not a subsequence of the other.A subsequence of some string is a sequence of characters that appears in the same order in the string, The appearances don\'t have to be consecutive, for example, strings ""ac"", ""bc"", ""abc"" and ""a"" are subsequences of string ""abc"" while strings ""abbc"" and ""acb"" are not. The empty string is a subsequence of any string. Any string is a subsequence of itself." 1000
765G "Math, math everywhere" "brute force,dp,math,meet-in-the-middle,number theory" "If you have gone that far, you\'ll probably skip unnecessary legends anyway...You are given a binary string  and an integer . Find the number of integers k, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89<\xe2\x80\x89N, such that for all i\xe2\x80\x89=\xe2\x80\x890, 1, ..., m\xe2\x80\x89-\xe2\x80\x891  Print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 3200
765F Souvenirs "data structures" "Artsem is on vacation and wants to buy souvenirs for his two teammates. There are n souvenir shops along the street. In i-th shop Artsem can buy one souvenir for ai dollars, and he cannot buy more than one souvenir in one shop. He doesn\'t want to introduce envy in his team, so he wants to buy two souvenirs with least possible difference in price.Artsem has visited the shopping street m times. For some strange reason on the i-th day only shops with numbers from li to ri were operating (weird? yes it is, but have you ever tried to come up with a reasonable legend for a range query problem?). For each visit, Artsem wants to know the minimum possible difference in prices of two different souvenirs he can buy in the opened shops.In other words, for each Artsem\'s visit you should find the minimum possible value of |as\xe2\x80\x89-\xe2\x80\x89at| where li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89s,\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri, s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t." 3100
765E "Tree Folding" "dfs and similar,dp,greedy,implementation,trees" "Vanya wants to minimize a tree. He can perform the following operation multiple times: choose a vertex v, and two disjoint (except for v) paths of equal length a0\xe2\x80\x89=\xe2\x80\x89v, a1, ..., ak, and b0\xe2\x80\x89=\xe2\x80\x89v, b1, ..., bk. Additionally, vertices a1, ..., ak, b1, ..., bk must not have any neighbours in the tree other than adjacent vertices of corresponding paths. After that, one of the paths may be merged into the other, that is, the vertices b1, ..., bk can be effectively erased:  Help Vanya determine if it possible to make the tree into a path via a sequence of described operations, and if the answer is positive, also determine the shortest length of such path." 2200
765D "Artsem and Saunders" "constructive algorithms,dsu,math" "Artsem has a friend Saunders from University of Chicago. Saunders presented him with the following problem.Let [n] denote the set {1,\xe2\x80\x89...,\xe2\x80\x89n}. We will also write f:\xe2\x80\x89[x]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[y] when a function f is defined in integer points 1, ..., x, and all its values are integers from 1 to y.Now then, you are given a function f:\xe2\x80\x89[n]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[n]. Your task is to find a positive integer m, and two functions g:\xe2\x80\x89[n]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[m], h:\xe2\x80\x89[m]\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89[n], such that g(h(x))\xe2\x80\x89=\xe2\x80\x89x for all , and h(g(x))\xe2\x80\x89=\xe2\x80\x89f(x) for all , or determine that finding these is impossible." 1700
765C "Table Tennis Game 2" math "Misha and Vanya have played several table tennis sets. Each set consists of several serves, each serve is won by one of the players, he receives one point and the loser receives nothing. Once one of the players scores exactly k points, the score is reset and a new set begins.Across all the sets Misha scored a points in total, and Vanya scored b points. Given this information, determine the maximum number of sets they could have played, or that the situation is impossible.Note that the game consisted of several complete sets." 1200
765B "Code obfuscation" greedy,implementation,strings "Kostya likes Codeforces contests very much. However, he is very disappointed that his solutions are frequently hacked. That\'s why he decided to obfuscate (intentionally make less readable) his code before upcoming contest.To obfuscate the code, Kostya first looks at the first variable name used in his program and replaces all its occurrences with a single symbol a, then he looks at the second variable name that has not been replaced yet, and replaces all its occurrences with b, and so on. Kostya is well-mannered, so he doesn\'t use any one-letter names before obfuscation. Moreover, there are at most 26 unique identifiers in his programs.You are given a list of identifiers of some program with removed spaces and line breaks. Check if this program can be a result of Kostya\'s obfuscation." 1100
765A "Neverending competitions" implementation,math "There are literally dozens of snooker competitions held each year, and team Jinotega tries to attend them all (for some reason they prefer name ""snookah"")! When a competition takes place somewhere far from their hometown, Ivan, Artsem and Konstantin take a flight to the contest and back.Jinotega\'s best friends, team Base have found a list of their itinerary receipts with information about departure and arrival airports. Now they wonder, where is Jinotega now: at home or at some competition far away? They know that:   this list contains all Jinotega\'s flights in this year (in arbitrary order),  Jinotega has only flown from his hometown to a snooker contest and back,  after each competition Jinotega flies back home (though they may attend a competition in one place several times),  and finally, at the beginning of the year Jinotega was at home. Please help them to determine Jinotega\'s location!" 900
764B "Timofey and cubes" "constructive algorithms,implementation" "Young Timofey has a birthday today! He got kit of n cubes as a birthday present from his parents. Every cube has a number ai, which is written on it. Timofey put all the cubes in a row and went to unpack other presents.In this time, Timofey\'s elder brother, Dima reordered the cubes using the following rule. Suppose the cubes are numbered from 1 to n in their order. Dima performs several steps, on step i he reverses the segment of cubes from i-th to (n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891)-th. He does this while i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891.After performing the operations Dima went away, being very proud of himself. When Timofey returned to his cubes, he understood that their order was changed. Help Timofey as fast as you can and save the holiday \xe2\x80\x94 restore the initial order of the cubes using information of their current location." 900
764A "Taymyr is calling you" "brute force,implementation,math" "Comrade Dujikov is busy choosing artists for Timofey\'s birthday and is recieving calls from Taymyr from Ilia-alpinist.Ilia-alpinist calls every n minutes, i.e. in minutes n, 2n, 3n and so on. Artists come to the comrade every m minutes, i.e. in minutes m, 2m, 3m and so on. The day is z minutes long, i.e. the day consists of minutes 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89z. How many artists should be killed so that there are no artists in the room when Ilia calls? Consider that a call and a talk with an artist take exactly one minute." 800
763E "Timofey and our friends animals" "data structures,divide and conquer,dsu" "After his birthday party, Timofey went to his favorite tree alley in a park. He wants to feed there his favorite birds \xe2\x80\x94 crows.It\'s widely known that each tree is occupied by a single crow family. The trees in the alley form a row and are numbered from 1 to n. Some families are friends to each other. For some reasons, two families can be friends only if they live not too far from each other, more precisely, there is no more than k\xe2\x80\x89-\xe2\x80\x891 trees between any pair of friend families. Formally, the family on the u-th tree and the family on the v-th tree can be friends only if |u\xe2\x80\x89-\xe2\x80\x89v|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k holds.One of the friendship features is that if some family learns that Timofey is feeding crows somewhere, it notifies about this all friend families. Thus, after Timofey starts to feed crows under some tree, all the families that are friends to the family living on this tree, as well as their friends and so on, fly to the feeding place. Of course, the family living on the tree also comes to the feeding place.Today Timofey came to the alley and noticed that all the families that live on trees with numbers strictly less than l or strictly greater than r have flown away. Thus, it is not possible to pass the information about feeding through them. Moreover, there is no need to feed them. Help Timofey to learn what is the minimum number of trees under which he has to feed crows so that all the families that have remained will get the information about feeding. You are given several situations, described by integers l and r, you need to calculate the answer for all of them." 2900
763D "Timofey and a flat tree" "data structures,graphs,hashing,shortest paths,trees" "Little Timofey has a big tree \xe2\x80\x94 an undirected connected graph with n vertices and no simple cycles. He likes to walk along it. His tree is flat so when he walks along it he sees it entirely. Quite naturally, when he stands on a vertex, he sees the tree as a rooted tree with the root in this vertex.Timofey assumes that the more non-isomorphic subtrees are there in the tree, the more beautiful the tree is. A subtree of a vertex is a subgraph containing this vertex and all its descendants. You should tell Timofey the vertex in which he should stand to see the most beautiful rooted tree.Subtrees of vertices u and v are isomorphic if the number of children of u equals the number of children of v, and their children can be arranged in such a way that the subtree of the first son of u is isomorphic to the subtree of the first son of v, the subtree of the second son of u is isomorphic to the subtree of the second son of v, and so on. In particular, subtrees consisting of single vertex are isomorphic to each other." 2900
763C "Timofey and remoduling" "brute force,implementation,math,number theory" "Little Timofey likes integers a lot. Unfortunately, he is very young and can\'t work with very big integers, so he does all the operations modulo his favorite prime m. Also, Timofey likes to look for arithmetical progressions everywhere.One of his birthday presents was a sequence of distinct integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Timofey wants to know whether he can rearrange the elements of the sequence so that is will be an arithmetical progression modulo m, or not.Arithmetical progression modulo m of length n with first element x and difference d is sequence of integers x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89d,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x892d,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89(n\xe2\x80\x89-\xe2\x80\x891)\xc2\xb7d, each taken modulo m." 2600
763B "Timofey and rectangles" "constructive algorithms,geometry" "One of Timofey\'s birthday presents is a colourbook in a shape of an infinite plane. On the plane n rectangles with sides parallel to coordinate axes are situated. All sides of the rectangles have odd length. Rectangles cannot intersect, but they can touch each other.Help Timofey to color his rectangles in 4 different colors in such a way that every two rectangles touching each other by side would have different color, or determine that it is impossible.Two rectangles intersect if their intersection has positive area. Two rectangles touch by sides if there is a pair of sides such that their intersection has non-zero length  The picture corresponds to the first example" 2100
763A "Timofey and a tree" "dfs and similar,dp,dsu,graphs,implementation,trees" "Each New Year Timofey and his friends cut down a tree of n vertices and bring it home. After that they paint all the n its vertices, so that the i-th vertex gets color ci.Now it\'s time for Timofey birthday, and his mother asked him to remove the tree. Timofey removes the tree in the following way: he takes some vertex in hands, while all the other vertices move down so that the tree becomes rooted at the chosen vertex. After that Timofey brings the tree to a trash can.Timofey doesn\'t like it when many colors are mixing together. A subtree annoys him if there are vertices of different color in it. Timofey wants to find a vertex which he should take in hands so that there are no subtrees that annoy him. He doesn\'t consider the whole tree as a subtree since he can\'t see the color of the root vertex.A subtree of some vertex is a subgraph containing that vertex and all its descendants.Your task is to determine if there is a vertex, taking which in hands Timofey wouldn\'t be annoyed." 1600
762F "Tree nesting" combinatorics,graphs,trees "You are given two trees (connected undirected acyclic graphs) S and T.Count the number of subtrees (connected subgraphs) of S that are isomorphic to tree T. Since this number can get quite large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897.Two subtrees of tree S are considered different, if there exists a vertex in S that belongs to exactly one of them.Tree G is called isomorphic to tree H if there exists a bijection f from the set of vertices of G to the set of vertices of H that has the following property: if there is an edge between vertices A and B in tree G, then there must be an edge between vertices f(A) and f(B) in tree H. And vice versa \xe2\x80\x94 if there is an edge between vertices A and B in tree H, there must be an edge between f\xe2\x80\x89-\xe2\x80\x891(A) and f\xe2\x80\x89-\xe2\x80\x891(B) in tree G." 2800
762E "Radio stations" "binary search,data structures" "In the lattice points of the coordinate line there are n radio stations, the i-th of which is described by three integers:  xi \xe2\x80\x94 the coordinate of the i-th station on the line,  ri \xe2\x80\x94 the broadcasting range of the i-th station,  fi \xe2\x80\x94 the broadcasting frequency of the i-th station. We will say that two radio stations with numbers i and j reach each other, if the broadcasting range of each of them is more or equal to the distance between them. In other words min(ri,\xe2\x80\x89rj)\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89|xi\xe2\x80\x89-\xe2\x80\x89xj|.Let\'s call a pair of radio stations (i,\xe2\x80\x89j) bad if i\xe2\x80\x89<\xe2\x80\x89j, stations i and j reach each other and they are close in frequency, that is, |fi\xe2\x80\x89-\xe2\x80\x89fj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k.Find the number of bad pairs of radio stations." 2200
762D "Maximum path" dp,greedy,implementation "You are given a rectangular table 3\xe2\x80\x89\xc3\x97\xe2\x80\x89n. Each cell contains an integer. You can move from one cell to another if they share a side.Find such path from the upper left cell to the bottom right cell of the table that doesn\'t visit any of the cells twice, and the sum of numbers written in the cells of this path is maximum possible." 2300
762C "Two strings" "binary search,hashing,strings,two pointers" "You are given two strings a and b. You have to remove the minimum possible number of consecutive (standing one after another) characters from string b in such a way that it becomes a subsequence of string a. It can happen that you will not need to remove any characters at all, or maybe you will have to remove all of the characters from b and make it empty.Subsequence of string s is any such string that can be obtained by erasing zero or more characters (not necessarily consecutive) from string s." 2100
762B "USB vs. PS/2" "greedy,implementation,sortings,two pointers" "Due to the increase in the number of students of Berland State University it was decided to equip a new computer room. You were given the task of buying mouses, and you have to spend as little as possible. After all, the country is in crisis!The computers bought for the room were different. Some of them had only USB ports, some \xe2\x80\x94 only PS/2 ports, and some had both options.You have found a price list of a certain computer shop. In it, for m mouses it is specified the cost and the type of the port that is required to plug the mouse in (USB or PS/2). Each mouse from the list can be bought at most once.You want to buy some set of mouses from the given price list in such a way so that you maximize the number of computers equipped with mouses (it is not guaranteed that you will be able to equip all of the computers), and in case of equality of this value you want to minimize the total cost of mouses you will buy." 1400
762A "k-th divisor" "math,number theory" "You are given two integers n and k. Find k-th smallest divisor of n, or report that it doesn\'t exist.Divisor of n is any such natural number, that n can be divided by it without remainder." 1400
761F "Dasha and Photos" "brute force,data structures,dp,implementation" "Dasha decided to have a rest after solving the problem D and began to look photos from previous competitions.Let\'s call photos as the matrix with the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, which consists of lowercase English letters.Some k photos especially interested her, because they can be received from photo-template by painting a rectangular area in a certain color. Let\'s call such photos special.   More formally the i-th special photo is received from the photo-template by replacing all characters on some rectangle with upper left corner of the cell with coordinates (ai,\xe2\x80\x89bi) and lower right corner in the cell with coordinates (ci,\xe2\x80\x89di) to the symbol ei.Dasha asks you to find the special photo so that the total distance from it to all other special photos is minimum. And calculate this distance.Determine the distance between two photos as the sum of distances between all corresponding letters. The distance between two letters is the difference module of their positions in the alphabet. For example, the distance between letters \'h\' and \'m\' equals |8\xe2\x80\x89-\xe2\x80\x8913|\xe2\x80\x89=\xe2\x80\x895, because the letter \'h\' is the 8-th in the alphabet, the letter \'m\' is the 13-th." 2600
761E "Dasha and Puzzle" "constructive algorithms,dfs and similar,graphs,greedy,trees" "Dasha decided to have a rest after solving the problem. She had been ready to start her favourite activity \xe2\x80\x94 origami, but remembered the puzzle that she could not solve.   The tree is a non-oriented connected graph without cycles. In particular, there always are n\xe2\x80\x89-\xe2\x80\x891 edges in a tree with n vertices.The puzzle is to position the vertices at the points of the Cartesian plane with integral coordinates, so that the segments between the vertices connected by edges are parallel to the coordinate axes. Also, the intersection of segments is allowed only at their ends. Distinct vertices should be placed at different points. Help Dasha to find any suitable way to position the tree vertices on the plane.It is guaranteed that if it is possible to position the tree vertices on the plane without violating the condition which is given above, then you can do it by using points with integral coordinates which don\'t exceed 1018 in absolute value." 2000
761D "Dasha and Very Difficult Problem" "binary search,brute force,constructive algorithms,greedy,sortings" "Dasha logged into the system and began to solve problems. One of them is as follows:Given two sequences a and b of length n each you need to write a sequence c of length n, the i-th element of which is calculated as follows: ci\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x89ai.About sequences a and b we know that their elements are in the range from l to r. More formally, elements satisfy the following conditions: l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. About sequence c we know that all its elements are distinct.  Dasha wrote a solution to that problem quickly, but checking her work on the standard test was not so easy. Due to an error in the test system only the sequence a and the compressed sequence of the sequence c were known from that test.Let\'s give the definition to a compressed sequence. A compressed sequence of sequence c of length n is a sequence p of length n, so that pi equals to the number of integers which are less than or equal to ci in the sequence c. For example, for the sequence c\xe2\x80\x89=\xe2\x80\x89[250,\xe2\x80\x89200,\xe2\x80\x89300,\xe2\x80\x89100,\xe2\x80\x8950] the compressed sequence will be p\xe2\x80\x89=\xe2\x80\x89[4,\xe2\x80\x893,\xe2\x80\x895,\xe2\x80\x892,\xe2\x80\x891]. Pay attention that in c all integers are distinct. Consequently, the compressed sequence contains all integers from 1 to n inclusively.Help Dasha to find any sequence b for which the calculated compressed sequence of sequence c is correct." 1700
761C "Dasha and Password" "brute force,dp,implementation" "After overcoming the stairs Dasha came to classes. She needed to write a password to begin her classes. The password is a string of length n which satisfies the following requirements:  There is at least one digit in the string,  There is at least one lowercase (small) letter of the Latin alphabet in the string,  There is at least one of three listed symbols in the string: \'#\', \'*\', \'&\'.   Considering that these are programming classes it is not easy to write the password.For each character of the password we have a fixed string of length m, on each of these n strings there is a pointer on some character. The i-th character displayed on the screen is the pointed character in the i-th string. Initially, all pointers are on characters with indexes 1 in the corresponding strings (all positions are numbered starting from one).During one operation Dasha can move a pointer in one string one character to the left or to the right. Strings are cyclic, it means that when we move the pointer which is on the character with index 1 to the left, it moves to the character with the index m, and when we move it to the right from the position m it moves to the position 1.You need to determine the minimum number of operations necessary to make the string displayed on the screen a valid password." 1500
761B "Dasha and friends" "brute force,implementation,math" "Running with barriers on the circle track is very popular in the country where Dasha lives, so no wonder that on her way to classes she saw the following situation:The track is the circle with length L, in distinct points of which there are n barriers. Athlete always run the track in counterclockwise direction if you look on him from above. All barriers are located at integer distance from each other along the track. Her friends the parrot Kefa and the leopard Sasha participated in competitions and each of them ran one lap. Each of the friends started from some integral point on the track. Both friends wrote the distance from their start along the track to each of the n barriers. Thus, each of them wrote n integers in the ascending order, each of them was between 0 and L\xe2\x80\x89-\xe2\x80\x891, inclusively.  Consider an example. Let L\xe2\x80\x89=\xe2\x80\x898, blue points are barriers, and green points are Kefa\'s start (A) and Sasha\'s start (B). Then Kefa writes down the sequence [2,\xe2\x80\x894,\xe2\x80\x896], and Sasha writes down [1,\xe2\x80\x895,\xe2\x80\x897]. There are several tracks in the country, all of them have same length and same number of barriers, but the positions of the barriers can differ among different tracks. Now Dasha is interested if it is possible that Kefa and Sasha ran the same track or they participated on different tracks. Write the program which will check that Kefa\'s and Sasha\'s tracks coincide (it means that one can be obtained from the other by changing the start position). Note that they always run the track in one direction \xe2\x80\x94 counterclockwise, if you look on a track from above." 1300
761A "Dasha and Stairs" "brute force,constructive algorithms,implementation,math" "On her way to programming school tiger Dasha faced her first test \xe2\x80\x94 a huge staircase!  The steps were numbered from one to infinity. As we know, tigers are very fond of all striped things, it is possible that it has something to do with their color. So on some interval of her way she calculated two values \xe2\x80\x94 the number of steps with even and odd numbers. You need to check whether there is an interval of steps from the l-th to the r-th (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), for which values that Dasha has found are correct." 1000
760B "Frodo and pillows" "binary search,greedy" "n hobbits are planning to spend the night at Frodo\'s house. Frodo has n beds standing in a row and m pillows (n\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). Each hobbit needs a bed and at least one pillow to sleep, however, everyone wants as many pillows as possible. Of course, it\'s not always possible to share pillows equally, but any hobbit gets hurt if he has at least two pillows less than some of his neighbors have. Frodo will sleep on the k-th bed in the row. What is the maximum number of pillows he can have so that every hobbit has at least one pillow, every pillow is given to some hobbit and no one is hurt?" 1500
760A "Petr and a calendar" implementation,math "Petr wants to make a calendar for current month. For this purpose he draws a table in which columns correspond to weeks (a week is seven consequent days from Monday to Sunday), rows correspond to weekdays, and cells contain dates. For example, a calendar for January 2017 should look like on the picture:  Petr wants to know how many columns his table should have given the month and the weekday of the first date of that month? Assume that the year is non-leap." 800
758F "Geometrical Progression" "brute force,math,number theory" "For given n, l and r find the number of distinct geometrical progression, each of which contains n distinct integers not less than l and not greater than r. In other words, for each progression the following must hold: l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89aj , where a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is the geometrical progression, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i,\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j.Geometrical progression is a sequence of numbers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an where each term after first is found by multiplying the previous one by a fixed non-zero number d called the common ratio. Note that in our task d may be non-integer. For example in progression 4,\xe2\x80\x896,\xe2\x80\x899, common ratio is .Two progressions a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn are considered different, if there is such i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) that ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89bi." 2400
758E "Broken Tree" "dfs and similar,dp,graphs,greedy,trees" "You are given a tree that has n vertices, which are numbered from 1 to n, where the vertex number one is the root. Each edge has weight wi and strength pi.Botanist Innokentiy, who is the only member of the jury of the Olympiad in Informatics, doesn\'t like broken trees. The tree is broken if there is such an edge the strength of which is less than the sum of weight of subtree\'s edges to which it leads.It is allowed to reduce weight of any edge by arbitrary integer value, but then the strength of its edge is reduced by the same value. It means if the weight of the edge is 10, and the strength is 12, then by the reducing the weight by 7 its weight will equal 3, and the strength will equal 5. It is not allowed to increase the weight of the edge.Your task is to get the tree, which is not broken, by reducing the weight of edges of the given tree, and also all edged should have the positive weight, moreover, the total weight of all edges should be as large as possible.It is obvious that the strength of edges can not be negative, however it can equal zero if the weight of the subtree equals zero." 2600
758D "Ability To Convert" "constructive algorithms,dp,greedy,math,strings" "Alexander is learning how to convert numbers from the decimal system to any other, however, he doesn\'t know English letters, so he writes any number only as a decimal number, it means that instead of the letter A he will write the number 10. Thus, by converting the number 475 from decimal to hexadecimal system, he gets 11311 (475\xe2\x80\x89=\xe2\x80\x891\xc2\xb7162\xe2\x80\x89+\xe2\x80\x8913\xc2\xb7161\xe2\x80\x89+\xe2\x80\x8911\xc2\xb7160). Alexander lived calmly until he tried to convert the number back to the decimal number system.Alexander remembers that he worked with little numbers so he asks to find the minimum decimal number so that by converting it to the system with the base n he will get the number k." 2000
758C "Unfair Poll" "binary search,constructive algorithms,implementation,math" "On the Literature lesson Sergei noticed an awful injustice, it seems that some students are asked more often than others.Seating in the class looks like a rectangle, where n rows with m pupils in each. The teacher asks pupils in the following order: at first, she asks all pupils from the first row in the order of their seating, then she continues to ask pupils from the next row. If the teacher asked the last row, then the direction of the poll changes, it means that she asks the previous row. The order of asking the rows looks as follows: the 1-st row, the 2-nd row, ..., the n\xe2\x80\x89-\xe2\x80\x891-st row, the n-th row, the n\xe2\x80\x89-\xe2\x80\x891-st row, ..., the 2-nd row, the 1-st row, the 2-nd row, ...The order of asking of pupils on the same row is always the same: the 1-st pupil, the 2-nd pupil, ..., the m-th pupil.During the lesson the teacher managed to ask exactly k questions from pupils in order described above. Sergei seats on the x-th row, on the y-th place in the row. Sergei decided to prove to the teacher that pupils are asked irregularly, help him count three values:  the maximum number of questions a particular pupil is asked,  the minimum number of questions a particular pupil is asked,  how many times the teacher asked Sergei. If there is only one row in the class, then the teacher always asks children from this row." 1700
758B "Blown Garland" "brute force,implementation,number theory" "Nothing is eternal in the world, Kostya understood it on the 7-th of January when he saw partially dead four-color garland.Now he has a goal to replace dead light bulbs, however he doesn\'t know how many light bulbs for each color are required. It is guaranteed that for each of four colors at least one light is working.It is known that the garland contains light bulbs of four colors: red, blue, yellow and green. The garland is made as follows: if you take any four consecutive light bulbs then there will not be light bulbs with the same color among them. For example, the garland can look like ""RYBGRYBGRY"", ""YBGRYBGRYBG"", ""BGRYB"", but can not look like ""BGRYG"", ""YBGRYBYGR"" or ""BGYBGY"". Letters denote colors: \'R\' \xe2\x80\x94 red, \'B\' \xe2\x80\x94 blue, \'Y\' \xe2\x80\x94 yellow, \'G\' \xe2\x80\x94 green.Using the information that for each color at least one light bulb still works count the number of dead light bulbs of each four colors." 1100
758A "Holiday Of Equality" implementation,math "In Berland it is the holiday of equality. In honor of the holiday the king decided to equalize the welfare of all citizens in Berland by the expense of the state treasury. Totally in Berland there are n citizens, the welfare of each of them is estimated as the integer in ai burles (burle is the currency in Berland).You are the royal treasurer, which needs to count the minimum charges of the kingdom on the king\'s present. The king can only give money, he hasn\'t a power to take away them." 800
757G "Can Bash Save the Day?" "data structures,divide and conquer,graphs,trees" "Whoa! You did a great job helping Team Rocket who managed to capture all the Pokemons sent by Bash. Meowth, part of Team Rocket, having already mastered the human language, now wants to become a master in programming as well. He agrees to free the Pokemons if Bash can answer his questions.Initially, Meowth gives Bash a weighted tree containing n nodes and a sequence a1,\xe2\x80\x89a2...,\xe2\x80\x89an which is a permutation of 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n. Now, Mewoth makes q queries of one of the following forms:  1 l r v: meaning Bash should report , where dist(a,\xe2\x80\x89b) is the length of the shortest path from node a to node b in the given tree.   2 x: meaning Bash should swap ax and ax\xe2\x80\x89+\xe2\x80\x891 in the given sequence. This new sequence is used for later queries. Help Bash to answer the questions!" 3400
757F "Team Rocket Rises Again" "data structures,graphs,shortest paths" "It\'s the turn of the year, so Bash wants to send presents to his friends. There are n cities in the Himalayan region and they are connected by m bidirectional roads. Bash is living in city s. Bash has exactly one friend in each of the other cities. Since Bash wants to surprise his friends, he decides to send a Pikachu to each of them. Since there may be some cities which are not reachable from Bash\'s city, he only sends a Pikachu to those friends who live in a city reachable from his own city. He also wants to send it to them as soon as possible.He finds out the minimum time for each of his Pikachus to reach its destination city. Since he is a perfectionist, he informs all his friends with the time their gift will reach them. A Pikachu travels at a speed of 1 meters per second. His friends were excited to hear this and would be unhappy if their presents got delayed. Unfortunately Team Rocket is on the loose and they came to know of Bash\'s plan. They want to maximize the number of friends who are unhappy with Bash.They do this by destroying exactly one of the other n\xe2\x80\x89-\xe2\x80\x891 cities. This implies that the friend residing in that city dies, so he is unhappy as well.Note that if a city is destroyed, all the roads directly connected to the city are also destroyed and the Pikachu may be forced to take a longer alternate route.Please also note that only friends that are waiting for a gift count as unhappy, even if they die.Since Bash is already a legend, can you help Team Rocket this time and find out the maximum number of Bash\'s friends who can be made unhappy by destroying exactly one city." 2800
757E "Bash Plays with Functions" "brute force,combinatorics,dp,number theory" "Bash got tired on his journey to become the greatest Pokemon master. So he decides to take a break and play with functions.Bash defines a function f0(n), which denotes the number of ways of factoring n into two factors p and q such that gcd(p,\xe2\x80\x89q)\xe2\x80\x89=\xe2\x80\x891. In other words, f0(n) is the number of ordered pairs of positive integers (p,\xe2\x80\x89q) such that p\xc2\xb7q\xe2\x80\x89=\xe2\x80\x89n and gcd(p,\xe2\x80\x89q)\xe2\x80\x89=\xe2\x80\x891.But Bash felt that it was too easy to calculate this function. So he defined a series of functions, where fr\xe2\x80\x89+\xe2\x80\x891 is defined as:Where (u,\xe2\x80\x89v) is any ordered pair of positive integers, they need not to be co-prime.Now Bash wants to know the value of fr(n) for different r and n. Since the value could be huge, he would like to know the value modulo 109\xe2\x80\x89+\xe2\x80\x897. Help him!" 2500
757D "Felicity\'s Big Secret Revealed" bitmasks,dp "The gym leaders were fascinated by the evolutions which took place at Felicity camp. So, they were curious to know about the secret behind evolving Pokemon. The organizers of the camp gave the gym leaders a PokeBlock, a sequence of n ingredients. Each ingredient can be of type 0 or 1. Now the organizers told the gym leaders that to evolve a Pokemon of type k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892), they need to make a valid set of k cuts on the PokeBlock to get smaller blocks.Suppose the given PokeBlock sequence is b0b1b2... bn\xe2\x80\x89-\xe2\x80\x891. You have a choice of making cuts at n\xe2\x80\x89+\xe2\x80\x891 places, i.e., Before b0, between b0 and b1, between b1 and b2, ..., between bn\xe2\x80\x89-\xe2\x80\x892 and bn\xe2\x80\x89-\xe2\x80\x891, and after bn\xe2\x80\x89-\xe2\x80\x891.The n\xe2\x80\x89+\xe2\x80\x891 choices of making cuts are as follows (where a | denotes a possible cut):| b0 | b1 | b2 | ... | bn\xe2\x80\x89-\xe2\x80\x892 | bn\xe2\x80\x89-\xe2\x80\x891 |Consider a sequence of k cuts. Now each pair of consecutive cuts will contain a binary string between them, formed from the ingredient types. The ingredients before the first cut and after the last cut are wasted, which is to say they are not considered. So there will be exactly k\xe2\x80\x89-\xe2\x80\x891 such binary substrings. Every substring can be read as a binary number. Let m be the maximum number out of the obtained numbers. If all the obtained numbers are positive and the set of the obtained numbers contains all integers from 1 to m, then this set of cuts is said to be a valid set of cuts.For example, suppose the given PokeBlock sequence is 101101001110 and we made 5 cuts in the following way:10 | 11 | 010 | 01 | 1 | 10So the 4 binary substrings obtained are: 11, 010, 01 and 1, which correspond to the numbers 3, 2, 1 and 1 respectively. Here m\xe2\x80\x89=\xe2\x80\x893, as it is the maximum value among the obtained numbers. And all the obtained numbers are positive and we have obtained all integers from 1 to m. Hence this set of cuts is a valid set of 5 cuts.A Pokemon of type k will evolve only if the PokeBlock is cut using a valid set of k cuts. There can be many valid sets of the same size. Two valid sets of k cuts are considered different if there is a cut in one set which is not there in the other set.Let f(k) denote the number of valid sets of k cuts. Find the value of . Since the value of s can be very large, output s modulo 109\xe2\x80\x89+\xe2\x80\x897." 2200
757C "Felicity is Coming!" "data structures,hashing,sortings,strings" "It\'s that time of the year, Felicity is around the corner and you can see people celebrating all around the Himalayan region. The Himalayan region has n gyms. The i-th gym has gi Pokemon in it. There are m distinct Pokemon types in the Himalayan region numbered from 1 to m. There is a special evolution camp set up in the fest which claims to evolve any Pokemon. The type of a Pokemon could change after evolving, subject to the constraint that if two Pokemon have the same type before evolving, they will have the same type after evolving. Also, if two Pokemon have different types before evolving, they will have different types after evolving. It is also possible that a Pokemon has the same type before and after evolving. Formally, an evolution plan is a permutation f of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m}, such that f(x)\xe2\x80\x89=\xe2\x80\x89y means that a Pokemon of type x evolves into a Pokemon of type y.The gym leaders are intrigued by the special evolution camp and all of them plan to evolve their Pokemons. The protocol of the mountain states that in each gym, for every type of Pokemon, the number of Pokemon of that type before evolving any Pokemon should be equal the number of Pokemon of that type after evolving all the Pokemons according to the evolution plan. They now want to find out how many distinct evolution plans exist which satisfy the protocol.Two evolution plans f1 and f2 are distinct, if they have at least one Pokemon type evolving into a different Pokemon type in the two plans, i. e. there exists an i such that f1(i)\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89f2(i).Your task is to find how many distinct evolution plans are possible such that if all Pokemon in all the gyms are evolved, the number of Pokemon of each type in each of the gyms remains the same. As the answer can be large, output it modulo 109\xe2\x80\x89+\xe2\x80\x897." 1900
757B "Bash\'s Big Day" "greedy,math,number theory" "Bash has set out on a journey to become the greatest Pokemon master. To get his first Pokemon, he went to Professor Zulu\'s Lab. Since Bash is Professor Zulu\'s favourite student, Zulu allows him to take as many Pokemon from his lab as he pleases.But Zulu warns him that a group of k\xe2\x80\x89>\xe2\x80\x891 Pokemon with strengths {s1,\xe2\x80\x89s2,\xe2\x80\x89s3,\xe2\x80\x89...,\xe2\x80\x89sk} tend to fight among each other if gcd(s1,\xe2\x80\x89s2,\xe2\x80\x89s3,\xe2\x80\x89...,\xe2\x80\x89sk)\xe2\x80\x89=\xe2\x80\x891 (see notes for gcd definition).Bash, being smart, does not want his Pokemon to fight among each other. However, he also wants to maximize the number of Pokemon he takes from the lab. Can you help Bash find out the maximum number of Pokemon he can take? Note: A Pokemon cannot fight with itself." 1400
757A "Gotta Catch Em\' All!" implementation "Bash wants to become a Pokemon master one day. Although he liked a lot of Pokemon, he has always been fascinated by Bulbasaur the most. Soon, things started getting serious and his fascination turned into an obsession. Since he is too young to go out and catch Bulbasaur, he came up with his own way of catching a Bulbasaur.Each day, he takes the front page of the newspaper. He cuts out the letters one at a time, from anywhere on the front page of the newspaper to form the word ""Bulbasaur"" (without quotes) and sticks it on his wall. Bash is very particular about case \xe2\x80\x94 the first letter of ""Bulbasaur"" must be upper case and the rest must be lower case. By doing this he thinks he has caught one Bulbasaur. He then repeats this step on the left over part of the newspaper. He keeps doing this until it is not possible to form the word ""Bulbasaur"" from the newspaper.Given the text on the front page of the newspaper, can you tell how many Bulbasaurs he will catch today?Note: uppercase and lowercase letters are considered different." 1000
756F "Long number" "expression parsing,math,number theory" "Consider the following grammar: <expression> ::= <term> | <expression> \'+\' <term> <term> ::= <number> | <number> \'-\' <number> | <number> \'(\' <expression> \')\' <number> ::= <pos_digit> | <number> <digit> <digit> ::= \'0\' | <pos_digit> <pos_digit> ::= \'1\' | \'2\' | \'3\' | \'4\' | \'5\' | \'6\' | \'7\' | \'8\' | \'9\'This grammar describes a number in decimal system using the following rules: <number> describes itself, <number>-<number> (l-r, l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) describes integer which is concatenation of all integers from l to r, written without leading zeros. For example, 8-11 describes 891011, <number>(<expression>) describes integer which is concatenation of <number> copies of integer described by <expression>, <expression>+<term> describes integer which is concatenation of integers described by <expression> and <term>.For example, 2(2-4+1)+2(2(17)) describes the integer 2341234117171717.You are given an expression in the given grammar. Print the integer described by it modulo 109\xe2\x80\x89+\xe2\x80\x897." 3400
756E "Byteland coins" combinatorics,dp,math "There are n types of coins in Byteland. Conveniently, the denomination of the coin type k divides the denomination of the coin type k\xe2\x80\x89+\xe2\x80\x891, the denomination of the coin type 1 equals 1 tugrick. The ratio of the denominations of coin types k\xe2\x80\x89+\xe2\x80\x891 and k equals ak. It is known that for each x there are at most 20 coin types of denomination x.Byteasar has bk coins of type k with him, and he needs to pay exactly m tugricks. It is known that Byteasar never has more than 3\xc2\xb7105 coins with him. Byteasar want to know how many ways there are to pay exactly m tugricks. Two ways are different if there is an integer k such that the amount of coins of type k differs in these two ways. As all Byteland citizens, Byteasar wants to know the number of ways modulo 109\xe2\x80\x89+\xe2\x80\x897." 3200
756D "Bacterial Melee" "brute force,combinatorics,dp,string suffix structures" "Julia is conducting an experiment in her lab. She placed several luminescent bacterial colonies in a horizontal testtube. Different types of bacteria can be distinguished by the color of light they emit. Julia marks types of bacteria with small Latin letters ""a"", ..., ""z"".The testtube is divided into n consecutive regions. Each region is occupied by a single colony of a certain bacteria type at any given moment. Hence, the population of the testtube at any moment can be described by a string of n Latin characters.Sometimes a colony can decide to conquer another colony in one of the adjacent regions. When that happens, the attacked colony is immediately eliminated and replaced by a colony of the same type as the attacking colony, while the attacking colony keeps its type. Note that a colony can only attack its neighbours within the boundaries of the testtube. At any moment, at most one attack can take place.For example, consider a testtube with population ""babb"". There are six options for an attack that may happen next: the first colony attacks the second colony (1\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892), the resulting population is ""bbbb""; 2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x891, the result is ""aabb""; 2\xe2\x80\x89\xe2\x86\x92\xe2\x80\x893, the result is ""baab""; 3\xe2\x80\x89\xe2\x86\x92\xe2\x80\x892, the result is ""bbbb"" (note that the result is the same as the first option); 3\xe2\x80\x89\xe2\x86\x92\xe2\x80\x894 or 4\xe2\x80\x89\xe2\x86\x92\xe2\x80\x893, the population does not change.The pattern of attacks is rather unpredictable. Julia is now wondering how many different configurations of bacteria in the testtube she can obtain after a sequence of attacks takes place (it is possible that no attacks will happen at all). Since this number can be large, find it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2400
756C "Nikita and stack" "data structures" "Nikita has a stack. A stack in this problem is a data structure that supports two operations. Operation push(x) puts an integer x on the top of the stack, and operation pop() deletes the top integer from the stack, i. e. the last added. If the stack is empty, then the operation pop() does nothing.Nikita made m operations with the stack but forgot them. Now Nikita wants to remember them. He remembers them one by one, on the i-th step he remembers an operation he made pi-th. In other words, he remembers the operations in order of some permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pm. After each step Nikita wants to know what is the integer on the top of the stack after performing the operations he have already remembered, in the corresponding order. Help him!" 2200
756B "Travel Card" "binary search,dp" "A new innovative ticketing systems for public transport is introduced in Bytesburg. Now there is a single travel card for all transport. To make a trip a passenger scan his card and then he is charged according to the fare.The fare is constructed in the following manner. There are three types of tickets:   a ticket for one trip costs 20 byteland rubles,  a ticket for 90 minutes costs 50 byteland rubles,  a ticket for one day (1440 minutes) costs 120 byteland rubles. Note that a ticket for x minutes activated at time t can be used for trips started in time range from t to t\xe2\x80\x89+\xe2\x80\x89x\xe2\x80\x89-\xe2\x80\x891, inclusive. Assume that all trips take exactly one minute.To simplify the choice for the passenger, the system automatically chooses the optimal tickets. After each trip starts, the system analyses all the previous trips and the current trip and chooses a set of tickets for these trips with a minimum total cost. Let the minimum total cost of tickets to cover all trips from the first to the current is a, and the total sum charged before is b. Then the system charges the passenger the sum a\xe2\x80\x89-\xe2\x80\x89b.You have to write a program that, for given trips made by a passenger, calculates the sum the passenger is charged after each trip." 1600
756A "Pavel and barbecue" "constructive algorithms,dfs and similar" "Pavel cooks barbecue. There are n skewers, they lay on a brazier in a row, each on one of n positions. Pavel wants each skewer to be cooked some time in every of n positions in two directions: in the one it was directed originally and in the reversed direction.Pavel has a plan: a permutation p and a sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn, consisting of zeros and ones. Each second Pavel move skewer on position i to position pi, and if bi equals 1 then he reverses it. So he hope that every skewer will visit every position in both directions.Unfortunately, not every pair of permutation p and sequence b suits Pavel. What is the minimum total number of elements in the given permutation p and the given sequence b he needs to change so that every skewer will visit each of 2n placements? Note that after changing the permutation should remain a permutation as well.There is no problem for Pavel, if some skewer visits some of the placements several times before he ends to cook. In other words, a permutation p and a sequence b suit him if there is an integer k (k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892n), so that after k seconds each skewer visits each of the 2n placements.It can be shown that some suitable pair of permutation p and sequence b exists for any n." 1700
755G "PolandBall and Many Other Balls" "combinatorics,divide and conquer,dp,fft,math,number theory" "PolandBall is standing in a row with Many Other Balls. More precisely, there are exactly n Balls. Balls are proud of their home land \xe2\x80\x94 and they want to prove that it\'s strong.The Balls decided to start with selecting exactly m groups of Balls, each consisting either of single Ball or two neighboring Balls. Each Ball can join no more than one group.The Balls really want to impress their Enemies. They kindly asked you to calculate number of such divisions for all m where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k. Output all these values modulo 998244353, the Enemies will be impressed anyway." 3200
755F "PolandBall and Gifts" bitmasks,dp,greedy "It\'s Christmas time! PolandBall and his friends will be giving themselves gifts. There are n Balls overall. Each Ball has someone for whom he should bring a present according to some permutation p, pi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i for all i.Unfortunately, Balls are quite clumsy. We know earlier that exactly k of them will forget to bring their gift. A Ball number i will get his present if the following two constraints will hold:   Ball number i will bring the present he should give.  Ball x such that px\xe2\x80\x89=\xe2\x80\x89i will bring his present. What is minimum and maximum possible number of kids who will not get their present if exactly k Balls will forget theirs?" 2600
755E "PolandBall and White-Red graph" "constructive algorithms,graphs,shortest paths" "PolandBall has an undirected simple graph consisting of n vertices. Unfortunately, it has no edges. The graph is very sad because of that. PolandBall wanted to make it happier, adding some red edges. Then, he will add white edges in every remaining place. Therefore, the final graph will be a clique in two colors: white and red. Colorfulness of the graph is a value min(dr,\xe2\x80\x89dw), where dr is the diameter of the red subgraph and dw is the diameter of white subgraph. The diameter of a graph is a largest value d such that shortest path between some pair of vertices in it is equal to d. If the graph is not connected, we consider its diameter to be -1.PolandBall wants the final graph to be as neat as possible. He wants the final colorfulness to be equal to k. Can you help him and find any graph which satisfies PolandBall\'s requests?" 2400
755D "PolandBall and Polygon" "data structures" "PolandBall has such a convex polygon with n veritces that no three of its diagonals intersect at the same point. PolandBall decided to improve it and draw some red segments. He chose a number k such that gcd(n,\xe2\x80\x89k)\xe2\x80\x89=\xe2\x80\x891. Vertices of the polygon are numbered from 1 to n in a clockwise way. PolandBall repeats the following process n times, starting from the vertex 1: Assume you\'ve ended last operation in vertex x (consider x\xe2\x80\x89=\xe2\x80\x891 if it is the first operation). Draw a new segment from vertex x to k-th next vertex in clockwise direction. This is a vertex x\xe2\x80\x89+\xe2\x80\x89k or x\xe2\x80\x89+\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x89n depending on which of these is a valid index of polygon\'s vertex.Your task is to calculate number of polygon\'s sections after each drawing. A section is a clear area inside the polygon bounded with drawn diagonals or the polygon\'s sides." 2000
755C "PolandBall and Forest" "dfs and similar,dsu,graphs,interactive,trees" "PolandBall lives in a forest with his family. There are some trees in the forest. Trees are undirected acyclic graphs with k vertices and k\xe2\x80\x89-\xe2\x80\x891 edges, where k is some integer. Note that one vertex is a valid tree.There is exactly one relative living in each vertex of each tree, they have unique ids from 1 to n. For each Ball i we know the id of its most distant relative living on the same tree. If there are several such vertices, we only know the value of the one with smallest id among those.How many trees are there in the forest?" 1300
755B "PolandBall and Game" "binary search,data structures,games,greedy,sortings,strings" "PolandBall is playing a game with EnemyBall. The rules are simple. Players have to say words in turns. You cannot say a word which was already said. PolandBall starts. The Ball which can\'t say a new word loses.You\'re given two lists of words familiar to PolandBall and EnemyBall. Can you determine who wins the game, if both play optimally?" 1100
755A "PolandBall and Hypothesis" "brute force,graphs,math,number theory" "PolandBall is a young, clever Ball. He is interested in prime numbers. He has stated a following hypothesis: ""There exists such a positive integer n that for each positive integer m number n\xc2\xb7m\xe2\x80\x89+\xe2\x80\x891 is a prime number"".Unfortunately, PolandBall is not experienced yet and doesn\'t know that his hypothesis is incorrect. Could you prove it wrong? Write a program that finds a counterexample for any n." 800
754E "Dasha and cyclic table" "bitmasks,brute force,fft,strings,trees" "Dasha is fond of challenging puzzles: Rubik\'s Cube 3\xe2\x80\x89\xc3\x97\xe2\x80\x893\xe2\x80\x89\xc3\x97\xe2\x80\x893, 4\xe2\x80\x89\xc3\x97\xe2\x80\x894\xe2\x80\x89\xc3\x97\xe2\x80\x894, 5\xe2\x80\x89\xc3\x97\xe2\x80\x895\xe2\x80\x89\xc3\x97\xe2\x80\x895 and so on. This time she has a cyclic table of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, and each cell of the table contains a lowercase English letter. Each cell has coordinates (i,\xe2\x80\x89j) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89m). The table is cyclic means that to the right of cell (i,\xe2\x80\x89j) there is the cell , and to the down there is the cell .Dasha has a pattern as well. A pattern is a non-cyclic table of size r\xe2\x80\x89\xc3\x97\xe2\x80\x89c. Each cell is either a lowercase English letter or a question mark. Each cell has coordinates (i,\xe2\x80\x89j) (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89r, 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89c).The goal of the puzzle is to find all the appearance positions of the pattern in the cyclic table.We say that the cell (i,\xe2\x80\x89j) of cyclic table is an appearance position, if for every pair (x,\xe2\x80\x89y) such that 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89<\xe2\x80\x89r and 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89<\xe2\x80\x89c one of the following conditions holds:   There is a question mark in the cell (x,\xe2\x80\x89y) of the pattern, or  The cell  of the cyclic table equals to the cell (x,\xe2\x80\x89y) of the pattern. Dasha solved this puzzle in no time, as well as all the others she ever tried. Can you solve it?." 2600
754D "Fedor and coupons" "binary search,data structures,greedy,sortings" "All our characters have hobbies. The same is true for Fedor. He enjoys shopping in the neighboring supermarket. The goods in the supermarket have unique integer ids. Also, for every integer there is a product with id equal to this integer. Fedor has n discount coupons, the i-th of them can be used with products with ids ranging from li to ri, inclusive. Today Fedor wants to take exactly k coupons with him.Fedor wants to choose the k coupons in such a way that the number of such products x that all coupons can be used with this product x is as large as possible (for better understanding, see examples). Fedor wants to save his time as well, so he asks you to choose coupons for him. Help Fedor!" 2100
754C "Vladik and chat" "brute force,constructive algorithms,dp,implementation,strings" "Recently Vladik discovered a new entertainment \xe2\x80\x94 coding bots for social networks. He would like to use machine learning in his bots so now he want to prepare some learning data for them.At first, he need to download t chats. Vladik coded a script which should have downloaded the chats, however, something went wrong. In particular, some of the messages have no information of their sender. It is known that if a person sends several messages in a row, they all are merged into a single message. It means that there could not be two or more messages in a row with the same sender. Moreover, a sender never mention himself in his messages.Vladik wants to recover senders of all the messages so that each two neighboring messages will have different senders and no sender will mention himself in his messages.He has no idea of how to do this, and asks you for help. Help Vladik to recover senders in each of the chats!" 2200
754B "Ilya and tic-tac-toe game" "brute force,implementation" "Ilya is an experienced player in tic-tac-toe on the 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 field. He always starts and plays with Xs. He played a lot of games today with his friend Arseny. The friends became tired and didn\'t finish the last game. It was Ilya\'s turn in the game when they left it. Determine whether Ilya could have won the game by making single turn or not. The rules of tic-tac-toe on the 4\xe2\x80\x89\xc3\x97\xe2\x80\x894 field are as follows. Before the first turn all the field cells are empty. The two players take turns placing their signs into empty cells (the first player places Xs, the second player places Os). The player who places Xs goes first, the another one goes second. The winner is the player who first gets three of his signs in a row next to each other (horizontal, vertical or diagonal)." 1100
754A "Lesha and array splitting" "constructive algorithms,greedy,implementation" "One spring day on his way to university Lesha found an array A. Lesha likes to split arrays into several parts. This time Lesha decided to split the array A into several, possibly one, new arrays so that the sum of elements in each of the new arrays is not zero. One more condition is that if we place the new arrays one after another they will form the old array A.Lesha is tired now so he asked you to split the array. Help Lesha!" 1200
753C "Interactive Bulls and Cows (Hard)" "brute force,constructive algorithms,interactive" "The only difference from the previous problem is the constraint on the number of requests. In this problem your program should guess the answer doing at most 7 requests.This problem is a little bit unusual. Here you are to implement an interaction with a testing system. That means that you can make queries and get responses in the online mode. Please be sure to use the stream flushing operation after each query\'s output in order not to leave part of your output in some buffer. For example, in C++ you\'ve got to use the fflush(stdout) function, in Java \xe2\x80\x94 call System.out.flush(), and in Pascal \xe2\x80\x94 flush(output).Bulls and Cows (also known as Cows and Bulls or Pigs and Bulls or Bulls and Cleots) is an old code-breaking paper and pencil game for two players, predating the similar commercially marketed board game Mastermind.On a sheet of paper, the first player thinks a secret string. This string consists only of digits and has the length 4. The digits in the string must be all different, no two or more equal digits are allowed.Then the second player tries to guess his opponent\'s string. For every guess the first player gives the number of matches. If the matching digits are on their right positions, they are ""bulls"", if on different positions, they are ""cows"". Thus a response is a pair of numbers \xe2\x80\x94 the number of ""bulls"" and the number of ""cows"". A try can contain equal digits.More formally, let\'s the secret string is s and the second player are trying to guess it with a string x. The number of ""bulls"" is a number of such positions i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) where s[i]\xe2\x80\x89=\xe2\x80\x89x[i]. The number of ""cows"" is a number of such digits c that s contains c in the position i (i.e. s[i]\xe2\x80\x89=\xe2\x80\x89c), x contains c, but x[i]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c.For example, the secret string is ""0427"", the opponent\'s try is ""0724"", then the answer is 2 bulls and 2 cows (the bulls are ""0"" and ""2"", the cows are ""4"" and ""7""). If the secret string is ""0123"", the opponent\'s try is ""0330"", then the answer is 1 bull and 1 cow.In this problem you are to guess the string s that the system has chosen. You only know that the chosen string consists of 4 distinct digits.You can make queries to the testing system, each query is the output of a single 4-digit string. The answer to the query is the number of bulls and number of cows. If the system\'s response equals ""4 0"", that means the interaction with your problem is over and the program must terminate. That is possible for two reasons \xe2\x80\x94 the program either guessed the number x or made an invalid action (for example, printed letters instead of digits).Your program is allowed to do at most 7 queries.You can hack solutions of other participants providing a 4-digit string containing distinct digits \xe2\x80\x94 the secret string." 2500
753B "Interactive Bulls and Cows (Easy)" "brute force,constructive algorithms,implementation" "This problem is a little bit unusual. Here you are to implement an interaction with a testing system. That means that you can make queries and get responses in the online mode. Please be sure to use the stream flushing operation after each query\'s output in order not to leave part of your output in some buffer. For example, in C++ you\'ve got to use the fflush(stdout) function, in Java \xe2\x80\x94 call System.out.flush(), and in Pascal \xe2\x80\x94 flush(output).Bulls and Cows (also known as Cows and Bulls or Pigs and Bulls or Bulls and Cleots) is an old code-breaking paper and pencil game for two players, predating the similar commercially marketed board game Mastermind.On a sheet of paper, the first player thinks a secret string. This string consists only of digits and has the length 4. The digits in the string must be all different, no two or more equal digits are allowed.Then the second player tries to guess his opponent\'s string. For every guess the first player gives the number of matches. If the matching digits are on their right positions, they are ""bulls"", if on different positions, they are ""cows"". Thus a response is a pair of numbers \xe2\x80\x94 the number of ""bulls"" and the number of ""cows"". A try can contain equal digits.More formally, let\'s the secret string is s and the second player are trying to guess it with a string x. The number of ""bulls"" is a number of such positions i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) where s[i]\xe2\x80\x89=\xe2\x80\x89x[i]. The number of ""cows"" is a number of such digits c that s contains c in the position i (i.e. s[i]\xe2\x80\x89=\xe2\x80\x89c), x contains c, but x[i]\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c.For example, the secret string is ""0427"", the opponent\'s try is ""0724"", then the answer is 2 bulls and 2 cows (the bulls are ""0"" and ""2"", the cows are ""4"" and ""7""). If the secret string is ""0123"", the opponent\'s try is ""0330"", then the answer is 1 bull and 1 cow.In this problem you are to guess the string s that the system has chosen. You only know that the chosen string consists of 4 distinct digits.You can make queries to the testing system, each query is the output of a single 4-digit string. The answer to the query is the number of bulls and number of cows. If the system\'s response equals ""4 0"", that means the interaction with your problem is over and the program must terminate. That is possible for two reasons \xe2\x80\x94 the program either guessed the number x or made an invalid action (for example, printed letters instead of digits).Your program is allowed to do at most 50 queries.You can hack solutions of other participants providing a 4-digit string containing distinct digits \xe2\x80\x94 the secret string." 1600
753A "Santa Claus and Candies" dp,greedy,math "Santa Claus has n candies, he dreams to give them as gifts to children.What is the maximal number of children for whose he can give candies if Santa Claus want each kid should get distinct positive integer number of candies. Santa Class wants to give all n candies he has." 1000
750H "New Year and Snowy Grid" "dfs and similar,dsu,graphs,interactive" "Pay attention to the output section below, where you will see the information about flushing the output.Bearland is a grid with h rows and w columns. Rows are numbered 1 through h from top to bottom. Columns are numbered 1 through w from left to right. Every cell is either allowed (denoted by \'.\' in the input) or permanently blocked (denoted by \'#\').Bearland is a cold land, where heavy snow often makes travelling harder. Every day a few allowed cells are temporarily blocked by snow. Note, that this block works only on this particular day and next day any of these cells might be allowed again (unless there is another temporarily block).It\'s possible to move directly between two cells only if they share a side and none of them is permanently or temporarily blocked.Limak is a little polar bear who lives in Bearland. His house is at the top left cell, while his school is at the bottom right cell. Every day Limak should first go from his house to the school and then return back to his house. Since he gets bored easily, he doesn\'t want to visit the same cell twice on one day, except for the cell with his house, where he starts and ends. If Limak can reach a school and return home avoiding revisiting cells, he calls a day interesting.There are q days you must process, one after another. For each of these days you should check if it\'s interesting and print ""YES"" or ""NO"" on a separate line. In order to be able to read the description of the next day you should print the answer for the previous one and flush the output.It\'s guaranteed that a day with no cells temporarily blocked by snow would be interesting. It\'s also guaranteed that cells with Limak\'s house and school are never blocked (neither permanently or temporarily)." 3500
750G "New Year and Binary Tree Paths" "bitmasks,brute force,combinatorics,dp" "The New Year tree is an infinite perfect binary tree rooted in the node 1. Each node v has two children: nodes indexed (2\xc2\xb7v) and (2\xc2\xb7v\xe2\x80\x89+\xe2\x80\x891).  Polar bears love decorating the New Year tree and Limak is no exception. As he is only a little bear, he was told to decorate only one simple path between some pair of nodes. Though he was given an opportunity to pick the pair himself! Now he wants to know the number of unordered pairs of indices (u,\xe2\x80\x89v) (u\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89v), such that the sum of indices of all nodes along the simple path between u and v (including endpoints) is equal to s. Can you help him and count this value?" 3200
750F "New Year and Finding Roots" "constructive algorithms,implementation,interactive,trees" "This is an interactive problem. In the interaction section below you will find the information about flushing the output.The New Year tree of height h is a perfect binary tree with vertices numbered 1 through 2h\xe2\x80\x89-\xe2\x80\x891 in some order. In this problem we assume that h is at least 2. The drawing below shows one example New Year tree of height 3:  Polar bears love decorating the New Year tree and Limak is no exception. To decorate the tree, he must first find its root, i.e. a vertex with exactly two neighbours (assuming that h\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892). It won\'t be easy because Limak is a little bear and he doesn\'t even see the whole tree. Can you help him?There are t testcases. In each testcase, you should first read h from the input. Then you can ask at most 16 questions of format ""? x"" (without quotes), where x is an integer between 1 and 2h\xe2\x80\x89-\xe2\x80\x891, inclusive. As a reply you will get the list of neighbours of vertex x (more details in the ""Interaction"" section below). For example, for a tree on the drawing above after asking ""? 1"" you would get a response with 3 neighbours: 4, 5 and 7. Your goal is to find the index of the root y and print it in the format ""! y"". You will be able to read h for a next testcase only after printing the answer in a previous testcase and flushing the output.Each tree is fixed from the beginning and it doesn\'t change during your questions." 2800
750E "New Year and Old Subsequence" "data structures,divide and conquer,dp,matrices" "A string t is called nice if a string ""2017"" occurs in t as a subsequence but a string ""2016"" doesn\'t occur in t as a subsequence. For example, strings ""203434107"" and ""9220617"" are nice, while strings ""20016"", ""1234"" and ""20167"" aren\'t nice.The ugliness of a string is the minimum possible number of characters to remove, in order to obtain a nice string. If it\'s impossible to make a string nice by removing characters, its ugliness is \xe2\x80\x89-\xe2\x80\x891.Limak has a string s of length n, with characters indexed 1 through n. He asks you q queries. In the i-th query you should compute and print the ugliness of a substring (continuous subsequence) of s starting at the index ai and ending at the index bi (inclusive)." 2600
750D "New Year and Fireworks" "brute force,data structures,dfs and similar,dp,implementation" "One tradition of welcoming the New Year is launching fireworks into the sky. Usually a launched firework flies vertically upward for some period of time, then explodes, splitting into several parts flying in different directions. Sometimes those parts also explode after some period of time, splitting into even more parts, and so on.Limak, who lives in an infinite grid, has a single firework. The behaviour of the firework is described with a recursion depth n and a duration for each level of recursion t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tn. Once Limak launches the firework in some cell, the firework starts moving upward. After covering t1 cells (including the starting cell), it explodes and splits into two parts, each moving in the direction changed by 45 degrees (see the pictures below for clarification). So, one part moves in the top-left direction, while the other one moves in the top-right direction. Each part explodes again after covering t2 cells, splitting into two parts moving in directions again changed by 45 degrees. The process continues till the n-th level of recursion, when all 2n\xe2\x80\x89-\xe2\x80\x891 existing parts explode and disappear without creating new parts. After a few levels of recursion, it\'s possible that some parts will be at the same place and at the same time \xe2\x80\x94 it is allowed and such parts do not crash.Before launching the firework, Limak must make sure that nobody stands in cells which will be visited at least once by the firework. Can you count the number of those cells?" 1900
750C "New Year and Rating" "binary search,greedy,math" "Every Codeforces user has rating, described with one integer, possibly negative or zero. Users are divided into two divisions. The first division is for users with rating 1900 or higher. Those with rating 1899 or lower belong to the second division. In every contest, according to one\'s performance, his or her rating changes by some value, possibly negative or zero.Limak competed in n contests in the year 2016. He remembers that in the i-th contest he competed in the division di (i.e. he belonged to this division just before the start of this contest) and his rating changed by ci just after the contest. Note that negative ci denotes the loss of rating.What is the maximum possible rating Limak can have right now, after all n contests? If his rating may be arbitrarily big, print ""Infinity"". If there is no scenario matching the given information, print ""Impossible""." 1600
750B "New Year and North Pole" geometry,implementation "In this problem we assume the Earth to be a completely round ball and its surface a perfect sphere. The length of the equator and any meridian is considered to be exactly 40\xe2\x80\x89000 kilometers. Thus, travelling from North Pole to South Pole or vice versa takes exactly 20\xe2\x80\x89000 kilometers.Limak, a polar bear, lives on the North Pole. Close to the New Year, he helps somebody with delivering packages all around the world. Instead of coordinates of places to visit, Limak got a description how he should move, assuming that he starts from the North Pole. The description consists of n parts. In the i-th part of his journey, Limak should move ti kilometers in the direction represented by a string diri that is one of: ""North"", ""South"", ""West"", ""East"".Limak isn\xe2\x80\x99t sure whether the description is valid. You must help him to check the following conditions:  If at any moment of time (before any of the instructions or while performing one of them) Limak is on the North Pole, he can move only to the South.  If at any moment of time (before any of the instructions or while performing one of them) Limak is on the South Pole, he can move only to the North.  The journey must end on the North Pole. Check if the above conditions are satisfied and print ""YES"" or ""NO"" on a single line." 1300
750A "New Year and Hurry" "binary search,brute force,implementation,math" "Limak is going to participate in a contest on the last day of the 2016. The contest will start at 20:00 and will last four hours, exactly until midnight. There will be n problems, sorted by difficulty, i.e. problem 1 is the easiest and problem n is the hardest. Limak knows it will take him 5\xc2\xb7i minutes to solve the i-th problem.Limak\'s friends organize a New Year\'s Eve party and Limak wants to be there at midnight or earlier. He needs k minutes to get there from his house, where he will participate in the contest first.How many problems can Limak solve if he wants to make it to the party?" 800
749E "Inversions After Shuffle" "data structures,probabilities" "You are given a permutation of integers from 1 to n. Exactly once you apply the following operation to this permutation: pick a random segment and shuffle its elements. Formally:  Pick a random segment (continuous subsequence) from l to r. All  segments are equiprobable.  Let k\xe2\x80\x89=\xe2\x80\x89r\xe2\x80\x89-\xe2\x80\x89l\xe2\x80\x89+\xe2\x80\x891, i.e. the length of the chosen segment. Pick a random permutation of integers from 1 to k, p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk. All k! permutation are equiprobable.  This permutation is applied to elements of the chosen segment, i.e. permutation a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ar,\xe2\x80\x89ar\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an is transformed to a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89p1,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89pk\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89al\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89pk,\xe2\x80\x89ar\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89an. Inversion if a pair of elements (not necessary neighbouring) with the wrong relative order. In other words, the number of inversion is equal to the number of pairs (i,\xe2\x80\x89j) such that i\xe2\x80\x89<\xe2\x80\x89j and ai\xe2\x80\x89>\xe2\x80\x89aj. Find the expected number of inversions after we apply exactly one operation mentioned above." 2400
749D "Leaving Auction" "binary search,data structures" "There are n people taking part in auction today. The rules of auction are classical. There were n bids made, though it\'s not guaranteed they were from different people. It might happen that some people made no bids at all.Each bid is define by two integers (ai,\xe2\x80\x89bi), where ai is the index of the person, who made this bid and bi is its size. Bids are given in chronological order, meaning bi\xe2\x80\x89<\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891 for all i\xe2\x80\x89<\xe2\x80\x89n. Moreover, participant never makes two bids in a row (no one updates his own bid), i.e. ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ai\xe2\x80\x89+\xe2\x80\x891 for all i\xe2\x80\x89<\xe2\x80\x89n.Now you are curious with the following question: who (and which bid) will win the auction if some participants were absent? Consider that if someone was absent, all his bids are just removed and no new bids are added.Note, that if during this imaginary exclusion of some participants it happens that some of the remaining participants makes a bid twice (or more times) in a row, only first of these bids is counted. For better understanding take a look at the samples.You have several questions in your mind, compute the answer for each of them." 2000
749C Voting "greedy,implementation,two pointers" "There are n employees in Alternative Cake Manufacturing (ACM). They are now voting on some very important question and the leading world media are trying to predict the outcome of the vote.Each of the employees belongs to one of two fractions: depublicans or remocrats, and these two fractions have opposite opinions on what should be the outcome of the vote. The voting procedure is rather complicated:   Each of n employees makes a statement. They make statements one by one starting from employees 1 and finishing with employee n. If at the moment when it\'s time for the i-th employee to make a statement he no longer has the right to vote, he just skips his turn (and no longer takes part in this voting).  When employee makes a statement, he can do nothing or declare that one of the other employees no longer has a right to vote. It\'s allowed to deny from voting people who already made the statement or people who are only waiting to do so. If someone is denied from voting he no longer participates in the voting till the very end.  When all employees are done with their statements, the procedure repeats: again, each employees starting from 1 and finishing with n who are still eligible to vote make their statements.  The process repeats until there is only one employee eligible to vote remaining and he determines the outcome of the whole voting. Of course, he votes for the decision suitable for his fraction. You know the order employees are going to vote and that they behave optimal (and they also know the order and who belongs to which fraction). Predict the outcome of the vote." 1500
749B "Parallelogram is Back" "brute force,constructive algorithms,geometry" "Long time ago Alex created an interesting problem about parallelogram. The input data for this problem contained four integer points on the Cartesian plane, that defined the set of vertices of some non-degenerate (positive area) parallelogram. Points not necessary were given in the order of clockwise or counterclockwise traversal.Alex had very nice test for this problem, but is somehow happened that the last line of the input was lost and now he has only three out of four points of the original parallelogram. He remembers that test was so good that he asks you to restore it given only these three points." 1200
749A "Bachgold Problem" "greedy,implementation,math,number theory" "Bachgold problem is very easy to formulate. Given a positive integer n represent it as a sum of maximum possible number of prime numbers. One can prove that such representation exists for any integer greater than 1.Recall that integer k is called prime if it is greater than 1 and has exactly two positive integer divisors \xe2\x80\x94 1 and k." 800
748F "Santa Clauses and a Soccer Championship" "constructive algorithms,dfs and similar,graphs,trees" "The country Treeland consists of n cities connected with n\xe2\x80\x89-\xe2\x80\x891 bidirectional roads in such a way that it\'s possible to reach every city starting from any other city using these roads. There will be a soccer championship next year, and all participants are Santa Clauses. There are exactly 2k teams from 2k different cities.During the first stage all teams are divided into k pairs. Teams of each pair play two games against each other: one in the hometown of the first team, and the other in the hometown of the other team. Thus, each of the 2k cities holds exactly one soccer game. However, it\'s not decided yet how to divide teams into pairs.It\'s also necessary to choose several cities to settle players in. Organizers tend to use as few cities as possible to settle the teams.Nobody wants to travel too much during the championship, so if a team plays in cities u and v, it wants to live in one of the cities on the shortest path between u and v (maybe, in u or in v). There is another constraint also: the teams from one pair must live in the same city.Summarizing, the organizers want to divide 2k teams into pairs and settle them in the minimum possible number of cities m in such a way that teams from each pair live in the same city which lies between their hometowns." 2300
748E "Santa Claus and Tangerines" "binary search,data structures,greedy,two pointers" "Santa Claus has n tangerines, and the i-th of them consists of exactly ai slices. Santa Claus came to a school which has k pupils. Santa decided to treat them with tangerines.However, there can be too few tangerines to present at least one tangerine to each pupil. So Santa decided to divide tangerines into parts so that no one will be offended. In order to do this, he can divide a tangerine or any existing part into two smaller equal parts. If the number of slices in the part he wants to split is odd, then one of the resulting parts will have one slice more than the other. It\'s forbidden to divide a part consisting of only one slice.Santa Claus wants to present to everyone either a whole tangerine or exactly one part of it (that also means that everyone must get a positive number of slices). One or several tangerines or their parts may stay with Santa.Let bi be the number of slices the i-th pupil has in the end. Let Santa\'s joy be the minimum among all bi\'s.Your task is to find the maximum possible joy Santa can have after he treats everyone with tangerines (or their parts)." 2100
748D "Santa Claus and a Palindrome" "constructive algorithms,data structures,greedy" "Santa Claus likes palindromes very much. There was his birthday recently. k of his friends came to him to congratulate him, and each of them presented to him a string si having the same length n. We denote the beauty of the i-th string by ai. It can happen that ai is negative \xe2\x80\x94 that means that Santa doesn\'t find this string beautiful at all.Santa Claus is crazy about palindromes. He is thinking about the following question: what is the maximum possible total beauty of a palindrome which can be obtained by concatenating some (possibly all) of the strings he has? Each present can be used at most once. Note that all strings have the same length n.Recall that a palindrome is a string that doesn\'t change after one reverses it.Since the empty string is a palindrome too, the answer can\'t be negative. Even if all ai\'s are negative, Santa can obtain the empty string." 2100
748C "Santa Claus and Robot" "constructive algorithms,math" "Santa Claus has Robot which lives on the infinite grid and can move along its lines. He can also, having a sequence of m points p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pm with integer coordinates, do the following: denote its initial location by p0. First, the robot will move from p0 to p1 along one of the shortest paths between them (please notice that since the robot moves only along the grid lines, there can be several shortest paths). Then, after it reaches p1, it\'ll move to p2, again, choosing one of the shortest ways, then to p3, and so on, until he has visited all points in the given order. Some of the points in the sequence may coincide, in that case Robot will visit that point several times according to the sequence order.While Santa was away, someone gave a sequence of points to Robot. This sequence is now lost, but Robot saved the protocol of its unit movements. Please, find the minimum possible length of the sequence." 1400
748B "Santa Claus and Keyboard Check" implementation,strings "Santa Claus decided to disassemble his keyboard to clean it. After he returned all the keys back, he suddenly realized that some pairs of keys took each other\'s place! That is, Santa suspects that each key is either on its place, or on the place of another key, which is located exactly where the first key should be. In order to make sure that he\'s right and restore the correct order of keys, Santa typed his favorite patter looking only to his keyboard.You are given the Santa\'s favorite patter and the string he actually typed. Determine which pairs of keys could be mixed. Each key must occur in pairs at most once." 1500
748A "Santa Claus and a Place in a Class" implementation,math "Santa Claus is the first who came to the Christmas Olympiad, and he is going to be the first to take his place at a desk! In the classroom there are n lanes of m desks each, and there are two working places at each of the desks. The lanes are numbered from 1 to n from the left to the right, the desks in a lane are numbered from 1 to m starting from the blackboard. Note that the lanes go perpendicularly to the blackboard, not along it (see picture).The organizers numbered all the working places from 1 to 2nm. The places are numbered by lanes (i. e. all the places of the first lane go first, then all the places of the second lane, and so on), in a lane the places are numbered starting from the nearest to the blackboard (i. e. from the first desk in the lane), at each desk, the place on the left is numbered before the place on the right.  The picture illustrates the first and the second samples. Santa Clause knows that his place has number k. Help him to determine at which lane at which desk he should sit, and whether his place is on the left or on the right!" 800
747F "Igor and Interesting Numbers" "brute force,combinatorics,dp,math" "Igor likes hexadecimal notation and considers positive integer in the hexadecimal notation interesting if each digit and each letter in it appears no more than t times. For example, if t\xe2\x80\x89=\xe2\x80\x893, then integers 13a13322, aaa, abcdef0123456789 are interesting, but numbers aaaa, abababab and 1000000 are not interesting.Your task is to find the k-th smallest interesting for Igor integer in the hexadecimal notation. The integer should not contain leading zeros." 2500
747E Comments "dfs and similar,expression parsing,implementation,strings" "A rare article in the Internet is posted without a possibility to comment it. On a Polycarp\'s website each article has comments feed.Each comment on Polycarp\'s website is a non-empty string consisting of uppercase and lowercase letters of English alphabet. Comments have tree-like structure, that means each comment except root comments (comments of the highest level) has exactly one parent comment.When Polycarp wants to save comments to his hard drive he uses the following format. Each comment he writes in the following format:   at first, the text of the comment is written;  after that the number of comments is written, for which this comment is a parent comment (i. e. the number of the replies to this comments);  after that the comments for which this comment is a parent comment are written (the writing of these comments uses the same algorithm).  All elements in this format are separated by single comma. Similarly, the comments of the first level are separated by comma.For example, if the comments look like:  then the first comment is written as ""hello,2,ok,0,bye,0"", the second is written as ""test,0"", the third comment is written as ""one,1,two,2,a,0,b,0"". The whole comments feed is written as: ""hello,2,ok,0,bye,0,test,0,one,1,two,2,a,0,b,0"". For a given comments feed in the format specified above print the comments in a different format:   at first, print a integer d \xe2\x80\x94 the maximum depth of nesting comments;  after that print d lines, the i-th of them corresponds to nesting level i;  for the i-th row print comments of nesting level i in the order of their appearance in the Policarp\'s comments feed, separated by space." 1700
747D "Winter Is Coming" dp,greedy,sortings "The winter in Berland lasts n days. For each day we know the forecast for the average air temperature that day. Vasya has a new set of winter tires which allows him to drive safely no more than k days at any average air temperature. After k days of using it (regardless of the temperature of these days) the set of winter tires wears down and cannot be used more. It is not necessary that these k days form a continuous segment of days.Before the first winter day Vasya still uses summer tires. It is possible to drive safely on summer tires any number of days when the average air temperature is non-negative. It is impossible to drive on summer tires at days when the average air temperature is negative. Vasya can change summer tires to winter tires and vice versa at the beginning of any day.Find the minimum number of times Vasya needs to change summer tires to winter tires and vice versa to drive safely during the winter. At the end of the winter the car can be with any set of tires." 1800
747C Servers implementation "There are n servers in a laboratory, each of them can perform tasks. Each server has a unique id \xe2\x80\x94 integer from 1 to n.It is known that during the day q tasks will come, the i-th of them is characterized with three integers: ti \xe2\x80\x94 the moment in seconds in which the task will come, ki \xe2\x80\x94 the number of servers needed to perform it, and di \xe2\x80\x94 the time needed to perform this task in seconds. All ti are distinct.To perform the i-th task you need ki servers which are unoccupied in the second ti. After the servers begin to perform the task, each of them will be busy over the next di seconds. Thus, they will be busy in seconds ti,\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ti\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891. For performing the task, ki servers with the smallest ids will be chosen from all the unoccupied servers. If in the second ti there are not enough unoccupied servers, the task is ignored.Write the program that determines which tasks will be performed and which will be ignored." 1300
747B "Mammoth\'s Genome Decoding" implementation,strings "The process of mammoth\'s genome decoding in Berland comes to its end!One of the few remaining tasks is to restore unrecognized nucleotides in a found chain s. Each nucleotide is coded with a capital letter of English alphabet: \'A\', \'C\', \'G\' or \'T\'. Unrecognized nucleotides are coded by a question mark \'?\'. Thus, s is a string consisting of letters \'A\', \'C\', \'G\', \'T\' and characters \'?\'.It is known that the number of nucleotides of each of the four types in the decoded genome of mammoth in Berland should be equal.Your task is to decode the genome and replace each unrecognized nucleotide with one of the four types so that the number of nucleotides of each of the four types becomes equal." 900
747A "Display Size" "brute force,math" "A big company decided to launch a new series of rectangular displays, and decided that the display must have exactly n pixels. Your task is to determine the size of the rectangular display \xe2\x80\x94 the number of lines (rows) of pixels a and the number of columns of pixels b, so that:  there are exactly n pixels on the display;  the number of rows does not exceed the number of columns, it means a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b;  the difference b\xe2\x80\x89-\xe2\x80\x89a is as small as possible." 800
746G "New Roads" "constructive algorithms,graphs,trees" "There are n cities in Berland, each of them has a unique id \xe2\x80\x94 an integer from 1 to n, the capital is the one with id 1. Now there is a serious problem in Berland with roads \xe2\x80\x94 there are no roads.That is why there was a decision to build n\xe2\x80\x89-\xe2\x80\x891 roads so that there will be exactly one simple path between each pair of cities.In the construction plan t integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89at were stated, where t equals to the distance from the capital to the most distant city, concerning new roads. ai equals the number of cities which should be at the distance i from the capital. The distance between two cities is the number of roads one has to pass on the way from one city to another. Also, it was decided that among all the cities except the capital there should be exactly k cities with exactly one road going from each of them. Such cities are dead-ends and can\'t be economically attractive. In calculation of these cities the capital is not taken into consideration regardless of the number of roads from it. Your task is to offer a plan of road\'s construction which satisfies all the described conditions or to inform that it is impossible." 2100
746F "Music in Car" "data structures,greedy,two pointers" "Sasha reaches the work by car. It takes exactly k minutes. On his way he listens to music. All songs in his playlist go one by one, after listening to the i-th song Sasha gets a pleasure which equals ai. The i-th song lasts for ti minutes. Before the beginning of his way Sasha turns on some song x and then he listens to the songs one by one: at first, the song x, then the song (x\xe2\x80\x89+\xe2\x80\x891), then the song number (x\xe2\x80\x89+\xe2\x80\x892), and so on. He listens to songs until he reaches the work or until he listens to the last song in his playlist. Sasha can listen to each song to the end or partly.In the second case he listens to the song for integer number of minutes, at least half of the song\'s length. Formally, if the length of the song equals d minutes, Sasha listens to it for no less than  minutes, then he immediately switches it to the next song (if there is such). For example, if the length of the song which Sasha wants to partly listen to, equals 5 minutes, then he should listen to it for at least 3 minutes, if the length of the song equals 8 minutes, then he should listen to it for at least 4 minutes.It takes no time to switch a song.Sasha wants to listen partly no more than w songs. If the last listened song plays for less than half of its length, then Sasha doesn\'t get pleasure from it and that song is not included to the list of partly listened songs. It is not allowed to skip songs. A pleasure from a song does not depend on the listening mode, for the i-th song this value equals ai.Help Sasha to choose such x and no more than w songs for partial listening to get the maximum pleasure. Write a program to find the maximum pleasure Sasha can get from the listening to the songs on his way to the work." 2200
746E "Numbers Exchange" greedy,implementation,math "Eugeny has n cards, each of them has exactly one integer written on it. Eugeny wants to exchange some cards with Nikolay so that the number of even integers on his cards would equal the number of odd integers, and that all these numbers would be distinct. Nikolay has m cards, distinct numbers from 1 to m are written on them, one per card. It means that Nikolay has exactly one card with number 1, exactly one card with number 2 and so on. A single exchange is a process in which Eugeny gives one card to Nikolay and takes another one from those Nikolay has. Your task is to find the minimum number of card exchanges and determine which cards Eugeny should exchange." 1900
746D "Green and Black Tea" "constructive algorithms,greedy,math" "Innokentiy likes tea very much and today he wants to drink exactly n cups of tea. He would be happy to drink more but he had exactly n tea bags, a of them are green and b are black.Innokentiy doesn\'t like to drink the same tea (green or black) more than k times in a row. Your task is to determine the order of brewing tea bags so that Innokentiy will be able to drink n cups of tea, without drinking the same tea more than k times in a row, or to inform that it is impossible. Each tea bag has to be used exactly once." 1500
746C Tram "constructive algorithms,implementation,math" "The tram in Berland goes along a straight line from the point 0 to the point s and back, passing 1 meter per t1 seconds in both directions. It means that the tram is always in the state of uniform rectilinear motion, instantly turning around at points x\xe2\x80\x89=\xe2\x80\x890 and x\xe2\x80\x89=\xe2\x80\x89s.Igor is at the point x1. He should reach the point x2. Igor passes 1 meter per t2 seconds. Your task is to determine the minimum time Igor needs to get from the point x1 to the point x2, if it is known where the tram is and in what direction it goes at the moment Igor comes to the point x1.Igor can enter the tram unlimited number of times at any moment when his and the tram\'s positions coincide. It is not obligatory that points in which Igor enter and exit the tram are integers. Assume that any boarding and unboarding happens instantly. Igor can move arbitrary along the line (but not faster than 1 meter per t2 seconds). He can also stand at some point for some time." 1600
746B Decoding implementation,strings "Polycarp is mad about coding, that is why he writes Sveta encoded messages. He calls the median letter in a word the letter which is in the middle of the word. If the word\'s length is even, the median letter is the left of the two middle letters. In the following examples, the median letter is highlighted: contest, info. If the word consists of single letter, then according to above definition this letter is the median letter. Polycarp encodes each word in the following way: he writes down the median letter of the word, then deletes it and repeats the process until there are no letters left. For example, he encodes the word volga as logva.You are given an encoding s of some word, your task is to decode it." 900
746A Compote implementation,math "Nikolay has a lemons, b apples and c pears. He decided to cook a compote. According to the recipe the fruits should be in the ratio 1:\xe2\x80\x892:\xe2\x80\x894. It means that for each lemon in the compote should be exactly 2 apples and exactly 4 pears. You can\'t crumble up, break up or cut these fruits into pieces. These fruits \xe2\x80\x94 lemons, apples and pears \xe2\x80\x94 should be put in the compote as whole fruits.Your task is to determine the maximum total number of lemons, apples and pears from which Nikolay can cook the compote. It is possible that Nikolay can\'t use any fruits, in this case print 0." 800
745B "Hongcow Solves A Puzzle" implementation "Hongcow likes solving puzzles.One day, Hongcow finds two identical puzzle pieces, with the instructions ""make a rectangle"" next to them. The pieces can be described by an n by m grid of characters, where the character \'X\' denotes a part of the puzzle and \'.\' denotes an empty part of the grid. It is guaranteed that the puzzle pieces are one 4-connected piece. See the input format and samples for the exact details on how a jigsaw piece will be specified.The puzzle pieces are very heavy, so Hongcow cannot rotate or flip the puzzle pieces. However, he is allowed to move them in any directions. The puzzle pieces also cannot overlap.You are given as input the description of one of the pieces. Determine if it is possible to make a rectangle from two identical copies of the given input. The rectangle should be solid, i.e. there should be no empty holes inside it or on its border. Keep in mind that Hongcow is not allowed to flip or rotate pieces and they cannot overlap, i.e. no two \'X\' from different pieces can share the same position." 1400
745A "Hongcow Learns the Cyclic Shift" implementation,strings "Hongcow is learning to spell! One day, his teacher gives him a word that he needs to learn to spell. Being a dutiful student, he immediately learns how to spell the word.Hongcow has decided to try to make new words from this one. He starts by taking the word he just learned how to spell, and moves the last character of the word to the beginning of the word. He calls this a cyclic shift. He can apply cyclic shift many times. For example, consecutively applying cyclic shift operation to the word ""abracadabra"" Hongcow will get words ""aabracadabr"", ""raabracadab"" and so on.Hongcow is now wondering how many distinct words he can generate by doing the cyclic shift arbitrarily many times. The initial string is also counted." 900
744E "Hongcow Masters the Cyclic Shift" "strings,two pointers" "Hongcow\'s teacher heard that Hongcow had learned about the cyclic shift, and decided to set the following problem for him.You are given a list of n strings s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn contained in the list A.A list X of strings is called stable if the following condition holds.First, a message is defined as a concatenation of some elements of the list X. You can use an arbitrary element as many times as you want, and you may concatenate these elements in any arbitrary order. Let SX denote the set of of all messages you can construct from the list. Of course, this set has infinite size if your list is nonempty.Call a single message good if the following conditions hold:   Suppose the message is the concatenation of k strings w1,\xe2\x80\x89w2,\xe2\x80\x89...,\xe2\x80\x89wk, where each wi is an element of X.  Consider the |w1|\xe2\x80\x89+\xe2\x80\x89|w2|\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89|wk| cyclic shifts of the string. Let m be the number of these cyclic shifts of the string that are elements of SX.  A message is good if and only if m is exactly equal to k. The list X is called stable if and only if every element of SX is good.Let f(L) be 1 if L is a stable list, and 0 otherwise.Find the sum of f(L) where L is a nonempty contiguous sublist of A (there are  contiguous sublists in total)." 3200
744D "Hongcow Draws a Circle" geometry "Hongcow really likes the color red. Hongcow doesn\'t like the color blue.Hongcow is standing in an infinite field where there are n red points and m blue points.Hongcow wants to draw a circle in the field such that this circle contains at least one red point, and no blue points. Points that line exactly on the boundary of the circle can be counted as either inside or outside.Compute the radius of the largest circle that satisfies this condition. If this circle can have arbitrarily large size, print \xe2\x80\x89-\xe2\x80\x891. Otherwise, your answer will be accepted if it has relative or absolute error at most 10\xe2\x80\x89-\xe2\x80\x894." 3200
744C "Hongcow Buys a Deck of Cards" "bitmasks,brute force,dp" "One day, Hongcow goes to the store and sees a brand new deck of n special cards. Each individual card is either red or blue. He decides he wants to buy them immediately. To do this, he needs to play a game with the owner of the store.This game takes some number of turns to complete. On a turn, Hongcow may do one of two things:   Collect tokens. Hongcow collects 1 red token and 1 blue token by choosing this option (thus, 2 tokens in total per one operation).  Buy a card. Hongcow chooses some card and spends tokens to purchase it as specified below. The i-th card requires ri red resources and bi blue resources. Suppose Hongcow currently has A red cards and B blue cards. Then, the i-th card will require Hongcow to spend max(ri\xe2\x80\x89-\xe2\x80\x89A,\xe2\x80\x890) red tokens, and max(bi\xe2\x80\x89-\xe2\x80\x89B,\xe2\x80\x890) blue tokens. Note, only tokens disappear, but the cards stay with Hongcow forever. Each card can be bought only once.Given a description of the cards and their costs determine the minimum number of turns Hongcow needs to purchase all cards." 2400
744B "Hongcow\'s Game" "bitmasks,divide and conquer,interactive" "This is an interactive problem. In the interaction section below you will see the information about flushing the output.In this problem, you will be playing a game with Hongcow. How lucky of you!Hongcow has a hidden n by n matrix M. Let Mi,\xe2\x80\x89j denote the entry i-th row and j-th column of the matrix. The rows and columns are labeled from 1 to n.The matrix entries are between 0 and 109. In addition, Mi,\xe2\x80\x89i\xe2\x80\x89=\xe2\x80\x890 for all valid i. Your task is to find the minimum value along each row, excluding diagonal elements. Formally, for each i, you must find .To do this, you can ask Hongcow some questions.A question consists of giving Hongcow a subset of distinct indices {w1,\xe2\x80\x89w2,\xe2\x80\x89...,\xe2\x80\x89wk}, with 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n. Hongcow will respond with n integers. The i-th integer will contain the minimum value of min1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89kMi,\xe2\x80\x89wj.You may only ask Hongcow at most 20 questions \xe2\x80\x94 he thinks you only need that many questions answered.When you are ready to answer, print out a single integer \xe2\x80\x89-\xe2\x80\x891 on its own line, then n integers on the next line. The i-th integer should be the minimum value in the i-th row of the matrix, excluding the i-th element. Do not forget to flush the final answer as well. Printing the answer does not count as asking a question.You will get Wrong Answer verdict if   Your question or answers are not in the format described in this statement.  You ask strictly more than 20 questions.  Your question contains duplicate indices.  The value of k in your question does not lie in the range from 1 to n, inclusive.  Your final answer is not correct.  You will get Idleness Limit Exceeded if you don\'t print anything or if you forget to flush the output, including for the final answer (more info about flushing output below)." 1900
744A "Hongcow Builds A Nation" "dfs and similar,graphs" "Hongcow is ruler of the world. As ruler of the world, he wants to make it easier for people to travel by road within their own countries.The world can be modeled as an undirected graph with n nodes and m edges. k of the nodes are home to the governments of the k countries that make up the world.There is at most one edge connecting any two nodes and no edge connects a node to itself. Furthermore, for any two nodes corresponding to governments, there is no path between those two nodes. Any graph that satisfies all of these conditions is stable.Hongcow wants to add as many edges as possible to the graph while keeping it stable. Determine the maximum number of edges Hongcow can add." 1500
743E "Vladik and cards" "binary search,bitmasks,brute force,dp" "Vladik was bored on his way home and decided to play the following game. He took n cards and put them in a row in front of himself. Every card has a positive integer number not exceeding 8 written on it. He decided to find the longest subsequence of cards which satisfies the following conditions:  the number of occurrences of each number from 1 to 8 in the subsequence doesn\'t differ by more then 1 from the number of occurrences of any other number. Formally, if there are ck cards with number k on them in the subsequence, than for all pairs of integers  the condition |ci\xe2\x80\x89-\xe2\x80\x89cj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891 must hold.  if there is at least one card with number x on it in the subsequence, then all cards with number x in this subsequence must form a continuous segment in it (but not necessarily a continuous segment in the original sequence). For example, the subsequence [1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892] satisfies this condition while the subsequence [1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x891] doesn\'t. Note that [1,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892] doesn\'t satisfy the first condition. Please help Vladik to find the length of the longest subsequence that satisfies both conditions." 2200
743D "Chloe and pleasant prizes" "dfs and similar,dp,graphs,trees" "Generous sponsors of the olympiad in which Chloe and Vladik took part allowed all the participants to choose a prize for them on their own. Christmas is coming, so sponsors decided to decorate the Christmas tree with their prizes. They took n prizes for the contestants and wrote on each of them a unique id (integer from 1 to n). A gift i is characterized by integer ai \xe2\x80\x94 pleasantness of the gift. The pleasantness of the gift can be positive, negative or zero. Sponsors placed the gift 1 on the top of the tree. All the other gifts hung on a rope tied to some other gift so that each gift hung on the first gift, possibly with a sequence of ropes and another gifts. Formally, the gifts formed a rooted tree with n vertices.The prize-giving procedure goes in the following way: the participants come to the tree one after another, choose any of the remaining gifts and cut the rope this prize hang on. Note that all the ropes which were used to hang other prizes on the chosen one are not cut. So the contestant gets the chosen gift as well as the all the gifts that hang on it, possibly with a sequence of ropes and another gifts.Our friends, Chloe and Vladik, shared the first place on the olympiad and they will choose prizes at the same time! To keep themselves from fighting, they decided to choose two different gifts so that the sets of the gifts that hang on them with a sequence of ropes and another gifts don\'t intersect. In other words, there shouldn\'t be any gift that hang both on the gift chosen by Chloe and on the gift chosen by Vladik. From all of the possible variants they will choose such pair of prizes that the sum of pleasantness of all the gifts that they will take after cutting the ropes is as large as possible.Print the maximum sum of pleasantness that Vladik and Chloe can get. If it is impossible for them to choose the gifts without fighting, print Impossible." 1800
743C "Vladik and fractions" "brute force,constructive algorithms,math,number theory" "Vladik and Chloe decided to determine who of them is better at math. Vladik claimed that for any positive integer n he can represent fraction  as a sum of three distinct positive fractions in form .Help Vladik with that, i.e for a given n find three distinct positive integers x, y and z such that . Because Chloe can\'t check Vladik\'s answer if the numbers are large, he asks you to print numbers not exceeding 109.If there is no such answer, print -1." 1500
743B "Chloe and the sequence" "binary search,bitmasks,constructive algorithms,implementation" "Chloe, the same as Vladik, is a competitive programmer. She didn\'t have any problems to get to the olympiad like Vladik, but she was confused by the task proposed on the olympiad.Let\'s consider the following algorithm of generating a sequence of integers. Initially we have a sequence consisting of a single element equal to 1. Then we perform (n\xe2\x80\x89-\xe2\x80\x891) steps. On each step we take the sequence we\'ve got on the previous step, append it to the end of itself and insert in the middle the minimum positive integer we haven\'t used before. For example, we get the sequence [1,\xe2\x80\x892,\xe2\x80\x891] after the first step, the sequence [1,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x891] after the second step.The task is to find the value of the element with index k (the elements are numbered from 1) in the obtained sequence, i. e. after (n\xe2\x80\x89-\xe2\x80\x891) steps.Please help Chloe to solve the problem!" 1200
743A "Vladik and flights" "constructive algorithms,greedy,implementation" "Vladik is a competitive programmer. This year he is going to win the International Olympiad in Informatics. But it is not as easy as it sounds: the question Vladik face now is to find the cheapest way to get to the olympiad.Vladik knows n airports. All the airports are located on a straight line. Each airport has unique id from 1 to n, Vladik\'s house is situated next to the airport with id a, and the place of the olympiad is situated next to the airport with id b. It is possible that Vladik\'s house and the place of the olympiad are located near the same airport. To get to the olympiad, Vladik can fly between any pair of airports any number of times, but he has to start his route at the airport a and finish it at the airport b.Each airport belongs to one of two companies. The cost of flight from the airport i to the airport j is zero if both airports belong to the same company, and |i\xe2\x80\x89-\xe2\x80\x89j| if they belong to different companies.Print the minimum cost Vladik has to pay to get to the olympiad." 1200
742B "Arpa\xe2\x80\x99s obvious problem and Mehrdad\xe2\x80\x99s terrible solution" "brute force,math,number theory" "There are some beautiful girls in Arpa\xe2\x80\x99s land as mentioned before.Once Arpa came up with an obvious problem:Given an array and a number x, count the number of pairs of indices i,\xe2\x80\x89j (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) such that , where  is bitwise xor operation (see notes for explanation).  Immediately, Mehrdad discovered a terrible solution that nobody trusted. Now Arpa needs your help to implement the solution to that problem." 1500
742A "Arpa\xe2\x80\x99s hard exam and Mehrdad\xe2\x80\x99s naive cheat" "implementation,math,number theory" "There exists an island called Arpa\xe2\x80\x99s land, some beautiful girls live there, as ugly ones do.Mehrdad wants to become minister of Arpa\xe2\x80\x99s land. Arpa has prepared an exam. Exam has only one question, given n, print the last digit of 1378n.   Mehrdad has become quite confused and wants you to help him. Please help, although it\'s a naive cheat." 1000
741E "Arpa\xe2\x80\x99s abnormal DNA and Mehrdad\xe2\x80\x99s deep interest" "data structures,string suffix structures" "All of us know that girls in Arpa\xe2\x80\x99s land are... ok, you\xe2\x80\x99ve got the idea :DAnyone knows that Arpa isn\'t a normal man, he is ... well, sorry, I can\'t explain it more. Mehrdad is interested about the reason, so he asked Sipa, one of the best biology scientists in Arpa\'s land, for help. Sipa has a DNA editor.  Sipa put Arpa under the DNA editor. DNA editor showed Arpa\'s DNA as a string S consisting of n lowercase English letters. Also Sipa has another DNA T consisting of lowercase English letters that belongs to a normal man.Now there are (n\xe2\x80\x89+\xe2\x80\x891) options to change Arpa\'s DNA, numbered from 0 to n. i-th of them is to put T between i-th and (i\xe2\x80\x89+\xe2\x80\x891)-th characters of S (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n). If i\xe2\x80\x89=\xe2\x80\x890, T will be put before S, and if i\xe2\x80\x89=\xe2\x80\x89n, it will be put after S.Mehrdad wants to choose the most interesting option for Arpa\'s DNA among these n\xe2\x80\x89+\xe2\x80\x891 options. DNA A is more interesting than B if A is lexicographically smaller than B. Mehrdad asked Sipa q questions: Given integers l,\xe2\x80\x89r,\xe2\x80\x89k,\xe2\x80\x89x,\xe2\x80\x89y, what is the most interesting option if we only consider such options i that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r and ? If there are several most interesting options, Mehrdad wants to know one with the smallest number i.Since Sipa is a biology scientist but not a programmer, you should help him." 3400
741D "Arpa\xe2\x80\x99s letter-marked tree and Mehrdad\xe2\x80\x99s Dokhtar-kosh paths" "data structures,dfs and similar,trees" "Just in case somebody missed it: we have wonderful girls in Arpa\xe2\x80\x99s land.Arpa has a rooted tree (connected acyclic graph) consisting of n vertices. The vertices are numbered 1 through n, the vertex 1 is the root. There is a letter written on each edge of this tree. Mehrdad is a fan of Dokhtar-kosh things. He call a string Dokhtar-kosh, if we can shuffle the characters in string such that it becomes palindrome.  He asks Arpa, for each vertex v, what is the length of the longest simple path in subtree of v that form a Dokhtar-kosh string." 2900
741C "Arpa\xe2\x80\x99s overnight party and Mehrdad\xe2\x80\x99s silent entering" "constructive algorithms,dfs and similar,graphs" "Note that girls in Arpa\xe2\x80\x99s land are really attractive.Arpa loves overnight parties. In the middle of one of these parties Mehrdad suddenly appeared. He saw n pairs of friends sitting around a table. i-th pair consisted of a boy, sitting on the ai-th chair, and his girlfriend, sitting on the bi-th chair. The chairs were numbered 1 through 2n in clockwise direction. There was exactly one person sitting on each chair.  There were two types of food: Kooft and Zahre-mar. Now Mehrdad wonders, was there any way to serve food for the guests such that:   Each person had exactly one type of food,  No boy had the same type of food as his girlfriend,  Among any three guests sitting on consecutive chairs, there was two of them who had different type of food. Note that chairs 2n and 1 are considered consecutive. Find the answer for the Mehrdad question. If it was possible, find some arrangement of food types that satisfies the conditions." 2600
741B "Arpa\'s weak amphitheater and Mehrdad\'s valuable Hoses" "dfs and similar,dp,dsu" "Just to remind, girls in Arpa\'s land are really nice.Mehrdad wants to invite some Hoses to the palace for a dancing party. Each Hos has some weight wi and some beauty bi. Also each Hos may have some friends. Hoses are divided in some friendship groups. Two Hoses x and y are in the same friendship group if and only if there is a sequence of Hoses a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak such that ai and ai\xe2\x80\x89+\xe2\x80\x891 are friends for each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k, and a1\xe2\x80\x89=\xe2\x80\x89x and ak\xe2\x80\x89=\xe2\x80\x89y.  Arpa allowed to use the amphitheater of palace to Mehrdad for this party. Arpa\'s amphitheater can hold at most w weight on it. Mehrdad is so greedy that he wants to invite some Hoses such that sum of their weights is not greater than w and sum of their beauties is as large as possible. Along with that, from each friendship group he can either invite all Hoses, or no more than one. Otherwise, some Hoses will be hurt. Find for Mehrdad the maximum possible total beauty of Hoses he can invite so that no one gets hurt and the total weight doesn\'t exceed w." 1600
741A "Arpa\'s loud Owf and Mehrdad\'s evil plan" "dfs and similar,math" "As you have noticed, there are lovely girls in Arpa\xe2\x80\x99s land.People in Arpa\'s land are numbered from 1 to n. Everyone has exactly one crush, i-th person\'s crush is person with the number crushi.  Someday Arpa shouted Owf loudly from the top of the palace and a funny game started in Arpa\'s land. The rules are as follows.The game consists of rounds. Assume person x wants to start a round, he calls crushx and says: ""Oww...wwf"" (the letter w is repeated t times) and cuts off the phone immediately. If t\xe2\x80\x89>\xe2\x80\x891 then crushx calls crushcrushx and says: ""Oww...wwf"" (the letter w is repeated t\xe2\x80\x89-\xe2\x80\x891 times) and cuts off the phone immediately. The round continues until some person receives an ""Owf"" (t\xe2\x80\x89=\xe2\x80\x891). This person is called the Joon-Joon of the round. There can\'t be two rounds at the same time.Mehrdad has an evil plan to make the game more funny, he wants to find smallest t (t\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x891) such that for each person x, if x starts some round and y becomes the Joon-Joon of the round, then by starting from y, x would become the Joon-Joon of the round. Find such t for Mehrdad if it\'s possible.Some strange fact in Arpa\'s land is that someone can be himself\'s crush (i.e. crushi\xe2\x80\x89=\xe2\x80\x89i)." 1600
740B "Alyona and flowers" "constructive algorithms" "Little Alyona is celebrating Happy Birthday! Her mother has an array of n flowers. Each flower has some mood, the mood of i-th flower is ai. The mood can be positive, zero or negative.Let\'s define a subarray as a segment of consecutive flowers. The mother suggested some set of subarrays. Alyona wants to choose several of the subarrays suggested by her mother. After that, each of the flowers will add to the girl\'s happiness its mood multiplied by the number of chosen subarrays the flower is in.For example, consider the case when the mother has 5 flowers, and their moods are equal to 1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x894. Suppose the mother suggested subarrays (1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892), (3,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x894), (1,\xe2\x80\x893), (1,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x893). Then if the girl chooses the third and the fourth subarrays then:   the first flower adds 1\xc2\xb71\xe2\x80\x89=\xe2\x80\x891 to the girl\'s happiness, because he is in one of chosen subarrays,  the second flower adds (\xe2\x80\x89-\xe2\x80\x892)\xc2\xb71\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892, because he is in one of chosen subarrays,  the third flower adds 1\xc2\xb72\xe2\x80\x89=\xe2\x80\x892, because he is in two of chosen subarrays,  the fourth flower adds 3\xc2\xb72\xe2\x80\x89=\xe2\x80\x896, because he is in two of chosen subarrays,  the fifth flower adds (\xe2\x80\x89-\xe2\x80\x894)\xc2\xb70\xe2\x80\x89=\xe2\x80\x890, because he is in no chosen subarrays. Thus, in total 1\xe2\x80\x89+\xe2\x80\x89(\xe2\x80\x89-\xe2\x80\x892)\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x896\xe2\x80\x89+\xe2\x80\x890\xe2\x80\x89=\xe2\x80\x897 is added to the girl\'s happiness. Alyona wants to choose such subarrays from those suggested by the mother that the value added to her happiness would be as large as possible. Help her do this!Alyona can choose any number of the subarrays, even 0 or all suggested by her mother." 1200
740A "Alyona and copybooks" "brute force,implementation" "Little girl Alyona is in a shop to buy some copybooks for school. She study four subjects so she wants to have equal number of copybooks for each of the subjects. There are three types of copybook\'s packs in the shop: it is possible to buy one copybook for a rubles, a pack of two copybooks for b rubles, and a pack of three copybooks for c rubles. Alyona already has n copybooks.What is the minimum amount of rubles she should pay to buy such number of copybooks k that n\xe2\x80\x89+\xe2\x80\x89k is divisible by 4? There are infinitely many packs of any type in the shop. Alyona can buy packs of different type in the same purchase." 1300
739E "Gosha is hunting" "brute force,data structures,dp,flows,math,probabilities,sortings" "Gosha is hunting. His goal is to catch as many Pokemons as possible. Gosha has a Poke Balls and b Ultra Balls. There are n Pokemons. They are numbered 1 through n. Gosha knows that if he throws a Poke Ball at the i-th Pokemon he catches it with probability pi. If he throws an Ultra Ball at the i-th Pokemon he catches it with probability ui. He can throw at most one Ball of each type at any Pokemon.The hunting proceeds as follows: at first, Gosha chooses no more than a Pokemons at which he will throw Poke Balls and no more than b Pokemons at which he will throw Ultra Balls. After that, he throws the chosen Balls at the chosen Pokemons. If he throws both Ultra Ball and Poke Ball at some Pokemon, he is caught if and only if he is caught by any of these Balls. The outcome of a throw doesn\'t depend on the other throws.Gosha would like to know what is the expected number of the Pokemons he catches if he acts in an optimal way. In other words, he would like to know the maximum possible expected number of Pokemons can catch." 3000
739D "Recover a functional graph" "graph matchings" "Functional graph is a directed graph in which all vertices have outdegree equal to 1. Loops are allowed.Some vertices of a functional graph lay on a cycle. From the others we can come to a cycle by making a finite number of steps along the edges (we consider only finite functional graphs in this problem).Let\'s compute two values for each vertex. precyclei is the amount of edges we should pass to get to a vertex which is a part of some cycle (zero, if i itself lies on a cycle), cyclei is the length of the cycle we get to.You are given the information about these values for some functional graph. For each vertex you know the values precyclei and cyclei, however, instead of some values there can be the question mark. It means that these values are unknown.Build any functional graph that suits the description or determine that there is no such graph." 3400
739C "Alyona and towers" "data structures" "Alyona has built n towers by putting small cubes some on the top of others. Each cube has size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891\xe2\x80\x89\xc3\x97\xe2\x80\x891. A tower is a non-zero amount of cubes standing on the top of each other. The towers are next to each other, forming a row.Sometimes Alyona chooses some segment towers, and put on the top of each tower several cubes. Formally, Alyouna chooses some segment of towers from li to ri and adds di cubes on the top of them.Let the sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an be the heights of the towers from left to right. Let\'s call as a segment of towers al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar a hill if the following condition holds: there is integer k (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) such that al\xe2\x80\x89<\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89ak\xe2\x80\x89>\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89ak\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89>\xe2\x80\x89...\xe2\x80\x89>\xe2\x80\x89ar.After each addition of di cubes on the top of the towers from li to ri, Alyona wants to know the maximum width among all hills. The width of a hill is the number of towers in it." 2500
739B "Alyona and a tree" "binary search,data structures,dfs and similar,graphs,trees" "Alyona has a tree with n vertices. The root of the tree is the vertex 1. In each vertex Alyona wrote an positive integer, in the vertex i she wrote ai. Moreover, the girl wrote a positive integer to every edge of the tree (possibly, different integers on different edges).Let\'s define dist(v,\xe2\x80\x89u) as the sum of the integers written on the edges of the simple path from v to u.The vertex v controls the vertex u (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89u) if and only if u is in the subtree of v and dist(v,\xe2\x80\x89u)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89au.Alyona wants to settle in some vertex. In order to do this, she wants to know for each vertex v what is the number of vertices u such that v controls u." 1900
739A "Alyona and mex" "constructive algorithms,greedy" "Alyona\'s mother wants to present an array of n non-negative integers to Alyona. The array should be special. Alyona is a capricious girl so after she gets the array, she inspects m of its subarrays. Subarray is a set of some subsequent elements of the array. The i-th subarray is described with two integers li and ri, and its elements are a[li],\xe2\x80\x89a[li\xe2\x80\x89+\xe2\x80\x891],\xe2\x80\x89...,\xe2\x80\x89a[ri].Alyona is going to find mex for each of the chosen subarrays. Among these m mexes the girl is going to find the smallest. She wants this minimum mex to be as large as possible. You are to find an array a of n elements so that the minimum mex among those chosen by Alyona subarrays is as large as possible.The mex of a set S is a minimum possible non-negative integer that is not in S." 1700
737F "Dirty plates" "constructive algorithms,math" "After one of celebrations there is a stack of dirty plates in Nikita\'s kitchen. Nikita has to wash them and put into a dryer. In dryer, the plates should be also placed in a stack also, and the plates sizes should increase down up. The sizes of all plates are distinct.Nikita has no so much free space, specifically, he has a place for only one more stack of plates. Therefore, he can perform only such two operations:   Take any number of plates from 1 to a from the top of the dirty stack, wash them and put them to the intermediate stack.  Take any number of plates from 1 to b from the top of the intermediate stack and put them to the stack in the dryer. Note that after performing each of the operations, the plates are put in the same order as they were before the operation.You are given the sizes of the plates s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sn in the down up order in the dirty stack, and integers a and b. All the sizes are distinct. Write a program that determines whether or not Nikita can put the plates in increasing down up order in the dryer. If he is able to do so, the program should find some sequence of operations (not necessary optimal) to achieve it." 3300
737E "Tanya is 5!" "graph matchings,graphs,greedy,schedules" "Tanya is now five so all her friends gathered together to celebrate her birthday. There are n children on the celebration, including Tanya.The celebration is close to its end, and the last planned attraction is gaming machines. There are m machines in the hall, they are numbered 1 through m. Each of the children has a list of machines he wants to play on. Moreover, for each of the machines he knows the exact time he wants to play on it. For every machine, no more than one child can play on this machine at the same time.It is evening already, so every adult wants to go home. To speed up the process, you can additionally rent second copies of each of the machines. To rent the second copy of the j-th machine, you have to pay pj burles. After you rent a machine, you can use it for as long as you want.How long it will take to make every child play according to his plan, if you have a budget of b burles for renting additional machines? There is only one copy of each machine, so it\'s impossible to rent a third machine of the same type.The children can interrupt the game in any moment and continue it later. If the i-th child wants to play on the j-th machine, it is allowed after you rent the copy of the j-th machine that this child would play some part of the time on the j-th machine and some part of the time on its copy (each of these parts could be empty). The interruptions and changes take no time and can be performed in any integer moment of time. Of course, a child can\'t play on more than one machine at the same time.Remember, that it is not needed to save money (no one saves money at the expense of children happiness!), it is needed to minimize the latest moment of time some child ends his game." 3300
736E "Chess Championship" "constructive algorithms,flows,greedy,math" "Ostap is preparing to play chess again and this time he is about to prepare. Thus, he was closely monitoring one recent chess tournament. There were m players participating and each pair of players played exactly one game. The victory gives 2 points, draw \xe2\x80\x94 1 points, lose \xe2\x80\x94 0 points.Ostap is lazy, so he never tries to remember the outcome of each game. Instead, he computes the total number of points earned by each of the players (the sum of his points in all games which he took part in), sort these value in non-ascending order and then remembers first n integers in this list.Now the Great Strategist Ostap wonders whether he remembers everything correct. He considers that he is correct if there exists at least one tournament results table such that it will produce the given integers. That means, if we count the sum of points for each player, sort them and take first n elements, the result will coincide with what Ostap remembers. Can you check if such table exists?" 2900
736D Permutations math,matrices "Ostap Bender is worried that people started to forget that he is the Great Combinator. Now he wants to show them his skills in combinatorics. Now he studies the permutations of length n. He has a list of m valid pairs, pair ai and bi means that he is allowed to place integers bi at position ai.He knows that the number of permutations that use only valid pairs is odd. Now, for each pair he wants to find out, will the number of valid permutations be odd if he removes this pair (and only it) from the list." 2800
735E "Ostap and Tree" dp,trees "Ostap already settled down in Rio de Janiero suburb and started to grow a tree in his garden. Recall that a tree is a connected undirected acyclic graph. Ostap\'s tree now has n vertices. He wants to paint some vertices of the tree black such that from any vertex u there is at least one black vertex v at distance no more than k. Distance between two vertices of the tree is the minimum possible number of edges of the path between them.As this number of ways to paint the tree can be large, Ostap wants you to compute it modulo 109\xe2\x80\x89+\xe2\x80\x897. Two ways to paint the tree are considered different if there exists a vertex that is painted black in one way and is not painted in the other one." 2500
735D Taxes "math,number theory" "Mr. Funt now lives in a country with a very specific tax laws. The total income of mr. Funt during this year is equal to n (n\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892) burles and the amount of tax he has to pay is calculated as the maximum divisor of n (not equal to n, of course). For example, if n\xe2\x80\x89=\xe2\x80\x896 then Funt has to pay 3 burles, while for n\xe2\x80\x89=\xe2\x80\x8925 he needs to pay 5 and if n\xe2\x80\x89=\xe2\x80\x892 he pays only 1 burle.As mr. Funt is a very opportunistic person he wants to cheat a bit. In particular, he wants to split the initial n in several parts n1\xe2\x80\x89+\xe2\x80\x89n2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89nk\xe2\x80\x89=\xe2\x80\x89n (here k is arbitrary, even k\xe2\x80\x89=\xe2\x80\x891 is allowed) and pay the taxes for each part separately. He can\'t make some part equal to 1 because it will reveal him. So, the condition ni\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 should hold for all i from 1 to k.Ostap Bender wonders, how many money Funt has to pay (i.e. minimal) if he chooses and optimal way to split n in parts." 1600
735C "Tennis Championship" "combinatorics,constructive algorithms,greedy,math" "Famous Brazil city Rio de Janeiro holds a tennis tournament and Ostap Bender doesn\'t want to miss this event. There will be n players participating, and the tournament will follow knockout rules from the very first game. That means, that if someone loses a game he leaves the tournament immediately.Organizers are still arranging tournament grid (i.e. the order games will happen and who is going to play with whom) but they have already fixed one rule: two players can play against each other only if the number of games one of them has already played differs by no more than one from the number of games the other one has already played. Of course, both players had to win all their games in order to continue participating in the tournament.Tournament hasn\'t started yet so the audience is a bit bored. Ostap decided to find out what is the maximum number of games the winner of the tournament can take part in (assuming the rule above is used). However, it is unlikely he can deal with this problem without your help." 1600
735B Urbanization "greedy,number theory,sortings" "Local authorities have heard a lot about combinatorial abilities of Ostap Bender so they decided to ask his help in the question of urbanization. There are n people who plan to move to the cities. The wealth of the i of them is equal to ai. Authorities plan to build two cities, first for n1 people and second for n2 people. Of course, each of n candidates can settle in only one of the cities. Thus, first some subset of candidates of size n1 settle in the first city and then some subset of size n2 is chosen among the remaining candidates and the move to the second city. All other candidates receive an official refuse and go back home.To make the statistic of local region look better in the eyes of their bosses, local authorities decided to pick subsets of candidates in such a way that the sum of arithmetic mean of wealth of people in each of the cities is as large as possible. Arithmetic mean of wealth in one city is the sum of wealth ai among all its residents divided by the number of them (n1 or n2 depending on the city). The division should be done in real numbers without any rounding.Please, help authorities find the optimal way to pick residents for two cities." 1100
735A "Ostap and Grasshopper" implementation,strings "On the way to Rio de Janeiro Ostap kills time playing with a grasshopper he took with him in a special box. Ostap builds a line of length n such that some cells of this line are empty and some contain obstacles. Then, he places his grasshopper to one of the empty cells and a small insect in another empty cell. The grasshopper wants to eat the insect.Ostap knows that grasshopper is able to jump to any empty cell that is exactly k cells away from the current (to the left or to the right). Note that it doesn\'t matter whether intermediate cells are empty or not as the grasshopper makes a jump over them. For example, if k\xe2\x80\x89=\xe2\x80\x891 the grasshopper can jump to a neighboring cell only, and if k\xe2\x80\x89=\xe2\x80\x892 the grasshopper can jump over a single cell.Your goal is to determine whether there is a sequence of jumps such that grasshopper will get from his initial position to the cell with an insect." 800
734F "Anton and School" "bitmasks,constructive algorithms,implementation,math" "Anton goes to school, his favorite lessons are arraystudying. He usually solves all the tasks pretty fast, but this time the teacher gave him a complicated one: given two arrays b and c of length n, find array a, such that:where a and b means bitwise AND, while a or b means bitwise OR.Usually Anton is good in arraystudying, but this problem is too hard, so Anton asks you to help." 2500
734E "Anton and Tree" "dfs and similar,dp,trees" "Anton is growing a tree in his garden. In case you forgot, the tree is a connected acyclic undirected graph.There are n vertices in the tree, each of them is painted black or white. Anton doesn\'t like multicolored trees, so he wants to change the tree such that all vertices have the same color (black or white).To change the colors Anton can use only operations of one type. We denote it as paint(v), where v is some vertex of the tree. This operation changes the color of all vertices u such that all vertices on the shortest path from v to u have the same color (including v and u). For example, consider the tree  and apply operation paint(3) to get the following:  Anton is interested in the minimum number of operation he needs to perform in order to make the colors of all vertices equal." 2100
734D "Anton and Chess" implementation "Anton likes to play chess. Also, he likes to do programming. That is why he decided to write the program that plays chess. However, he finds the game on 8 to 8 board to too simple, he uses an infinite one instead.The first task he faced is to check whether the king is in check. Anton doesn\'t know how to implement this so he asks you to help.Consider that an infinite chess board contains one white king and the number of black pieces. There are only rooks, bishops and queens, as the other pieces are not supported yet. The white king is said to be in check if at least one black piece can reach the cell with the king in one move. Help Anton and write the program that for the given position determines whether the white king is in check.Remainder, on how do chess pieces move:   Bishop moves any number of cells diagonally, but it can\'t ""leap"" over the occupied cells.  Rook moves any number of cells horizontally or vertically, but it also can\'t ""leap"" over the occupied cells.  Queen is able to move any number of cells horizontally, vertically or diagonally, but it also can\'t ""leap""." 1700
734C "Anton and Making Potions" "binary search,dp,greedy,two pointers" "Anton is playing a very interesting computer game, but now he is stuck at one of the levels. To pass to the next level he has to prepare n potions.Anton has a special kettle, that can prepare one potions in x seconds. Also, he knows spells of two types that can faster the process of preparing potions.  Spells of this type speed up the preparation time of one potion. There are m spells of this type, the i-th of them costs bi manapoints and changes the preparation time of each potion to ai instead of x.  Spells of this type immediately prepare some number of potions. There are k such spells, the i-th of them costs di manapoints and instantly create ci potions. Anton can use no more than one spell of the first type and no more than one spell of the second type, and the total number of manapoints spent should not exceed s. Consider that all spells are used instantly and right before Anton starts to prepare potions.Anton wants to get to the next level as fast as possible, so he is interested in the minimum number of time he needs to spent in order to prepare at least n potions." 1600
734B "Anton and Digits" "brute force,greedy,implementation,math" "Recently Anton found a box with digits in his room. There are k2 digits 2, k3 digits 3, k5 digits 5 and k6 digits 6.Anton\'s favorite integers are 32 and 256. He decided to compose this integers from digits he has. He wants to make the sum of these integers as large as possible. Help him solve this task!Each digit can be used no more than once, i.e. the composed integers should contain no more than k2 digits 2, k3 digits 3 and so on. Of course, unused digits are not counted in the sum." 800
734A "Anton and Danik" implementation,strings "Anton likes to play chess, and so does his friend Danik.Once they have played n games in a row. For each game it\'s known who was the winner \xe2\x80\x94 Anton or Danik. None of the games ended with a tie.Now Anton wonders, who won more games, he or Danik? Help him determine this." 800
733F "Drivers Dissatisfaction" "data structures,dsu,graphs,trees" "In one kingdom there are n cities and m two-way roads. Each road connects a pair of cities, and for each road we know the level of drivers dissatisfaction \xe2\x80\x94 the value wi.For each road we know the value ci \xe2\x80\x94 how many lamziks we should spend to reduce the level of dissatisfaction with this road by one. Thus, to reduce the dissatisfaction with the i-th road by k, we should spend k\xc2\xb7ci lamziks. And it is allowed for the dissatisfaction to become zero or even negative.In accordance with the king\'s order, we need to choose n\xe2\x80\x89-\xe2\x80\x891 roads and make them the main roads. An important condition must hold: it should be possible to travel from any city to any other by the main roads.The road ministry has a budget of S lamziks for the reform. The ministry is going to spend this budget for repair of some roads (to reduce the dissatisfaction with them), and then to choose the n\xe2\x80\x89-\xe2\x80\x891 main roads.Help to spend the budget in such a way and then to choose the main roads so that the total dissatisfaction with the main roads will be as small as possible. The dissatisfaction with some roads can become negative. It is not necessary to spend whole budget S.It is guaranteed that it is possible to travel from any city to any other using existing roads. Each road in the kingdom is a two-way road." 2200
733E "Sleep in Class" "constructive algorithms,data structures,math,two pointers" "The academic year has just begun, but lessons and olympiads have already occupied all the free time. It is not a surprise that today Olga fell asleep on the Literature. She had a dream in which she was on a stairs. The stairs consists of n steps. The steps are numbered from bottom to top, it means that the lowest step has number 1, and the highest step has number n. Above each of them there is a pointer with the direction (up or down) Olga should move from this step. As soon as Olga goes to the next step, the direction of the pointer (above the step she leaves) changes. It means that the direction ""up"" changes to ""down"", the direction ""down""  \xe2\x80\x94  to the direction ""up"".Olga always moves to the next step in the direction which is shown on the pointer above the step. If Olga moves beyond the stairs, she will fall and wake up. Moving beyond the stairs is a moving down from the first step or moving up from the last one (it means the n-th) step. In one second Olga moves one step up or down according to the direction of the pointer which is located above the step on which Olga had been at the beginning of the second. For each step find the duration of the dream if Olga was at this step at the beginning of the dream.Olga\'s fall also takes one second, so if she was on the first step and went down, she would wake up in the next second." 2400
733D "Kostya the Sculptor" "data structures,hashing" "Kostya is a genial sculptor, he has an idea: to carve a marble sculpture in the shape of a sphere. Kostya has a friend Zahar who works at a career. Zahar knows about Kostya\'s idea and wants to present him a rectangular parallelepiped of marble from which he can carve the sphere. Zahar has n stones which are rectangular parallelepipeds. The edges sizes of the i-th of them are ai, bi and ci. He can take no more than two stones and present them to Kostya. If Zahar takes two stones, he should glue them together on one of the faces in order to get a new piece of rectangular parallelepiped of marble. Thus, it is possible to glue a pair of stones together if and only if two faces on which they are glued together match as rectangles. In such gluing it is allowed to rotate and flip the stones in any way. Help Zahar choose such a present so that Kostya can carve a sphere of the maximum possible volume and present it to Zahar." 1600
733C "Epidemic in Monstropolis" "constructive algorithms,dp,greedy,two pointers" "There was an epidemic in Monstropolis and all monsters became sick. To recover, all monsters lined up in queue for an appointment to the only doctor in the city.Soon, monsters became hungry and began to eat each other. One monster can eat other monster if its weight is strictly greater than the weight of the monster being eaten, and they stand in the queue next to each other. Monsters eat each other instantly. There are no monsters which are being eaten at the same moment. After the monster A eats the monster B, the weight of the monster A increases by the weight of the eaten monster B. In result of such eating the length of the queue decreases by one, all monsters after the eaten one step forward so that there is no empty places in the queue again. A monster can eat several monsters one after another. Initially there were n monsters in the queue, the i-th of which had weight ai.For example, if weights are [1,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x892] (in order of queue, monsters are numbered from 1 to 6 from left to right) then some of the options are:  the first monster can\'t eat the second monster because a1\xe2\x80\x89=\xe2\x80\x891 is not greater than a2\xe2\x80\x89=\xe2\x80\x892;  the second monster can\'t eat the third monster because a2\xe2\x80\x89=\xe2\x80\x892 is not greater than a3\xe2\x80\x89=\xe2\x80\x892;  the second monster can\'t eat the fifth monster because they are not neighbors;  the second monster can eat the first monster, the queue will be transformed to [3,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x892]. After some time, someone said a good joke and all monsters recovered. At that moment there were k (k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) monsters in the queue, the j-th of which had weight bj. Both sequences (a and b) contain the weights of the monsters in the order from the first to the last.You are required to provide one of the possible orders of eating monsters which led to the current queue, or to determine that this could not happen. Assume that the doctor didn\'t make any appointments while monsters were eating each other." 1800
733B Parade math "Very soon there will be a parade of victory over alien invaders in Berland. Unfortunately, all soldiers died in the war and now the army consists of entirely new recruits, many of whom do not even know from which leg they should begin to march. The civilian population also poorly understands from which leg recruits begin to march, so it is only important how many soldiers march in step.There will be n columns participating in the parade, the i-th column consists of li soldiers, who start to march from left leg, and ri soldiers, who start to march from right leg.The beauty of the parade is calculated by the following formula: if L is the total number of soldiers on the parade who start to march from the left leg, and R is the total number of soldiers on the parade who start to march from the right leg, so the beauty will equal |L\xe2\x80\x89-\xe2\x80\x89R|.No more than once you can choose one column and tell all the soldiers in this column to switch starting leg, i.e. everyone in this columns who starts the march from left leg will now start it from right leg, and vice versa. Formally, you can pick no more than one index i and swap values li and ri. Find the index of the column, such that switching the starting leg for soldiers in it will maximize the the beauty of the parade, or determine, that no such operation can increase the current beauty." 1100
733A "Grasshopper And the String" implementation "One day, the Grasshopper was jumping on the lawn and found a piece of paper with a string. Grasshopper became interested what is the minimum jump ability he should have in order to be able to reach the far end of the string, jumping only on vowels of the English alphabet. Jump ability is the maximum possible length of his jump. Formally, consider that at the begginning the Grasshopper is located directly in front of the leftmost character of the string. His goal is to reach the position right after the rightmost character of the string. In one jump the Grasshopper could jump to the right any distance from 1 to the value of his jump ability.  The picture corresponds to the first example. The following letters are vowels: \'A\', \'E\', \'I\', \'O\', \'U\' and \'Y\'." 1000
732F "Tourist Reform" "dfs and similar,graphs" "Berland is a tourist country! At least, it can become such \xe2\x80\x94 the government of Berland is confident about this. There are n cities in Berland, some pairs of which are connected by two-ways roads. Each road connects two different cities. In Berland there are no roads which connect the same pair of cities. It is possible to get from any city to any other city using given two-ways roads. According to the reform each road will become one-way. It will be oriented to one of two directions.To maximize the tourist attraction of Berland, after the reform for each city i the value ri will be calculated. It will equal to the number of cities x for which there is an oriented path from the city i to the city x. In other words, ri will equal the number of cities which can be reached from the city i by roads. The government is sure that tourist\'s attention will be focused on the minimum value of ri.Help the government of Berland make the reform to maximize the minimum of ri." 2300
732E Sockets greedy,sortings "The ICM ACPC World Finals is coming! Unfortunately, the organizers of the competition were so busy preparing tasks that totally missed an important technical point \xe2\x80\x94 the organization of electricity supplement for all the participants workstations.There are n computers for participants, the i-th of which has power equal to positive integer pi. At the same time there are m sockets available, the j-th of which has power euqal to positive integer sj. It is possible to connect the i-th computer to the j-th socket if and only if their powers are the same: pi\xe2\x80\x89=\xe2\x80\x89sj. It is allowed to connect no more than one computer to one socket. Thus, if the powers of all computers and sockets are distinct, then no computer can be connected to any of the sockets. In order to fix the situation professor Puch Williams urgently ordered a wagon of adapters \xe2\x80\x94 power splitters. Each adapter has one plug and one socket with a voltage divider between them. After plugging an adapter to a socket with power x, the power on the adapter\'s socket becomes equal to , it means that it is equal to the socket\'s power divided by two with rounding up, for example  and .Each adapter can be used only once. It is possible to connect several adapters in a chain plugging the first to a socket. For example, if two adapters are plugged one after enother to a socket with power 10, it becomes possible to connect one computer with power 3 to this socket.The organizers should install adapters so that it will be possible to supply with electricity the maximum number of computers c at the same time. If there are several possible connection configurations, they want to find the one that uses the minimum number of adapters u to connect c computers.Help organizers calculate the maximum number of connected computers c and the minimum number of adapters u needed for this.The wagon of adapters contains enough of them to do the task. It is guaranteed that it\'s possible to connect at least one computer." 2100
732D Exams "binary search,greedy,sortings" "Vasiliy has an exam period which will continue for n days. He has to pass exams on m subjects. Subjects are numbered from 1 to m.About every day we know exam for which one of m subjects can be passed on that day. Perhaps, some day you can\'t pass any exam. It is not allowed to pass more than one exam on any day. On each day Vasiliy can either pass the exam of that day (it takes the whole day) or prepare all day for some exam or have a rest. About each subject Vasiliy know a number ai \xe2\x80\x94 the number of days he should prepare to pass the exam number i. Vasiliy can switch subjects while preparing for exams, it is not necessary to prepare continuously during ai days for the exam number i. He can mix the order of preparation for exams in any way.Your task is to determine the minimum number of days in which Vasiliy can pass all exams, or determine that it is impossible. Each exam should be passed exactly one time." 1700
732C Sanatorium "binary search,constructive algorithms,greedy,implementation,math" "Vasiliy spent his vacation in a sanatorium, came back and found that he completely forgot details of his vacation! Every day there was a breakfast, a dinner and a supper in a dining room of the sanatorium (of course, in this order). The only thing that Vasiliy has now is a card from the dining room contaning notes how many times he had a breakfast, a dinner and a supper (thus, the card contains three integers). Vasiliy could sometimes have missed some meal, for example, he could have had a breakfast and a supper, but a dinner, or, probably, at some days he haven\'t been at the dining room at all.Vasiliy doesn\'t remember what was the time of the day when he arrived to sanatorium (before breakfast, before dinner, before supper or after supper), and the time when he left it (before breakfast, before dinner, before supper or after supper). So he considers any of these options. After Vasiliy arrived to the sanatorium, he was there all the time until he left. Please note, that it\'s possible that Vasiliy left the sanatorium on the same day he arrived.According to the notes in the card, help Vasiliy determine the minimum number of meals in the dining room that he could have missed. We shouldn\'t count as missed meals on the arrival day before Vasiliy\'s arrival and meals on the departure day after he left." 1200
732B "Cormen --- The Best Friend Of a Man" dp,greedy "Recently a dog was bought for Polycarp. The dog\'s name is Cormen. Now Polycarp has a lot of troubles. For example, Cormen likes going for a walk. Empirically Polycarp learned that the dog needs at least k walks for any two consecutive days in order to feel good. For example, if k\xe2\x80\x89=\xe2\x80\x895 and yesterday Polycarp went for a walk with Cormen 2 times, today he has to go for a walk at least 3 times. Polycarp analysed all his affairs over the next n days and made a sequence of n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the number of times Polycarp will walk with the dog on the i-th day while doing all his affairs (for example, he has to go to a shop, throw out the trash, etc.).Help Polycarp determine the minimum number of walks he needs to do additionaly in the next n days so that Cormen will feel good during all the n days. You can assume that on the day before the first day and on the day after the n-th day Polycarp will go for a walk with Cormen exactly k times. Write a program that will find the minumum number of additional walks and the appropriate schedule \xe2\x80\x94 the sequence of integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn (bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89ai), where bi means the total number of walks with the dog on the i-th day." 1000
732A "Buy a Shovel" "brute force,constructive algorithms,implementation,math" "Polycarp urgently needs a shovel! He comes to the shop and chooses an appropriate one. The shovel that Policarp chooses is sold for k burles. Assume that there is an unlimited number of such shovels in the shop.In his pocket Polycarp has an unlimited number of ""10-burle coins"" and exactly one coin of r burles (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x899).What is the minimum number of shovels Polycarp has to buy so that he can pay for the purchase without any change? It is obvious that he can pay for 10 shovels without any change (by paying the requied amount of 10-burle coins and not using the coin of r burles). But perhaps he can buy fewer shovels and pay without any change. Note that Polycarp should buy at least one shovel." 800
731F "Video Cards" "brute force,data structures,implementation,math,number theory" "Little Vlad is fond of popular computer game Bota-2. Recently, the developers announced the new add-on named Bota-3. Of course, Vlad immediately bought only to find out his computer is too old for the new game and needs to be updated.There are n video cards in the shop, the power of the i-th video card is equal to integer value ai. As Vlad wants to be sure the new game will work he wants to buy not one, but several video cards and unite their powers using the cutting-edge technology. To use this technology one of the cards is chosen as the leading one and other video cards are attached to it as secondary. For this new technology to work it\'s required that the power of each of the secondary video cards is divisible by the power of the leading video card. In order to achieve that the power of any secondary video card can be reduced to any integer value less or equal than the current power. However, the power of the leading video card should remain unchanged, i.e. it can\'t be reduced.Vlad has an infinite amount of money so he can buy any set of video cards. Help him determine which video cards he should buy such that after picking the leading video card and may be reducing some powers of others to make them work together he will get the maximum total value of video power." 1900
731E "Funny Game" dp,games "Once upon a time Petya and Gena gathered after another programming competition and decided to play some game. As they consider most modern games to be boring, they always try to invent their own games. They have only stickers and markers, but that won\'t stop them.The game they came up with has the following rules. Initially, there are n stickers on the wall arranged in a row. Each sticker has some number written on it. Now they alternate turn, Petya moves first.One move happens as follows. Lets say there are m\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892 stickers on the wall. The player, who makes the current move, picks some integer k from 2 to m and takes k leftmost stickers (removes them from the wall). After that he makes the new sticker, puts it to the left end of the row, and writes on it the new integer, equal to the sum of all stickers he took on this move. Game ends when there is only one sticker left on the wall. The score of the player is equal to the sum of integers written on all stickers he took during all his moves. The goal of each player is to maximize the difference between his score and the score of his opponent.Given the integer n and the initial sequence of stickers on the wall, define the result of the game, i.e. the difference between the Petya\'s and Gena\'s score if both players play optimally." 2200
731D "80-th Level Archeology" "brute force,data structures,greedy,sortings" "Archeologists have found a secret pass in the dungeon of one of the pyramids of Cycleland. To enter the treasury they have to open an unusual lock on the door. The lock consists of n words, each consisting of some hieroglyphs. The wall near the lock has a round switch. Each rotation of this switch changes the hieroglyphs according to some rules. The instruction nearby says that the door will open only if words written on the lock would be sorted in lexicographical order (the definition of lexicographical comparison in given in notes section).The rule that changes hieroglyphs is the following. One clockwise rotation of the round switch replaces each hieroglyph with the next hieroglyph in alphabet, i.e. hieroglyph x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89-\xe2\x80\x891) is replaced with hieroglyph (x\xe2\x80\x89+\xe2\x80\x891), and hieroglyph c is replaced with hieroglyph 1.Help archeologist determine, how many clockwise rotations they should perform in order to open the door, or determine that this is impossible, i.e. no cyclic shift of the alphabet will make the sequence of words sorted lexicographically." 2200
731C Socks "dfs and similar,dsu,graphs,greedy" "Arseniy is already grown-up and independent. His mother decided to leave him alone for m days and left on a vacation. She have prepared a lot of food, left some money and washed all Arseniy\'s clothes. Ten minutes before her leave she realized that it would be also useful to prepare instruction of which particular clothes to wear on each of the days she will be absent. Arseniy\'s family is a bit weird so all the clothes is enumerated. For example, each of Arseniy\'s n socks is assigned a unique integer from 1 to n. Thus, the only thing his mother had to do was to write down two integers li and ri for each of the days \xe2\x80\x94 the indices of socks to wear on the day i (obviously, li stands for the left foot and ri for the right). Each sock is painted in one of k colors.When mother already left Arseniy noticed that according to instruction he would wear the socks of different colors on some days. Of course, that is a terrible mistake cause by a rush. Arseniy is a smart boy, and, by some magical coincidence, he posses k jars with the paint \xe2\x80\x94 one for each of k colors.Arseniy wants to repaint some of the socks in such a way, that for each of m days he can follow the mother\'s instructions and wear the socks of the same color. As he is going to be very busy these days he will have no time to change the colors of any socks so he has to finalize the colors now.The new computer game Bota-3 was just realised and Arseniy can\'t wait to play it. What is the minimum number of socks that need their color to be changed in order to make it possible to follow mother\'s instructions and wear the socks of the same color during each of m days." 1600
731B "Coupons and Discounts" "constructive algorithms,greedy" "The programming competition season has already started and it\'s time to train for ICPC. Sereja coaches his teams for a number of year and he knows that to get ready for the training session it\'s not enough to prepare only problems and editorial. As the training sessions lasts for several hours, teams become hungry. Thus, Sereja orders a number of pizzas so they can eat right after the end of the competition.Teams plan to train for n times during n consecutive days. During the training session Sereja orders exactly one pizza for each team that is present this day. He already knows that there will be ai teams on the i-th day.There are two types of discounts in Sereja\'s favourite pizzeria. The first discount works if one buys two pizzas at one day, while the second is a coupon that allows to buy one pizza during two consecutive days (two pizzas in total).As Sereja orders really a lot of pizza at this place, he is the golden client and can use the unlimited number of discounts and coupons of any type at any days.Sereja wants to order exactly ai pizzas on the i-th day while using only discounts and coupons. Note, that he will never buy more pizzas than he need for this particular day. Help him determine, whether he can buy the proper amount of pizzas each day if he is allowed to use only coupons and discounts. Note, that it\'s also prohibited to have any active coupons after the end of the day n." 1100
731A "Night at the Museum" implementation,strings "Grigoriy, like the hero of one famous comedy film, found a job as a night security guard at the museum. At first night he received embosser and was to take stock of the whole exposition.Embosser is a special devise that allows to ""print"" the text of a plastic tape. Text is printed sequentially, character by character. The device consists of a wheel with a lowercase English letters written in a circle, static pointer to the current letter and a button that print the chosen letter. At one move it\'s allowed to rotate the alphabetic wheel one step clockwise or counterclockwise. Initially, static pointer points to letter \'a\'. Other letters are located as shown on the picture:  After Grigoriy add new item to the base he has to print its name on the plastic tape and attach it to the corresponding exhibit. It\'s not required to return the wheel to its initial position with pointer on the letter \'a\'.Our hero is afraid that some exhibits may become alive and start to attack him, so he wants to print the names as fast as possible. Help him, for the given string find the minimum number of rotations of the wheel required to print it." 800
730L "Expression Queries" "data structures" "A simplified arithmetic expression (SAE) is an arithmetic expression defined by the following grammar:  <SAE> ::= <Number> | <SAE>+<SAE> | <SAE>*<SAE> | (<SAE>)  <Number> ::= <Digit> | <Digit><Number>  <Digit> ::= 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 In other words it\'s a correct arithmetic expression that is allowed to contain brackets, numbers (possibly with leading zeros), multiplications and additions. For example expressions ""(0+01)"", ""0"" and ""1*(0)"" are simplified arithmetic expressions, but expressions ""2-1"", ""+1"" and ""1+2)"" are not.Given a string s1s2...s|s| that represents a SAE; si denotes the i-th character of the string which can be either a digit (\'0\'-\'9\'), a plus sign (\'+\'), a multiplication sign (\'*\'), an opening round bracket \'(\' or a closing round bracket \')\'.A part slsl\xe2\x80\x89+\xe2\x80\x891...sr of this string is called a sub-expression if and only if it is a SAE.You task is to answer m queries, each of which is a pair of integers li, ri (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89li\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ri\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|). For each query determine whether the corresponding part of the given string is a sub-expression and in case it\'s a sub-expression calculate its value modulo 1000000007 (109\xe2\x80\x89+\xe2\x80\x897). The values should be calculated using standard operator priorities." 3200
730K "Roads Orientation Problem" graphs "Berland consists of n cities and m bidirectional roads connecting pairs of cities. There is no road connecting a city to itself, and between any pair of cities there is no more than one road. It is possible to reach any city from any other moving along roads.Currently Mr. President is in the city s and his destination is the city t. He plans to move along roads from s to t (s\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t).That\'s why Ministry of Fools and Roads has difficult days. The minister is afraid that Mr. President could get into a traffic jam or get lost. Who knows what else can happen!To be sure that everything goes as planned, the minister decided to temporarily make all roads one-way. So each road will be oriented in one of two possible directions. The following conditions must be satisfied:  There should be no cycles along roads after orientation.  The city s should be the only such city that all its roads are oriented out (i.e. there are no ingoing roads to the city s and the city s is the only such city).  The city t should be the only such city that all its roads are oriented in (i.e. there are no outgoing roads from the city t and the city t is the only such city). Help the minister solve his problem. Write a program to find any such orientation of all roads or report that no solution exists." 3200
730J Bottles dp "Nick has n bottles of soda left after his birthday. Each bottle is described by two values: remaining amount of soda ai and bottle volume bi (ai\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89bi).Nick has decided to pour all remaining soda into minimal number of bottles, moreover he has to do it as soon as possible. Nick spends x seconds to pour x units of soda from one bottle to another.Nick asks you to help him to determine k \xe2\x80\x94 the minimal number of bottles to store all remaining soda and t \xe2\x80\x94 the minimal time to pour soda into k bottles. A bottle can\'t store more soda than its volume. All remaining soda should be saved." 1900
730I "Olympiad in Programming and Sports" dp,flows,graphs,greedy "There are n students at Berland State University. Every student has two skills, each measured as a number: ai \xe2\x80\x94 the programming skill and bi \xe2\x80\x94 the sports skill.It is announced that an Olympiad in programming and sports will be held soon. That\'s why Berland State University should choose two teams: one to take part in the programming track and one to take part in the sports track.There should be exactly p students in the programming team and exactly s students in the sports team. A student can\'t be a member of both teams.The university management considers that the strength of the university on the Olympiad is equal to the sum of two values: the programming team strength and the sports team strength. The strength of a team is the sum of skills of its members in the corresponding area, so the strength of the programming team is the sum of all ai and the strength of the sports team is the sum of all bi over corresponding team members.Help Berland State University to compose two teams to maximize the total strength of the university on the Olympiad." 2000
730H "Delete Them" "constructive algorithms,implementation" "Polycarp is a beginner programmer. He is studying how to use a command line.Polycarp faced the following problem. There are n files in a directory and he needs to delete some of them. Polycarp wants to run a single delete command with filename pattern as an argument. All the files to be deleted should match the pattern and all other files shouldn\'t match the pattern.Polycarp doesn\'t know about an asterisk \'*\', the only special character he knows is a question mark \'?\' which matches any single character. All other characters in the pattern match themselves only.Formally, a pattern matches a filename if and only if they have equal lengths and all characters in the corresponding positions are equal except when the character in the pattern is \'?\', in which case the corresponding filename character does not matter.For example, the filename pattern ""a?ba?"":  matches filenames ""aabaa"", ""abba."", ""a.ba9"" and ""a.ba."";  does not match filenames ""aaba"", ""abaab"", ""aabaaa"" and ""aabaa."". Help Polycarp find a pattern which matches files to be deleted and only them or report if there is no such pattern." 1300
730G "Car Repair Shop" implementation "Polycarp starts his own business. Tomorrow will be the first working day of his car repair shop. For now the car repair shop is very small and only one car can be repaired at a given time.Polycarp is good at marketing, so he has already collected n requests from clients. The requests are numbered from 1 to n in order they came.The i-th request is characterized by two values: si \xe2\x80\x94 the day when a client wants to start the repair of his car, di \xe2\x80\x94 duration (in days) to repair the car. The days are enumerated from 1, the first day is tomorrow, the second day is the day after tomorrow and so on.Polycarp is making schedule by processing requests in the order from the first to the n-th request. He schedules the i-th request as follows:  If the car repair shop is idle for di days starting from si (si,\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89si\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891), then these days are used to repair a car of the i-th client.  Otherwise, Polycarp finds the first day x (from 1 and further) that there are di subsequent days when no repair is scheduled starting from x. In other words he chooses the smallest positive x that all days x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891 are not scheduled for repair of any car. So, the car of the i-th client will be repaired in the range [x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89-\xe2\x80\x891]. It is possible that the day x when repair is scheduled to start will be less than si. Given n requests, you are asked to help Polycarp schedule all of them according to the rules above." 1600
730F "Ber Patio" NA "Polycarp is a regular customer at the restaurant ""Ber Patio"". He likes having lunches there.""Ber Patio"" has special discount program for regular customers. A customer can collect bonuses and partially cover expenses in the restaurant.Let\'s assume a customer currently has b bonuses and she has to pay r burles for a lunch. In this case the customer can use bonuses (1 bonus = 1 burle) to reduce the payment. She can cover at most half of the payment using bonuses. However, 1 bonus will be added to the customer\'s bonus balance per each 10 burles she paid.Formally:  a customer can choose any number x of bonuses to use ()),  the customer\'s bonus balance is reduced by x,  the customer pays r\xe2\x80\x89-\xe2\x80\x89x burles,  the customer\'s bonus balance is increased by \xe2\x8c\x8a(r\xe2\x80\x89-\xe2\x80\x89x)\xe2\x80\x89/\xe2\x80\x8910\xe2\x8c\x8b (i.e. integer division rounded down is used). Initially, there are b bonuses on Polycarp\'s account. Polycarp is going to have a lunch in ""Ber Patio"" for the next n days. He estimated the values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is the number of burles in a receipt for the i-th day. The sum over all receipts doesn\'t exceed 105 burles.Write a program to find the minimum number of burles Polycarp has to spend and an optimal strategy to use bonuses." 3100
730E "Award Ceremony" greedy,implementation "All-Berland programming contest comes to an end. In total, n teams participated in it. Like in ACM-ICPC, current results stopped refreshing one hour before the contest ends. So at the Award Ceremony, results are partially known. For each team the value ai is given \xe2\x80\x94 the number of points the i-th team has earned before the last hour of the contest. Besides that, the Jury has evaluated all submissions sent during the last hour and knows values di \xe2\x80\x94 the number of points earned by the i-th team during the last hour (these values can be negative, which means that a team can lose points).Before the contest, each team got unique id from 1 to n. According to the contest rules, a team with more points takes a higher place. If two or more teams have equal number of points, the team with lower id will take the higher place. So no two teams can share the same place.The Award Ceremony proceeds in the following way. At the beginning of the ceremony, a large screen shows the results for the time moment ""one hour before the end"", which means that the i-th team has ai points. Then the Jury unfreezes results of the teams one by one in some order. When result of the j-th team is unfrozen, its score changes from aj to aj\xe2\x80\x89+\xe2\x80\x89dj. At this time the table of results is modified and the place of the team can change. The unfreezing of the j-th team is followed by the applause from the audience with duration of |xj\xe2\x80\x89-\xe2\x80\x89yj| seconds, where xj is the place of the j-th team before unfreezing and yj is the place right after the unfreezing. For example, if the team does not change the place, there is no applause from the audience. As you can see, during the Award Ceremony, each team will be unfrozen exactly once.Your task is to find such an order to unfreeze all the teams that the total duration of applause is maximum possible." 2200
730D "Running Over The Bridges" greedy,implementation,math "Polycarp is playing a game called ""Running Over The Bridges"". In this game he has to run over n bridges from the left to the right. Bridges are arranged one after the other, so the i-th bridge begins where the (i\xe2\x80\x89-\xe2\x80\x891)-th bridge ends.You have the following data about bridges: li and ti \xe2\x80\x94 the length of the i-th bridge and the maximum allowed time which Polycarp can spend running over the i-th bridge. Thus, if Polycarp is in the beginning of the bridge i at the time T then he has to leave it at the time T\xe2\x80\x89+\xe2\x80\x89ti or earlier. It is allowed to reach the right end of a bridge exactly at the time T\xe2\x80\x89+\xe2\x80\x89ti.Polycarp can run from the left side to the right one with speed 0.5, so he will run over a bridge with length s in time 2\xc2\xb7s. Besides, he has several magical drinks. If he uses one drink, his speed increases twice (i.e. to value 1) for r seconds. All magical drinks are identical. Please note that Polycarp can use a drink only at integer moments of time, and he drinks it instantly and completely. Additionally, if Polycarp uses a drink at the moment T he can use the next drink not earlier than at the moment T\xe2\x80\x89+\xe2\x80\x89r.What is the minimal number of drinks Polycarp has to use to run over all n bridges? If this number is not greater than 105, then you have to find out the moments of time when Polycarp has to use each magical drink." 2200
730C Bulmart "binary search,dfs and similar" "A new trade empire is rising in Berland. Bulmart, an emerging trade giant, decided to dominate the market of ... shovels! And now almost every city in Berland has a Bulmart store, and some cities even have several of them! The only problem is, at the moment sales are ... let\'s say a little below estimates. Some people even say that shovels retail market is too small for such a big company to make a profit. But the company management believes in the future of that market and seeks new ways to increase income. There are n cities in Berland connected with m bi-directional roads. All roads have equal lengths. It can happen that it is impossible to reach a city from another city using only roads. There is no road which connects a city to itself. Any pair of cities can be connected by at most one road.There are w Bulmart stores in Berland. Each of them is described by three numbers:   ci \xe2\x80\x94 the number of city where the i-th store is located (a city can have no stores at all or have several of them),  ki \xe2\x80\x94 the number of shovels in the i-th store,  pi \xe2\x80\x94 the price of a single shovel in the i-th store (in burles). The latest idea of the Bulmart management is to create a program which will help customers get shovels as fast as possible for affordable budget. Formally, the program has to find the minimum amount of time needed to deliver rj shovels to the customer in the city gj for the total cost of no more than aj burles. The delivery time between any two adjacent cities is equal to 1. If shovels are delivered from several cities, the delivery time is equal to the arrival time of the last package. The delivery itself is free of charge.The program needs to find answers to q such queries. Each query has to be processed independently from others, i.e. a query does not change number of shovels in stores for the next queries." 2100
730B "Minimum and Maximum" "constructive algorithms,interactive" "This is an interactive problem. You have to use flush operation right after printing each line. For example, in C++ you should use function fflush(stdout), in Java \xe2\x80\x94 System.out.flush(), in Pascal \xe2\x80\x94 flush(output) and in Python \xe2\x80\x94 sys.stdout.flush().In this problem, you need to find maximal and minimal elements of an array. What could be simpler?You can imagine that the jury has an array, and initially you know the only number n \xe2\x80\x94 array\'s length.Array\'s elements are numbered from 1 to n. You are allowed to compare two elements of the array by using their indices i and j. There are three possible responses to this query: \'<\' (if ai is less than aj), \'=\' (if ai is equal to aj) and finally \'>\' (if ai is greater than aj).It\'s known that it\'s always possible to find both maximal and minimal elements of the array by using no more than  comparisons, where \xe2\x8c\x88 x\xe2\x8c\x89 is the result of rounding x up.Write the program that will find positions of the minimum and the maximum in the jury\'s array of length n, by using no more than f(n) comparisons." 1800
730A "Toda 2" greedy,implementation "A group of n friends enjoys playing popular video game Toda 2. There is a rating system describing skill level of each player, initially the rating of the i-th friend is ri.The friends decided to take part in the championship as a team. But they should have equal ratings to be allowed to compose a single team consisting of all n friends. So the friends are faced with the problem: how to make all their ratings equal.One way to change ratings is to willingly lose in some matches. Friends can form a party consisting of two to five (but not more than n) friends and play a match in the game. When the party loses, the rating of each of its members decreases by 1. A rating can\'t become negative, so ri\xe2\x80\x89=\xe2\x80\x890 doesn\'t change after losing.The friends can take part in multiple matches, each time making a party from any subset of friends (but remember about constraints on party size: from 2 to 5 members).The friends want to make their ratings equal but as high as possible.Help the friends develop a strategy of losing the matches so that all their ratings become equal and the resulting rating is maximum possible." 1800
729F "Financiers Game" dp "This problem has unusual memory constraint.At evening, Igor and Zhenya the financiers became boring, so they decided to play a game. They prepared n papers with the income of some company for some time periods. Note that the income can be positive, zero or negative.Igor and Zhenya placed the papers in a row and decided to take turns making moves. Igor will take the papers from the left side, Zhenya will take the papers from the right side. Igor goes first and takes 1 or 2 (on his choice) papers from the left. Then, on each turn a player can take k or k\xe2\x80\x89+\xe2\x80\x891 papers from his side if the opponent took exactly k papers in the previous turn. Players can\'t skip moves. The game ends when there are no papers left, or when some of the players can\'t make a move.Your task is to determine the difference between the sum of incomes on the papers Igor took and the sum of incomes on the papers Zhenya took, assuming both players play optimally. Igor wants to maximize the difference, Zhenya wants to minimize it." 2500
729E Subordinates "constructive algorithms,data structures,graphs,greedy,sortings" "There are n workers in a company, each of them has a unique id from 1 to n. Exaclty one of them is a chief, his id is s. Each worker except the chief has exactly one immediate superior.There was a request to each of the workers to tell how how many superiors (not only immediate). Worker\'s superiors are his immediate superior, the immediate superior of the his immediate superior, and so on. For example, if there are three workers in the company, from which the first is the chief, the second worker\'s immediate superior is the first, the third worker\'s immediate superior is the second, then the third worker has two superiors, one of them is immediate and one not immediate. The chief is a superior to all the workers except himself.Some of the workers were in a hurry and made a mistake. You are to find the minimum number of workers that could make a mistake." 1900
729D "Sea Battle" "constructive algorithms,greedy,math" "Galya is playing one-dimensional Sea Battle on a 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n grid. In this game a ships are placed on the grid. Each of the ships consists of b consecutive cells. No cell can be part of two ships, however, the ships can touch each other.Galya doesn\'t know the ships location. She can shoot to some cells and after each shot she is told if that cell was a part of some ship (this case is called ""hit"") or not (this case is called ""miss"").Galya has already made k shots, all of them were misses.Your task is to calculate the minimum number of cells such that if Galya shoot at all of them, she would hit at least one ship.It is guaranteed that there is at least one valid ships placement." 1700
729C "Road to Cinema" "binary search,greedy,sortings" "Vasya is currently at a car rental service, and he wants to reach cinema. The film he has bought a ticket for starts in t minutes. There is a straight road of length s from the service to the cinema. Let\'s introduce a coordinate system so that the car rental service is at the point 0, and the cinema is at the point s.There are k gas stations along the road, and at each of them you can fill a car with any amount of fuel for free! Consider that this operation doesn\'t take any time, i.e. is carried out instantly.There are n cars in the rental service, i-th of them is characterized with two integers ci and vi \xe2\x80\x94 the price of this car rent and the capacity of its fuel tank in liters. It\'s not allowed to fuel a car with more fuel than its tank capacity vi. All cars are completely fueled at the car rental service.Each of the cars can be driven in one of two speed modes: normal or accelerated. In the normal mode a car covers 1 kilometer in 2 minutes, and consumes 1 liter of fuel. In the accelerated mode a car covers 1 kilometer in 1 minutes, but consumes 2 liters of fuel. The driving mode can be changed at any moment and any number of times.Your task is to choose a car with minimum price such that Vasya can reach the cinema before the show starts, i.e. not later than in t minutes. Assume that all cars are completely fueled initially." 1700
729B Spotlights dp,implementation "Theater stage is a rectangular field of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The director gave you the stage\'s plan which actors will follow. For each cell it is stated in the plan if there would be an actor in this cell or not.You are to place a spotlight on the stage in some good position. The spotlight will project light in one of the four directions (if you look at the stage from above) \xe2\x80\x94 left, right, up or down. Thus, the spotlight\'s position is a cell it is placed to and a direction it shines.A position is good if two conditions hold:   there is no actor in the cell the spotlight is placed to;  there is at least one actor in the direction the spotlight projects. Count the number of good positions for placing the spotlight. Two positions of spotlight are considered to be different if the location cells or projection direction differ." 1200
729A "Interview with Oleg" implementation,strings "Polycarp has interviewed Oleg and has written the interview down without punctuation marks and spaces to save time. Thus, the interview is now a string s consisting of n lowercase English letters.There is a filler word ogo in Oleg\'s speech. All words that can be obtained from ogo by adding go several times to the end of it are also considered to be fillers. For example, the words ogo, ogogo, ogogogo are fillers, but the words go, og, ogog, ogogog and oggo are not fillers.The fillers have maximal size, for example, for ogogoo speech we can\'t consider ogo a filler and goo as a normal phrase. We should consider ogogo as a filler here.To print the interview, Polycarp has to replace each of the fillers with three asterisks. Note that a filler word is replaced with exactly three asterisks regardless of its length.Polycarp has dealt with this problem in no time. Can you do the same? The clock is ticking!" 900
727F "Polycarp\'s problems" "binary search,dp,greedy" "Polycarp is an experienced participant in Codehorses programming contests. Now he wants to become a problemsetter.He sent to the coordinator a set of n problems. Each problem has it\'s quality, the quality of the i-th problem is ai (ai can be positive, negative or equal to zero). The problems are ordered by expected difficulty, but the difficulty is not related to the quality in any way. The easiest problem has index 1, the hardest problem has index n.The coordinator\'s mood is equal to q now. After reading a problem, the mood changes by it\'s quality. It means that after the coordinator reads a problem with quality b, the value b is added to his mood. The coordinator always reads problems one by one from the easiest to the hardest, it\'s impossible to change the order of the problems.If after reading some problem the coordinator\'s mood becomes negative, he immediately stops reading and rejects the problemset.Polycarp wants to remove the minimum number of problems from his problemset to make the coordinator\'s mood non-negative at any moment of time. Polycarp is not sure about the current coordinator\'s mood, but he has m guesses ""the current coordinator\'s mood q\xe2\x80\x89=\xe2\x80\x89bi"".For each of m guesses, find the minimum number of problems Polycarp needs to remove so that the coordinator\'s mood will always be greater or equal to 0 while he reads problems from the easiest of the remaining problems to the hardest." 2300
727E "Games on a CD" "data structures,hashing,string suffix structures,strings" "Several years ago Tolya had n computer games and at some point of time he decided to burn them to CD. After that he wrote down the names of the games one after another in a circle on the CD in clockwise order. The names were distinct, the length of each name was equal to k. The names didn\'t overlap.Thus, there is a cyclic string of length n\xc2\xb7k written on the CD.Several years have passed and now Tolya can\'t remember which games he burned to his CD. He knows that there were g popular games that days. All of the games he burned were among these g games, and no game was burned more than once.You have to restore any valid list of games Tolya could burn to the CD several years ago." 2300
727D "T-shirts Distribution" "constructive algorithms,flows,greedy" "The organizers of a programming contest have decided to present t-shirts to participants. There are six different t-shirts sizes in this problem: S, M, L, XL, XXL, XXXL (sizes are listed in increasing order). The t-shirts are already prepared. For each size from S to XXXL you are given the number of t-shirts of this size.During the registration, the organizers asked each of the n participants about the t-shirt size he wants. If a participant hesitated between two sizes, he could specify two neighboring sizes \xe2\x80\x94 this means that any of these two sizes suits him.Write a program that will determine whether it is possible to present a t-shirt to each participant of the competition, or not. Of course, each participant should get a t-shirt of proper size:   the size he wanted, if he specified one size;  any of the two neibouring sizes, if he specified two sizes. If it is possible, the program should find any valid distribution of the t-shirts." 1800
727C "Guess the Array" "constructive algorithms,interactive,math" "This is an interactive problem. You should use flush operation after each printed line. For example, in C++ you should use fflush(stdout), in Java you should use System.out.flush(), and in Pascal \xe2\x80\x94 flush(output).In this problem you should guess an array a which is unknown for you. The only information you have initially is the length n of the array a.The only allowed action is to ask the sum of two elements by their indices. Formally, you can print two indices i and j (the indices should be distinct). Then your program should read the response: the single integer equals to ai\xe2\x80\x89+\xe2\x80\x89aj.It is easy to prove that it is always possible to guess the array using at most n requests.Write a program that will guess the array a by making at most n requests." 1400
727B "Bill Total Value" "expression parsing,implementation,strings" "Vasily exited from a store and now he wants to recheck the total price of all purchases in his bill. The bill is a string in which the names of the purchases and their prices are printed in a row without any spaces. Check has the format ""name1price1name2price2...namenpricen"", where namei (name of the i-th purchase) is a non-empty string of length not more than 10, consisting of lowercase English letters, and pricei (the price of the i-th purchase) is a non-empty string, consisting of digits and dots (decimal points). It is possible that purchases with equal names have different prices.The price of each purchase is written in the following format. If the price is an integer number of dollars then cents are not written.Otherwise, after the number of dollars a dot (decimal point) is written followed by cents in a two-digit format (if number of cents is between 1 and 9 inclusively, there is a leading zero).Also, every three digits (from less significant to the most) in dollars are separated by dot (decimal point). No extra leading zeroes are allowed. The price always starts with a digit and ends with a digit.For example:  ""234"", ""1.544"", ""149.431.10"", ""0.99"" and ""123.05"" are valid prices,  "".333"", ""3.33.11"", ""12.00"", "".33"", ""0.1234"" and ""1.2"" are not valid. Write a program that will find the total price of all purchases in the given bill." 1600
727A "Transformation: from A to B" "brute force,dfs and similar,math" "Vasily has a number a, which he wants to turn into a number b. For this purpose, he can do two types of operations:  multiply the current number by 2 (that is, replace the number x by 2\xc2\xb7x);  append the digit 1 to the right of current number (that is, replace the number x by 10\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891). You need to help Vasily to transform the number a into the number b using only the operations described above, or find that it is impossible.Note that in this task you are not required to minimize the number of operations. It suffices to find any way to transform a into b." 1000
725G "Messages on a Tree" NA "Alice and Bob are well-known for sending messages to each other. This time you have a rooted tree with Bob standing in the root node and copies of Alice standing in each of the other vertices. The root node has number 0, the rest are numbered 1 through n.At some moments of time some copies of Alice want to send a message to Bob and receive an answer. We will call this copy the initiator. The process of sending a message contains several steps:   The initiator sends the message to the person standing in the parent node and begins waiting for the answer.  When some copy of Alice receives a message from some of her children nodes, she sends the message to the person standing in the parent node and begins waiting for the answer.  When Bob receives a message from some of his child nodes, he immediately sends the answer to the child node where the message came from.  When some copy of Alice (except for initiator) receives an answer she is waiting for, she immediately sends it to the child vertex where the message came from.  When the initiator receives the answer she is waiting for, she doesn\'t send it to anybody.  There is a special case: a copy of Alice can\'t wait for two answers at the same time, so if some copy of Alice receives a message from her child node while she already waits for some answer, she rejects the message and sends a message saying this back to the child node where the message came from. Then the copy of Alice in the child vertex processes this answer as if it was from Bob.  The process of sending a message to a parent node or to a child node is instant but a receiver (a parent or a child) gets a message after 1 second. If some copy of Alice receives several messages from child nodes at the same moment while she isn\'t waiting for an answer, she processes the message from the initiator with the smallest number and rejects all the rest. If some copy of Alice receives messages from children nodes and also receives the answer she is waiting for at the same instant, then Alice first processes the answer, then immediately continue as normal with the incoming messages.You are given the moments of time when some copy of Alice becomes the initiator and sends a message to Bob. For each message, find the moment of time when the answer (either from Bob or some copy of Alice) will be received by the initiator.You can assume that if Alice wants to send a message (i.e. become the initiator) while waiting for some answer, she immediately rejects the message and receives an answer from herself in no time." 3300
725F "Family Photos" games,greedy "Alice and Bonnie are sisters, but they don\'t like each other very much. So when some old family photos were found in the attic, they started to argue about who should receive which photos. In the end, they decided that they would take turns picking photos. Alice goes first.There are n stacks of photos. Each stack contains exactly two photos. In each turn, a player may take only a photo from the top of one of the stacks.Each photo is described by two non-negative integers a and b, indicating that it is worth a units of happiness to Alice and b units of happiness to Bonnie. Values of a and b might differ for different photos.It\'s allowed to pass instead of taking a photo. The game ends when all photos are taken or both players pass consecutively.The players don\'t act to maximize their own happiness. Instead, each player acts to maximize the amount by which her happiness exceeds her sister\'s. Assuming both players play optimal, find the difference between Alice\'s and Bonnie\'s happiness. That is, if there\'s a perfectly-played game such that Alice has x happiness and Bonnie has y happiness at the end, you should print x\xe2\x80\x89-\xe2\x80\x89y." 2900
725E "Too Much Money" "brute force,greedy" "Alfred wants to buy a toy moose that costs c dollars. The store doesn\xe2\x80\x99t give change, so he must give the store exactly c dollars, no more and no less. He has n coins. To make c dollars from his coins, he follows the following algorithm: let S be the set of coins being used. S is initially empty. Alfred repeatedly adds to S the highest-valued coin he has such that the total value of the coins in S after adding the coin doesn\xe2\x80\x99t exceed c. If there is no such coin, and the value of the coins in S is still less than c, he gives up and goes home. Note that Alfred never removes a coin from S after adding it.As a programmer, you might be aware that Alfred\xe2\x80\x99s algorithm can fail even when there is a set of coins with value exactly c. For example, if Alfred has one coin worth $3, one coin worth $4, and two coins worth $5, and the moose costs $12, then Alfred will add both of the $5 coins to S and then give up, since adding any other coin would cause the value of the coins in S to exceed $12. Of course, Alfred could instead combine one $3 coin, one $4 coin, and one $5 coin to reach the total.Bob tried to convince Alfred that his algorithm was flawed, but Alfred didn\xe2\x80\x99t believe him. Now Bob wants to give Alfred some coins (in addition to those that Alfred already has) such that Alfred\xe2\x80\x99s algorithm fails. Bob can give Alfred any number of coins of any denomination (subject to the constraint that each coin must be worth a positive integer number of dollars). There can be multiple coins of a single denomination. He would like to minimize the total value of the coins he gives Alfred. Please find this minimum value. If there is no solution, print ""Greed is good"". You can assume that the answer, if it exists, is positive. In other words, Alfred\'s algorithm will work if Bob doesn\'t give him any coins." 2600
725D "Contest Balloons" "data structures,greedy" "One tradition of ACM-ICPC contests is that a team gets a balloon for every solved problem. We assume that the submission time doesn\'t matter and teams are sorted only by the number of balloons they have. It means that one\'s place is equal to the number of teams with more balloons, increased by 1. For example, if there are seven teams with more balloons, you get the eight place. Ties are allowed.You should know that it\'s important to eat before a contest. If the number of balloons of a team is greater than the weight of this team, the team starts to float in the air together with their workstation. They eventually touch the ceiling, what is strictly forbidden by the rules. The team is then disqualified and isn\'t considered in the standings.A contest has just finished. There are n teams, numbered 1 through n. The i-th team has ti balloons and weight wi. It\'s guaranteed that ti doesn\'t exceed wi so nobody floats initially.Limak is a member of the first team. He doesn\'t like cheating and he would never steal balloons from other teams. Instead, he can give his balloons away to other teams, possibly making them float. Limak can give away zero or more balloons of his team. Obviously, he can\'t give away more balloons than his team initially has.What is the best place Limak can get?" 1800
725C "Hidden Word" "brute force,constructive algorithms,implementation,strings" "Let\xe2\x80\x99s define a grid to be a set of tiles with 2 rows and 13 columns. Each tile has an English letter written in it. The letters don\'t have to be unique: there might be two or more tiles with the same letter written on them. Here is an example of a grid: ABCDEFGHIJKLMNOPQRSTUVWXYZ We say that two tiles are adjacent if they share a side or a corner. In the example grid above, the tile with the letter \'A\' is adjacent only to the tiles with letters \'B\', \'N\', and \'O\'. A tile is not adjacent to itself.A sequence of tiles is called a path if each tile in the sequence is adjacent to the tile which follows it (except for the last tile in the sequence, which of course has no successor). In this example, ""ABC"" is a path, and so is ""KXWIHIJK"". ""MAB"" is not a path because \'M\' is not adjacent to \'A\'. A single tile can be used more than once by a path (though the tile cannot occupy two consecutive places in the path because no tile is adjacent to itself).You\xe2\x80\x99re given a string s which consists of 27 upper-case English letters. Each English letter occurs at least once in s. Find a grid that contains a path whose tiles, viewed in the order that the path visits them, form the string s. If there\xe2\x80\x99s no solution, print ""Impossible"" (without the quotes)." 1600
725B "Food on the Plane" implementation,math "A new airplane SuperPuperJet has an infinite number of rows, numbered with positive integers starting with 1 from cockpit to tail. There are six seats in each row, denoted with letters from \'a\' to \'f\'. Seats \'a\', \'b\' and \'c\' are located to the left of an aisle (if one looks in the direction of the cockpit), while seats \'d\', \'e\' and \'f\' are located to the right. Seats \'a\' and \'f\' are located near the windows, while seats \'c\' and \'d\' are located near the aisle.    It\'s lunch time and two flight attendants have just started to serve food. They move from the first rows to the tail, always maintaining a distance of two rows from each other because of the food trolley. Thus, at the beginning the first attendant serves row 1 while the second attendant serves row 3. When both rows are done they move one row forward: the first attendant serves row 2 while the second attendant serves row 4. Then they move three rows forward and the first attendant serves row 5 while the second attendant serves row 7. Then they move one row forward again and so on.Flight attendants work with the same speed: it takes exactly 1 second to serve one passenger and 1 second to move one row forward. Each attendant first serves the passengers on the seats to the right of the aisle and then serves passengers on the seats to the left of the aisle (if one looks in the direction of the cockpit). Moreover, they always serve passengers in order from the window to the aisle. Thus, the first passenger to receive food in each row is located in seat \'f\', and the last one \xe2\x80\x94 in seat \'c\'. Assume that all seats are occupied.Vasya has seat s in row n and wants to know how many seconds will pass before he gets his lunch." 1200
725A "Jumping Ball" implementation "In a new version of the famous Pinball game, one of the most important parts of the game field is a sequence of n bumpers. The bumpers are numbered with integers from 1 to n from left to right. There are two types of bumpers. They are denoted by the characters \'<\' and \'>\'. When the ball hits the bumper at position i it goes one position to the right (to the position i\xe2\x80\x89+\xe2\x80\x891) if the type of this bumper is \'>\', or one position to the left (to i\xe2\x80\x89-\xe2\x80\x891) if the type of the bumper at position i is \'<\'. If there is no such position, in other words if i\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89<\xe2\x80\x891 or i\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89>\xe2\x80\x89n, the ball falls from the game field.Depending on the ball\'s starting position, the ball may eventually fall from the game field or it may stay there forever. You are given a string representing the bumpers\' types. Calculate the number of positions such that the ball will eventually fall from the game field if it starts at that position." 1000
724G "Xor-matic Number of the Graph" "bitmasks,graphs,math,number theory,trees" "You are given an undirected graph, constisting of n vertices and m edges. Each edge of the graph has some non-negative integer written on it.Let\'s call a triple (u,\xe2\x80\x89v,\xe2\x80\x89s) interesting, if 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and there is a path (possibly non-simple, i.e. it can visit the same vertices and edges multiple times) between vertices u and v such that xor of all numbers written on the edges of this path is equal to s. When we compute the value s for some path, each edge is counted in xor as many times, as it appear on this path. It\'s not hard to prove that there are finite number of such triples.Calculate the sum over modulo 109\xe2\x80\x89+\xe2\x80\x897 of the values of s over all interesting triples." 2600
724F "Uniformly Branched Trees" combinatorics,dp,trees "A tree is a connected graph without cycles.Two trees, consisting of n vertices each, are called isomorphic if there exists a permutation p:\xe2\x80\x89{1,\xe2\x80\x89...,\xe2\x80\x89n}\xe2\x80\x89\xe2\x86\x92\xe2\x80\x89{1,\xe2\x80\x89...,\xe2\x80\x89n} such that the edge (u,\xe2\x80\x89v) is present in the first tree if and only if the edge (pu,\xe2\x80\x89pv) is present in the second tree.Vertex of the tree is called internal if its degree is greater than or equal to two.Count the number of different non-isomorphic trees, consisting of n vertices, such that the degree of each internal vertex is exactly d. Print the answer over the given prime modulo mod." 2700
724E "Goods transportation" dp,flows,greedy "There are n cities located along the one-way road. Cities are numbered from 1 to n in the direction of the road.The i-th city had produced pi units of goods. No more than si units of goods can be sold in the i-th city.For each pair of cities i and j such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n you can no more than once transport no more than c units of goods from the city i to the city j. Note that goods can only be transported from a city with a lesser index to the city with a larger index. You can transport goods between cities in any order.Determine the maximum number of produced goods that can be sold in total in all the cities after a sequence of transportations." 2900
724D "Dense Subsequence" "data structures,greedy,strings" "You are given a string s, consisting of lowercase English letters, and the integer m.One should choose some symbols from the given string so that any contiguous subsegment of length m has at least one selected symbol. Note that here we choose positions of symbols, not the symbols themselves.Then one uses the chosen symbols to form a new string. All symbols from the chosen position should be used, but we are allowed to rearrange them in any order.Formally, we choose a subsequence of indices 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89it\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|. The selected sequence must meet the following condition: for every j such that 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|\xe2\x80\x89-\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891, there must be at least one selected index that belongs to the segment [j,\xe2\x80\x89 j\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891], i.e. there should exist a k from 1 to t, such that j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ik\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x89m\xe2\x80\x89-\xe2\x80\x891.Then we take any permutation p of the selected indices and form a new string sip1sip2... sipt.Find the lexicographically smallest string, that can be obtained using this procedure." 1900
724C "Ray Tracing" "greedy,hashing,implementation,math,number theory,sortings" "There are k sensors located in the rectangular room of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m meters. The i-th sensor is located at point (xi,\xe2\x80\x89yi). All sensors are located at distinct points strictly inside the rectangle. Opposite corners of the room are located at points (0,\xe2\x80\x890) and (n,\xe2\x80\x89m). Walls of the room are parallel to coordinate axes.At the moment 0, from the point (0,\xe2\x80\x890) the laser ray is released in the direction of point (1,\xe2\x80\x891). The ray travels with a speed of  meters per second. Thus, the ray will reach the point (1,\xe2\x80\x891) in exactly one second after the start.When the ray meets the wall it\'s reflected by the rule that the angle of incidence is equal to the angle of reflection. If the ray reaches any of the four corners, it immediately stops.For each sensor you have to determine the first moment of time when the ray will pass through the point where this sensor is located. If the ray will never pass through this point, print \xe2\x80\x89-\xe2\x80\x891 for such sensors." 1800
724B "Batch Sort" "brute force,greedy,implementation,math" "You are given a table consisting of n rows and m columns.Numbers in each row form a permutation of integers from 1 to m.You are allowed to pick two elements in one row and swap them, but no more than once for each row. Also, no more than once you are allowed to pick two columns and swap them. Thus, you are allowed to perform from 0 to n\xe2\x80\x89+\xe2\x80\x891 actions in total. Operations can be performed in any order.You have to check whether it\'s possible to obtain the identity permutation 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89m in each row. In other words, check if one can perform some of the operation following the given rules and make each row sorted in increasing order." 1500
724A "Checking the Calendar" implementation "You are given names of two days of the week.Please, determine whether it is possible that during some non-leap year the first day of some month was equal to the first day of the week you are given, while the first day of the next month was equal to the second day of the week you are given. Both months should belong to one year.In this problem, we consider the Gregorian calendar to be used. The number of months in this calendar is equal to 12. The number of days in months during any non-leap year is: 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31.Names of the days of the week are given with lowercase English letters: ""monday"", ""tuesday"", ""wednesday"", ""thursday"", ""friday"", ""saturday"", ""sunday""." 1000
723F "st-Spanning Tree" dsu,graphs,greedy,implementation "You are given an undirected connected graph consisting of n vertices and m edges. There are no loops and no multiple edges in the graph.You are also given two distinct vertices s and t, and two values ds and dt. Your task is to build any spanning tree of the given graph (note that the graph is not weighted), such that the degree of the vertex s doesn\'t exceed ds, and the degree of the vertex t doesn\'t exceed dt, or determine, that there is no such spanning tree.The spanning tree of the graph G is a subgraph which is a tree and contains all vertices of the graph G. In other words, it is a connected graph which contains n\xe2\x80\x89-\xe2\x80\x891 edges and can be obtained by removing some of the edges from G.The degree of a vertex is the number of edges incident to this vertex." 2300
723E "One-Way Reform" "constructive algorithms,dfs and similar,flows,graphs,greedy" "There are n cities and m two-way roads in Berland, each road connects two cities. It is known that there is no more than one road connecting each pair of cities, and there is no road which connects the city with itself. It is possible that there is no way to get from one city to some other city using only these roads.The road minister decided to make a reform in Berland and to orient all roads in the country, i.e. to make each road one-way. The minister wants to maximize the number of cities, for which the number of roads that begins in the city equals to the number of roads that ends in it." 2200
723D "Lakes in Berland" "dfs and similar,dsu,graphs,greedy,implementation" "The map of Berland is a rectangle of the size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, which consists of cells of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x891. Each cell is either land or water. The map is surrounded by the ocean. Lakes are the maximal regions of water cells, connected by sides, which are not connected with the ocean. Formally, lake is a set of water cells, such that it\'s possible to get from any cell of the set to any other without leaving the set and moving only to cells adjacent by the side, none of them is located on the border of the rectangle, and it\'s impossible to add one more water cell to the set such that it will be connected with any other cell.You task is to fill up with the earth the minimum number of water cells so that there will be exactly k lakes in Berland. Note that the initial number of lakes on the map is not less than k." 1600
723C "Polycarp at the Radio" greedy "Polycarp is a music editor at the radio station. He received a playlist for tomorrow, that can be represented as a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, where ai is a band, which performs the i-th song. Polycarp likes bands with the numbers from 1 to m, but he doesn\'t really like others. We define as bj the number of songs the group j is going to perform tomorrow. Polycarp wants to change the playlist in such a way that the minimum among the numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm will be as large as possible.Find this maximum possible value of the minimum among the bj (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m), and the minimum number of changes in the playlist Polycarp needs to make to achieve it. One change in the playlist is a replacement of the performer of the i-th song with any other group." 1600
723B "Text Document Analysis" "expression parsing,implementation,strings" "Modern text editors usually show some information regarding the document being edited. For example, the number of words, the number of pages, or the number of characters.In this problem you should implement the similar functionality.You are given a string which only consists of:  uppercase and lowercase English letters,  underscore symbols (they are used as separators),  parentheses (both opening and closing). It is guaranteed that each opening parenthesis has a succeeding closing parenthesis. Similarly, each closing parentheses has a preceding opening parentheses matching it. For each pair of matching parentheses there are no other parenthesis between them. In other words, each parenthesis in the string belongs to a matching ""opening-closing"" pair, and such pairs can\'t be nested.For example, the following string is valid: ""_Hello_Vasya(and_Petya)__bye_(and_OK)"".Word is a maximal sequence of consecutive letters, i.e. such sequence that the first character to the left and the first character to the right of it is an underscore, a parenthesis, or it just does not exist. For example, the string above consists of seven words: ""Hello"", ""Vasya"", ""and"", ""Petya"", ""bye"", ""and"" and ""OK"". Write a program that finds:  the length of the longest word outside the parentheses (print 0, if there is no word outside the parentheses),  the number of words inside the parentheses (print 0, if there is no word inside the parentheses)." 1100
723A "The New Year: Meeting Friends" implementation,math,sortings "There are three friend living on the straight line Ox in Lineland. The first friend lives at the point x1, the second friend lives at the point x2, and the third friend lives at the point x3. They plan to celebrate the New Year together, so they need to meet at one point. What is the minimum total distance they have to travel in order to meet at some point and celebrate the New Year?It\'s guaranteed that the optimal answer is always integer." 800
722F "Cyclic Cipher" "chinese remainder theorem,data structures,implementation,number theory,two pointers" "You are given n sequences. Each sequence consists of positive integers, not exceeding m. All integers in one sequence are distinct, but the same integer may appear in multiple sequences. The length of the i-th sequence is ki.Each second integers in each of the sequences are shifted by one to the left, i.e. integers at positions i\xe2\x80\x89>\xe2\x80\x891 go to positions i\xe2\x80\x89-\xe2\x80\x891, while the first integers becomes the last.Each second we take the first integer of each sequence and write it down to a new array. Then, for each value x from 1 to m we compute the longest segment of the array consisting of element x only.The above operation is performed for 10100 seconds. For each integer from 1 to m find out the longest segment found at this time." 2800
722E "Research Rover" combinatorics,dp "Unfortunately, the formal description of the task turned out to be too long, so here is the legend.Research rover finally reached the surface of Mars and is ready to complete its mission. Unfortunately, due to the mistake in the navigation system design, the rover is located in the wrong place.The rover will operate on the grid consisting of n rows and m columns. We will define as (r,\xe2\x80\x89c) the cell located in the row r and column c. From each cell the rover is able to move to any cell that share a side with the current one.The rover is currently located at cell (1,\xe2\x80\x891) and has to move to the cell (n,\xe2\x80\x89m). It will randomly follow some shortest path between these two cells. Each possible way is chosen equiprobably.The cargo section of the rover contains the battery required to conduct the research. Initially, the battery charge is equal to s units of energy.Some of the cells contain anomaly. Each time the rover gets to the cell with anomaly, the battery looses half of its charge rounded down. Formally, if the charge was equal to x before the rover gets to the cell with anomaly, the charge will change to .While the rover picks a random shortest path to proceed, compute the expected value of the battery charge after it reaches cell (n,\xe2\x80\x89m). If the cells (1,\xe2\x80\x891) and (n,\xe2\x80\x89m) contain anomaly, they also affect the charge of the battery." 2900
722D "Generating Sets" "binary search,data structures,dfs and similar,greedy,strings,trees" "You are given a set Y of n distinct positive integers y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn.Set X of n distinct positive integers x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn is said to generate set Y if one can transform X to Y by applying some number of the following two operation to integers in X:  Take any integer xi and multiply it by two, i.e. replace xi with 2\xc2\xb7xi.  Take any integer xi, multiply it by two and add one, i.e. replace xi with 2\xc2\xb7xi\xe2\x80\x89+\xe2\x80\x891. Note that integers in X are not required to be distinct after each operation.Two sets of distinct integers X and Y are equal if they are equal as sets. In other words, if we write elements of the sets in the array in the increasing order, these arrays would be equal.Note, that any set of integers (or its permutation) generates itself.You are given a set Y and have to find a set X that generates Y and the maximum element of X is mininum possible." 1900
722C "Destroying Array" "data structures,dsu" "You are given an array consisting of n non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.You are going to destroy integers in the array one by one. Thus, you are given the permutation of integers from 1 to n defining the order elements of the array are destroyed.After each element is destroyed you have to find out the segment of the array, such that it contains no destroyed elements and the sum of its elements is maximum possible. The sum of elements in the empty segment is considered to be 0." 1600
722B "Verse Pattern" implementation,strings "You are given a text consisting of n lines. Each line contains some space-separated words, consisting of lowercase English letters.We define a syllable as a string that contains exactly one vowel and any arbitrary number (possibly none) of consonants. In English alphabet following letters are considered to be vowels: \'a\', \'e\', \'i\', \'o\', \'u\' and \'y\'.Each word of the text that contains at least one vowel can be divided into syllables. Each character should be a part of exactly one syllable. For example, the word ""mamma"" can be divided into syllables as ""ma"" and ""mma"", ""mam"" and ""ma"", and ""mamm"" and ""a"". Words that consist of only consonants should be ignored.The verse patterns for the given text is a sequence of n integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn. Text matches the given verse pattern if for each i from 1 to n one can divide words of the i-th line in syllables in such a way that the total number of syllables is equal to pi.You are given the text and the verse pattern. Check, if the given text matches the given verse pattern." 1200
722A "Broken Clock" "brute force,implementation" "You are given a broken clock. You know, that it is supposed to show time in 12- or 24-hours HH:MM format. In 12-hours format hours change from 1 to 12, while in 24-hours it changes from 0 to 23. In both formats minutes change from 0 to 59.You are given a time in format HH:MM that is currently displayed on the broken clock. Your goal is to change minimum number of digits in order to make clocks display the correct time in the given format.For example, if 00:99 is displayed, it is enough to replace the second 9 with 3 in order to get 00:39 that is a correct time in 24-hours format. However, to make 00:99 correct in 12-hours format, one has to change at least two digits. Additionally to the first change one can replace the second 0 with 1 and obtain 01:39." 1300
721E "Road to Home" "binary search,dp" "Once Danil the student was returning home from tram stop lately by straight road of length L. The stop is located at the point x\xe2\x80\x89=\xe2\x80\x890, but the Danil\'s home \xe2\x80\x94 at the point x\xe2\x80\x89=\xe2\x80\x89L. Danil goes from x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89L with a constant speed and does not change direction of movement.There are n street lights at the road, each of which lights some continuous segment of the road. All of the n lightened segments do not share common points.Danil loves to sing, thus he wants to sing his favourite song over and over again during his walk. As soon as non-lightened segments of the road scare him, he sings only when he goes through the lightened segments.Danil passes distance p while performing his favourite song once. Danil can\'t start another performance if the segment passed while performing is not fully lightened. Moreover, if Danil has taken a pause between two performances, he is not performing while not having passed a segment of length at least t. Formally,  Danil can start single performance at a point x only if every point of segment [x,\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89p] is lightened;  If Danil has finished performing at a point x\xe2\x80\x89+\xe2\x80\x89p, then the next performance can be started only at a point y such that y\xe2\x80\x89=\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89p or y\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89x\xe2\x80\x89+\xe2\x80\x89p\xe2\x80\x89+\xe2\x80\x89t satisfying the statement under the point 1.   Blue half-circles denote performances. Please note that just after Danil has taken a pause in performing, he has not sang for a path of length of at least t. Determine how many times Danil can perform his favourite song during his walk from x\xe2\x80\x89=\xe2\x80\x890 to x\xe2\x80\x89=\xe2\x80\x89L.Please note that Danil does not break a single performance, thus, started singing another time, he finishes singing when having a segment of length of p passed from the performance start point." 2700
721D "Maxim and Array" "constructive algorithms,data structures,greedy,math" "Recently Maxim has found an array of n integers, needed by no one. He immediately come up with idea of changing it: he invented positive integer x and decided to add or subtract it from arbitrary array elements. Formally, by applying single operation Maxim chooses integer i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and replaces the i-th element of array ai either with ai\xe2\x80\x89+\xe2\x80\x89x or with ai\xe2\x80\x89-\xe2\x80\x89x. Please note that the operation may be applied more than once to the same position.Maxim is a curious minimalis, thus he wants to know what is the minimum value that the product of all array elements (i.e. ) can reach, if Maxim would apply no more than k operations to it. Please help him in that." 2000
721C Journey dp,graphs "Recently Irina arrived to one of the most famous cities of Berland \xe2\x80\x94 the Berlatov city. There are n showplaces in the city, numbered from 1 to n, and some of them are connected by one-directional roads. The roads in Berlatov are designed in a way such that there are no cyclic routes between showplaces.Initially Irina stands at the showplace 1, and the endpoint of her journey is the showplace n. Naturally, Irina wants to visit as much showplaces as she can during her journey. However, Irina\'s stay in Berlatov is limited and she can\'t be there for more than T time units.Help Irina determine how many showplaces she may visit during her journey from showplace 1 to showplace n within a time not exceeding T. It is guaranteed that there is at least one route from showplace 1 to showplace n such that Irina will spend no more than T time units passing it." 1800
721B Passwords implementation,math,sortings,strings "Vanya is managed to enter his favourite site Codehorses. Vanya uses n distinct passwords for sites at all, however he can\'t remember which one exactly he specified during Codehorses registration.Vanya will enter passwords in order of non-decreasing their lengths, and he will enter passwords of same length in arbitrary order. Just when Vanya will have entered the correct password, he is immediately authorized on the site. Vanya will not enter any password twice.Entering any passwords takes one second for Vanya. But if Vanya will enter wrong password k times, then he is able to make the next try only 5 seconds after that. Vanya makes each try immediately, that is, at each moment when Vanya is able to enter password, he is doing that.Determine how many seconds will Vanya need to enter Codehorses in the best case for him (if he spends minimum possible number of second) and in the worst case (if he spends maximum possible amount of seconds)." 1100
721A "One-dimensional Japanese Crossword" implementation "Recently Adaltik discovered japanese crosswords. Japanese crossword is a picture, represented as a table sized a\xe2\x80\x89\xc3\x97\xe2\x80\x89b squares, and each square is colored white or black. There are integers to the left of the rows and to the top of the columns, encrypting the corresponding row or column. The number of integers represents how many groups of black squares there are in corresponding row or column, and the integers themselves represents the number of consecutive black squares in corresponding group (you can find more detailed explanation in Wikipedia https://en.wikipedia.org/wiki/Japanese_crossword).Adaltik decided that the general case of japanese crossword is too complicated and drew a row consisting of n squares (e.g. japanese crossword sized 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n), which he wants to encrypt in the same way as in japanese crossword.  The example of encrypting of a single row of japanese crossword. Help Adaltik find the numbers encrypting the row he drew." 800
720F "Array Covering" "data structures" "Misha has an array of integers of length n. He wants to choose k different continuous subarrays, so that each element of the array belongs to at least one of the chosen subarrays.Misha wants to choose the subarrays in such a way that if he calculated the sum of elements for each subarray, and then add up all these sums, the resulting value was maximum possible." 3100
720E Cipher implementation "Borya has recently found a big electronic display. The computer that manages the display stores some integer number. The number has n decimal digits, the display shows the encoded version of the number, where each digit is shown using some lowercase letter of the English alphabet.There is a legend near the display, that describes how the number is encoded. For each digit position i and each digit j the character c is known, that encodes this digit at this position. Different digits can have the same code characters.Each second the number is increased by 1. And one second after a moment when the number reaches the value that is represented as n 9-s in decimal notation, the loud beep sounds. Andrew knows the number that is stored in the computer. Now he wants to know how many seconds must pass until Borya can definitely tell what was the original number encoded by the display. Assume that Borya can precisely measure time, and that the encoded number will first be increased exactly one second after Borya started watching at the display." 3100
720D Slalom "data structures,dp,sortings" "Little girl Masha likes winter sports, today she\'s planning to take part in slalom skiing.The track is represented as a grid composed of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m squares. There are rectangular obstacles at the track, composed of grid squares. Masha must get from the square (1,\xe2\x80\x891) to the square (n,\xe2\x80\x89m). She can move from a square to adjacent square: either to the right, or upwards. If the square is occupied by an obstacle, it is not allowed to move to that square.One can see that each obstacle can actually be passed in two ways: either it is to the right of Masha\'s path, or to the left. Masha likes to try all ways to do things, so she would like to know how many ways are there to pass the track. Two ways are considered different if there is an obstacle such that it is to the right of the path in one way, and to the left of the path in the other way.Help Masha to find the number of ways to pass the track. The number of ways can be quite big, so Masha would like to know it modulo 109\xe2\x80\x89+\xe2\x80\x897.The pictures below show different ways to pass the track in sample tests." 3100
720C Homework "constructive algorithms" "Today Peter has got an additional homework for tomorrow. The teacher has given three integers to him: n, m and k, and asked him to mark one or more squares on a square grid of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m. The marked squares must form a connected figure, and there must be exactly k triples of marked squares that form an L-shaped tromino \xe2\x80\x94 all three squares are inside a 2\xe2\x80\x89\xc3\x97\xe2\x80\x892 square.The set of squares forms a connected figure if it is possible to get from any square to any other one if you are allowed to move from a square to any adjacent by a common side square.Peter cannot fulfill the task, so he asks you for help. Help him to create such figure." 3100
720B Cactusophobia "dfs and similar,flows" "Tree is a connected undirected graph that has no cycles. Edge cactus is a connected undirected graph without loops and parallel edges, such that each edge belongs to at most one cycle.Vasya has an edge cactus, each edge of this graph has some color.Vasya would like to remove the minimal number of edges in such way that his cactus turned to a tree. Vasya wants to make it in such a way that there were edges of as many different colors in the resulting tree, as possible. Help him to find how many different colors can the resulting tree have." 2400
720A "Closing ceremony" greedy "The closing ceremony of Squanch Code Cup is held in the big hall with n\xe2\x80\x89\xc3\x97\xe2\x80\x89m seats, arranged in n rows, m seats in a row. Each seat has two coordinates (x,\xe2\x80\x89y) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m). There are two queues of people waiting to enter the hall: k people are standing at (0,\xe2\x80\x890) and n\xc2\xb7m\xe2\x80\x89-\xe2\x80\x89k people are standing at (0,\xe2\x80\x89m\xe2\x80\x89+\xe2\x80\x891). Each person should have a ticket for a specific seat. If person p at (x,\xe2\x80\x89y) has ticket for seat (xp,\xe2\x80\x89yp) then he should walk |x\xe2\x80\x89-\xe2\x80\x89xp|\xe2\x80\x89+\xe2\x80\x89|y\xe2\x80\x89-\xe2\x80\x89yp| to get to his seat.Each person has a stamina \xe2\x80\x94 the maximum distance, that the person agrees to walk. You should find out if this is possible to distribute all n\xc2\xb7m tickets in such a way that each person has enough stamina to get to their seat." 2000
719B "Anatoly and Cockroaches" greedy "Anatoly lives in the university dorm as many other students do. As you know, cockroaches are also living there together with students. Cockroaches might be of two colors: black and red. There are n cockroaches living in Anatoly\'s room.Anatoly just made all his cockroaches to form a single line. As he is a perfectionist, he would like the colors of cockroaches in the line to alternate. He has a can of black paint and a can of red paint. In one turn he can either swap any two cockroaches, or take any single cockroach and change it\'s color.Help Anatoly find out the minimum number of turns he needs to make the colors of cockroaches in the line alternate." 1400
719A "Vitya in the Countryside" implementation "Every summer Vitya comes to visit his grandmother in the countryside. This summer, he got a huge wart. Every grandma knows that one should treat warts when the moon goes down. Thus, Vitya has to catch the moment when the moon is down.Moon cycle lasts 30 days. The size of the visible part of the moon (in Vitya\'s units) for each day is 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, and then cycle repeats, thus after the second 1 again goes 0.As there is no internet in the countryside, Vitya has been watching the moon for n consecutive days and for each of these days he wrote down the size of the visible part of the moon. Help him find out whether the moon will be up or down next day, or this cannot be determined by the data he has." 1100
718E "Matvey\'s Birthday" bitmasks,graphs "Today is Matvey\'s birthday. He never knows what to ask as a present so friends gave him a string s of length n. This string consists of only first eight English letters: \'a\', \'b\', ..., \'h\'.First question that comes to mind is: who might ever need some string? Matvey is a special boy so he instantly found what to do with this string. He used it to build an undirected graph where vertices correspond to position in the string and there is an edge between distinct positions a and b (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) if at least one of the following conditions hold:   a and b are neighbouring, i.e. |a\xe2\x80\x89-\xe2\x80\x89b|\xe2\x80\x89=\xe2\x80\x891.  Positions a and b contain equal characters, i.e. sa\xe2\x80\x89=\xe2\x80\x89sb. Then Matvey decided to find the diameter of this graph. Diameter is a maximum distance (length of the shortest path) among all pairs of vertices. Also, Matvey wants to find the number of pairs of vertices such that the distance between them is equal to the diameter of the graph. As he is very cool and experienced programmer he managed to solve this problem very fast. Will you do the same?" 3300
718D "Andrew and Chemistry" dp,hashing,trees "During the chemistry lesson Andrew learned that the saturated hydrocarbons (alkanes) enter into radical chlorination reaction. Andrew is a very curious boy, so he wondered how many different products of the reaction may be forms for a given alkane. He managed to solve the task for small molecules, but for large ones he faced some difficulties and asks you to help.Formally, you are given a tree consisting of n vertices, such that the degree of each vertex doesn\'t exceed 4. You have to count the number of distinct non-isomorphic trees that can be obtained by adding to this tree one new vertex and one new edge, such that the graph is still the tree and the degree of each vertex doesn\'t exceed 4.Two trees are isomorphic if there exists a bijection f(v) such that vertices u and v are connected by an edge if and only if vertices f(v) and f(u) are connected by an edge." 2900
718C "Sasha and Array" "data structures,math,matrices" "Sasha has an array of integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. You have to perform m queries. There might be queries of two types:  1 l r x \xe2\x80\x94 increase all integers on the segment from l to r by values x;  2 l r \xe2\x80\x94 find , where f(x) is the x-th Fibonacci number. As this number may be large, you only have to find it modulo 109\xe2\x80\x89+\xe2\x80\x897. In this problem we define Fibonacci numbers as follows: f(1)\xe2\x80\x89=\xe2\x80\x891, f(2)\xe2\x80\x89=\xe2\x80\x891, f(x)\xe2\x80\x89=\xe2\x80\x89f(x\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89f(x\xe2\x80\x89-\xe2\x80\x892) for all x\xe2\x80\x89>\xe2\x80\x892.Sasha is a very talented boy and he managed to perform all queries in five seconds. Will you be able to write the program that performs as well as Sasha?" 2300
718A "Efim and Strange Grade" dp,implementation,math "Efim just received his grade for the last test. He studies in a special school and his grade can be equal to any positive decimal fraction. First he got disappointed, as he expected a way more pleasant result. Then, he developed a tricky plan. Each second, he can ask his teacher to round the grade at any place after the decimal point (also, he can ask to round to the nearest integer). There are t seconds left till the end of the break, so Efim has to act fast. Help him find what is the maximum grade he can get in no more than t seconds. Note, that he can choose to not use all t seconds. Moreover, he can even choose to not round the grade at all.In this problem, classic rounding rules are used: while rounding number to the n-th digit one has to take a look at the digit n\xe2\x80\x89+\xe2\x80\x891. If it is less than 5 than the n-th digit remain unchanged while all subsequent digits are replaced with 0. Otherwise, if the n\xe2\x80\x89+\xe2\x80\x891 digit is greater or equal to 5, the digit at the position n is increased by 1 (this might also change some other digits, if this one was equal to 9) and all subsequent digits are replaced with 0. At the end, all trailing zeroes are thrown away.For example, if the number 1.14 is rounded to the first decimal place, the result is 1.1, while if we round 1.5 to the nearest integer, the result is 2. Rounding number 1.299996121 in the fifth decimal place will result in number 1.3." 1700
717I "Cowboy Beblop at his computer" geometry "Cowboy Beblop is a funny little boy who likes sitting at his computer. He somehow obtained two elastic hoops in the shape of 2D polygons, which are not necessarily convex. Since there\'s no gravity on his spaceship, the hoops are standing still in the air. Since the hoops are very elastic, Cowboy Beblop can stretch, rotate, translate or shorten their edges as much as he wants.For both hoops, you are given the number of their vertices, as well as the position of each vertex, defined by the X , Y and Z coordinates. The vertices are given in the order they\'re connected: the 1st\xe2\x80\xafvertex is connected to the 2nd, which is connected to the 3rd, etc., and the last vertex is connected to the first one. Two hoops are connected if it\'s impossible to pull them to infinity in different directions by manipulating their edges, without having their edges or vertices intersect at any point \xe2\x80\x93 just like when two links of a chain are connected. The polygons\' edges do not intersect or overlap. To make things easier, we say that two polygons are well-connected, if the edges of one polygon cross the area of the other polygon in two different directions (from the upper and lower sides of the plane defined by that polygon) a different number of times.Cowboy Beblop is fascinated with the hoops he has obtained and he would like to know whether they are well-connected or not. Since he\xe2\x80\x99s busy playing with his dog, Zwei, he\xe2\x80\x99d like you to figure it out for him. He promised you some sweets if you help him!" 2800
717H "Pokermon League challenge" math,probabilities "Welcome to the world of Pokermon, yellow little mouse-like creatures, who absolutely love playing poker! Yeah, right\xe2\x80\xa6 In the ensuing Pokermon League, there are n registered Pokermon trainers, and t existing trainer teams each of which belongs to one of two conferences. Since there is a lot of jealousy between trainers, there are e pairs of trainers who hate each other. Their hate is mutual, there are no identical pairs among these, and no trainer hates himself (the world of Pokermon is a joyful place!). Each trainer has a wish-list of length li of teams he\xe2\x80\x99d like to join.Your task is to divide players into teams and the teams into two conferences, so that:   each trainer belongs to exactly one team;   no team is in both conferences;   total hate between conferences is at least e\xe2\x80\x89/\xe2\x80\x892;   every trainer is in a team from his wish-list. Total hate between conferences is calculated as the number of pairs of trainers from teams from different conferences who hate each other." 2400
717G Underfail flows "You have recently fallen through a hole and, after several hours of unconsciousness, have realized you are in an underground city. On one of your regular, daily walks through the unknown, you have encountered two unusually looking skeletons called Sanz and P\xe2\x80\x99pairus, who decided to accompany you and give you some puzzles for seemingly unknown reasons.One day, Sanz has created a crossword for you. Not any kind of crossword, but a 1D crossword! You are given m words and a string of length n. You are also given an array p, which designates how much each word is worth \xe2\x80\x94 the i-th word is worth pi points. Whenever you find one of the m words in the string, you are given the corresponding number of points. Each position in the crossword can be used at most x times. A certain word can be counted at different places, but you cannot count the same appearance of a word multiple times. If a word is a substring of another word, you can count them both (presuming you haven\xe2\x80\x99t used the positions more than x times).In order to solve the puzzle, you need to tell Sanz what\xe2\x80\x99s the maximum achievable number of points in the crossword. There is no need to cover all postions, just get the maximal score! Crossword and words contain only lowercase English letters." 2400
717F "Heroes of Making Magic III" "data structures" "I\xe2\x80\x99m strolling on sunshine, yeah-ah! And doesn\xe2\x80\x99t it feel good! Well, it certainly feels good for our Heroes of Making Magic, who are casually walking on a one-directional road, fighting imps. Imps are weak and feeble creatures and they are not good at much. However, Heroes enjoy fighting them. For fun, if nothing else. Our Hero, Ignatius, simply adores imps. He is observing a line of imps, represented as a zero-indexed array of integers a of length n, where ai denotes the number of imps at the i-th position. Sometimes, imps can appear out of nowhere. When heroes fight imps, they select a segment of the line, start at one end of the segment, and finish on the other end, without ever exiting the segment. They can move exactly one cell left or right from their current position and when they do so, they defeat one imp on the cell that they moved to, so, the number of imps on that cell decreases by one. This also applies when heroes appear at one end of the segment, at the beginning of their walk. Their goal is to defeat all imps on the segment, without ever moving to an empty cell in it (without imps), since they would get bored. Since Ignatius loves imps, he doesn\xe2\x80\x99t really want to fight them, so no imps are harmed during the events of this task. However, he would like you to tell him whether it would be possible for him to clear a certain segment of imps in the above mentioned way if he wanted to. You are given q queries, which have two types:   1 a b k \xe2\x80\x94 denotes that k imps appear at each cell from the interval [a,\xe2\x80\x89b]  2 a b - asks whether Ignatius could defeat all imps on the interval [a,\xe2\x80\x89b] in the way described above" 2600
717E "Paint it really, really dark gray" "dfs and similar" "I see a pink boar and I want it painted black. Black boars look much more awesome and mighty than the pink ones. Since Jaggy became the ruler of the forest, he has been trying his best to improve the diplomatic relations between the forest region and the nearby ones. Some other rulers, however, have requested too much in return for peace between their two regions, so he realized he has to resort to intimidation. Once a delegate for diplomatic relations of a neighboring region visits Jaggy\xe2\x80\x99s forest, if they see a whole bunch of black boars, they might suddenly change their mind about attacking Jaggy. Black boars are really scary, after all. Jaggy\xe2\x80\x99s forest can be represented as a tree (connected graph without cycles) with n vertices. Each vertex represents a boar and is colored either black or pink. Jaggy has sent a squirrel to travel through the forest and paint all the boars black. The squirrel, however, is quite unusually trained and while it traverses the graph, it changes the color of every vertex it visits, regardless of its initial color: pink vertices become black and black vertices become pink. Since Jaggy is too busy to plan the squirrel\xe2\x80\x99s route, he needs your help. He wants you to construct a walk through the tree starting from vertex 1 such that in the end all vertices are black. A walk is a sequence of vertices, such that every consecutive pair has an edge between them in a tree." 1900
717D "Dexterina\xe2\x80\x99s Lab" games,matrices,probabilities "Dexterina and Womandark have been arch-rivals since they\xe2\x80\x99ve known each other. Since both are super-intelligent teenage girls, they\xe2\x80\x99ve always been trying to solve their disputes in a peaceful and nonviolent way. After god knows how many different challenges they\xe2\x80\x99ve given to one another, their score is equal and they\xe2\x80\x99re both desperately trying to best the other in various games of wits. This time, Dexterina challenged Womandark to a game of Nim.Nim is a two-player game in which players take turns removing objects from distinct heaps. On each turn, a player must remove at least one object, and may remove any number of objects from a single heap. The player who can\'t make a turn loses. By their agreement, the sizes of piles are selected randomly from the range [0,\xe2\x80\x89x]. Each pile\'s size is taken independently from the same probability distribution that is known before the start of the game.Womandark is coming up with a brand new and evil idea on how to thwart Dexterina\xe2\x80\x99s plans, so she hasn\xe2\x80\x99t got much spare time. She, however, offered you some tips on looking fabulous in exchange for helping her win in Nim. Your task is to tell her what is the probability that the first player to play wins, given the rules as above." 1900
717C "Potions Homework" implementation,sortings "Harry Water, Ronaldo, Her-my-oh-knee and their friends have started a new school year at their MDCS School of Speechcraft and Misery. At the time, they are very happy to have seen each other after a long time. The sun is shining, birds are singing, flowers are blooming, and their Potions class teacher, professor Snipe is sulky as usual. Due to his angst fueled by disappointment in his own life, he has given them a lot of homework in Potions class. Each of the n students has been assigned a single task. Some students do certain tasks faster than others. Thus, they want to redistribute the tasks so that each student still does exactly one task, and that all tasks are finished. Each student has their own laziness level, and each task has its own difficulty level. Professor Snipe is trying hard to improve their work ethics, so each student\xe2\x80\x99s laziness level is equal to their task\xe2\x80\x99s difficulty level. Both sets of values are given by the sequence a, where ai represents both the laziness level of the i-th student and the difficulty of his task. The time a student needs to finish a task is equal to the product of their laziness level and the task\xe2\x80\x99s difficulty. They are wondering, what is the minimum possible total time they must spend to finish all tasks if they distribute them in the optimal way. Each person should receive one task and each task should be given to one person. Print the answer modulo 10\xe2\x80\x89007." 1200
717B "R3D3\xe2\x80\x99s Summer Adventure" dp,greedy "R3D3 spent some time on an internship in MDCS. After earning enough money, he decided to go on a holiday somewhere far, far away. He enjoyed suntanning, drinking alcohol-free cocktails and going to concerts of popular local bands. While listening to ""The White Buttons"" and their hit song ""Dacan the Baker"", he met another robot for whom he was sure is the love of his life. Well, his summer, at least. Anyway, R3D3 was too shy to approach his potential soulmate, so he decided to write her a love letter. However, he stumbled upon a problem. Due to a terrorist threat, the Intergalactic Space Police was monitoring all letters sent in the area. Thus, R3D3 decided to invent his own alphabet, for which he was sure his love would be able to decipher.There are n letters in R3D3\xe2\x80\x99s alphabet, and he wants to represent each letter as a sequence of \'0\' and \'1\', so that no letter\xe2\x80\x99s sequence is a prefix of another letter\'s sequence. Since the Intergalactic Space Communications Service has lately introduced a tax for invented alphabets, R3D3 must pay a certain amount of money for each bit in his alphabet\xe2\x80\x99s code (check the sample test for clarifications). He is too lovestruck to think clearly, so he asked you for help.Given the costs c0 and c1 for each \'0\' and \'1\' in R3D3\xe2\x80\x99s alphabet, respectively, you should come up with a coding for the alphabet (with properties as above) with minimum total cost." 2700
717A "Festival Organization" "combinatorics,math,number theory" "The Prodiggers are quite a cool band and for this reason, they have been the surprise guest at the ENTER festival for the past 80 years. At the beginning of their careers, they weren\xe2\x80\x99t so successful, so they had to spend time digging channels to earn money; hence the name. Anyway, they like to tour a lot and have surprising amounts of energy to do extremely long tours. However, they hate spending two consecutive days without having a concert, so they would like to avoid it.A tour is defined by a sequence of concerts and days-off. You need to count in how many ways The Prodiggers can select k different tours of the same length between l and r.For example if k\xe2\x80\x89=\xe2\x80\x892, l\xe2\x80\x89=\xe2\x80\x891 and r\xe2\x80\x89=\xe2\x80\x892, if we define concert day as {1} and day-off as {0}, here are all possible tours: {0}, {1}, {00}, {01}, {10}, {11}. But tour 00 can not be selected because it has 2 days-off in a row. Now, we need to count in how many ways we can select k\xe2\x80\x89=\xe2\x80\x892 tours of the same length in range [1;2]. Here they are: {0,1}; {01,10}; {01,11}; {10,11}.Since their schedule is quite busy, they want you to tell them in how many ways can do that, modulo 1\xe2\x80\x89000\xe2\x80\x89000\xe2\x80\x89007 (109\xe2\x80\x89+\xe2\x80\x897)." 2900
716B "Complete the Word" "greedy,two pointers" "ZS the Coder loves to read the dictionary. He thinks that a word is nice if there exists a substring (contiguous segment of letters) of it of length 26 where each letter of English alphabet appears exactly once. In particular, if the string has length strictly less than 26, no such substring exists and thus it is not nice.Now, ZS the Coder tells you a word, where some of its letters are missing as he forgot them. He wants to determine if it is possible to fill in the missing letters so that the resulting word is nice. If it is possible, he needs you to find an example of such a word as well. Can you help him?" 1300
716A "Crazy Computer" implementation "ZS the Coder is coding on a crazy computer. If you don\'t type in a word for a c consecutive seconds, everything you typed disappear! More formally, if you typed a word at second a and then the next word at second b, then if b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c, just the new word is appended to other words on the screen. If b\xe2\x80\x89-\xe2\x80\x89a\xe2\x80\x89>\xe2\x80\x89c, then everything on the screen disappears and after that the word you have typed appears on the screen.For example, if c\xe2\x80\x89=\xe2\x80\x895 and you typed words at seconds 1,\xe2\x80\x893,\xe2\x80\x898,\xe2\x80\x8914,\xe2\x80\x8919,\xe2\x80\x8920 then at the second 8 there will be 3 words on the screen. After that, everything disappears at the second 13 because nothing was typed. At the seconds 14 and 19 another two words are typed, and finally, at the second 20, one more word is typed, and a total of 3 words remain on the screen.You\'re given the times when ZS the Coder typed the words. Determine how many words remain on the screen after he finished typing everything." 800
715E "Complete the Permutations" combinatorics,fft,graphs,math "ZS the Coder is given two permutations p and q of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n}, but some of their elements are replaced with 0. The distance between two permutations p and q is defined as the minimum number of moves required to turn p into q. A move consists of swapping exactly 2 elements of p.ZS the Coder wants to determine the number of ways to replace the zeros with positive integers from the set {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} such that p and q are permutations of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} and the distance between p and q is exactly k.ZS the Coder wants to find the answer for all 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891. Can you help him?" 3400
715D "Create a Maze" "constructive algorithms" "ZS the Coder loves mazes. Your job is to create one so that he can play with it. A maze consists of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m rooms, and the rooms are arranged in n rows (numbered from the top to the bottom starting from 1) and m columns (numbered from the left to the right starting from 1). The room in the i-th row and j-th column is denoted by (i,\xe2\x80\x89j). A player starts in the room (1,\xe2\x80\x891) and wants to reach the room (n,\xe2\x80\x89m).Each room has four doors (except for ones at the maze border), one on each of its walls, and two adjacent by the wall rooms shares the same door. Some of the doors are locked, which means it is impossible to pass through the door. For example, if the door connecting (i,\xe2\x80\x89j) and (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) is locked, then we can\'t go from (i,\xe2\x80\x89j) to (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891). Also, one can only travel between the rooms downwards (from the room (i,\xe2\x80\x89j) to the room (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j)) or rightwards (from the room (i,\xe2\x80\x89j) to the room (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891)) provided the corresponding door is not locked.  This image represents a maze with some doors locked. The colored arrows denotes all the possible paths while a red cross denotes a locked door. ZS the Coder considers a maze to have difficulty x if there is exactly x ways of travelling from the room (1,\xe2\x80\x891) to the room (n,\xe2\x80\x89m). Two ways are considered different if they differ by the sequence of rooms visited while travelling.Your task is to create a maze such that its difficulty is exactly equal to T. In addition, ZS the Coder doesn\'t like large mazes, so the size of the maze and the number of locked doors are limited. Sounds simple enough, right?" 3100
715C "Digit Tree" "dfs and similar,divide and conquer,dsu,trees" "ZS the Coder has a large tree. It can be represented as an undirected connected graph of n vertices numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891 and n\xe2\x80\x89-\xe2\x80\x891 edges between them. There is a single nonzero digit written on each edge.One day, ZS the Coder was bored and decided to investigate some properties of the tree. He chose a positive integer M, which is coprime to 10, i.e. .ZS consider an ordered pair of distinct vertices (u,\xe2\x80\x89v) interesting when if he would follow the shortest path from vertex u to vertex v and write down all the digits he encounters on his path in the same order, he will get a decimal representaion of an integer divisible by M.Formally, ZS consider an ordered pair of distinct vertices (u,\xe2\x80\x89v) interesting if the following states true:  Let a1\xe2\x80\x89=\xe2\x80\x89u,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak\xe2\x80\x89=\xe2\x80\x89v be the sequence of vertices on the shortest path from u to v in the order of encountering them;  Let di (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k) be the digit written on the edge between vertices ai and ai\xe2\x80\x89+\xe2\x80\x891;  The integer  is divisible by M. Help ZS the Coder find the number of interesting pairs!" 2700
715B "Complete The Graph" "binary search,constructive algorithms,graphs,shortest paths" "ZS the Coder has drawn an undirected graph of n vertices numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891 and m edges between them. Each edge of the graph is weighted, each weight is a positive integer.The next day, ZS the Coder realized that some of the weights were erased! So he wants to reassign positive integer weight to each of the edges which weights were erased, so that the length of the shortest path between vertices s and t in the resulting graph is exactly L. Can you help him?" 2300
715A "Plus and Square Root" "constructive algorithms,math" "ZS the Coder is playing a game. There is a number displayed on the screen and there are two buttons, \'\xe2\x80\x89+\xe2\x80\x89\' (plus) and \'\' (square root). Initially, the number 2 is displayed on the screen. There are n\xe2\x80\x89+\xe2\x80\x891 levels in the game and ZS the Coder start at the level 1.When ZS the Coder is at level k, he can :  Press the \'\xe2\x80\x89+\xe2\x80\x89\' button. This increases the number on the screen by exactly k. So, if the number on the screen was x, it becomes x\xe2\x80\x89+\xe2\x80\x89k. Press the \'\' button. Let the number on the screen be x. After pressing this button, the number becomes . After that, ZS the Coder levels up, so his current level becomes k\xe2\x80\x89+\xe2\x80\x891. This button can only be pressed when x is a perfect square, i.e. x\xe2\x80\x89=\xe2\x80\x89m2 for some positive integer m. Additionally, after each move, if ZS the Coder is at level k, and the number on the screen is m, then m must be a multiple of k. Note that this condition is only checked after performing the press. For example, if ZS the Coder is at level 4 and current number is 100, he presses the \'\' button and the number turns into 10. Note that at this moment, 10 is not divisible by 4, but this press is still valid, because after it, ZS the Coder is at level 5, and 10 is divisible by 5.ZS the Coder needs your help in beating the game \xe2\x80\x94 he wants to reach level n\xe2\x80\x89+\xe2\x80\x891. In other words, he needs to press the \'\' button n times. Help him determine the number of times he should press the \'\xe2\x80\x89+\xe2\x80\x89\' button before pressing the \'\' button at each level. Please note that ZS the Coder wants to find just any sequence of presses allowing him to reach level n\xe2\x80\x89+\xe2\x80\x891, but not necessarily a sequence minimizing the number of presses." 1600
714B "Filya and Homework" implementation,sortings "Today, hedgehog Filya went to school for the very first time! Teacher gave him a homework which Filya was unable to complete without your help.Filya is given an array of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. First, he pick an integer x and then he adds x to some elements of the array (no more than once), subtract x from some other elements (also, no more than once) and do no change other elements. He wants all elements of the array to be equal.Now he wonders if it\'s possible to pick such integer x and change some elements of the array using this x in order to make all elements equal." 1200
714A "Meeting of Old Friends" implementation,math "Today an outstanding event is going to happen in the forest \xe2\x80\x94 hedgehog Filya will come to his old fried Sonya!Sonya is an owl and she sleeps during the day and stay awake from minute l1 to minute r1 inclusive. Also, during the minute k she prinks and is unavailable for Filya.Filya works a lot and he plans to visit Sonya from minute l2 to minute r2 inclusive.Calculate the number of minutes they will be able to spend together." 1100
713E "Sonya Partymaker" "binary search,dp" "Owl Sonya decided to become a partymaker. To train for this role she gather all her owl friends in the country house. There are m chairs located in a circle and consequently numbered with integers from 1 to m. Thus, chairs i and i\xe2\x80\x89+\xe2\x80\x891 are neighbouring for all i from 1 to m\xe2\x80\x89-\xe2\x80\x891. Chairs 1 and m are also neighbouring. Some chairs are occupied by her friends. There are n friends in total. No two friends occupy the same chair. Rules are the following:  Each participant removes from the game the chair he is currently sitting on.  Each of the participants choose a direction that she will follow: clockwise (indices increase, from m goes to 1) and counter-clockwise (indices decrease, from 1 goes to m). This direction may coincide or be different for any pair of owls.  Each turn all guests move one step in the chosen directions. If some guest move to the position with a chair there, he removes this chair from the game.  Game ends if there are no more chairs left in the game. Owls are very busy and want to get rid of the game as soon as possible. They cooperate to pick the direction. Your goal is to find the minimum number o moves required to finish the game." 3300
713D "Animals and Puzzle" "binary search,data structures" "Owl Sonya gave a huge lake puzzle of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89m to hedgehog Filya as a birthday present. Friends immediately started to assemble the puzzle, but some parts of it turned out to be empty \xe2\x80\x94 there was no picture on them. Parts with picture on it are denoted by 1, while empty parts are denoted by 0. Rows of the puzzle are numbered from top to bottom with integers from 1 to n, while columns are numbered from left to right with integers from 1 to m.Animals decided to complete the picture and play with it, as it might be even more fun! Owl and hedgehog ask each other some queries. Each query is provided by four integers x1, y1, x2, y2 which define the rectangle, where (x1,\xe2\x80\x89y1) stands for the coordinates of the up left cell of the rectangle, while (x2,\xe2\x80\x89y2) stands for the coordinates of the bottom right cell. The answer to the query is the size of the maximum square consisting of picture parts only (only parts denoted by 1) and located fully inside the query rectangle.Help Sonya and Filya answer t queries." 2700
713C "Sonya and Problem Wihtout a Legend" dp,sortings "Sonya was unable to think of a story for this problem, so here comes the formal description.You are given the array containing n positive integers. At one turn you can pick any element and increase or decrease it by 1. The goal is the make the array strictly increasing by making the minimum possible number of operations. You are allowed to change elements in any way, they can become negative or equal to 0." 2300
713B "Searching Rectangles" "binary search,constructive algorithms,interactive" "Filya just learned new geometry object \xe2\x80\x94 rectangle. He is given a field consisting of n\xe2\x80\x89\xc3\x97\xe2\x80\x89n unit cells. Rows are numbered from bottom to top with integer from 1 to n. Columns are numbered from left to right with integers from 1 to n. Cell, located at the intersection of the row r and column c is denoted as (r,\xe2\x80\x89c). Filya has painted two rectangles, such that their sides are parallel to coordinate axes and each cell lies fully inside or fully outside each of them. Moreover, no cell lies in both rectangles.Later, hedgehog Filya became interested in the location of his rectangles but was unable to find the sheet of paper they were painted on. They were taken by Sonya and now she wants to play a little game with Filya. He tells her a query rectangle and she replies with the number of initial rectangles that lie fully inside the given query rectangle. The query rectangle should match the same conditions as initial rectangles. Rectangle lies fully inside the query if each o its cells lies inside the query.Filya knows Sonya really well, so is sure that if he asks more than 200 questions she will stop to reply." 2200
713A "Sonya and Queries" "data structures,implementation" "Today Sonya learned about long integers and invited all her friends to share the fun. Sonya has an initially empty multiset with integers. Friends give her t queries, each of one of the following type:  \xe2\x80\x89+\xe2\x80\x89 ai \xe2\x80\x94 add non-negative integer ai to the multiset. Note, that she has a multiset, thus there may be many occurrences of the same integer.  \xe2\x80\x89-\xe2\x80\x89 ai \xe2\x80\x94 delete a single occurrence of non-negative integer ai from the multiset. It\'s guaranteed, that there is at least one ai in the multiset.  ? s \xe2\x80\x94 count the number of integers in the multiset (with repetitions) that match some pattern s consisting of 0 and 1. In the pattern, 0 stands for the even digits, while 1 stands for the odd. Integer x matches the pattern s, if the parity of the i-th from the right digit in decimal notation matches the i-th from the right digit of the pattern. If the pattern is shorter than this integer, it\'s supplemented with 0-s from the left. Similarly, if the integer is shorter than the pattern its decimal notation is supplemented with the 0-s from the left. For example, if the pattern is s\xe2\x80\x89=\xe2\x80\x89010, than integers 92, 2212, 50 and 414 match the pattern, while integers 3, 110, 25 and 1030 do not." 1400
712E "Memory and Casinos" "data structures,math,probabilities" "There are n casinos lined in a row. If Memory plays at casino i, he has probability pi to win and move to the casino on the right (i\xe2\x80\x89+\xe2\x80\x891) or exit the row (if i\xe2\x80\x89=\xe2\x80\x89n), and a probability 1\xe2\x80\x89-\xe2\x80\x89pi to lose and move to the casino on the left (i\xe2\x80\x89-\xe2\x80\x891) or also exit the row (if i\xe2\x80\x89=\xe2\x80\x891). We say that Memory dominates on the interval i... j if he completes a walk such that,  He starts on casino i.  He never looses in casino i.  He finishes his walk by winning in casino j. Note that Memory can still walk left of the 1-st casino and right of the casino n and that always finishes the process.Now Memory has some requests, in one of the following forms:  1 i a b: Set .  2 l r: Print the probability that Memory will dominate on the interval l... r, i.e. compute the probability that Memory will first leave the segment l... r after winning at casino r, if she starts in casino l. It is guaranteed that at any moment of time p is a non-decreasing sequence, i.e. pi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891 for all i from 1 to n\xe2\x80\x89-\xe2\x80\x891.Please help Memory by answering all his requests!" 2500
712D "Memory and Scores" combinatorics,dp,math "Memory and his friend Lexa are competing to get higher score in one popular computer game. Memory starts with score a and Lexa starts with score b. In a single turn, both Memory and Lexa get some integer in the range [\xe2\x80\x89-\xe2\x80\x89k;k] (i.e. one integer among \xe2\x80\x89-\xe2\x80\x89k,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89k\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89k) and add them to their current scores. The game has exactly t turns. Memory and Lexa, however, are not good at this game, so they both always get a random integer at their turn.Memory wonders how many possible games exist such that he ends with a strictly higher score than Lexa. Two games are considered to be different if in at least one turn at least one player gets different score. There are (2k\xe2\x80\x89+\xe2\x80\x891)2t games in total. Since the answer can be very large, you should print it modulo 109\xe2\x80\x89+\xe2\x80\x897. Please solve this problem for Memory." 2200
712C "Memory and De-Evolution" greedy,math "Memory is now interested in the de-evolution of objects, specifically triangles. He starts with an equilateral triangle of side length x, and he wishes to perform operations to obtain an equilateral triangle of side length y.In a single second, he can modify the length of a single side of the current triangle such that it remains a non-degenerate triangle (triangle of positive area). At any moment of time, the length of each side should be integer.What is the minimum number of seconds required for Memory to obtain the equilateral triangle of side length y?" 1600
712B "Memory and Trident" implementation,strings "Memory is performing a walk on the two-dimensional plane, starting at the origin. He is given a string s with his directions for motion: An \'L\' indicates he should move one unit left.  An \'R\' indicates he should move one unit right.  A \'U\' indicates he should move one unit up.  A \'D\' indicates he should move one unit down.But now Memory wants to end at the origin. To do this, he has a special trident. This trident can replace any character in s with any of \'L\', \'R\', \'U\', or \'D\'. However, because he doesn\'t want to wear out the trident, he wants to make the minimum number of edits possible. Please tell Memory what is the minimum number of changes he needs to make to produce a string that, when walked, will end at the origin, or if there is no such string." 1100
712A "Memory and Crow" implementation,math "There are n integers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn written in a row. For all i from 1 to n, values ai are defined by the crows performing the following procedure:  The crow sets ai initially 0.  The crow then adds bi to ai, subtracts bi\xe2\x80\x89+\xe2\x80\x891, adds the bi\xe2\x80\x89+\xe2\x80\x892 number, and so on until the n\'th number. Thus, ai\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89-\xe2\x80\x89bi\xe2\x80\x89+\xe2\x80\x893.... Memory gives you the values a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and he now wants you to find the initial numbers b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bn written in the row? Can you do it?" 800
711E "ZS and The Birthday Paradox" "math,number theory,probabilities" "ZS the Coder has recently found an interesting concept called the Birthday Paradox. It states that given a random set of 23 people, there is around 50% chance that some two of them share the same birthday. ZS the Coder finds this very interesting, and decides to test this with the inhabitants of Udayland.In Udayland, there are 2n days in a year. ZS the Coder wants to interview k people from Udayland, each of them has birthday in one of 2n days (each day with equal probability). He is interested in the probability of at least two of them have the birthday at the same day. ZS the Coder knows that the answer can be written as an irreducible fraction . He wants to find the values of A and B (he does not like to deal with floating point numbers). Can you help him?" 2300
711D "Directed Roads" "combinatorics,dfs and similar,graphs,math" "ZS the Coder and Chris the Baboon has explored Udayland for quite some time. They realize that it consists of n towns numbered from 1 to n. There are n directed roads in the Udayland. i-th of them goes from town i to some other town ai (ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i). ZS the Coder can flip the direction of any road in Udayland, i.e. if it goes from town A to town B before the flip, it will go from town B to town A after.ZS the Coder considers the roads in the Udayland confusing, if there is a sequence of distinct towns A1,\xe2\x80\x89A2,\xe2\x80\x89...,\xe2\x80\x89Ak (k\xe2\x80\x89>\xe2\x80\x891) such that for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89k there is a road from town Ai to town Ai\xe2\x80\x89+\xe2\x80\x891 and another road from town Ak to town A1. In other words, the roads are confusing if some of them form a directed cycle of some towns.Now ZS the Coder wonders how many sets of roads (there are 2n variants) in initial configuration can he choose to flip such that after flipping each road in the set exactly once, the resulting network will not be confusing.Note that it is allowed that after the flipping there are more than one directed road from some town and possibly some towns with no roads leading out of it, or multiple roads between any pair of cities." 1900
711C "Coloring Trees" dp "ZS the Coder and Chris the Baboon has arrived at Udayland! They walked in the park where n trees grow. They decided to be naughty and color the trees in the park. The trees are numbered with integers from 1 to n from left to right.Initially, tree i has color ci. ZS the Coder and Chris the Baboon recognizes only m different colors, so 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ci\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m, where ci\xe2\x80\x89=\xe2\x80\x890 means that tree i is uncolored.ZS the Coder and Chris the Baboon decides to color only the uncolored trees, i.e. the trees with ci\xe2\x80\x89=\xe2\x80\x890. They can color each of them them in any of the m colors from 1 to m. Coloring the i-th tree with color j requires exactly pi,\xe2\x80\x89j litres of paint.The two friends define the beauty of a coloring of the trees as the minimum number of contiguous groups (each group contains some subsegment of trees) you can split all the n trees into so that each group contains trees of the same color. For example, if the colors of the trees from left to right are 2,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x891,\xe2\x80\x893, the beauty of the coloring is 7, since we can partition the trees into 7 contiguous groups of the same color : {2},\xe2\x80\x89{1,\xe2\x80\x891,\xe2\x80\x891},\xe2\x80\x89{3},\xe2\x80\x89{2,\xe2\x80\x892},\xe2\x80\x89{3},\xe2\x80\x89{1},\xe2\x80\x89{3}. ZS the Coder and Chris the Baboon wants to color all uncolored trees so that the beauty of the coloring is exactly k. They need your help to determine the minimum amount of paint (in litres) needed to finish the job.Please note that the friends can\'t color the trees that are already colored." 1700
711B "Chris and Magic Square" "constructive algorithms,implementation" "ZS the Coder and Chris the Baboon arrived at the entrance of Udayland. There is a n\xe2\x80\x89\xc3\x97\xe2\x80\x89n magic grid on the entrance which is filled with integers. Chris noticed that exactly one of the cells in the grid is empty, and to enter Udayland, they need to fill a positive integer into the empty cell.Chris tried filling in random numbers but it didn\'t work. ZS the Coder realizes that they need to fill in a positive integer such that the numbers in the grid form a magic square. This means that he has to fill in a positive integer so that the sum of the numbers in each row of the grid (), each column of the grid (), and the two long diagonals of the grid (the main diagonal \xe2\x80\x94  and the secondary diagonal \xe2\x80\x94 ) are equal. Chris doesn\'t know what number to fill in. Can you help Chris find the correct positive integer to fill in or determine that it is impossible?" 1400
711A "Bus to Udayland" "brute force,implementation" "ZS the Coder and Chris the Baboon are travelling to Udayland! To get there, they have to get on the special IOI bus. The IOI bus has n rows of seats. There are 4 seats in each row, and the seats are separated into pairs by a walkway. When ZS and Chris came, some places in the bus was already occupied.ZS and Chris are good friends. They insist to get a pair of neighbouring empty seats. Two seats are considered neighbouring if they are in the same row and in the same pair. Given the configuration of the bus, can you help ZS and Chris determine where they should sit?" 800
710F "String Set Queries" "brute force,data structures,hashing,interactive,string suffix structures,strings" "You should process m queries over a set D of strings. Each query is one of three kinds:  Add a string s to the set D. It is guaranteed that the string s was not added before.  Delete a string s from the set D. It is guaranteed that the string s is in the set D.  For the given string s find the number of occurrences of the strings from the set D. If some string p from D has several occurrences in s you should count all of them. Note that you should solve the problem in online mode. It means that you can\'t read the whole input at once. You can read each query only after writing the answer for the last query of the third type. Use functions fflush in C++ and BufferedWriter.flush in Java languages after each writing in your program." 2400
710E "Generate a String" "dfs and similar,dp" "zscoder wants to generate an input file for some programming competition problem.His input is a string consisting of n letters \'a\'. He is too lazy to write a generator so he will manually generate the input in a text editor.Initially, the text editor is empty. It takes him x seconds to insert or delete a letter \'a\' from the text file and y seconds to copy the contents of the entire text file, and duplicate it.zscoder wants to find the minimum amount of time needed for him to create the input file of exactly n letters \'a\'. Help him to determine the amount of time needed to generate the input." 2000
710D "Two Arithmetic Progressions" "math,number theory" "You are given two arithmetic progressions: a1k\xe2\x80\x89+\xe2\x80\x89b1 and a2l\xe2\x80\x89+\xe2\x80\x89b2. Find the number of integers x such that L\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89R and x\xe2\x80\x89=\xe2\x80\x89a1k\'\xe2\x80\x89+\xe2\x80\x89b1\xe2\x80\x89=\xe2\x80\x89a2l\'\xe2\x80\x89+\xe2\x80\x89b2, for some integers k\',\xe2\x80\x89l\'\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890." 2500
710C "Magic Odd Square" "constructive algorithms,math" "Find an n\xe2\x80\x89\xc3\x97\xe2\x80\x89n matrix with different numbers from 1 to n2, so the sum in each row, column and both main diagonals are odd." 1500
710B "Optimal Point on a Line" "brute force,sortings" "You are given n points on a line with their coordinates xi. Find the point x so the sum of distances to the given points is minimal." 1400
710A "King Moves" implementation "The only king stands on the standard chess board. You are given his position in format ""cd"", where c is the column from \'a\' to \'h\' and d is the row from \'1\' to \'8\'. Find the number of moves permitted for the king.Check the king\'s moves here https://en.wikipedia.org/wiki/King_(chess).  King moves from the position e4" 800
709B Checkpoints greedy,implementation,sortings "Vasya takes part in the orienteering competition. There are n checkpoints located along the line at coordinates x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn. Vasya starts at the point with coordinate a. His goal is to visit at least n\xe2\x80\x89-\xe2\x80\x891 checkpoint in order to finish the competition. Participant are allowed to visit checkpoints in arbitrary order.Vasya wants to pick such checkpoints and the order of visiting them that the total distance travelled is minimized. He asks you to calculate this minimum possible value." 1500
709A Juicer implementation "Kolya is going to make fresh orange juice. He has n oranges of sizes a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Kolya will put them in the juicer in the fixed order, starting with orange of size a1, then orange of size a2 and so on. To be put in the juicer the orange must have size not exceeding b, so if Kolya sees an orange that is strictly greater he throws it away and continues with the next one.The juicer has a special section to collect waste. It overflows if Kolya squeezes oranges of the total size strictly greater than d. When it happens Kolya empties the waste section (even if there are no more oranges) and continues to squeeze the juice. How many times will he have to empty the waste section?" 900
708E "Student\'s Camp" dp,math "Alex studied well and won the trip to student camp Alushta, located on the seashore. Unfortunately, it\'s the period of the strong winds now and there is a chance the camp will be destroyed! Camp building can be represented as the rectangle of n\xe2\x80\x89+\xe2\x80\x892 concrete blocks height and m blocks width.Every day there is a breeze blowing from the sea. Each block, except for the blocks of the upper and lower levers, such that there is no block to the left of it is destroyed with the probability . Similarly, each night the breeze blows in the direction to the sea. Thus, each block (again, except for the blocks of the upper and lower levers) such that there is no block to the right of it is destroyed with the same probability p. Note, that blocks of the upper and lower level are indestructible, so there are only n\xc2\xb7m blocks that can be destroyed.The period of the strong winds will last for k days and k nights. If during this period the building will split in at least two connected components, it will collapse and Alex will have to find another place to spend summer.Find the probability that Alex won\'t have to look for other opportunities and will be able to spend the summer in this camp." 3100
708D "Incorrect Flow" flows "At the entrance examination for the magistracy of the MSU Cyber-Mechanics Department Sasha got the question about Ford-Fulkerson algorithm. He knew the topic perfectly as he worked with it many times on programming competition. As the task for the question he was given a network with partially build flow that he had to use in order to demonstrate the workflow of the algorithm. He quickly finished to write the text and took a look at the problem only to understand that the given network is incorrect!Suppose you are given a directed graph G(V,\xe2\x80\x89E) with two special nodes s and t called source and sink. We denote as n the number of nodes in the graph, i.e. n\xe2\x80\x89=\xe2\x80\x89|V| and m stands for the number of directed edges in the graph, i.e. m\xe2\x80\x89=\xe2\x80\x89|E|. For the purpose of this problem we always consider node 1 to be the source and node n to be the sink. In addition, for each edge of the graph e we define the capacity function c(e) and flow function f(e). Function f(e) represents the correct flow if the following conditions are satisfied:  For each edge  the flow is non-negative and does not exceed capacity c(e), i.e. 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89f(e)\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c(e).  For each node , that is not source or sink (v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89s and v\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89t) the sum of flows of all edges going in v is equal to the sum of the flows among all edges going out from v. In other words, there is no flow stuck in v. It was clear that as the exam was prepared last night and there are plenty of mistakes in the tasks. Sasha asked one of the professors to fix the network or give the correct task, but the reply was that the magistrate student should be able to fix the network himself. As the professor doesn\'t want the task to become easier, he asks Sasha to fix the network in a such way that the total number of changes is minimum possible. Sasha is not allowed to remove edges, add new ones or reverse the direction of existing edges. The only thing he is able to do is to change capacity function c(e) and flow function f(e). Moreover, all the values should remain non-negative integers. There is no requirement on the flow to be maximum in any sense.Find the minimum possible total change of the functions f(e) and c(e) that Sasha has to make in order to make the flow correct. The total change is defined as the sum of absolute differences, i.e. if new functions are f\xe2\x80\x89*\xe2\x80\x89(e) and c\xe2\x80\x89*\xe2\x80\x89(e), then the total change is ." 2900
708C Centroids "data structures,dfs and similar,dp,graphs,greedy,trees" "Tree is a connected acyclic graph. Suppose you are given a tree consisting of n vertices. The vertex of this tree is called centroid if the size of each connected component that appears if this vertex is removed from the tree doesn\'t exceed .You are given a tree of size n and can perform no more than one edge replacement. Edge replacement is the operation of removing one edge from the tree (without deleting incident vertices) and inserting one new edge (without adding new vertices) in such a way that the graph remains a tree. For each vertex you have to determine if it\'s possible to make it centroid by performing no more than one edge replacement." 2300
708B "Recover the String" "constructive algorithms,greedy,implementation,math" "For each string s consisting of characters \'0\' and \'1\' one can define four integers a00, a01, a10 and a11, where axy is the number of subsequences of length 2 of the string s equal to the sequence {x,\xe2\x80\x89y}. In these problem you are given four integers a00, a01, a10, a11 and have to find any non-empty string s that matches them, or determine that there is no such string. One can prove that if at least one answer exists, there exists an answer of length no more than 1\xe2\x80\x89000\xe2\x80\x89000." 1900
708A "Letters Cyclic Shift" "constructive algorithms,greedy,implementation,strings" "You are given a non-empty string s consisting of lowercase English letters. You have to pick exactly one non-empty substring of s and shift all its letters \'z\'  \'y\'  \'x\'  \'b\'  \'a\'  \'z\'. In other words, each character is replaced with the previous character of English alphabet and \'a\' is replaced with \'z\'.What is the lexicographically minimum string that can be obtained from s by performing this shift exactly once?" 1200
707E Garlands "data structures" "Like all children, Alesha loves New Year celebration. During the celebration he and his whole family dress up the fir-tree. Like all children, Alesha likes to play with garlands \xe2\x80\x94 chains consisting of a lightbulbs.Alesha uses a grid field sized n\xe2\x80\x89\xc3\x97\xe2\x80\x89m for playing. The rows of the field are numbered from 1 to n from the top to the bottom and columns are numbered from 1 to m from the left to the right.Alesha has k garlands which he places at the field. He does so in the way such that each lightbulb of each garland lies in the center of some cell in the field, and each cell contains at most one lightbulb. Of course lightbulbs, which are neighbours in some garland, appears in cells neighbouring by a side.The example of garland placing.Each garland is turned off or turned on at any moment. If some garland is turned on then each of its lightbulbs is turned on, the same applies for garland turned off. Each lightbulb in the whole garland set is unique, and thus, being turned on, brings Alesha some pleasure, described by an integer value. Turned off lightbulbs don\'t bring Alesha any pleasure.Alesha can turn garlands on and off and wants to know the sum of pleasure value which the lightbulbs, placed in the centers of the cells in some rectangular part of the field, bring him. Initially all the garlands are turned on.Alesha is still very little and can\'t add big numbers. He extremely asks you to help him." 2400
707D "Persistent Bookcase" "bitmasks,data structures,dfs and similar,implementation" "Recently in school Alina has learned what are the persistent data structures: they are data structures that always preserves the previous version of itself and access to it when it is modified.After reaching home Alina decided to invent her own persistent data structure. Inventing didn\'t take long: there is a bookcase right behind her bed. Alina thinks that the bookcase is a good choice for a persistent data structure. Initially the bookcase is empty, thus there is no book at any position at any shelf.The bookcase consists of n shelves, and each shelf has exactly m positions for books at it. Alina enumerates shelves by integers from 1 to n and positions at shelves \xe2\x80\x94 from 1 to m. Initially the bookcase is empty, thus there is no book at any position at any shelf in it.Alina wrote down q operations, which will be consecutively applied to the bookcase. Each of the operations has one of four types: 1 i j \xe2\x80\x94 Place a book at position j at shelf i if there is no book at it. 2 i j \xe2\x80\x94 Remove the book from position j at shelf i if there is a book at it. 3 i \xe2\x80\x94 Invert book placing at shelf i. This means that from every position at shelf i which has a book at it, the book should be removed, and at every position at shelf i which has not book at it, a book should be placed. 4 k \xe2\x80\x94 Return the books in the bookcase in a state they were after applying k-th operation. In particular, k\xe2\x80\x89=\xe2\x80\x890 means that the bookcase should be in initial state, thus every book in the bookcase should be removed from its position.After applying each of operation Alina is interested in the number of books in the bookcase. Alina got \'A\' in the school and had no problem finding this values. Will you do so?" 2200
707C "Pythagorean Triples" "math,number theory" "Katya studies in a fifth grade. Recently her class studied right triangles and the Pythagorean theorem. It appeared, that there are triples of positive integers such that you can construct a right triangle with segments of lengths corresponding to triple. Such triples are called Pythagorean triples.For example, triples (3,\xe2\x80\x894,\xe2\x80\x895), (5,\xe2\x80\x8912,\xe2\x80\x8913) and (6,\xe2\x80\x898,\xe2\x80\x8910) are Pythagorean triples.Here Katya wondered if she can specify the length of some side of right triangle and find any Pythagorean triple corresponding to such length? Note that the side which length is specified can be a cathetus as well as hypotenuse.Katya had no problems with completing this task. Will you do the same?" 1500
707B Bakery graphs "Masha wants to open her own bakery and bake muffins in one of the n cities numbered from 1 to n. There are m bidirectional roads, each of whose connects some pair of cities.To bake muffins in her bakery, Masha needs to establish flour supply from some storage. There are only k storages, located in different cities numbered a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89ak.Unforunately the law of the country Masha lives in prohibits opening bakery in any of the cities which has storage located in it. She can open it only in one of another n\xe2\x80\x89-\xe2\x80\x89k cities, and, of course, flour delivery should be paid \xe2\x80\x94 for every kilometer of path between storage and bakery Masha should pay 1 ruble.Formally, Masha will pay x roubles, if she will open the bakery in some city b (ai\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and choose a storage in some city s (s\xe2\x80\x89=\xe2\x80\x89aj for some 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and b and s are connected by some path of roads of summary length x (if there are more than one path, Masha is able to choose which of them should be used).Masha is very thrifty and rational. She is interested in a city, where she can open her bakery (and choose one of k storages and one of the paths between city with bakery and city with storage) and pay minimum possible amount of rubles for flour delivery. Please help Masha find this amount." 1300
707A "Brain\'s Photos" implementation "Small, but very brave, mouse Brain was not accepted to summer school of young villains. He was upset and decided to postpone his plans of taking over the world, but to become a photographer instead.As you may know, the coolest photos are on the film (because you can specify the hashtag #film for such).Brain took a lot of colourful pictures on colored and black-and-white film. Then he developed and translated it into a digital form. But now, color and black-and-white photos are in one folder, and to sort them, one needs to spend more than one hour!As soon as Brain is a photographer not programmer now, he asks you to help him determine for a single photo whether it is colored or black-and-white.Photo can be represented as a matrix sized n\xe2\x80\x89\xc3\x97\xe2\x80\x89m, and each element of the matrix stores a symbol indicating corresponding pixel color. There are only 6 colors:   \'C\' (cyan) \'M\' (magenta) \'Y\' (yellow) \'W\' (white) \'G\' (grey) \'B\' (black) The photo is considered black-and-white if it has only white, black and grey pixels in it. If there are any of cyan, magenta or yellow pixels in the photo then it is considered colored." 800
706E "Working routine" "data structures,implementation" "Vasiliy finally got to work, where there is a huge amount of tasks waiting for him. Vasiliy is given a matrix consisting of n rows and m columns and q tasks. Each task is to swap two submatrices of the given matrix.For each task Vasiliy knows six integers ai, bi, ci, di, hi, wi, where ai is the index of the row where the top-left corner of the first rectangle is located, bi is the index of its column, ci is the index of the row of the top-left corner of the second rectangle, di is the index of its column, hi is the height of the rectangle and wi is its width.It\'s guaranteed that two rectangles in one query do not overlap and do not touch, that is, no cell belongs to both rectangles, and no two cells belonging to different rectangles share a side. However, rectangles are allowed to share an angle.Vasiliy wants to know how the matrix will look like after all tasks are performed." 2500
706D "Vasiliy\'s Multiset" "binary search,bitmasks,data structures,trees" "Author has gone out of the stories about Vasiliy, so here is just a formal task description.You are given q queries and a multiset A, initially containing only integer 0. There are three types of queries:  ""+ x"" \xe2\x80\x94 add integer x to multiset A. ""- x"" \xe2\x80\x94 erase one occurrence of integer x from multiset A. It\'s guaranteed that at least one x is present in the multiset A before this query. ""? x"" \xe2\x80\x94 you are given integer x and need to compute the value , i.e. the maximum value of bitwise exclusive OR (also know as XOR) of integer x and some integer y from the multiset A.Multiset is a set, where equal elements are allowed." 1800
706C "Hard problem" dp,strings "Vasiliy is fond of solving different tasks. Today he found one he wasn\'t able to solve himself, so he asks you to help.Vasiliy is given n strings consisting of lowercase English letters. He wants them to be sorted in lexicographical order (as in the dictionary), but he is not allowed to swap any of them. The only operation he is allowed to do is to reverse any of them (first character becomes last, second becomes one before last and so on).To reverse the i-th string Vasiliy has to spent ci units of energy. He is interested in the minimum amount of energy he has to spent in order to have strings sorted in lexicographical order.String A is lexicographically smaller than string B if it is shorter than B (|A|\xe2\x80\x89<\xe2\x80\x89|B|) and is its prefix, or if none of them is a prefix of the other and at the first position where they differ character in A is smaller than the character in B.For the purpose of this problem, two equal strings nearby do not break the condition of sequence being sorted lexicographically." 1600
706B "Interesting drink" "binary search,dp,implementation" "Vasiliy likes to rest after a hard work, so you may often meet him in some bar nearby. As all programmers do, he loves the famous drink ""Beecola"", which can be bought in n different shops in the city. It\'s known that the price of one bottle in the shop i is equal to xi coins.Vasiliy plans to buy his favorite drink for q consecutive days. He knows, that on the i-th day he will be able to spent mi coins. Now, for each of the days he want to know in how many different shops he can buy a bottle of ""Beecola""." 1100
706A Beru-taxi "brute force,geometry,implementation" "Vasiliy lives at point (a,\xe2\x80\x89b) of the coordinate plane. He is hurrying up to work so he wants to get out of his house as soon as possible. New app suggested n available Beru-taxi nearby. The i-th taxi is located at point (xi,\xe2\x80\x89yi) and moves with a speed vi. Consider that each of n drivers will move directly to Vasiliy and with a maximum possible speed. Compute the minimum time when Vasiliy will get in any of Beru-taxi cars." 900
705B "Spider Man" games,math "Peter Parker wants to play a game with Dr. Octopus. The game is about cycles. Cycle is a sequence of vertices, such that first one is connected with the second, second is connected with third and so on, while the last one is connected with the first one again. Cycle may consist of a single isolated vertex.Initially there are k cycles, i-th of them consisting of exactly vi vertices. Players play alternatively. Peter goes first. On each turn a player must choose a cycle with at least 2 vertices (for example, x vertices) among all available cycles and replace it by two cycles with p and x\xe2\x80\x89-\xe2\x80\x89p vertices where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89p\xe2\x80\x89<\xe2\x80\x89x is chosen by the player. The player who cannot make a move loses the game (and his life!).Peter wants to test some configurations of initial cycle sets before he actually plays with Dr. Octopus. Initially he has an empty set. In the i-th test he adds a cycle with ai vertices to the set (this is actually a multiset because it can contain two or more identical cycles). After each test, Peter wants to know that if the players begin the game with the current set of cycles, who wins? Peter is pretty good at math, but now he asks you to help." 1100
705A Hulk implementation "Dr. Bruce Banner hates his enemies (like others don\'t). As we all know, he can barely talk when he turns into the incredible Hulk. That\'s why he asked you to help him to express his feelings.Hulk likes the Inception so much, and like that his feelings are complicated. They have n layers. The first layer is hate, second one is love, third one is hate and so on...For example if n\xe2\x80\x89=\xe2\x80\x891, then his feeling is ""I hate it"" or if n\xe2\x80\x89=\xe2\x80\x892 it\'s ""I hate that I love it"", and if n\xe2\x80\x89=\xe2\x80\x893 it\'s ""I hate that I love that I hate it"" and so on.Please help Dr. Banner." 800
704E "Iron Man" "data structures,geometry,trees" "Tony Stark is playing a game with his suits (they have auto-pilot now). He lives in Malibu. Malibu has n junctions numbered from 1 to n, connected with n\xe2\x80\x89-\xe2\x80\x891 roads. One can get from a junction to any other junction using these roads (graph of Malibu forms a tree).Tony has m suits. There\'s a special plan for each suit. The i-th suit will appear at the moment of time ti in the junction vi, and will move to junction ui using the shortest path between vi and ui with the speed ci roads per second (passing a junctions takes no time), and vanishing immediately when arriving at ui (if it reaches ui in time q, it\'s available there at moment q, but not in further moments). Also, suits move continuously (for example if vi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89ui, at time  it\'s in the middle of a road. Please note that if vi\xe2\x80\x89=\xe2\x80\x89ui it means the suit will be at junction number vi only at moment ti and then it vanishes. An explosion happens if at any moment of time two suits share the same exact location (it may be in a junction or somewhere on a road; while appearing, vanishing or moving).Your task is to tell Tony the moment of the the first explosion (if there will be any)." 3300
704D "Captain America" flows,greedy "Steve Rogers is fascinated with new vibranium shields S.H.I.E.L.D gave him. They\'re all uncolored. There are n shields in total, the i-th shield is located at point (xi,\xe2\x80\x89yi) of the coordinate plane. It\'s possible that two or more shields share the same location.Steve wants to paint all these shields. He paints each shield in either red or blue. Painting a shield in red costs r dollars while painting it in blue costs b dollars.Additionally, there are m constraints Steve wants to be satisfied. The i-th constraint is provided by three integers ti, li and di:  If ti\xe2\x80\x89=\xe2\x80\x891, then the absolute difference between the number of red and blue shields on line x\xe2\x80\x89=\xe2\x80\x89li should not exceed di.  If ti\xe2\x80\x89=\xe2\x80\x892, then the absolute difference between the number of red and blue shields on line y\xe2\x80\x89=\xe2\x80\x89li should not exceed di. Steve gave you the task of finding the painting that satisfies all the condition and the total cost is minimum." 3100
704C "Black Widow" dp,graphs,implementation,math "Natalia Romanova is trying to test something on the new gun S.H.I.E.L.D gave her. In order to determine the result of the test, she needs to find the number of answers to a certain equation. The equation is of form:Where  represents logical OR and  represents logical exclusive OR (XOR), and vi,\xe2\x80\x89j are some boolean variables or their negations. Natalia calls the left side of the equation a XNF formula. Each statement in brackets is called a clause, and vi,\xe2\x80\x89j are called literals.In the equation Natalia has, the left side is actually a 2-XNF-2 containing variables x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xm and their negations. An XNF formula is 2-XNF-2 if:  For each 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, ki\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892, i.e. the size of each clause doesn\'t exceed two.  Each variable occurs in the formula at most two times (with negation and without negation in total). Please note that it\'s possible that a variable occurs twice but its negation doesn\'t occur in any clause (or vice versa). Natalia is given a formula of m variables, consisting of n clauses. Please, make sure to check the samples in order to properly understand how the formula looks like.Natalia is more into fight than theory, so she asked you to tell her the number of answers to this equation. More precisely, you need to find the number of ways to set x1,\xe2\x80\x89...,\xe2\x80\x89xm with true and false (out of total of 2m ways) so that the equation is satisfied. Since this number can be extremely large, you need to print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897.Please, note that some variable may appear twice in one clause, or not appear in the equation at all (but still, setting it to false or true gives different ways to set variables)." 2900
704B "Ant Man" dp,graphs,greedy "Scott Lang is at war with Darren Cross. There are n chairs in a hall where they are, numbered with 1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n from left to right. The i-th chair is located at coordinate xi. Scott is on chair number s and Cross is on chair number e. Scott can jump to all other chairs (not only neighboring chairs). He wants to start at his position (chair number s), visit each chair exactly once and end up on chair number e with Cross. As we all know, Scott can shrink or grow big (grow big only to his normal size), so at any moment of time he can be either small or large (normal). The thing is, he can only shrink or grow big while being on a chair (not in the air while jumping to another chair). Jumping takes time, but shrinking and growing big takes no time. Jumping from chair number i to chair number j takes |xi\xe2\x80\x89-\xe2\x80\x89xj| seconds. Also, jumping off a chair and landing on a chair takes extra amount of time. If Scott wants to jump to a chair on his left, he can only be small, and if he wants to jump to a chair on his right he should be large.Jumping off the i-th chair takes:  ci extra seconds if he\'s small.  di extra seconds otherwise (he\'s large). Also, landing on i-th chair takes:  bi extra seconds if he\'s small.  ai extra seconds otherwise (he\'s large). In simpler words, jumping from i-th chair to j-th chair takes exactly:  |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89ci\xe2\x80\x89+\xe2\x80\x89bj seconds if j\xe2\x80\x89<\xe2\x80\x89i.  |xi\xe2\x80\x89-\xe2\x80\x89xj|\xe2\x80\x89+\xe2\x80\x89di\xe2\x80\x89+\xe2\x80\x89aj seconds otherwise (j\xe2\x80\x89>\xe2\x80\x89i). Given values of x, a, b, c, d find the minimum time Scott can get to Cross, assuming he wants to visit each chair exactly once." 2500
704A Thor "brute force,data structures,implementation" "Thor is getting used to the Earth. As a gift Loki gave him a smartphone. There are n applications on this phone. Thor is fascinated by this phone. He has only one minor issue: he can\'t count the number of unread notifications generated by those applications (maybe Loki put a curse on it so he can\'t).q events are about to happen (in chronological order). They are of three types:  Application x generates a notification (this new notification is unread).  Thor reads all notifications generated so far by application x (he may re-read some notifications).  Thor reads the first t notifications generated by phone applications (notifications generated in first t events of the first type). It\'s guaranteed that there were at least t events of the first type before this event. Please note that he doesn\'t read first t unread notifications, he just reads the very first t notifications generated on his phone and he may re-read some of them in this operation. Please help Thor and tell him the number of unread notifications after each event. You may assume that initially there are no notifications in the phone." 1600
703E "Mishka and Divisors" "dp,number theory" "After playing with her beautiful array, Mishka decided to learn some math. After learning how to multiply, divide and what is divisibility, she is now interested in solving the following problem.You are given integer k and array a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n integers. You are to find non-empty subsequence of array elements such that the product of its elements is divisible by k and it contains minimum possible number of elements.Formally, you are to find a sequence of indices 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i1\xe2\x80\x89<\xe2\x80\x89i2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89im\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n such that  is divisible by k while m is minimum possible among all such variants.If there are more than one such subsequences, you should choose one among them, such that sum of its elements is minimum possible.Mishka quickly solved this problem. Will you do so?" 2600
703D "Mishka and Interesting sum" "data structures" "Little Mishka enjoys programming. Since her birthday has just passed, her friends decided to present her with array of non-negative integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n elements!Mishka loved the array and she instantly decided to determine its beauty value, but she is too little and can\'t process large arrays. Right because of that she invited you to visit her and asked you to process m queries.Each query is processed in the following way:  Two integers l and r (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) are specified \xe2\x80\x94 bounds of query segment.  Integers, presented in array segment [l,\xe2\x80\x89\xe2\x80\x89r] (in sequence of integers al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar) even number of times, are written down.  XOR-sum of written down integers is calculated, and this value is the answer for a query. Formally, if integers written down in point 2 are x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xk, then Mishka wants to know the value , where  \xe2\x80\x94 operator of exclusive bitwise OR. Since only the little bears know the definition of array beauty, all you are to do is to answer each of queries presented." 2100
703C "Chris and Road" geometry,implementation "And while Mishka is enjoying her trip...Chris is a little brown bear. No one knows, where and when he met Mishka, but for a long time they are together (excluding her current trip). However, best friends are important too. John is Chris\' best friend.Once walking with his friend, John gave Chris the following problem:At the infinite horizontal road of width w, bounded by lines y\xe2\x80\x89=\xe2\x80\x890 and y\xe2\x80\x89=\xe2\x80\x89w, there is a bus moving, presented as a convex polygon of n vertices. The bus moves continuously with a constant speed of v in a straight Ox line in direction of decreasing x coordinates, thus in time only x coordinates of its points are changing. Formally, after time t each of x coordinates of its points will be decreased by vt.There is a pedestrian in the point (0,\xe2\x80\x890), who can move only by a vertical pedestrian crossing, presented as a segment connecting points (0,\xe2\x80\x890) and (0,\xe2\x80\x89w) with any speed not exceeding u. Thus the pedestrian can move only in a straight line Oy in any direction with any speed not exceeding u and not leaving the road borders. The pedestrian can instantly change his speed, thus, for example, he can stop instantly.Please look at the sample note picture for better understanding.We consider the pedestrian is hit by the bus, if at any moment the point he is located in lies strictly inside the bus polygon (this means that if the point lies on the polygon vertex or on its edge, the pedestrian is not hit by the bus).You are given the bus position at the moment 0. Please help Chris determine minimum amount of time the pedestrian needs to cross the road and reach the point (0,\xe2\x80\x89w) and not to be hit by the bus." 2100
703B "Mishka and trip" implementation,math "Little Mishka is a great traveller and she visited many countries. After thinking about where to travel this time, she chose XXX \xe2\x80\x94 beautiful, but little-known northern country.Here are some interesting facts about XXX:  XXX consists of n cities, k of whose (just imagine!) are capital cities.  All of cities in the country are beautiful, but each is beautiful in its own way. Beauty value of i-th city equals to ci.  All the cities are consecutively connected by the roads, including 1-st and n-th city, forming a cyclic route 1\xe2\x80\x89\xe2\x80\x94\xe2\x80\x892\xe2\x80\x89\xe2\x80\x94\xe2\x80\x89...\xe2\x80\x89\xe2\x80\x94\xe2\x80\x89n\xe2\x80\x89\xe2\x80\x94\xe2\x80\x891. Formally, for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n there is a road between i-th and i\xe2\x80\x89+\xe2\x80\x891-th city, and another one between 1-st and n-th city.  Each capital city is connected with each other city directly by the roads. Formally, if city x is a capital city, then for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n,\xe2\x80\x89\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89x, there is a road between cities x and i.  There is at most one road between any two cities.  Price of passing a road directly depends on beauty values of cities it connects. Thus if there is a road between cities i and j, price of passing it equals ci\xc2\xb7cj.Mishka started to gather her things for a trip, but didn\'t still decide which route to follow and thus she asked you to help her determine summary price of passing each of the roads in XXX. Formally, for every pair of cities a and b (a\xe2\x80\x89<\xe2\x80\x89b), such that there is a road between a and b you are to find sum of products ca\xc2\xb7cb. Will you help her?" 1400
703A "Mishka and Game" implementation "Mishka is a little polar bear. As known, little bears loves spending their free time playing dice for chocolates. Once in a wonderful sunny morning, walking around blocks of ice, Mishka met her friend Chris, and they started playing the game.Rules of the game are very simple: at first number of rounds n is defined. In every round each of the players throws a cubical dice with distinct numbers from 1 to 6 written on its faces. Player, whose value after throwing the dice is greater, wins the round. In case if player dice values are equal, no one of them is a winner.In average, player, who won most of the rounds, is the winner of the game. In case if two players won the same number of rounds, the result of the game is draw.Mishka is still very little and can\'t count wins and losses, so she asked you to watch their game and determine its result. Please help her!" 800
702F T-Shirts "data structures" "The big consignment of t-shirts goes on sale in the shop before the beginning of the spring. In all n types of t-shirts go on sale. The t-shirt of the i-th type has two integer parameters \xe2\x80\x94 ci and qi, where ci \xe2\x80\x94 is the price of the i-th type t-shirt, qi \xe2\x80\x94 is the quality of the i-th type t-shirt. It should be assumed that the unlimited number of t-shirts of each type goes on sale in the shop, but in general the quality is not concerned with the price. As predicted, k customers will come to the shop within the next month, the j-th customer will get ready to spend up to bj on buying t-shirts. All customers have the same strategy. First of all, the customer wants to buy the maximum possible number of the highest quality t-shirts, then to buy the maximum possible number of the highest quality t-shirts from residuary t-shirts and so on. At the same time among several same quality t-shirts the customer will buy one that is cheaper. The customers don\'t like the same t-shirts, so each customer will not buy more than one t-shirt of one type. Determine the number of t-shirts which each customer will buy, if they use the described strategy. All customers act independently from each other, and the purchase of one does not affect the purchase of another." 2800
702E "Analysis of Pathes in Functional Graph" "data structures,graphs" "You are given a functional graph. It is a directed graph, in which from each vertex goes exactly one arc. The vertices are numerated from 0 to n\xe2\x80\x89-\xe2\x80\x891.Graph is given as the array f0,\xe2\x80\x89f1,\xe2\x80\x89...,\xe2\x80\x89fn\xe2\x80\x89-\xe2\x80\x891, where fi \xe2\x80\x94 the number of vertex to which goes the only arc from the vertex i. Besides you are given array with weights of the arcs w0,\xe2\x80\x89w1,\xe2\x80\x89...,\xe2\x80\x89wn\xe2\x80\x89-\xe2\x80\x891, where wi \xe2\x80\x94 the arc weight from i to fi.  The graph from the first sample test. Also you are given the integer k (the length of the path) and you need to find for each vertex two numbers si and mi, where:  si \xe2\x80\x94 the sum of the weights of all arcs of the path with length equals to k which starts from the vertex i;  mi \xe2\x80\x94 the minimal weight from all arcs on the path with length k which starts from the vertex i. The length of the path is the number of arcs on this path." 2100
702D "Road to Post Office" math "Vasiliy has a car and he wants to get from home to the post office. The distance which he needs to pass equals to d kilometers.Vasiliy\'s car is not new \xe2\x80\x94 it breaks after driven every k kilometers and Vasiliy needs t seconds to repair it. After repairing his car Vasiliy can drive again (but after k kilometers it will break again, and so on). In the beginning of the trip the car is just from repair station.To drive one kilometer on car Vasiliy spends a seconds, to walk one kilometer on foot he needs b seconds (a\xe2\x80\x89<\xe2\x80\x89b).Your task is to find minimal time after which Vasiliy will be able to reach the post office. Consider that in every moment of time Vasiliy can left his car and start to go on foot." 1900
702C "Cellular Network" "binary search,implementation,two pointers" "You are given n points on the straight line \xe2\x80\x94 the positions (x-coordinates) of the cities and m points on the same line \xe2\x80\x94 the positions (x-coordinates) of the cellular towers. All towers work in the same way \xe2\x80\x94 they provide cellular network for all cities, which are located at the distance which is no more than r from this tower.Your task is to find minimal r that each city has been provided by cellular network, i.e. for each city there is at least one cellular tower at the distance which is no more than r.If r\xe2\x80\x89=\xe2\x80\x890 then a tower provides cellular network only for the point where it is located. One tower can provide cellular network for any number of cities, but all these cities must be at the distance which is no more than r from this tower." 1500
702B "Powers of Two" "brute force,data structures,implementation,math" "You are given n integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. Find the number of pairs of indexes i,\xe2\x80\x89j (i\xe2\x80\x89<\xe2\x80\x89j) that ai\xe2\x80\x89+\xe2\x80\x89aj is a power of 2 (i. e. some integer x exists so that ai\xe2\x80\x89+\xe2\x80\x89aj\xe2\x80\x89=\xe2\x80\x892x)." 1500
702A "Maximum Increase" dp,greedy,implementation "You are given array consisting of n integers. Your task is to find the maximum length of an increasing subarray of the given array.A subarray is the sequence of consecutive elements of the array. Subarray is called increasing if each element of this subarray strictly greater than previous." 800
701C "They Are Everywhere" "binary search,strings,two pointers" "Sergei B., the young coach of Pokemons, has found the big house which consists of n flats ordered in a row from left to right. It is possible to enter each flat from the street. It is possible to go out from each flat. Also, each flat is connected with the flat to the left and the flat to the right. Flat number 1 is only connected with the flat number 2 and the flat number n is only connected with the flat number n\xe2\x80\x89-\xe2\x80\x891.There is exactly one Pokemon of some type in each of these flats. Sergei B. asked residents of the house to let him enter their flats in order to catch Pokemons. After consulting the residents of the house decided to let Sergei B. enter one flat from the street, visit several flats and then go out from some flat. But they won\'t let him visit the same flat more than once. Sergei B. was very pleased, and now he wants to visit as few flats as possible in order to collect Pokemons of all types that appear in this house. Your task is to help him and determine this minimum number of flats he has to visit." 1500
701B "Cells Not Under Attack" "data structures,math" "Vasya has the square chessboard of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n and m rooks. Initially the chessboard is empty. Vasya will consequently put the rooks on the board one after another.The cell of the field is under rook\'s attack, if there is at least one rook located in the same row or in the same column with this cell. If there is a rook located in the cell, this cell is also under attack.You are given the positions of the board where Vasya will put rooks. For each rook you have to determine the number of cells which are not under attack after Vasya puts it on the board." 1200
701A Cards greedy,implementation "There are n cards (n is even) in the deck. Each card has a positive integer written on it. n\xe2\x80\x89/\xe2\x80\x892 people will play new card game. At the beginning of the game each player gets two cards, each card is given to exactly one player. Find the way to distribute cards such that the sum of values written of the cards will be equal for each player. It is guaranteed that it is always possible." 800
700E "Cool Slogans" "string suffix structures,strings" "Bomboslav set up a branding agency and now helps companies to create new logos and advertising slogans. In term of this problems, slogan of the company should be a non-empty substring of its name. For example, if the company name is ""hornsandhoofs"", then substrings ""sand"" and ""hor"" could be its slogans, while strings ""e"" and ""hornss"" can not.Sometimes the company performs rebranding and changes its slogan. Slogan A is considered to be cooler than slogan B if B appears in A as a substring at least twice (this occurrences are allowed to overlap). For example, slogan A\xe2\x80\x89=\xe2\x80\x89 ""abacaba"" is cooler than slogan B\xe2\x80\x89=\xe2\x80\x89 ""ba"", slogan A\xe2\x80\x89=\xe2\x80\x89 ""abcbcbe"" is cooler than slogan B\xe2\x80\x89=\xe2\x80\x89 ""bcb"", but slogan A\xe2\x80\x89=\xe2\x80\x89 ""aaaaaa"" is not cooler than slogan B\xe2\x80\x89=\xe2\x80\x89 ""aba"".You are given the company name w and your task is to help Bomboslav determine the length of the longest sequence of slogans s1,\xe2\x80\x89s2,\xe2\x80\x89...,\xe2\x80\x89sk, such that any slogan in the sequence is cooler than the previous one." 3300
700D "Huffman Coding on Segment" "data structures,greedy" "Alice wants to send an important message to Bob. Message a\xe2\x80\x89=\xe2\x80\x89(a1,\xe2\x80\x89...,\xe2\x80\x89an) is a sequence of positive integers (characters).To compress the message Alice wants to use binary Huffman coding. We recall that binary Huffman code, or binary prefix code is a function f, that maps each letter that appears in the string to some binary string (that is, string consisting of characters \'0\' and \'1\' only) such that for each pair of different characters ai and aj string f(ai) is not a prefix of f(aj) (and vice versa). The result of the encoding of the message a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an is the concatenation of the encoding of each character, that is the string f(a1)f(a2)... f(an). Huffman codes are very useful, as the compressed message can be easily and uniquely decompressed, if the function f is given. Code is usually chosen in order to minimize the total length of the compressed message, i.e. the length of the string f(a1)f(a2)... f(an).Because of security issues Alice doesn\'t want to send the whole message. Instead, she picks some substrings of the message and wants to send them separately. For each of the given substrings ali... ari she wants to know the minimum possible length of the Huffman coding. Help her solve this problem." 3100
700C "Break Up" "dfs and similar,graphs" "Again, there are hard times in Berland! Many towns have such tensions that even civil war is possible. There are n towns in Reberland, some pairs of which connected by two-way roads. It is not guaranteed that it is possible to reach one town from any other town using these roads. Towns s and t announce the final break of any relationship and intend to rule out the possibility of moving between them by the roads. Now possibly it is needed to close several roads so that moving from s to t using roads becomes impossible. Each town agrees to spend money on closing no more than one road, therefore, the total number of closed roads will be no more than two.Help them find set of no more than two roads such that there will be no way between s and t after closing these roads. For each road the budget required for its closure was estimated. Among all sets find such that the total budget for the closure of a set of roads is minimum." 2600
700B "Connecting Universities" "dfs and similar,dp,graphs,trees" "Treeland is a country in which there are n towns connected by n\xe2\x80\x89-\xe2\x80\x891 two-way road such that it\'s possible to get from any town to any other town. In Treeland there are 2k universities which are located in different towns. Recently, the president signed the decree to connect universities by high-speed network.The Ministry of Education understood the decree in its own way and decided that it was enough to connect each university with another one by using a cable. Formally, the decree will be done! To have the maximum sum in the budget, the Ministry decided to divide universities into pairs so that the total length of the required cable will be maximum. In other words, the total distance between universities in k pairs should be as large as possible. Help the Ministry to find the maximum total distance. Of course, each university should be present in only one pair. Consider that all roads have the same length which is equal to 1." 1800
700A "As Fast As Possible" "binary search,math" "On vacations n pupils decided to go on excursion and gather all together. They need to overcome the path with the length l meters. Each of the pupils will go with the speed equal to v1. To get to the excursion quickly, it was decided to rent a bus, which has seats for k people (it means that it can\'t fit more than k people at the same time) and the speed equal to v2. In order to avoid seasick, each of the pupils want to get into the bus no more than once.Determine the minimum time required for all n pupils to reach the place of excursion. Consider that the embarkation and disembarkation of passengers, as well as the reversal of the bus, take place immediately and this time can be neglected." 1900
699B "One Bomb" implementation "You are given a description of a depot. It is a rectangular checkered field of n\xe2\x80\x89\xc3\x97\xe2\x80\x89m size. Each cell in a field can be empty (""."") or it can be occupied by a wall (""*""). You have one bomb. If you lay the bomb at the cell (x,\xe2\x80\x89y), then after triggering it will wipe out all walls in the row x and all walls in the column y.You are to determine if it is possible to wipe out all walls in the depot by placing and triggering exactly one bomb. The bomb can be laid both in an empty cell or in a cell occupied by a wall." 1400
699A "Launch of Collider" implementation "There will be a launch of a new, powerful and unusual collider very soon, which located along a straight line. n particles will be launched inside it. All of them are located in a straight line and there can not be two or more particles located in the same point. The coordinates of the particles coincide with the distance in meters from the center of the collider, xi is the coordinate of the i-th particle and its position in the collider at the same time. All coordinates of particle positions are even integers.You know the direction of each particle movement \xe2\x80\x94 it will move to the right or to the left after the collider\'s launch start. All particles begin to move simultaneously at the time of the collider\'s launch start. Each particle will move straight to the left or straight to the right with the constant speed of 1 meter per microsecond. The collider is big enough so particles can not leave it in the foreseeable time.Write the program which finds the moment of the first collision of any two particles of the collider. In other words, find the number of microseconds before the first moment when any two particles are at the same point." 1000
698F "Coprime Permutation" "combinatorics,number theory" "Two positive integers are coprime if and only if they don\'t have a common divisor greater than 1.Some bear doesn\'t want to tell Radewoosh how to solve some algorithmic problem. So, Radewoosh is going to break into that bear\'s safe with solutions. To pass through the door, he must enter a permutation of numbers 1 through n. The door opens if and only if an entered permutation p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn satisfies:In other words, two different elements are coprime if and only if their indices are coprime. Some elements of a permutation may be already fixed. In how many ways can Radewoosh fill the remaining gaps so that the door will open? Print the answer modulo 109\xe2\x80\x89+\xe2\x80\x897." 3000
698E Cron NA "Sometime the classic solution are not powerful enough and we have to design our own. For the purpose of this problem you have to implement the part of the system of task scheduling.Each task should be executed at some particular moments of time. In our system you may set the exact value for the second, minute, hour, day of the week, day and month, when the task should be executed. Moreover, one can set a special value -1 that means any value of this parameter is valid.For example, if the parameter string is -1 59 23 -1 -1 -1, the problem will be executed every day at 23:59:00, 23:59:01, 23:59:02, ..., 23:59:59 (60 times in total).Seconds, minutes and hours are numbered starting from zero, while day, months and days of the week are numbered starting from one. The first day of the week is Monday.There is one special case that is treated separately. If both day of the week and day are given (i.e. differ from -1) to execute the task only one of these two (at least one, if both match this is fine too) parameters should match the current time (of course, all other parameters should match too). For example, the string of parameters 0 0 12 6 3 7 means that the task will be executed both on Saturday, July 2nd, 2016 and on Sunday, July 3rd, 2016 at noon.One should not forget about the existence of the leap years. The year is leap if it\'s number is divisible by 400, or is not divisible by 100, but is divisible by 4. Each leap year has 366 days instead of usual 365, by extending February to 29 days rather than the common 28.The current time is represented as the number of seconds passed after 00:00:00 January 1st, 1970 (Thursday).You are given the string of six parameters, describing the moments of time the task should be executed. You are also given a number of moments of time. For each of them you have to find the first moment of time strictly greater than the current when the task will be executed." 2800
698D "Limak and Shooting Points" "brute force,geometry,math" "Bearland is a dangerous place. Limak can\xe2\x80\x99t travel on foot. Instead, he has k magic teleportation stones. Each stone can be used at most once. The i-th stone allows to teleport to a point (axi,\xe2\x80\x89ayi). Limak can use stones in any order.There are n monsters in Bearland. The i-th of them stands at (mxi,\xe2\x80\x89myi).The given k\xe2\x80\x89+\xe2\x80\x89n points are pairwise distinct.After each teleportation, Limak can shoot an arrow in some direction. An arrow will hit the first monster in the chosen direction. Then, both an arrow and a monster disappear. It\xe2\x80\x99s dangerous to stay in one place for long, so Limak can shoot only one arrow from one place.A monster should be afraid if it\xe2\x80\x99s possible that Limak will hit it. How many monsters should be afraid of Limak?" 2600
698C LRU bitmasks,dp,math,probabilities "While creating high loaded systems one should pay a special attention to caching. This problem will be about one of the most popular caching algorithms called LRU (Least Recently Used).Suppose the cache may store no more than k objects. At the beginning of the workflow the cache is empty. When some object is queried we check if it is present in the cache and move it here if it\'s not. If there are more than k objects in the cache after this, the least recently used one should be removed. In other words, we remove the object that has the smallest time of the last query.Consider there are n videos being stored on the server, all of the same size. Cache can store no more than k videos and caching algorithm described above is applied. We know that any time a user enters the server he pick the video i with probability pi. The choice of the video is independent to any events before.The goal of this problem is to count for each of the videos the probability it will be present in the cache after 10100 queries." 2400
698B "Fix a Tree" "constructive algorithms,dfs and similar,dsu,graphs,trees" "A tree is an undirected connected graph without cycles.Let\'s consider a rooted undirected tree with n vertices, numbered 1 through n. There are many ways to represent such a tree. One way is to create an array with n integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, where pi denotes a parent of vertex i (here, for convenience a root is considered its own parent).  For this rooted tree the array p is [2,\xe2\x80\x893,\xe2\x80\x893,\xe2\x80\x892]. Given a sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn, one is able to restore a tree:  There must be exactly one index r that pr\xe2\x80\x89=\xe2\x80\x89r. A vertex r is a root of the tree.  For all other n\xe2\x80\x89-\xe2\x80\x891 vertices i, there is an edge between vertex i and vertex pi. A sequence p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn is called valid if the described procedure generates some (any) rooted tree. For example, for n\xe2\x80\x89=\xe2\x80\x893 sequences (1,2,2), (2,3,1) and (2,1,3) are not valid.You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, not necessarily valid. Your task is to change the minimum number of elements, in order to get a valid sequence. Print the minimum number of changes and an example of a valid sequence after that number of changes. If there are many valid sequences achievable in the minimum number of changes, print any of them." 1700
698A Vacations dp "Vasya has n days of vacations! So he decided to improve his IT skills and do sport. Vasya knows the following information about each of this n days: whether that gym opened and whether a contest was carried out in the Internet on that day. For the i-th day there are four options:  on this day the gym is closed and the contest is not carried out;  on this day the gym is closed and the contest is carried out;  on this day the gym is open and the contest is not carried out;  on this day the gym is open and the contest is carried out. On each of days Vasya can either have a rest or write the contest (if it is carried out on this day), or do sport (if the gym is open on this day).Find the minimum number of days on which Vasya will have a rest (it means, he will not do sport and write the contest at the same time). The only limitation that Vasya has \xe2\x80\x94 he does not want to do the same activity on two consecutive days: it means, he will not do sport on two consecutive days, and write the contest on two consecutive days." 1400
697B Barnicle "brute force,implementation,math,strings" "Barney is standing in a bar and starring at a pretty girl. He wants to shoot her with his heart arrow but he needs to know the distance between him and the girl to make his shot accurate.  Barney asked the bar tender Carl about this distance value, but Carl was so busy talking to the customers so he wrote the distance value (it\'s a real number) on a napkin. The problem is that he wrote it in scientific notation. The scientific notation of some real number x is the notation of form AeB, where A is a real number and B is an integer and x\xe2\x80\x89=\xe2\x80\x89A\xe2\x80\x89\xc3\x97\xe2\x80\x8910B is true. In our case A is between 0 and 9 and B is non-negative.Barney doesn\'t know anything about scientific notation (as well as anything scientific at all). So he asked you to tell him the distance value in usual decimal representation with minimal number of digits after the decimal point (and no decimal point if it is an integer). See the output format for better understanding." 1400
697A "Pineapple Incident" implementation,math "Ted has a pineapple. This pineapple is able to bark like a bulldog! At time t (in seconds) it barks for the first time. Then every s seconds after it, it barks twice with 1 second interval. Thus it barks at times t, t\xe2\x80\x89+\xe2\x80\x89s, t\xe2\x80\x89+\xe2\x80\x89s\xe2\x80\x89+\xe2\x80\x891, t\xe2\x80\x89+\xe2\x80\x892s, t\xe2\x80\x89+\xe2\x80\x892s\xe2\x80\x89+\xe2\x80\x891, etc.  Barney woke up in the morning and wants to eat the pineapple, but he can\'t eat it when it\'s barking. Barney plans to eat it at time x (in seconds), so he asked you to tell him if it\'s gonna bark at that time." 900
696F ...Dary! "binary search,geometry,two pointers" "Barney has finally found the one, a beautiful young lady named Lyanna. The problem is, Lyanna and Barney are trapped in Lord Loss\' castle. This castle has shape of a convex polygon of n points. Like most of castles in Demonata worlds, this castle has no ceiling.  Barney and Lyanna have an escape plan, but it requires some geometry knowledge, so they asked for your help.Barney knows that demons are organized and move in lines. He and Lyanna want to wait for the appropriate time so they need to watch for the demons. Each of them wants to stay in a point inside the castle (possibly on edges or corners), also they may stay in the same position. They both want to pick a real number r and watch all points in the circles with radius r around each of them (these two circles may overlap).  We say that Barney and Lyanna are watching carefully if and only if for every edge of the polygon, at least one of them can see at least one point on the line this edge lies on, thus such point may not be on the edge but it should be on edge\'s line. Formally, each edge line should have at least one common point with at least one of two circles.The greater r is, the more energy and focus they need. So they asked you to tell them the minimum value of r such that they can watch carefully." 3300
696E "...Wait for it..." "data structures,dsu,trees" "Barney is searching for his dream girl. He lives in NYC. NYC has n junctions numbered from 1 to n and n\xe2\x80\x89-\xe2\x80\x891 roads connecting them. We will consider the NYC as a rooted tree with root being junction 1. m girls live in NYC, i-th of them lives along junction ci and her weight initially equals i pounds.  Barney consider a girl x to be better than a girl y if and only if: girl x has weight strictly less than girl y or girl x and girl y have equal weights and index of girl x living junction index is strictly less than girl y living junction index, i.e. cx\xe2\x80\x89<\xe2\x80\x89cy. Thus for any two girls one of them is always better than another one.For the next q days, one event happens each day. There are two types of events:  Barney goes from junction v to junction u. As a result he picks at most k best girls he still have not invited from junctions on his way and invites them to his house to test if one of them is his dream girl. If there are less than k not invited girls on his path, he invites all of them. Girls living along junctions in subtree of junction v (including v itself) put on some weight. As result, their weights increase by k pounds. Your task is for each event of first type tell Barney the indices of girls he will invite to his home in this event." 3000
696D Legen... "data structures,dp,matrices,strings" "Barney was hanging out with Nora for a while and now he thinks he may have feelings for her. Barney wants to send her a cheesy text message and wants to make her as happy as possible.  Initially, happiness level of Nora is 0. Nora loves some pickup lines like ""I\'m falling for you"" and stuff. Totally, she knows n pickup lines, each consisting only of lowercase English letters, also some of them may be equal (in writing, but different in pronouncing or meaning though). Every time Nora sees i-th pickup line as a consecutive subsequence of Barney\'s text message her happiness level increases by ai. These substrings may overlap, for example, Nora will see the pickup line aa twice and the pickup line ab once in text message aaab.Due to texting app limits, Barney\'s text may have up to l characters.Barney asked you to help him make Nora as much happy as possible, it\'s gonna be legen..." 2500
