1725H "Hot Black Hot White" "constructive algorithms,math" "One day, you are accepted as being Dr. Chanek\'s assistant. The first task given by Dr. Chanek to you is to take care and store his magical stones.Dr. Chanek has N magical stones with N being an even number. Those magical stones are numbered from 1 to N. Magical stone i has a strength of Ai. A magical stone can be painted with two colours, namely the colour black or the colour white. You are tasked to paint the magical stones with the colour black or white and store the magical stones into a magic box with a magic coefficient Z (0\xe2\x89\xa4Z\xe2\x89\xa42). The painting of the magical stones must be done in a way such that there are N2 black magical stones and N2 white magical stones.Define concat(x,y) for two integers x and y as the result of concatenating the digits of x to the left of y in their decimal representation without changing the order. As an example, concat(10,24) will result in 1024.For a magic box with a magic coefficient Z, magical stone i will react with magical stone j if the colours of both stones are different and concat(Ai,Aj)\xc3\x97concat(Aj,Ai)+Ai\xc3\x97Aj\xe2\x89\xa1Zmod3. A magical stone that is reacting will be very hot and dangerous. Because of that, you must colour the magical stones and determine the magic coefficient Z of the magic box in a way such that there is no magical stone that reacts, or report if it is impossible." 1800
1725G Garage "binary search,geometry,math" "Pak Chanek plans to build a garage. He wants the garage to consist of a square and a right triangle that are arranged like the following illustration.  Define a and b as the lengths of two of the sides in the right triangle as shown in the illustration. An integer x is suitable if and only if we can construct a garage with assigning positive integer values for the lengths a and b (a<b) so that the area of the square at the bottom is exactly x. As a good friend of Pak Chanek, you are asked to help him find the N-th smallest suitable number." 1500
1725F "Field Photography" "bitmasks,data structures,sortings" "Pak Chanek is traveling to Manado. It turns out that OSN (Indonesian National Scientific Olympiad) 2019 is being held. The contestants of OSN 2019 are currently lining up in a field to be photographed. The field is shaped like a grid of size N\xc3\x9710100 with N rows and 10100 columns. The rows are numbered from 1 to N from north to south, the columns are numbered from 1 to 10100 from west to east. The tile in row r and column c is denoted as (r,c).There are N provinces that participate in OSN 2019. Initially, each contestant who represents province i stands in tile (i,p) for each p satisfying Li\xe2\x89\xa4p\xe2\x89\xa4Ri. So, we can see that there are Ri\xe2\x88\x92Li+1 contestants who represent province i.Pak Chanek has a variable Z that is initially equal to 0. In one operation, Pak Chanek can choose a row i and a positive integer k. Then, Pak Chanek will do one of the two following possibilities:   Move all contestants in row i exactly k tiles to the west. In other words, a contestant who is in (i,p) is moved to (i,p\xe2\x88\x92k).  Move all contestants in row i exactly k tiles to the east. In other words, a contestant who is in (i,p) is moved to (i,p+k). After each operation, the value of Z will change into Z OR k, with OR being the bitwise OR operation. Note that Pak Chanek can do operations to the same row more than once. Also note that Pak Chanek is not allowed to move contestants out of the grid.There are Q questions. For the j-th question, you are given a positive integer Wj, Pak Chanek must do zero or more operations so that the final value of Z is exactly Wj. Define M as the biggest number such that after all operations, there is at least one column that contains exactly M contestants. For each question, you must find the biggest possible M for all sequences of operations that can be done by Pak Chanek. Note that the operations done by Pak Chanek for one question do not carry over to other questions." 2100
1725E "Electrical Efficiency" "combinatorics,data structures,dp,math,number theory,trees" "In the country of Dengkleknesia, there are N factories numbered from 1 to N. Factory i has an electrical coefficient of Ai. There are also N\xe2\x88\x921 power lines with the j-th power line connecting factory Uj and factory Vj. It can be guaranteed that each factory in Dengkleknesia is connected to all other factories in Dengkleknesia through one or more power lines. In other words, the collection of factories forms a tree. Each pair of different factories in Dengkleknesia can use one or more existing power lines to transfer electricity to each other. However, each power line needs to be turned on first so that electricity can pass through it.Define f(x,y,z) as the minimum number of power lines that need to be turned on so that factory x can make electrical transfers to factory y and factory z. Also define g(x,y,z) as the number of distinct prime factors of GCD(Ax,Ay,Az).To measure the electrical efficiency, you must find the sum of f(x,y,z)\xc3\x97g(x,y,z) for all combinations of (x,y,z) such that 1\xe2\x89\xa4x<y<z\xe2\x89\xa4N. Because the answer can be very large, you just need to output the answer modulo 998244353.Note: GCD(k1,k2,k3) is the greatest common divisor of k1, k2, and k3, which is the biggest integer that simultaneously divides k1, k2, and k3." 2500
1725D "Deducing Sortability" "binary search,bitmasks,math" "Let\'s say Pak Chanek has an array A consisting of N positive integers. Pak Chanek will do a number of operations. In each operation, Pak Chanek will do the following:   Choose an index p (1\xe2\x89\xa4p\xe2\x89\xa4N).  Let c be the number of operations that have been done on index p before this operation.  Decrease the value of Ap by 2c.  Multiply the value of Ap by 2. After each operation, all elements of A must be positive integers.An array A is said to be sortable if and only if Pak Chanek can do zero or more operations so that A1<A2<A3<A4<\xe2\x80\xa6<AN.Pak Chanek must find an array A that is sortable with length N such that A1+A2+A3+A4+\xe2\x80\xa6+AN is the minimum possible. If there are more than one possibilities, Pak Chanek must choose the array that is lexicographically minimum among them.Pak Chanek must solve the following things:   Pak Chanek must print the value of A1+A2+A3+A4+\xe2\x80\xa6+AN for that array.  Q questions will be given. For the i-th question, an integer Pi is given. Pak Chanek must print the value of APi. Help Pak Chanek solve the problem.Note: an array B of size N is said to be lexicographically smaller than an array C that is also of size N if and only if there exists an index i such that Bi<Ci and for each j<i, Bj=Cj." 2900
1725C "Circular Mirror" "binary search,combinatorics,geometry,math,two pointers" "Pak Chanek has a mirror in the shape of a circle. There are N lamps on the circumference numbered from 1 to N in clockwise order. The length of the arc from lamp i to lamp i+1 is Di for 1\xe2\x89\xa4i\xe2\x89\xa4N\xe2\x88\x921. Meanwhile, the length of the arc between lamp N and lamp 1 is DN.Pak Chanek wants to colour the lamps with M different colours. Each lamp can be coloured with one of the M colours. However, there cannot be three different lamps such that the colours of the three lamps are the same and the triangle made by considering the three lamps as vertices is a right triangle (triangle with one of its angles being exactly 90 degrees).The following are examples of lamp colouring configurations on the circular mirror. Figure 1. an example of an incorrect colouring because lamps 1, 2, and 3 form a right triangleFigure 2. an example of a correct colouringFigure 3. an example of a correct colouring Before colouring the lamps, Pak Chanek wants to know the number of distinct colouring configurations he can make. Count the number of distinct possible lamp colouring configurations, modulo 998244353." 2000
1725B "Basketball Together" "binary search,greedy,sortings" "A basketball competition is held where the number of players in a team does not have a maximum or minimum limit (not necessarily 5 players in one team for each match). There are N candidate players in the competition that will be trained by Pak Chanek, the best basketball coach on earth. The i-th candidate player has a power of Pi.Pak Chanek will form zero or more teams from the N candidate players on the condition that each candidate player may only join in at most one team. Each of Pak Chanek\'s teams will be sent to compete once with an enemy team that has a power of D. In each match, the team sent is said to defeat the enemy team if the sum of powers from the formed players is strictly greater than D.One of Pak Chanek\'s skills is that when a team that has been formed plays in a match, he can change the power of each player in the team to be equal to the biggest player power from the team.Determine the maximum number of wins that can be achieved by Pak Chanek." 1000
1725A "Accumulation of Dominoes" math "Pak Chanek has a grid that has N rows and M columns. Each row is numbered from 1 to N from top to bottom. Each column is numbered from 1 to M from left to right.Each tile in the grid contains a number. The numbers are arranged as follows:   Row 1 contains integers from 1 to M from left to right.  Row 2 contains integers from M+1 to 2\xc3\x97M from left to right.  Row 3 contains integers from 2\xc3\x97M+1 to 3\xc3\x97M from left to right.  And so on until row N. A domino is defined as two different tiles in the grid that touch by their sides. A domino is said to be tight if and only if the two numbers in the domino have a difference of exactly 1. Count the number of distinct tight dominoes in the grid.Two dominoes are said to be distinct if and only if there exists at least one tile that is in one domino, but not in the other." 800
1722G "Even-Odd XOR" "bitmasks,constructive algorithms,greedy" "Given an integer n, find any array a of n distinct nonnegative integers less than 231 such that the bitwise XOR of the elements on odd indices equals the bitwise XOR of the elements on even indices." 1500
1722F L-shapes "dfs and similar,implementation" "An L-shape is a figure on gridded paper that looks like the first four pictures below. An L-shape contains exactly three shaded cells (denoted by *), which can be rotated in any way.  You are given a rectangular grid. Determine if it contains L-shapes only, where L-shapes can\'t touch an edge or corner. More formally:   Each shaded cell in the grid is part of exactly one L-shape, and  no two L-shapes are adjacent by edge or corner. For example, the last two grids in the picture above do not satisfy the condition because the two L-shapes touch by corner and edge, respectively." 1700
1722E "Counting Rectangles" "brute force,data structures,dp,implementation" "You have n rectangles, the i-th rectangle has height hi and width wi.You are asked q queries of the form hs ws hb wb. For each query output, the total area of rectangles you own that can fit a rectangle of height hs and width ws while also fitting in a rectangle of height hb and width wb. In other words, print \xe2\x88\x91hi\xe2\x8b\x85wi for i such that hs<hi<hb and ws<wi<wb. Please note, that if two rectangles have the same height or the same width, then they cannot fit inside each other. Also note that you cannot rotate rectangles.Please note that the answer for some test cases won\'t fit into 32-bit integer type, so you should use at least 64-bit integer type in your programming language (like long long for C++)." 1600
1722D Line greedy,sortings "There are n people in a horizontal line, each looking either to the left or the right. Each person counts the number of people in the direction they are looking. The value of the line is the sum of each person\'s count.For example, in the arrangement LRRLL, where L stands for a person looking left and R stands for a person looking right, the counts for each person are [0,3,2,3,4], and the value is 0+3+2+3+4=12.You are given the initial arrangement of people in the line. For each k from 1 to n, determine the maximum value of the line if you can change the direction of at most k people." 1100
1722C "Word Game" "data structures,implementation" "Three guys play a game: first, each person writes down n distinct words of length 3. Then, they total up the number of points as follows:   if a word was written by one person \xe2\x80\x94 that person gets 3 points,  if a word was written by two people \xe2\x80\x94 each of the two gets 1 point,  if a word was written by all \xe2\x80\x94 nobody gets any points.  In the end, how many points does each player have?" 800
1722B Colourblindness implementation "Vasya has a grid with 2 rows and n columns. He colours each cell red, green, or blue.Vasya is colourblind and can\'t distinguish green from blue. Determine if Vasya will consider the two rows of the grid to be coloured the same." 800
1722A "Spell Check" implementation "Timur likes his name. As a spelling of his name, he allows any permutation of the letters of the name. For example, the following strings are valid spellings of his name: Timur, miurT, Trumi, mriTu. Note that the correct spelling must have uppercased T and lowercased other letters.Today he wrote string s of length n consisting only of uppercase or lowercase Latin letters. He asks you to check if s is the correct spelling of his name." 800
1721F "Matching Reduction" "brute force,constructive algorithms,dfs and similar,flows,graph matchings,graphs,interactive" "You are given a bipartite graph with n1 vertices in the first part, n2 vertices in the second part, and m edges. The maximum matching in this graph is the maximum possible (by size) subset of edges of this graph such that no vertex is incident to more than one chosen edge.You have to process two types of queries to this graph:  1 \xe2\x80\x94 remove the minimum possible number of vertices from this graph so that the size of the maximum matching gets reduced exactly by 1, and print the vertices that you have removed. Then, find any maximum matching in this graph and print the sum of indices of edges belonging to this matching;  2 \xe2\x80\x94 query of this type will be asked only after a query of type 1. As the answer to this query, you have to print the edges forming the maximum matching you have chosen in the previous query. Note that you should solve the problem in online mode. It means that you can\'t read the whole input at once. You can read each query only after writing the answer for the last query. Use functions fflush in C++ and BufferedWriter.flush in Java languages after each writing in your program." 2800
1721E "Prefix Function Queries" "dfs and similar,dp,hashing,string suffix structures,strings,trees" "You are given a string s, consisting of lowercase Latin letters.You are asked q queries about it: given another string t, consisting of lowercase Latin letters, perform the following steps:  concatenate s and t;  calculate the prefix function of the resulting string s+t;  print the values of the prefix function on positions |s|+1,|s|+2,\xe2\x80\xa6,|s|+|t| (|s| and |t| denote the lengths of strings s and t, respectively);  revert the string back to s. The prefix function of a string a is a sequence p1,p2,\xe2\x80\xa6,p|a|, where pi is the maximum value of k such that k<i and a[1..k]=a[i\xe2\x88\x92k+1..i] (a[l..r] denotes a contiguous substring of a string a from a position l to a position r, inclusive). In other words, it\'s the longest proper prefix of the string a[1..i] that is equal to its suffix of the same length." 2200
1721D "Maximum AND" "bitmasks,dfs and similar,divide and conquer,greedy,sortings" "You are given two arrays a and b, consisting of n integers each.Let\'s define a function f(a,b) as follows:   let\'s define an array c of size n, where ci=ai\xe2\x8a\x95bi (\xe2\x8a\x95 denotes bitwise XOR);  the value of the function is c1&c2&\xe2\x8b\xaf&cn (i.e. bitwise AND of the entire array c). Find the maximum value of the function f(a,b) if you can reorder the array b in an arbitrary way (leaving the initial order is also an option)." 1800
1721C "Min-Max Array Transformation" "binary search,greedy,two pointers" "You are given an array a1,a2,\xe2\x80\xa6,an, which is sorted in non-descending order. You decided to perform the following steps to create array b1,b2,\xe2\x80\xa6,bn:   Create an array d consisting of n arbitrary non-negative integers.  Set bi=ai+di for each bi.  Sort the array b in non-descending order. You are given the resulting array b. For each index i, calculate what is the minimum and maximum possible value of di you can choose in order to get the given array b.Note that the minimum (maximum) di-s are independent of each other, i. e. they can be obtained from different possible arrays d." 1400
1721B "Deadly Laser" implementation "The robot is placed in the top left corner of a grid, consisting of n rows and m columns, in a cell (1,1).In one step, it can move into a cell, adjacent by a side to the current one:   (x,y)\xe2\x86\x92(x,y+1);  (x,y)\xe2\x86\x92(x+1,y);  (x,y)\xe2\x86\x92(x,y\xe2\x88\x921);  (x,y)\xe2\x86\x92(x\xe2\x88\x921,y). The robot can\'t move outside the grid.The cell (sx,sy) contains a deadly laser. If the robot comes into some cell that has distance less than or equal to d to the laser, it gets evaporated. The distance between two cells (x1,y1) and (x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|.Print the smallest number of steps that the robot can take to reach the cell (n,m) without getting evaporated or moving outside the grid. If it\'s not possible to reach the cell (n,m), print -1.The laser is neither in the starting cell, nor in the ending cell. The starting cell always has distance greater than d to the laser." 1000
1721A Image greedy,implementation "You have an image file of size 2\xc3\x972, consisting of 4 pixels. Each pixel can have one of 26 different colors, denoted by lowercase Latin letters.You want to recolor some of the pixels of the image so that all 4 pixels have the same color. In one move, you can choose no more than two pixels of the same color and paint them into some other color (if you choose two pixels, both should be painted into the same color).What is the minimum number of moves you have to make in order to fulfill your goal?" 800
1720E "Misha and Paintings" "constructive algorithms,data structures,greedy,implementation,math" "Misha has a square n\xc3\x97n matrix, where the number in row i and column j is equal to ai,j. Misha wants to modify the matrix to contain exactly k distinct integers. To achieve this goal, Misha can perform the following operation zero or more times:  choose any square submatrix of the matrix (you choose (x1,y1), (x2,y2), such that x1\xe2\x89\xa4x2, y1\xe2\x89\xa4y2, x2\xe2\x88\x92x1=y2\xe2\x88\x92y1, then submatrix is a set of cells with coordinates (x,y), such that x1\xe2\x89\xa4x\xe2\x89\xa4x2, y1\xe2\x89\xa4y\xe2\x89\xa4y2),  choose an integer k, where 1\xe2\x89\xa4k\xe2\x89\xa4n2,  replace all integers in the submatrix with k. Please find the minimum number of operations that Misha needs to achieve his goal." 2700
1720D2 "Xor-Subsequence (hard version)" "bitmasks,data structures,dp,strings,trees" "It is the hard version of the problem. The only difference is that in this version ai\xe2\x89\xa4109.You are given an array of n integers a0,a1,a2,\xe2\x80\xa6an\xe2\x88\x921. Bryap wants to find the longest beautiful subsequence in the array.An array b=[b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921], where 0\xe2\x89\xa4b0<b1<\xe2\x80\xa6<bm\xe2\x88\x921<n, is a subsequence of length m of the array a.Subsequence b=[b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921] of length m is called beautiful, if the following condition holds:   For any p (0\xe2\x89\xa4p<m\xe2\x88\x921) holds: abp\xe2\x8a\x95bp+1<abp+1\xe2\x8a\x95bp. Here a\xe2\x8a\x95b denotes the bitwise XOR of a and b. For example, 2\xe2\x8a\x954=6 and 3\xe2\x8a\x951=2.Bryap is a simple person so he only wants to know the length of the longest such subsequence. Help Bryap and find the answer to his question." 2400
1720D1 "Xor-Subsequence (easy version)" "bitmasks,brute force,dp,strings,trees,two pointers" "It is the easy version of the problem. The only difference is that in this version ai\xe2\x89\xa4200.You are given an array of n integers a0,a1,a2,\xe2\x80\xa6an\xe2\x88\x921. Bryap wants to find the longest beautiful subsequence in the array.An array b=[b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921], where 0\xe2\x89\xa4b0<b1<\xe2\x80\xa6<bm\xe2\x88\x921<n, is a subsequence of length m of the array a.Subsequence b=[b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921] of length m is called beautiful, if the following condition holds:   For any p (0\xe2\x89\xa4p<m\xe2\x88\x921) holds: abp\xe2\x8a\x95bp+1<abp+1\xe2\x8a\x95bp. Here a\xe2\x8a\x95b denotes the bitwise XOR of a and b. For example, 2\xe2\x8a\x954=6 and 3\xe2\x8a\x951=2.Bryap is a simple person so he only wants to know the length of the longest such subsequence. Help Bryap and find the answer to his question." 1800
1720C Corners greedy,implementation "You are given a matrix consisting of n rows and m columns. Each cell of this matrix contains 0 or 1.Let\'s call a square of size 2\xc3\x972 without one corner cell an L-shape figure. In one operation you can take one L-shape figure, with at least one cell containing 1 and replace all numbers in it with zeroes.Find the maximum number of operations that you can do with the given matrix." 1200
1720B "Interesting Sum" "brute force,data structures,greedy,math,sortings" "You are given an array a that contains n integers. You can choose any proper subsegment al,al+1,\xe2\x80\xa6,ar of this array, meaning you can choose any two integers 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, where r\xe2\x88\x92l+1<n. We define the beauty of a given subsegment as the value of the following expression:max(a1,a2,\xe2\x80\xa6,al\xe2\x88\x921,ar+1,ar+2,\xe2\x80\xa6,an)\xe2\x88\x92min(a1,a2,\xe2\x80\xa6,al\xe2\x88\x921,ar+1,ar+2,\xe2\x80\xa6,an)+max(al,\xe2\x80\xa6,ar)\xe2\x88\x92min(al,\xe2\x80\xa6,ar).Please find the maximum beauty among all proper subsegments." 800
1720A "Burenka Plays with Fractions" "math,number theory" "Burenka came to kindergarden. This kindergarten is quite strange, so each kid there receives two fractions (ab and cd) with integer numerators and denominators. Then children are commanded to play with their fractions.Burenka is a clever kid, so she noticed that when she claps once, she can multiply numerator or denominator of one of her two fractions by any integer of her choice (but she can\'t multiply denominators by 0). Now she wants know the minimal number of claps to make her fractions equal (by value). Please help her and find the required number of claps!" 900
1719C "Fighting Tournament" "binary search,data structures,implementation,two pointers" "Burenka is about to watch the most interesting sporting event of the year \xe2\x80\x94 a fighting tournament organized by her friend Tonya.n athletes participate in the tournament, numbered from 1 to n. Burenka determined the strength of the i-th athlete as an integer ai, where 1\xe2\x89\xa4ai\xe2\x89\xa4n. All the strength values are different, that is, the array a is a permutation of length n. We know that in a fight, if ai>aj, then the i-th participant always wins the j-th.The tournament goes like this: initially, all n athletes line up in ascending order of their ids, and then there are infinitely many fighting rounds. In each round there is exactly one fight: the first two people in line come out and fight. The winner goes back to the front of the line, and the loser goes to the back.Burenka decided to ask Tonya q questions. In each question, Burenka asks how many victories the i-th participant gets in the first k rounds of the competition for some given numbers i and k. Tonya is not very good at analytics, so he asks you to help him answer all the questions." 1400
1719B "Mathematical Circus" "constructive algorithms,math" "A new entertainment has appeared in Buryatia \xe2\x80\x94 a mathematical circus! The magician shows two numbers to the audience \xe2\x80\x94 n and k, where n is even. Next, he takes all the integers from 1 to n, and splits them all into pairs (a,b) (each integer must be in exactly one pair) so that for each pair the integer (a+k)\xe2\x8b\x85b is divisible by 4 (note that the order of the numbers in the pair matters), or reports that, unfortunately for viewers, such a split is impossible.Burenka really likes such performances, so she asked her friend Tonya to be a magician, and also gave him the numbers n and k.Tonya is a wolf, and as you know, wolves do not perform in the circus, even in a mathematical one. Therefore, he asks you to help him. Let him know if a suitable splitting into pairs is possible, and if possible, then tell it." 800
1719A "Chip Game" games,math "Burenka and Tonya are playing an old Buryat game with a chip on a board of n\xc3\x97m cells.At the beginning of the game, the chip is located in the lower left corner of the board. In one move, the player can move the chip to the right or up by any odd number of cells (but you cannot move the chip both to the right and up in one move). The one who cannot make a move loses.Burenka makes the first move, the players take turns. Burenka really wants to win the game, but she is too lazy to come up with a strategy, so you are invited to solve the difficult task of finding it. Name the winner of the game (it is believed that Burenka and Tonya are masters of playing with chips, so they always move in the optimal way).  Chip\'s starting cell is green, the only cell from which chip can\'t move is red. if the chip is in the yellow cell, then blue cells are all options to move the chip in one move." 800
1718F "Burenka, an Array and Queries" "data structures,math,number theory" "Eugene got Burenka an array a of length n of integers from 1 to m for her birthday. Burenka knows that Eugene really likes coprime integers (integers x and y such that they have only one common factor (equal to 1)) so she wants to to ask Eugene q questions about the present. Each time Burenka will choose a subsegment al,al+1,\xe2\x80\xa6,ar of array a, and compute the product of these numbers p=al\xe2\x8b\x85al+1\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85ar. Then she will ask Eugene to count the number of integers between 1 and C inclusive which are coprime with p. Help Eugene answer all the questions!" 3300
1718E Impressionism "constructive algorithms,graphs,implementation,math" "Burenka has two pictures a and b, which are tables of the same size n\xc3\x97m. Each cell of each painting has a color \xe2\x80\x94 a number from 0 to 2\xe2\x8b\x85105, and there are no repeating colors in any row or column of each of the two paintings, except color 0.Burenka wants to get a picture b from the picture a. To achieve her goal, Burenka can perform one of 2 operations: swap any two rows of a or any two of its columns. Tell Burenka if she can fulfill what she wants, and if so, tell her the sequence of actions.The rows are numbered from 1 to n from top to bottom, the columns are numbered from 1 to m from left to right." 3500
1718D "Permutation for Burenka" "data structures,graph matchings,greedy,math,trees" "We call an array a pure if all elements in it are pairwise distinct. For example, an array [1,7,9] is pure, [1,3,3,7] isn\'t, because 3 occurs twice in it.A pure array b is similar to a pure array c if their lengths n are the same and for all pairs of indices l, r, such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, it\'s true that argmax([bl,bl+1,\xe2\x80\xa6,br])=argmax([cl,cl+1,\xe2\x80\xa6,cr]), where argmax(x) is defined as the index of the largest element in x (which is unique for pure arrays). For example, argmax([3,4,2])=2, argmax([1337,179,57])=1.Recently, Tonya found out that Burenka really likes a permutation p of length n. Tonya decided to please her and give her an array a similar to p. He already fixed some elements of a, but exactly k elements are missing (in these positions temporarily ai=0). It is guaranteed that k\xe2\x89\xa52. Also, he has a set S of k\xe2\x88\x921 numbers.Tonya realized that he was missing one number to fill the empty places of a, so he decided to buy it. He has q options to buy. Tonya thinks that the number d suits him, if it is possible to replace all zeros in a with numbers from S and the number d, so that a becomes a pure array similar to p. For each option of d, output whether this number is suitable for him or not." 3300
1718C "Tonya and Burenka-179" "data structures,greedy,math,number theory" "Tonya was given an array of a of length n written on a postcard for his birthday. For some reason, the postcard turned out to be a cyclic array, so the index of the element located strictly to the right of the n-th is 1. Tonya wanted to study it better, so he bought a robot ""Burenka-179"".A program for Burenka is a pair of numbers (s,k), where 1\xe2\x89\xa4s\xe2\x89\xa4n, 1\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921. Note that k cannot be equal to n. Initially, Tonya puts the robot in the position of the array s. After that, Burenka makes exactly n steps through the array. If at the beginning of a step Burenka stands in the position i, then the following happens:   The number ai is added to the usefulness of the program.  ""Burenka"" moves k positions to the right (i:=i+k is executed, if i becomes greater than n, then i:=i\xe2\x88\x92n). Help Tonya find the maximum possible usefulness of a program for ""Burenka"" if the initial usefulness of any program is 0.Also, Tony\'s friend Ilyusha asks him to change the array q times. Each time he wants to assign ap:=x for a given index p and a value x. You need to find the maximum possible usefulness of the program after each of these changes." 2400
1718B "Fibonacci Strings" "greedy,implementation,math,number theory" "In all schools in Buryatia, in the 1 class, everyone is told the theory of Fibonacci strings.""A block is a subsegment of a string where all the letters are the same and are bounded on the left and right by the ends of the string or by letters other than the letters in the block. A string is called a Fibonacci string if, when it is divided into blocks, their lengths in the order they appear in the string form the Fibonacci sequence (f0=f1=1, fi=fi\xe2\x88\x922+fi\xe2\x88\x921), starting from the zeroth member of this sequence. A string is called semi-Fibonacci if it possible to reorder its letters to get a Fibonacci string.""Burenka decided to enter the Buryat State University, but at the entrance exam she was given a difficult task. She was given a string consisting of the letters of the Buryat alphabet (which contains exactly k letters), and was asked if the given string is semi-Fibonacci. The string can be very long, so instead of the string, she was given the number of appearances of each letter (ci for the i-th letter) in that string. Unfortunately, Burenka no longer remembers the theory of Fibonacci strings, so without your help she will not pass the exam." 2000
1718A2 "Burenka and Traditions (hard version)" "data structures,dp,greedy" "This is the hard version of this problem. The difference between easy and hard versions is only the constraints on ai and on n. You can make hacks only if both versions of the problem are solved.Burenka is the crown princess of Buryatia, and soon she will become the n-th queen of the country. There is an ancient tradition in Buryatia \xe2\x80\x94 before the coronation, the ruler must show their strength to the inhabitants. To determine the strength of the n-th ruler, the inhabitants of the country give them an array of a of exactly n numbers, after which the ruler must turn all the elements of the array into zeros in the shortest time. The ruler can do the following two-step operation any number of times:   select two indices l and r, so that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and a non-negative integer x, then  for all l\xe2\x89\xa4i\xe2\x89\xa4r assign ai:=ai\xe2\x8a\x95x, where \xe2\x8a\x95 denotes the bitwise XOR operation. It takes \xe2\x8c\x88r\xe2\x88\x92l+12\xe2\x8c\x89 seconds to do this operation, where \xe2\x8c\x88y\xe2\x8c\x89 denotes y rounded up to the nearest integer. Help Burenka calculate how much time she will need." 1900
1718A1 "Burenka and Traditions (easy version)" dp,greedy "This is the easy version of this problem. The difference between easy and hard versions is only the constraints on ai and on n. You can make hacks only if both versions of the problem are solved.Burenka is the crown princess of Buryatia, and soon she will become the n-th queen of the country. There is an ancient tradition in Buryatia \xe2\x80\x94 before the coronation, the ruler must show their strength to the inhabitants. To determine the strength of the n-th ruler, the inhabitants of the country give them an array of a of exactly n numbers, after which the ruler must turn all the elements of the array into zeros in the shortest time. The ruler can do the following two-step operation any number of times:   select two indices l and r, so that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and a non-negative integer x, then  for all l\xe2\x89\xa4i\xe2\x89\xa4r assign ai:=ai\xe2\x8a\x95x, where \xe2\x8a\x95 denotes the bitwise XOR operation. It takes \xe2\x8c\x88r\xe2\x88\x92l+12\xe2\x8c\x89 seconds to do this operation, where \xe2\x8c\x88y\xe2\x8c\x89 denotes y rounded up to the nearest integer. Help Burenka calculate how much time she will need." 1800
1717F "Madoka and The First Session" "constructive algorithms,flows,graph matchings,graphs,implementation" "Oh no, on the first exam Madoka got this hard problem:Given integer n and m pairs of integers (vi,ui). Also there is an array b1,b2,\xe2\x80\xa6,bn, initially filled with zeros.Then for each index i, where 1\xe2\x89\xa4i\xe2\x89\xa4m, perform either bvi:=bvi\xe2\x88\x921 and bui:=bui+1, or bvi:=bvi+1 and bui:=bui\xe2\x88\x921. Note that exactly one of these operations should be performed for every i.Also there is an array s of length n consisting of 0 and 1. And there is an array a1,a2,\xe2\x80\xa6,an, where it is guaranteed, that if si=0 holds, then ai=0.Help Madoka and determine whenever it is possible to perform operations in such way that for every i, where si=1 it holds that ai=bi. If it possible you should also provide Madoka with a way to perform operations." 2500
1717E "Madoka and The Best University" "math,number theory" "Madoka wants to enter to ""Novosibirsk State University"", but in the entrance exam she came across a very difficult task:Given an integer n, it is required to calculate \xe2\x88\x91lcm(c,gcd(a,b)), for all triples of positive integers (a,b,c), where a+b+c=n.In this problem gcd(x,y) denotes the greatest common divisor of x and y, and lcm(x,y) denotes the least common multiple of x and y.Solve this problem for Madoka and help her to enter to the best university!" 2200
1717D "Madoka and The Corruption Scheme" "combinatorics,constructive algorithms,greedy,math" "Madoka decided to entrust the organization of a major computer game tournament ""OSU""!In this tournament, matches are held according to the ""Olympic system"". In other words, there are 2n participants in the tournament, numbered with integers from 1 to 2n. There are n rounds in total in the tournament. In the i-th round there are 2n\xe2\x88\x92i matches between two players (one of whom is right, the other is left), after which the winners go further along the tournament grid, and the losing participants are eliminated from the tournament. Herewith, the relative order in the next round does not change. And the winner of the tournament \xe2\x80\x94 is the last remaining participant.But the smaller the participant\'s number, the more he will pay Madoka if he wins, so Madoka wants the participant with the lowest number to win. To do this, she can arrange the participants in the first round as she likes, and also determine for each match who will win \xe2\x80\x94 the participant on the left or right.But Madoka knows that tournament sponsors can change the winner in matches no more than k times. (That is, if the participant on the left won before the change, then the participant on the right will win after the change, and if the participant on the right won, then the participant on the left will win after the change).  So, the first image shows the tournament grid that Madoka made, where the red lines denote who should win the match. And the second one shows the tournament grid, after one change in the outcome of the match by sponsors (a match between 1 and 3 players). Print the minimum possible number of the winner in the tournament, which Madoka can get regardless of changes in sponsors. But since the answer can be very large, output it modulo 109+7. Note that we need to minimize the answer, and only then take it modulo." 1900
1717C "Madoka and Formal Statement" greedy "Given an array of integer a1,a2,\xe2\x80\xa6,an. In one operation you can make ai:=ai+1 if i<n and ai\xe2\x89\xa4ai+1, or i=n and ai\xe2\x89\xa4a1.You need to check whether the array a1,a2,\xe2\x80\xa6,an can become equal to the array b1,b2,\xe2\x80\xa6,bn in some number of operations (possibly, zero). Two arrays a and b of length n are called equal if ai=bi for all integers i from 1 to n." 1300
1717B "Madoka and Underground Competitions" "constructive algorithms,implementation" "Madoka decided to participate in an underground sports programming competition. And there was exactly one task in it:A square table of size n\xc3\x97n, where n is a multiple of k, is called good if only the characters \'.\' and \'X\' are written in it, as well as in any subtable of size 1\xc3\x97k or k\xc3\x971, there is at least one character \'X\'. In other words, among any k consecutive vertical or horizontal cells, there must be at least one containing the character \'X\'.Output any good table that has the minimum possible number of characters \'X\', and also the symbol \'X\' is written in the cell (r,c). Rows are numbered from 1 to n from top to bottom, columns are numbered from 1 to n from left to right." 1100
1717A "Madoka and Strange Thoughts" "math,number theory" "Madoka is a very strange girl, and therefore she suddenly wondered how many pairs of integers (a,b) exist, where 1\xe2\x89\xa4a,b\xe2\x89\xa4n, for which lcm(a,b)gcd(a,b)\xe2\x89\xa43.In this problem, gcd(a,b) denotes the greatest common divisor of the numbers a and b, and lcm(a,b) denotes the smallest common multiple of the numbers a and b." 800
1716F "Bags with Balls" "combinatorics,dp,math,number theory" "There are n bags, each bag contains m balls with numbers from 1 to m. For every i\xe2\x88\x88[1,m], there is exactly one ball with number i in each bag.You have to take exactly one ball from each bag (all bags are different, so, for example, taking the ball 1 from the first bag and the ball 2 from the second bag is not the same as taking the ball 2 from the first bag and the ball 1 from the second bag). After that, you calculate the number of balls with odd numbers among the ones you have taken. Let the number of these balls be F.Your task is to calculate the sum of Fk over all possible ways to take n balls, one from each bag." 2500
1716E "Swap and Maximum Block" "bitmasks,data structures,dfs and similar,divide and conquer,dp" "You are given an array of length 2n. The elements of the array are numbered from 1 to 2n.You have to process q queries to this array. In the i-th query, you will be given an integer k (0\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921). To process the query, you should do the following:  for every i\xe2\x88\x88[1,2n\xe2\x88\x922k] in ascending order, do the following: if the i-th element was already swapped with some other element during this query, skip it; otherwise, swap ai and ai+2k;  after that, print the maximum sum over all contiguous subsegments of the array (including the empty subsegment). For example, if the array a is [\xe2\x88\x923,5,\xe2\x88\x923,2,8,\xe2\x88\x9220,6,\xe2\x88\x921], and k=1, the query is processed as follows:  the 1-st element wasn\'t swapped yet, so we swap it with the 3-rd element;  the 2-nd element wasn\'t swapped yet, so we swap it with the 4-th element;  the 3-rd element was swapped already;  the 4-th element was swapped already;  the 5-th element wasn\'t swapped yet, so we swap it with the 7-th element;  the 6-th element wasn\'t swapped yet, so we swap it with the 8-th element. So, the array becomes [\xe2\x88\x923,2,\xe2\x88\x923,5,6,\xe2\x88\x921,8,\xe2\x88\x9220]. The subsegment with the maximum sum is [5,6,\xe2\x88\x921,8], and the answer to the query is 18.Note that the queries actually change the array, i.\xe2\x80\x89e. after a query is performed, the array does not return to its original state, and the next query will be applied to the modified array." 2500
1716D "Chip Move" "brute force,dp,math" "There is a chip on the coordinate line. Initially, the chip is located at the point 0. You can perform any number of moves; each move increases the coordinate of the chip by some positive integer (which is called the length of the move). The length of the first move you make should be divisible by k, the length of the second move \xe2\x80\x94 by k+1, the third \xe2\x80\x94 by k+2, and so on.For example, if k=2, then the sequence of moves may look like this: 0\xe2\x86\x924\xe2\x86\x927\xe2\x86\x9219\xe2\x86\x9244, because 4\xe2\x88\x920=4 is divisible by 2=k, 7\xe2\x88\x924=3 is divisible by 3=k+1, 19\xe2\x88\x927=12 is divisible by 4=k+2, 44\xe2\x88\x9219=25 is divisible by 5=k+3.You are given two positive integers n and k. Your task is to count the number of ways to reach the point x, starting from 0, for every x\xe2\x88\x88[1,n]. The number of ways can be very large, so print it modulo 998244353. Two ways are considered different if they differ as sets of visited positions." 2000
1716C "Robot in a Hallway" "data structures,dp,greedy,implementation,ternary search" "There is a grid, consisting of 2 rows and m columns. The rows are numbered from 1 to 2 from top to bottom. The columns are numbered from 1 to m from left to right.The robot starts in a cell (1,1). In one second, it can perform either of two actions:   move into a cell adjacent by a side: up, right, down or left;  remain in the same cell. The robot is not allowed to move outside the grid.Initially, all cells, except for the cell (1,1), are locked. Each cell (i,j) contains a value ai,j \xe2\x80\x94 the moment that this cell gets unlocked. The robot can only move into a cell (i,j) if at least ai,j seconds have passed before the move.The robot should visit all cells without entering any cell twice or more (cell (1,1) is considered entered at the start). It can finish in any cell.What is the fastest the robot can achieve that?" 2000
1716B "Permutation Chain" "constructive algorithms,math" "A permutation of length n is a sequence of integers from 1 to n such that each integer appears in it exactly once.Let the fixedness of a permutation p be the number of fixed points in it \xe2\x80\x94 the number of positions j such that pj=j, where pj is the j-th element of the permutation p.You are asked to build a sequence of permutations a1,a2,\xe2\x80\xa6, starting from the identity permutation (permutation a1=[1,2,\xe2\x80\xa6,n]). Let\'s call it a permutation chain. Thus, ai is the i-th permutation of length n.For every i from 2 onwards, the permutation ai should be obtained from the permutation ai\xe2\x88\x921 by swapping any two elements in it (not necessarily neighboring). The fixedness of the permutation ai should be strictly lower than the fixedness of the permutation ai\xe2\x88\x921.Consider some chains for n=3:  a1=[1,2,3], a2=[1,3,2] \xe2\x80\x94 that is a valid chain of length 2. From a1 to a2, the elements on positions 2 and 3 get swapped, the fixedness decrease from 3 to 1.  a1=[2,1,3], a2=[3,1,2] \xe2\x80\x94 that is not a valid chain. The first permutation should always be [1,2,3] for n=3.  a1=[1,2,3], a2=[1,3,2], a3=[1,2,3] \xe2\x80\x94 that is not a valid chain. From a2 to a3, the elements on positions 2 and 3 get swapped but the fixedness increase from 1 to 3.  a1=[1,2,3], a2=[3,2,1], a3=[3,1,2] \xe2\x80\x94 that is a valid chain of length 3. From a1 to a2, the elements on positions 1 and 3 get swapped, the fixedness decrease from 3 to 1. From a2 to a3, the elements on positions 2 and 3 get swapped, the fixedness decrease from 1 to 0. Find the longest permutation chain. If there are multiple longest answers, print any of them." 800
1716A "2-3 Moves" greedy,math "You are standing at the point 0 on a coordinate line. Your goal is to reach the point n. In one minute, you can move by 2 or by 3 to the left or to the right (i.\xe2\x80\x89e., if your current coordinate is x, it can become x\xe2\x88\x923, x\xe2\x88\x922, x+2 or x+3). Note that the new coordinate can become negative.Your task is to find the minimum number of minutes required to get from the point 0 to the point n.You have to answer t independent test cases." 800
1715F "Crop Squares" "constructive algorithms,geometry,interactive,math" "This is an interactive problem.Farmer Stanley grows corn on a rectangular field of size n\xc3\x97m meters with corners in points (0,0), (0,m), (n,0), (n,m). This year the harvest was plentiful and corn covered the whole field.The night before harvest aliens arrived and poisoned the corn in a single 1\xc3\x971 square with sides parallel to field borders. The corn inside the square must not be eaten, but you cannot distinguish it from ordinary corn by sight. Stanley can only collect a sample of corn from an arbitrary polygon and bring it to the laboratory, where it will be analyzed and Stanley will be told the amount of corn in the sample that was poisoned. Since the harvest will soon deteriorate, such a study can be carried out no more than 5 times.More formally, it is allowed to make no more than 5 queries, each of them calculates the area of intersection of a chosen polygon with a square of poisoned corn. It is necessary to find out the coordinates of the lower-left corner of the drawn square (the vertex of the square with the smallest x and y coordinates)." 2700
1715E "Long Way Home" "data structures,divide and conquer,dp,geometry,graphs,greedy,shortest paths" "Stanley lives in a country that consists of n cities (he lives in city 1). There are bidirectional roads between some of the cities, and you know how long it takes to ride through each of them. Additionally, there is a flight between each pair of cities, the flight between cities u and v takes (u\xe2\x88\x92v)2 time.Stanley is quite afraid of flying because of watching ""Sully: Miracle on the Hudson"" recently, so he can take at most k flights. Stanley wants to know the minimum time of a journey to each of the n cities from the city 1." 2400
1715D "2+ doors" 2-sat,bitmasks,graphs,greedy "The Narrator has an integer array a of length n, but he will only tell you the size n and q statements, each of them being three integers i,j,x, which means that ai\xe2\x88\xa3aj=x, where | denotes the bitwise OR operation.Find the lexicographically smallest array a that satisfies all the statements.An array a is lexicographically smaller than an array b of the same length if and only if the following holds:   in the first position where a and b differ, the array a has a smaller element than the corresponding element in b." 1900
1715C Monoblock "combinatorics,data structures,implementation,math" "Stanley has decided to buy a new desktop PC made by the company ""Monoblock"", and to solve captcha on their website, he needs to solve the following task.The awesomeness of an array is the minimum number of blocks of consecutive identical numbers in which the array could be split. For example, the awesomeness of an array   [1,1,1] is 1;  [5,7] is 2, as it could be split into blocks [5] and [7];  [1,7,7,7,7,7,7,7,9,9,9,9,9,9,9,9,9] is 3, as it could be split into blocks [1], [7,7,7,7,7,7,7], and [9,9,9,9,9,9,9,9,9]. You are given an array a of length n. There are m queries of two integers i, x. A query i, x means that from now on the i-th element of the array a is equal to x.After each query print the sum of awesomeness values among all subsegments of array a. In other words, after each query you need to calculate n\xe2\x88\x91l=1n\xe2\x88\x91r=lg(l,r), where g(l,r) is the awesomeness of the array b=[al,al+1,\xe2\x80\xa6,ar]." 1700
1715B "Beautiful Array" "constructive algorithms,greedy,math" "Stanley defines the beauty of an array a of length n, which contains non-negative integers, as follows: n\xe2\x88\x91i=1\xe2\x8c\x8aaik\xe2\x8c\x8b, which means that we divide each element by k, round it down, and sum up the resulting values.Stanley told Sam the integer k and asked him to find an array a of n non-negative integers, such that the beauty is equal to b and the sum of elements is equal to s. Help Sam \xe2\x80\x94 find any of the arrays satisfying the conditions above." 1000
1715A Crossmarket "constructive algorithms,greedy,math" "Stanley and Megan decided to shop in the ""Crossmarket"" grocery store, which can be represented as a matrix with n rows and m columns. Stanley and Megan can move to an adjacent cell using 1 unit of power. Two cells are considered adjacent if they share an edge. To speed up the shopping process, Megan brought her portals with her, and she leaves one in each cell she visits (if there is no portal yet). If a person (Stanley or Megan) is in a cell with a portal, that person can use 1 unit of power to teleport to any other cell with a portal, including Megan\'s starting cell.They decided to split up: Stanley will go from the upper-left cell (cell with coordinates (1,1)) to the lower-right cell (cell with coordinates (n,m)), whilst Megan needs to get from the lower-left cell (cell with coordinates (n,1)) to the upper-right cell (cell with coordinates (1,m)).What is the minimum total energy needed for them both to do that?Note that they can choose the time they move. Time does not affect energy." 800
1714G "Path Prefixes" "binary search,data structures,dfs and similar,trees" "You are given a rooted tree. It contains n vertices, which are numbered from 1 to n. The root is the vertex 1.Each edge has two positive integer values. Thus, two positive integers aj and bj are given for each edge.Output n\xe2\x88\x921 numbers r2,r3,\xe2\x80\xa6,rn, where ri is defined as follows.Consider the path from the root (vertex 1) to i (2\xe2\x89\xa4i\xe2\x89\xa4n). Let the sum of the costs of aj along this path be Ai. Then ri is equal to the length of the maximum prefix of this path such that the sum of bj along this prefix does not exceed Ai.  Example for n=9. The blue color shows the costs of aj, and the red color shows the costs of bj. Consider an example. In this case:  r2=0, since the path to 2 has an amount of aj equal to 5, only the prefix of this path of length 0 has a smaller or equal amount of bj; r3=3, since the path to 3 has an amount of aj equal to 5+9+5=19, the prefix of length 3 of this path has a sum of bj equal to 6+10+1=17 ( the number is 17\xe2\x89\xa419); r4=1, since the path to 4 has an amount of aj equal to 5+9=14, the prefix of length 1 of this path has an amount of bj equal to 6 (this is the longest suitable prefix, since the prefix of length 2 already has an amount of bj equal to 6+10=16, which is more than 14); r5=2, since the path to 5 has an amount of aj equal to 5+9+2=16, the prefix of length 2 of this path has a sum of bj equal to 6+10=16 (this is the longest suitable prefix, since the prefix of length 3 already has an amount of bj equal to 6+10+1=17, what is more than 16); r6=1, since the path up to 6 has an amount of aj equal to 2, the prefix of length 1 of this path has an amount of bj equal to 1; r7=1, since the path to 7 has an amount of aj equal to 5+3=8, the prefix of length 1 of this path has an amount of bj equal to 6 (this is the longest suitable prefix, since the prefix of length 2 already has an amount of bj equal to 6+3=9, which is more than 8); r8=2, since the path up to 8 has an amount of aj equal to 2+4=6, the prefix of length 2 of this path has an amount of bj equal to 1+3=4; r9=3, since the path to 9 has an amount of aj equal to 2+4+1=7, the prefix of length 3 of this path has a sum of bj equal to 1+3+3=7." 1700
1714F "Build a Tree and That Is It" "constructive algorithms,implementation,trees" "A tree is a connected undirected graph without cycles. Note that in this problem, we are talking about not rooted trees.You are given four positive integers n,d12,d23 and d31. Construct a tree such that:  it contains n vertices numbered from 1 to n,  the distance (length of the shortest path) from vertex 1 to vertex 2 is d12,  distance from vertex 2 to vertex 3 is d23,  the distance from vertex 3 to vertex 1 is d31. Output any tree that satisfies all the requirements above, or determine that no such tree exists." 1900
1714E "Add Modulo 10" "brute force,math,number theory" "You are given an array of n integers a1,a2,\xe2\x80\xa6,anYou can apply the following operation an arbitrary number of times:   select an index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace the value of the element ai with the value ai+(aimod10), where aimod10 is the remainder of the integer dividing ai by 10. For a single index (value i), this operation can be applied multiple times. If the operation is applied repeatedly to the same index, then the current value of ai is taken into account each time. For example, if ai=47 then after the first operation we get ai=47+7=54, and after the second operation we get ai=54+4=58.Check if it is possible to make all array elements equal by applying multiple (possibly zero) operations.For example, you have an array [6,11].   Let\'s apply this operation to the first element of the array. Let\'s replace a1=6 with a1+(a1mod10)=6+(6mod10)=6+6=12. We get the array [12,11].  Then apply this operation to the second element of the array. Let\'s replace a2=11 with a2+(a2mod10)=11+(11mod10)=11+1=12. We get the array [12,12]. Thus, by applying 2 operations, you can make all elements of an array equal." 1400
1714D "Color with Occurrences" "brute force,data structures,dp,greedy,strings" "You are given some text t and a set of n strings s1,s2,\xe2\x80\xa6,sn. In one step, you can choose any occurrence of any string si in the text t and color the corresponding characters of the text in red. For example, if t=bababa and s1=ba, s2=aba, you can get t=bababa, t=bababa or t=bababa in one step.You want to color all the letters of the text t in red. When you color a letter in red again, it stays red.In the example above, three steps are enough:  Let\'s color t[2\xe2\x80\xa64]=s2=aba in red, we get t=bababa;  Let\'s color t[1\xe2\x80\xa62]=s1=ba in red, we get t=bababa;  Let\'s color t[4\xe2\x80\xa66]=s2=aba in red, we get t=bababa. Each string si can be applied any number of times (or not at all). Occurrences for coloring can intersect arbitrarily.Determine the minimum number of steps needed to color all letters t in red and how to do it. If it is impossible to color all letters of the text t in red, output -1." 1600
1714C "Minimum  Varied Number" greedy "Find the minimum number with the given sum of digits s such that all digits in it are distinct (i.e. all digits are unique).For example, if s=20, then the answer is 389. This is the minimum number in which all digits are different and the sum of the digits is 20 (3+8+9=20).For the given s print the required number." 800
1714B "Remove Prefix" "data structures,greedy,implementation" "Polycarp was presented with some sequence of integers a of length n (1\xe2\x89\xa4ai\xe2\x89\xa4n). A sequence can make Polycarp happy only if it consists of different numbers (i.e. distinct numbers).In order to make his sequence like this, Polycarp is going to make some (possibly zero) number of moves.In one move, he can:   remove the first (leftmost) element of the sequence. For example, in one move, the sequence [3,1,4,3] will produce the sequence [1,4,3], which consists of different numbers.Determine the minimum number of moves he needs to make so that in the remaining sequence all elements are different. In other words, find the length of the smallest prefix of the given sequence a, after removing which all values in the sequence will be unique." 800
1714A "Everyone Loves to Sleep" implementation,math "Vlad, like everyone else, loves to sleep very much.Every day Vlad has to do n things, each at a certain time. For each of these things, he has an alarm clock set, the i-th of them is triggered on hi hours mi minutes every day (0\xe2\x89\xa4hi<24,0\xe2\x89\xa4mi<60). Vlad uses the 24-hour time format, so after h=12,m=59 comes h=13,m=0 and after h=23,m=59 comes h=0,m=0.This time Vlad went to bed at H hours M minutes (0\xe2\x89\xa4H<24,0\xe2\x89\xa4M<60) and asks you to answer: how much he will be able to sleep until the next alarm clock.If any alarm clock rings at the time when he went to bed, then he will sleep for a period of time of length 0." 900
1713F "Lost Array" "bitmasks,combinatorics,constructive algorithms,dp,math" "My orzlers, we can optimize this problem from O(S3) to O(T59)!\xe2\x80\x94 Spyofgame, founder of Orzlim religionA long time ago, Spyofgame invented the famous array a (1-indexed) of length n that contains information about the world and life. After that, he decided to convert it into the matrix b (0-indexed) of size (n+1)\xc3\x97(n+1) which contains information about the world, life and beyond.Spyofgame converted a into b with the following rules.  bi,0=0 if 0\xe2\x89\xa4i\xe2\x89\xa4n;  b0,i=ai if 1\xe2\x89\xa4i\xe2\x89\xa4n;  bi,j=bi,j\xe2\x88\x921\xe2\x8a\x95bi\xe2\x88\x921,j if 1\xe2\x89\xa4i,j\xe2\x89\xa4n. Here \xe2\x8a\x95 denotes the bitwise XOR operation.Today, archaeologists have discovered the famous matrix b. However, many elements of the matrix has been lost. They only know the values of bi,n for 1\xe2\x89\xa4i\xe2\x89\xa4n (note that these are some elements of the last column, not the last row).The archaeologists want to know what a possible array of a is. Can you help them reconstruct any array that could be a?" 2900
1713E "Cross Swapping" "2-sat,data structures,dsu,greedy,matrices" "You are given a square matrix A of size n\xc3\x97n whose elements are integers. We will denote the element on the intersection of the i-th row and the j-th column as Ai,j.You can perform operations on the matrix. In each operation, you can choose an integer k, then for each index i (1\xe2\x89\xa4i\xe2\x89\xa4n), swap Ai,k with Ak,i. Note that cell Ak,k remains unchanged.For example, for n=4 and k=3, this matrix will be transformed like this:  The operation k=3 swaps the blue row with the green column. You can perform this operation any number of times. Find the lexicographically smallest matrix\xe2\x80\xa0 you can obtain after performing arbitrary number of operations.\xe2\x80\xa0 For two matrices A and B of size n\xc3\x97n, let a(i\xe2\x88\x921)\xe2\x8b\x85n+j=Ai,j and b(i\xe2\x88\x921)\xe2\x8b\x85n+j=Bi,j. Then, the matrix A is lexicographically smaller than the matrix B when there exists an index i (1\xe2\x89\xa4i\xe2\x89\xa4n2) such that ai<bi and for all indices j such that 1\xe2\x89\xa4j<i, aj=bj." 2400
1713D "Tournament Countdown" "constructive algorithms,greedy,interactive,number theory,probabilities" "This is an interactive problem.There was a tournament consisting of 2n contestants. The 1-st contestant competed with the 2-nd, the 3-rd competed with the 4-th, and so on. After that, the winner of the first match competed with the winner of second match, etc. The tournament ended when there was only one contestant left, who was declared the winner of the tournament. Such a tournament scheme is known as the single-elimination tournament.You don\'t know the results, but you want to find the winner of the tournament. In one query, you select two integers a and b, which are the indices of two contestants. The jury will return 1 if a won more matches than b, 2 if b won more matches than a, or 0 if their number of wins was equal.Find the winner in no more than \xe2\x8c\x8813\xe2\x8b\x852n+1\xe2\x8c\x89 queries. Here \xe2\x8c\x88x\xe2\x8c\x89 denotes the value of x rounded up to the nearest integer.Note that the tournament is long over, meaning that the results are fixed and do not depend on your queries." 1800
1713C "Build Permutation" "constructive algorithms,dp,math" "A 0-indexed array a of size n is called good if for all valid indices i (0\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), ai+i is a perfect square\xe2\x80\xa0.Given an integer n. Find a permutation\xe2\x80\xa1 p of [0,1,2,\xe2\x80\xa6,n\xe2\x88\x921] that is good or determine that no such permutation exists.\xe2\x80\xa0 An integer x is said to be a perfect square if there exists an integer y such that x=y2.\xe2\x80\xa1 An array b is a permutation of an array a if b consists of the elements of a in arbitrary order. For example, [4,2,3,4] is a permutation of [3,2,4,4] while [1,2,2] is not a permutation of [1,2,3]." 1200
1713B "Optimal Reduction" "constructive algorithms,sortings" "Consider an array a of n positive integers.You may perform the following operation:   select two indices l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n), then  decrease all elements al,al+1,\xe2\x80\xa6,ar by 1. Let\'s call f(a) the minimum number of operations needed to change array a into an array of n zeros.Determine if for all permutations\xe2\x80\xa0 b of a, f(a)\xe2\x89\xa4f(b) is true. \xe2\x80\xa0 An array b is a permutation of an array a if b consists of the elements of a in arbitrary order. For example, [4,2,3,4] is a permutation of [3,2,4,4] while [1,2,2] is not a permutation of [1,2,3]." 1000
1713A "Traveling Salesman Problem" geometry,greedy,implementation "You are living on an infinite plane with the Cartesian coordinate system on it. In one move you can go to any of the four adjacent points (left, right, up, down).More formally, if you are standing at the point (x,y), you can:   go left, and move to (x\xe2\x88\x921,y), or  go right, and move to (x+1,y), or  go up, and move to (x,y+1), or  go down, and move to (x,y\xe2\x88\x921). There are n boxes on this plane. The i-th box has coordinates (xi,yi). It is guaranteed that the boxes are either on the x-axis or the y-axis. That is, either xi=0 or yi=0.You can collect a box if you and the box are at the same point. Find the minimum number of moves you have to perform to collect all of these boxes if you have to start and finish at the point (0,0)." 800
1712F Triameter "binary search,data structures,dfs and similar,trees" "\xe2\x80\x94 What is my mission?  \xe2\x80\x94 To count graph diameters.You and Your SubmissionA tree is a connected undirected graph without cycles. A weighted tree has a weight assigned to each edge. The degree of a vertex is the number of edges connected to this vertex.You are given a weighted tree with n vertices, each edge has a weight of 1. Let L be the set of vertices with degree equal to 1. You have to answer q independent queries. In the i-th query:  You are given a positive integer xi.  For all u,v\xe2\x88\x88L such that u<v, add edge (u,v) with weight xi to the graph (initially the given tree).  Find the diameter of the resulting graph. The diameter of a graph is equal to max1\xe2\x89\xa4u<v\xe2\x89\xa4nd(u,v), where d(u,v) is the length of the shortest path between vertex u and vertex v." 3200
1712E2 "LCM Sum (hard version)" "brute force,data structures,math,number theory,two pointers" "We are sum for we are manySome NumberThis version of the problem differs from the previous one only in the constraint on t. You can make hacks only if both versions of the problem are solved.You are given two positive integers l and r.Count the number of distinct triplets of integers (i,j,k) such that l\xe2\x89\xa4i<j<k\xe2\x89\xa4r and lcm(i,j,k)\xe2\x89\xa5i+j+k.Here lcm(i,j,k) denotes the least common multiple (LCM) of integers i, j, and k." 2500
1712E1 "LCM Sum (easy version)" "binary search,brute force,combinatorics,math,number theory,two pointers" "We are sum for we are manySome NumberThis version of the problem differs from the next one only in the constraint on t. You can make hacks only if both versions of the problem are solved.You are given two positive integers l and r.Count the number of distinct triplets of integers (i,j,k) such that l\xe2\x89\xa4i<j<k\xe2\x89\xa4r and lcm(i,j,k)\xe2\x89\xa5i+j+k.Here lcm(i,j,k) denotes the least common multiple (LCM) of integers i, j, and k." 2300
1712D "Empty Graph" "binary search,constructive algorithms,data structures,greedy,shortest paths" "\xe2\x80\x94 Do you have a wish?  \xe2\x80\x94 I want people to stop gifting each other arrays.O_o and Another Young BoyAn array of n positive integers a1,a2,\xe2\x80\xa6,an fell down on you from the skies, along with a positive integer k\xe2\x89\xa4n.You can apply the following operation at most k times:   Choose an index 1\xe2\x89\xa4i\xe2\x89\xa4n and an integer 1\xe2\x89\xa4x\xe2\x89\xa4109. Then do ai:=x (assign x to ai). Then build a complete undirected weighted graph with n vertices numbered with integers from 1 to n, where edge (l,r) (1\xe2\x89\xa4l<r\xe2\x89\xa4n) has weight min(al,al+1,\xe2\x80\xa6,ar).You have to find the maximum possible diameter of the resulting graph after performing at most k operations.The diameter of a graph is equal to max1\xe2\x89\xa4u<v\xe2\x89\xa4nd(u,v), where d(u,v) is the length of the shortest path between vertex u and vertex v." 2000
1712C "Sort Zero" greedy,sortings "An array is sorted if it has no inversionsA Young BoyYou are given an array of n positive integers a1,a2,\xe2\x80\xa6,an. In one operation you do the following:   Choose any integer x.  For all i such that ai=x, do ai:=0 (assign 0 to ai). Find the minimum number of operations required to sort the array in non-decreasing order." 1100
1712B "Woeful Permutation" "constructive algorithms,greedy,number theory" "I wonder, does the falling rain Forever yearn for it\'s disdain?Effluvium of the MindYou are given a positive integer n.Find any permutation p of length n such that the sum lcm(1,p1)+lcm(2,p2)+\xe2\x80\xa6+lcm(n,pn) is as large as possible. Here lcm(x,y) denotes the least common multiple (LCM) of integers x and y.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800
1712A "Wonderful Permutation" greedy,implementation "God\'s Blessing on This PermutationForces!A Random PebbleYou are given a permutation p1,p2,\xe2\x80\xa6,pn of length n and a positive integer k\xe2\x89\xa4n. In one operation you can choose two indices i and j (1\xe2\x89\xa4i<j\xe2\x89\xa4n) and swap pi with pj.Find the minimum number of operations needed to make the sum p1+p2+\xe2\x80\xa6+pk as small as possible.A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800
1711B Party "brute force,graphs" "A club plans to hold a party and will invite some of its n members. The n members are identified by the numbers 1,2,\xe2\x80\xa6,n. If member i is not invited, the party will gain an unhappiness value of ai.There are m pairs of friends among the n members. As per tradition, if both people from a friend pair are invited, they will share a cake at the party. The total number of cakes eaten will be equal to the number of pairs of friends such that both members have been invited.However, the club\'s oven can only cook two cakes at a time. So, the club demands that the total number of cakes eaten is an even number.What is the minimum possible total unhappiness value of the party, respecting the constraint that the total number of cakes eaten is even?" 1300
1711A "Perfect Permutation" "constructive algorithms" "You are given a positive integer n.The weight of a permutation p1,p2,\xe2\x80\xa6,pn is the number of indices 1\xe2\x89\xa4i\xe2\x89\xa4n such that i divides pi. Find a permutation p1,p2,\xe2\x80\xa6,pn with the minimum possible weight (among all permutations of length n).A permutation is an array consisting of n distinct integers from 1 to n in arbitrary order. For example, [2,3,1,5,4] is a permutation, but [1,2,2] is not a permutation (2 appears twice in the array) and [1,3,4] is also not a permutation (n=3 but there is 4 in the array)." 800
1710E "Two Arrays" "binary search,games,graph matchings" "You are given two arrays of integers a1,a2,\xe2\x80\xa6,an and b1,b2,\xe2\x80\xa6,bm. Alice and Bob are going to play a game. Alice moves first and they take turns making a move.They play on a grid of size n\xc3\x97m (a grid with n rows and m columns). Initially, there is a rook positioned on the first row and first column of the grid.During her/his move, a player can do one of the following two operations:  Move the rook to a different cell on the same row or the same column of the current cell. A player cannot move the rook to a cell that has been visited 1000 times before (i.e., the rook can stay in a certain cell at most 1000 times during the entire game). Note that the starting cell is considered to be visited once at the beginning of the game. End the game immediately with a score of ar+bc, where (r,c) is the current cell (i.e., the rook is on the r-th row and c-th column). Bob wants to maximize the score while Alice wants to minimize it. If they both play this game optimally, what is the final score of the game?" 2400
1710D "Recover the Tree" "constructive algorithms,trees" "Rhodoks has a tree with n vertices, but he doesn\'t remember its structure. The vertices are indexed from 1 to n.A segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) is good if the vertices with indices l, l+1, ..., r form a connected component in Rhodoks\' tree. Otherwise, it is bad.For example, if the tree is the one in the picture, then only the segment [3,4] is bad while all the other segments are good.  For each of the n(n+1)2 segments, Rhodoks remembers whether it is good or bad. Can you help him recover the tree? If there are multiple solutions, print any.It is guaranteed that the there is at least one tree satisfying Rhodoks\' description." 3400
1710C "XOR Triangle" "bitmasks,brute force,constructive algorithms,dp,greedy,math" "You are given a positive integer n. Since n may be very large, you are given its binary representation.You should compute the number of triples (a,b,c) with 0\xe2\x89\xa4a,b,c\xe2\x89\xa4n such that a\xe2\x8a\x95b, b\xe2\x8a\x95c, and a\xe2\x8a\x95c are the sides of a non-degenerate triangle. Here, \xe2\x8a\x95 denotes the bitwise XOR operation.You should output the answer modulo 998244353.Three positive values x, y, and z are the sides of a non-degenerate triangle if and only if x+y>z, x+z>y, and y+z>x." 2500
1710B Rain "binary search,brute force,data structures,geometry,greedy,implementation,math" "You are the owner of a harvesting field which can be modeled as an infinite line, whose positions are identified by integers.It will rain for the next n days. On the i-th day, the rain will be centered at position xi and it will have intensity pi. Due to these rains, some rainfall will accumulate; let aj be the amount of rainfall accumulated at integer position j. Initially aj is 0, and it will increase by max(0,pi\xe2\x88\x92|xi\xe2\x88\x92j|) after the i-th day\'s rain.A flood will hit your field if, at any moment, there is a position j with accumulated rainfall aj>m.You can use a magical spell to erase exactly one day\'s rain, i.e., setting pi=0. For each i from 1 to n, check whether in case of erasing the i-th day\'s rain there is no flood." 2100
1710A "Color the Picture" "constructive algorithms,greedy,math" "A picture can be represented as an n\xc3\x97m grid (n rows and m columns) so that each of the n\xe2\x8b\x85m cells is colored with one color. You have k pigments of different colors. You have a limited amount of each pigment, more precisely you can color at most ai cells with the i-th pigment.A picture is considered beautiful if each cell has at least 3 toroidal neighbors with the same color as itself.Two cells are considered toroidal neighbors if they toroidally share an edge. In other words, for some integers 1\xe2\x89\xa4x1,x2\xe2\x89\xa4n and 1\xe2\x89\xa4y1,y2\xe2\x89\xa4m, the cell in the x1-th row and y1-th column is a toroidal neighbor of the cell in the x2-th row and y2-th column if one of following two conditions holds:  x1\xe2\x88\x92x2\xe2\x89\xa1\xc2\xb11(modn) and y1=y2, or  y1\xe2\x88\x92y2\xe2\x89\xa1\xc2\xb11(modm) and x1=x2. Notice that each cell has exactly 4 toroidal neighbors. For example, if n=3 and m=4, the toroidal neighbors of the cell (1,2) (the cell on the first row and second column) are: (3,2), (2,2), (1,3), (1,1). They are shown in gray on the image below:  The gray cells show toroidal neighbors of (1,2). Is it possible to color all cells with the pigments provided and create a beautiful picture?" 1500
1709F "Multiset of Strings" "bitmasks,brute force,dp,fft,flows,graphs,math,meet-in-the-middle,trees" "You are given three integers n, k and f.Consider all binary strings (i.\xe2\x80\x89e. all strings consisting of characters 0 and/or 1) of length from 1 to n. For every such string s, you need to choose an integer cs from 0 to k.A multiset of binary strings of length exactly n is considered beautiful if for every binary string s with length from 1 to n, the number of strings in the multiset such that s is their prefix is not exceeding cs.For example, let n=2, c0=3, c00=1, c01=2, c1=1, c10=2, and c11=3. The multiset of strings {11,01,00,01} is beautiful, since:  for the string 0, there are 3 strings in the multiset such that 0 is their prefix, and 3\xe2\x89\xa4c0;  for the string 00, there is one string in the multiset such that 00 is its prefix, and 1\xe2\x89\xa4c00;  for the string 01, there are 2 strings in the multiset such that 01 is their prefix, and 2\xe2\x89\xa4c01;  for the string 1, there is one string in the multiset such that 1 is its prefix, and 1\xe2\x89\xa4c1;  for the string 10, there are 0 strings in the multiset such that 10 is their prefix, and 0\xe2\x89\xa4c10;  for the string 11, there is one string in the multiset such that 11 is its prefix, and 1\xe2\x89\xa4c11. Now, for the problem itself. You have to calculate the number of ways to choose the integer cs for every binary string s of length from 1 to n in such a way that the maximum possible size of a beautiful multiset is exactly f." 2500
1709E "XOR Tree" "bitmasks,data structures,dfs and similar,dsu,greedy,trees" "You are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to ai.Recall that a simple path is a path that visits each vertex at most once. Let the weight of the path be the bitwise XOR of the values written on vertices it consists of. Let\'s say that a tree is good if no simple path has weight 0.You can apply the following operation any number of times (possibly, zero): select a vertex of the tree and replace the value written on it with an arbitrary positive integer. What is the minimum number of times you have to apply this operation in order to make the tree good?" 2400
1709D Rorororobot "binary search,data structures,greedy,math" "There is a grid, consisting of n rows and m columns. The rows are numbered from 1 to n from bottom to top. The columns are numbered from 1 to m from left to right. The i-th column has the bottom ai cells blocked (the cells in rows 1,2,\xe2\x80\xa6,ai), the remaining n\xe2\x88\x92ai cells are unblocked.A robot is travelling across this grid. You can send it commands \xe2\x80\x94 move up, right, down or left. If a robot attempts to move into a blocked cell or outside the grid, it explodes.However, the robot is broken \xe2\x80\x94 it executes each received command k times. So if you tell it to move up, for example, it will move up k times (k cells). You can\'t send it commands while the robot executes the current one.You are asked q queries about the robot. Each query has a start cell, a finish cell and a value k. Can you send the robot an arbitrary number of commands (possibly, zero) so that it reaches the finish cell from the start cell, given that it executes each command k times?The robot must stop in the finish cell. If it visits the finish cell while still executing commands, it doesn\'t count." 1700
1709C "Recover an RBS" "constructive algorithms,greedy,implementation,strings" "A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence (or, shortly, an RBS) is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example:  bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)"");  bracket sequences "")("", ""("" and "")"" are not. There was an RBS. Some brackets have been replaced with question marks. Is it true that there is a unique way to replace question marks with brackets, so that the resulting sequence is an RBS?" 1800
1709B "Also Try Minecraft" "data structures,dp,implementation" "You are beta testing the new secret Terraria update. This update will add quests to the game!Simply, the world map can be represented as an array of length n, where the i-th column of the world has height ai.There are m quests you have to test. The j-th of them is represented by two integers sj and tj. In this quest, you have to go from the column sj to the column tj. At the start of the quest, you are appearing at the column sj.In one move, you can go from the column x to the column x\xe2\x88\x921 or to the column x+1. In this version, you have Spectre Boots, which allow you to fly. Since it is a beta version, they are bugged, so they only allow you to fly when you are going up and have infinite fly duration. When you are moving from the column with the height p to the column with the height q, then you get some amount of fall damage. If the height p is greater than the height q, you get p\xe2\x88\x92q fall damage, otherwise you fly up and get 0 damage.For each of the given quests, determine the minimum amount of fall damage you can get during this quest." 900
1709A "Three Doors" "brute force,greedy,implementation,math" "There are three doors in front of you, numbered from 1 to 3 from left to right. Each door has a lock on it, which can only be opened with a key with the same number on it as the number on the door.There are three keys \xe2\x80\x94 one for each door. Two of them are hidden behind the doors, so that there is no more than one key behind each door. So two doors have one key behind them, one door doesn\'t have a key behind it. To obtain a key hidden behind a door, you should first unlock that door. The remaining key is in your hands.Can you open all the doors?" 800
1708B "Difference of GCDs" "constructive algorithms,math" "You are given three integers n, l, and r. You need to construct an array a1,a2,\xe2\x80\xa6,an (l\xe2\x89\xa4ai\xe2\x89\xa4r) such that gcd(i,ai) are all distinct or report there\'s no solution.Here gcd(x,y) denotes the greatest common divisor (GCD) of integers x and y." 1100
1708A "Difference Operations" greedy,math "You are given an array a consisting of n positive integers.You are allowed to perform this operation any number of times (possibly, zero):   choose an index i (2\xe2\x89\xa4i\xe2\x89\xa4n), and change ai to ai\xe2\x88\x92ai\xe2\x88\x921. Is it possible to make ai=0 for all 2\xe2\x89\xa4i\xe2\x89\xa4n?" 800
1707F Bugaboo "bitmasks,constructive algorithms,dp,number theory" "A transformation of an array of positive integers a1,a2,\xe2\x80\xa6,an is defined by replacing a with the array b1,b2,\xe2\x80\xa6,bn given by bi=ai\xe2\x8a\x95a(imodn)+1, where \xe2\x8a\x95 denotes the bitwise XOR operation.You are given integers n, t, and w. We consider an array c1,c2,\xe2\x80\xa6,cn (0\xe2\x89\xa4ci\xe2\x89\xa42w\xe2\x88\x921) to be bugaboo if and only if there exists an array a1,a2,\xe2\x80\xa6,an such that after transforming a for t times, a becomes c.For example, when n=6, t=2, w=2, then the array [3,2,1,0,2,2] is bugaboo because it can be given by transforming the array [2,3,1,1,0,1] for 2 times:[2,3,1,1,0,1]\xe2\x86\x92[2\xe2\x8a\x953,3\xe2\x8a\x951,1\xe2\x8a\x951,1\xe2\x8a\x950,0\xe2\x8a\x951,1\xe2\x8a\x952]=[1,2,0,1,1,3];[1,2,0,1,1,3]\xe2\x86\x92[1\xe2\x8a\x952,2\xe2\x8a\x950,0\xe2\x8a\x951,1\xe2\x8a\x951,1\xe2\x8a\x953,3\xe2\x8a\x951]=[3,2,1,0,2,2].And the array [4,4,4,4,0,0] is not bugaboo because 4>22\xe2\x88\x921. The array [2,3,3,3,3,3] is also not bugaboo because it can\'t be given by transforming one array for 2 times.You are given an array c with some positions lost (only m positions are known at first and the remaining positions are lost). And there are q modifications, where each modification is changing a position of c. A modification can possibly change whether the position is lost or known, and it can possibly redefine a position that is already given.You need to calculate how many possible arrays c (with arbitrary elements on the lost positions) are bugaboos after each modification. Output the i-th answer modulo pi (pi is a given array consisting of q elements)." 3500
1707E Replace "binary search,data structures" "You are given an integer array a1,\xe2\x80\xa6,an, where 1\xe2\x89\xa4ai\xe2\x89\xa4n for all i.There\'s a ""replace"" function f which takes a pair of integers (l,r), where l\xe2\x89\xa4r, as input and outputs the pair f((l,r))=(min{al,al+1,\xe2\x80\xa6,ar},max{al,al+1,\xe2\x80\xa6,ar}).Consider repeated calls of this function. That is, from a starting pair (l,r) we get f((l,r)), then f(f((l,r))), then f(f(f((l,r)))), and so on.Now you need to answer q queries. For the i-th query you have two integers li and ri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n). You must answer the minimum number of times you must apply the ""replace"" function to the pair (li,ri) to get (1,n), or report that it is impossible." 3500
1707D "Partial Virtual Trees" "combinatorics,dfs and similar,dp,math,trees" "Kawashiro Nitori is a girl who loves competitive programming. One day she found a rooted tree consisting of n vertices. The root is vertex 1. As an advanced problem setter, she quickly thought of a problem.Kawashiro Nitori has a vertex set U={1,2,\xe2\x80\xa6,n}. She\'s going to play a game with the tree and the set. In each operation, she will choose a vertex set T, where T is a partial virtual tree of U, and change U into T.A vertex set S1 is a partial virtual tree of a vertex set S2, if S1 is a subset of S2, S1\xe2\x89\xa0S2, and for all pairs of vertices i and j in S1, LCA(i,j) is in S1, where LCA(x,y) denotes the lowest common ancestor of vertices x and y on the tree. Note that a vertex set can have many different partial virtual trees.Kawashiro Nitori wants to know for each possible k, if she performs the operation exactly k times, in how many ways she can make U={1} in the end? Two ways are considered different if there exists an integer z (1\xe2\x89\xa4z\xe2\x89\xa4k) such that after z operations the sets U are different.Since the answer could be very large, you need to find it modulo p. It\'s guaranteed that p is a prime number." 3000
1707C "DFS Trees" "dfs and similar,dsu,graphs,greedy,sortings,trees" "You are given a connected undirected graph consisting of n vertices and m edges. The weight of the i-th edge is i.Here is a wrong algorithm of finding a minimum spanning tree (MST) of a graph:vis := an array of length ns := a set of edgesfunction dfs(u):    vis[u] := true    iterate through each edge (u, v) in the order from smallest to largest edge weight        if vis[v] = false            add edge (u, v) into the set (s)            dfs(v)function findMST(u):    reset all elements of (vis) to false    reset the edge set (s) to empty    dfs(u)    return the edge set (s)Each of the calls findMST(1), findMST(2), ..., findMST(n) gives you a spanning tree of the graph. Determine which of these trees are minimum spanning trees." 2400
1707B "Difference Array" "brute force,data structures,implementation,sortings" "You are given an array a consisting of n non-negative integers. It is guaranteed that a is sorted from small to large.For each operation, we generate a new array bi=ai+1\xe2\x88\x92ai for 1\xe2\x89\xa4i<n. Then we sort b from small to large, replace a with b, and decrease n by 1.After performing n\xe2\x88\x921 operations, n becomes 1. You need to output the only integer in array a (that is to say, you need to output a1)." 1900
1707A "Doremy\'s IQ" "binary search,constructive algorithms,greedy,implementation" "Doremy is asked to test n contests. Contest i can only be tested on day i. The difficulty of contest i is ai. Initially, Doremy\'s IQ is q. On day i Doremy will choose whether to test contest i or not. She can only test a contest if her current IQ is strictly greater than 0.If Doremy chooses to test contest i on day i, the following happens:   if ai>q, Doremy will feel she is not wise enough, so q decreases by 1;  otherwise, nothing changes.  If she chooses not to test a contest, nothing changes.Doremy wants to test as many contests as possible. Please give Doremy a solution." 1600
1706E "Qpwoeirut and Vertices" "binary search,data structures,dfs and similar,divide and conquer,dsu,greedy,trees" "You are given a connected undirected graph with n vertices and m edges. Vertices of the graph are numbered by integers from 1 to n and edges of the graph are numbered by integers from 1 to m.Your task is to answer q queries, each consisting of two integers l and r. The answer to each query is the smallest non-negative integer k such that the following condition holds:   For all pairs of integers (a,b) such that l\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4r, vertices a and b are reachable from one another using only the first k edges (that is, edges 1,2,\xe2\x80\xa6,k)." 2300
1706D2 "Chopping Carrots (Hard Version)" "brute force,constructive algorithms,data structures,dp,greedy,math,number theory,two pointers" "This is the hard version of the problem. The only difference between the versions is the constraints on n, k, ai, and the sum of n over all test cases. You can make hacks only if both versions of the problem are solved.Note the unusual memory limit.You are given an array of integers a1,a2,\xe2\x80\xa6,an of length n, and an integer k.The cost of an array of integers p1,p2,\xe2\x80\xa6,pn of length n is max1\xe2\x89\xa4i\xe2\x89\xa4n(\xe2\x8c\x8aaipi\xe2\x8c\x8b)\xe2\x88\x92min1\xe2\x89\xa4i\xe2\x89\xa4n(\xe2\x8c\x8aaipi\xe2\x8c\x8b).Here, \xe2\x8c\x8axy\xe2\x8c\x8b denotes the integer part of the division of x by y. Find the minimum cost of an array p such that 1\xe2\x89\xa4pi\xe2\x89\xa4k for all 1\xe2\x89\xa4i\xe2\x89\xa4n." 2400
1706D1 "Chopping Carrots (Easy Version)" "binary search,brute force,constructive algorithms,greedy,number theory" "This is the easy version of the problem. The only difference between the versions is the constraints on n, k, ai, and the sum of n over all test cases. You can make hacks only if both versions of the problem are solved.Note the unusual memory limit.You are given an array of integers a1,a2,\xe2\x80\xa6,an of length n, and an integer k.The cost of an array of integers p1,p2,\xe2\x80\xa6,pn of length n is max1\xe2\x89\xa4i\xe2\x89\xa4n(\xe2\x8c\x8aaipi\xe2\x8c\x8b)\xe2\x88\x92min1\xe2\x89\xa4i\xe2\x89\xa4n(\xe2\x8c\x8aaipi\xe2\x8c\x8b).Here, \xe2\x8c\x8axy\xe2\x8c\x8b denotes the integer part of the division of x by y. Find the minimum cost of an array p such that 1\xe2\x89\xa4pi\xe2\x89\xa4k for all 1\xe2\x89\xa4i\xe2\x89\xa4n." 1700
1706C "Qpwoeirut And The City" dp,flows,greedy,implementation "Qpwoeirut has taken up architecture and ambitiously decided to remodel his city.Qpwoeirut\'s city can be described as a row of n buildings, the i-th (1\xe2\x89\xa4i\xe2\x89\xa4n) of which is hi floors high. You can assume that the height of every floor in this problem is equal. Therefore, building i is taller than the building j if and only if the number of floors hi in building i is larger than the number of floors hj in building j.Building i is cool if it is taller than both building i\xe2\x88\x921 and building i+1 (and both of them exist). Note that neither the 1-st nor the n-th building can be cool.To remodel the city, Qpwoeirut needs to maximize the number of cool buildings. To do this, Qpwoeirut can build additional floors on top of any of the buildings to make them taller. Note that he cannot remove already existing floors.Since building new floors is expensive, Qpwoeirut wants to minimize the number of floors he builds. Find the minimum number of floors Qpwoeirut needs to build in order to maximize the number of cool buildings." 1400
