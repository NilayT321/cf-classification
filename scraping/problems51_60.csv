1137D "Cooperative Game" "constructive algorithms,interactive,number theory" "This is an interactive problem.Misha likes to play cooperative games with incomplete information. Today he suggested ten his friends to play a cooperative game ""Lake"".Misha has already come up with a field for the upcoming game. The field for this game is a directed graph consisting of two parts. The first part is a road along the coast of the lake which is a cycle of c vertices. The second part is a path from home to the lake which is a chain of t vertices, and there is an edge from the last vertex of this chain to the vertex of the road along the coast which has the most beautiful view of the lake, also known as the finish vertex. Misha decided to keep the field secret, so nobody knows neither t nor c.  Note that each vertex of the field has exactly one outgoing edge and all the vertices except the home vertex and the finish vertex have exactly one ingoing edge. The home vertex has no incoming edges, the finish vertex has two incoming edges.At the beginning of the game pieces of all the ten players, indexed with consecutive integers from 0 to 9, are at the home vertex. After that on each turn some of the players can ask Misha to simultaneously move their pieces along the corresponding edges. Misha will not answer more than q such queries. After each move Misha will tell players whose pieces are at the same vertices and whose pieces are at different vertices.The goal of the game is to move all the pieces to the finish vertex. Misha\'s friends have no idea how to win in such a game without knowledge of c, t and q, but luckily they are your friends. Help them: coordinate their actions to win the game. Misha has drawn such a field that 1\xe2\x89\xa4t,c, (t+c)\xe2\x89\xa41000 and q=3\xe2\x8b\x85(t+c)." 2400
1137C "Museums Tour" dp,graphs,implementation "In the country N, there are n cities connected by m one-way roads. Although this country seems unremarkable, there are two interesting facts about it. At first, a week lasts d days here. At second, there is exactly one museum in each city of the country N.Travel agency ""Open museums"" is developing a new program for tourists interested in museums. Agency\'s employees know which days each of the museums is open. The tour should start in the capital \xe2\x80\x94 the city number 1, and the first day of the tour must be on the first day of a week. Each day a tourist will be in some city, watching the exposition in its museum (in case museum is open today), and by the end of the day, the tour either ends or the tourist goes into another city connected by a road with the current one. The road system of N is designed in such a way that traveling by a road always takes one night and also all the roads are one-way. It\'s allowed to visit a city multiple times during the trip.You should develop such route for the trip that the number of distinct museums, possible to visit during it, is maximum." 2500
1137B "Camp Schedule" greedy,hashing,strings "The new camp by widely-known over the country Spring Programming Camp is going to start soon. Hence, all the team of friendly curators and teachers started composing the camp\'s schedule. After some continuous discussion, they came up with a schedule s, which can be represented as a binary string, in which the i-th symbol is \'1\' if students will write the contest in the i-th day and \'0\' if they will have a day off.At the last moment Gleb said that the camp will be the most productive if it runs with the schedule t (which can be described in the same format as schedule s). Since the number of days in the current may be different from number of days in schedule t, Gleb required that the camp\'s schedule must be altered so that the number of occurrences of t in it as a substring is maximum possible. At the same time, the number of contest days and days off shouldn\'t change, only their order may change.Could you rearrange the schedule in the best possible way?" 1600
1137A Skyscrapers implementation,sortings "Dora loves adventures quite a lot. During some journey she encountered an amazing city, which is formed by n streets along the Eastern direction and m streets across the Southern direction. Naturally, this city has nm intersections. At any intersection of i-th Eastern street and j-th Southern street there is a monumental skyscraper. Dora instantly became curious and decided to explore the heights of the city buildings.When Dora passes through the intersection of the i-th Eastern and j-th Southern street she examines those two streets. After Dora learns the heights of all the skyscrapers on those two streets she wonders: how one should reassign heights to the skyscrapers on those two streets, so that the maximum height would be as small as possible and the result of comparing the heights of any two skyscrapers on one street wouldn\'t change.Formally, on every of nm intersections Dora solves an independent problem. She sees n+m\xe2\x88\x921 skyscrapers and for each of them she knows its real height. Moreover, any two heights can be compared to get a result ""greater"", ""smaller"" or ""equal"". Now Dora wants to select some integer x and assign every skyscraper a height from 1 to x. When assigning heights, Dora wants to preserve the relative order of the skyscrapers in both streets. That is, the result of any comparison of heights of two skyscrapers in the current Eastern street shouldn\'t change and the result of any comparison of heights of two skyscrapers in current Southern street shouldn\'t change as well. Note that skyscrapers located on the Southern street are not compared with skyscrapers located on the Eastern street only. However, the skyscraper located at the streets intersection can be compared with both Southern and Eastern skyscrapers. For every intersection Dora wants to independently calculate the minimum possible x.For example, if the intersection and the two streets corresponding to it look as follows:  Then it is optimal to replace the heights of the skyscrapers as follows (note that all comparisons ""less"", ""equal"", ""greater"" inside the Eastern street and inside the Southern street are preserved)  The largest used number is 5, hence the answer for this intersection would be 5.Help Dora to compute the answers for each intersection." 1600
1136E "Nastya Hasn\'t Written a Legend" "binary search,data structures" "In this task, Nastya asked us to write a formal statement.An array a of length n and an array k of length n\xe2\x88\x921 are given. Two types of queries should be processed:   increase ai by x. Then if ai+1<ai+ki, ai+1 becomes exactly ai+ki; again, if ai+2<ai+1+ki+1, ai+2 becomes exactly ai+1+ki+1, and so far for ai+3, ..., an;  print the sum of the contiguous subarray from the l-th element to the r-th element of the array a. It\'s guaranteed that initially ai+ki\xe2\x89\xa4ai+1 for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921." 2200
1136D "Nastya Is Buying Lunch" greedy "At the big break Nastya came to the school dining room. There are n pupils in the school, numbered from 1 to n. Unfortunately, Nastya came pretty late, so that all pupils had already stood in the queue, i.e. Nastya took the last place in the queue. Of course, it\'s a little bit sad for Nastya, but she is not going to despond because some pupils in the queue can agree to change places with some other pupils.Formally, there are some pairs u, v such that if the pupil with number u stands directly in front of the pupil with number v, Nastya can ask them and they will change places. Nastya asks you to find the maximal number of places in queue she can move forward." 1800
1136C "Nastya Is Transposing Matrices" "constructive algorithms,sortings" "Nastya came to her informatics lesson, and her teacher who is, by the way, a little bit famous here gave her the following task.Two matrices A and B are given, each of them has size n\xc3\x97m. Nastya can perform the following operation to matrix A unlimited number of times:   take any square square submatrix of A and transpose it (i.e. the element of the submatrix which was in the i-th row and j-th column of the submatrix will be in the j-th row and i-th column after transposing, and the transposed submatrix itself will keep its place in the matrix A). Nastya\'s task is to check whether it is possible to transform the matrix A to the matrix B.  Example of the operation As it may require a lot of operations, you are asked to answer this question for Nastya.A square submatrix of matrix M is a matrix which consist of all elements which comes from one of the rows with indeces x,x+1,\xe2\x80\xa6,x+k\xe2\x88\x921 of matrix M and comes from one of the columns with indeces y,y+1,\xe2\x80\xa6,y+k\xe2\x88\x921 of matrix M. k is the size of square submatrix. In other words, square submatrix is the set of elements of source matrix which form a solid square (i.e. without holes)." 1500
1136B "Nastya Is Playing Computer Games" "constructive algorithms,math" "Finished her homework, Nastya decided to play computer games. Passing levels one by one, Nastya eventually faced a problem. Her mission is to leave a room, where a lot of monsters live, as quickly as possible.There are n manholes in the room which are situated on one line, but, unfortunately, all the manholes are closed, and there is one stone on every manhole. There is exactly one coin under every manhole, and to win the game Nastya should pick all the coins. Initially Nastya stands near the k-th manhole from the left. She is thinking what to do.In one turn, Nastya can do one of the following:   if there is at least one stone on the manhole Nastya stands near, throw exactly one stone from it onto any other manhole (yes, Nastya is strong).  go to a neighboring manhole;  if there are no stones on the manhole Nastya stays near, she can open it and pick the coin from it. After it she must close the manhole immediately (it doesn\'t require additional moves).   The figure shows the intermediate state of the game. At the current position Nastya can throw the stone to any other manhole or move left or right to the neighboring manholes. If she were near the leftmost manhole, she could open it (since there are no stones on it). Nastya can leave the room when she picks all the coins. Monsters are everywhere, so you need to compute the minimum number of moves Nastya has to make to pick all the coins.Note one time more that Nastya can open a manhole only when there are no stones onto it." 1000
1136A "Nastya Is Reading a Book" implementation "After lessons Nastya decided to read a book. The book contains n chapters, going one after another, so that one page of the book belongs to exactly one chapter and each chapter contains at least one page.Yesterday evening Nastya did not manage to finish reading the book, so she marked the page with number k as the first page which was not read (i.e. she read all pages from the 1-st to the (k\xe2\x88\x921)-th).The next day Nastya\'s friend Igor came and asked her, how many chapters remain to be read by Nastya? Nastya is too busy now, so she asks you to compute the number of chapters she has not completely read yet (i.e. the number of chapters she has not started to read or has finished reading somewhere in the middle)." 800
1133F2 "Spanning Tree with One Fixed Degree" "constructive algorithms,dfs and similar,dsu,graphs,greedy" "You are given an undirected unweighted connected graph consisting of n vertices and m edges. It is guaranteed that there are no self-loops or multiple edges in the given graph.Your task is to find any spanning tree of this graph such that the degree of the first vertex (vertex with label 1 on it) is equal to D (or say that there are no such spanning trees). Recall that the degree of a vertex is the number of edges incident to it." 1900
1133F1 "Spanning Tree with Maximum Degree" graphs "You are given an undirected unweighted connected graph consisting of n vertices and m edges. It is guaranteed that there are no self-loops or multiple edges in the given graph.Your task is to find any spanning tree of this graph such that the maximum degree over all vertices is maximum possible. Recall that the degree of a vertex is the number of edges incident to it." 1600
1133E "K Balanced Teams" "dp,sortings,two pointers" "You are a coach at your local university. There are n students under your supervision, the programming skill of the i-th student is ai.You have to form k teams for yet another new programming competition. As you know, the more students are involved in competition the more probable the victory of your university is! So you have to form no more than k (and at least one) non-empty teams so that the total number of students in them is maximized. But you also know that each team should be balanced. It means that the programming skill of each pair of students in each team should differ by no more than 5. Teams are independent from one another (it means that the difference between programming skills of two students from two different teams does not matter).It is possible that some students not be included in any team at all.Your task is to report the maximum possible total number of students in no more than k (and at least one) non-empty balanced teams.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1800
1133D "Zero Quantity Maximization" "hashing,math,number theory" "You are given two arrays a and b, each contains n integers.You want to create a new array c as follows: choose some real (i.e. not necessarily integer) number d, and then for every i\xe2\x88\x88[1,n] let ci:=d\xe2\x8b\x85ai+bi.Your goal is to maximize the number of zeroes in array c. What is the largest possible answer, if you choose d optimally?" 1500
1133C "Balanced Team" "sortings,two pointers" "You are a coach at your local university. There are n students under your supervision, the programming skill of the i-th student is ai.You have to create a team for a new programming competition. As you know, the more students some team has the more probable its victory is! So you have to create a team with the maximum number of students. But you also know that a team should be balanced. It means that the programming skill of each pair of students in a created team should differ by no more than 5.Your task is to report the maximum possible number of students in a balanced team." 1200
1133B "Preparation for International Women\'s Day" "math,number theory" "International Women\'s Day is coming soon! Polycarp is preparing for the holiday.There are n candy boxes in the shop for sale. The i-th box contains di candies.Polycarp wants to prepare the maximum number of gifts for k girls. Each gift will consist of exactly two boxes. The girls should be able to share each gift equally, so the total amount of candies in a gift (in a pair of boxes) should be divisible by k. In other words, two boxes i and j (i\xe2\x89\xa0j) can be combined as a gift if di+dj is divisible by k.How many boxes will Polycarp be able to give? Of course, each box can be a part of no more than one gift. Polycarp cannot use boxes ""partially"" or redistribute candies between them." 1200
1133A "Middle of the Contest" implementation "Polycarp is going to participate in the contest. It starts at h1:m1 and ends at h2:m2. It is guaranteed that the contest lasts an even number of minutes (i.e. m1%2=m2%2, where x%y is x modulo y). It is also guaranteed that the entire contest is held during a single day. And finally it is guaranteed that the contest lasts at least two minutes.Polycarp wants to know the time of the midpoint of the contest. For example, if the contest lasts from 10:00 to 11:00 then the answer is 10:30, if the contest lasts from 11:10 to 11:12 then the answer is 11:11." 1000
1132G "Greedy Subsequences" "data structures,dp,trees" "For some array c, let\'s denote a greedy subsequence as a sequence of indices p1, p2, ..., pl such that 1\xe2\x89\xa4p1<p2<\xe2\x8b\xaf<pl\xe2\x89\xa4|c|, and for each i\xe2\x88\x88[1,l\xe2\x88\x921], pi+1 is the minimum number such that pi+1>pi and c[pi+1]>c[pi].You are given an array a1,a2,\xe2\x80\xa6,an. For each its subsegment of length k, calculate the length of its longest greedy subsequence." 2400
1132F "Clear the String" dp "You are given a string s of length n consisting of lowercase Latin letters. You may apply some operations to this string: in one operation you can delete some contiguous substring of this string, if all letters in the substring you delete are equal. For example, after deleting substring bbbb from string abbbbaccdd we get the string aaccdd.Calculate the minimum number of operations to delete the whole string s." 2000
1132E Knapsack "dfs and similar,dp,greedy" "You have a set of items, each having some integer weight not greater than 8. You denote that a subset of items is good if total weight of items in the subset does not exceed W.You want to calculate the maximum possible weight of a good subset of items. Note that you have to consider the empty set and the original set when calculating the answer." 2300
1132D "Stressful Training" "binary search,greedy" "Berland SU holds yet another training contest for its students today. n students came, each of them brought his laptop. However, it turned out that everyone has forgot their chargers!Let students be numbered from 1 to n. Laptop of the i-th student has charge ai at the beginning of the contest and it uses bi of charge per minute (i.e. if the laptop has c charge at the beginning of some minute, it becomes c\xe2\x88\x92bi charge at the beginning of the next minute). The whole contest lasts for k minutes.Polycarp (the coach of Berland SU) decided to buy a single charger so that all the students would be able to successfully finish the contest. He buys the charger at the same moment the contest starts.Polycarp can choose to buy the charger with any non-negative (zero or positive) integer power output. The power output is chosen before the purchase, it can\'t be changed afterwards. Let the chosen power output be x. At the beginning of each minute (from the minute contest starts to the last minute of the contest) he can plug the charger into any of the student\'s laptops and use it for some integer number of minutes. If the laptop is using bi charge per minute then it will become bi\xe2\x88\x92x per minute while the charger is plugged in. Negative power usage rate means that the laptop\'s charge is increasing. The charge of any laptop isn\'t limited, it can become infinitely large. The charger can be plugged in no more than one laptop at the same time.The student successfully finishes the contest if the charge of his laptop never is below zero at the beginning of some minute (from the minute contest starts to the last minute of the contest, zero charge is allowed). The charge of the laptop of the minute the contest ends doesn\'t matter.Help Polycarp to determine the minimal possible power output the charger should have so that all the students are able to successfully finish the contest. Also report if no such charger exists." 2300
1132C "Painting the Fence" "brute force" "You have a long fence which consists of n sections. Unfortunately, it is not painted, so you decided to hire q painters to paint it. i-th painter will paint all sections x such that li\xe2\x89\xa4x\xe2\x89\xa4ri.Unfortunately, you are on a tight budget, so you may hire only q\xe2\x88\x922 painters. Obviously, only painters you hire will do their work.You want to maximize the number of painted sections if you choose q\xe2\x88\x922 painters optimally. A section is considered painted if at least one painter paints it." 1700
1132B Discounts greedy,sortings "You came to a local shop and want to buy some chocolate bars. There are n bars in the shop, i-th of them costs ai coins (and you want to buy all of them).You have m different coupons that allow you to buy chocolate bars. i-th coupon allows you to buy qi chocolate bars while you have to pay only for the qi\xe2\x88\x921 most expensive ones (so, the cheapest bar of those qi bars is for free).You can use only one coupon; if you use coupon i, you have to choose qi bars and buy them using the coupon, and buy all the remaining n\xe2\x88\x92qi bars without any discounts.To decide which coupon to choose, you want to know what will be the minimum total amount of money you have to pay if you use one of the coupons optimally." 900
1132A "Regular Bracket Sequence" greedy,implementation "A string is called bracket sequence if it does not contain any characters other than ""("" and "")"". A bracket sequence is called regular if it it is possible to obtain correct arithmetic expression by inserting characters ""+"" and ""1"" into this sequence. For example, """", ""(())"" and ""()()"" are regular bracket sequences; ""))"" and "")(("" are bracket sequences (but not regular ones), and ""(a)"" and ""(1)+(1)"" are not bracket sequences at all.You have a number of strings; each string is a bracket sequence of length 2. So, overall you have cnt1 strings ""(("", cnt2 strings ""()"", cnt3 strings "")("" and cnt4 strings ""))"". You want to write all these strings in some order, one after another; after that, you will get a long bracket sequence of length 2(cnt1+cnt2+cnt3+cnt4). You wonder: is it possible to choose some order of the strings you have such that you will get a regular bracket sequence? Note that you may not remove any characters or strings, and you may not add anything either." 1100
1131G "Most Dangerous Shark" "data structures,dp,two pointers" "Semyon participates in the most prestigious competition of the world ocean for the title of the most dangerous shark. During this competition sharks compete in different subjects: speed swimming, masking, map navigation and many others. Now Semyon is taking part in \xc2\xabdestruction\xc2\xbb contest.During it, m dominoes are placed in front of the shark. All dominoes are on the same line, but the height of the dominoes may vary. The distance between adjacent dominoes is 1. Moreover, each Domino has its own cost value, expressed as an integer. The goal is to drop all the dominoes. To do this, the shark can push any domino to the left or to the right, and it will begin falling in this direction. If during the fall the domino touches other dominoes, they will also start falling in the same direction in which the original domino is falling, thus beginning a chain reaction, as a result of which many dominoes can fall. A falling domino touches another one, if and only if the distance between them was strictly less than the height of the falling domino, the dominoes do not necessarily have to be adjacent.Of course, any shark can easily drop all the dominoes in this way, so the goal is not to drop all the dominoes, but do it with a minimum cost. The cost of the destruction is the sum of the costs of dominoes that the shark needs to push to make all the dominoes fall.Simon has already won in the previous subjects, but is not smart enough to win in this one. Help Semyon and determine the minimum total cost of the dominoes he will have to push to make all the dominoes fall." 2700
1131F "Asya And Kittens" "constructive algorithms,dsu" "Asya loves animals very much. Recently, she purchased n kittens, enumerated them from 1 and n and then put them into the cage. The cage consists of one row of n cells, enumerated with integers from 1 to n from left to right. Adjacent cells had a partially transparent partition wall between them, hence there were n\xe2\x88\x921 partitions originally. Initially, each cell contained exactly one kitten with some number.Observing the kittens, Asya noticed, that they are very friendly and often a pair of kittens in neighboring cells wants to play together. So Asya started to remove partitions between neighboring cells. In particular, on the day i, Asya:  Noticed, that the kittens xi and yi, located in neighboring cells want to play together.  Removed the partition between these two cells, efficiently creating a single cell, having all kittens from two original cells. Since Asya has never putted partitions back, after n\xe2\x88\x921 days the cage contained a single cell, having all kittens.For every day, Asya remembers numbers of kittens xi and yi, who wanted to play together, however she doesn\'t remember how she placed kittens in the cage in the beginning. Please help her and find any possible initial arrangement of the kittens into n cells." 1700
1131E "String Multiplication" dp,greedy,strings "Roman and Denis are on the trip to the programming competition. Since the trip was long, they soon got bored, and hence decided to came up with something. Roman invented a pizza\'s recipe, while Denis invented a string multiplication. According to Denis, the result of multiplication (product) of strings s of length m and t is a string t+s1+t+s2+\xe2\x80\xa6+t+sm+t, where si denotes the i-th symbol of the string s, and ""+"" denotes string concatenation. For example, the product of strings ""abc"" and ""de"" is a string ""deadebdecde"", while the product of the strings ""ab"" and ""z"" is a string ""zazbz"". Note, that unlike the numbers multiplication, the product of strings s and t is not necessarily equal to product of t and s.Roman was jealous of Denis, since he invented such a cool operation, and hence decided to invent something string-related too. Since Roman is beauty-lover, he decided to define the beauty of the string as the length of the longest substring, consisting of only one letter. For example, the beauty of the string ""xayyaaabca"" is equal to 3, since there is a substring ""aaa"", while the beauty of the string ""qwerqwer"" is equal to 1, since all neighboring symbols in it are different.In order to entertain Roman, Denis wrote down n strings p1,p2,p3,\xe2\x80\xa6,pn on the paper and asked him to calculate the beauty of the string (\xe2\x80\xa6(((p1\xe2\x8b\x85p2)\xe2\x8b\x85p3)\xe2\x8b\x85\xe2\x80\xa6)\xe2\x8b\x85pn, where s\xe2\x8b\x85t denotes a multiplication of strings s and t. Roman hasn\'t fully realized how Denis\'s multiplication works, so he asked you for a help. Denis knows, that Roman is very impressionable, he guarantees, that the beauty of the resulting string is at most 109." 2300
1131D "Gourmet choice" "dfs and similar,dp,dsu,graphs,greedy" "Mr. Apple, a gourmet, works as editor-in-chief of a gastronomic periodical. He travels around the world, tasting new delights of famous chefs from the most fashionable restaurants. Mr. Apple has his own signature method of review  \xe2\x80\x94 in each restaurant Mr. Apple orders two sets of dishes on two different days. All the dishes are different, because Mr. Apple doesn\'t like to eat the same food. For each pair of dishes from different days he remembers exactly which was better, or that they were of the same quality. After this the gourmet evaluates each dish with a positive integer.Once, during a revision of a restaurant of Celtic medieval cuisine named \xc2\xabPoisson\xc2\xbb, that serves chestnut soup with fir, warm soda bread, spicy lemon pie and other folk food, Mr. Apple was very pleasantly surprised the gourmet with its variety of menu, and hence ordered too much. Now he\'s confused about evaluating dishes.The gourmet tasted a set of n dishes on the first day and a set of m dishes on the second day. He made a table a of size n\xc3\x97m, in which he described his impressions. If, according to the expert, dish i from the first set was better than dish j from the second set, then aij is equal to "">"", in the opposite case aij is equal to ""<"". Dishes also may be equally good, in this case aij is ""="".Now Mr. Apple wants you to help him to evaluate every dish. Since Mr. Apple is very strict, he will evaluate the dishes so that the maximal number used is as small as possible. But Mr. Apple also is very fair, so he never evaluates the dishes so that it goes against his feelings. In other words, if aij is ""<"", then the number assigned to dish i from the first set should be less than the number of dish j from the second set, if aij is "">"", then it should be greater, and finally if aij is ""="", then the numbers should be the same.Help Mr. Apple to evaluate each dish from both sets so that it is consistent with his feelings, or determine that this is impossible." 2000
1131C Birthday "binary search,greedy,sortings" "Cowboy Vlad has a birthday today! There are n children who came to the celebration. In order to greet Vlad, the children decided to form a circle around him. Among the children who came, there are both tall and low, so if they stand in a circle arbitrarily, it may turn out, that there is a tall and low child standing next to each other, and it will be difficult for them to hold hands. Therefore, children want to stand in a circle so that the maximum difference between the growth of two neighboring children would be minimal possible.Formally, let\'s number children from 1 to n in a circle order, that is, for every i child with number i will stand next to the child with number i+1, also the child with number 1 stands next to the child with number n. Then we will call the discomfort of the circle the maximum absolute difference of heights of the children, who stand next to each other.Please help children to find out how they should reorder themselves, so that the resulting discomfort is smallest possible." 1200
1131B Draw! greedy,implementation "You still have partial information about the score during the historic football match. You are given a set of pairs (ai,bi), indicating that at some point during the match the score was ""ai: bi"". It is known that if the current score is \xc2\xabx:y\xc2\xbb, then after the goal it will change to ""x+1:y"" or ""x:y+1"". What is the largest number of times a draw could appear on the scoreboard?The pairs ""ai:bi"" are given in chronological order (time increases), but you are given score only for some moments of time. The last pair corresponds to the end of the match." 1400
1131A "Sea Battle" math "In order to make the ""Sea Battle"" game more interesting, Boris decided to add a new ship type to it. The ship consists of two rectangles. The first rectangle has a width of w1 and a height of h1, while the second rectangle has a width of w2 and a height of h2, where w1\xe2\x89\xa5w2. In this game, exactly one ship is used, made up of two rectangles. There are no other ships on the field.The rectangles are placed on field in the following way:  the second rectangle is on top the first rectangle;  they are aligned to the left, i.e. their left sides are on the same line;  the rectangles are adjacent to each other without a gap. See the pictures in the notes: the first rectangle is colored red, the second rectangle is colored blue.Formally, let\'s introduce a coordinate system. Then, the leftmost bottom cell of the first rectangle has coordinates (1,1), the rightmost top cell of the first rectangle has coordinates (w1,h1), the leftmost bottom cell of the second rectangle has coordinates (1,h1+1) and the rightmost top cell of the second rectangle has coordinates (w2,h1+h2).After the ship is completely destroyed, all cells neighboring by side or a corner with the ship are marked. Of course, only cells, which don\'t belong to the ship are marked. On the pictures in the notes such cells are colored green.Find out how many cells should be marked after the ship is destroyed. The field of the game is infinite in any direction." 800
1130C Connect "brute force,dfs and similar,dsu" "Alice lives on a flat planet that can be modeled as a square grid of size n\xc3\x97n, with rows and columns enumerated from 1 to n. We represent the cell at the intersection of row r and column c with ordered pair (r,c). Each cell in the grid is either land or water.  An example planet with n=5. It also appears in the first sample test. Alice resides in land cell (r1,c1). She wishes to travel to land cell (r2,c2). At any moment, she may move to one of the cells adjacent to where she is\xe2\x80\x94in one of the four directions (i.e., up, down, left, or right).Unfortunately, Alice cannot swim, and there is no viable transportation means other than by foot (i.e., she can walk only on land). As a result, Alice\'s trip may be impossible.To help Alice, you plan to create at most one tunnel between some two land cells. The tunnel will allow Alice to freely travel between the two endpoints. Indeed, creating a tunnel is a lot of effort: the cost of creating a tunnel between cells (rs,cs) and (rt,ct) is (rs\xe2\x88\x92rt)2+(cs\xe2\x88\x92ct)2.For now, your task is to find the minimum possible cost of creating at most one tunnel so that Alice could travel from (r1,c1) to (r2,c2). If no tunnel needs to be created, the cost is 0." 1400
1130B "Two Cakes" greedy "Sasha and Dima want to buy two n-tier cakes. Each cake should consist of n different tiers: from the size of 1 to the size of n. Tiers should go in order from the smallest to the biggest (from top to bottom).They live on the same street, there are 2\xe2\x8b\x85n houses in a row from left to right. Each house has a pastry shop where you can buy a cake tier. Unfortunately, in each pastry shop you can buy only one tier of only one specific size: in the i-th house you can buy a tier of the size ai (1\xe2\x89\xa4ai\xe2\x89\xa4n).Since the guys carry already purchased tiers, and it is impossible to insert a new tier in the middle of the cake, they agreed to buy tiers from the smallest to the biggest. That is, each of them buys tiers in order: 1, then 2, then 3 and so on up to n.Initially, Sasha and Dima are located near the first (leftmost) house. Output the minimum distance that they will have to walk in total to buy both cakes. The distance between any two neighboring houses is exactly 1." 1200
1130A "Be Positive" implementation "You are given an array of n integers: a1,a2,\xe2\x80\xa6,an. Your task is to find some non-zero integer d (\xe2\x88\x92103\xe2\x89\xa4d\xe2\x89\xa4103) such that, after each number in the array is divided by d, the number of positive numbers that are presented in the array is greater than or equal to half of the array size (i.e., at least \xe2\x8c\x88n2\xe2\x8c\x89). Note that those positive numbers do not need to be an integer (e.g., a 2.5 counts as a positive number). If there are multiple values of d that satisfy the condition, you may print any of them. In case that there is no such d, print a single integer 0.Recall that \xe2\x8c\x88x\xe2\x8c\x89 represents the smallest integer that is not less than x and that zero (0) is neither positive nor negative." 800
1129E "Legendary Tree" "binary search,interactive,trees" "This is an interactive problem.A legendary tree rests deep in the forest. Legend has it that individuals who realize this tree would eternally become a Legendary Grandmaster.To help you determine the tree, Mikaela the Goddess has revealed to you that the tree contains n vertices, enumerated from 1 through n. She also allows you to ask her some questions as follows. For each question, you should tell Mikaela some two disjoint non-empty sets of vertices S and T, along with any vertex v that you like. Then, Mikaela will count and give you the number of pairs of vertices (s,t) where s\xe2\x88\x88S and t\xe2\x88\x88T such that the simple path from s to t contains v.Mikaela the Goddess is busy and will be available to answer at most 11111 questions.This is your only chance. Your task is to determine the tree and report its edges." 3100
1129D Isolation "data structures,dp" "Find the number of ways to divide an array a of n integers into any number of disjoint non-empty segments so that, in each segment, there exist at most k distinct integers that appear exactly once.Since the answer can be large, find it modulo 998244353." 2900
1129C "Morse Code" "binary search,data structures,dp,hashing,sortings,string suffix structures,strings" "In Morse code, an letter of English alphabet is represented as a string of some length from 1 to 4. Moreover, each Morse code representation of an English letter contains only dots and dashes. In this task, we will represent a dot with a ""0"" and a dash with a ""1"".Because there are 21+22+23+24=30 strings with length 1 to 4 containing only ""0"" and/or ""1"", not all of them correspond to one of the 26 English letters. In particular, each string of ""0"" and/or ""1"" of length at most 4 translates into a distinct English letter, except the following four strings that do not correspond to any English alphabet: ""0011"", ""0101"", ""1110"", and ""1111"".You will work with a string S, which is initially empty. For m times, either a dot or a dash will be appended to S, one at a time. Your task is to find and report, after each of these modifications to string S, the number of non-empty sequences of English letters that are represented with some substring of S in Morse code.Since the answers can be incredibly tremendous, print them modulo 109+7." 2400
1129B "Wrong Answer" "constructive algorithms" "Consider the following problem: given an array a containing n integers (indexed from 0 to n\xe2\x88\x921), find max0\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n\xe2\x88\x921\xe2\x88\x91l\xe2\x89\xa4i\xe2\x89\xa4r(r\xe2\x88\x92l+1)\xe2\x8b\x85ai. In this problem, 1\xe2\x89\xa4n\xe2\x89\xa42000 and |ai|\xe2\x89\xa4106.In an attempt to solve the problem described, Alice quickly came up with a blazing-fast greedy algorithm and coded it. Her implementation in pseudocode is as follows:function find_answer(n, a)    # Assumes n is an integer between 1 and 2000, inclusive    # Assumes a is a list containing n integers: a[0], a[1], ..., a[n-1]    res = 0    cur = 0    k = -1    for i = 0 to i = n-1        cur = cur + a[i]        if cur < 0            cur = 0            k = i        res = max(res, (i-k)*cur)    return resAlso, as you can see, Alice\'s idea is not entirely correct. For example, suppose n=4 and a=[6,\xe2\x88\x928,7,\xe2\x88\x9242]. Then, find_answer(n, a) would return 7, but the correct answer is 3\xe2\x8b\x85(6\xe2\x88\x928+7)=15.You told Alice that her solution is incorrect, but she did not believe what you said.Given an integer k, you are to find any sequence a of n integers such that the correct answer and the answer produced by Alice\'s algorithm differ by exactly k. Note that although the choice of n and the content of the sequence is yours, you must still follow the constraints earlier given: that 1\xe2\x89\xa4n\xe2\x89\xa42000 and that the absolute value of each element does not exceed 106. If there is no such sequence, determine so." 2000
1129A2 "Toy Train" "brute force,greedy" "Alice received a set of Toy Train\xe2\x84\xa2 from Bob. It consists of one train and a connected railway network of n stations, enumerated from 1 through n. The train occupies one station at a time and travels around the network of stations in a circular manner. More precisely, the immediate station that the train will visit after station i is station i+1 if 1\xe2\x89\xa4i<n or station 1 if i=n. It takes the train 1 second to travel to its next station as described.Bob gave Alice a fun task before he left: to deliver m candies that are initially at some stations to their independent destinations using the train. The candies are enumerated from 1 through m. Candy i (1\xe2\x89\xa4i\xe2\x89\xa4m), now at station ai, should be delivered to station bi (ai\xe2\x89\xa0bi).  The blue numbers on the candies correspond to bi values. The image corresponds to the 1-st example. The train has infinite capacity, and it is possible to load off any number of candies at a station. However, only at most one candy can be loaded from a station onto the train before it leaves the station. You can choose any candy at this station. The time it takes to move the candies is negligible.Now, Alice wonders how much time is needed for the train to deliver all candies. Your task is to find, for each station, the minimum time the train would need to deliver all the candies were it to start from there." 1800
1129A1 "Toy Train (Simplified)" "brute force,greedy" "This is a simplified version of the task Toy Train. These two versions differ only in the constraints. Hacks for this version are disabled.Alice received a set of Toy Train\xe2\x84\xa2 from Bob. It consists of one train and a connected railway network of n stations, enumerated from 1 through n. The train occupies one station at a time and travels around the network of stations in a circular manner. More precisely, the immediate station that the train will visit after station i is station i+1 if 1\xe2\x89\xa4i<n or station 1 if i=n. It takes the train 1 second to travel to its next station as described.Bob gave Alice a fun task before he left: to deliver m candies that are initially at some stations to their independent destinations using the train. The candies are enumerated from 1 through m. Candy i (1\xe2\x89\xa4i\xe2\x89\xa4m), now at station ai, should be delivered to station bi (ai\xe2\x89\xa0bi).  The blue numbers on the candies correspond to bi values. The image corresponds to the 1-st example. The train has infinite capacity, and it is possible to load off any number of candies at a station. However, only at most one candy can be loaded from a station onto the train before it leaves the station. You can choose any candy at this station. The time it takes to move the candies is negligible.Now, Alice wonders how much time is needed for the train to deliver all candies. Your task is to find, for each station, the minimum time the train would need to deliver all the candies were it to start from there." 1700
1121C "System Testing" implementation "Vasya likes taking part in Codeforces contests. When a round is over, Vasya follows all submissions in the system testing tab.There are n solutions, the i-th of them should be tested on ai tests, testing one solution on one test takes 1 second. The solutions are judged in the order from 1 to n. There are k testing processes which test solutions simultaneously. Each of them can test at most one solution at a time.At any time moment t when some testing process is not judging any solution, it takes the first solution from the queue and tests it on each test in increasing order of the test ids. Let this solution have id i, then it is being tested on the first test from time moment t till time moment t+1, then on the second test till time moment t+2 and so on. This solution is fully tested at time moment t+ai, and after that the testing process immediately starts testing another solution.Consider some time moment, let there be exactly m fully tested solutions by this moment. There is a caption ""System testing: d%"" on the page with solutions, where d is calculated asd=round(100\xe2\x8b\x85mn),where round(x)=\xe2\x8c\x8ax+0.5\xe2\x8c\x8b is a function which maps every real to the nearest integer.Vasya calls a submission interesting if there is a time moment (possibly, non-integer) when the solution is being tested on some test q, and the caption says ""System testing: q%"". Find the number of interesting solutions.Please note that in case when multiple processes attempt to take the first submission from the queue at the same moment (for instance, at the initial moment), the order they take the solutions does not matter." 1600
1121B "Mike and Children" "brute force,implementation" "Mike decided to teach programming to children in an elementary school. He knows that it is not an easy task to interest children in that age to code. That is why he decided to give each child two sweets.Mike has n sweets with sizes a1,a2,\xe2\x80\xa6,an. All his sweets have different sizes. That is, there is no such pair (i,j) (1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that i\xe2\x89\xa0j and ai=aj.Since Mike has taught for many years, he knows that if he gives two sweets with sizes ai and aj to one child and ak and ap to another, where (ai+aj)\xe2\x89\xa0(ak+ap), then a child who has a smaller sum of sizes will be upset. That is, if there are two children who have different sums of sweets, then one of them will be upset. Apparently, Mike does not want somebody to be upset. Mike wants to invite children giving each of them two sweets. Obviously, he can\'t give one sweet to two or more children. His goal is to invite as many children as he can. Since Mike is busy preparing to his first lecture in the elementary school, he is asking you to find the maximum number of children he can invite giving each of them two sweets in such way that nobody will be upset." 1200
1121A "Technogoblet of Fire" implementation,sortings "Everybody knows that the m-coder Tournament will happen soon. m schools participate in the tournament, and only one student from each school participates.There are a total of n students in those schools. Before the tournament, all students put their names and the names of their schools into the Technogoblet of Fire. After that, Technogoblet selects the strongest student from each school to participate. Arkady is a hacker who wants to have k Chosen Ones selected by the Technogoblet. Unfortunately, not all of them are the strongest in their schools, but Arkady can make up some new school names and replace some names from Technogoblet with those. You can\'t use each made-up name more than once. In that case, Technogoblet would select the strongest student in those made-up schools too.You know the power of each student and schools they study in. Calculate the minimal number of schools Arkady has to make up so that k Chosen Ones would be selected by the Technogoblet." 1100
1120F "Secret Letters" "data structures,dp,greedy" "Little W and Little P decided to send letters to each other regarding the most important events during a day. There are n events during a day: at time moment ti something happens to the person pi (pi is either W or P, denoting Little W and Little P, respectively), so he needs to immediately send a letter to the other person. They can send a letter using one of the two ways:  Ask Friendly O to deliver the letter directly. Friendly O takes d acorns for each letter. Leave the letter at Wise R\'s den. Wise R values free space, so he takes c\xe2\x8b\x85T acorns for storing a letter for a time segment of length T. The recipient can take a letter from Wise R either when he leaves his own letter at Wise R\'s den, or at time moment tn+1, when everybody comes to Wise R for a tea. It is not possible to take a letter from Wise R\'s den at other time moments. The friends can store as many letters at Wise R\'s den as they want, paying for each one separately. Help the friends determine the minimum possible total cost of sending all letters." 3100
1120E "The very same Munchhausen" "brute force" "A positive integer a is given. Baron Munchausen claims that he knows such a positive integer n that if one multiplies n by a, the sum of its digits decreases a times. In other words, S(an)=S(n)/a, where S(x) denotes the sum of digits of the number x. Find out if what Baron told can be true." 2600
1120D "Power Tree" "dfs and similar,dp,dsu,graphs,greedy,trees" "You are given a rooted tree with n vertices, the root of the tree is the vertex 1. Each vertex has some non-negative price. A leaf of the tree is a non-root vertex that has degree 1.Arkady and Vasily play a strange game on the tree. The game consists of three stages. On the first stage Arkady buys some non-empty set of vertices of the tree. On the second stage Vasily puts some integers into all leaves of the tree. On the third stage Arkady can perform several (possibly none) operations of the following kind: choose some vertex v he bought on the first stage and some integer x, and then add x to all integers in the leaves in the subtree of v. The integer x can be positive, negative of zero.A leaf a is in the subtree of a vertex b if and only if the simple path between a and the root goes through b.Arkady\'s task is to make all integers in the leaves equal to zero. What is the minimum total cost s he has to pay on the first stage to guarantee his own win independently of the integers Vasily puts on the second stage? Also, we ask you to find all such vertices that there is an optimal (i.e. with cost s) set of vertices containing this one such that Arkady can guarantee his own win buying this set on the first stage." 2500
1120C "Compress String" dp,strings "Suppose you are given a string s of length n consisting of lowercase English letters. You need to compress it using the smallest possible number of coins.To compress the string, you have to represent s as a concatenation of several non-empty strings: s=t1t2\xe2\x80\xa6tk. The i-th of these strings should be encoded with one of the two ways:  if |ti|=1, meaning that the current string consists of a single character, you can encode it paying a coins;  if ti is a substring of t1t2\xe2\x80\xa6ti\xe2\x88\x921, then you can encode it paying b coins. A string x is a substring of a string y if x can be obtained from y by deletion of several (possibly, zero or all) characters from the beginning and several (possibly, zero or all) characters from the end.So your task is to calculate the minimum possible number of coins you need to spend in order to compress the given string s." 2100
1120B "Once in a casino" "constructive algorithms,greedy,implementation,math" "One player came to a casino and found a slot machine where everything depends only on how he plays. The rules follow.A positive integer a is initially on the screen. The player can put a coin into the machine and then add 1 to or subtract 1 from any two adjacent digits. All digits must remain from 0 to 9 after this operation, and the leading digit must not equal zero. In other words, it is forbidden to add 1 to 9, to subtract 1 from 0 and to subtract 1 from the leading 1. Once the number on the screen becomes equal to b, the player wins the jackpot. a and b have the same number of digits.Help the player to determine the minimal number of coins he needs to spend in order to win the jackpot and tell how to play." 2700
1120A "Diana and Liana" "greedy,implementation,two pointers" "At the first holiday in spring, the town Shortriver traditionally conducts a flower festival. Townsfolk wear traditional wreaths during these festivals. Each wreath contains exactly k flowers.The work material for the wreaths for all n citizens of Shortriver is cut from the longest flowered liana that grew in the town that year. Liana is a sequence a1, a2, ..., am, where ai is an integer that denotes the type of flower at the position i. This year the liana is very long (m\xe2\x89\xa5n\xe2\x8b\x85k), and that means every citizen will get a wreath.Very soon the liana will be inserted into a special cutting machine in order to make work material for wreaths. The machine works in a simple manner: it cuts k flowers from the beginning of the liana, then another k flowers and so on. Each such piece of k flowers is called a workpiece. The machine works until there are less than k flowers on the liana.Diana has found a weaving schematic for the most beautiful wreath imaginable. In order to weave it, k flowers must contain flowers of types b1, b2, ..., bs, while other can be of any type. If a type appears in this sequence several times, there should be at least that many flowers of that type as the number of occurrences of this flower in the sequence. The order of the flowers in a workpiece does not matter.Diana has a chance to remove some flowers from the liana before it is inserted into the cutting machine. She can remove flowers from any part of the liana without breaking liana into pieces. If Diana removes too many flowers, it may happen so that some of the citizens do not get a wreath. Could some flowers be removed from the liana so that at least one workpiece would conform to the schematic and machine would still be able to create at least n workpieces?" 1900
1119H Triple fft,math "You have received your birthday gifts \xe2\x80\x94 n triples of integers! The i-th of them is {ai,bi,ci}. All numbers are greater than or equal to 0, and strictly smaller than 2k, where k is a fixed integer.One day, you felt tired playing with triples. So you came up with three new integers x, y, z, and then formed n arrays. The i-th array consists of ai repeated x times, bi repeated y times and ci repeated z times. Thus, each array has length (x+y+z).You want to choose exactly one integer from each array such that the XOR (bitwise exclusive or) of them is equal to t. Output the number of ways to choose the numbers for each t between 0 and 2k\xe2\x88\x921, inclusive, modulo 998244353." 3200
1119G "Get Ready for the Battle" "constructive algorithms,implementation" "Recently Evlampy installed one interesting computer game, one of aspects of which is to split army into several groups and then fight with enemy\'s groups. Let us consider a simplified version of the battle.In the nearest battle Evlampy should fight an enemy army that consists of m groups, the i-th of which has hpi health points.Evlampy\'s army consists of n equal soldiers. Before each battle he should split his army in exactly m groups (possibly, empty) so that the total size of the groups is n. The battle is played step-by-step. On each step each of Evlampy\'s groups attacks exactly one enemy group. Thus, each step is described with an array of m integers a1,a2,\xe2\x80\xa6,am, meaning that the i-th Evlampy\'s group attacks the ai-th enemy group. Different groups can attack same group, on each step the array a is chosen independently.After each step the health points of each enemy group decreases by the total number of soldiers in Evlampy\'s groups that attacked this enemy group at this step. Enemy group is destroyed once its health points are zero or negative. Evlampy\'s soldiers do not lose health.  An example of a step. The numbers in green circles represent the number of soldiers in Evlampy\'s groups, the arrows represent attacks, the numbers in red circles represent health points of enemy groups, the blue numbers represent how much the health points will decrease after the step. Evlampy understands that the upcoming battle will take the whole night. He became sad because this way he won\'t have enough time to finish his homework. Now Evlampy wants you to write a program that will help him win in the smallest possible number of steps. Can you help him?In other words, find the smallest number of steps needed to destroy all enemy groups and show a possible way of doing this. Find the requires splitting of the army into m groups and the arrays a for each step." 3100
1119F "Niyaz and Small Degrees" "data structures,dp,trees" "Niyaz has a tree with n vertices numerated from 1 to n. A tree is a connected graph without cycles.Each edge in this tree has strictly positive integer weight. A degree of a vertex is the number of edges adjacent to this vertex.Niyaz does not like when vertices in the tree have too large degrees. For each x from 0 to (n\xe2\x88\x921), he wants to find the smallest total weight of a set of edges to be deleted so that degrees of all vertices become at most x." 3400
1119E "Pavel and Triangles" "brute force,dp,fft,greedy,ternary search" "Pavel has several sticks with lengths equal to powers of two.He has a0 sticks of length 20=1, a1 sticks of length 21=2, ..., an\xe2\x88\x921 sticks of length 2n\xe2\x88\x921. Pavel wants to make the maximum possible number of triangles using these sticks. The triangles should have strictly positive area, each stick can be used in at most one triangle.It is forbidden to break sticks, and each triangle should consist of exactly three sticks.Find the maximum possible number of triangles." 1900
1119D "Frets On Fire" "binary search,sortings" "Miyako came to the flea kingdom with a ukulele. She became good friends with local flea residents and played beautiful music for them every day.In return, the fleas made a bigger ukulele for her: it has n strings, and each string has (1018+1) frets numerated from 0 to 1018. The fleas use the array s1,s2,\xe2\x80\xa6,sn to describe the ukulele\'s tuning, that is, the pitch of the j-th fret on the i-th string is the integer si+j.Miyako is about to leave the kingdom, but the fleas hope that Miyako will answer some last questions for them.Each question is in the form of: ""How many different pitches are there, if we consider frets between l and r (inclusive) on all strings?""Miyako is about to visit the cricket kingdom and has no time to answer all the questions. Please help her with this task!Formally, you are given a matrix with n rows and (1018+1) columns, where the cell in the i-th row and j-th column (0\xe2\x89\xa4j\xe2\x89\xa41018) contains the integer si+j. You are to answer q queries, in the k-th query you have to answer the number of distinct integers in the matrix from the lk-th to the rk-th columns, inclusive." 1800
1119C "Ramesses and Corner Inversion" "constructive algorithms,greedy,implementation,math" "Ramesses came to university to algorithms practice, and his professor, who is a fairly known programmer, gave him the following task.You are given two matrices A and B of size n\xc3\x97m, each of which consists of 0 and 1 only. You can apply the following operation to the matrix A arbitrary number of times: take any submatrix of the matrix A that has at least two rows and two columns, and invert the values in its corners (i.e. all corners of the submatrix that contain 0, will be replaced by 1, and all corners of the submatrix that contain 1, will be replaced by 0). You have to answer whether you can obtain the matrix B from the matrix A.  An example of the operation. The chosen submatrix is shown in blue and yellow, its corners are shown in yellow. Ramesses don\'t want to perform these operations by himself, so he asks you to answer this question.A submatrix of matrix M is a matrix which consist of all elements which come from one of the rows with indices x1,x1+1,\xe2\x80\xa6,x2 of matrix M and one of the columns with indices y1,y1+1,\xe2\x80\xa6,y2 of matrix M, where x1,x2,y1,y2 are the edge rows and columns of the submatrix. In other words, a submatrix is a set of elements of source matrix which form a solid rectangle (i.e. without holes) with sides parallel to the sides of the original matrix. The corners of the submatrix are cells (x1,y1), (x1,y2), (x2,y1), (x2,y2), where the cell (i,j) denotes the cell on the intersection of the i-th row and the j-th column." 1500
1119B "Alyona and a Narrow Fridge" "binary search,flows,greedy,sortings" "Alyona has recently bought a miniature fridge that can be represented as a matrix with h rows and 2 columns. Initially there is only one shelf at the bottom of the fridge, but Alyona can install arbitrary number of shelves inside the fridge between any two rows. A shelf is two cells wide, does not occupy any space but separates the inside of the fridge to the lower and upper part.  An example of a fridge with h=7 and two shelves. The shelves are shown in black. The picture corresponds to the first example. Alyona has n bottles of milk that she wants to put in the fridge. The i-th bottle is ai cells tall and 1 cell wide. She can put a bottle on some shelf if the corresponding space above the shelf is at least as tall as the bottle. She can not put a bottle on top of another bottle (if there is no shelf between them). Two bottles can not share a cell.Alyona is interested in the largest integer k such that she can put bottles 1, 2, ..., k in the fridge at the same time. Find this largest k." 1300
1119A "Ilya and a Colorful Walk" greedy,implementation "Ilya lives in a beautiful city of Chordalsk.There are n houses on the street Ilya lives, they are numerated from 1 to n from left to right; the distance between every two neighboring houses is equal to 1 unit. The neighboring houses are 1 and 2, 2 and 3, ..., n\xe2\x88\x921 and n. The houses n and 1 are not neighboring.The houses are colored in colors c1,c2,\xe2\x80\xa6,cn so that the i-th house is colored in the color ci. Everyone knows that Chordalsk is not boring, so there are at least two houses colored in different colors.Ilya wants to select two houses i and j so that 1\xe2\x89\xa4i<j\xe2\x89\xa4n, and they have different colors: ci\xe2\x89\xa0cj. He will then walk from the house i to the house j the distance of (j\xe2\x88\x92i) units.Ilya loves long walks, so he wants to choose the houses so that the distance between them is the maximum possible.Help Ilya, find this maximum possible distance." 1100
1118F2 "Tree Cutting (Hard Version)" "combinatorics,dfs and similar,dp,trees" "You are given an undirected tree of n vertices. Some vertices are colored one of the k colors, some are uncolored. It is guaranteed that the tree contains at least one vertex of each of the k colors. There might be no uncolored vertices.You choose a subset of exactly k\xe2\x88\x921 edges and remove it from the tree. Tree falls apart into k connected components. Let\'s call this subset of edges nice if none of the resulting components contain vertices of different colors.How many nice subsets of edges are there in the given tree? Two subsets are considered different if there is some edge that is present in one subset and absent in the other.The answer may be large, so print it modulo 998244353." 2700
1118F1 "Tree Cutting (Easy Version)" "dfs and similar,trees" "You are given an undirected tree of n vertices. Some vertices are colored blue, some are colored red and some are uncolored. It is guaranteed that the tree contains at least one red vertex and at least one blue vertex.You choose an edge and remove it from the tree. Tree falls apart into two connected components. Let\'s call an edge nice if neither of the resulting components contain vertices of both red and blue colors.How many nice edges are there in the given tree?" 1800
1118E "Yet Another Ball Problem" "constructive algorithms,implementation" "The king of Berland organizes a ball! n pair are invited to the ball, they are numbered from 1 to n. Each pair consists of one man and one woman. Each dancer (either man or woman) has a monochrome costume. The color of each costume is represented by an integer from 1 to k, inclusive.Let bi be the color of the man\'s costume and gi be the color of the woman\'s costume in the i-th pair. You have to choose a color for each dancer\'s costume (i.e. values b1,b2,\xe2\x80\xa6,bn and g1,g2,\xe2\x80\xa6gn) in such a way that:  for every i: bi and gi are integers between 1 and k, inclusive;  there are no two completely identical pairs, i.e. no two indices i,j (i\xe2\x89\xa0j) such that bi=bj and gi=gj at the same time;  there is no pair such that the color of the man\'s costume is the same as the color of the woman\'s costume in this pair, i.e. bi\xe2\x89\xa0gi for every i;  for each two consecutive (adjacent) pairs both man\'s costume colors and woman\'s costume colors differ, i.e. for every i from 1 to n\xe2\x88\x921 the conditions bi\xe2\x89\xa0bi+1 and gi\xe2\x89\xa0gi+1 hold. Let\'s take a look at the examples of bad and good color choosing (for n=4 and k=3, man is the first in a pair and woman is the second):Bad color choosing:   (1,2), (2,3), (3,2), (1,2) \xe2\x80\x94 contradiction with the second rule (there are equal pairs);  (2,3), (1,1), (3,2), (1,3) \xe2\x80\x94 contradiction with the third rule (there is a pair with costumes of the same color);  (1,2), (2,3), (1,3), (2,1) \xe2\x80\x94 contradiction with the fourth rule (there are two consecutive pairs such that colors of costumes of men/women are the same). Good color choosing:   (1,2), (2,1), (1,3), (3,1);  (1,2), (3,1), (2,3), (3,2);  (3,1), (1,2), (2,3), (3,2). You have to find any suitable color choosing or say that no suitable choosing exists." 1700
1118D2 "Coffee and Coursework (Hard Version)" "binary search,greedy" "The only difference between easy and hard versions is the constraints.Polycarp has to write a coursework. The coursework consists of m pages.Polycarp also has n cups of coffee. The coffee in the i-th cup Polycarp has ai caffeine in it. Polycarp can drink some cups of coffee (each one no more than once). He can drink cups in any order. Polycarp drinks each cup instantly and completely (i.e. he cannot split any cup into several days).Surely, courseworks are not being written in a single day (in a perfect world of Berland, at least).Let\'s consider some day of Polycarp\'s work. Consider Polycarp drinks k cups of coffee during this day and caffeine dosages of cups Polycarp drink during this day are ai1,ai2,\xe2\x80\xa6,aik. Then the first cup he drinks gives him energy to write ai1 pages of coursework, the second cup gives him energy to write max(0,ai2\xe2\x88\x921) pages, the third cup gives him energy to write max(0,ai3\xe2\x88\x922) pages, ..., the k-th cup gives him energy to write max(0,aik\xe2\x88\x92k+1) pages.If Polycarp doesn\'t drink coffee during some day, he cannot write coursework at all that day.Polycarp has to finish his coursework as soon as possible (spend the minimum number of days to do it). Your task is to find out this number of days or say that it is impossible." 1700
1118D1 "Coffee and Coursework (Easy version)" "brute force,greedy" "The only difference between easy and hard versions is the constraints.Polycarp has to write a coursework. The coursework consists of m pages.Polycarp also has n cups of coffee. The coffee in the i-th cup has ai caffeine in it. Polycarp can drink some cups of coffee (each one no more than once). He can drink cups in any order. Polycarp drinks each cup instantly and completely (i.e. he cannot split any cup into several days).Surely, courseworks are not usually being written in a single day (in a perfect world of Berland, at least). Some of them require multiple days of hard work.Let\'s consider some day of Polycarp\'s work. Consider Polycarp drinks k cups of coffee during this day and caffeine dosages of cups Polycarp drink during this day are ai1,ai2,\xe2\x80\xa6,aik. Then the first cup he drinks gives him energy to write ai1 pages of coursework, the second cup gives him energy to write max(0,ai2\xe2\x88\x921) pages, the third cup gives him energy to write max(0,ai3\xe2\x88\x922) pages, ..., the k-th cup gives him energy to write max(0,aik\xe2\x88\x92k+1) pages.If Polycarp doesn\'t drink coffee during some day, he cannot write coursework at all that day.Polycarp has to finish his coursework as soon as possible (spend the minimum number of days to do it). Your task is to find out this number of days or say that it is impossible." 1700
1118C "Palindromic Matrix" "constructive algorithms,implementation" "Let\'s call some square matrix with integer values in its cells palindromic if it doesn\'t change after the order of rows is reversed and it doesn\'t change after the order of columns is reversed.For example, the following matrices are palindromic:  The following matrices are not palindromic because they change after the order of rows is reversed:  The following matrices are not palindromic because they change after the order of columns is reversed:  You are given n2 integers. Put them into a matrix of n rows and n columns so that each number is used exactly once, each cell contains exactly one number and the resulting matrix is palindromic. If there are multiple answers, print any. If there is no solution, print ""NO""." 1700
1118B "Tanya and Candies" implementation "Tanya has n candies numbered from 1 to n. The i-th candy has the weight ai.She plans to eat exactly n\xe2\x88\x921 candies and give the remaining candy to her dad. Tanya eats candies in order of increasing their numbers, exactly one candy per day.Your task is to find the number of such candies i (let\'s call these candies good) that if dad gets the i-th candy then the sum of weights of candies Tanya eats in even days will be equal to the sum of weights of candies Tanya eats in odd days. Note that at first, she will give the candy, after it she will eat the remaining candies one by one.For example, n=4 and weights are [1,4,3,3]. Consider all possible cases to give a candy to dad:  Tanya gives the 1-st candy to dad (a1=1), the remaining candies are [4,3,3]. She will eat a2=4 in the first day, a3=3 in the second day, a4=3 in the third day. So in odd days she will eat 4+3=7 and in even days she will eat 3. Since 7\xe2\x89\xa03 this case shouldn\'t be counted to the answer (this candy isn\'t good).  Tanya gives the 2-nd candy to dad (a2=4), the remaining candies are [1,3,3]. She will eat a1=1 in the first day, a3=3 in the second day, a4=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 3. Since 4\xe2\x89\xa03 this case shouldn\'t be counted to the answer (this candy isn\'t good).  Tanya gives the 3-rd candy to dad (a3=3), the remaining candies are [1,4,3]. She will eat a1=1 in the first day, a2=4 in the second day, a4=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 4. Since 4=4 this case should be counted to the answer (this candy is good).  Tanya gives the 4-th candy to dad (a4=3), the remaining candies are [1,4,3]. She will eat a1=1 in the first day, a2=4 in the second day, a3=3 in the third day. So in odd days she will eat 1+3=4 and in even days she will eat 4. Since 4=4 this case should be counted to the answer (this candy is good). In total there 2 cases which should counted (these candies are good), so the answer is 2." 1200
1118A "Water Buying" math "Polycarp wants to cook a soup. To do it, he needs to buy exactly n liters of water.There are only two types of water bottles in the nearby shop \xe2\x80\x94 1-liter bottles and 2-liter bottles. There are infinitely many bottles of these two types in the shop.The bottle of the first type costs a burles and the bottle of the second type costs b burles correspondingly.Polycarp wants to spend as few money as possible. Your task is to find the minimum amount of money (in burles) Polycarp needs to buy exactly n liters of water in the nearby shop if the bottle of the first type costs a burles and the bottle of the second type costs b burles. You also have to answer q independent queries." 800
1117G "Recursive Queries" "data structures" "You are given a permutation p1,p2,\xe2\x80\xa6,pn. You should answer q queries. Each query is a pair (li,ri), and you should calculate f(li,ri).Let\'s denote ml,r as the position of the maximum in subsegment pl,pl+1,\xe2\x80\xa6,pr.Then f(l,r)=(r\xe2\x88\x92l+1)+f(l,ml,r\xe2\x88\x921)+f(ml,r+1,r) if l\xe2\x89\xa4r or 0 otherwise." 2500
1117F "Crisp String" bitmasks,dp "You are given a string of length n. Each character is one of the first p lowercase Latin letters.You are also given a matrix A with binary values of size p\xc3\x97p. This matrix is symmetric (Aij=Aji). Aij=1 means that the string can have the i-th and j-th letters of Latin alphabet adjacent.Let\'s call the string crisp if all of the adjacent characters in it can be adjacent (have 1 in the corresponding cell of matrix A).You are allowed to do the following move. Choose any letter, remove all its occurrences and join the remaining parts of the string without changing their order. For example, removing letter \'a\' from ""abacaba"" will yield ""bcb"".The string you are given is crisp. The string should remain crisp after every move you make.You are allowed to do arbitrary number of moves (possible zero). What is the shortest resulting string you can obtain?" 2500
1117E "Decypher the String" "bitmasks,chinese remainder theorem,constructive algorithms,interactive,math" "This is an interactive problem. Remember to flush your output while communicating with the testing program. You may use fflush(stdout) in C++, system.out.flush() in Java, stdout.flush() in Python or flush(output) in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: https://codeforces.com/blog/entry/45307.You are given a string t consisting of n lowercase Latin letters. This string was cyphered as follows: initially, the jury had a string s consisting of n lowercase Latin letters. Then they applied a sequence of no more than n (possibly zero) operations. i-th operation is denoted by two integers ai and bi (1\xe2\x89\xa4ai,bi\xe2\x89\xa4n), and means swapping two elements of the string with indices ai and bi. All operations were done in the order they were placed in the sequence. For example, if s is xyz and 2 following operations are performed: a1=1,b1=2; a2=2,b2=3, then after the first operation the current string is yxz, and after the second operation the current string is yzx, so t is yzx.You are asked to restore the original string s. Unfortunately, you have no information about the operations used in the algorithm (you don\'t even know if there were any operations in the sequence). But you may run the same sequence of operations on any string you want, provided that it contains only lowercase Latin letters and its length is n, and get the resulting string after those operations.Can you guess the original string s asking the testing system to run the sequence of swaps no more than 3 times?The string s and the sequence of swaps are fixed in each test; the interactor doesn\'t try to adapt the test to your solution." 2200
1117D "Magic Gems" dp,math,matrices "Reziba has many magic gems. Each magic gem can be split into M normal gems. The amount of space each magic (and normal) gem takes is 1 unit. A normal gem cannot be split.Reziba wants to choose a set of magic gems and split some of them, so the total space occupied by the resulting set of gems is N units. If a magic gem is chosen and split, it takes M units of space (since it is split into M gems); if a magic gem is not split, it takes 1 unit.How many different configurations of the resulting set of gems can Reziba have, such that the total amount of space taken is N units? Print the answer modulo 1000000007 (109+7). Two configurations are considered different if the number of magic gems Reziba takes to form them differs, or the indices of gems Reziba has to split differ." 2100
1117C "Magic Ship" "binary search" "You a captain of a ship. Initially you are standing in a point (x1,y1) (obviously, all positions in the sea can be described by cartesian plane) and you want to travel to a point (x2,y2). You know the weather forecast \xe2\x80\x94 the string s of length n, consisting only of letters U, D, L and R. The letter corresponds to a direction of wind. Moreover, the forecast is periodic, e.g. the first day wind blows to the side s1, the second day \xe2\x80\x94 s2, the n-th day \xe2\x80\x94 sn and (n+1)-th day \xe2\x80\x94 s1 again and so on. Ship coordinates change the following way:  if wind blows the direction U, then the ship moves from (x,y) to (x,y+1);  if wind blows the direction D, then the ship moves from (x,y) to (x,y\xe2\x88\x921);  if wind blows the direction L, then the ship moves from (x,y) to (x\xe2\x88\x921,y);  if wind blows the direction R, then the ship moves from (x,y) to (x+1,y). The ship can also either go one of the four directions or stay in place each day. If it goes then it\'s exactly 1 unit of distance. Transpositions of the ship and the wind add up. If the ship stays in place, then only the direction of wind counts. For example, if wind blows the direction U and the ship moves the direction L, then from point (x,y) it will move to the point (x\xe2\x88\x921,y+1), and if it goes the direction U, then it will move to the point (x,y+2).You task is to determine the minimal number of days required for the ship to reach the point (x2,y2)." 1900
1117B Emotes greedy,math,sortings "There are n emotes in very popular digital collectible card game (the game is pretty famous so we won\'t say its name). The i-th emote increases the opponent\'s happiness by ai units (we all know that emotes in this game are used to make opponents happy).You have time to use some emotes only m times. You are allowed to use any emotion once, more than once, or not use it at all. The only restriction is that you cannot use the same emote more than k times in a row (otherwise the opponent will think that you\'re trolling him).Note that two emotes i and j (i\xe2\x89\xa0j) such that ai=aj are considered different.You have to make your opponent as happy as possible. Find the maximum possible opponent\'s happiness." 1000
1117A "Best Subsegment" implementation,math "You are given array a1,a2,\xe2\x80\xa6,an. Find the subsegment al,al+1,\xe2\x80\xa6,ar (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) with maximum arithmetic mean 1r\xe2\x88\x92l+1r\xe2\x88\x91i=lai (in floating-point numbers, i.e. without any rounding).If there are many such subsegments find the longest one." 1100
1116D6 "Hessenberg matrix" NA "Implement a unitary operation on N qubits which is represented by an upper Hessenberg matrix (a square matrix of size 2N which has all zero elements below the first subdiagonal and all non-zero elements on the first subdiagonal and above it).For example, for N=2 the matrix of the operation should have the following shape:XXXXXXXX.XXX..XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa44) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999
1116D5 Creeper NA "Implement a unitary operation on 3 qubits which is represented by a square matrix of size 8 with the following pattern:XX....XXXX....XX...XX......XX.....X..X....X..X..XX....XXXX....XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of 3 qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999
1116D4 "TIE fighter" NA "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has non-zero elements in the following positions: the central 2x2 sub-matrix, the diagonals of the top right and bottom left square sub-matrices of size 2N\xe2\x88\x921\xe2\x88\x921 that do not overlap with the central 2x2 sub-matrix, the anti-diagonals of the top left and bottom right square sub-matrices of size 2N\xe2\x88\x921\xe2\x88\x921 that do not overlap with the central 2x2 sub-matrix.For example, for N=3 the matrix of the operation should have the following shape:..X..X...X....X.X......X...XX......XX...X......X.X....X...X..X..Here X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999
1116D3 "X-wing fighter" NA "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has non-zero elements on both main diagonal and anti-diagonal and zero elements everywhere else.For example, for N=3 the matrix of the operation should have the following shape:X......X.X....X...X..X.....XX......XX.....X..X...X....X.X......XHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999
1116D2 "Pattern of increasing blocks" NA "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N defined as follows: top right and bottom left quarters are filled with zero elements,  the top left quarter is the same pattern of size 2N\xe2\x88\x921 (for N=1, the top left quarter is a non-zero element), the bottom right quarter is filled with non-zero elements.For example, for N=3 the matrix of the operation should have the following shape:X........X........XX......XX........XXXX....XXXX....XXXX....XXXXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999
1116D1 "Block diagonal matrix" NA "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N which has 2x2 blocks of non-zero elements on the main diagonal and zero elements everywhere else.For example, for N=3 the matrix of the operation should have the following shape:XX......XX........XX......XX........XX......XX........XX......XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}You are not allowed to use measurements in your operation." -999
1116C3 "``Is the number of ones divisible by 3?\'\' oracle" NA "Implement a quantum oracle on N qubits which checks whether the number of bits equal to 1 in the input vector \xe2\x86\x92x is divisible by 3 (i.e., implements the function f(\xe2\x86\x92x)=1 if the number of xi=1 in \xe2\x86\x92x is divisible by 3, and 0 otherwise).You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa49) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits. Note that the input register x has to remain unchanged after applying the operation.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}Note: the operation has to have an adjoint specified for it; adjoint auto means that the adjoint will be generated automatically. For details on adjoint, see Operation Declarations.You are not allowed to use measurements in your operation." -999
1116C2 "``Is the bit string periodic?\'\' oracle" NA "Implement a quantum oracle on N qubits which checks whether the bits in the input vector \xe2\x86\x92x form a periodic bit string (i.e., implements the function f(\xe2\x86\x92x)=1 if \xe2\x86\x92x is periodic, and 0 otherwise). A bit string of length N is considered periodic with period P (1\xe2\x89\xa4P\xe2\x89\xa4N\xe2\x88\x921) if for all i\xe2\x88\x88[0,N\xe2\x88\x92P\xe2\x88\x921] xi=xi+P. Note that P does not have to divide N evenly; for example, bit string ""01010"" is periodic with period P=2.You have to implement an operation which takes the following inputs: an array of N (2\xe2\x89\xa4N\xe2\x89\xa47) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits. Note that the input register x has to remain unchanged after applying the operation.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}Note: the operation has to have an adjoint specified for it; adjoint auto means that the adjoint will be generated automatically. For details on adjoint, see Operation Definitions.You are not allowed to use measurements in your operation." -999
1116C1 "Alternating bits oracle" NA "Implement a quantum oracle on N qubits which checks whether the bits in the input vector \xe2\x86\x92x alternate (i.e., implements the function f(\xe2\x86\x92x)=1 if \xe2\x86\x92x does not have a pair of adjacent bits in state 00 or 11).You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa47) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits. Note that the input register x has to remain unchanged after applying the operation.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}Note: the operation has to have an adjoint specified for it; adjoint auto means that the adjoint will be generated automatically. For details on adjoint, see Operation Definitions.You are not allowed to use measurements in your operation." -999
1116B2 "Not A, not B or not C?" NA "You are given a qubit which is guaranteed to be in one of the following states: |A\xe2\x9f\xa9=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+|1\xe2\x9f\xa9), |B\xe2\x9f\xa9=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+\xcf\x89|1\xe2\x9f\xa9), or |C\xe2\x9f\xa9=1\xe2\x88\x9a2(|0\xe2\x9f\xa9+\xcf\x892|1\xe2\x9f\xa9), where \xcf\x89=e2i\xcf\x80/3.These states are not orthogonal, and thus can not be distinguished perfectly. Your task is to figure out in which state the qubit is not. More formally: If the qubit was in state |A\xe2\x9f\xa9, you have to return 1 or 2. If the qubit was in state |B\xe2\x9f\xa9, you have to return 0 or 2. If the qubit was in state |C\xe2\x9f\xa9, you have to return 0 or 1. In other words, return 0 if you\'re sure the qubit was not in state |A\xe2\x9f\xa9, return 1 if you\'re sure the qubit was not in state |B\xe2\x9f\xa9, and return 2 if you\'re sure the qubit was not in state |C\xe2\x9f\xa9.Your solution will be called 1000 times, each time the state of the qubit will be chosen as |A\xe2\x9f\xa9, |B\xe2\x9f\xa9 or |C\xe2\x9f\xa9 with equal probability. The state of the qubit after the operations does not matter.You have to implement an operation which takes a qubit as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (q : Qubit) : Int {        // your code here    }}" -999
1116B1 "Distinguish three-qubit states" NA "You are given 3 qubits which are guaranteed to be in one of the two states: |\xcf\x880\xe2\x9f\xa9=1\xe2\x88\x9a3(|100\xe2\x9f\xa9+\xcf\x89|010\xe2\x9f\xa9+\xcf\x892|001\xe2\x9f\xa9), or |\xcf\x881\xe2\x9f\xa9=1\xe2\x88\x9a3(|100\xe2\x9f\xa9+\xcf\x892|010\xe2\x9f\xa9+\xcf\x89|001\xe2\x9f\xa9), where \xcf\x89=e2i\xcf\x80/3.Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was |\xcf\x880\xe2\x9f\xa9 state or 1 if it was |\xcf\x881\xe2\x9f\xa9 state. The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of 3 qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int {        // your code here    }}" -999
1116A2 "Generate equal superposition of four basis states" NA "You are given N qubits in the zero state |0...0\xe2\x9f\xa9. You are also given four distinct bit vectors which describe four different basis states on N qubits |\xcf\x88i\xe2\x9f\xa9.Your task is to generate a state which is an equal superposition of the given basis states:|S\xe2\x9f\xa9=12(|\xcf\x880\xe2\x9f\xa9+|\xcf\x881\xe2\x9f\xa9+|\xcf\x882\xe2\x9f\xa9+|\xcf\x883\xe2\x9f\xa9)You have to implement an operation which takes the following inputs: an array of N (2\xe2\x89\xa4N\xe2\x89\xa416) qubits, a two-dimensional array of Boolean values bits representing the basis states |\xcf\x88i\xe2\x9f\xa9. bits will have exactly 4 elements, each of bits[i] describing the basis state |\xcf\x88i\xe2\x9f\xa9. Each of bits[i] will have N elements, bits[i][j] giving the state of qubit j in the basis state |\xcf\x88i\xe2\x9f\xa9. Bit values true and false corresponding to |1\xe2\x9f\xa9 and |0\xe2\x9f\xa9 states, respectively; for example, for N=2 an array [false, true] will represent the basis state |01\xe2\x9f\xa9. Each pair of bits[i] and bits[j] will differ in at least one position for i\xe2\x89\xa0j.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[], bits : Bool[][]) : Unit {        // your code here    }}" -999
1116A1 "Generate state |00\xe2\x9f\xa9 + |01\xe2\x9f\xa9 + |10\xe2\x9f\xa9" NA "You are given two qubits in state |00\xe2\x9f\xa9. Your task is to create the following state on them:1\xe2\x88\x9a3(|00\xe2\x9f\xa9+|01\xe2\x9f\xa9+|10\xe2\x9f\xa9)You have to implement an operation which takes an array of 2 qubits as an input and has no output. The ""output"" of your solution is the state in which it left the input qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" -999
1115U3 "Block unitary" "*special problem" "Implement a unitary operation on N qubits which is represented by the following square matrix of size 2N: top right and bottom left quarters are filled with zero elements,  top left quarter is an anti-diagonal matrix of size 2N\xe2\x88\x921, bottom right quarter is filled with non-zero elements.For example, for N=2 the matrix of the operation should have the following shape:.X..X.....XX..XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" 1700
1115U2 "Chessboard unitary" "*special problem" "Implement a unitary operation on N qubits which is represented by a square matrix of size 2N in which zero and non-zero elements form a chessboard pattern with alternating 2x2 squares (top left square formed by non-zero elements).For example, for N=3 the matrix of the operation should have the following shape:XX..XX..XX..XX....XX..XX..XX..XXXX..XX..XX..XX....XX..XX..XX..XXHere X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" 1600
1115U1 "Anti-diagonal unitary" "*special problem" "Implement a unitary operation on N qubits which is represented by an anti-diagonal matrix (a square matrix of size 2N which has non-zero elements on the diagonal that runs from the top right corner to the bottom left corner and zero elements everywhere else).For example, for N=2 the matrix of the operation should have the following shape:...X..X..X..X...Here X denotes a ""non-zero"" element of the matrix (a complex number which has the square of the absolute value greater than or equal to 10\xe2\x88\x925), and . denotes a ""zero"" element of the matrix (a complex number which has the square of the absolute value less than 10\xe2\x88\x925).The row and column indices of the matrix follow little endian format: the least significant bit of the index is stored first in the qubit array. Thus, the first column of the matrix gives you the coefficients of the basis states you\'ll get if you apply the unitary to the |00..0\xe2\x9f\xa9 basis state, the second column - to the |10..0\xe2\x9f\xa9 basis state etc. You can use the DumpUnitary tool to get the coefficients of the matrix your unitary implements (up to relative phases between columns) and the corresponding pattern of Xs and .s.You have to implement an operation which takes an array of N (2\xe2\x89\xa4N\xe2\x89\xa45) qubits as an input and applies the unitary transformation with the matrix of the described shape to it. If there are multiple unitaries which satisfy the requirements, you can implement any of them. The ""output"" of your operation is the pattern of the matrix coefficients implemented by it; you can see the testing harness in the UnitaryPatterns kata.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Unit {        // your code here    }}" 1500
1115G3 "Palindrome checker oracle" "*special problem" "Implement a quantum oracle on N qubits which checks whether the vector \xe2\x86\x92x is a palindrome (i.e., implements the function f(\xe2\x86\x92x)=1 if \xe2\x86\x92x is a palindrome, and 0 otherwise).You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa48) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}" 1600
1115G2 "OR oracle" "*special problem" "Implement a quantum oracle on N qubits which implements the following function: f(\xe2\x86\x92x)=x0\xe2\x88\xa8x1\xe2\x88\xa8\xe2\x8b\xaf\xe2\x88\xa8xN\xe2\x88\x921You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa48) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}" 1600
1115G1 "AND oracle" "*special problem" "Implement a quantum oracle on N qubits which implements the following function: f(\xe2\x86\x92x)=x0\xe2\x88\xa7x1\xe2\x88\xa7\xe2\x8b\xaf\xe2\x88\xa7xN\xe2\x88\x921You have to implement an operation which takes the following inputs: an array of N (1\xe2\x89\xa4N\xe2\x89\xa48) qubits x in an arbitrary state (input register), a qubit y in an arbitrary state (output qubit),and performs a transformation |x\xe2\x9f\xa9|y\xe2\x9f\xa9\xe2\x86\x92|x\xe2\x9f\xa9|y\xe2\x8a\x95f(x)\xe2\x9f\xa9. The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : Unit {        body (...) {            // your code here        }        adjoint auto;    }}" 1100
1114F "Please, another Queries on Array?" "bitmasks,data structures,divide and conquer,math,number theory" "You are given an array a1,a2,\xe2\x80\xa6,an.You need to perform q queries of the following two types:  ""MULTIPLY l r x"" \xe2\x80\x94 for every i (l\xe2\x89\xa4i\xe2\x89\xa4r) multiply ai by x. ""TOTIENT l r"" \xe2\x80\x94 print \xcf\x86(r\xe2\x88\x8fi=lai) taken modulo 109+7, where \xcf\x86 denotes Euler\'s totient function. The Euler\'s totient function of a positive integer n (denoted as \xcf\x86(n)) is the number of integers x (1\xe2\x89\xa4x\xe2\x89\xa4n) such that gcd(n,x)=1." 2400
1114E "Arithmetic Progression" "binary search,interactive,number theory,probabilities" "This is an interactive problem!An arithmetic progression or arithmetic sequence is a sequence of integers such that the subtraction of element with its previous element (xi\xe2\x88\x92xi\xe2\x88\x921, where i\xe2\x89\xa52) is constant \xe2\x80\x94 such difference is called a common difference of the sequence.That is, an arithmetic progression is a sequence of form xi=x1+(i\xe2\x88\x921)d, where d is a common difference of the sequence.There is a secret list of n integers a1,a2,\xe2\x80\xa6,an.It is guaranteed that all elements a1,a2,\xe2\x80\xa6,an are between 0 and 109, inclusive.This list is special: if sorted in increasing order, it will form an arithmetic progression with positive common difference (d>0). For example, the list [14,24,9,19] satisfies this requirement, after sorting it makes a list [9,14,19,24], which can be produced as xn=9+5\xe2\x8b\x85(n\xe2\x88\x921).Also you are also given a device, which has a quite discharged battery, thus you can only use it to perform at most 60 queries of following two types: Given a value i (1\xe2\x89\xa4i\xe2\x89\xa4n), the device will show the value of the ai. Given a value x (0\xe2\x89\xa4x\xe2\x89\xa4109), the device will return 1 if an element with a value strictly greater than x exists, and it will return 0 otherwise.Your can use this special device for at most 60 queries. Could you please find out the smallest element and the common difference of the sequence? That is, values x1 and d in the definition of the arithmetic progression. Note that the array a is not sorted." 2200
1114D "Flood Fill" dp "You are given a line of n colored squares in a row, numbered from 1 to n from left to right. The i-th square initially has the color ci.Let\'s say, that two squares i and j belong to the same connected component if ci=cj, and ci=ck for all k satisfying i<k<j. In other words, all squares on the segment from i to j should have the same color.For example, the line [3,3,3] has 1 connected component, while the line [5,2,4,4] has 3 connected components.The game ""flood fill"" is played on the given line as follows:   At the start of the game you pick any starting square (this is not counted as a turn).  Then, in each game turn, change the color of the connected component containing the starting square to any other color. Find the minimum number of turns needed for the entire line to be changed into a single color." 1900
1114C "Trailing Loves (or L\'oeufs?)" "brute force,implementation,math,number theory" "The number ""zero"" is called ""love"" (or ""l\'oeuf"" to be precise, literally means ""egg"" in French), for example when denoting the zero score in a game of tennis. Aki is fond of numbers, especially those with trailing zeros. For example, the number 9200 has two trailing zeros. Aki thinks the more trailing zero digits a number has, the prettier it is.However, Aki believes, that the number of trailing zeros of a number is not static, but depends on the base (radix) it is represented in. Thus, he considers a few scenarios with some numbers and bases. And now, since the numbers he used become quite bizarre, he asks you to help him to calculate the beauty of these numbers.Given two integers n and b (in decimal notation), your task is to calculate the number of trailing zero digits in the b-ary (in the base/radix of b) representation of n! (factorial of n)." 1700
1114B "Yet Another Array Partitioning Task" "constructive algorithms,greedy,sortings" "An array b is called to be a subarray of a if it forms a continuous subsequence of a, that is, if it is equal to al, al+1, \xe2\x80\xa6, ar for some l,r.Suppose m is some known constant. For any array, having m or more elements, let\'s define it\'s beauty as the sum of m largest elements of that array. For example:   For array x=[4,3,1,5,2] and m=3, the 3 largest elements of x are 5, 4 and 3, so the beauty of x is 5+4+3=12. For array x=[10,10,10] and m=2, the beauty of x is 10+10=20.You are given an array a1,a2,\xe2\x80\xa6,an, the value of the said constant m and an integer k. Your need to split the array a into exactly k subarrays such that:  Each element from a belongs to exactly one subarray. Each subarray has at least m elements. The sum of all beauties of k subarrays is maximum possible." 1500
1114A "Got Any Grapes?" "brute force,greedy,implementation" "The Duck songFor simplicity, we\'ll assume that there are only three types of grapes: green grapes, purple grapes and black grapes.Andrew, Dmitry and Michal are all grapes\' lovers, however their preferences of grapes are different. To make all of them happy, the following should happen: Andrew, Dmitry and Michal should eat at least x, y and z grapes, respectively. Andrew has an extreme affinity for green grapes, thus he will eat green grapes and green grapes only. On the other hand, Dmitry is not a fan of black grapes \xe2\x80\x94 any types of grapes except black would do for him. In other words, Dmitry can eat green and purple grapes. Michal has a common taste \xe2\x80\x94 he enjoys grapes in general and will be pleased with any types of grapes, as long as the quantity is sufficient.Knowing that his friends are so fond of grapes, Aki decided to host a grape party with them. He has prepared a box with a green grapes, b purple grapes and c black grapes.However, Aki isn\'t sure if the box he prepared contains enough grapes to make everyone happy. Can you please find out whether it\'s possible to distribute grapes so that everyone is happy or Aki has to buy some more grapes?It is not required to distribute all the grapes, so it\'s possible that some of them will remain unused." 800
1113B "Sasha and Magnetic Machines" "greedy,number theory" "One day Sasha visited the farmer 2D and his famous magnetic farm. On this farm, the crop grows due to the influence of a special magnetic field. Maintaining of the magnetic field is provided by n machines, and the power of the i-th machine is ai. This year 2D decided to cultivate a new culture, but what exactly he didn\'t say. For the successful growth of the new culture, it is necessary to slightly change the powers of the machines. 2D can at most once choose an arbitrary integer x, then choose one machine and reduce the power of its machine by x times, and at the same time increase the power of one another machine by x times (powers of all the machines must stay positive integers). Note that he may not do that if he wants. More formally, 2D can choose two such indices i and j, and one integer x such that x is a divisor of ai, and change powers as following: ai=aix, aj=aj\xe2\x8b\x85xSasha is very curious, that\'s why he wants to calculate the minimum total power the farmer can reach. There are too many machines, and Sasha can\'t cope with computations, help him!" 1300
1113A "Sasha and His Trip" dp,greedy,math "Sasha is a very happy guy, that\'s why he is always on the move. There are n cities in the country where Sasha lives. They are all located on one straight line, and for convenience, they are numbered from 1 to n in increasing order. The distance between any two adjacent cities is equal to 1 kilometer. Since all roads in the country are directed, it\'s possible to reach the city y from the city x only if x<y. Once Sasha decided to go on a trip around the country and to visit all n cities. He will move with the help of his car, Cheetah-2677. The tank capacity of this model is v liters, and it spends exactly 1 liter of fuel for 1 kilometer of the way. At the beginning of the journey, the tank is empty. Sasha is located in the city with the number 1 and wants to get to the city with the number n. There is a gas station in each city. In the i-th city, the price of 1 liter of fuel is i dollars. It is obvious that at any moment of time, the tank can contain at most v liters of fuel.Sasha doesn\'t like to waste money, that\'s why he wants to know what is the minimum amount of money is needed to finish the trip if he can buy fuel in any city he wants. Help him to figure it out!" 900
1111E Tree "data structures,dfs and similar,dp,graphs,trees" "You are given a tree with n nodes and q queries.Every query starts with three integers k, m and r, followed by k nodes of the tree a1,a2,\xe2\x80\xa6,ak. To answer a query, assume that the tree is rooted at r. We want to divide the k given nodes into at most m groups such that the following conditions are met:   Each node should be in exactly one group and each group should have at least one node.  In any group, there should be no two distinct nodes such that one node is an ancestor (direct or indirect) of the other. You need to output the number of ways modulo 109+7 for every query." 2500
1111D "Destroy the Colony" combinatorics,dp,math "There is a colony of villains with several holes aligned in a row, where each hole contains exactly one villain.Each colony arrangement can be expressed as a string of even length, where the i-th character of the string represents the type of villain in the i-th hole. Iron Man can destroy a colony only if the colony arrangement is such that all villains of a certain type either live in the first half of the colony or in the second half of the colony.His assistant Jarvis has a special power. It can swap villains of any two holes, i.e. swap any two characters in the string; he can do this operation any number of times.Now Iron Man asks Jarvis q questions. In each question, he gives Jarvis two numbers x and y. Jarvis has to tell Iron Man the number of distinct colony arrangements he can create from the original one using his powers such that all villains having the same type as those originally living in x-th hole or y-th hole live in the same half and the Iron Man can destroy that colony arrangement.Two colony arrangements are considered to be different if there exists a hole such that different types of villains are present in that hole in the arrangements." 2600
1111C "Creative Snap" "binary search,brute force,divide and conquer,math" "Thanos wants to destroy the avengers base, but he needs to destroy the avengers along with their base.Let we represent their base with an array, where each position can be occupied by many avengers, but one avenger can occupy only one position. Length of their base is a perfect power of 2. Thanos wants to destroy the base using minimum power. He starts with the whole base and in one step he can do either of following:   if the current length is at least 2, divide the base into 2 equal halves and destroy them separately, or  burn the current base. If it contains no avenger in it, it takes A amount of power, otherwise it takes his B\xe2\x8b\x85na\xe2\x8b\x85l amount of power, where na is the number of avengers and l is the length of the current base. Output the minimum power needed by Thanos to destroy the avengers\' base." 1700
1111B "Average Superhero Gang Power" "brute force,implementation,math" "Every superhero has been given a power value by the Felicity Committee. The avengers crew wants to maximize the average power of the superheroes in their team by performing certain operations.Initially, there are n superheroes in avengers team having powers a1,a2,\xe2\x80\xa6,an, respectively. In one operation, they can remove one superhero from their team (if there are at least two) or they can increase the power of a superhero by 1. They can do at most m operations. Also, on a particular superhero at most k operations can be done.Can you help the avengers team to maximize the average power of their crew?" 1700
1111A "Superhero Transformation" implementation,strings "We all know that a superhero can transform to certain other superheroes. But not all Superheroes can transform to any other superhero. A superhero with name s can transform to another superhero with name t if s can be made equal to t by changing any vowel in s to any other vowel and any consonant in s to any other consonant. Multiple changes can be made.In this problem, we consider the letters \'a\', \'e\', \'i\', \'o\' and \'u\' to be vowels and all the other letters to be consonants.Given the names of two superheroes, determine if the superhero with name s can be transformed to the Superhero with name t." 1000
1110H "Modest Substrings" dp,strings "You are given two integers l and r.Let\'s call an integer x modest, if l\xe2\x89\xa4x\xe2\x89\xa4r.Find a string of length n, consisting of digits, which has the largest possible number of substrings, which make a modest integer. Substring having leading zeros are not counted. If there are many answers, find lexicographically smallest one.If some number occurs multiple times as a substring, then in the counting of the number of modest substrings it is counted multiple times as well." 3500
1110G Tree-Tac-Toe "constructive algorithms,games,trees" "The tic-tac-toe game is starting on a tree of n vertices. Some vertices are already colored in white while the remaining are uncolored.There are two players \xe2\x80\x94 white and black. The players make moves alternatively. The white player starts the game. In his turn, a player must select one uncolored vertex and paint it in his color.The player wins if he paints some path of three vertices in his color. In case all vertices are colored and neither player won, the game ends in a draw.Could you please find who will win the game or whether it ends as a draw, assuming both players play optimally?" 3100
1110F "Nearest Leaf" "data structures,trees" "Let\'s define the Eulerian traversal of a tree (a connected undirected graph without cycles) as follows: consider a depth-first search algorithm which traverses vertices of the tree and enumerates them in the order of visiting (only the first visit of each vertex counts). This function starts from the vertex number 1 and then recursively runs from all vertices which are connected with an edge with the current vertex and are not yet visited in increasing numbers order. Formally, you can describe this function using the following pseudocode:next_id = 1id = array of length n filled with -1visited = array of length n filled with falsefunction dfs(v):    visited[v] = true    id[v] = next_id    next_id += 1    for to in neighbors of v in increasing order:        if not visited[to]:            dfs(to)You are given a weighted tree, the vertices of which were enumerated with integers from 1 to n using the algorithm described above.A leaf is a vertex of the tree which is connected with only one other vertex. In the tree given to you, the vertex 1 is not a leaf. The distance between two vertices in the tree is the sum of weights of the edges on the simple path between them.You have to answer q queries of the following type: given integers v, l and r, find the shortest distance from vertex v to one of the leaves with indices from l to r inclusive." 2600
1110E "Magic Stones" "constructive algorithms,math,sortings" "Grigory has n magic stones, conveniently numbered from 1 to n. The charge of the i-th stone is equal to ci.Sometimes Grigory gets bored and selects some inner stone (that is, some stone with index i, where 2\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921), and after that synchronizes it with neighboring stones. After that, the chosen stone loses its own charge, but acquires the charges from neighboring stones. In other words, its charge ci changes to c\xe2\x80\xb2i=ci+1+ci\xe2\x88\x921\xe2\x88\x92ci.Andrew, Grigory\'s friend, also has n stones with charges ti. Grigory is curious, whether there exists a sequence of zero or more synchronization operations, which transforms charges of Grigory\'s stones into charges of corresponding Andrew\'s stones, that is, changes ci into ti for all i?" 2200
1110D Jongmah dp "You are playing a game of Jongmah. You don\'t need to know the rules to solve this problem. You have n tiles in your hand. Each tile has an integer between 1 and m written on it.To win the game, you will need to form some number of triples. Each triple consists of three tiles, such that the numbers written on the tiles are either all the same or consecutive. For example, 7,7,7 is a valid triple, and so is 12,13,14, but 2,2,3 or 2,4,6 are not. You can only use the tiles in your hand to form triples. Each tile can be used in at most one triple.To determine how close you are to the win, you want to know the maximum number of triples you can form from the tiles in your hand." 2200
1110C "Meaningless Operations" "constructive algorithms,math,number theory" "Can the greatest common divisor and bitwise operations have anything in common? It is time to answer this question.Suppose you are given a positive integer a. You want to choose some integer b from 1 to a\xe2\x88\x921 inclusive in such a way that the greatest common divisor (GCD) of integers a\xe2\x8a\x95b and a&b is as large as possible. In other words, you\'d like to compute the following function:f(a)=max0<b<agcd(a\xe2\x8a\x95b,a&b).Here \xe2\x8a\x95 denotes the bitwise XOR operation, and & denotes the bitwise AND operation.The greatest common divisor of two integers x and y is the largest integer g such that both x and y are divided by g without remainder.You are given q integers a1,a2,\xe2\x80\xa6,aq. For each of these integers compute the largest possible value of the greatest common divisor (when b is chosen optimally)." 1500
1110B Tape greedy,sortings "You have a long stick, consisting of m segments enumerated from 1 to m. Each segment is 1 centimeter long. Sadly, some segments are broken and need to be repaired.You have an infinitely long repair tape. You want to cut some pieces from the tape and use them to cover all of the broken segments. To be precise, a piece of tape of integer length t placed at some position s will cover segments s,s+1,\xe2\x80\xa6,s+t\xe2\x88\x921.You are allowed to cover non-broken segments; it is also possible that some pieces of tape will overlap.Time is money, so you want to cut at most k continuous pieces of tape to cover all the broken segments. What is the minimum total length of these pieces?" 1400
1110A Parity math "You are given an integer n (n\xe2\x89\xa50) represented with k digits in base (radix) b. So,n=a1\xe2\x8b\x85bk\xe2\x88\x921+a2\xe2\x8b\x85bk\xe2\x88\x922+\xe2\x80\xa6ak\xe2\x88\x921\xe2\x8b\x85b+ak.For example, if b=17,k=3 and a=[11,15,7] then n=11\xe2\x8b\x85172+15\xe2\x8b\x8517+7=3179+255+7=3441.Determine whether n is even or odd." 900
1109F "Sasha and Algorithm of Silence\'s Sounds" "data structures,trees" "One fine day Sasha went to the park for a walk. In the park, he saw that his favorite bench is occupied, and he had to sit down on the neighboring one. He sat down and began to listen to the silence. Suddenly, he got a question: what if in different parts of the park, the silence sounds in different ways? So it was. Let\'s divide the park into 1\xc3\x9711\xc3\x971 meter squares and call them cells, and numerate rows from 11 to nn from up to down, and columns from 11 to mm from left to right. And now, every cell can be described with a pair of two integers (x,y)(x,y), where xx \xe2\x80\x94 the number of the row, and yy \xe2\x80\x94 the number of the column. Sasha knows that the level of silence in the cell (i,j)(i,j) equals to fi,jfi,j, and all fi,jfi,j form a permutation of numbers from 11 to n\xe2\x8b\x85mn\xe2\x8b\x85m. Sasha decided to count, how many are there pleasant segments of silence?Let\'s take some segment [l\xe2\x80\xa6r][l\xe2\x80\xa6r]. Denote SS as the set of cells (i,j)(i,j) that l\xe2\x89\xa4fi,j\xe2\x89\xa4rl\xe2\x89\xa4fi,j\xe2\x89\xa4r. Then, the segment of silence [l\xe2\x80\xa6r][l\xe2\x80\xa6r] is pleasant if there is only one simple path between every pair of cells from SS (path can\'t contain cells, which are not in SS). In other words, set SS should look like a tree on a plain. Sasha has done this task pretty quickly, and called the algorithm \xe2\x80\x94 ""algorithm of silence\'s sounds"".Time passed, and the only thing left from the algorithm is a legend. To prove the truthfulness of this story, you have to help Sasha and to find the number of different pleasant segments of silence. Two segments [l1\xe2\x80\xa6r1][l1\xe2\x80\xa6r1], [l2\xe2\x80\xa6r2][l2\xe2\x80\xa6r2] are different, if l1\xe2\x89\xa0l2l1\xe2\x89\xa0l2 or r1\xe2\x89\xa0r2r1\xe2\x89\xa0r2 or both at the same time." 3200
1109E "Sasha and a Very Easy Test" "data structures,number theory" "Egor likes math, and not so long ago he got the highest degree of recognition in the math community \xe2\x80\x94 Egor became a red mathematician. In this regard, Sasha decided to congratulate Egor and give him a math test as a present. This test contains an array a of integers of length n and exactly q queries. Queries were of three types:   ""1 l r x"" \xe2\x80\x94 multiply each number on the range from l to r by x.  ""2 p x"" \xe2\x80\x94 divide the number at the position p by x (divisibility guaranteed).  ""3 l r"" \xe2\x80\x94 find the sum of all elements on the range from l to r. The sum can be big, so Sasha asked Egor to calculate the sum modulo some integer mod. But since Egor is a red mathematician, he doesn\'t have enough time to solve such easy tasks, at the same time he doesn\'t want to anger Sasha, that\'s why he asked you to help and to find answers for all queries of the 3-rd type." 2700
1109D "Sasha and Interesting Fact from Graph Theory" "brute force,combinatorics,dp,math,trees" "Once, during a lesson, Sasha got bored and decided to talk with his friends. Suddenly, he saw Kefa. Since we can talk endlessly about Kefa, we won\'t even start doing that. The conversation turned to graphs. Kefa promised Sasha to tell him about one interesting fact from graph theory if Sasha helps Kefa to count the number of beautiful trees. In this task, a tree is a weighted connected graph, consisting of n vertices and n\xe2\x88\x921 edges, and weights of edges are integers from 1 to m. Kefa determines the beauty of a tree as follows: he finds in the tree his two favorite vertices \xe2\x80\x94 vertices with numbers a and b, and counts the distance between them. The distance between two vertices x and y is the sum of weights of edges on the simple path from x to y. If the distance between two vertices a and b is equal to m, then the tree is beautiful.Sasha likes graph theory, and even more, Sasha likes interesting facts, that\'s why he agreed to help Kefa. Luckily, Sasha is familiar with you the best programmer in Byteland. Help Sasha to count the number of beautiful trees for Kefa. Two trees are considered to be distinct if there is an edge that occurs in one of them and doesn\'t occur in the other one. Edge\'s weight matters.Kefa warned Sasha, that there can be too many beautiful trees, so it will be enough to count the number modulo 109+7." 2400
1109C "Sasha and a Patient Friend" "binary search,data structures,implementation" "Fedya and Sasha are friends, that\'s why Sasha knows everything about Fedya.Fedya keeps his patience in an infinitely large bowl. But, unlike the bowl, Fedya\'s patience isn\'t infinite, that is why let v be the number of liters of Fedya\'s patience, and, as soon as v becomes equal to 0, the bowl will burst immediately. There is one tap in the bowl which pumps s liters of patience per second. Notice that s can be negative, in that case, the tap pumps out the patience. Sasha can do different things, so he is able to change the tap\'s speed. All actions that Sasha does can be represented as q queries. There are three types of queries:  ""1 t s""  \xe2\x80\x94 add a new event, means that starting from the t-th second the tap\'s speed will be equal to s.  ""2 t""  \xe2\x80\x94 delete the event which happens at the t-th second. It is guaranteed that such event exists.  ""3 l r v"" \xe2\x80\x94 Sasha wonders: if you take all the events for which l\xe2\x89\xa4t\xe2\x89\xa4r and simulate changes of Fedya\'s patience from the very beginning of the l-th second till the very beginning of the r-th second inclusive (the initial volume of patience, at the beginning of the l-th second, equals to v liters) then when will be the moment when the bowl will burst. If that does not happen, then the answer will be \xe2\x88\x921. Since Sasha does not want to check what will happen when Fedya\'s patience ends, and he has already come up with the queries, he is asking you to help him and find the answer for each query of the 3-rd type.It is guaranteed that at any moment of time, there won\'t be two events which happen at the same second." 2800
1109B "Sasha and One More Name" "constructive algorithms,hashing,strings" "Reading books is one of Sasha\'s passions. Once while he was reading one book, he became acquainted with an unusual character. The character told about himself like that: ""Many are my names in many countries. Mithrandir among the Elves, Thark\xc3\xbbn to the Dwarves, Ol\xc3\xb3rin I was in my youth in the West that is forgotten, in the South Inc\xc3\xa1nus, in the North Gandalf; to the East I go not.""And at that moment Sasha thought, how would that character be called in the East? In the East all names are palindromes. A string is a palindrome if it reads the same backward as forward. For example, such strings as ""kazak"", ""oo"" and ""r"" are palindromes, but strings ""abb"" and ""ij"" are not. Sasha believed that the hero would be named after one of the gods of the East. As long as there couldn\'t be two equal names, so in the East people did the following: they wrote the original name as a string on a piece of paper, then cut the paper minimum number of times k, so they got k+1 pieces of paper with substrings of the initial string, and then unite those pieces together to get a new string. Pieces couldn\'t be turned over, they could be shuffled.In this way, it\'s possible to achive a string abcdefg from the string f|de|abc|g using 3 cuts (by swapping papers with substrings f and abc). The string cbadefg can\'t be received using the same cuts.More formally, Sasha wants for the given palindrome s find such minimum k, that you can cut this string into k+1 parts, and then unite them in such a way that the final string will be a palindrome and it won\'t be equal to the initial string s. It there is no answer, then print ""Impossible"" (without quotes)." 1800
1109A "Sasha and a Bit of Relax" dp,implementation "Sasha likes programming. Once, during a very long contest, Sasha decided that he was a bit tired and needed to relax. So he did. But since Sasha isn\'t an ordinary guy, he prefers to relax unusually. During leisure time Sasha likes to upsolve unsolved problems because upsolving is very useful.Therefore, Sasha decided to upsolve the following problem:You have an array a with n integers. You need to count the number of funny pairs (l,r) (l\xe2\x89\xa4r). To check if a pair (l,r) is a funny pair, take mid=l+r\xe2\x88\x9212, then if r\xe2\x88\x92l+1 is an even number and al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95amid=amid+1\xe2\x8a\x95amid+2\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar, then the pair is funny. In other words, \xe2\x8a\x95 of elements of the left half of the subarray from l to r should be equal to \xe2\x8a\x95 of elements of the right half. Note that \xe2\x8a\x95 denotes the bitwise XOR operation.It is time to continue solving the contest, so Sasha asked you to solve this task." 1600
1108F "MST Unification" "binary search,dsu,graphs,greedy" "You are given an undirected weighted connected graph with n vertices and m edges without loops and multiple edges.The i-th edge is ei=(ui,vi,wi); the distance between vertices ui and vi along the edge ei is wi (1\xe2\x89\xa4wi). The graph is connected, i.\xe2\x80\x89e. for any pair of vertices, there is at least one path between them consisting only of edges of the given graph.A minimum spanning tree (MST) in case of positive weights is a subset of the edges of a connected weighted undirected graph that connects all the vertices together and has minimum total cost among all such subsets (total cost is the sum of costs of chosen edges).You can modify the given graph. The only operation you can perform is the following: increase the weight of some edge by 1. You can increase the weight of each edge multiple (possibly, zero) times.Suppose that the initial MST cost is k. Your problem is to increase weights of some edges with minimum possible number of operations in such a way that the cost of MST in the obtained graph remains k, but MST is unique (it means that there is only one way to choose MST in the obtained graph).Your problem is to calculate the minimum number of operations required to do it." 2100
1108E2 "Array and Segments (Hard version)" "data structures,implementation" "The only difference between easy and hard versions is a number of elements in the array.You are given an array a consisting of n integers. The value of the i-th element of the array is ai.You are also given a set of m segments. The j-th segment is [lj;rj], where 1\xe2\x89\xa4lj\xe2\x89\xa4rj\xe2\x89\xa4n.You can choose some subset of the given set of segments and decrease values on each of the chosen segments by one (independently). For example, if the initial array a=[0,0,0,0,0] and the given segments are [1;3] and [2;4] then you can choose both of them and the array will become b=[\xe2\x88\x921,\xe2\x88\x922,\xe2\x88\x922,\xe2\x88\x921,0].You have to choose some subset of the given segments (each segment can be chosen at most once) in such a way that if you apply this subset of segments to the array a and obtain the array b then the value nmaxi=1bi\xe2\x88\x92nmini=1bi will be maximum possible.Note that you can choose the empty set.If there are multiple answers, you can print any.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 2100
1108E1 "Array and Segments (Easy version)" "brute force,greedy,implementation" "The only difference between easy and hard versions is a number of elements in the array.You are given an array a consisting of n integers. The value of the i-th element of the array is ai.You are also given a set of m segments. The j-th segment is [lj;rj], where 1\xe2\x89\xa4lj\xe2\x89\xa4rj\xe2\x89\xa4n.You can choose some subset of the given set of segments and decrease values on each of the chosen segments by one (independently). For example, if the initial array a=[0,0,0,0,0] and the given segments are [1;3] and [2;4] then you can choose both of them and the array will become b=[\xe2\x88\x921,\xe2\x88\x922,\xe2\x88\x922,\xe2\x88\x921,0].You have to choose some subset of the given segments (each segment can be chosen at most once) in such a way that if you apply this subset of segments to the array a and obtain the array b then the value nmaxi=1bi\xe2\x88\x92nmini=1bi will be maximum possible.Note that you can choose the empty set.If there are multiple answers, you can print any.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1800
1108D "Diverse Garland" "constructive algorithms,dp,greedy" "You have a garland consisting of n lamps. Each lamp is colored red, green or blue. The color of the i-th lamp is si (\'R\', \'G\' and \'B\' \xe2\x80\x94 colors of lamps in the garland).You have to recolor some lamps in this garland (recoloring a lamp means changing its initial color to another) in such a way that the obtained garland is diverse.A garland is called diverse if any two adjacent (consecutive) lamps (i.\xe2\x80\x89e. such lamps that the distance between their positions is 1) have distinct colors.In other words, if the obtained garland is t then for each i from 1 to n\xe2\x88\x921 the condition ti\xe2\x89\xa0ti+1 should be satisfied.Among all ways to recolor the initial garland to make it diverse you have to choose one with the minimum number of recolored lamps. If there are multiple optimal solutions, print any of them." 1400
1108C "Nice Garland" "brute force,greedy,math" "You have a garland consisting of n lamps. Each lamp is colored red, green or blue. The color of the i-th lamp is si (\'R\', \'G\' and \'B\' \xe2\x80\x94 colors of lamps in the garland).You have to recolor some lamps in this garland (recoloring a lamp means changing its initial color to another) in such a way that the obtained garland is nice.A garland is called nice if any two lamps of the same color have distance divisible by three between them. I.e. if the obtained garland is t, then for each i,j such that ti=tj should be satisfied |i\xe2\x88\x92j| mod 3=0. The value |x| means absolute value of x, the operation x mod y means remainder of x when divided by y.For example, the following garlands are nice: ""RGBRGBRG"", ""GB"", ""R"", ""GRBGRBG"", ""BRGBRGB"". The following garlands are not nice: ""RR"", ""RGBG"".Among all ways to recolor the initial garland to make it nice you have to choose one with the minimum number of recolored lamps. If there are multiple optimal solutions, print any of them." 1300
1108B "Divisors of Two Integers" "brute force,greedy,math,number theory" "Recently you have received two positive integer numbers x and y. You forgot them, but you remembered a shuffled list containing all divisors of x (including 1 and x) and all divisors of y (including 1 and y). If d is a divisor of both numbers x and y at the same time, there are two occurrences of d in the list.For example, if x=4 and y=6 then the given list can be any permutation of the list [1,2,4,1,2,3,6]. Some of the possible lists are: [1,1,2,4,6,3,2], [4,6,1,1,2,3,2] or [1,6,3,2,4,1,2].Your problem is to restore suitable positive integer numbers x and y that would yield the same list of divisors (possibly in different order).It is guaranteed that the answer exists, i.e. the given list of divisors corresponds to some positive integers x and y." 1100
1108A "Two distinct points" implementation "You are given two segments [l1;r1] and [l2;r2] on the x-axis. It is guaranteed that l1<r1 and l2<r2. Segments may intersect, overlap or even coincide with each other.  The example of two segments on the x-axis. Your problem is to find two integers a and b such that l1\xe2\x89\xa4a\xe2\x89\xa4r1, l2\xe2\x89\xa4b\xe2\x89\xa4r2 and a\xe2\x89\xa0b. In other words, you have to choose two distinct integer points in such a way that the first point belongs to the segment [l1;r1] and the second one belongs to the segment [l2;r2].It is guaranteed that the answer exists. If there are multiple answers, you can print any of them.You have to answer q independent queries." 800
1107G "Vasya and Maximum Profit" "binary search,constructive algorithms,data structures,dp,dsu" "Vasya got really tired of these credits (from problem F) and now wants to earn the money himself! He decided to make a contest to gain a profit.Vasya has n problems to choose from. They are numbered from 1 to n. The difficulty of the i-th problem is di. Moreover, the problems are given in the increasing order by their difficulties. The difficulties of all tasks are pairwise distinct. In order to add the i-th problem to the contest you need to pay ci burles to its author. For each problem in the contest Vasya gets a burles.In order to create a contest he needs to choose a consecutive subsegment of tasks.So the total earnings for the contest are calculated as follows:   if Vasya takes problem i to the contest, he needs to pay ci to its author;  for each problem in the contest Vasya gets a burles;  let gap(l,r)=maxl\xe2\x89\xa4i<r(di+1\xe2\x88\x92di)2. If Vasya takes all the tasks with indices from l to r to the contest, he also needs to pay gap(l,r). If l=r then gap(l,r)=0. Calculate the maximum profit that Vasya can earn by taking a consecutive segment of tasks." 2400
1107F "Vasya and Endless Credits" "dp,flows,graph matchings,graphs,sortings" "Vasya wants to buy himself a nice new car. Unfortunately, he lacks some money. Currently he has exactly 0 burles.However, the local bank has n credit offers. Each offer can be described with three numbers ai, bi and ki. Offers are numbered from 1 to n. If Vasya takes the i-th offer, then the bank gives him ai burles at the beginning of the month and then Vasya pays bank bi burles at the end of each month for the next ki months (including the month he activated the offer). Vasya can take the offers any order he wants.Each month Vasya can take no more than one credit offer. Also each credit offer can not be used more than once. Several credits can be active at the same time. It implies that Vasya pays bank the sum of bi over all the i of active credits at the end of each month.Vasya wants to buy a car in the middle of some month. He just takes all the money he currently has and buys the car of that exact price.Vasya don\'t really care what he\'ll have to pay the bank back after he buys a car. He just goes out of the country on his car so that the bank can\'t find him anymore.What is the maximum price that car can have?" 2600
1107E "Vasya and Binary String" dp "Vasya has a string s of length n consisting only of digits 0 and 1. Also he has an array a of length n. Vasya performs the following operation until the string becomes empty: choose some consecutive substring of equal characters, erase it from the string and glue together the remaining parts (any of them can be empty). For example, if he erases substring 111 from string 111110 he will get the string 110. Vasya gets ax points for erasing substring of length x.Vasya wants to maximize his total points, so help him with this!" 2400
1107D Compression "dp,implementation,math,number theory" "You are given a binary matrix A of size n\xc3\x97n. Let\'s denote an x-compression of the given matrix as a matrix B of size nx\xc3\x97nx such that for every i\xe2\x88\x88[1,n],j\xe2\x88\x88[1,n] the condition A[i][j]=B[\xe2\x8c\x88ix\xe2\x8c\x89][\xe2\x8c\x88jx\xe2\x8c\x89] is met.Obviously, x-compression is possible only if x divides n, but this condition is not enough. For example, the following matrix of size 2\xc3\x972 does not have any 2-compression: 01   10 For the given matrix A, find maximum x such that an x-compression of this matrix is possible.Note that the input is given in compressed form. But even though it is compressed, you\'d better use fast input." 1800
1107C Brutality "greedy,sortings,two pointers" "You are playing a new famous fighting game: Kortal Mombat XII. You have to perform a brutality on your opponent\'s character.You are playing the game on the new generation console so your gamepad have 26 buttons. Each button has a single lowercase Latin letter from \'a\' to \'z\' written on it. All the letters on buttons are pairwise distinct.You are given a sequence of hits, the i-th hit deals ai units of damage to the opponent\'s character. To perform the i-th hit you have to press the button si on your gamepad. Hits are numbered from 1 to n.You know that if you press some button more than k times in a row then it\'ll break. You cherish your gamepad and don\'t want to break any of its buttons.To perform a brutality you have to land some of the hits of the given sequence. You are allowed to skip any of them, however changing the initial order of the sequence is prohibited. The total damage dealt is the sum of ai over all i for the hits which weren\'t skipped.Note that if you skip the hit then the counter of consecutive presses the button won\'t reset.Your task is to skip some hits to deal the maximum possible total damage to the opponent\'s character and not break your gamepad buttons." 1300
1107B "Digital root" "math,number theory" "Today at the lesson of mathematics, Petya learns about the digital root.The digital root of a non-negative integer is the single digit value obtained by an iterative process of summing digits, on each iteration using the result from the previous iteration to compute a digit sum. The process continues until a single-digit number is reached. Let\'s denote the digital root of x as S(x). Then S(5)=5, S(38)=S(3+8=11)=S(1+1=2)=2, S(10)=S(1+0=1)=1.As a homework Petya got n tasks of the form: find k-th positive number whose digital root is x.Petya has already solved all the problems, but he doesn\'t know if it\'s right. Your task is to solve all n tasks from Petya\'s homework." 1000
1107A "Digits Sequence Dividing" greedy,strings "You are given a sequence s consisting of n digits from 1 to 9.You have to divide it into at least two segments (segment \xe2\x80\x94 is a consecutive sequence of elements) (in other words, you have to place separators between some digits of the sequence) in such a way that each element belongs to exactly one segment and if the resulting division will be represented as an integer numbers sequence then each next element of this sequence will be strictly greater than the previous one.More formally: if the resulting division of the sequence is t1,t2,\xe2\x80\xa6,tk, where k is the number of element in a division, then for each i from 1 to k\xe2\x88\x921 the condition ti<ti+1 (using numerical comparing, it means that the integer representations of strings are compared) should be satisfied.For example, if s=654 then you can divide it into parts [6,54] and it will be suitable division. But if you will divide it into parts [65,4] then it will be bad division because 65>4. If s=123 then you can divide it into parts [1,23], [1,2,3] but not into parts [12,3].Your task is to find any suitable division for each of the q independent queries." 900
1106F "Lunar New Year and a Recursive Sequence" "math,matrices,number theory" "Lunar New Year is approaching, and Bob received a gift from his friend recently \xe2\x80\x94 a recursive sequence! He loves this sequence very much and wants to play with it.Let f1,f2,\xe2\x80\xa6,fi,\xe2\x80\xa6 be an infinite sequence of positive integers. Bob knows that for i>k, fi can be obtained by the following recursive equation:fi=(fb1i\xe2\x88\x921\xe2\x8b\x85fb2i\xe2\x88\x922\xe2\x8b\x85\xe2\x8b\xaf\xe2\x8b\x85fbki\xe2\x88\x92k)modp,which in short isfi=(k\xe2\x88\x8fj=1fbji\xe2\x88\x92j)modp,where p=998244353 (a widely-used prime), b1,b2,\xe2\x80\xa6,bk are known integer constants, and xmody denotes the remainder of x divided by y.Bob lost the values of f1,f2,\xe2\x80\xa6,fk, which is extremely troublesome \xe2\x80\x93 these are the basis of the sequence! Luckily, Bob remembers the first k\xe2\x88\x921 elements of the sequence: f1=f2=\xe2\x80\xa6=fk\xe2\x88\x921=1 and the n-th element: fn=m. Please find any possible value of fk. If no solution exists, just tell Bob that it is impossible to recover his favorite sequence, regardless of Bob\'s sadness." 2400
1106E "Lunar New Year and Red Envelopes" "data structures,dp" "Lunar New Year is approaching, and Bob is going to receive some red envelopes with countless money! But collecting money from red envelopes is a time-consuming process itself.Let\'s describe this problem in a mathematical way. Consider a timeline from time 1 to n. The i-th red envelope will be available from time si to ti, inclusive, and contain wi coins. If Bob chooses to collect the coins in the i-th red envelope, he can do it only in an integer point of time between si and ti, inclusive, and he can\'t collect any more envelopes until time di (inclusive) after that. Here si\xe2\x89\xa4ti\xe2\x89\xa4di holds.Bob is a greedy man, he collects coins greedily \xe2\x80\x94 whenever he can collect coins at some integer time x, he collects the available red envelope with the maximum number of coins. If there are multiple envelopes with the same maximum number of coins, Bob would choose the one whose parameter d is the largest. If there are still multiple choices, Bob will choose one from them randomly.However, Alice \xe2\x80\x94 his daughter \xe2\x80\x94 doesn\'t want her father to get too many coins. She could disturb Bob at no more than m integer time moments. If Alice decides to disturb Bob at time x, he could not do anything at time x and resumes his usual strategy at the time x+1 (inclusive), which may lead to missing some red envelopes.Calculate the minimum number of coins Bob would get if Alice disturbs him optimally." 2100
1106D "Lunar New Year and a Wander" "data structures,dfs and similar,graphs,greedy,shortest paths" "Lunar New Year is approaching, and Bob decides to take a wander in a nearby park.The park can be represented as a connected graph with n nodes and m bidirectional edges. Initially Bob is at the node 1 and he records 1 on his notebook. He can wander from one node to another through those bidirectional edges. Whenever he visits a node not recorded on his notebook, he records it. After he visits all nodes at least once, he stops wandering, thus finally a permutation of nodes a1,a2,\xe2\x80\xa6,an is recorded.Wandering is a boring thing, but solving problems is fascinating. Bob wants to know the lexicographically smallest sequence of nodes he can record while wandering. Bob thinks this problem is trivial, and he wants you to solve it.A sequence x is lexicographically smaller than a sequence y if and only if one of the following holds:   x is a prefix of y, but x\xe2\x89\xa0y (this is impossible in this problem as all considered sequences have the same length);  in the first position where x and y differ, the sequence x has a smaller element than the corresponding element in y." 1500
1106C "Lunar New Year and Number Division" greedy,implementation,math,sortings "Lunar New Year is approaching, and Bob is struggling with his homework \xe2\x80\x93 a number division problem.There are n positive integers a1,a2,\xe2\x80\xa6,an on Bob\'s homework paper, where n is always an even number. Bob is asked to divide those numbers into groups, where each group must contain at least 2 numbers. Suppose the numbers are divided into m groups, and the sum of the numbers in the j-th group is sj. Bob\'s aim is to minimize the sum of the square of sj, that is m\xe2\x88\x91j=1s2j.Bob is puzzled by this hard problem. Could you please help him solve it?" 900
1106B "Lunar New Year and Food Ordering" "data structures,implementation" "Lunar New Year is approaching, and Bob is planning to go for a famous restaurant \xe2\x80\x94 ""Alice\'s"".The restaurant ""Alice\'s"" serves n kinds of food. The cost for the i-th kind is always ci. Initially, the restaurant has enough ingredients for serving exactly ai dishes of the i-th kind. In the New Year\'s Eve, m customers will visit Alice\'s one after another and the j-th customer will order dj dishes of the tj-th kind of food. The (i+1)-st customer will only come after the i-th customer is completely served.Suppose there are ri dishes of the i-th kind remaining (initially ri=ai). When a customer orders 1 dish of the i-th kind, the following principles will be processed. If ri>0, the customer will be served exactly 1 dish of the i-th kind. The cost for the dish is ci. Meanwhile, ri will be reduced by 1. Otherwise, the customer will be served 1 dish of the cheapest available kind of food if there are any. If there are multiple cheapest kinds of food, the one with the smallest index among the cheapest will be served. The cost will be the cost for the dish served and the remain for the corresponding dish will be reduced by 1. If there are no more dishes at all, the customer will leave angrily. Therefore, no matter how many dishes are served previously, the cost for the customer is 0.If the customer doesn\'t leave after the dj dishes are served, the cost for the customer will be the sum of the cost for these dj dishes.Please determine the total cost for each of the m customers." 1500
1106A "Lunar New Year and Cross Counting" implementation "Lunar New Year is approaching, and you bought a matrix with lots of ""crosses"".This matrix M of size n\xc3\x97n contains only \'X\' and \'.\' (without quotes). The element in the i-th row and the j-th column (i,j) is defined as M(i,j), where 1\xe2\x89\xa4i,j\xe2\x89\xa4n. We define a cross appearing in the i-th row and the j-th column (1<i,j<n) if and only if M(i,j)=M(i\xe2\x88\x921,j\xe2\x88\x921)=M(i\xe2\x88\x921,j+1)=M(i+1,j\xe2\x88\x921)=M(i+1,j+1)= \'X\'.The following figure illustrates a cross appearing at position (2,2) in a 3\xc3\x973 matrix. X.X.X.X.X Your task is to find out the number of crosses in the given matrix M. Two crosses are different if and only if they appear in different rows or columns." 800
1105E "Helping Hiasat" "bitmasks,brute force,dp,meet-in-the-middle" "Hiasat registered a new account in NeckoForces and when his friends found out about that, each one of them asked to use his name as Hiasat\'s handle.Luckily for Hiasat, he can change his handle in some points in time. Also he knows the exact moments friends will visit his profile page. Formally, you are given a sequence of events of two types:  1 \xe2\x80\x94 Hiasat can change his handle.  2 s \xe2\x80\x94 friend s visits Hiasat\'s profile. The friend s will be happy, if each time he visits Hiasat\'s profile his handle would be s.Hiasat asks you to help him, find the maximum possible number of happy friends he can get." 2200
1105D "Kilani and the Game" "dfs and similar,graphs,implementation,shortest paths" "Kilani is playing a game with his friends. This game can be represented as a grid of size n\xc3\x97m, where each cell is either empty or blocked, and every player has one or more castles in some cells (there are no two castles in one cell).The game is played in rounds. In each round players expand turn by turn: firstly, the first player expands, then the second player expands and so on. The expansion happens as follows: for each castle the player owns now, he tries to expand into the empty cells nearby. The player i can expand from a cell with his castle to the empty cell if it\'s possible to reach it in at most si (where si is player\'s expansion speed) moves to the left, up, right or down without going through blocked cells or cells occupied by some other player\'s castle. The player examines the set of cells he can expand to and builds a castle in each of them at once. The turned is passed to the next player after that. The game ends when no player can make a move. You are given the game field and speed of the expansion for each player. Kilani wants to know for each player how many cells he will control (have a castle their) after the game ends." 1900
1105C "Ayoub and Lost Array" combinatorics,dp,math "Ayoub had an array a of integers of size n and this array had two interesting properties:   All the integers in the array were between l and r (inclusive).  The sum of all the elements was divisible by 3. Unfortunately, Ayoub has lost his array, but he remembers the size of the array n and the numbers l and r, so he asked you to find the number of ways to restore the array. Since the answer could be very large, print it modulo 109+7 (i.e. the remainder when dividing by 109+7). In case there are no satisfying arrays (Ayoub has a wrong memory), print 0." 1500
1105B "Zuhair and Strings" "brute force,implementation,strings" "Given a string s of length n and integer k (1\xe2\x89\xa4k\xe2\x89\xa4n). The string s has a level x, if x is largest non-negative integer, such that it\'s possible to find in s:  x non-intersecting (non-overlapping) substrings of length k,  all characters of these x substrings are the same (i.e. each substring contains only one distinct character and this character is the same for all the substrings). A substring is a sequence of consecutive (adjacent) characters, it is defined by two integers i and j (1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n), denoted as s[i\xe2\x80\xa6j] = ""sisi+1\xe2\x80\xa6sj"".For example, if k=2, then:  the string ""aabb"" has level 1 (you can select substring ""aa""),  the strings ""zzzz"" and ""zzbzz"" has level 2 (you can select two non-intersecting substrings ""zz"" in each of them),  the strings ""abed"" and ""aca"" have level 0 (you can\'t find at least one substring of the length k=2 containing the only distinct character). Zuhair gave you the integer k and the string s of length n. You need to find x, the level of the string s." 1100
1105A "Salem and Sticks" "brute force,implementation" "Salem gave you n sticks with integer positive lengths a1,a2,\xe2\x80\xa6,an.For every stick, you can change its length to any other positive integer length (that is, either shrink or stretch it). The cost of changing the stick\'s length from a to b is |a\xe2\x88\x92b|, where |x| means the absolute value of x.A stick length ai is called almost good for some integer t if |ai\xe2\x88\x92t|\xe2\x89\xa41.Salem asks you to change the lengths of some sticks (possibly all or none), such that all sticks\' lengths are almost good for some positive integer t and the total cost of changing is minimum possible. The value of t is not fixed in advance and you can choose it as any positive integer. As an answer, print the value of t and the minimum cost. If there are multiple optimal choices for t, print any of them." 1100
1104B "Game with string" "data structures,implementation,math" "Two people are playing a game with a string s, consisting of lowercase latin letters. On a player\'s turn, he should choose two consecutive equal letters in the string and delete them. For example, if the string is equal to ""xaax"" than there is only one possible turn: delete ""aa"", so the string will become ""xx"". A player not able to make a turn loses.Your task is to determine which player will win if both play optimally." 1200
1104A "Splitting into digits" "constructive algorithms,implementation,math" "Vasya has his favourite number n. He wants to split it to some non-zero digits. It means, that he wants to choose some digits d1,d2,\xe2\x80\xa6,dk, such that 1\xe2\x89\xa4di\xe2\x89\xa49 for all i and d1+d2+\xe2\x80\xa6+dk=n.Vasya likes beauty in everything, so he wants to find any solution with the minimal possible number of different digits among d1,d2,\xe2\x80\xa6,dk. Help him!" 800
1103E "Radix sum" "fft,math,number theory" "Let\'s define radix sum of number a consisting of digits a1,\xe2\x80\xa6,ak and number b consisting of digits b1,\xe2\x80\xa6,bk(we add leading zeroes to the shorter number to match longer length) as number s(a,b) consisting of digits (a1+b1)mod10,\xe2\x80\xa6,(ak+bk)mod10. The radix sum of several integers is defined as follows: s(t1,\xe2\x80\xa6,tn)=s(t1,s(t2,\xe2\x80\xa6,tn))You are given an array x1,\xe2\x80\xa6,xn. The task is to compute for each integer i(0\xe2\x89\xa4i<n) number of ways to consequently choose one of the integers from the array n times, so that the radix sum of these integers is equal to i. Calculate these values modulo 258." 3400
1103D "Professional layer" bitmasks,dp "Cardbluff is popular sport game in Telegram. Each Cardbluff player has ever dreamed about entrance in the professional layer. There are n judges now in the layer and you are trying to pass the entrance exam. You have a number k \xe2\x80\x94 your skill in Cardbluff.Each judge has a number ai \xe2\x80\x94 an indicator of uncertainty about your entrance to the professional layer and a number ei \xe2\x80\x94 an experience playing Cardbluff. To pass the exam you need to convince all judges by playing with them. You can play only one game with each judge. As a result of a particular game, you can divide the uncertainty of i-th judge by any natural divisor of ai which is at most k. If GCD of all indicators is equal to 1, you will enter to the professional layer and become a judge.Also, you want to minimize the total amount of spent time. So, if you play with x judges with total experience y you will spend x\xe2\x8b\x85y seconds.Print minimal time to enter to the professional layer or \xe2\x88\x921 if it\'s impossible." 3100
1103C "Johnny Solving" "constructive algorithms,dfs and similar,graphs,math" "Today is tuesday, that means there is a dispute in JOHNNY SOLVING team again: they try to understand who is Johnny and who is Solving. That\'s why guys asked Umnik to help them. Umnik gave guys a connected graph with n vertices without loops and multiedges, such that a degree of any vertex is at least 3, and also he gave a number 1\xe2\x89\xa4k\xe2\x89\xa4n. Because Johnny is not too smart, he promised to find a simple path with length at least nk in the graph. In reply, Solving promised to find k simple by vertices cycles with representatives, such that:   Length of each cycle is at least 3.  Length of each cycle is not divisible by 3.  In each cycle must be a representative - vertex, which belongs only to this cycle among all printed cycles. You need to help guys resolve the dispute, for that you need to find a solution for Johnny: a simple path with length at least nk (n is not necessarily divided by k), or solution for Solving: k cycles that satisfy all the conditions above. If there is no any solution - print \xe2\x88\x921." 2700
1103B "Game with modulo" "binary search,constructive algorithms,interactive" "This is an interactive problem.Vasya and Petya are going to play the following game: Petya has some positive integer number a. After that Vasya should guess this number using the following questions. He can say a pair of non-negative integer numbers (x,y). Petya will answer him:   ""x"", if (xmoda)\xe2\x89\xa5(ymoda).  ""y"", if (xmoda)<(ymoda). We define (xmoda) as a remainder of division x by a.Vasya should guess the number a using no more, than 60 questions.It\'s guaranteed that Petya has a number, that satisfies the inequality 1\xe2\x89\xa4a\xe2\x89\xa4109.Help Vasya playing this game and write a program, that will guess the number a." 2000
1103A "Grid game" "constructive algorithms,implementation" "You are given a 4x4 grid. You play a game \xe2\x80\x94 there is a sequence of tiles, each of them is either 2x1 or 1x2. Your task is to consequently place all tiles from the given sequence in the grid. When tile is placed, each cell which is located in fully occupied row or column is deleted (cells are deleted at the same time independently). You can place tile in the grid at any position, the only condition is that tiles (and tile parts) should not overlap. Your goal is to proceed all given figures and avoid crossing at any time." 1400
1102F "Elongated Matrix" "binary search,bitmasks,brute force,dp,graphs" "You are given a matrix a, consisting of n rows and m columns. Each cell contains an integer in it.You can change the order of rows arbitrarily (including leaving the initial order), but you can\'t change the order of cells in a row. After you pick some order of rows, you traverse the whole matrix the following way: firstly visit all cells of the first column from the top row to the bottom one, then the same for the second column and so on. During the traversal you write down the sequence of the numbers on the cells in the same order you visited them. Let that sequence be s1,s2,\xe2\x80\xa6,snm. The traversal is k-acceptable if for all i (1\xe2\x89\xa4i\xe2\x89\xa4nm\xe2\x88\x921) |si\xe2\x88\x92si+1|\xe2\x89\xa5k.Find the maximum integer k such that there exists some order of rows of matrix a that it produces a k-acceptable traversal." 2000
1102E "Monotonic Renumeration" combinatorics,sortings "You are given an array a consisting of n integers. Let\'s denote monotonic renumeration of array a as an array b consisting of n integers such that all of the following conditions are met:  b1=0;  for every pair of indices i and j such that 1\xe2\x89\xa4i,j\xe2\x89\xa4n, if ai=aj, then bi=bj (note that if ai\xe2\x89\xa0aj, it is still possible that bi=bj);  for every index i\xe2\x88\x88[1,n\xe2\x88\x921] either bi=bi+1 or bi+1=bi+1. For example, if a=[1,2,1,2,3], then two possible monotonic renumerations of a are b=[0,0,0,0,0] and b=[0,0,0,0,1].Your task is to calculate the number of different monotonic renumerations of a. The answer may be large, so print it modulo 998244353." 1700
1102D "Balanced Ternary String" greedy,strings "You are given a string s consisting of exactly n characters, and each character is either \'0\', \'1\' or \'2\'. Such strings are called ternary strings.Your task is to replace minimum number of characters in this string with other characters to obtain a balanced ternary string (balanced ternary string is a ternary string such that the number of characters \'0\' in this string is equal to the number of characters \'1\', and the number of characters \'1\' (and \'0\' obviously) is equal to the number of characters \'2\').Among all possible balanced ternary strings you have to obtain the lexicographically (alphabetically) smallest.Note that you can neither remove characters from the string nor add characters to the string. Also note that you can replace the given characters only with characters \'0\', \'1\' and \'2\'.It is guaranteed that the answer exists." 1500
1102C "Doors Breaking and Repairing" games "You are policeman and you are playing a game with Slavik. The game is turn-based and each turn consists of two phases. During the first phase you make your move and during the second phase Slavik makes his move.There are n doors, the i-th door initially has durability equal to ai.During your move you can try to break one of the doors. If you choose door i and its current durability is bi then you reduce its durability to max(0,bi\xe2\x88\x92x) (the value x is given).During Slavik\'s move he tries to repair one of the doors. If he chooses door i and its current durability is bi then he increases its durability to bi+y (the value y is given). Slavik cannot repair doors with current durability equal to 0.The game lasts 10100 turns. If some player cannot make his move then he has to skip it.Your goal is to maximize the number of doors with durability equal to 0 at the end of the game. You can assume that Slavik wants to minimize the number of such doors. What is the number of such doors in the end if you both play optimally?" 1200
1102B "Array K-Coloring" greedy,sortings "You are given an array a consisting of n integer numbers.You have to color this array in k colors in such a way that:   Each element of the array should be colored in some color;  For each i from 1 to k there should be at least one element colored in the i-th color in the array;  For each i from 1 to k all elements colored in the i-th color should be distinct. Obviously, such coloring might be impossible. In this case, print ""NO"". Otherwise print ""YES"" and any coloring (i.e. numbers c1,c2,\xe2\x80\xa6cn, where 1\xe2\x89\xa4ci\xe2\x89\xa4k and ci is the color of the i-th element of the given array) satisfying the conditions above. If there are multiple answers, you can print any." 1400
1102A "Integer Sequence Dividing" math "You are given an integer sequence 1,2,\xe2\x80\xa6,n. You have to divide it into two sets A and B in such a way that each element belongs to exactly one set and |sum(A)\xe2\x88\x92sum(B)| is minimum possible.The value |x| is the absolute value of x and sum(S) is the sum of elements of the set S." 800
1101G "(Zero XOR Subset)-less" math,matrices "You are given an array a1,a2,\xe2\x80\xa6,an of integer numbers.Your task is to divide the array into the maximum number of segments in such a way that:  each element is contained in exactly one segment;  each segment contains at least one element;  there doesn\'t exist a non-empty subset of segments such that bitwise XOR of the numbers from them is equal to 0. Print the maximum number of segments the array can be divided into. Print -1 if no suitable division exists." 2300
1101F "Trucks and Cities" "binary search,dp" "There are n cities along the road, which can be represented as a straight line. The i-th city is situated at the distance of ai kilometers from the origin. All cities are situated in the same direction from the origin. There are m trucks travelling from one city to another. Each truck can be described by 4 integers: starting city si, finishing city fi, fuel consumption ci and number of possible refuelings ri. The i-th truck will spend ci litres of fuel per one kilometer. When a truck arrives in some city, it can be refueled (but refueling is impossible in the middle of nowhere). The i-th truck can be refueled at most ri times. Each refueling makes truck\'s gas-tank full. All trucks start with full gas-tank.All trucks will have gas-tanks of the same size V litres. You should find minimum possible V such that all trucks can reach their destinations without refueling more times than allowed." 2400
1101E "Polycarp\'s New Job" implementation "Polycarp has recently got himself a new job. He now earns so much that his old wallet can\'t even store all the money he has.Berland bills somehow come in lots of different sizes. However, all of them are shaped as rectangles (possibly squares). All wallets are also produced in form of rectangles (possibly squares).A bill x\xc3\x97y fits into some wallet h\xc3\x97w if either x\xe2\x89\xa4h and y\xe2\x89\xa4w or y\xe2\x89\xa4h and x\xe2\x89\xa4w. Bills can overlap with each other in a wallet and an infinite amount of bills can fit into a wallet. That implies that all the bills Polycarp currently have fit into a wallet if every single one of them fits into it independently of the others.Now you are asked to perform the queries of two types:  + x y \xe2\x80\x94 Polycarp earns a bill of size x\xc3\x97y;  ? h w \xe2\x80\x94 Polycarp wants to check if all the bills he has earned to this moment fit into a wallet of size h\xc3\x97w. It is guaranteed that there is at least one query of type 1 before the first query of type 2 and that there is at least one query of type 2 in the input data.For each query of type 2 print ""YES"" if all the bills he has earned to this moment fit into a wallet of given size. Print ""NO"" otherwise." 1500
1101D "GCD Counting" "data structures,dfs and similar,dp,number theory,trees" "You are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to ai.Let\'s denote the function g(x,y) as the greatest common divisor of the numbers written on the vertices belonging to the simple path from vertex x to vertex y (including these two vertices). Also let\'s denote dist(x,y) as the number of vertices on the simple path between vertices x and y, including the endpoints. dist(x,x)=1 for every vertex x.Your task is calculate the maximum value of dist(x,y) among such pairs of vertices that g(x,y)>1." 2000
1101C "Division and Union" sortings "There are n segments [li,ri] for 1\xe2\x89\xa4i\xe2\x89\xa4n. You should divide all segments into two non-empty groups in such way that there is no pair of segments from different groups which have at least one common point, or say that it\'s impossible to do it. Each segment should belong to exactly one group.To optimize testing process you will be given multitest." 1500
1101B Accordion greedy,implementation "An accordion is a string (yes, in the real world accordions are musical instruments, but let\'s forget about it for a while) which can be represented as a concatenation of: an opening bracket (ASCII code 091), a colon (ASCII code 058), some (possibly zero) vertical line characters (ASCII code 124), another colon, and a closing bracket (ASCII code 093). The length of the accordion is the number of characters in it.For example, [::], [:||:] and [:|||:] are accordions having length 4, 6 and 7. (:|:), {:||:}, [:], ]:||:[ are not accordions. You are given a string s. You want to transform it into an accordion by removing some (possibly zero) characters from it. Note that you may not insert new characters or reorder existing ones. Is it possible to obtain an accordion by removing characters from s, and if so, what is the maximum possible length of the result?" 1300
1101A "Minimum Integer" math "You are given q queries in the following form:Given three integers li, ri and di, find minimum positive integer xi such that it is divisible by di and it does not belong to the segment [li,ri].Can you answer all the queries?Recall that a number x belongs to segment [l,r] if l\xe2\x89\xa4x\xe2\x89\xa4r." 1000
1100F "Ivan and Burgers" "data structures,divide and conquer,greedy,math" "Ivan loves burgers and spending money. There are n burger joints on the street where Ivan lives. Ivan has q friends, and the i-th friend suggested to meet at the joint li and walk to the joint ri (li\xe2\x89\xa4ri). While strolling with the i-th friend Ivan can visit all joints x which satisfy li\xe2\x89\xa4x\xe2\x89\xa4ri.For each joint Ivan knows the cost of the most expensive burger in it, it costs ci burles. Ivan wants to visit some subset of joints on his way, in each of them he will buy the most expensive burger and spend the most money. But there is a small issue: his card broke and instead of charging him for purchases, the amount of money on it changes as follows.If Ivan had d burles before the purchase and he spent c burles at the joint, then after the purchase he would have d\xe2\x8a\x95c burles, where \xe2\x8a\x95 denotes the bitwise XOR operation.Currently Ivan has 22100\xe2\x88\x921 burles and he wants to go out for a walk. Help him to determine the maximal amount of burles he can spend if he goes for a walk with the friend i. The amount of burles he spends is defined as the difference between the initial amount on his account and the final account." 2500
1100E "Andrew and Taxi" "binary search,dfs and similar,graphs" "Andrew prefers taxi to other means of transport, but recently most taxi drivers have been acting inappropriately. In order to earn more money, taxi drivers started to drive in circles. Roads in Andrew\'s city are one-way, and people are not necessary able to travel from one part to another, but it pales in comparison to insidious taxi drivers.The mayor of the city decided to change the direction of certain roads so that the taxi drivers wouldn\'t be able to increase the cost of the trip endlessly. More formally, if the taxi driver is on a certain crossroads, they wouldn\'t be able to reach it again if he performs a nonzero trip. Traffic controllers are needed in order to change the direction the road goes. For every road it is known how many traffic controllers are needed to change the direction of the road to the opposite one. It is allowed to change the directions of roads one by one, meaning that each traffic controller can participate in reversing two or more roads.You need to calculate the minimum number of traffic controllers that you need to hire to perform the task and the list of the roads that need to be reversed." 2200
1100D "Dasha and Chess" "constructive algorithms,games,interactive" "This is an interactive task.Dasha and NN like playing chess. While playing a match they decided that normal chess isn\'t interesting enough for them, so they invented a game described below.There are 666 black rooks and 1 white king on the chess board of size 999\xc3\x97999. The white king wins if he gets checked by rook, or, in other words, if he moves onto the square which shares either a row or column with a black rook.The sides take turns, starting with white. NN plays as a white king and on each of his turns he moves a king to one of the squares that are adjacent to his current position either by side or diagonally, or, formally, if the king was on the square (x,y), it can move to the square (nx,ny) if and only max(|nx\xe2\x88\x92x|,|ny\xe2\x88\x92y|)=1 , 1\xe2\x89\xa4nx,ny\xe2\x89\xa4999. NN is also forbidden from moving onto the squares occupied with black rooks, however, he can move onto the same row or column as a black rook.Dasha, however, neglects playing by the chess rules, and instead of moving rooks normally she moves one of her rooks on any space devoid of other chess pieces. It is also possible that the rook would move onto the same square it was before and the position wouldn\'t change. However, she can\'t move the rook on the same row or column with the king.Each player makes 2000 turns, if the white king wasn\'t checked by a black rook during those turns, black wins. NN doesn\'t like losing, but thinks the task is too difficult for him, so he asks you to write a program that will always win playing for the white king. Note that Dasha can see your king and play depending on its position." 2500
1100C "NN and the Optical Illusion" "binary search,geometry,math" "NN is an experienced internet user and that means he spends a lot of time on the social media. Once he found the following image on the Net, which asked him to compare the sizes of inner circles:  It turned out that the circles are equal. NN was very surprised by this fact, so he decided to create a similar picture himself.He managed to calculate the number of outer circles n and the radius of the inner circle r. NN thinks that, using this information, you can exactly determine the radius of the outer circles R so that the inner circle touches all of the outer ones externally and each pair of neighboring outer circles also touches each other. While NN tried very hard to guess the required radius, he didn\'t manage to do that. Help NN find the required radius for building the required picture." 1200
1100B "Build a Contest" "data structures,implementation" "Arkady coordinates rounds on some not really famous competitive programming platform. Each round features n problems of distinct difficulty, the difficulties are numbered from 1 to n.To hold a round Arkady needs n new (not used previously) problems, one for each difficulty. As for now, Arkady creates all the problems himself, but unfortunately, he can\'t just create a problem of a desired difficulty. Instead, when he creates a problem, he evaluates its difficulty from 1 to n and puts it into the problems pool.At each moment when Arkady can choose a set of n new problems of distinct difficulties from the pool, he holds a round with these problems and removes them from the pool. Arkady always creates one problem at a time, so if he can hold a round after creating a problem, he immediately does it.You are given a sequence of problems\' difficulties in the order Arkady created them. For each problem, determine whether Arkady held the round right after creating this problem, or not. Initially the problems pool is empty." 1300
1100A "Roman and Browser" implementation "This morning, Roman woke up and opened the browser with n opened tabs numbered from 1 to n. There are two kinds of tabs: those with the information required for the test and those with social network sites. Roman decided that there are too many tabs open so he wants to close some of them.He decided to accomplish this by closing every k-th (2\xe2\x89\xa4k\xe2\x89\xa4n\xe2\x88\x921) tab. Only then he will decide whether he wants to study for the test or to chat on the social networks. Formally, Roman will choose one tab (let its number be b) and then close all tabs with numbers c=b+i\xe2\x8b\x85k that satisfy the following condition: 1\xe2\x89\xa4c\xe2\x89\xa4n and i is an integer (it may be positive, negative or zero).For example, if k=3, n=14 and Roman chooses b=8, then he will close tabs with numbers 2, 5, 8, 11 and 14.After closing the tabs Roman will calculate the amount of remaining tabs with the information for the test (let\'s denote it e) and the amount of remaining social network tabs (s). Help Roman to calculate the maximal absolute value of the difference of those values |e\xe2\x88\x92s| so that it would be easy to decide what to do next." 1000
1099F Cookies "binary search,data structures,dfs and similar,dp,games,trees" "Mitya and Vasya are playing an interesting game. They have a rooted tree with n vertices, and the vertices are indexed from 1 to n. The root has index 1. Every other vertex i\xe2\x89\xa52 has its parent pi, and vertex i is called a child of vertex pi.There are some cookies in every vertex of the tree: there are xi cookies in vertex i. It takes exactly ti time for Mitya to eat one cookie in vertex i. There is also a chip, which is initially located in the root of the tree, and it takes li time to move the chip along the edge connecting vertex i with its parent.Mitya and Vasya take turns playing, Mitya goes first.  Mitya moves the chip from the vertex, where the chip is located, to one of its children.  Vasya can remove an edge from the vertex, where the chip is located, to one of its children. Vasya can also decide to skip his turn.   Mitya can stop the game at any his turn. Once he stops the game, he moves the chip up to the root, eating some cookies along his way. Mitya can decide how many cookies he would like to eat in every vertex on his way. The total time spent on descend, ascend and eating cookies should not exceed T. Please note that in the end of the game the chip is always located in the root of the tree: Mitya can not leave the chip in any other vertex, even if he has already eaten enough cookies \xe2\x80\x94 he must move the chip back to the root (and every move from vertex v to its parent takes lv time).Find out what is the maximum number of cookies Mitya can eat, regardless of Vasya\'s actions." 2400
1099C Postcard "constructive algorithms,implementation" "Andrey received a postcard from Irina. It contained only the words ""Hello, Andrey!"", and a strange string consisting of lowercase Latin letters, snowflakes and candy canes. Andrey thought that this string is an encrypted message, and decided to decrypt it.Andrey noticed that snowflakes and candy canes always stand after the letters, so he supposed that the message was encrypted as follows. Candy cane means that the letter before it can be removed, or can be left. A snowflake means that the letter before it can be removed, left, or repeated several times.For example, consider the following string:   This string can encode the message \xc2\xabhappynewyear\xc2\xbb. For this, candy canes and snowflakes should be used as follows:   candy cane 1: remove the letter w,  snowflake 1: repeat the letter p twice,  candy cane 2: leave the letter n,  snowflake 2: remove the letter w,  snowflake 3: leave the letter e.   Please note that the same string can encode different messages. For example, the string above can encode \xc2\xabhayewyar\xc2\xbb, \xc2\xabhapppppynewwwwwyear\xc2\xbb, and other messages.Andrey knows that messages from Irina usually have a length of k letters. Help him to find out if a given string can encode a message of k letters, and if so, give an example of such a message." 1200
1099B "Squares and Segments" "binary search,constructive algorithms,math" "Little Sofia is in fourth grade. Today in the geometry lesson she learned about segments and squares. On the way home, she decided to draw n squares in the snow with a side length of 1. For simplicity, we assume that Sofia lives on a plane and can draw only segments of length 1, parallel to the coordinate axes, with vertices at integer points.In order to draw a segment, Sofia proceeds as follows. If she wants to draw a vertical segment with the coordinates of the ends (x,y) and (x,y+1). Then Sofia looks if there is already a drawn segment with the coordinates of the ends (x\xe2\x80\xb2,y) and (x\xe2\x80\xb2,y+1) for some x\xe2\x80\xb2. If such a segment exists, then Sofia quickly draws a new segment, using the old one as a guideline. If there is no such segment, then Sofia has to take a ruler and measure a new segment for a long time. Same thing happens when Sofia wants to draw a horizontal segment, but only now she checks for the existence of a segment with the same coordinates x, x+1 and the differing coordinate y.For example, if Sofia needs to draw one square, she will have to draw two segments using a ruler:   After that, she can draw the remaining two segments, using the first two as a guide:   If Sofia needs to draw two squares, she will have to draw three segments using a ruler:   After that, she can draw the remaining four segments, using the first three as a guide:   Sofia is in a hurry, so she wants to minimize the number of segments that she will have to draw with a ruler without a guide. Help her find this minimum number." 1100
1099A Snowball implementation "Today\'s morning was exceptionally snowy. Meshanya decided to go outside and noticed a huge snowball rolling down the mountain! Luckily, there are two stones on that mountain.Initially, snowball is at height h and it has weight w. Each second the following sequence of events happens: snowball\'s weights increases by i, where i \xe2\x80\x94 is the current height of snowball, then snowball hits the stone (if it\'s present at the current height), then snowball moves one meter down. If the snowball reaches height zero, it stops.There are exactly two stones on the mountain. First stone has weight u1 and is located at height d1, the second one \xe2\x80\x94 u2 and d2 respectively. When the snowball hits either of two stones, it loses weight equal to the weight of that stone. If after this snowball has negative weight, then its weight becomes zero, but the snowball continues moving as before.  Find the weight of the snowball when it stops moving, that is, it reaches height 0." 800
1098F \xd0\x96-function "string suffix structures,strings" "The length of the longest common prefix of two strings s=s1s2\xe2\x80\xa6sn and t=t1t2\xe2\x80\xa6tm is defined as the maximum k\xe2\x89\xa4min(n,m) such that s1s2\xe2\x80\xa6sk equals t1t2\xe2\x80\xa6tk. Let\'s denote the longest common prefix of two strings s and t as lcp(s,t).Z-function of a string s1s2\xe2\x80\xa6sn is a sequence of integers z1,z2,\xe2\x80\xa6,zn, where zi=lcp(s1s2\xe2\x80\xa6sn,  sisi+1\xe2\x80\xa6sn). \xd0\x96-function of a string s is defined as z1+z2+\xe2\x80\xa6+zn.You\'re given a string s=s1s2\xe2\x80\xa6sn and q queries. Each query is described by two integers li and ri, where 1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n. The answer for the query is defined as \xd0\x96-function of the string slisli+1\xe2\x80\xa6sri." 3500
1098E "Fedya the Potter" "binary search,implementation,math,number theory" "Fedya loves problems involving data structures. Especially ones about different queries on subsegments. Fedya had a nice array a1,a2,\xe2\x80\xa6an and a beautiful data structure. This data structure, given l and r, 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, could find the greatest integer d, such that d divides each of al, al+1, ..., ar. Fedya really likes this data structure, so he applied it to every non-empty contiguous subarray of array a, put all answers into the array and sorted it. He called this array b. It\'s easy to see that array b contains n(n+1)/2 elements.After that, Fedya implemented another cool data structure, that allowed him to find sum bl+bl+1+\xe2\x80\xa6+br for given l and r, 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n(n+1)/2. Surely, Fedya applied this data structure to every contiguous subarray of array b, called the result c and sorted it. Help Fedya find the lower median of array c.Recall that for a sorted array of length k the lower median is an element at position \xe2\x8c\x8ak+12\xe2\x8c\x8b, if elements of the array are enumerated starting from 1. For example, the lower median of array (1,1,2,3,6) is 2, and the lower median of (0,17,23,96) is 17." 3400
1098D Eels "data structures" "Vasya is a big fish lover, and his parents gave him an aquarium for the New Year. Vasya does not have a degree in ichthyology, so he thinks that filling a new aquarium with eels is a good idea. Unfortunately, eels are predators, so Vasya decided to find out how dangerous this idea was.Getting into one aquarium, eels fight each other until exactly one fish remains. When two eels fight, the big one eats the smaller one (if their weights are equal, then one of them will still eat the other). Namely, let n eels be initially in an aquarium, and the i-th of them have a weight of xi. Then n\xe2\x88\x921 battles will occur between them, as a result of which, only one eel will survive. In a battle of two eels with weights a and b, where a\xe2\x89\xa4b, eel of weight a will be eaten and disappear from the aquarium, and eel of weight b will increase its weight to a+b.A battle between two eels with weights a and b, where a\xe2\x89\xa4b, is considered dangerous if b\xe2\x89\xa42a. For a given set of eels, danger is defined as the maximum number of dangerous battles that can occur among these eels if they are placed in one aquarium.Now Vasya is planning, which eels he wants to put into an aquarium. He has some set of eels (initially empty). He makes a series of operations with this set. With each operation, he either adds one eel in the set, or removes one eel from the set. Vasya asks you to calculate the danger of the current set of eels after each operation." 2800
1098C "Construct a tree" "binary search,constructive algorithms,dfs and similar,graphs,greedy,trees" "Misha walked through the snowy forest and he was so fascinated by the trees to decide to draw his own tree!Misha would like to construct a rooted tree with n vertices, indexed from 1 to n, where the root has index 1. Every other vertex has a parent pi, and i is called a child of vertex pi. Vertex u belongs to the subtree of vertex v iff v is reachable from u while iterating over the parents (u, pu, ppu, ...). Clearly, v belongs to its own subtree, and the number of vertices in the subtree is called the size of the subtree. Misha is only interested in trees where every vertex belongs to the subtree of vertex 1.Below there is a tree with 6 vertices. The subtree of vertex 2 contains vertices 2, 3, 4, 5. Hence the size of its subtree is 4.   The branching coefficient of the tree is defined as the maximum number of children in any vertex. For example, for the tree above the branching coefficient equals 2. Your task is to construct a tree with n vertices such that the sum of the subtree sizes for all vertices equals s, and the branching coefficient is minimum possible." 2400
1098B "Nice table" "brute force,constructive algorithms,greedy,math" "You are given an n\xc3\x97m table, consisting of characters \xc2\xabA\xc2\xbb, \xc2\xabG\xc2\xbb, \xc2\xabC\xc2\xbb, \xc2\xabT\xc2\xbb. Let\'s call a table nice, if every 2\xc3\x972 square contains all four distinct characters. Your task is to find a nice table (also consisting of \xc2\xabA\xc2\xbb, \xc2\xabG\xc2\xbb, \xc2\xabC\xc2\xbb, \xc2\xabT\xc2\xbb), that differs from the given table in the minimum number of characters." 2100
1098A "Sum in the tree" "constructive algorithms,dfs and similar,greedy,trees" "Mitya has a rooted tree with n vertices indexed from 1 to n, where the root has index 1. Each vertex v initially had an integer number av\xe2\x89\xa50 written on it. For every vertex v Mitya has computed sv: the sum of all values written on the vertices on the path from vertex v to the root, as well as hv \xe2\x80\x94 the depth of vertex v, which denotes the number of vertices on the path from vertex v to the root. Clearly, s1=a1 and h1=1.Then Mitya erased all numbers av, and by accident he also erased all values sv for vertices with even depth (vertices with even hv). Your task is to restore the values av for every vertex, or determine that Mitya made a mistake. In case there are multiple ways to restore the values, you\'re required to find one which minimizes the total sum of values av for all vertices in the tree." 1600
1097H "Mateusz and an Infinite Sequence" "bitmasks,brute force,dp,strings" "A Thue-Morse-Radecki-Mateusz sequence (Thorse-Radewoosh sequence in short) is an infinite sequence constructed from a finite sequence gen of length d and an integer m, obtained in the following sequence of steps:  In the beginning, we define the one-element sequence M0=(0). In the k-th step, k\xe2\x89\xa51, we define the sequence Mk to be the concatenation of the d copies of Mk\xe2\x88\x921. However, each of them is altered slightly \xe2\x80\x94 in the i-th of them (1\xe2\x89\xa4i\xe2\x89\xa4d), each element x is changed to (x+geni)(modm). For instance, if we pick gen=(0,1,2) and m=4:   M0=(0),  M1=(0,1,2),  M2=(0,1,2,1,2,3,2,3,0),  M3=(0,1,2,1,2,3,2,3,0,1,2,3,2,3,0,3,0,1,2,3,0,3,0,1,0,1,2), and so on. As you can see, as long as the first element of gen is 0, each consecutive step produces a sequence whose prefix is the sequence generated in the previous step. Therefore, we can define the infinite Thorse-Radewoosh sequence M\xe2\x88\x9e as the sequence obtained by applying the step above indefinitely. For the parameters above, M\xe2\x88\x9e=(0,1,2,1,2,3,2,3,0,1,2,3,2,3,0,3,0,1,\xe2\x80\xa6).Mateusz picked a sequence gen and an integer m, and used them to obtain a Thorse-Radewoosh sequence M\xe2\x88\x9e. He then picked two integers l, r, and wrote down a subsequence of this sequence A:=((M\xe2\x88\x9e)l,(M\xe2\x88\x9e)l+1,\xe2\x80\xa6,(M\xe2\x88\x9e)r).Note that we use the 1-based indexing both for M\xe2\x88\x9e and A.Mateusz has his favorite sequence B with length n, and would like to see how large it is compared to A. Let\'s say that B majorizes sequence X of length n (let\'s denote it as B\xe2\x89\xa5X) if and only if for all i\xe2\x88\x88{1,2,\xe2\x80\xa6,n}, we have Bi\xe2\x89\xa5Xi.He now asks himself how many integers x in the range [1,|A|\xe2\x88\x92n+1] there are such that B\xe2\x89\xa5(Ax,Ax+1,Ax+2,\xe2\x80\xa6,Ax+n\xe2\x88\x921). As both sequences were huge, answering the question using only his pen and paper turned out to be too time-consuming. Can you help him automate his research?" 3400
1097G "Vladislav and a Great Legend" combinatorics,dp,trees "A great legend used to be here, but some troll hacked Codeforces and erased it. Too bad for us, but in the troll society he earned a title of an ultimate-greatest-over troll. At least for them, it\'s something good. And maybe a formal statement will be even better for us?You are given a tree T with n vertices numbered from 1 to n. For every non-empty subset X of vertices of T, let f(X) be the minimum number of edges in the smallest connected subtree of T which contains every vertex from X.You\'re also given an integer k. You need to compute the sum of (f(X))k among all non-empty subsets of vertices, that is:\xe2\x88\x91X\xe2\x8a\x86{1,2,\xe2\x80\xa6,n},X\xe2\x89\xa0\xe2\x88\x85(f(X))k.As the result might be very large, output it modulo 109+7." 3000
1097F "Alex and a TV Show" "bitmasks,combinatorics,number theory" "Alex decided to try his luck in TV shows. He once went to the quiz named ""What\'s That Word?!"". After perfectly answering the questions ""How is a pseudonym commonly referred to in the Internet?"" (""Um... a nick?""), ""After which famous inventor we name the unit of the magnetic field strength?"" (""Um... Nikola Tesla?"") and ""Which rock band performs ""How You Remind Me""?"" (""Um... Nickelback?""), he decided to apply to a little bit more difficult TV show: ""What\'s in This Multiset?!"".The rules of this TV show are as follows: there are n multisets numbered from 1 to n. Each of them is initially empty. Then, q events happen; each of them is in one of the four possible types:  1 x v \xe2\x80\x94 set the x-th multiset to a singleton {v}. 2 x y z \xe2\x80\x94 set the x-th multiset to a union of the y-th and the z-th multiset. For example: {1,3}\xe2\x88\xaa{1,4,4}={1,1,3,4,4}. 3 x y z \xe2\x80\x94 set the x-th multiset to a product of the y-th and the z-th multiset. The product A\xc3\x97B of two multisets A, B is defined as {gcd(a,b)\xe2\x88\xa3a\xe2\x88\x88A,b\xe2\x88\x88B}, where gcd(p,q) is the greatest common divisor of p and q. For example: {2,2,3}\xc3\x97{1,4,6}={1,2,2,1,2,2,1,1,3}. 4 x v \xe2\x80\x94 the participant is asked how many times number v occurs in the x-th multiset. As the quiz turned out to be too hard in the past, participants should now give the answers modulo 2 only. Note, that x, y and z described above are not necessarily different. In events of types 2 and 3, the sum or the product is computed first, and then the assignment is performed.Alex is confused by the complicated rules of the show. Can you help him answer the requests of the 4-th type?" 2500
1097E "Egor and an RPG game" "constructive algorithms,greedy" "One Saturday afternoon Egor was playing his favorite RPG game. While discovering new lands and territories, he came across the following sign:  Egor is a passionate player, but he is an algorithmician as well. That\'s why he instantly spotted four common letters in two words on the sign above \xe2\x80\x94 if we permute the letters ""R"", ""E"", ""G"", ""O"" from the first word, we can obtain the letters ""O"", ""G"", ""R"", ""E"". Egor got inspired by the sign and right away he came up with a problem about permutations.You are given a permutation of length n. You have to split it into some non-empty subsequences so that each element of the permutation belongs to exactly one subsequence. Each subsequence must be monotonic \xe2\x80\x94 that is, either increasing or decreasing.Sequence is called to be a subsequence if it can be derived from permutation by deleting some (possibly none) elements without changing the order of the remaining elements.The number of subsequences should be small enough \xe2\x80\x94 let f(n) be the minimum integer k such that every permutation of length n can be partitioned into at most k monotonic subsequences.You need to split the permutation into at most f(n) monotonic subsequences." 3400
1097D "Makoto and a Blackboard" "dp,math,number theory,probabilities" "Makoto has a big blackboard with a positive integer n written on it. He will perform the following action exactly k times:Suppose the number currently written on the blackboard is v. He will randomly pick one of the divisors of v (possibly 1 and v) and replace v with this divisor. As Makoto uses his famous random number generator (RNG) and as he always uses 58 as his generator seed, each divisor is guaranteed to be chosen with equal probability.He now wonders what is the expected value of the number written on the blackboard after k steps.It can be shown that this value can be represented as PQ where P and Q are coprime integers and Q\xe2\x89\xa20(mod109+7). Print the value of P\xe2\x8b\x85Q\xe2\x88\x921 modulo 109+7." 2200
1097C "Yuhao and a Parenthesis" greedy,implementation "One day, Yuhao came across a problem about checking if some bracket sequences are correct bracket sequences.A bracket sequence is any non-empty sequence of opening and closing parentheses. A bracket sequence is called a correct bracket sequence if it\'s possible to obtain a correct arithmetic expression by inserting characters ""+"" and ""1"" into this sequence. For example, the sequences ""(())()"", ""()"" and ""(()(()))"" are correct, while the bracket sequences "")("", ""(()"" and ""(()))("" are not correct.Yuhao found this problem too simple for him so he decided to make the problem harder. You are given many (not necessarily correct) bracket sequences. The task is to connect some of them into ordered pairs so that each bracket sequence occurs in at most one pair and the concatenation of the bracket sequences in each pair is a correct bracket sequence. The goal is to create as many pairs as possible.This problem unfortunately turned out to be too difficult for Yuhao. Can you help him and solve it?" 1400
1097B "Petr and a Combination Lock" "bitmasks,brute force,dp" "Petr has just bought a new car. He\'s just arrived at the most known Petersburg\'s petrol station to refuel it when he suddenly discovered that the petrol tank is secured with a combination lock! The lock has a scale of 360 degrees and a pointer which initially points at zero:  Petr called his car dealer, who instructed him to rotate the lock\'s wheel exactly n times. The i-th rotation should be ai degrees, either clockwise or counterclockwise, and after all n rotations the pointer should again point at zero.This confused Petr a little bit as he isn\'t sure which rotations should be done clockwise and which should be done counterclockwise. As there are many possible ways of rotating the lock, help him and find out whether there exists at least one, such that after all n rotations the pointer will point at zero again." 1200
1097A "Gennady and a Card Game" "brute force,implementation" "Gennady owns a small hotel in the countryside where he lives a peaceful life. He loves to take long walks, watch sunsets and play cards with tourists staying in his hotel. His favorite game is called ""Mau-Mau"".To play Mau-Mau, you need a pack of 52 cards. Each card has a suit (Diamonds \xe2\x80\x94 D, Clubs \xe2\x80\x94 C, Spades \xe2\x80\x94 S, or Hearts \xe2\x80\x94 H), and a rank (2, 3, 4, 5, 6, 7, 8, 9, T, J, Q, K, or A).At the start of the game, there is one card on the table and you have five cards in your hand. You can play a card from your hand if and only if it has the same rank or the same suit as the card on the table.In order to check if you\'d be a good playing partner, Gennady has prepared a task for you. Given the card on the table and five cards in your hand, check if you can play at least one card." 800
1096G "Lucky Tickets" "divide and conquer,dp,fft" "All bus tickets in Berland have their numbers. A number consists of n digits (n is even). Only k decimal digits d1,d2,\xe2\x80\xa6,dk can be used to form ticket numbers. If 0 is among these digits, then numbers may have leading zeroes. For example, if n=4 and only digits 0 and 4 can be used, then 0000, 4004, 4440 are valid ticket numbers, and 0002, 00, 44443 are not.A ticket is lucky if the sum of first n/2 digits is equal to the sum of remaining n/2 digits. Calculate the number of different lucky tickets in Berland. Since the answer may be big, print it modulo 998244353." 2400
1096F "Inversion Expectation" dp,math,probabilities "A permutation of size n is an array of size n such that each integer from 1 to n occurs exactly once in this array. An inversion in a permutation p is a pair of indices (i,j) such that i>j and ai<aj. For example, a permutation [4,1,3,2] contains 4 inversions: (2,1), (3,1), (4,1), (4,3).You are given a permutation p of size n. However, the numbers on some positions are replaced by \xe2\x88\x921. Let the valid permutation be such a replacement of \xe2\x88\x921 in this sequence back to numbers from 1 to n in such a way that the resulting sequence is a permutation of size n.The given sequence was turned into a valid permutation randomly with the equal probability of getting each valid permutation.Calculate the expected total number of inversions in the resulting valid permutation.It can be shown that it is in the form of PQ where P and Q are non-negative integers and Q\xe2\x89\xa00. Report the value of P\xe2\x8b\x85Q\xe2\x88\x921(mod998244353)." 2300
1096E "The Top Scorer" combinatorics,dp,math,probabilities "Hasan loves playing games and has recently discovered a game called TopScore. In this soccer-like game there are p players doing penalty shoot-outs. Winner is the one who scores the most. In case of ties, one of the top-scorers will be declared as the winner randomly with equal probability.They have just finished the game and now are waiting for the result. But there\'s a tiny problem! The judges have lost the paper of scores! Fortunately they have calculated sum of the scores before they get lost and also for some of the players they have remembered a lower bound on how much they scored. However, the information about the bounds is private, so Hasan only got to know his bound.According to the available data, he knows that his score is at least r and sum of the scores is s.Thus the final state of the game can be represented in form of sequence of p integers a1,a2,\xe2\x80\xa6,ap (0\xe2\x89\xa4ai) \xe2\x80\x94 player\'s scores. Hasan is player number 1, so a1\xe2\x89\xa5r. Also a1+a2+\xe2\x8b\xaf+ap=s. Two states are considered different if there exists some position i such that the value of ai differs in these states. Once again, Hasan doesn\'t know the exact scores (he doesn\'t know his exact score as well). So he considers each of the final states to be equally probable to achieve.Help Hasan find the probability of him winning.It can be shown that it is in the form of PQ where P and Q are non-negative integers and Q\xe2\x89\xa00, P\xe2\x89\xa4Q. Report the value of P\xe2\x8b\x85Q\xe2\x88\x921(mod998244353)." 2500
1096D "Easy Problem" dp "Vasya is preparing a contest, and now he has written a statement for an easy problem. The statement is a string of length n consisting of lowercase Latin latters. Vasya thinks that the statement can be considered hard if it contains a subsequence hard; otherwise the statement is easy. For example, hard, hzazrzd, haaaaard can be considered hard statements, while har, hart and drah are easy statements. Vasya doesn\'t want the statement to be hard. He may remove some characters from the statement in order to make it easy. But, of course, some parts of the statement can be crucial to understanding. Initially the ambiguity of the statement is 0, and removing i-th character increases the ambiguity by ai (the index of each character is considered as it was in the original statement, so, for example, if you delete character r from hard, and then character d, the index of d is still 4 even though you delete it from the string had).Vasya wants to calculate the minimum ambiguity of the statement, if he removes some characters (possibly zero) so that the statement is easy. Help him to do it!Recall that subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements." 1800
1096C "Polygon for the Angle" "brute force,geometry" "You are given an angle ang. The Jury asks You to find such regular n-gon (regular polygon with n vertices) that it has three vertices a, b and c (they can be non-consecutive) with \xe2\x88\xa0abc=ang or report that there is no such n-gon.  If there are several answers, print the minimal one. It is guarantied that if answer exists then it doesn\'t exceed 998244353." 1600
1096B "Substring Removal" combinatorics,math,strings "You are given a string s of length n consisting only of lowercase Latin letters.A substring of a string is a contiguous subsequence of that string. So, string ""forces"" is substring of string ""codeforces"", but string ""coder"" is not.Your task is to calculate the number of ways to remove exactly one substring from this string in such a way that all remaining characters are equal (the number of distinct characters either zero or one).It is guaranteed that there is at least two different characters in s.Note that you can remove the whole string and it is correct. Also note that you should remove at least one character.Since the answer can be rather large (not very large though) print it modulo 998244353.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1300
1096A "Find Divisible" greedy,implementation,math "You are given a range of positive integers from l to r.Find such a pair of integers (x,y) that l\xe2\x89\xa4x,y\xe2\x89\xa4r, x\xe2\x89\xa0y and x divides y.If there are multiple answers, print any of them.You are also asked to answer T independent queries." 800
1095F "Make It Connected" dsu,graphs,greedy "You are given an undirected graph consisting of n vertices. A number is written on each vertex; the number on vertex i is ai. Initially there are no edges in the graph.You may add some edges to this graph, but you have to pay for them. The cost of adding an edge between vertices x and y is ax+ay coins. There are also m special offers, each of them is denoted by three numbers x, y and w, and means that you can add an edge connecting vertices x and y and pay w coins for it. You don\'t have to use special offers: if there is a pair of vertices x and y that has a special offer associated with it, you still may connect these two vertices paying ax+ay coins for it.What is the minimum number of coins you have to spend to make the graph connected? Recall that a graph is connected if it\'s possible to get from any vertex to any other vertex using only the edges belonging to this graph." 1900
1095E "Almost Regular Bracket Sequence" implementation "You are given a bracket sequence s consisting of n opening \'(\' and closing \')\' brackets.A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \'1\' and \'+\' between the original characters of the sequence. For example, bracket sequences ""()()"", ""(())"" are regular (the resulting expressions are: ""(1)+(1)"", ""((1+1)+1)""), and "")("" and ""("" are not.You can change the type of some bracket si. It means that if si= \')\' then you can change it to \'(\' and vice versa.Your task is to calculate the number of positions i such that if you change the type of the i-th bracket, then the resulting bracket sequence becomes regular." 1900
1095D "Circular Dance" implementation "There are n kids, numbered from 1 to n, dancing in a circle around the Christmas tree. Let\'s enumerate them in a clockwise direction as p1, p2, ..., pn (all these numbers are from 1 to n and are distinct, so p is a permutation). Let the next kid for a kid pi be kid pi+1 if i<n and p1 otherwise. After the dance, each kid remembered two kids: the next kid (let\'s call him x) and the next kid for x. Each kid told you which kids he/she remembered: the kid i remembered kids ai,1 and ai,2. However, the order of ai,1 and ai,2 can differ from their order in the circle.  Example: 5 kids in a circle, p=[3,2,4,1,5] (or any cyclic shift). The information kids remembered is: a1,1=3, a1,2=5; a2,1=1, a2,2=4; a3,1=2, a3,2=4; a4,1=1, a4,2=5; a5,1=2, a5,2=3. You have to restore the order of the kids in the circle using this information. If there are several answers, you may print any. It is guaranteed that at least one solution exists.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1600
1095C "Powers Of Two" bitmasks,greedy "A positive integer x is called a power of two if it can be represented as x=2y, where y is a non-negative integer. So, the powers of two are 1,2,4,8,16,\xe2\x80\xa6.You are given two positive integers n and k. Your task is to represent n as the sum of exactly k powers of two." 1400
1095B "Array Stabilization" implementation "You are given an array a consisting of n integer numbers.Let instability of the array be the following value: nmaxi=1ai\xe2\x88\x92nmini=1ai.You have to remove exactly one element from this array to minimize instability of the resulting (n\xe2\x88\x921)-elements array. Your task is to calculate the minimum possible instability." 900
1095A "Repeating Cipher" implementation "Polycarp loves ciphers. He has invented his own cipher called repeating.Repeating cipher is used for strings. To encrypt the string s=s1s2\xe2\x80\xa6sm (1\xe2\x89\xa4m\xe2\x89\xa410), Polycarp uses the following algorithm:  he writes down s1 ones,  he writes down s2 twice,  he writes down s3 three times,  ...  he writes down sm m times. For example, if s=""bab"" the process is: ""b"" \xe2\x86\x92 ""baa"" \xe2\x86\x92 ""baabbb"". So the encrypted s=""bab"" is ""baabbb"".Given string t \xe2\x80\x94 the result of encryption of some string s. Your task is to decrypt it, i.\xe2\x80\x89e. find the string s." 800
1093G "Multidimensional Queries" "bitmasks,data structures" "You are given an array a of n points in k-dimensional space. Let the distance between two points ax and ay be k\xe2\x88\x91i=1|ax,i\xe2\x88\x92ay,i| (it is also known as Manhattan distance).You have to process q queries of the following two types: 1 i b1 b2 ... bk \xe2\x80\x94 set i-th element of a to the point (b1,b2,\xe2\x80\xa6,bk); 2 l r \xe2\x80\x94 find the maximum distance between two points ai and aj, where l\xe2\x89\xa4i,j\xe2\x89\xa4r." 2300
1093F "Vasya and Array" dp "Vasya has got an array consisting of n integers, and two integers k and len in addition. All numbers in the array are either between 1 and k (inclusive), or equal to \xe2\x88\x921. The array is good if there is no segment of len consecutive equal numbers.Vasya will replace each \xe2\x88\x921 with some number from 1 to k (inclusive) in such a way that the resulting array is good. Tell him the number of ways to do this replacement. Since the answer may be large, print it modulo 998244353." 2400
1093E "Intersection of Permutations" "data structures" "You are given two permutations a and b, both consisting of n elements. Permutation of n elements is such a integer sequence that each value from 1 to n appears exactly once in it.You are asked to perform two types of queries with them:  1 la ra lb rb \xe2\x80\x94 calculate the number of values which appear in both segment [la;ra] of positions in permutation a and segment [lb;rb] of positions in permutation b;  2 x y \xe2\x80\x94 swap values on positions x and y in permutation b. Print the answer for each query of the first type.It is guaranteed that there will be at least one query of the first type in the input." 2400
1093D "Beautiful Graph" "dfs and similar,graphs" "You are given an undirected unweighted graph consisting of n vertices and m edges.You have to write a number on each vertex of the graph. Each number should be 1, 2 or 3. The graph becomes beautiful if for each edge the sum of numbers on vertices connected by this edge is odd.Calculate the number of possible ways to write numbers 1, 2 and 3 on vertices so the graph becomes beautiful. Since this number may be large, print it modulo 998244353.Note that you have to write exactly one number on each vertex.The graph does not have any self-loops or multiple edges." 1700
1093C "Mishka and the Last Exam" greedy "Mishka is trying really hard to avoid being kicked out of the university. In particular, he was doing absolutely nothing for the whole semester, miraculously passed some exams so that just one is left.There were n classes of that subject during the semester and on i-th class professor mentioned some non-negative integer ai to the students. It turned out, the exam was to tell the whole sequence back to the professor. Sounds easy enough for those who attended every class, doesn\'t it?Obviously Mishka didn\'t attend any classes. However, professor left some clues on the values of a to help out students like Mishka:   a was sorted in non-decreasing order (a1\xe2\x89\xa4a2\xe2\x89\xa4\xe2\x8b\xaf\xe2\x89\xa4an);  n was even;  the following sequence b, consisting of n2 elements, was formed and given out to students: bi=ai+an\xe2\x88\x92i+1. Professor also mentioned that any sequence a, which produces sequence b with the presented technique, will be acceptable.Help Mishka to pass that last exam. Restore any sorted sequence a of non-negative integers, which produces sequence b with the presented technique. It is guaranteed that there exists at least one correct sequence a, which produces the given sequence b." 1300
1093B "Letters Rearranging" "constructive algorithms,greedy,sortings,strings" "You are given a string s consisting only of lowercase Latin letters.You can rearrange all letters of this string as you wish. Your task is to obtain a good string by rearranging the letters of the given string or report that it is impossible to do it.Let\'s call a string good if it is not a palindrome. Palindrome is a string which is read from left to right the same as from right to left. For example, strings ""abacaba"", ""aa"" and ""z"" are palindromes and strings ""bba"", ""xd"" are not.You have to answer t independent queries." 900
1093A "Dice Rolling" math "Mishka got a six-faced dice. It has integer numbers from 2 to 7 written on its faces (all numbers on faces are different, so this is an almost usual dice).Mishka wants to get exactly x points by rolling his dice. The number of points is just a sum of numbers written at the topmost face of the dice for all the rolls Mishka makes.Mishka doesn\'t really care about the number of rolls, so he just wants to know any number of rolls he can make to be able to get exactly x points for them. Mishka is very lucky, so if the probability to get x points with chosen number of rolls is non-zero, he will be able to roll the dice in such a way. Your task is to print this number. It is guaranteed that at least one answer exists.Mishka is also very curious about different number of points to score so you have to answer t independent queries." 800
1092F "Tree with Maximum Cost" "dfs and similar,dp,trees" "You are given a tree consisting exactly of n vertices. Tree is a connected undirected graph with n\xe2\x88\x921 edges. Each vertex v of this tree has a value av assigned to it.Let dist(x,y) be the distance between the vertices x and y. The distance between the vertices is the number of edges on the simple path between them.Let\'s define the cost of the tree as the following value: firstly, let\'s fix some vertex of the tree. Let it be v. Then the cost of the tree is n\xe2\x88\x91i=1dist(i,v)\xe2\x8b\x85ai.Your task is to calculate the maximum possible cost of the tree if you can choose v arbitrarily." 1900
1092E "Minimal Diameter Forest" "constructive algorithms,dfs and similar,greedy,trees" "You are given a forest \xe2\x80\x94 an undirected graph with n vertices such that each its connected component is a tree.The diameter (aka ""longest shortest path"") of a connected undirected graph is the maximum number of edges in the shortest path between any pair of its vertices.You task is to add some edges (possibly zero) to the graph so that it becomes a tree and the diameter of the tree is minimal possible.If there are multiple correct answers, print any of them." 2000
1092D2 "Great Vova Wall (Version 2)" "data structures,implementation" "Vova\'s family is building the Great Vova Wall (named by Vova himself). Vova\'s parents, grandparents, grand-grandparents contributed to it. Now it\'s totally up to Vova to put the finishing touches.The current state of the wall can be respresented by a sequence a of n integers, with ai being the height of the i-th part of the wall.Vova can only use 2\xc3\x971 bricks to put in the wall (he has infinite supply of them, however).Vova can put bricks only horizontally on the neighbouring parts of the wall of equal height. It means that if for some i the current height of part i is the same as for part i+1, then Vova can put a brick there and thus increase both heights by 1. Obviously, Vova can\'t put bricks in such a way that its parts turn out to be off the borders (to the left of part 1 of the wall or to the right of part n of it).Note that Vova can\'t put bricks vertically.Vova is a perfectionist, so he considers the wall completed when:  all parts of the wall has the same height;  the wall has no empty spaces inside it. Can Vova complete the wall using any amount of bricks (possibly zero)?" 2200
1092D1 "Great Vova Wall (Version 1)" greedy,implementation,math "Vova\'s family is building the Great Vova Wall (named by Vova himself). Vova\'s parents, grandparents, grand-grandparents contributed to it. Now it\'s totally up to Vova to put the finishing touches.The current state of the wall can be respresented by a sequence a of n integers, with ai being the height of the i-th part of the wall.Vova can only use 2\xc3\x971 bricks to put in the wall (he has infinite supply of them, however).Vova can put bricks horizontally on the neighboring parts of the wall of equal height. It means that if for some i the current height of part i is the same as for part i+1, then Vova can put a brick there and thus increase both heights by 1. Obviously, Vova can\'t put bricks in such a way that its parts turn out to be off the borders (to the left of part 1 of the wall or to the right of part n of it).The next paragraph is specific to the version 1 of the problem.Vova can also put bricks vertically. That means increasing height of any part of the wall by 2.Vova is a perfectionist, so he considers the wall completed when:  all parts of the wall has the same height;  the wall has no empty spaces inside it. Can Vova complete the wall using any amount of bricks (possibly zero)?" 2200
1092C "Prefixes and Suffixes" strings "Ivan wants to play a game with you. He picked some string s of length n consisting only of lowercase Latin letters. You don\'t know this string. Ivan has informed you about all its improper prefixes and suffixes (i.e. prefixes and suffixes of lengths from 1 to n\xe2\x88\x921), but he didn\'t tell you which strings are prefixes and which are suffixes.Ivan wants you to guess which of the given 2n\xe2\x88\x922 strings are prefixes of the given string and which are suffixes. It may be impossible to guess the string Ivan picked (since multiple strings may give the same set of suffixes and prefixes), but Ivan will accept your answer if there is at least one string that is consistent with it. Let the game begin!" 1700
1092B "Teams Forming" sortings "There are n students in a university. The number of students is even. The i-th student has programming skill equal to ai. The coach wants to form n2 teams. Each team should consist of exactly two students, and each student should belong to exactly one team. Two students can form a team only if their skills are equal (otherwise they cannot understand each other and cannot form a team).Students can solve problems to increase their skill. One solved problem increases the skill by one.The coach wants to know the minimum total number of problems students should solve to form exactly n2 teams (i.e. each pair of students should form a team). Your task is to find this number." 800
1092A "Uniform String" implementation "You are given two integers n and k.Your task is to construct such a string s of length n that for each i from 1 to k there is at least one i-th letter of the Latin alphabet in this string (the first letter is \'a\', the second is \'b\' and so on) and there are no other letters except these. You have to maximize the minimal frequency of some letter (the frequency of a letter is the number of occurrences of this letter in a string). If there are several possible answers, you can print any.You have to answer t independent queries." 800
1091H "New Year and the Tricolore Recreation" games "Alice and Bob play a game on a grid with n rows and infinitely many columns. In each row, there are three tokens, blue, white and red one. Before the game starts and after every move, the following two conditions must hold:   Any two tokens are not in the same cell.  In each row, the blue token is to the left of the white token, and the red token is to the right of the white token. First, they pick a positive integer f, whose value is valid for the whole game. Second, the starting player is chosen and makes his or her first turn. Then players take alternating turns. The player who is unable to make a move loses. During a move, a player first selects an integer k that is either a prime number or a product of two (not necessarily distinct) primes. The smallest possible values of k are thus 2,3,4,5,6,7,9,10,11,13,14,15,17,19,\xe2\x80\xa6. Furthermore, k must not be equal to the previously picked integer f. Each turn, a move is performed in exactly one of the rows.If it is Alice\'s turn, she chooses a single blue token and moves it k cells to the right. Alternatively, she may move both the blue and the white token in the same row by the same amount k to the right.On the other hand, Bob selects a single red token and moves it k cells to the left. Similarly, he may also move the white and the red token in the corresponding row by k to the left.Note that Alice may never move a red token, while Bob may never move a blue one. Remember that after a move, the two conditions on relative positions of the tokens must still hold. Both players play optimally. Given the initial state of the board, determine who wins for two games: if Alice starts and if Bob starts." 3200
1091G "New Year and the Factorisation Collaboration" "interactive,math,number theory" "Integer factorisation is hard. The RSA Factoring Challenge offered $100000 for factoring RSA-1024, a 1024-bit long product of two prime numbers. To this date, nobody was able to claim the prize. We want you to factorise a 1024-bit number.Since your programming language of choice might not offer facilities for handling large integers, we will provide you with a very simple calculator. To use this calculator, you can print queries on the standard output and retrieve the results from the standard input. The operations are as follows:   + x y where x and y are integers between 0 and n\xe2\x88\x921. Returns (x+y)modn.  - x y where x and y are integers between 0 and n\xe2\x88\x921. Returns (x\xe2\x88\x92y)modn.  * x y where x and y are integers between 0 and n\xe2\x88\x921. Returns (x\xe2\x8b\x85y)modn.  / x y where x and y are integers between 0 and n\xe2\x88\x921 and y is coprime with n. Returns (x\xe2\x8b\x85y\xe2\x88\x921)modn where y\xe2\x88\x921 is multiplicative inverse of y modulo n. If y is not coprime with n, then \xe2\x88\x921 is returned instead.  sqrt x where x is integer between 0 and n\xe2\x88\x921 coprime with n. Returns y such that y2modn=x. If there are multiple such integers, only one of them is returned. If there are none, \xe2\x88\x921 is returned instead.  ^ x y where x and y are integers between 0 and n\xe2\x88\x921. Returns xymodn. Find the factorisation of n that is a product of between 2 and 10 distinct prime numbers, all of form 4x+3 for some integer x.Because of technical issues, we restrict number of requests to 100." 3200
1091F "New Year and the Mallard Expedition" "constructive algorithms,greedy" "Bob is a duck. He wants to get to Alice\'s nest, so that those two can duck!  Duck is the ultimate animal! (Image courtesy of See Bang) The journey can be represented as a straight line, consisting of n segments. Bob is located to the left of the first segment, while Alice\'s nest is on the right of the last segment. Each segment has a length in meters, and also terrain type: grass, water or lava. Bob has three movement types: swimming, walking and flying. He can switch between them or change his direction at any point in time (even when he is located at a non-integer coordinate), and doing so doesn\'t require any extra time. Bob can swim only on the water, walk only on the grass and fly over any terrain. Flying one meter takes 1 second, swimming one meter takes 3 seconds, and finally walking one meter takes 5 seconds.Bob has a finite amount of energy, called stamina. Swimming and walking is relaxing for him, so he gains 1 stamina for every meter he walks or swims. On the other hand, flying is quite tiring, and he spends 1 stamina for every meter flown. Staying in place does not influence his stamina at all. Of course, his stamina can never become negative. Initially, his stamina is zero.What is the shortest possible time in which he can reach Alice\'s nest?" 2600
1091E "New Year and the Acquaintance Estimation" "binary search,data structures,graphs,greedy,implementation,math,sortings" "Bob is an active user of the social network Faithbug. On this network, people are able to engage in a mutual friendship. That is, if a is a friend of b, then b is also a friend of a. Each user thus has a non-negative amount of friends.This morning, somebody anonymously sent Bob the following link: graph realization problem and Bob wants to know who that was. In order to do that, he first needs to know how the social network looks like. He investigated the profile of every other person on the network and noted down the number of his friends. However, he neglected to note down the number of his friends. Help him find out how many friends he has. Since there may be many possible answers, print all of them." 2400
1091D "New Year and the Permutation Concatenation" combinatorics,dp,math "Let n be an integer. Consider all permutations on integers 1 to n in lexicographic order, and concatenate them into one big sequence p. For example, if n=3, then p=[1,2,3,1,3,2,2,1,3,2,3,1,3,1,2,3,2,1]. The length of this sequence will be n\xe2\x8b\x85n!.Let 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4n\xe2\x8b\x85n! be a pair of indices. We call the sequence (pi,pi+1,\xe2\x80\xa6,pj\xe2\x88\x921,pj) a subarray of p. Its length is defined as the number of its elements, i.e., j\xe2\x88\x92i+1. Its sum is the sum of all its elements, i.e., \xe2\x88\x91jk=ipk. You are given n. Find the number of subarrays of p of length n having sum n(n+1)2. Since this number may be large, output it modulo 998244353 (a prime number)." 1700
1091C "New Year and the Sphere Transmission" "math,number theory" "There are n people sitting in a circle, numbered from 1 to n in the order in which they are seated. That is, for all i from 1 to n\xe2\x88\x921, the people with id i and i+1 are adjacent. People with id n and 1 are adjacent as well.The person with id 1 initially has a ball. He picks a positive integer k at most n, and passes the ball to his k-th neighbour in the direction of increasing ids, that person passes the ball to his k-th neighbour in the same direction, and so on until the person with the id 1 gets the ball back. When he gets it back, people do not pass the ball any more.For instance, if n=6 and k=4, the ball is passed in order [1,5,3,1]. Consider the set of all people that touched the ball. The fun value of the game is the sum of the ids of people that touched it. In the above example, the fun value would be 1+5+3=9.Find and report the set of possible fun values for all choices of positive integer k. It can be shown that under the constraints of the problem, the ball always gets back to the 1-st player after finitely many steps, and there are no more than 105 possible fun values for given n." 1400
1091B "New Year and the Treasure Geolocation" "brute force,constructive algorithms,greedy,implementation" "Bob is a pirate looking for the greatest treasure the world has ever seen. The treasure is located at the point T, which coordinates to be found out.Bob travelled around the world and collected clues of the treasure location at n obelisks. These clues were in an ancient language, and he has only decrypted them at home. Since he does not know which clue belongs to which obelisk, finding the treasure might pose a challenge. Can you help him?As everyone knows, the world is a two-dimensional plane. The i-th obelisk is at integer coordinates (xi,yi). The j-th clue consists of 2 integers (aj,bj) and belongs to the obelisk pj, where p is some (unknown) permutation on n elements. It means that the treasure is located at T=(xpj+aj,ypj+bj). This point T is the same for all clues.In other words, each clue belongs to exactly one of the obelisks, and each obelisk has exactly one clue that belongs to it. A clue represents the vector from the obelisk to the treasure. The clues must be distributed among the obelisks in such a way that they all point to the same position of the treasure.Your task is to find the coordinates of the treasure. If there are multiple solutions, you may print any of them.Note that you don\'t need to find the permutation. Permutations are used only in order to explain the problem." 1200
1091A "New Year and the Christmas Ornament" "brute force,implementation,math" "Alice and Bob are decorating a Christmas Tree. Alice wants only 3 types of ornaments to be used on the Christmas Tree: yellow, blue and red. They have y yellow ornaments, b blue ornaments and r red ornaments.In Bob\'s opinion, a Christmas Tree will be beautiful if:  the number of blue ornaments used is greater by exactly 1 than the number of yellow ornaments, and  the number of red ornaments used is greater by exactly 1 than the number of blue ornaments. That is, if they have 8 yellow ornaments, 13 blue ornaments and 9 red ornaments, we can choose 4 yellow, 5 blue and 6 red ornaments (5=4+1 and 6=5+1).Alice wants to choose as many ornaments as possible, but she also wants the Christmas Tree to be beautiful according to Bob\'s opinion.In the example two paragraphs above, we would choose 7 yellow, 8 blue and 9 red ornaments. If we do it, we will use 7+8+9=24 ornaments. That is the maximum number.Since Alice and Bob are busy with preparing food to the New Year\'s Eve, they are asking you to find out the maximum number of ornaments that can be used in their beautiful Christmas Tree! It is guaranteed that it is possible to choose at least 6 (1+2+3=6) ornaments." 800
1090M "The Pleasant Walk" implementation "There are n houses along the road where Anya lives, each one is painted in one of k possible colors.Anya likes walking along this road, but she doesn\'t like when two adjacent houses at the road have the same color. She wants to select a long segment of the road such that no two adjacent houses have the same color.Help Anya find the longest segment with this property." 1000
1090J "Two Prefixes" strings "Misha didn\'t do his math homework for today\'s lesson once again. As a punishment, his teacher Dr. Andrew decided to give him a hard, but very useless task.Dr. Andrew has written two strings s and t of lowercase English letters at the blackboard. He reminded Misha that prefix of a string is a string formed by removing several (possibly none) of its last characters, and a concatenation of two strings is a string formed by appending the second string to the right of the first string.The teacher asked Misha to write down on the blackboard all strings that are the concatenations of some non-empty prefix of s and some non-empty prefix of t. When Misha did it, Dr. Andrew asked him how many distinct strings are there. Misha spent almost the entire lesson doing that and completed the task. Now he asks you to write a program that would do this task automatically." 2600
1090D "Similar Arrays" "constructive algorithms" "Vasya had an array of n integers, each element of the array was from 1 to n. He chose m pairs of different positions and wrote them down to a sheet of paper. Then Vasya compared the elements at these positions, and wrote down the results of the comparisons to another sheet of paper. For each pair he wrote either ""greater"", ""less"", or ""equal"".After several years, he has found the first sheet of paper, but he couldn\'t find the second one. Also he doesn\'t remember the array he had. In particular, he doesn\'t remember if the array had equal elements. He has told this sad story to his informatics teacher Dr Helen.She told him that it could be the case that even if Vasya finds his second sheet, he would still not be able to find out whether the array had two equal elements. Now Vasya wants to find two arrays of integers, each of length n. All elements of the first array must be distinct, and there must be two equal elements in the second array. For each pair of positions Vasya wrote at the first sheet of paper, the result of the comparison must be the same for the corresponding elements of the first array, and the corresponding elements of the second array. Help Vasya find two such arrays of length n, or find out that there are no such arrays for his sets of pairs." 1800
1090C "New Year Presents" "constructive algorithms,data structures" "Santa has prepared boxes with presents for n kids, one box for each kid. There are m kinds of presents: balloons, sweets, chocolate bars, toy cars... A child would be disappointed to receive two presents of the same kind, so all kinds of presents in one box are distinct.Having packed all the presents, Santa realized that different boxes can contain different number of presents. It would be unfair to the children, so he decided to move some presents between boxes, and make their sizes similar. After all movements, the difference between the maximal and the minimal number of presents in a box must be as small as possible. All presents in each box should still be distinct. Santa wants to finish the job as fast as possible, so he wants to minimize the number of movements required to complete the task.Given the sets of presents in each box, find the shortest sequence of movements of presents between boxes that minimizes the difference of sizes of the smallest and the largest box, and keeps all presents in each box distinct." 2400
1090A "Company Merging" greedy "A conglomerate consists of n companies. To make managing easier, their owners have decided to merge all companies into one. By law, it is only possible to merge two companies, so the owners plan to select two companies, merge them into one, and continue doing so until there is only one company left.But anti-monopoly service forbids to merge companies if they suspect unfriendly absorption. The criterion they use is the difference in maximum salaries between two companies. Merging is allowed only if the maximum salaries are equal.To fulfill the anti-monopoly requirements, the owners can change salaries in their companies before merging. But the labor union insists on two conditions: it is only allowed to increase salaries, moreover all the employees in one company must get the same increase.Sure enough, the owners want to minimize the total increase of all salaries in all companies. Help them find the minimal possible increase that will allow them to merge companies into one." 1300
1089L Lazyland NA "The kingdom of Lazyland is the home to n idlers. These idlers are incredibly lazy and create many problems to their ruler, the mighty King of Lazyland. Today k important jobs for the kingdom (k\xe2\x89\xa4n) should be performed. Every job should be done by one person and every person can do at most one job. The King allowed every idler to choose one job they wanted to do and the i-th idler has chosen the job ai. Unfortunately, some jobs may not be chosen by anyone, so the King has to persuade some idlers to choose another job. The King knows that it takes bi minutes to persuade the i-th idler. He asked his minister of labour to calculate the minimum total time he needs to spend persuading the idlers to get all the jobs done. Can you help him?" 900
1089K "King Kog\'s Reception" "data structures" "King Kog got annoyed of the usual laxity of his knights \xe2\x80\x94 they can break into his hall without prior notice! Thus, the King decided to build a reception with a queue where each knight chooses in advance the time when he will come and how long the visit will take. The knights are served in the order of the recorded time, but each knight has to wait until the visits of all the knights before him are finished.Princess Keabeanie wants to see her father. However, she does not want to interrupt the knights so she joins the queue. Unfortunately, the knights change their minds very often \xe2\x80\x94 they can join the queue or cancel their visits. Please help the princess to understand how long she will have to wait until she sees her father if she enters the queue at the specified moments of time given the records at the reception." 2400
1089J "JS Minification" greedy,implementation "International Coding Procedures Company (ICPC) writes all its code in Jedi Script (JS) programming language. JS does not get compiled, but is delivered for execution in its source form. Sources contain comments, extra whitespace (including trailing and leading spaces), and other non-essential features that make them quite large but do not contribute to the semantics of the code, so the process of minification is performed on source files before their delivery to execution to compress sources while preserving their semantics.You are hired by ICPC to write JS minifier for ICPC. Fortunately, ICPC adheres to very strict programming practices and their JS sources are quite restricted in grammar. They work only on integer algorithms and do not use floating point numbers and strings. Every JS source contains a sequence of lines. Each line contains zero or more tokens that can be separated by spaces. On each line, a part of the line that starts with a hash character (\'#\' code 35), including the hash character itself, is treated as a comment and is ignored up to the end of the line.Each line is parsed into a sequence of tokens from left to right by repeatedly skipping spaces and finding the longest possible token starting at the current parsing position, thus transforming the source code into a sequence of tokens. All the possible tokens are listed below:  A reserved token is any kind of operator, separator, literal, reserved word, or a name of a library function that should be preserved during the minification process. Reserved tokens are fixed strings of non-space ASCII characters that do not contain the hash character (\'#\' code 35). All reserved tokens are given as an input to the minification process.  A number token consists of a sequence of digits, where a digit is a character from zero (\'0\') to nine (\'9\') inclusive.  A word token consists of a sequence of characters from the following set: lowercase letters, uppercase letters, digits, underscore (\'_\' code 95), and dollar sign (\'$\' code 36). A word does not start with a digit. Note, that during parsing the longest sequence of characters that satisfies either a number or a word definition, but that appears in the list of reserved tokens, is considered to be a reserved token instead.During the minification process words are renamed in a systematic fashion using the following algorithm:  Take a list of words that consist only of lowercase letters ordered first by their length, then lexicographically: ""a"", ""b"", ..., ""z"", ""aa"", ""ab"", ..., excluding reserved tokens, since they are not considered to be words. This is the target word list.  Rename the first word encountered in the input token sequence to the first word in the target word list and all further occurrences of the same word in the input token sequence, too. Rename the second new word encountered in the input token sequence to the second word in the target word list, and so on. The goal of the minification process is to convert the given source to the shortest possible line (counting spaces) that still parses to the same sequence of tokens with the correspondingly renamed words using these JS parsing rules." 3200
1089I "Interval-Free Permutations" combinatorics "Consider a permutation p1,p2,\xe2\x80\xa6pn of integers from 1 to n. We call a sub-segment pl,pl+1,\xe2\x80\xa6,pr\xe2\x88\x921,pr of the permutation an interval if it is a reordering of some set of consecutive integers. For example, the permutation (6,7,1,8,5,3,2,4) has the intervals (6,7), (5,3,2,4), (3,2), and others. Each permutation has some trivial intervals \xe2\x80\x94 the full permutation itself and every single element. We call a permutation interval-free if it does not have non-trivial intervals. In other words, interval-free permutation does not have intervals of length between 2 and n\xe2\x88\x921 inclusive. Your task is to count the number of interval-free permutations of length n modulo prime number p." 2600
1089G "Guest Student" math "Berland State University invites people from all over the world as guest students. You can come to the capital of Berland and study with the best teachers in the country.Berland State University works every day of the week, but classes for guest students are held on the following schedule. You know the sequence of seven integers a1,a2,\xe2\x80\xa6,a7 (ai=0 or ai=1):  a1=1 if and only if there are classes for guest students on Sundays;  a2=1 if and only if there are classes for guest students on Mondays;  ...   a7=1 if and only if there are classes for guest students on Saturdays. The classes for guest students are held in at least one day of a week.You want to visit the capital of Berland and spend the minimum number of days in it to study k days as a guest student in Berland State University. Write a program to find the length of the shortest continuous period of days to stay in the capital to study exactly k days as a guest student." 1500
1089F Fractions math "You are given a positive integer n.Find a sequence of fractions aibi, i=1\xe2\x80\xa6k (where ai and bi are positive integers) for some k such that:{bi divides n, 1<bi<n for i=1\xe2\x80\xa6k1\xe2\x89\xa4ai<bi for i=1\xe2\x80\xa6kk\xe2\x88\x91i=1aibi=1\xe2\x88\x921n" 1900
1089A "Alice the Fan" dp "Alice is a big fan of volleyball and especially of the very strong ""Team A"".Volleyball match consists of up to five sets. During each set teams score one point for winning a ball. The first four sets are played until one of the teams scores at least 25 points and the fifth set is played until one of the teams scores at least 15 points. Moreover, if one of the teams scores 25 (or 15 in the fifth set) points while the other team scores 24 (or 14 in the fifth set), the set is played until the absolute difference between teams\' points becomes two. The match ends when one of the teams wins three sets. The match score is the number of sets won by each team.Alice found a book containing all the results of all matches played by ""Team A"". The book is old, and some parts of the book became unreadable. Alice can not read the information on how many sets each of the teams won, she can not read the information on how many points each of the teams scored in each set, she even does not know the number of sets played in a match. The only information she has is the total number of points scored by each of the teams in all the sets during a single match.Alice wonders what is the best match score ""Team A"" could achieve in each of the matches. The bigger is the difference between the number of sets won by ""Team A"" and their opponent, the better is the match score. Find the best match score or conclude that no match could end like that. If there is a solution, then find any possible score for each set that results in the best match score." 2200
1088F "Ehab and a weird weight formula" "data structures,trees" "You\'re given a tree consisting of n nodes. Every node u has a weight au. It is guaranteed that there is only one node with minimum weight in the tree. For every node u (except for the node with the minimum weight), it must have a neighbor v such that av<au. You should construct a tree to minimize the weight w calculated as follows:  For every node u, degu\xe2\x8b\x85au is added to w (degu is the number of edges containing node u).  For every edge {u,v}, \xe2\x8c\x88log2(dist(u,v))\xe2\x8c\x89\xe2\x8b\x85min(au,av) is added to w, where dist(u,v) is the number of edges in the path from u to v in the given tree." 2800
1088E "Ehab and a component choosing problem" dp,greedy,math,trees "You\'re given a tree consisting of n nodes. Every node u has a weight au. You want to choose an integer k (1\xe2\x89\xa4k\xe2\x89\xa4n) and then choose k connected components of nodes that don\'t overlap (i.e every node is in at most 1 component). Let the set of nodes you chose be s. You want to maximize:\xe2\x88\x91u\xe2\x88\x88saukIn other words, you want to maximize the sum of weights of nodes in s divided by the number of connected components you chose. Also, if there are several solutions, you want to maximize k.Note that adjacent nodes can belong to different components. Refer to the third sample." 2400
1088D "Ehab and another another xor problem" "bitmasks,constructive algorithms,implementation,interactive" "This is an interactive problem!Ehab plays a game with Laggy. Ehab has 2 hidden integers (a,b). Laggy can ask a pair of integers (c,d) and Ehab will reply with:  1 if a\xe2\x8a\x95c>b\xe2\x8a\x95d.  0 if a\xe2\x8a\x95c=b\xe2\x8a\x95d.  -1 if a\xe2\x8a\x95c<b\xe2\x8a\x95d. Operation a\xe2\x8a\x95b is the bitwise-xor operation of two numbers a and b.Laggy should guess (a,b) with at most 62 questions. You\'ll play this game. You\'re Laggy and the interactor is Ehab.It\'s guaranteed that 0\xe2\x89\xa4a,b<230." 2000
1088C "Ehab and a 2-operation task" "constructive algorithms,greedy,math" "You\'re given an array a of length n. You can perform the following operations on it:  choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n), an integer x (0\xe2\x89\xa4x\xe2\x89\xa4106), and replace aj with aj+x for all (1\xe2\x89\xa4j\xe2\x89\xa4i), which means add x to all the elements in the prefix ending at i.  choose an index i (1\xe2\x89\xa4i\xe2\x89\xa4n), an integer x (1\xe2\x89\xa4x\xe2\x89\xa4106), and replace aj with aj%x for all (1\xe2\x89\xa4j\xe2\x89\xa4i), which means replace every element in the prefix ending at i with the remainder after dividing it by x. Can you make the array strictly increasing in no more than n+1 operations?" 1400
1088B "Ehab and subtraction" implementation,sortings "You\'re given an array a. You should repeat the following operation k times: find the minimum non-zero element in the array, print it, and then subtract it from all the non-zero elements of the array. If all the elements are 0s, just print 0." 1000
1088A "Ehab and another construction problem" "brute force,constructive algorithms" "Given an integer x, find 2 integers a and b such that:   1\xe2\x89\xa4a,b\xe2\x89\xa4x  b divides a (a is divisible by b).  a\xe2\x8b\x85b>x.  ab<x." 800
1086F "Forest Fires" math "Berland forest was planted several decades ago in a formation of an infinite grid with a single tree in every cell. Now the trees are grown up and they form a pretty dense structure.So dense, actually, that the fire became a real danger for the forest. This season had been abnormally hot in Berland and some trees got caught on fire! The second fire started is considered the second 0. Every second fire lit up all intact neightbouring trees to every currently burning tree. The tree is neighbouring if it occupies adjacent by side or by corner cell. Luckily, after t seconds Berland fire department finally reached the location of fire and instantaneously extinguished it all.Now they want to calculate the destructive power of the fire. Let valx,y be the second the tree in cell (x,y) got caught on fire. The destructive power is the sum of valx,y over all (x,y) of burnt trees.Clearly, all the workers of fire department are firefighters, not programmers, thus they asked you to help them calculate the destructive power of the fire.The result can be rather big, so print it modulo 998244353." 3500
1085G "Beautiful Matrix" "combinatorics,data structures,dp" "Petya collects beautiful matrix.A matrix of size n\xc3\x97n is beautiful if:   All elements of the matrix are integers between 1 and n;  For every row of the matrix, all elements of this row are different;  For every pair of vertically adjacent elements, these elements are different. Today Petya bought a beautiful matrix a of size n\xc3\x97n, and now he wants to determine its rarity.The rarity of the matrix is its index in the list of beautiful matrices of size n\xc3\x97n, sorted in lexicographical order. Matrix comparison is done row by row. (The index of lexicographically smallest matrix is zero).Since the number of beautiful matrices may be huge, Petya wants you to calculate the rarity of the matrix a modulo 998244353." 2900
1085F "Rock-Paper-Scissors Champion" NA "n players are going to play a rock-paper-scissors tournament. As you probably know, in a one-on-one match of rock-paper-scissors, two players choose their shapes independently. The outcome is then determined depending on the chosen shapes: ""paper"" beats ""rock"", ""rock"" beats ""scissors"", ""scissors"" beat ""paper"", and two equal shapes result in a draw.At the start of the tournament all players will stand in a row, with their numbers increasing from 1 for the leftmost player, to n for the rightmost player. Each player has a pre-chosen shape that they will use in every game throughout the tournament. Here\'s how the tournament is conducted: If there is only one player left, he is declared the champion. Otherwise, two adjacent players in the row are chosen arbitrarily, and they play the next match. The losing player is eliminated from the tournament and leaves his place in the row (with his former neighbours becoming adjacent). If the game is a draw, the losing player is determined by a coin toss.The organizers are informed about all players\' favoured shapes. They wish to find out the total number of players who have a chance of becoming the tournament champion (that is, there is a suitable way to choose the order of the games and manipulate the coin tosses). However, some players are still optimizing their strategy, and can inform the organizers about their new shapes. Can you find the number of possible champions after each such request?" 2500
1085E "Vasya and Templates" greedy,implementation,strings "Vasya owns three strings s , a and b, each of them consists only of first k Latin letters.Let a template be such a string of length k that each of the first k Latin letters appears in it exactly once (thus there are k! distinct templates). Application of template p to the string s is the replacement of each character in string s with pi, i is the index of this letter in the alphabet. For example, applying template ""bdca"" to a string ""aabccd"" yields string ""bbdcca"".Vasya wants to know if there exists such a template which yields a string lexicographically greater than or equal to string a and lexicographically less than or equal to string b after applying it to s.If there exist multiple suitable templates, print any of them.String a is lexicographically less than string b if there is some i (1\xe2\x89\xa4i\xe2\x89\xa4n) that ai<bi and for any j (1\xe2\x89\xa4j<i) aj=bj.You are required to answer t testcases independently." 2300
1085D "Minimum Diameter Tree" "constructive algorithms,implementation,trees" "You are given a tree (an undirected connected graph without cycles) and an integer s.Vanya wants to put weights on all edges of the tree so that all weights are non-negative real numbers and their sum is s. At the same time, he wants to make the diameter of the tree as small as possible.Let\'s define the diameter of a weighed tree as the maximum sum of the weights of the edges lying on the path between two some vertices of the tree. In other words, the diameter of a weighed tree is the length of the longest simple path in the tree, where length of a path is equal to the sum of weights over all edges in the path.Find the minimum possible diameter that Vanya can get." 1700
1085C "Connect Three" implementation,math "The Squareland national forest is divided into equal 1\xc3\x971 square plots aligned with north-south and east-west directions. Each plot can be uniquely described by integer Cartesian coordinates (x,y) of its south-west corner.Three friends, Alice, Bob, and Charlie are going to buy three distinct plots of land A,B,C in the forest. Initially, all plots in the forest (including the plots A,B,C) are covered by trees. The friends want to visit each other, so they want to clean some of the plots from trees. After cleaning, one should be able to reach any of the plots A,B,C from any other one of those by moving through adjacent cleared plots. Two plots are adjacent if they share a side.  For example, A=(0,0), B=(1,1), C=(2,2). The minimal number of plots to be cleared is 5. One of the ways to do it is shown with the gray color. Of course, the friends don\'t want to strain too much. Help them find out the smallest number of plots they need to clean from trees." 1600
1085B "Div Times Mod" math "Vasya likes to solve equations. Today he wants to solve (x div k)\xe2\x8b\x85(xmodk)=n, where div and mod stand for integer division and modulo operations (refer to the Notes below for exact definition). In this equation, k and n are positive integer parameters, and x is a positive integer unknown. If there are several solutions, Vasya wants to find the smallest possible x. Can you help him?" 1100
1085A "Right-Left Cipher" implementation,strings "Polycarp loves ciphers. He has invented his own cipher called Right-Left.Right-Left cipher is used for strings. To encrypt the string s=s1s2\xe2\x80\xa6sn Polycarp uses the following algorithm:  he writes down s1,  he appends the current word with s2 (i.e. writes down s2 to the right of the current result),  he prepends the current word with s3 (i.e. writes down s3 to the left of the current result),  he appends the current word with s4 (i.e. writes down s4 to the right of the current result),  he prepends the current word with s5 (i.e. writes down s5 to the left of the current result),  and so on for each position until the end of s. For example, if s=""techno"" the process is: ""t"" \xe2\x86\x92 ""te"" \xe2\x86\x92 ""cte"" \xe2\x86\x92 ""cteh"" \xe2\x86\x92 ""ncteh"" \xe2\x86\x92 ""ncteho"". So the encrypted s=""techno"" is ""ncteho"".Given string t \xe2\x80\x94 the result of encryption of some string s. Your task is to decrypt it, i.e. find the string s." 800
1084C "The Fair Nut and String" combinatorics,dp,implementation "The Fair Nut found a string s. The string consists of lowercase Latin letters. The Nut is a curious guy, so he wants to find the number of strictly increasing sequences p1,p2,\xe2\x80\xa6,pk, such that:   For each i (1\xe2\x89\xa4i\xe2\x89\xa4k), spi= \'a\'.  For each i (1\xe2\x89\xa4i<k), there is such j that pi<j<pi+1 and sj= \'b\'. The Nut is upset because he doesn\'t know how to find the number. Help him.This number should be calculated modulo 109+7." 1500
1084B "Kvass and the Fair Nut" greedy,implementation "The Fair Nut likes kvass very much. On his birthday parents presented him n kegs of kvass. There are vi liters of kvass in the i-th keg. Each keg has a lever. You can pour your glass by exactly 1 liter pulling this lever. The Fair Nut likes this drink very much, so he wants to pour his glass by s liters of kvass. But he wants to do it, so kvass level in the least keg is as much as possible.Help him find out how much kvass can be in the least keg or define it\'s not possible to pour his glass by s liters of kvass." 1200
1084A "The Fair Nut and Elevator" "brute force,implementation" "The Fair Nut lives in n story house. ai people live on the i-th floor of the house. Every person uses elevator twice a day: to get from the floor where he/she lives to the ground (first) floor and to get from the first floor to the floor where he/she lives, when he/she comes back home in the evening. It was decided that elevator, when it is not used, will stay on the x-th floor, but x hasn\'t been chosen yet. When a person needs to get from floor a to floor b, elevator follows the simple algorithm:   Moves from the x-th floor (initially it stays on the x-th floor) to the a-th and takes the passenger.  Moves from the a-th floor to the b-th floor and lets out the passenger (if a equals b, elevator just opens and closes the doors, but still comes to the floor from the x-th floor).  Moves from the b-th floor back to the x-th.  The elevator never transposes more than one person and always goes back to the floor x before transposing a next passenger. The elevator spends one unit of electricity to move between neighboring floors. So moving from the a-th floor to the b-th floor requires |a\xe2\x88\x92b| units of electricity.Your task is to help Nut to find the minimum number of electricity units, that it would be enough for one day, by choosing an optimal the x-th floor. Don\'t forget than elevator initially stays on the x-th floor." 1000
1083F "The Fair Nut and Amusing Xor" "data structures" "The Fair Nut has two arrays a and b, consisting of n numbers. He found them so long ago that no one knows when they came to him.The Fair Nut often changes numbers in his arrays. He also is interested in how similar a and b are after every modification.Let\'s denote similarity of two arrays as the minimum number of operations to apply to make arrays equal (every operation can be applied for both arrays). If it is impossible, similarity will be equal \xe2\x88\x921.Per one operation you can choose a subarray with length k (k is fixed), and change every element ai, which belongs to the chosen subarray, to ai\xe2\x8a\x95x (x can be chosen), where \xe2\x8a\x95 denotes the bitwise XOR operation. Nut has already calculated the similarity of the arrays after every modification. Can you do it?Note that you just need to calculate those values, that is you do not need to apply any operations." 3300
1083E "The Fair Nut and Rectangles" "data structures,dp,geometry" "The Fair Nut got stacked in planar world. He should solve this task to get out.You are given n rectangles with vertexes in (0,0), (xi,0), (xi,yi), (0,yi). For each rectangle, you are also given a number ai. Choose some of them that the area of union minus sum of ai of the chosen ones is maximum.It is guaranteed that there are no nested rectangles.Nut has no idea how to find the answer, so he asked for your help." 2400
1083D "The Fair Nut\'s getting crazy" "data structures,implementation" "The Fair Nut has found an array a of n integers. We call subarray l\xe2\x80\xa6r a sequence of consecutive elements of an array with indexes from l to r, i.e. al,al+1,al+2,\xe2\x80\xa6,ar\xe2\x88\x921,ar. No one knows the reason, but he calls a pair of subsegments good if and only if the following conditions are satisfied: These subsegments should not be nested. That is, each of the subsegments should contain an element (as an index) that does not belong to another subsegment. Subsegments intersect and each element that belongs to the intersection belongs each of segments only once.For example a=[1,2,3,5,5]. Pairs (1\xe2\x80\xa63;2\xe2\x80\xa65) and (1\xe2\x80\xa62;2\xe2\x80\xa63)) \xe2\x80\x94 are good, but (1\xe2\x80\xa63;2\xe2\x80\xa63) and (3\xe2\x80\xa64;4\xe2\x80\xa65) \xe2\x80\x94 are not (subsegment 1\xe2\x80\xa63 contains subsegment 2\xe2\x80\xa63, integer 5 belongs both segments, but occurs twice in subsegment 4\xe2\x80\xa65).Help the Fair Nut to find out the number of pairs of good subsegments! The answer can be rather big so print it modulo 109+7." 3500
1083C "Max Mex" "data structures,trees" "Once Grisha found a tree (connected graph without cycles) with a root in node 1.But this tree was not just a tree. A permutation p of integers from 0 to n\xe2\x88\x921 is written in nodes, a number pi is written in node i.As Grisha likes to invent some strange and interesting problems for himself, but not always can solve them, you need to help him deal with two types of queries on this tree.Let\'s define a function MEX(S), where S is a set of non-negative integers, as a smallest non-negative integer that is not included in this set.Let l be a simple path in this tree. So let\'s define indices of nodes which lie on l as u1, u2, \xe2\x80\xa6, uk. Define V(l) as a set {pu1, pu2, \xe2\x80\xa6 , puk}. Then queries are:   For two nodes i and j, swap pi and pj.  Find the maximum value of MEX(V(l)) in all possible l." 2900
1083B "The Fair Nut and Strings" greedy,strings "Recently, the Fair Nut has written k strings of length n, consisting of letters ""a"" and ""b"". He calculated c \xe2\x80\x94 the number of strings that are prefixes of at least one of the written strings. Every string was counted only one time.Then, he lost his sheet with strings. He remembers that all written strings were lexicographically not smaller than string s and not bigger than string t. He is interested: what is the maximum value of c that he could get.A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 2000
1083A "The Fair Nut and the Best Path" "data structures,dp,trees" "The Fair Nut is going to travel to the Tree Country, in which there are n cities. Most of the land of this country is covered by forest. Furthermore, the local road system forms a tree (connected graph without cycles). Nut wants to rent a car in the city u and go by a simple path to city v. He hasn\'t determined the path, so it\'s time to do it. Note that chosen path can consist of only one vertex.A filling station is located in every city. Because of strange law, Nut can buy only wi liters of gasoline in the i-th city. We can assume, that he has infinite money. Each road has a length, and as soon as Nut drives through this road, the amount of gasoline decreases by length. Of course, Nut can\'t choose a path, which consists of roads, where he runs out of gasoline. He can buy gasoline in every visited city, even in the first and the last.He also wants to find the maximum amount of gasoline that he can have at the end of the path. Help him: count it." 1800
1082G "Petya and Graph" flows,graphs "Petya has a simple graph (that is, a graph without loops or multiple edges) consisting of n vertices and m edges.The weight of the i-th vertex is ai.The weight of the i-th edge is wi.A subgraph of a graph is some set of the graph vertices and some set of the graph edges. The set of edges must meet the condition: both ends of each edge from the set must belong to the chosen set of vertices. The weight of a subgraph is the sum of the weights of its edges, minus the sum of the weights of its vertices. You need to find the maximum weight of subgraph of given graph. The given graph does not contain loops and multiple edges." 2400
1082F "Speed Dial" dp,strings,trees "Polycarp\'s phone book contains n phone numbers, each of them is described by si \xe2\x80\x94 the number itself and mi \xe2\x80\x94 the number of times Polycarp dials it in daily.Polycarp has just bought a brand new phone with an amazing speed dial feature! More precisely, k buttons on it can have a number assigned to it (not necessary from the phone book). To enter some number Polycarp can press one of these k buttons and then finish the number using usual digit buttons (entering a number with only digit buttons is also possible).Speed dial button can only be used when no digits are entered. No button can have its number reassigned.What is the minimal total number of digit number presses Polycarp can achieve after he assigns numbers to speed dial buttons and enters each of the numbers from his phone book the given number of times in an optimal way?" 2800
1082E "Increasing Frequency" "binary search,dp,greedy" "You are given array a of length n. You can choose one segment [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) and integer value k (positive, negative or even zero) and change al,al+1,\xe2\x80\xa6,ar by k each (i.e. ai:=ai+k for each l\xe2\x89\xa4i\xe2\x89\xa4r).What is the maximum possible number of elements with value c that can be obtained after one such operation?" 2000
1082D "Maximum Diameter Graph" "constructive algorithms,graphs,implementation" "Graph constructive problems are back! This time the graph you are asked to build should match the following properties.The graph is connected if and only if there exists a path between every pair of vertices.The diameter (aka ""longest shortest path"") of a connected undirected graph is the maximum number of edges in the shortest path between any pair of its vertices.The degree of a vertex is the number of edges incident to it.Given a sequence of n integers a1,a2,\xe2\x80\xa6,an construct a connected undirected graph of n vertices such that:  the graph contains no self-loops and no multiple edges;  the degree di of the i-th vertex doesn\'t exceed ai (i.e. di\xe2\x89\xa4ai);  the diameter of the graph is maximum possible. Output the resulting graph or report that no solution exists." 1800
1082C "Multi-Subject Competition" greedy,sortings "A multi-subject competition is coming! The competition has m different subjects participants can choose from. That\'s why Alex (the coach) should form a competition delegation among his students. He has n candidates. For the i-th person he knows subject si the candidate specializes in and ri \xe2\x80\x94 a skill level in his specialization (this level can be negative!). The rules of the competition require each delegation to choose some subset of subjects they will participate in. The only restriction is that the number of students from the team participating in each of the chosen subjects should be the same.Alex decided that each candidate would participate only in the subject he specializes in. Now Alex wonders whom he has to choose to maximize the total sum of skill levels of all delegates, or just skip the competition this year if every valid non-empty delegation has negative sum.(Of course, Alex doesn\'t have any spare money so each delegate he chooses must participate in the competition)." 1600
1082B "Vova and Trophies" greedy "Vova has won n trophies in different competitions. Each trophy is either golden or silver. The trophies are arranged in a row.The beauty of the arrangement is the length of the longest subsegment consisting of golden trophies. Vova wants to swap two trophies (not necessarily adjacent ones) to make the arrangement as beautiful as possible \xe2\x80\x94 that means, to maximize the length of the longest such subsegment.Help Vova! Tell him the maximum possible beauty of the arrangement if he is allowed to do at most one swap." 1600
1082A "Vasya and Book" implementation,math "Vasya is reading a e-book. The file of the book consists of n pages, numbered from 1 to n. The screen is currently displaying the contents of page x, and Vasya wants to read the page y. There are two buttons on the book which allow Vasya to scroll d pages forwards or backwards (but he cannot scroll outside the book). For example, if the book consists of 10 pages, and d=3, then from the first page Vasya can scroll to the first or to the fourth page by pressing one of the buttons; from the second page \xe2\x80\x94 to the first or to the fifth; from the sixth page \xe2\x80\x94 to the third or to the ninth; from the eighth \xe2\x80\x94 to the fifth or to the tenth.Help Vasya to calculate the minimum number of times he needs to press a button to move to page y." 1200
1081H "Palindromic Magic" "data structures,hashing,strings" "After learning some fancy algorithms about palindromes, Chouti found palindromes very interesting, so he wants to challenge you with this problem.Chouti has got two strings A and B. Since he likes palindromes, he would like to pick a as some non-empty palindromic substring of A and b as some non-empty palindromic substring of B. Concatenating them, he will get string ab.Chouti thinks strings he could get this way are interesting, so he wants to know how many different strings he can get." 3500
1081G "Mergesort Strikes Back" math,probabilities "Chouti thought about his very first days in competitive programming. When he had just learned to write merge sort, he thought that the merge sort is too slow, so he restricted the maximum depth of recursion and modified the merge sort to the following:  Chouti found his idea dumb since obviously, this ""merge sort"" sometimes cannot sort the array correctly. However, Chouti is now starting to think of how good this ""merge sort"" is. Particularly, Chouti wants to know for a random permutation a of 1,2,\xe2\x80\xa6,n the expected number of inversions after calling MergeSort(a, 1, n, k).It can be proved that the expected number is rational. For the given prime q, suppose the answer can be denoted by ud where gcd(u,d)=1, you need to output an integer r satisfying 0\xe2\x89\xa4r<q and rd\xe2\x89\xa1u(modq). It can be proved that such r exists and is unique." 3200
1081F "Tricky Interactor" "constructive algorithms,implementation,interactive" "This is an interactive problem.Chouti was tired of studying, so he opened the computer and started playing a puzzle game.Long long ago, the boy found a sequence s1,s2,\xe2\x80\xa6,sn of length n, kept by a tricky interactor. It consisted of 0s and 1s only and the number of 1s is t. The boy knows nothing about this sequence except n and t, but he can try to find it out with some queries with the interactor.We define an operation called flipping. Flipping [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) means for each x\xe2\x88\x88[l,r], changing sx to 1\xe2\x88\x92sx.In each query, the boy can give the interactor two integers l,r satisfying 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and the interactor will either flip [1,r] or [l,n] (both outcomes have the same probability and all decisions made by interactor are independent from each other, see Notes section for more details). The interactor will tell the current number of 1s after each operation. Note, that the sequence won\'t be restored after each operation.Help the boy to find the original sequence in no more than 10000 interactions.""Weird legend, dumb game."" he thought. However, after several tries, he is still stuck with it. Can you help him beat this game?" 2600
1081E "Missing Numbers" "binary search,constructive algorithms,greedy,math,number theory" "Chouti is working on a strange math problem.There was a sequence of n positive integers x1,x2,\xe2\x80\xa6,xn, where n is even. The sequence was very special, namely for every integer t from 1 to n, x1+x2+...+xt is a square of some integer number (that is, a perfect square).Somehow, the numbers with odd indexes turned to be missing, so he is only aware of numbers on even positions, i.e. x2,x4,x6,\xe2\x80\xa6,xn. The task for him is to restore the original sequence. Again, it\'s your turn to help him.The problem setter might make mistakes, so there can be no possible sequence at all. If there are several possible sequences, you can output any." 1900
1081D "Maximum Distance" "dsu,graphs,shortest paths,sortings" "Chouti was tired of the tedious homework, so he opened up an old programming problem he created years ago.You are given a connected undirected graph with n vertices and m weighted edges. There are k special vertices: x1,x2,\xe2\x80\xa6,xk.Let\'s define the cost of the path as the maximum weight of the edges in it. And the distance between two vertexes as the minimum cost of the paths connecting them.For each special vertex, find another special vertex which is farthest from it (in terms of the previous paragraph, i.e. the corresponding distance is maximum possible) and output the distance between them.The original constraints are really small so he thought the problem was boring. Now, he raises the constraints and hopes you can solve it for him." 1800
1081C "Colorful Bricks" combinatorics,dp,math "On his free time, Chouti likes doing some housework. He has got one new task, paint some bricks in the yard.There are n bricks lined in a row on the ground. Chouti has got m paint buckets of different colors at hand, so he painted each brick in one of those m colors.Having finished painting all bricks, Chouti was satisfied. He stood back and decided to find something fun with these bricks. After some counting, he found there are k bricks with a color different from the color of the brick on its left (the first brick is not counted, for sure).So as usual, he needs your help in counting how many ways could he paint the bricks. Two ways of painting bricks are different if there is at least one brick painted in different colors in these two ways. Because the answer might be quite big, you only need to output the number of ways modulo 998244353." 1500
1081B "Farewell Party" "constructive algorithms,implementation" "Chouti and his classmates are going to the university soon. To say goodbye to each other, the class has planned a big farewell party in which classmates, teachers and parents sang and danced.Chouti remembered that n persons took part in that party. To make the party funnier, each person wore one hat among n kinds of weird hats numbered 1,2,\xe2\x80\xa6n. It is possible that several persons wore hats of the same kind. Some kinds of hats can remain unclaimed by anyone.After the party, the i-th person said that there were ai persons wearing a hat differing from his own.It has been some days, so Chouti forgot all about others\' hats, but he is curious about that. Let bi be the number of hat type the i-th person was wearing, Chouti wants you to find any possible b1,b2,\xe2\x80\xa6,bn that doesn\'t contradict with any person\'s statement. Because some persons might have a poor memory, there could be no solution at all." 1500
1081A "Definite Game" "constructive algorithms,math" "Chouti was doing a competitive programming competition. However, after having all the problems accepted, he got bored and decided to invent some small games.He came up with the following game. The player has a positive integer n. Initially the value of n equals to v and the player is able to do the following operation as many times as the player want (possibly zero): choose a positive integer x that x<n and x is not a divisor of n, then subtract x from n. The goal of the player is to minimize the value of n in the end.Soon, Chouti found the game trivial. Can you also beat the game?" 800
1080F "Katya and Segments Sets" "data structures,interactive,sortings" "It is a very important day for Katya. She has a test in a programming class. As always, she was given an interesting problem that she solved very fast. Can you solve that problem?You are given n ordered segments sets. Each segment can be represented as a pair of two integers [l,r] where l\xe2\x89\xa4r. Each set can contain an arbitrary number of segments (even 0). It is possible that some segments are equal.You are also given m queries, each of them can be represented as four numbers: a,b,x,y. For each segment, find out whether it is true that each set p (a\xe2\x89\xa4p\xe2\x89\xa4b) contains at least one segment [l,r] that lies entirely on the segment [x,y], that is x\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4y. Find out the answer to each query.Note that you need to solve this problem online. That is, you will get a new query only after you print the answer for the previous query." 2400
1080E "Sonya and Matrix Beauty" strings "Sonya had a birthday recently. She was presented with the matrix of size n\xc3\x97m and consist of lowercase Latin letters. We assume that the rows are numbered by integers from 1 to n from bottom to top, and the columns are numbered from 1 to m from left to right. Let\'s call a submatrix (i1,j1,i2,j2) (1\xe2\x89\xa4i1\xe2\x89\xa4i2\xe2\x89\xa4n;1\xe2\x89\xa4j1\xe2\x89\xa4j2\xe2\x89\xa4m) elements aij of this matrix, such that i1\xe2\x89\xa4i\xe2\x89\xa4i2 and j1\xe2\x89\xa4j\xe2\x89\xa4j2. Sonya states that a submatrix is beautiful if we can independently reorder the characters in each row (not in column) so that all rows and columns of this submatrix form palidroms. Let\'s recall that a string is called palindrome if it reads the same from left to right and from right to left. For example, strings abacaba,bcaacb,a are palindromes while strings abca,acbba,ab are not.Help Sonya to find the number of beautiful submatrixes. Submatrixes are different if there is an element that belongs to only one submatrix." 2400
1080D "Olya and magical square" "constructive algorithms,implementation,math" "Recently, Olya received a magical square with the size of 2n\xc3\x972n.It seems to her sister that one square is boring. Therefore, she asked Olya to perform exactly k splitting operations.A Splitting operation is an operation during which Olya takes a square with side a and cuts it into 4 equal squares with side a2. If the side of the square is equal to 1, then it is impossible to apply a splitting operation to it (see examples for better understanding).Olya is happy to fulfill her sister\'s request, but she also wants the condition of Olya\'s happiness to be satisfied after all operations.The condition of Olya\'s happiness will be satisfied if the following statement is fulfilled:Let the length of the side of the lower left square be equal to a, then the length of the side of the right upper square should also be equal to a. There should also be a path between them that consists only of squares with the side of length a. All consecutive squares on a path should have a common side.Obviously, as long as we have one square, these conditions are met. So Olya is ready to fulfill her sister\'s request only under the condition that she is satisfied too. Tell her: is it possible to perform exactly k splitting operations in a certain order so that the condition of Olya\'s happiness is satisfied? If it is possible, tell also the size of the side of squares of which the path from the lower left square to the upper right one will consist." 2000
1080C "Masha and two friends" implementation "Recently, Masha was presented with a chessboard with a height of n and a width of m.The rows on the chessboard are numbered from 1 to n from bottom to top. The columns are numbered from 1 to m from left to right. Therefore, each cell can be specified with the coordinates (x,y), where x is the column number, and y is the row number (do not mix up).Let us call a rectangle with coordinates (a,b,c,d) a rectangle lower left point of which has coordinates (a,b), and the upper right one \xe2\x80\x94 (c,d).The chessboard is painted black and white as follows:   An example of a chessboard. Masha was very happy with the gift and, therefore, invited her friends Maxim and Denis to show off. The guys decided to make her a treat \xe2\x80\x94 they bought her a can of white and a can of black paint, so that if the old board deteriorates, it can be repainted. When they came to Masha, something unpleasant happened: first, Maxim went over the threshold and spilled white paint on the rectangle (x1,y1,x2,y2). Then after him Denis spilled black paint on the rectangle (x3,y3,x4,y4).To spill paint of color color onto a certain rectangle means that all the cells that belong to the given rectangle become color. The cell dyeing is superimposed on each other (if at first some cell is spilled with white paint and then with black one, then its color will be black).Masha was shocked! She drove away from the guests and decided to find out how spoiled the gift was. For this, she needs to know the number of cells of white and black color. Help her find these numbers!" 1500
1080B "Margarite and the best present" math "Little girl Margarita is a big fan of competitive programming. She especially loves problems about arrays and queries on them.Recently, she was presented with an array a of the size of 109 elements that is filled as follows:   a1=\xe2\x88\x921  a2=2  a3=\xe2\x88\x923  a4=4  a5=\xe2\x88\x925  And so on ... That is, the value of the i-th element of the array a is calculated using the formula ai=i\xe2\x8b\x85(\xe2\x88\x921)i.She immediately came up with q queries on this array. Each query is described with two numbers: l and r. The answer to a query is the sum of all the elements of the array at positions from l to r inclusive.Margarita really wants to know the answer to each of the requests. She doesn\'t want to count all this manually, but unfortunately, she couldn\'t write the program that solves the problem either. She has turned to you \xe2\x80\x94 the best programmer.Help her find the answers!" 900
1080A "Petya and Origami" math "Petya is having a party soon, and he has decided to invite his n friends.He wants to make invitations in the form of origami. For each invitation, he needs two red sheets, five green sheets, and eight blue sheets. The store sells an infinite number of notebooks of each color, but each notebook consists of only one color with k sheets. That is, each notebook contains k sheets of either red, green, or blue.Find the minimum number of notebooks that Petya needs to buy to invite all n of his friends." 800
1078E "Negative Time Summation" "constructive algorithms" "Everyone knows that computers become faster and faster. Recently Berland scientists have built a machine that can move itself back in time!More specifically, it works as follows. It has an infinite grid and a robot which stands on one of the cells. Each cell of the grid can either be empty or contain 0 or 1. The machine also has a program which consists of instructions, which are being handled one by one. Each instruction is represented by exactly one symbol (letter or digit) and takes exactly one unit of time (say, second) to be performed, except the last type of operation (it\'s described below). Here they are:  0 or 1: the robot places this number into the cell he is currently at. If this cell wasn\'t empty before the operation, its previous number is replaced anyway.  e: the robot erases the number into the cell he is at.  l, r, u or d: the robot goes one cell to the left/right/up/down.  s: the robot stays where he is for a unit of time.  t: let x be 0, if the cell with the robot is empty, otherwise let x be one more than the digit in this cell (that is, x=1 if the digit in this cell is 0, and x=2 if the digit is 1). Then the machine travels x seconds back in time. Note that this doesn\'t change the instructions order, but it changes the position of the robot and the numbers in the grid as they were x units of time ago. You can consider this instruction to be equivalent to a Ctrl-Z pressed x times. For example, let the board be completely empty, and the program be sr1t0. Let the robot initially be at (0,0).  [now is the moment 0, the command is s]: we do nothing.  [now is the moment 1, the command is r]: we are now at (1,0).  [now is the moment 2, the command is 1]: we are at (1,0), and this cell contains 1.  [now is the moment 3, the command is t]: we travel 1+1=2 moments back, that is, to the moment 1.  [now is the moment 1, the command is 0]: we are again at (0,0), and the board is clear again, but after we follow this instruction, this cell has 0 in it. We\'ve just rewritten the history. The consequences of the third instruction have never happened. Now Berland scientists want to use their machine in practice. For example, they want to be able to add two integers.Assume that the initial state of the machine is as follows:  One positive integer is written in binary on the grid in such a way that its right bit is at the cell (0,1), from left to right from the highest bit to the lowest bit.  The other positive integer is written in binary on the grid in such a way that its right bit is at the cell (0,0), from left to right from the highest bit to the lowest bit.  All the other cells are empty.  The robot is at (0,0).  We consider this state to be always in the past; that is, if you manage to travel to any negative moment, the board was always as described above, and the robot was at (0,0) for eternity. You are asked to write a program after which  The robot stands on a non-empty cell,  If we read the number starting from the cell with the robot and moving to the right until the first empty cell, this will be a+b in binary, from the highest bit to the lowest bit. Note that there are no restrictions on other cells. In particular, there may be a digit just to the left to the robot after all instructions.In each test you are given up to 1000 pairs (a,b), and your program must work for all these pairs. Also since the machine\'s memory is not very big, your program must consist of no more than 105 instructions." 3400
1077F2 "Pictures with Kittens (hard version)" "data structures,dp" "The only difference between easy and hard versions is the constraints.Vova likes pictures with kittens. The news feed in the social network he uses can be represented as an array of n consecutive pictures (with kittens, of course). Vova likes all these pictures, but some are more beautiful than the others: the i-th picture has beauty ai.Vova wants to repost exactly x pictures in such a way that:   each segment of the news feed of at least k consecutive pictures has at least one picture reposted by Vova;  the sum of beauty values of reposted pictures is maximum possible. For example, if k=1 then Vova has to repost all the pictures in the news feed. If k=2 then Vova can skip some pictures, but between every pair of consecutive pictures Vova has to repost at least one of them.Your task is to calculate the maximum possible sum of values of reposted pictures if Vova follows conditions described above, or say that there is no way to satisfy all conditions." 2100
1077F1 "Pictures with Kittens (easy version)" dp "The only difference between easy and hard versions is the constraints.Vova likes pictures with kittens. The news feed in the social network he uses can be represented as an array of n consecutive pictures (with kittens, of course). Vova likes all these pictures, but some are more beautiful than the others: the i-th picture has beauty ai.Vova wants to repost exactly x pictures in such a way that:   each segment of the news feed of at least k consecutive pictures has at least one picture reposted by Vova;  the sum of beauty values of reposted pictures is maximum possible. For example, if k=1 then Vova has to repost all the pictures in the news feed. If k=2 then Vova can skip some pictures, but between every pair of consecutive pictures Vova has to repost at least one of them.Your task is to calculate the maximum possible sum of values of reposted pictures if Vova follows conditions described above, or say that there is no way to satisfy all conditions." 1900
1077E "Thematic Contests" greedy,sortings "Polycarp has prepared n competitive programming problems. The topic of the i-th problem is ai, and some problems\' topics may coincide.Polycarp has to host several thematic contests. All problems in each contest should have the same topic, and all contests should have pairwise distinct topics. He may not use all the problems. It is possible that there are no contests for some topics.Polycarp wants to host competitions on consecutive days, one contest per day. Polycarp wants to host a set of contests in such a way that:  number of problems in each contest is exactly twice as much as in the previous contest (one day ago), the first contest can contain arbitrary number of problems;  the total number of problems in all the contests should be maximized. Your task is to calculate the maximum number of problems in the set of thematic contests. Note, that you should not maximize the number of contests." 1800
1077D "Cutting Out" "binary search,sortings" "You are given an array s consisting of n integers.You have to find any array t of length k such that you can cut out maximum number of copies of array t from array s.Cutting out the copy of t means that for each element ti of array t you have to find ti in s and remove it from s. If for some ti you cannot find such element in s, then you cannot cut out one more copy of t. The both arrays can contain duplicate elements.For example, if s=[1,2,3,2,4,3,1] and k=3 then one of the possible answers is t=[1,2,3]. This array t can be cut out 2 times.   To cut out the first copy of t you can use the elements [1,2_,3,2,4,3_,1_] (use the highlighted elements). After cutting out the first copy of t the array s can look like [1,3,2,4].  To cut out the second copy of t you can use the elements [1_,3_,2_,4]. After cutting out the second copy of t the array s will be [4]. Your task is to find such array t that you can cut out the copy of t from s maximum number of times. If there are multiple answers, you may choose any of them." 1600
1077C "Good Array" NA "Let\'s call an array good if there is an element in the array that equals to the sum of all other elements. For example, the array a=[1,3,3,7] is good because there is the element a4=7 which equals to the sum 1+3+3.You are given an array a consisting of n integers. Your task is to print all indices j of this array such that after removing the j-th element from the array it will be good (let\'s call such indices nice).For example, if a=[8,3,5,2], the nice indices are 1 and 4:   if you remove a1, the array will look like [3,5,2] and it is good;  if you remove a4, the array will look like [8,3,5] and it is good. You have to consider all removals independently, i.\xe2\x80\x89e. remove the element, check if the resulting array is good, and return the element into the array." 1300
1077B "Disturbed People" greedy "There is a house with n flats situated on the main street of Berlatov. Vova is watching this house every night. The house can be represented as an array of n integer numbers a1,a2,\xe2\x80\xa6,an, where ai=1 if in the i-th flat the light is on and ai=0 otherwise.Vova thinks that people in the i-th flats are disturbed and cannot sleep if and only if 1<i<n and ai\xe2\x88\x921=ai+1=1 and ai=0.Vova is concerned by the following question: what is the minimum number k such that if people from exactly k pairwise distinct flats will turn off the lights then nobody will be disturbed? Your task is to find this number k." 1000
1077A "Frog Jumping" math "A frog is currently at the point 0 on a coordinate axis Ox. It jumps by the following algorithm: the first jump is a units to the right, the second jump is b units to the left, the third jump is a units to the right, the fourth jump is b units to the left, and so on.Formally:   if the frog has jumped an even number of times (before the current jump), it jumps from its current position x to position x+a;  otherwise it jumps from its current position x to position x\xe2\x88\x92b. Your task is to calculate the position of the frog after k jumps.But... One more thing. You are watching t different frogs so you have to answer t independent queries." 800
1076G "Array Game" "data structures,games" "Consider a following game between two players:There is an array b1, b2, ..., bk, consisting of positive integers. Initially a chip is placed into the first cell of the array, and b1 is decreased by 1. Players move in turns. Each turn the current player has to do the following: if the index of the cell where the chip is currently placed is x, then he or she has to choose an index y\xe2\x88\x88[x,min(k,x+m)] such that by>0, move the chip to the cell y and decrease by by 1. If it\'s impossible to make a valid move, the current player loses the game.Your task is the following: you are given an array a consisting of n positive integers, and q queries to it. There are two types of queries: 1 l r d \xe2\x80\x94 for every i\xe2\x88\x88[l,r] increase ai by d;  2 l r \xe2\x80\x94 tell who is the winner of the game that is played on the subarray of a from index l to index r inclusive. Assume both players choose an optimal strategy." 3000
1076F "Summer Practice Report" dp,greedy "Vova has taken his summer practice this year and now he should write a report on how it went.Vova has already drawn all the tables and wrote down all the formulas. Moreover, he has already decided that the report will consist of exactly n pages and the i-th page will include xi tables and yi formulas. The pages are numbered from 1 to n.Vova fills the pages one after another, he can\'t go filling page i+1 before finishing page i and he can\'t skip pages. However, if he draws strictly more than k tables in a row or writes strictly more than k formulas in a row then he will get bored. Vova wants to rearrange tables and formulas in each page in such a way that he doesn\'t get bored in the process. Vova can\'t move some table or some formula to another page.Note that the count doesn\'t reset on the start of the new page. For example, if the page ends with 3 tables and the next page starts with 5 tables, then it\'s counted as 8 tables in a row.Help Vova to determine if he can rearrange tables and formulas on each page in such a way that there is no more than k tables in a row and no more than k formulas in a row." 2500
1076E "Vasya and a Tree" "data structures,trees" "Vasya has a tree consisting of n vertices with root in vertex 1. At first all vertices has 0 written on it.Let d(i,j) be the distance between vertices i and j, i.e. number of edges in the shortest path from i to j. Also, let\'s denote k-subtree of vertex x \xe2\x80\x94 set of vertices y such that next two conditions are met:   x is the ancestor of y (each vertex is the ancestor of itself);  d(x,y)\xe2\x89\xa4k. Vasya needs you to process m queries. The i-th query is a triple vi, di and xi. For each query Vasya adds value xi to each vertex from di-subtree of vi.Report to Vasya all values, written on vertices of the tree after processing all queries." 1900
1076D "Edge Deletion" "graphs,greedy,shortest paths" "You are given an undirected connected weighted graph consisting of n vertices and m edges. Let\'s denote the length of the shortest path from vertex 1 to vertex i as di. You have to erase some edges of the graph so that at most k edges remain. Let\'s call a vertex i good if there still exists a path from 1 to i with length di after erasing the edges.Your goal is to erase the edges in such a way that the number of good vertices is maximized." 1800
1076C "Meme Problem" "binary search,math" "Try guessing the statement from this picture:   You are given a non-negative integer d. You have to find two non-negative real numbers a and b such that a+b=d and a\xe2\x8b\x85b=d." 1300
1076B "Divisor Subtraction" "implementation,math,number theory" "You are given an integer number n. The following algorithm is applied to it:  if n=0, then end algorithm;  find the smallest prime divisor d of n;  subtract d from n and go to step 1. Determine the number of subtrations the algorithm will make." 1200
1076A "Minimizing the String" greedy,strings "You are given a string s consisting of n lowercase Latin letters.You have to remove at most one (i.e. zero or one) character of this string in such a way that the string you obtain will be lexicographically smallest among all strings that can be obtained using this operation.String s=s1s2\xe2\x80\xa6sn is lexicographically smaller than string t=t1t2\xe2\x80\xa6tm if n<m and s1=t1,s2=t2,\xe2\x80\xa6,sn=tn or there exists a number p such that p\xe2\x89\xa4min(n,m) and s1=t1,s2=t2,\xe2\x80\xa6,sp\xe2\x88\x921=tp\xe2\x88\x921 and sp<tp.For example, ""aaa"" is smaller than ""aaaa"", ""abb"" is smaller than ""abc"", ""pqr"" is smaller than ""z""." 1200
1075B "Taxi drivers and Lyft" implementation,sortings "Palo Alto is an unusual city because it is an endless coordinate line. It is also known for the office of Lyft Level 5.Lyft has become so popular so that it is now used by all m taxi drivers in the city, who every day transport the rest of the city residents \xe2\x80\x94 n riders.Each resident (including taxi drivers) of Palo-Alto lives in its unique location (there is no such pair of residents that their coordinates are the same).The Lyft system is very clever: when a rider calls a taxi, his call does not go to all taxi drivers, but only to the one that is the closest to that person. If there are multiple ones with the same distance, then to taxi driver with a smaller coordinate is selected.But one morning the taxi drivers wondered: how many riders are there that would call the given taxi driver if they were the first to order a taxi on that day? In other words, you need to find for each taxi driver i the number ai \xe2\x80\x94 the number of riders that would call the i-th taxi driver when all drivers and riders are at their home?The taxi driver can neither transport himself nor other taxi drivers." 1200
1075A "The King\'s Race" implementation,math "On a chessboard with a width of nn and a height of nn, rows are numbered from bottom to top from 11 to nn, columns are numbered from left to right from 11 to nn. Therefore, for each cell of the chessboard, you can assign the coordinates (r,c)(r,c), where rr is the number of the row, and cc is the number of the column.The white king has been sitting in a cell with (1,1)(1,1) coordinates for a thousand years, while the black king has been sitting in a cell with (n,n)(n,n) coordinates. They would have sat like that further, but suddenly a beautiful coin fell on the cell with coordinates (x,y)(x,y)...Each of the monarchs wanted to get it, so they decided to arrange a race according to slightly changed chess rules:As in chess, the white king makes the first move, the black king makes the second one, the white king makes the third one, and so on. However, in this problem, kings can stand in adjacent cells or even in the same cell at the same time.The player who reaches the coin first will win, that is to say, the player who reaches the cell with the coordinates (x,y)(x,y) first will win.Let\'s recall that the king is such a chess piece that can move one cell in all directions, that is, if the king is in the (a,b)(a,b) cell, then in one move he can move from (a,b)(a,b) to the cells (a+1,b)(a+1,b), (a\xe2\x88\x921,b)(a\xe2\x88\x921,b), (a,b+1)(a,b+1), (a,b\xe2\x88\x921)(a,b\xe2\x88\x921), (a+1,b\xe2\x88\x921)(a+1,b\xe2\x88\x921), (a+1,b+1)(a+1,b+1), (a\xe2\x88\x921,b\xe2\x88\x921)(a\xe2\x88\x921,b\xe2\x88\x921), or (a\xe2\x88\x921,b+1)(a\xe2\x88\x921,b+1). Going outside of the field is prohibited.Determine the color of the king, who will reach the cell with the coordinates (x,y)(x,y) first, if the white king moves first." 800
1073G "Yet Another LCP Problem" "data structures,string suffix structures" "Let LCP(s,t) be the length of the longest common prefix of strings s and t. Also let s[x\xe2\x80\xa6y] be the substring of s from index x to index y (inclusive). For example, if s= ""abcde"", then s[1\xe2\x80\xa63]= ""abc"", s[2\xe2\x80\xa65]= ""bcde"".You are given a string s of length n and q queries. Each query is a pair of integer sets a1,a2,\xe2\x80\xa6,ak and b1,b2,\xe2\x80\xa6,bl. Calculate i=k\xe2\x88\x91i=1j=l\xe2\x88\x91j=1LCP(s[ai\xe2\x80\xa6n],s[bj\xe2\x80\xa6n]) for each query." 2600
1073F "Choosing Two Paths" "dfs and similar,dp,greedy,trees" "You are given an undirected unweighted tree consisting of n vertices.An undirected tree is a connected undirected graph with n\xe2\x88\x921 edges.Your task is to choose two pairs of vertices of this tree (all the chosen vertices should be distinct) (x1,y1) and (x2,y2) in such a way that neither x1 nor y1 belong to the simple path from x2 to y2 and vice versa (neither x2 nor y2 should not belong to the simple path from x1 to y1).It is guaranteed that it is possible to choose such pairs for the given tree.Among all possible ways to choose such pairs you have to choose one with the maximum number of common vertices between paths from x1 to y1 and from x2 to y2. And among all such pairs you have to choose one with the maximum total length of these two paths.It is guaranteed that the answer with at least two common vertices exists for the given tree.The length of the path is the number of edges in it.The simple path is the path that visits each vertex at most once." 2500
1073E "Segment Sum" bitmasks,combinatorics,dp,math "You are given two integers l and r (l\xe2\x89\xa4r). Your task is to calculate the sum of numbers from l to r (including l and r) such that each number contains at most k different digits, and print this sum modulo 998244353.For example, if k=1 then you have to calculate all numbers from l to r such that each number is formed using only one digit. For l=10,r=50 the answer is 11+22+33+44=110." 2300
1073D "Berland Fair" "binary search,brute force,data structures,greedy" "XXI Berland Annual Fair is coming really soon! Traditionally fair consists of n booths, arranged in a circle. The booths are numbered 1 through n clockwise with n being adjacent to 1. The i-th booths sells some candies for the price of ai burles per item. Each booth has an unlimited supply of candies.Polycarp has decided to spend at most T burles at the fair. However, he has some plan in mind for his path across the booths:  at first, he visits booth number 1;  if he has enough burles to buy exactly one candy from the current booth, then he buys it immediately;  then he proceeds to the next booth in the clockwise order (regardless of if he bought a candy or not). Polycarp\'s money is finite, thus the process will end once he can no longer buy candy at any booth.Calculate the number of candies Polycarp will buy." 1700
1073C "Vasya and Robot" "binary search,two pointers" "Vasya has got a robot which is situated on an infinite Cartesian plane, initially in the cell (0,0). Robot can perform the following four kinds of operations:   U \xe2\x80\x94 move from (x,y) to (x,y+1);  D \xe2\x80\x94 move from (x,y) to (x,y\xe2\x88\x921);  L \xe2\x80\x94 move from (x,y) to (x\xe2\x88\x921,y);  R \xe2\x80\x94 move from (x,y) to (x+1,y). Vasya also has got a sequence of n operations. Vasya wants to modify this sequence so after performing it the robot will end up in (x,y).Vasya wants to change the sequence so the length of changed subsegment is minimum possible. This length can be calculated as follows: maxID\xe2\x88\x92minID+1, where maxID is the maximum index of a changed operation, and minID is the minimum index of a changed operation. For example, if Vasya changes RRRRRRR to RLRRLRL, then the operations with indices 2, 5 and 7 are changed, so the length of changed subsegment is 7\xe2\x88\x922+1=6. Another example: if Vasya changes DDDD to DDRD, then the length of changed subsegment is 1. If there are no changes, then the length of changed subsegment is 0. Changing an operation means replacing it with some operation (possibly the same); Vasya can\'t insert new operations into the sequence or remove them.Help Vasya! Tell him the minimum length of subsegment that he needs to change so that the robot will go from (0,0) to (x,y), or tell him that it\'s impossible." 1800
1073B "Vasya and Books" implementation,math "Vasya has got n books, numbered from 1 to n, arranged in a stack. The topmost book has number a1, the next one \xe2\x80\x94 a2, and so on. The book at the bottom of the stack has number an. All numbers are distinct.Vasya wants to move all the books to his backpack in n steps. During i-th step he wants to move the book number bi into his backpack. If the book with number bi is in the stack, he takes this book and all the books above the book bi, and puts them into the backpack; otherwise he does nothing and begins the next step. For example, if books are arranged in the order [1,2,3] (book 1 is the topmost), and Vasya moves the books in the order [2,1,3], then during the first step he will move two books (1 and 2), during the second step he will do nothing (since book 1 is already in the backpack), and during the third step \xe2\x80\x94 one book (the book number 3). Note that b1,b2,\xe2\x80\xa6,bn are distinct.Help Vasya! Tell him the number of books he will put into his backpack during each step." 1000
1073A "Diverse Substring" implementation,strings "You are given a string s, consisting of n lowercase Latin letters.A substring of string s is a continuous segment of letters from s. For example, ""defor"" is a substring of ""codeforces"" and ""fors"" is not. The length of the substring is the number of letters in it.Let\'s call some string of length n diverse if and only if there is no letter to appear strictly more than n2 times. For example, strings ""abc"" and ""iltlml"" are diverse and strings ""aab"" and ""zz"" are not.Your task is to find any diverse substring of string s or report that there is none. Note that it is not required to maximize or minimize the length of the resulting substring." 1000
1071E "Rain Protection" "binary search,geometry" "A lot of people dream of convertibles (also often called cabriolets). Some of convertibles, however, don\'t have roof at all, and are vulnerable to rain. This is why Melon Ask, the famous inventor, decided to create a rain protection mechanism for convertibles.The workplace of the mechanism is a part of plane just above the driver. Its functional part consists of two rails with sliding endpoints of a piece of stretching rope. For the sake of simplicity we can consider this as a pair of parallel segments in a plane with the rope segment, whose endpoints we are free to choose as any points on these rails segments.  The algorithmic part of the mechanism detects each particular raindrop and predicts when and where it reaches the plane. At this exact moment the rope segment must contain the raindrop point (so the rope adsorbs the raindrop).You are given the initial position of the rope endpoints and all information about raindrops. You are to choose the minimal possible speed v of the endpoints sliding (both endpoints can slide in any direction along their segments independently of each other) in such a way that it is possible to catch all raindrops moving both endpoints with speed not greater than v, or find out that it\'s impossible no matter how high the speed is." 3500
1070M "Algoland and Berland" "constructive algorithms,divide and conquer,geometry" "Once upon a time Algoland and Berland were a single country, but those times are long gone. Now they are two different countries, but their cities are scattered on a common territory.All cities are represented as points on the Cartesian plane. Algoland consists of a cities numbered from 1 to a. The coordinates of the i-th Algoland city are a pair of integer numbers (xai,yai). Similarly, Berland consists of b cities numbered from 1 to b. The coordinates of the j-th Berland city are a pair of integer numbers (xbj,ybj). No three of the a+b mentioned cities lie on a single straight line.As the first step to unite the countries, Berland decided to build several bidirectional freeways. Each freeway is going to be a line segment that starts in a Berland city and ends in an Algoland city. Freeways can\'t intersect with each other at any point except freeway\'s start or end. Moreover, the freeways have to connect all a+b cities. Here, connectivity means that one can get from any of the specified a+b cities to any other of the a+b cities using freeways. Note that all freeways are bidirectional, which means that one can drive on each of them in both directions.Mayor of each of the b Berland cities allocated a budget to build the freeways that start from this city. Thus, you are given the numbers r1,r2,\xe2\x80\xa6,rb, where rj is the number of freeways that are going to start in the j-th Berland city. The total allocated budget is very tight and only covers building the minimal necessary set of freeways. In other words, r1+r2+\xe2\x8b\xaf+rb=a+b\xe2\x88\x921.Help Berland to build the freeways so that:  each freeway is a line segment connecting a Berland city and an Algoland city,  no freeways intersect with each other except for the freeway\'s start or end,  freeways connect all a+b cities (all freeways are bidirectional),  there are rj freeways that start from the j-th Berland city." 3000
1070L "Odd Federalization" "constructive algorithms" "Berland has n cities, some of which are connected by roads. Each road is bidirectional, connects two distinct cities and for each two cities there\'s at most one road connecting them.The president of Berland decided to split country into r states in such a way that each city will belong to exactly one of these r states.After this split each road will connect either cities of the same state or cities of the different states. Let\'s call roads that connect two cities of the same state ""inner"" roads.The president doesn\'t like odd people, odd cities and odd numbers, so he wants this split to be done in such a way that each city would have even number of ""inner"" roads connected to it.Please help president to find smallest possible r for which such a split exists." 2600
1070K "Video Posts" implementation "Polycarp took n videos, the duration of the i-th video is ai seconds. The videos are listed in the chronological order, i.e. the 1-st video is the earliest, the 2-nd video is the next, ..., the n-th video is the last.Now Polycarp wants to publish exactly k (1\xe2\x89\xa4k\xe2\x89\xa4n) posts in Instabram. Each video should be a part of a single post. The posts should preserve the chronological order, it means that the first post should contain one or more of the earliest videos, the second post should contain a block (one or more videos) going next and so on. In other words, if the number of videos in the j-th post is sj then:  s1+s2+\xe2\x8b\xaf+sk=n (si>0),  the first post contains the videos: 1,2,\xe2\x80\xa6,s1;  the second post contains the videos: s1+1,s1+2,\xe2\x80\xa6,s1+s2;  the third post contains the videos: s1+s2+1,s1+s2+2,\xe2\x80\xa6,s1+s2+s3;  ...  the k-th post contains videos: n\xe2\x88\x92sk+1,n\xe2\x88\x92sk+2,\xe2\x80\xa6,n. Polycarp is a perfectionist, he wants the total duration of videos in each post to be the same.Help Polycarp to find such positive integer values s1,s2,\xe2\x80\xa6,sk that satisfy all the conditions above." 1100
1070J "Streets and Avenues in Berhattan" dp "Berhattan is the capital of Berland. There are n streets running parallel in the east-west direction (horizontally), and there are m avenues running parallel in the south-north direction (vertically). Each street intersects with each avenue, forming a crossroad. So in total there are n\xe2\x8b\x85m crossroads in Berhattan.Recently, the government has changed in Berland. The new government wants to name all avenues and all streets after heroes of revolution.The special committee prepared the list of k names. Only these names can be used as new names for streets and avenues. Each name can be used at most once.The members of committee want to name streets and avenues in the way that minimizes inconvenience for residents. They believe that if street and avenue names start with the same letter, then their crossroad will be inconvenient. Hence only the first letter of each name matters.Given first letters of k names, find C \xe2\x80\x94 minimal possible number of inconvenient crossroads in Berhattan after the naming process." 2300
1070I "Privatization of Roads in Berland" "flows,graph matchings,graphs" "There are n cities and m two-way roads in Berland, each road connecting two distinct cities.Recently the Berland government has made a tough decision to transfer ownership of the roads to private companies. In total, there are 100500 private companies in Berland, numbered by integers from 1 to 100500. After the privatization, every road should belong to exactly one company.The anti-monopoly committee demands that after the privatization each company can own at most two roads. The urbanists of Berland also stated their opinion: each city should be adjacent to the roads owned by at most k companies.Help the government to distribute the roads between the companies so that both conditions are satisfied. That is, each company gets at most two roads, and each city has roads of at most k distinct companies adjacent to it." 2400
1070H "BerOS File Suggestion" "brute force,implementation" "Polycarp is working on a new operating system called BerOS. He asks you to help with implementation of a file suggestion feature.There are n files on hard drive and their names are f1,f2,\xe2\x80\xa6,fn. Any file name contains between 1 and 8 characters, inclusive. All file names are unique.The file suggestion feature handles queries, each represented by a string s. For each query s it should count number of files containing s as a substring (i.e. some continuous segment of characters in a file name equals s) and suggest any such file name.For example, if file names are ""read.me"", ""hosts"", ""ops"", and ""beros.18"", and the query is ""os"", the number of matched files is 2 (two file names contain ""os"" as a substring) and suggested file name can be either ""hosts"" or ""beros.18""." 1500
1070G "Monsters and Potions" "brute force,dp,greedy,implementation" "Polycarp is an introvert person. In fact he is so much of an introvert that he plays ""Monsters and Potions"" board game alone. The board of the game is a row of n cells. The cells are numbered from 1 to n from left to right. There are three types of cells: a cell containing a single monster, a cell containing a single potion or a blank cell (it contains neither a monster nor a potion).Polycarp has m tokens representing heroes fighting monsters, which are initially located in the blank cells s1,s2,\xe2\x80\xa6,sm. Polycarp\'s task is to choose a single cell (rally point) and one by one move all the heroes into this cell. A rally point can be a cell of any of three types.After Policarp selects a rally point, he picks a hero and orders him to move directly to the point. Once that hero reaches the point, Polycarp picks another hero and orders him also to go to the point. And so forth, until all the heroes reach the rally point cell. While going to the point, a hero can not deviate from the direct route or take a step back. A hero just moves cell by cell in the direction of the point until he reaches it. It is possible that multiple heroes are simultaneously in the same cell.Initially the i-th hero has hi hit points (HP). Monsters also have HP, different monsters might have different HP. And potions also have HP, different potions might have different HP.If a hero steps into a cell which is blank (i.e. doesn\'t contain a monster/potion), hero\'s HP does not change.If a hero steps into a cell containing a monster, then the hero and the monster fight. If monster\'s HP is strictly higher than hero\'s HP, then the monster wins and Polycarp loses the whole game. If hero\'s HP is greater or equal to monster\'s HP, then the hero wins and monster\'s HP is subtracted from hero\'s HP. I.e. the hero survives if his HP drops to zero, but dies (and Polycarp looses) if his HP becomes negative due to a fight. If a hero wins a fight with a monster, then the monster disappears, and the cell becomes blank.If a hero steps into a cell containing a potion, then the hero drinks the potion immediately. As a result, potion\'s HP is added to hero\'s HP, the potion disappears, and the cell becomes blank.Obviously, Polycarp wants to win the game. It means that he must choose such rally point and the order in which heroes move, that every hero reaches the rally point and survives. I.e. Polycarp loses if a hero reaches rally point but is killed by a monster at the same time. Polycarp can use any of n cells as a rally point \xe2\x80\x94 initially it can contain a monster, a potion, or be a blank cell with or without a hero in it.Help Polycarp write a program to choose a rally point and the order in which heroes move." 2300
1070F Debate greedy "Elections in Berland are coming. There are only two candidates \xe2\x80\x94 Alice and Bob.The main Berland TV channel plans to show political debates. There are n people who want to take part in the debate as a spectator. Each person is described by their influence and political views. There are four kinds of political views:  supporting none of candidates (this kind is denoted as ""00""),  supporting Alice but not Bob (this kind is denoted as ""10""),  supporting Bob but not Alice (this kind is denoted as ""01""),  supporting both candidates (this kind is denoted as ""11""). The direction of the TV channel wants to invite some of these people to the debate. The set of invited spectators should satisfy three conditions:  at least half of spectators support Alice (i.e. 2\xe2\x8b\x85a\xe2\x89\xa5m, where a is number of spectators supporting Alice and m is the total number of spectators),  at least half of spectators support Bob (i.e. 2\xe2\x8b\x85b\xe2\x89\xa5m, where b is number of spectators supporting Bob and m is the total number of spectators),  the total influence of spectators is maximal possible. Help the TV channel direction to select such non-empty set of spectators, or tell that this is impossible." 1500
1070E "Getting Deals Done" "binary search,data structures" "Polycarp has a lot of work to do. Recently he has learned a new time management rule: ""if a task takes five minutes or less, do it immediately"". Polycarp likes the new rule, however he is not sure that five minutes is the optimal value. He supposes that this value d should be chosen based on existing task list.Polycarp has a list of n tasks to complete. The i-th task has difficulty pi, i.e. it requires exactly pi minutes to be done. Polycarp reads the tasks one by one from the first to the n-th. If a task difficulty is d or less, Polycarp starts the work on the task immediately. If a task difficulty is strictly greater than d, he will not do the task at all. It is not allowed to rearrange tasks in the list. Polycarp doesn\'t spend any time for reading a task or skipping it.Polycarp has t minutes in total to complete maximum number of tasks. But he does not want to work all the time. He decides to make a break after each group of m consecutive tasks he was working on. The break should take the same amount of time as it was spent in total on completion of these m tasks.For example, if n=7, p=[3,1,4,1,5,9,2], d=3 and m=2 Polycarp works by the following schedule:  Polycarp reads the first task, its difficulty is not greater than d (p1=3\xe2\x89\xa4d=3) and works for 3 minutes (i.e. the minutes 1, 2, 3);  Polycarp reads the second task, its difficulty is not greater than d (p2=1\xe2\x89\xa4d=3) and works for 1 minute (i.e. the minute 4);  Polycarp notices that he has finished m=2 tasks and takes a break for 3+1=4 minutes (i.e. on the minutes 5,6,7,8);  Polycarp reads the third task, its difficulty is greater than d (p3=4>d=3) and skips it without spending any time;  Polycarp reads the fourth task, its difficulty is not greater than d (p4=1\xe2\x89\xa4d=3) and works for 1 minute (i.e. the minute 9);  Polycarp reads the tasks 5 and 6, skips both of them (p5>d and p6>d);  Polycarp reads the 7-th task, its difficulty is not greater than d (p7=2\xe2\x89\xa4d=3) and works for 2 minutes (i.e. the minutes 10, 11);  Polycarp notices that he has finished m=2 tasks and takes a break for 1+2=3 minutes (i.e. on the minutes 12,13,14). Polycarp stops exactly after t minutes. If Polycarp started a task but has not finished it by that time, the task is not considered as completed. It is allowed to complete less than m tasks in the last group. Also Polycarp considers acceptable to have shorter break than needed after the last group of tasks or even not to have this break at all \xe2\x80\x94 his working day is over and he will have enough time to rest anyway.Please help Polycarp to find such value d, which would allow him to complete maximum possible number of tasks in t minutes." 2100
1070D "Garbage Disposal" greedy "Enough is enough. Too many times it happened that Vasya forgot to dispose of garbage and his apartment stank afterwards. Now he wants to create a garbage disposal plan and stick to it.For each of next n days Vasya knows ai \xe2\x80\x94 number of units of garbage he will produce on the i-th day. Each unit of garbage must be disposed of either on the day it was produced or on the next day. Vasya disposes of garbage by putting it inside a bag and dropping the bag into a garbage container. Each bag can contain up to k units of garbage. It is allowed to compose and drop multiple bags into a garbage container in a single day.Being economical, Vasya wants to use as few bags as possible. You are to compute the minimum number of bags Vasya needs to dispose of all of his garbage for the given n days. No garbage should be left after the n-th day." 1300
1070C "Cloud Computing" "data structures,greedy" "Buber is a Berland technology company that specializes in waste of investor\'s money. Recently Buber decided to transfer its infrastructure to a cloud. The company decided to rent CPU cores in the cloud for n consecutive days, which are numbered from 1 to n. Buber requires k CPU cores each day.The cloud provider offers m tariff plans, the i-th tariff plan is characterized by the following parameters:  li and ri \xe2\x80\x94 the i-th tariff plan is available only on days from li to ri, inclusive,  ci \xe2\x80\x94 the number of cores per day available for rent on the i-th tariff plan,  pi \xe2\x80\x94 the price of renting one core per day on the i-th tariff plan. Buber can arbitrarily share its computing core needs between the tariff plans. Every day Buber can rent an arbitrary number of cores (from 0 to ci) on each of the available plans. The number of rented cores on a tariff plan can vary arbitrarily from day to day.Find the minimum amount of money that Buber will pay for its work for n days from 1 to n. If on a day the total number of cores for all available tariff plans is strictly less than k, then this day Buber will have to work on fewer cores (and it rents all the available cores), otherwise Buber rents exactly k cores this day." 2000
1070B Berkomnadzor "data structures,greedy" "Berkomnadzor \xe2\x80\x94 Federal Service for Supervision of Communications, Information Technology and Mass Media \xe2\x80\x94 is a Berland federal executive body that protects ordinary residents of Berland from the threats of modern internet.Berkomnadzor maintains a list of prohibited IPv4 subnets (blacklist) and a list of allowed IPv4 subnets (whitelist). All Internet Service Providers (ISPs) in Berland must configure the network equipment to block access to all IPv4 addresses matching the blacklist. Also ISPs must provide access (that is, do not block) to all IPv4 addresses matching the whitelist. If an IPv4 address does not match either of those lists, it\'s up to the ISP to decide whether to block it or not. An IPv4 address matches the blacklist (whitelist) if and only if it matches some subnet from the blacklist (whitelist). An IPv4 address can belong to a whitelist and to a blacklist at the same time, this situation leads to a contradiction (see no solution case in the output description).An IPv4 address is a 32-bit unsigned integer written in the form a.b.c.d, where each of the values a,b,c,d is called an octet and is an integer from 0 to 255 written in decimal notation. For example, IPv4 address 192.168.0.1 can be converted to a 32-bit number using the following expression 192\xe2\x8b\x85224+168\xe2\x8b\x85216+0\xe2\x8b\x8528+1\xe2\x8b\x8520. First octet a encodes the most significant (leftmost) 8 bits, the octets b and c \xe2\x80\x94 the following blocks of 8 bits (in this order), and the octet d encodes the least significant (rightmost) 8 bits.The IPv4 network in Berland is slightly different from the rest of the world. There are no reserved or internal addresses in Berland and use all 232 possible values.An IPv4 subnet is represented either as a.b.c.d or as a.b.c.d/x (where 0\xe2\x89\xa4x\xe2\x89\xa432). A subnet a.b.c.d contains a single address a.b.c.d. A subnet a.b.c.d/x contains all IPv4 addresses with x leftmost (most significant) bits equal to x leftmost bits of the address a.b.c.d. It is required that 32\xe2\x88\x92x rightmost (least significant) bits of subnet a.b.c.d/x are zeroes.Naturally it happens that all addresses matching subnet a.b.c.d/x form a continuous range. The range starts with address a.b.c.d (its rightmost 32\xe2\x88\x92x bits are zeroes). The range ends with address which x leftmost bits equal to x leftmost bits of address a.b.c.d, and its 32\xe2\x88\x92x rightmost bits are all ones. Subnet contains exactly 232\xe2\x88\x92x addresses. Subnet a.b.c.d/32 contains exactly one address and can also be represented by just a.b.c.d.For example subnet 192.168.0.0/24 contains range of 256 addresses. 192.168.0.0 is the first address of the range, and 192.168.0.255 is the last one.Berkomnadzor\'s engineers have devised a plan to improve performance of Berland\'s global network. Instead of maintaining both whitelist and blacklist they want to build only a single optimised blacklist containing minimal number of subnets. The idea is to block all IPv4 addresses matching the optimised blacklist and allow all the rest addresses. Of course, IPv4 addresses from the old blacklist must remain blocked and all IPv4 addresses from the old whitelist must still be allowed. Those IPv4 addresses which matched neither the old blacklist nor the old whitelist may be either blocked or allowed regardless of their accessibility before. Please write a program which takes blacklist and whitelist as input and produces optimised blacklist. The optimised blacklist must contain the minimal possible number of subnets and satisfy all IPv4 addresses accessibility requirements mentioned above. IPv4 subnets in the source lists may intersect arbitrarily. Please output a single number -1 if some IPv4 address matches both source whitelist and blacklist." 2400
1070A "Find a Number" "dp,graphs,number theory,shortest paths" "You are given two positive integers d and s. Find minimal positive integer n which is divisible by d and has sum of digits equal to s." 2200
1068C "Colored Rooks" "constructive algorithms,graphs" "Ivan is a novice painter. He has n dyes of different colors. He also knows exactly m pairs of colors which harmonize with each other.Ivan also enjoy playing chess. He has 5000 rooks. He wants to take k rooks, paint each of them in one of n colors and then place this k rooks on a chessboard of size 109\xc3\x97109.Let\'s call the set of rooks on the board connected if from any rook we can get to any other rook in this set moving only through cells with rooks from this set. Assume that rooks can jump over other rooks, in other words a rook can go to any cell which shares vertical and to any cell which shares horizontal.Ivan wants his arrangement of rooks to have following properties: For any color there is a rook of this color on a board; For any color the set of rooks of this color is connected; For any two different colors a b union of set of rooks of color a and set of rooks of color b is connected if and only if this two colors harmonize with each other.Please help Ivan find such an arrangement." 1700
1068B LCM "math,number theory" "Ivan has number b. He is sorting through the numbers a from 1 to 1018, and for every a writes [a,b]a on blackboard. Here [a,b] stands for least common multiple of a and b. Ivan is very lazy, that\'s why this task bored him soon. But he is interested in how many different numbers he would write on the board if he would finish the task. Help him to find the quantity of different numbers he would write on the board." 1200
1068A Birthday math "Ivan is collecting coins. There are only N different collectible coins, Ivan has K of them. He will be celebrating his birthday soon, so all his M freinds decided to gift him coins. They all agreed to three terms:  Everyone must gift as many coins as others. All coins given to Ivan must be different. Not less than L coins from gifts altogether, must be new in Ivan\'s collection.But his friends don\'t know which coins have Ivan already got in his collection. They don\'t want to spend money so they want to buy minimum quantity of coins, that satisfy all terms, irrespective of the Ivan\'s collection. Help them to find this minimum number of coins or define it\'s not possible to meet all the terms." 1400
1067E "Random Forest Rank" "dp,graph matchings,math,trees" "Let\'s define rank of undirected graph as rank of its adjacency matrix in Rn\xc3\x97n.Given a tree. Each edge of this tree will be deleted with probability 1/2, all these deletions are independent. Let E be the expected rank of resulting forest. Find E\xe2\x8b\x852n\xe2\x88\x921 modulo 998244353 (it is easy to show that E\xe2\x8b\x852n\xe2\x88\x921 is an integer)." 2800
1067D "Computer Game" dp,greedy,math,probabilities "Ivan plays some computer game. There are n quests in the game. Each quest can be upgraded once, this increases the reward for its completion. Each quest has 3 parameters ai, bi, pi: reward for completing quest before upgrade, reward for completing quest after upgrade (ai<bi) and probability of successful completing the quest.Each second Ivan can try to complete one quest and he will succeed with probability pi. In case of success Ivan will get the reward and opportunity to upgrade any one quest (not necessary the one he just completed). In case of failure he gets nothing. Quests do not vanish after completing.Ivan has t seconds. He wants to maximize expected value of his total gain after t seconds. Help him to calculate this value." 3100
1067C Knights "constructive algorithms" "Ivan places knights on infinite chessboard. Initially there are n knights. If there is free cell which is under attack of at least 4 knights then he places new knight in this cell. Ivan repeats this until there are no such free cells. One can prove that this process is finite. One can also prove that position in the end does not depend on the order in which new knights are placed.Ivan asked you to find initial placement of exactly n knights such that in the end there will be at least \xe2\x8c\x8an210\xe2\x8c\x8b knights." 2600
1067B Multihedgehog "dfs and similar,graphs,shortest paths" "Someone give a strange birthday present to Ivan. It is hedgehog \xe2\x80\x94 connected undirected graph in which one vertex has degree at least 3 (we will call it center) and all other vertices has degree 1. Ivan thought that hedgehog is too boring and decided to make himself k-multihedgehog.Let us define k-multihedgehog as follows: 1-multihedgehog is hedgehog: it has one vertex of degree at least 3 and some vertices of degree 1. For all k\xe2\x89\xa52, k-multihedgehog is (k\xe2\x88\x921)-multihedgehog in which the following changes has been made for each vertex v with degree 1: let u be its only neighbor; remove vertex v, create a new hedgehog with center at vertex w and connect vertices u and w with an edge. New hedgehogs can differ from each other and the initial gift. Thereby k-multihedgehog is a tree. Ivan made k-multihedgehog but he is not sure that he did not make any mistakes. That is why he asked you to check if his tree is indeed k-multihedgehog." 1800
1067A "Array Without Local Maximums" dp "Ivan unexpectedly saw a present from one of his previous birthdays. It is array of n numbers from 1 to 200. Array is old and some numbers are hard to read. Ivan remembers that for all elements at least one of its neighbours ls not less than it, more formally:a1\xe2\x89\xa4a2,an\xe2\x89\xa4an\xe2\x88\x921 andai\xe2\x89\xa4max(ai\xe2\x88\x921,ai+1) for all i from 2 to n\xe2\x88\x921.Ivan does not remember the array and asks to find the number of ways to restore it. Restored elements also should be integers from 1 to 200. Since the number of ways can be big, print it modulo 998244353." 1900
1066F "Yet another 2D Walking" dp "Maksim walks on a Cartesian plane. Initially, he stands at the point (0,0) and in one move he can go to any of four adjacent points (left, right, up, down). For example, if Maksim is currently at the point (0,0), he can go to any of the following points in one move:   (1,0);  (0,1);  (\xe2\x88\x921,0);  (0,\xe2\x88\x921). There are also n distinct key points at this plane. The i-th point is pi=(xi,yi). It is guaranteed that 0\xe2\x89\xa4xi and 0\xe2\x89\xa4yi and there is no key point (0,0).Let the first level points be such points that max(xi,yi)=1, the second level points be such points that max(xi,yi)=2 and so on. Maksim wants to visit all the key points. But he shouldn\'t visit points of level i+1 if he does not visit all the points of level i. He starts visiting the points from the minimum level of point from the given set.The distance between two points (x1,y1) and (x2,y2) is |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2| where |v| is the absolute value of v.Maksim wants to visit all the key points in such a way that the total distance he walks will be minimum possible. Your task is to find this distance.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 2100
1066E "Binary Numbers AND Sum" "data structures,implementation,math" "You are given two huge binary integer numbers a and b of lengths n and m respectively. You will repeat the following process: if b>0, then add to the answer the value a & b and divide b by 2 rounding down (i.e. remove the last digit of b), and repeat the process again, otherwise stop the process.The value a & b means bitwise AND of a and b. Your task is to calculate the answer modulo 998244353.Note that you should add the value a & b to the answer in decimal notation, not in binary. So your task is to calculate the answer in decimal notation. For example, if a=10102 (1010) and b=10002 (810), then the value a & b will be equal to 8, not to 1000." 1700
1066D "Boxes Packing" "binary search,implementation" "Maksim has n objects and m boxes, each box has size exactly k. Objects are numbered from 1 to n in order from left to right, the size of the i-th object is ai.Maksim wants to pack his objects into the boxes and he will pack objects by the following algorithm: he takes one of the empty boxes he has, goes from left to right through the objects, and if the i-th object fits in the current box (the remaining size of the box is greater than or equal to ai), he puts it in the box, and the remaining size of the box decreases by ai. Otherwise he takes the new empty box and continues the process above. If he has no empty boxes and there is at least one object not in some box then Maksim cannot pack the chosen set of objects.Maksim wants to know the maximum number of objects he can pack by the algorithm above. To reach this target, he will throw out the leftmost object from the set until the remaining set of objects can be packed in boxes he has. Your task is to say the maximum number of objects Maksim can pack in boxes he has.Each time when Maksim tries to pack the objects into the boxes, he will make empty all the boxes he has before do it (and the relative order of the remaining set of objects will not change)." 1800
1066C "Books Queries" implementation "You have got a shelf and want to put some books on it.You are given q queries of three types:  L id \xe2\x80\x94 put a book having index id on the shelf to the left from the leftmost existing book;  R id \xe2\x80\x94 put a book having index id on the shelf to the right from the rightmost existing book;  ? id \xe2\x80\x94 calculate the minimum number of books you need to pop from the left or from the right in such a way that the book with index id will be leftmost or rightmost. You can assume that the first book you will put can have any position (it does not matter) and queries of type 3 are always valid (it is guaranteed that the book in each such query is already placed). You can also assume that you don\'t put the same book on the shelf twice, so ids don\'t repeat in queries of first two types.Your problem is to answer all the queries of type 3 in order they appear in the input.Note that after answering the query of type 3 all the books remain on the shelf and the relative order of books does not change.If you are Python programmer, consider using PyPy instead of Python when you submit your code." 1400
1066B Heaters "greedy,two pointers" "Vova\'s house is an array consisting of n elements (yeah, this is the first problem, I think, where someone lives in the array). There are heaters in some positions of the array. The i-th element of the array is 1 if there is a heater in the position i, otherwise the i-th element of the array is 0.Each heater has a value r (r is the same for all heaters). This value means that the heater at the position pos can warm up all the elements in range [pos\xe2\x88\x92r+1;pos+r\xe2\x88\x921].Vova likes to walk through his house while he thinks, and he hates cold positions of his house. Vova wants to switch some of his heaters on in such a way that each element of his house will be warmed up by at least one heater. Vova\'s target is to warm up the whole house (all the elements of the array), i.e. if n=6, r=2 and heaters are at positions 2 and 5, then Vova can warm up the whole house if he switches all the heaters in the house on (then the first 3 elements will be warmed up by the first heater and the last 3 elements will be warmed up by the second heater).Initially, all the heaters are off.But from the other hand, Vova didn\'t like to pay much for the electricity. So he wants to switch the minimum number of heaters on in such a way that each element of his house is warmed up by at least one heater.Your task is to find this number of heaters or say that it is impossible to warm up the whole house." 1500
1066A "Vova and Train" math "Vova plans to go to the conference by train. Initially, the train is at the point 1 and the destination point of the path is the point L. The speed of the train is 1 length unit per minute (i.e. at the first minute the train is at the point 1, at the second minute \xe2\x80\x94 at the point 2 and so on).There are lanterns on the path. They are placed at the points with coordinates divisible by v (i.e. the first lantern is at the point v, the second is at the point 2v and so on).There is also exactly one standing train which occupies all the points from l to r inclusive.Vova can see the lantern at the point p if p is divisible by v and there is no standing train at this position (p\xe2\x88\x89[l;r]). Thus, if the point with the lantern is one of the points covered by the standing train, Vova can\'t see this lantern.Your problem is to say the number of lanterns Vova will see during the path. Vova plans to go to t different conferences, so you should answer t independent queries." 1100
1065G "Fibonacci Suffix" strings "Let\'s denote (yet again) the sequence of Fibonacci strings:F(0)= 0, F(1)= 1, F(i)=F(i\xe2\x88\x922)+F(i\xe2\x88\x921), where the plus sign denotes the concatenation of two strings.Let\'s denote the lexicographically sorted sequence of suffixes of string F(i) as A(F(i)). For example, F(4) is 01101, and A(F(4)) is the following sequence: 01, 01101, 1, 101, 1101. Elements in this sequence are numbered from 1.Your task is to print m first characters of k-th element of A(F(n)). If there are less than m characters in this suffix, then output the whole suffix." 2700
1065F "Up and Down the Tree" "dfs and similar,dp,trees" "You are given a tree with n vertices; its root is vertex 1. Also there is a token, initially placed in the root. You can move the token to other vertices. Let\'s assume current vertex of token is v, then you make any of the following two possible moves:   move down to any leaf in subtree of v;  if vertex v is a leaf, then move up to the parent no more than k times. In other words, if h(v) is the depth of vertex v (the depth of the root is 0), then you can move to vertex to such that to is an ancestor of v and h(v)\xe2\x88\x92k\xe2\x89\xa4h(to). Consider that root is not a leaf (even if its degree is 1). Calculate the maximum number of different leaves you can visit during one sequence of moves." 2500
1065E "Side Transmutations" combinatorics,strings "Consider some set of distinct characters A and some string S, consisting of exactly n characters, where each character is present in A.You are given an array of m integers b (b1<b2<\xe2\x8b\xaf<bm). You are allowed to perform the following move on the string S:  Choose some valid i and set k=bi;  Take the first k characters of S=Prk;  Take the last k characters of S=Suk;  Substitute the first k characters of S with the reversed Suk;  Substitute the last k characters of S with the reversed Prk. For example, let\'s take a look at S= ""abcdefghi"" and k=2. Pr2= ""ab"", Su2= ""hi"". Reversed Pr2= ""ba"", Su2= ""ih"". Thus, the resulting S is ""ihcdefgba"".The move can be performed arbitrary number of times (possibly zero). Any i can be selected multiple times over these moves.Let\'s call some strings S and T equal if and only if there exists such a sequence of moves to transmute string S to string T. For the above example strings ""abcdefghi"" and ""ihcdefgba"" are equal. Also note that this implies S=S.The task is simple. Count the number of distinct strings.The answer can be huge enough, so calculate it modulo 998244353." 2300
1065D "Three Pieces" "dfs and similar,dp,shortest paths" "You stumbled upon a new kind of chess puzzles. The chessboard you are given is not necesserily 8\xc3\x978, but it still is N\xc3\x97N. Each square has some number written on it, all the numbers are from 1 to N2 and all the numbers are pairwise distinct. The j-th square in the i-th row has a number Aij written on it.In your chess set you have only three pieces: a knight, a bishop and a rook. At first, you put one of them on the square with the number 1 (you can choose which one). Then you want to reach square 2 (possibly passing through some other squares in process), then square 3 and so on until you reach square N2. In one step you are allowed to either make a valid move with the current piece or replace it with some other piece. Each square can be visited arbitrary number of times.A knight can move to a square that is two squares away horizontally and one square vertically, or two squares vertically and one square horizontally. A bishop moves diagonally. A rook moves horizontally or vertically. The move should be performed to a different square from the one a piece is currently standing on.You want to minimize the number of steps of the whole traversal. Among all the paths to have the same number of steps you want to choose the one with the lowest number of piece replacements.What is the path you should take to satisfy all conditions?" 2200
1065C "Make It Equal" greedy "There is a toy building consisting of n towers. Each tower consists of several cubes standing on each other. The i-th tower consists of hi cubes, so it has height hi.Let\'s define operation slice on some height H as following: for each tower i, if its height is greater than H, then remove some top cubes to make tower\'s height equal to H. Cost of one ""slice"" equals to the total number of removed cubes from all towers.Let\'s name slice as good one if its cost is lower or equal to k (k\xe2\x89\xa5n).  Calculate the minimum number of good slices you have to do to make all towers have the same height. Of course, it is always possible to make it so." 1600
1065B "Vasya and Isolated Vertices" "constructive algorithms,graphs" "Vasya has got an undirected graph consisting of n vertices and m edges. This graph doesn\'t contain any self-loops or multiple edges. Self-loop is an edge connecting a vertex to itself. Multiple edges are a pair of edges such that they connect the same pair of vertices. Since the graph is undirected, the pair of edges (1,2) and (2,1) is considered to be multiple edges. Isolated vertex of the graph is a vertex such that there is no edge connecting this vertex to any other vertex.Vasya wants to know the minimum and maximum possible number of isolated vertices in an undirected graph consisting of n vertices and m edges." 1300
1065A "Vasya and Chocolate" implementation,math "There is a special offer in Vasya\'s favourite supermarket: if the customer buys a chocolate bars, he or she may take b additional bars for free. This special offer can be used any number of times.Vasya currently has s roubles, and he wants to get as many chocolate bars for free. Each chocolate bar costs c roubles. Help Vasya to calculate the maximum possible number of chocolate bars he can get!" 800
1064B "Equations of Mathematical Magic" math "Colossal! \xe2\x80\x94 exclaimed Hawk-nose. \xe2\x80\x94 A programmer! That\'s exactly what we are looking for.Arkadi and Boris Strugatsky. Monday starts on SaturdayReading the book ""Equations of Mathematical Magic"" Roman Oira-Oira and Cristobal Junta found an interesting equation: a\xe2\x88\x92(a\xe2\x8a\x95x)\xe2\x88\x92x=0 for some given a, where \xe2\x8a\x95 stands for a bitwise exclusive or (XOR) of two integers (this operation is denoted as ^ or xor in many modern programming languages). Oira-Oira quickly found some x, which is the solution of the equation, but Cristobal Junta decided that Oira-Oira\'s result is not interesting enough, so he asked his colleague how many non-negative solutions of this equation exist. This task turned out to be too difficult for Oira-Oira, so he asks you to help." 1200
1064A "Make a triangle!" "brute force,geometry,math" "Masha has three sticks of length a, b and c centimeters respectively. In one minute Masha can pick one arbitrary stick and increase its length by one centimeter. She is not allowed to break sticks.What is the minimum number of minutes she needs to spend increasing the stick\'s length in order to be able to assemble a triangle of positive area. Sticks should be used as triangle\'s sides (one stick for one side) and their endpoints should be located at triangle\'s vertices." 800
1063F "String Journey" "data structures,dp,string suffix structures" "We call a sequence of strings t1,\xe2\x80\x89...,\xe2\x80\x89tk a journey of length k, if for each i\xe2\x80\x89>\xe2\x80\x891 ti is a substring of ti\xe2\x80\x89-\xe2\x80\x891 and length of ti is strictly less than length of ti\xe2\x80\x89-\xe2\x80\x891. For example, {ab,\xe2\x80\x89b} is a journey, but {ab,\xe2\x80\x89c} and {a,\xe2\x80\x89a} are not.Define a journey on string s as journey t1,\xe2\x80\x89...,\xe2\x80\x89tk, such that all its parts can be nested inside s in such a way that there exists a sequence of strings u1,\xe2\x80\x89...,\xe2\x80\x89uk\xe2\x80\x89+\xe2\x80\x891 (each of these strings can be empty) and s\xe2\x80\x89=\xe2\x80\x89u1\xe2\x80\x89t1\xe2\x80\x89u2\xe2\x80\x89t2... uk\xe2\x80\x89tk\xe2\x80\x89uk\xe2\x80\x89+\xe2\x80\x891. As an example, {ab,\xe2\x80\x89b} is a journey on string abb, but not on bab because the journey strings ti should appear from the left to the right.The length of a journey on a string is the number of strings in it. Determine the maximum possible length of a journey on the given string s." 3300
1063E "Lasers and Mirrors" "constructive algorithms,math" "Oleg came to see the maze of mirrors. The maze is a n by n room in which each cell is either empty or contains a mirror connecting opposite corners of this cell. Mirrors in this maze reflect light in a perfect way, which causes the interesting visual effects and contributes to the loss of orientation in the maze.Oleg is a person of curious nature, so he decided to install n lasers facing internal of the maze on the south wall of the maze. On the north wall of the maze, Oleg installed n receivers, also facing internal of the maze. Let\'s number lasers and receivers from west to east with distinct integers from 1 to n. Each laser sends a beam of some specific kind and receiver with number ai should receive the beam sent from laser number i. Since two lasers\' beams can\'t come to the same receiver, these numbers form a permutation \xe2\x80\x94 each of the receiver numbers occurs exactly once.You came to the maze together with Oleg. Help him to place the mirrors in the initially empty maze so that the maximum number of lasers\' beams will come to the receivers they should. There are no mirrors outside the maze, so if the laser beam leaves the maze, it will not be able to go back." 3000
1063D "Candies for Children" "brute force,math" "At the children\'s festival, children were dancing in a circle. When music stopped playing, the children were still standing in a circle. Then Lena remembered, that her parents gave her a candy box with exactly k candies ""Wilky May"". Lena is not a greedy person, so she decided to present all her candies to her friends in the circle. Lena knows, that some of her friends have a sweet tooth and others do not. Sweet tooth takes out of the box two candies, if the box has at least two candies, and otherwise takes one. The rest of Lena\'s friends always take exactly one candy from the box.Before starting to give candies, Lena step out of the circle, after that there were exactly n people remaining there. Lena numbered her friends in a clockwise order with positive integers starting with 1 in such a way that index 1 was assigned to her best friend Roma.Initially, Lena gave the box to the friend with number l, after that each friend (starting from friend number l) took candies from the box and passed the box to the next friend in clockwise order. The process ended with the friend number r taking the last candy (or two, who knows) and the empty box. Please note that it is possible that some of Lena\'s friends took candy from the box several times, that is, the box could have gone several full circles before becoming empty.Lena does not know which of her friends have a sweet tooth, but she is interested in the maximum possible number of friends that can have a sweet tooth. If the situation could not happen, and Lena have been proved wrong in her observations, please tell her about this." 2600
1063C "Dwarves, Hats and Extrasensory Abilities" "binary search,constructive algorithms,geometry,interactive" "This is an interactive problem.In good old times dwarves tried to develop extrasensory abilities:  Exactly n dwarves entered completely dark cave.  Each dwarf received a hat \xe2\x80\x94 white or black. While in cave, none of the dwarves was able to see either his own hat or hats of other Dwarves.  Dwarves went out of the cave to the meadow and sat at an arbitrary place one after the other. When a dwarf leaves the cave, he sees the colors of all hats of all dwarves that are seating on the meadow (i.e. left the cave before him). However, he is not able to see the color of his own hat and none of the dwarves can give him this information.  The task for dwarves was to got diverged into two parts \xe2\x80\x94 one with dwarves with white hats and one with black hats. After many centuries, dwarves finally managed to select the right place on the meadow without error. Will you be able to repeat their success?You are asked to successively name n different integer points on the plane. After naming each new point you will be given its color \xe2\x80\x94 black or white. Your task is to ensure that the named points can be split by a line in such a way that all points of one color lie on the same side from the line and points of different colors lie on different sides. Moreover, no points can belong to the line. Also, you need to report any such line at the end of the process.In this problem, the interactor is adaptive \xe2\x80\x94 the colors of the points in the tests are not fixed beforehand and the jury program can select them arbitrarily, in particular, depending on your program output." 1900
1063B Labyrinth "graphs,shortest paths" "You are playing some computer game. One of its levels puts you in a maze consisting of n lines, each of which contains m cells. Each cell either is free or is occupied by an obstacle. The starting cell is in the row r and column c. In one step you can move one square up, left, down or right, if the target cell is not occupied by an obstacle. You can\'t move beyond the boundaries of the labyrinth.Unfortunately, your keyboard is about to break, so you can move left no more than x times and move right no more than y times. There are no restrictions on the number of moves up and down since the keys used to move up and down are in perfect condition.Now you would like to determine for each cell whether there exists a sequence of moves that will put you from the starting cell to this particular one. How many cells of the board have this property?" 1800
1063A "Oh Those Palindromes" "constructive algorithms,strings" "A non-empty string is called palindrome, if it reads the same from the left to the right and from the right to the left. For example, ""abcba"", ""a"", and ""abba"" are palindromes, while ""abab"" and ""xy"" are not.A string is called a substring of another string, if it can be obtained from that string by dropping some (possibly zero) number of characters from the beginning and from the end of it. For example, ""abc"", ""ab"", and ""c"" are substrings of the string ""abc"", while ""ac"" and ""d"" are not.Let\'s define a palindromic count of the string as the number of its substrings that are palindromes. For example, the palindromic count of the string ""aaa"" is 6 because all its substrings are palindromes, and the palindromic count of the string ""abc"" is 3 because only its substrings of length 1 are palindromes.You are given a string s. You can arbitrarily rearrange its characters. You goal is to obtain a string with the maximum possible value of palindromic count." 1300
1062F "Upgrading Cities" "dfs and similar,graphs" "There are n cities in the kingdom X, numbered from 1 through n. People travel between cities by some one-way roads. As a passenger, JATC finds it weird that from any city u, he can\'t start a trip in it and then return back to it using the roads of the kingdom. That is, the kingdom can be viewed as an acyclic graph.Being annoyed by the traveling system, JATC decides to meet the king and ask him to do something. In response, the king says that he will upgrade some cities to make it easier to travel. Because of the budget, the king will only upgrade those cities that are important or semi-important. A city u is called important if for every city v\xe2\x89\xa0u, there is either a path from u to v or a path from v to u. A city u is called semi-important if it is not important and we can destroy exactly one city v\xe2\x89\xa0u so that u becomes important.The king will start to act as soon as he finds out all those cities. Please help him to speed up the process." 2900
1062E Company "binary search,data structures,dfs and similar,greedy,trees" "The company X has n employees numbered from 1 through n. Each employee u has a direct boss pu (1\xe2\x89\xa4pu\xe2\x89\xa4n), except for the employee 1 who has no boss. It is guaranteed, that values pi form a tree. Employee u is said to be in charge of employee v if u is the direct boss of v or there is an employee w such that w is in charge of v and u is the direct boss of w. Also, any employee is considered to be in charge of himself.In addition, for each employee u we define it\'s level lv(u) as follow:   lv(1)=0  lv(u)=lv(pu)+1 for u\xe2\x89\xa01 In the near future, there are q possible plans for the company to operate. The i-th plan consists of two integers li and ri, meaning that all the employees in the range [li,ri], and only they, are involved in this plan. To operate the plan smoothly, there must be a project manager who is an employee in charge of all the involved employees. To be precise, if an employee u is chosen as the project manager for the i-th plan then for every employee v\xe2\x88\x88[li,ri], u must be in charge of v. Note, that u is not necessary in the range [li,ri]. Also, u is always chosen in such a way that lv(u) is as large as possible (the higher the level is, the lower the salary that the company has to pay the employee).Before any plan is operated, the company has JATC take a look at their plans. After a glance, he tells the company that for every plan, it\'s possible to reduce the number of the involved employees exactly by one without affecting the plan. Being greedy, the company asks JATC which employee they should kick out of the plan so that the level of the project manager required is as large as possible. JATC has already figured out the answer and challenges you to do the same." 2300
1062D "Fun with Integers" "dfs and similar,graphs,implementation,math" "You are given a positive integer n greater or equal to 2. For every pair of integers a and b (2\xe2\x89\xa4|a|,|b|\xe2\x89\xa4n), you can transform a into b if and only if there exists an integer x such that 1<|x| and (a\xe2\x8b\x85x=b or b\xe2\x8b\x85x=a), where |x| denotes the absolute value of x.After such a transformation, your score increases by |x| points and you are not allowed to transform a into b nor b into a anymore.Initially, you have a score of 0. You can start at any integer and transform it as many times as you like. What is the maximum score you can achieve?" 1800
1062C Banh-mi greedy,implementation,math "JATC loves Banh-mi (a Vietnamese food). His affection for Banh-mi is so much that he always has it for breakfast. This morning, as usual, he buys a Banh-mi and decides to enjoy it in a special way.First, he splits the Banh-mi into n parts, places them on a row and numbers them from 1 through n. For each part i, he defines the deliciousness of the part as xi\xe2\x88\x88{0,1}. JATC\'s going to eat those parts one by one. At each step, he chooses arbitrary remaining part and eats it. Suppose that part is the i-th part then his enjoyment of the Banh-mi will increase by xi and the deliciousness of all the remaining parts will also increase by xi. The initial enjoyment of JATC is equal to 0.For example, suppose the deliciousness of 3 parts are [0,1,0]. If JATC eats the second part then his enjoyment will become 1 and the deliciousness of remaining parts will become [1,_,1]. Next, if he eats the first part then his enjoyment will become 2 and the remaining parts will become [_,_,2]. After eating the last part, JATC\'s enjoyment will become 4.However, JATC doesn\'t want to eat all the parts but to save some for later. He gives you q queries, each of them consisting of two integers li and ri. For each query, you have to let him know what is the maximum enjoyment he can get if he eats all the parts with indices in the range [li,ri] in some order.All the queries are independent of each other. Since the answer to the query could be very large, print it modulo 109+7." 1600
1062B Math "greedy,math,number theory" "JATC\'s math teacher always gives the class some interesting math problems so that they don\'t get bored. Today the problem is as follows. Given an integer n, you can perform the following operations zero or more times:  mul x: multiplies n by x (where x is an arbitrary positive integer).  sqrt: replaces n with \xe2\x88\x9an (to apply this operation, \xe2\x88\x9an must be an integer). You can perform these operations as many times as you like. What is the minimum value of n, that can be achieved and what is the minimum number of operations, to achieve that minimum value?Apparently, no one in the class knows the answer to this problem, maybe you can help them?" 1500
1062A "A Prank" greedy,implementation "JATC and his friend Giraffe are currently in their room, solving some problems. Giraffe has written on the board an array a1, a2, ..., an of integers, such that 1\xe2\x89\xa4a1<a2<\xe2\x80\xa6<an\xe2\x89\xa4103, and then went to the bathroom.JATC decided to prank his friend by erasing some consecutive elements in the array. Since he doesn\'t want for the prank to go too far, he will only erase in a way, such that Giraffe can still restore the array using the information from the remaining elements. Because Giraffe has created the array, he\'s also aware that it\'s an increasing array and all the elements are integers in the range [1,103].JATC wonders what is the greatest number of elements he can erase?" 1300
1061F "Lost Root" interactive,probabilities "The graph is called tree if it is connected and has no cycles. Suppose the tree is rooted at some vertex. Then tree is called to be perfect k-ary tree if each vertex is either a leaf (has no children) or has exactly k children. Also, in perfect k-ary tree all leafs must have same depth.For example, the picture below illustrates perfect binary tree with 15 vertices:There is a perfect k-ary tree with n nodes. The nodes are labeled with distinct integers from 1 to n, however you don\'t know how nodes are labelled. Still, you want to find the label of the root of the tree.You are allowed to make at most 60\xe2\x8b\x85n queries of the following type:  ""? a b c"", the query returns ""Yes"" if node with label b lies on the path from a to c and ""No"" otherwise. Both a and c are considered to be lying on the path from a to c.When you are ready to report the root of the tree, print   ""! s"", where s is the label of the root of the tree. It is possible to report the root only once and this query is not counted towards limit of 60\xe2\x8b\x85n queries." 2400
1061E Politics flows,graphs "There are n cities in the country. Two candidates are fighting for the post of the President. The elections are set in the future, and both candidates have already planned how they are going to connect the cities with roads. Both plans will connect all cities using n\xe2\x88\x921 roads only. That is, each plan can be viewed as a tree. Both of the candidates had also specified their choice of the capital among n cities (x for the first candidate and y for the second candidate), which may or may not be same.Each city has a potential of building a port (one city can have at most one port). Building a port in i-th city brings ai amount of money. However, each candidate has his specific demands. The demands are of the form:   k x, which means that the candidate wants to build exactly x ports in the subtree of the k-th city of his tree (the tree is rooted at the capital of his choice). Find out the maximum revenue that can be gained while fulfilling all demands of both candidates, or print -1 if it is not possible to do.It is additionally guaranteed, that each candidate has specified the port demands for the capital of his choice." 2600
1061D "TV Shows" "data structures,greedy,implementation,sortings" "There are n TV shows you want to watch. Suppose the whole time is split into equal parts called ""minutes"". The i-th of the shows is going from li-th to ri-th minute, both ends inclusive.You need a TV to watch a TV show and you can\'t watch two TV shows which air at the same time on the same TV, so it is possible you will need multiple TVs in some minutes. For example, if segments [li,ri] and [lj,rj] intersect, then shows i and j can\'t be watched simultaneously on one TV.Once you start watching a show on some TV it is not possible to ""move"" it to another TV (since it would be too distracting), or to watch another show on the same TV until this show ends.There is a TV Rental shop near you. It rents a TV for x rupees, and charges y (y<x) rupees for every extra minute you keep the TV. So in order to rent a TV for minutes [a;b] you will need to pay x+y\xe2\x8b\x85(b\xe2\x88\x92a). You can assume, that taking and returning of the TV doesn\'t take any time and doesn\'t distract from watching other TV shows. Find the minimum possible cost to view all shows. Since this value could be too large, print it modulo 109+7." 2000
1061C Multiplicity "data structures,dp,implementation,math,number theory" "You are given an integer array a1,a2,\xe2\x80\xa6,an.The array b is called to be a subsequence of a if it is possible to remove some elements from a to get b.Array b1,b2,\xe2\x80\xa6,bk is called to be good if it is not empty and for every i (1\xe2\x89\xa4i\xe2\x89\xa4k) bi is divisible by i.Find the number of good subsequences in a modulo 109+7. Two subsequences are considered different if index sets of numbers included in them are different. That is, the values \xe2\x80\x8bof the elements \xe2\x80\x8bdo not matter in the comparison of subsequences. In particular, the array a has exactly 2n\xe2\x88\x921 different subsequences (excluding an empty subsequence)." 1700
1061B "Views Matter" greedy,implementation,sortings "You came to the exhibition and one exhibit has drawn your attention. It consists of n stacks of blocks, where the i-th stack consists of ai blocks resting on the surface.The height of the exhibit is equal to m. Consequently, the number of blocks in each stack is less than or equal to m.There is a camera on the ceiling that sees the top view of the blocks and a camera on the right wall that sees the side view of the blocks. Find the maximum number of blocks you can remove such that the views for both the cameras would not change.Note, that while originally all blocks are stacked on the floor, it is not required for them to stay connected to the floor after some blocks are removed. There is no gravity in the whole exhibition, so no block would fall down, even if the block underneath is removed. It is not allowed to move blocks by hand either." 1400
1061A Coins greedy,implementation,math "You have unlimited number of coins with values 1,2,\xe2\x80\xa6,n. You want to select some set of coins having the total value of S. It is allowed to have multiple coins with the same value in the set. What is the minimum number of coins required to get sum S?" 800
1060H "Sophisticated Device" "constructive algorithms" "You are given integers d and p, p is prime. Also you have a mysterious device. It has memory cells, each contains an integer between 0 and p\xe2\x88\x921. Also two instructions are supported, addition and raising to the d-th power. Both are modulo p.The memory cells are numbered 1,2,\xe2\x80\xa6,5000. Initially cells 1 and 2 contain integers x and y, respectively (0\xe2\xa9\xbdx,y\xe2\x89\xa4p\xe2\x88\x921). All other cells contain 1s. You can not directly access values in cells, and you don\'t know values of x and y (but you know they are written in first two cells). You mission, should you choose to accept it, is to write a program using the available instructions to obtain the product xy modulo p in one of the cells. You program should work for all possible x and y.Addition instruction evaluates sum of values in two cells and writes it to third cell. This instruction is encoded by a string ""+ e1 e2 to"", which writes sum of values in cells e1 and e2 into cell to. Any values of e1, e2, to can coincide. Second instruction writes the d-th power of a value in some cell to the target cell. This instruction is encoded by a string ""^ e to"". Values e and to can coincide, in this case value in the cell will be overwritten. Last instruction is special, this is the return instruction, and it is encoded by a string ""f target"". This means you obtained values xymodp in the cell target. No instructions should be called after this instruction.Provide a program that obtains xymodp and uses no more than 5000 instructions (including the return instruction).It is guaranteed that, under given constrains, a solution exists." 3300
1060G "Balls and Pockets" "data structures" "There is a strip with an infinite number of cells. Cells are numbered starting with 0. Initially the cell i contains a ball with the number i.There are n pockets located at cells a1,\xe2\x80\xa6,an. Each cell contains at most one pocket.Filtering is the following sequence of operations: All pockets at cells a1,\xe2\x80\xa6,an open simultaneously, which makes balls currently located at those cells disappear. After the balls disappear, the pockets close again. For each cell i from 0 to \xe2\x88\x9e, if the cell i contains a ball, we move that ball to the free cell j with the lowest number. If there is no free cell j<i, the ball stays at the cell i.Note that after each filtering operation each cell will still contain exactly one ball.For example, let the cells 1, 3 and 4 contain pockets. The initial configuration of balls is shown below (underscores display the cells with pockets): 0 1 2 3 4 5 6 7 8 9 ... After opening and closing the pockets, balls 1, 3 and 4 disappear: 0   2     5 6 7 8 9 ... After moving all the balls to the left, the configuration looks like this: 0 2 5 6 7 8 9 10 11 12 ... Another filtering repetition results in the following: 0 5 8 9 10 11 12 13 14 15 ... You have to answer m questions. The i-th of these questions is ""what is the number of the ball located at the cell xi after ki repetitions of the filtering operation?""" 3400
1060F "Shrinking Tree" combinatorics,dp "Consider a tree T (that is, a connected graph without cycles) with n vertices labelled 1 through n. We start the following process with T: while T has more than one vertex, do the following: choose a random edge of T equiprobably; shrink the chosen edge: if the edge was connecting vertices v and u, erase both v and u and create a new vertex adjacent to all vertices previously adjacent to either v or u. The new vertex is labelled either v or u equiprobably.At the end of the process, T consists of a single vertex labelled with one of the numbers 1,\xe2\x80\xa6,n. For each of the numbers, what is the probability of this number becoming the label of the final vertex?" 2900
1060E "Sergey and Subway" "dfs and similar,dp,trees" "Sergey Semyonovich is a mayor of a county city N and he used to spend his days and nights in thoughts of further improvements of Nkers\' lives. Unfortunately for him, anything and everything has been done already, and there are no more possible improvements he can think of during the day (he now prefers to sleep at night). However, his assistants have found a solution and they now draw an imaginary city on a paper sheet and suggest the mayor can propose its improvements.Right now he has a map of some imaginary city with n subway stations. Some stations are directly connected with tunnels in such a way that the whole map is a tree (assistants were short on time and enthusiasm). It means that there exists exactly one simple path between each pair of station. We call a path simple if it uses each tunnel no more than once.One of Sergey Semyonovich\'s favorite quality objectives is the sum of all pairwise distances between every pair of stations. The distance between two stations is the minimum possible number of tunnels on a path between them.Sergey Semyonovich decided to add new tunnels to the subway map. In particular, he connected any two stations u and v that were not connected with a direct tunnel but share a common neighbor, i.e. there exists such a station w that the original map has a tunnel between u and w and a tunnel between w and v. You are given a task to compute the sum of pairwise distances between all pairs of stations in the new map." 2000
1060D "Social Circles" greedy,math "You invited n guests to dinner! You plan to arrange one or more circles of chairs. Each chair is going to be either occupied by one guest, or be empty. You can make any number of circles. Your guests happen to be a little bit shy, so the i-th guest wants to have a least li free chairs to the left of his chair, and at least ri free chairs to the right. The ""left"" and ""right"" directions are chosen assuming all guests are going to be seated towards the center of the circle. Note that when a guest is the only one in his circle, the li chairs to his left and ri chairs to his right may overlap.What is smallest total number of chairs you have to use?" 1900
1060C "Maximum Subrectangle" "binary search,implementation,two pointers" "You are given two arrays a and b of positive integers, with length n and m respectively. Let c be an n\xc3\x97m matrix, where ci,j=ai\xe2\x8b\x85bj. You need to find a subrectangle of the matrix c such that the sum of its elements is at most x, and its area (the total number of elements) is the largest possible.Formally, you need to find the largest number s such that it is possible to choose integers x1,x2,y1,y2 subject to 1\xe2\x89\xa4x1\xe2\x89\xa4x2\xe2\x89\xa4n, 1\xe2\x89\xa4y1\xe2\x89\xa4y2\xe2\x89\xa4m, (x2\xe2\x88\x92x1+1)\xc3\x97(y2\xe2\x88\x92y1+1)=s, and x2\xe2\x88\x91i=x1y2\xe2\x88\x91j=y1ci,j\xe2\x89\xa4x." 1600
1060B "Maximum Sum of Digits" greedy "You are given a positive integer n.Let S(x) be sum of digits in base 10 representation of x, for example, S(123)=1+2+3=6, S(0)=0.Your task is to find two integers a,b, such that 0\xe2\x89\xa4a,b\xe2\x89\xa4n, a+b=n and S(a)+S(b) is the largest possible among all such pairs." 1100
1060A "Phone Numbers" "brute force" "Let\'s call a string a phone number if it has length 11 and fits the pattern ""8xxxxxxxxxx"", where each ""x"" is replaced by a digit.For example, ""80123456789"" and ""80000000000"" are phone numbers, while ""8012345678"" and ""79000000000"" are not.You have n cards with digits, and you want to use them to make as many phone numbers as possible. Each card must be used in at most one phone number, and you don\'t have to use all cards. The phone numbers do not necessarily have to be distinct." 800
1059E "Split the Tree" "binary search,data structures,dp,greedy,trees" "You are given a rooted tree on n vertices, its root is the vertex number 1. The i-th vertex contains a number wi. Split it into the minimum possible number of vertical paths in such a way that each path contains no more than L vertices and the sum of integers wi on each path does not exceed S. Each vertex should belong to exactly one path.A vertical path is a sequence of vertices v1,v2,\xe2\x80\xa6,vk where vi (i\xe2\x89\xa52) is the parent of vi\xe2\x88\x921." 2400
1059D "Nature Reserve" "binary search,geometry,ternary search" "There is a forest that we model as a plane and live n rare animals. Animal number i has its lair in the point (xi,yi). In order to protect them, a decision to build a nature reserve has been made.The reserve must have a form of a circle containing all lairs. There is also a straight river flowing through the forest. All animals drink from this river, therefore it must have at least one common point with the reserve. On the other hand, ships constantly sail along the river, so the reserve must not have more than one common point with the river.For convenience, scientists have made a transformation of coordinates so that the river is defined by y=0. Check whether it is possible to build a reserve, and if possible, find the minimum possible radius of such a reserve." 2200
1059C "Sequence Transformation" "constructive algorithms,math" "Let\'s call the following process a transformation of a sequence of length n.If the sequence is empty, the process ends. Otherwise, append the greatest common divisor (GCD) of all the elements of the sequence to the result and remove one arbitrary element from the sequence. Thus, when the process ends, we have a sequence of n integers: the greatest common divisors of all the elements in the sequence before each deletion.You are given an integer sequence 1,2,\xe2\x80\xa6,n. Find the lexicographically maximum result of its transformation.A sequence a1,a2,\xe2\x80\xa6,an is lexicographically larger than a sequence b1,b2,\xe2\x80\xa6,bn, if there is an index i such that aj=bj for all j<i, and ai>bi." 1600
1059B Forgery implementation "Student Andrey has been skipping physical education lessons for the whole term, and now he must somehow get a passing grade on this subject. Obviously, it is impossible to do this by legal means, but Andrey doesn\'t give up. Having obtained an empty certificate from a local hospital, he is going to use his knowledge of local doctor\'s handwriting to make a counterfeit certificate of illness. However, after writing most of the certificate, Andrey suddenly discovered that doctor\'s signature is impossible to forge. Or is it?For simplicity, the signature is represented as an n\xc3\x97m grid, where every cell is either filled with ink or empty. Andrey\'s pen can fill a 3\xc3\x973 square without its central cell if it is completely contained inside the grid, as shown below. xxxx.xxxx Determine whether is it possible to forge the signature on an empty n\xc3\x97m grid." 1300
1059A Cashier implementation "Vasya has recently got a job as a cashier at a local store. His day at work is L minutes long. Vasya has already memorized n regular customers, the i-th of which comes after ti minutes after the beginning of the day, and his service consumes li minutes. It is guaranteed that no customer will arrive while Vasya is servicing another customer. Vasya is a bit lazy, so he likes taking smoke breaks for a minutes each. Those breaks may go one after another, but Vasya must be present at work during all the time periods he must serve regular customers, otherwise one of them may alert his boss. What is the maximum number of breaks Vasya can take during the day?" 1000
1057C "Tanya and Colored Candies" "*special problem,dp" "There are n candy boxes in front of Tania. The boxes are arranged in a row from left to right, numbered from 1 to n. The i-th box contains ri candies, candies have the color ci (the color can take one of three values \xe2\x80\x8b\xe2\x80\x8b\xe2\x80\x94 red, green, or blue). All candies inside a single box have the same color (and it is equal to ci).Initially, Tanya is next to the box number s. Tanya can move to the neighbor box (that is, with a number that differs by one) or eat candies in the current box. Tanya eats candies instantly, but the movement takes one second.If Tanya eats candies from the box, then the box itself remains in place, but there is no more candies in it. In other words, Tanya always eats all the candies from the box and candies in the boxes are not refilled.It is known that Tanya cannot eat candies of the same color one after another (that is, the colors of candies in two consecutive boxes from which she eats candies are always different). In addition, Tanya\'s appetite is constantly growing, so in each next box from which she eats candies, there should be strictly more candies than in the previous one.Note that for the first box from which Tanya will eat candies, there are no restrictions on the color and number of candies.Tanya wants to eat at least k candies. What is the minimum number of seconds she will need? Remember that she eats candies instantly, and time is spent only on movements." 2000
1057B DDoS "*special problem,brute force" "We get more and more news about DDoS-attacks of popular websites.Arseny is an admin and he thinks that a website is under a DDoS-attack if the total number of requests for a some period of time exceeds 100\xe2\x8b\x85t, where t \xe2\x80\x94 the number of seconds in this time segment. Arseny knows statistics on the number of requests per second since the server is booted. He knows the sequence r1,r2,\xe2\x80\xa6,rn, where ri \xe2\x80\x94 the number of requests in the i-th second after boot. Determine the length of the longest continuous period of time, which Arseny considers to be a DDoS-attack. A seeking time period should not go beyond the boundaries of the segment [1,n]." 1400
1057A "Bmail Computer Network" "*special problem,dfs and similar,trees" "Once upon a time there was only one router in the well-known company Bmail. Years went by and over time new routers were purchased. Every time they bought a new router, they connected it to one of the routers bought before it. You are given the values pi \xe2\x80\x94 the index of the router to which the i-th router was connected after being purchased (pi<i).There are n routers in Boogle in total now. Print the sequence of routers on the path from the first to the n-th router." 900
1056H "Detect Robots" "data structures,strings" "You successfully found poor Arkady near the exit of the station you\'ve perfectly predicted. You sent him home on a taxi and suddenly came up with a question.There are n crossroads in your city and several bidirectional roads connecting some of them. A taxi ride is a path from some crossroads to another one without passing the same crossroads twice. You have a collection of rides made by one driver and now you wonder if this driver can be a robot or they are definitely a human.You think that the driver can be a robot if for every two crossroads a and b the driver always chooses the same path whenever he drives from a to b. Note that a and b here do not have to be the endpoints of a ride and that the path from b to a can be different. On the contrary, if the driver ever has driven two different paths from a to b, they are definitely a human.Given the system of roads and the description of all rides available to you, determine if the driver can be a robot or not." 3200
1056G "Take Metro" "brute force,data structures,graphs" "Having problems with tram routes in the morning, Arkady decided to return home by metro. Fortunately for Arkady, there is only one metro line in the city.Unfortunately for Arkady, the line is circular. It means that the stations are enumerated from 1 to n and there is a tunnel between any pair of consecutive stations as well as between the station 1 and the station n. Trains that go in clockwise direction visit the stations in order 1\xe2\x86\x922\xe2\x86\x923\xe2\x86\x92\xe2\x80\xa6\xe2\x86\x92n\xe2\x86\x921 while the trains that go in the counter-clockwise direction visit the stations in the reverse order.The stations that have numbers from 1 to m have interior mostly in red colors while the stations that have numbers from m+1 to n have blue interior. Arkady entered the metro at station s and decided to use the following algorithm to choose his way home.  Initially he has a positive integer t in his mind.  If the current station has red interior, he takes a clockwise-directed train, otherwise he takes a counter-clockwise-directed train.  He rides exactly t stations on the train and leaves the train.  He decreases t by one. If t is still positive, he returns to step 2. Otherwise he exits the metro. You have already realized that this algorithm most probably won\'t bring Arkady home. Find the station he will exit the metro at so that you can continue helping him." 2900
1056F "Write The Contest" "binary search,dp,math" "Polycarp, Arkady\'s friend, prepares to the programming competition and decides to write a contest. The contest consists of n problems and lasts for T minutes. Each of the problems is defined by two positive integers ai and pi \xe2\x80\x94 its difficulty and the score awarded by its solution.Polycarp\'s experience suggests that his skill level is defined with positive real value s, and initially s=1.0. To solve the i-th problem Polycarp needs ai/s minutes.Polycarp loves to watch series, and before solving each of the problems he will definitely watch one episode. After Polycarp watches an episode, his skill decreases by 10%, that is skill level s decreases to 0.9s. Each episode takes exactly 10 minutes to watch. When Polycarp decides to solve some problem, he firstly has to watch one episode, and only then he starts solving the problem without breaks for ai/s minutes, where s is his current skill level. In calculation of ai/s no rounding is performed, only division of integer value ai by real value s happens.Also, Polycarp can train for some time. If he trains for t minutes, he increases his skill by C\xe2\x8b\x85t, where C is some given positive real constant. Polycarp can train only before solving any problem (and before watching series). Duration of the training can be arbitrary real value.Polycarp is interested: what is the largest score he can get in the contest? It is allowed to solve problems in any order, while training is only allowed before solving the first problem." 2500
1056E "Check Transcription" "brute force,data structures,hashing,strings" "One of Arkady\'s friends works at a huge radio telescope. A few decades ago the telescope has sent a signal s towards a faraway galaxy. Recently they\'ve received a response t which they believe to be a response from aliens! The scientists now want to check if the signal t is similar to s.The original signal s was a sequence of zeros and ones (everyone knows that binary code is the universe-wide language). The returned signal t, however, does not look as easy as s, but the scientists don\'t give up! They represented t as a sequence of English letters and say that t is similar to s if you can replace all zeros in s with some string r0 and all ones in s with some other string r1 and obtain t. The strings r0 and r1 must be different and non-empty.Please help Arkady\'s friend and find the number of possible replacements for zeros and ones (the number of pairs of strings r0 and r1) that transform s to t." 2100
1056D "Decorate Apple Tree" "constructive algorithms,dfs and similar,dp,graphs,greedy,sortings,trees" "There is one apple tree in Arkady\'s garden. It can be represented as a set of junctions connected with branches so that there is only one way to reach any junctions from any other one using branches. The junctions are enumerated from 1 to n, the junction 1 is called the root.A subtree of a junction v is a set of junctions u such that the path from u to the root must pass through v. Note that v itself is included in a subtree of v.A leaf is such a junction that its subtree contains exactly one junction.The New Year is coming, so Arkady wants to decorate the tree. He will put a light bulb of some color on each leaf junction and then count the number happy junctions. A happy junction is such a junction t that all light bulbs in the subtree of t have different colors.Arkady is interested in the following question: for each k from 1 to n, what is the minimum number of different colors needed to make the number of happy junctions be greater than or equal to k?" 1600
1056C "Pick Heroes" greedy,implementation,interactive,sortings "Don\'t you tell me what you think that I can beIf you say that Arkady is a bit old-fashioned playing checkers, you won\'t be right. There is also a modern computer game Arkady and his friends are keen on. We won\'t discuss its rules, the only feature important to this problem is that each player has to pick a distinct hero in the beginning of the game.There are 2 teams each having n players and 2n heroes to distribute between the teams. The teams take turns picking heroes: at first, the first team chooses a hero in its team, after that the second team chooses a hero and so on. Note that after a hero is chosen it becomes unavailable to both teams.The friends estimate the power of the i-th of the heroes as pi. Each team wants to maximize the total power of its heroes. However, there is one exception: there are m pairs of heroes that are especially strong against each other, so when any team chooses a hero from such a pair, the other team must choose the other one on its turn. Each hero is in at most one such pair.This is an interactive problem. You are to write a program that will optimally choose the heroes for one team, while the jury\'s program will play for the other team. Note that the jury\'s program may behave inefficiently, in this case you have to take the opportunity and still maximize the total power of your team. Formally, if you ever have chance to reach the total power of q or greater regardless of jury\'s program choices, you must get q or greater to pass a test." 1700
1056B "Divide Candies" "math,number theory" "Arkady and his friends love playing checkers on an n\xc3\x97n field. The rows and the columns of the field are enumerated from 1 to n.The friends have recently won a championship, so Arkady wants to please them with some candies. Remembering an old parable (but not its moral), Arkady wants to give to his friends one set of candies per each cell of the field: the set of candies for cell (i,j) will have exactly (i2+j2) candies of unique type.There are m friends who deserve the present. How many of these n\xc3\x97n sets of candies can be split equally into m parts without cutting a candy into pieces? Note that each set has to be split independently since the types of candies in different sets are different." 1600
1056A "Determine Line" implementation "Arkady\'s morning seemed to be straight of his nightmare. He overslept through the whole morning and, still half-asleep, got into the tram that arrived the first. Some time after, leaving the tram, he realized that he was not sure about the line number of the tram he was in.During his ride, Arkady woke up several times and each time he saw the tram stopping at some stop. For each stop he knows which lines of tram stop there. Given this information, can you help Arkady determine what are the possible lines of the tram he was in?" 800
1055G "Jellyfish Nightmare" NA "Bob has put on some weight recently. In order to lose weight a bit, Bob has decided to swim regularly in the pool. However, the day before he went to the pool for the first time he had a weird dream. In this dream Bob was swimming along one of the pool\'s lanes, but also there were some jellyfish swimming around him. It\'s worth mentioning that jellyfish have always been one of Bob\'s deepest childhood fears.Let us assume the following physical model for Bob\'s dream.  The pool\'s lane is an area of the plane between lines x=0 and x=w. Bob is not allowed to swim outside of the lane, but he may touch its bounding lines if he wants.  The jellyfish are very small, but in Bob\'s dream they are extremely swift. Each jellyfish has its area of activity around it. Those areas are circles of various radii, with the jellyfish sitting in their centers. The areas of activity of two jellyfish may overlap and one area of activity may even be fully contained within another one.  Bob has a shape of a convex polygon.  Unfortunately, Bob\'s excess weight has made him very clumsy, and as a result he can\'t rotate his body while swimming. So he swims in a parallel translation pattern. However at any given moment of time he can choose any direction of his movement.  Whenever Bob swims into a jellyfish\'s activity area, it will immediately notice him and sting him very painfully. We assume that Bob has swum into the activity area if at some moment of time the intersection of his body with the jellyfish\'s activity area had a positive area (for example, if they only touch, the jellyfish does not notice Bob).  Once a jellyfish stung Bob, it happily swims away and no longer poses any threat to Bob. Bob wants to swim the lane to its end and get stung the least possible number of times. He will start swimming on the line y=\xe2\x88\x92h, and finish on the line y=h where h=1010." 3500
1055F "Tree and XOR" strings,trees "You are given a connected undirected graph without cycles (that is, a tree) of n vertices, moreover, there is a non-negative integer written on every edge.Consider all pairs of vertices (v,u) (that is, there are exactly n2 such pairs) and for each pair calculate the bitwise exclusive or (xor) of all integers on edges of the simple path between v and u. If the path consists of one vertex only, then xor of all integers on edges of this path is equal to 0.Suppose we sorted the resulting n2 values in non-decreasing order. You need to find the k-th of them.The definition of xor is as follows.Given two integers x and y, consider their binary representations (possibly with leading zeros): xk\xe2\x80\xa6x2x1x0 and yk\xe2\x80\xa6y2y1y0 (where k is any number so that all bits of x and y can be represented). Here, xi is the i-th bit of the number x and yi is the i-th bit of the number y. Let r=x\xe2\x8a\x95y be the result of the xor operation of x and y. Then r is defined as rk\xe2\x80\xa6r2r1r0 where:ri={1, if xi\xe2\x89\xa0yi0, if xi=yi" 2900
1055E "Segments on the Line" "binary search,dp" "You are a given a list of integers a1,a2,\xe2\x80\xa6,an and s of its segments [lj;rj] (where 1\xe2\x89\xa4lj\xe2\x89\xa4rj\xe2\x89\xa4n).You need to select exactly m segments in such a way that the k-th order statistic of the multiset of ai, where i is contained in at least one segment, is the smallest possible. If it\'s impossible to select a set of m segments in such a way that the multiset contains at least k elements, print -1.The k-th order statistic of a multiset is the value of the k-th element after sorting the multiset in non-descending order." 2500
1055D Refactoring greedy,implementation,strings "Alice has written a program and now tries to improve its readability. One of the ways to improve readability is to give sensible names to the variables, so now Alice wants to rename some variables in her program. In her IDE there is a command called ""massive refactoring"", which can replace names of many variable in just one run. To use it, Alice needs to select two strings s and t and after that for each variable the following algorithm is performed: if the variable\'s name contains s as a substring, then the first (and only first) occurrence of s is replaced with t. If the name doesn\'t contain s, then this variable\'s name stays the same.The list of variables is known and for each variable both the initial name and the name Alice wants this variable change to are known. Moreover, for each variable the lengths of the initial name and the target name are equal (otherwise the alignment of the code could become broken). You need to perform renaming of all variables in exactly one run of the massive refactoring command or determine that it is impossible." 2400
1055C "Lucky Days" "math,number theory" "Bob and Alice are often participating in various programming competitions. Like many competitive programmers, Alice and Bob have good and bad days. They noticed, that their lucky and unlucky days are repeating with some period. For example, for Alice days [la;ra] are lucky, then there are some unlucky days: [ra+1;la+ta\xe2\x88\x921], and then there are lucky days again: [la+ta;ra+ta] and so on. In other words, the day is lucky for Alice if it lies in the segment [la+kta;ra+kta] for some non-negative integer k.The Bob\'s lucky day have similar structure, however the parameters of his sequence are different: lb, rb, tb. So a day is a lucky for Bob if it lies in a segment [lb+ktb;rb+ktb], for some non-negative integer k.Alice and Bob want to participate in team competitions together and so they want to find out what is the largest possible number of consecutive days, which are lucky for both Alice and Bob." 1900
1055B "Alice and Hairdresser" dsu,implementation "Alice\'s hair is growing by leaps and bounds. Maybe the cause of it is the excess of vitamins, or maybe it is some black magic...To prevent this, Alice decided to go to the hairdresser. She wants for her hair length to be at most l centimeters after haircut, where l is her favorite number. Suppose, that the Alice\'s head is a straight line on which n hairlines grow. Let\'s number them from 1 to n. With one swing of the scissors the hairdresser can shorten all hairlines on any segment to the length l, given that all hairlines on that segment had length strictly greater than l. The hairdresser wants to complete his job as fast as possible, so he will make the least possible number of swings of scissors, since each swing of scissors takes one second.Alice hasn\'t decided yet when she would go to the hairdresser, so she asked you to calculate how much time the haircut would take depending on the time she would go to the hairdresser. In particular, you need to process queries of two types:  0 \xe2\x80\x94 Alice asks how much time the haircut would take if she would go to the hairdresser now.  1 p d \xe2\x80\x94 p-th hairline grows by d centimeters. Note, that in the request 0 Alice is interested in hypothetical scenario of taking a haircut now, so no hairlines change their length." 1300
1055A Metro graphs "Alice has a birthday today, so she invited home her best friend Bob. Now Bob needs to find a way to commute to the Alice\'s home.In the city in which Alice and Bob live, the first metro line is being built. This metro line contains n stations numbered from 1 to n. Bob lives near the station with number 1, while Alice lives near the station with number s. The metro line has two tracks. Trains on the first track go from the station 1 to the station n and trains on the second track go in reverse direction. Just after the train arrives to the end of its track, it goes to the depot immediately, so it is impossible to travel on it after that.Some stations are not yet open at all and some are only partially open \xe2\x80\x94 for each station and for each track it is known whether the station is closed for that track or not. If a station is closed for some track, all trains going in this track\'s direction pass the station without stopping on it.When the Bob got the information on opened and closed stations, he found that traveling by metro may be unexpectedly complicated. Help Bob determine whether he can travel to the Alice\'s home by metro or he should search for some other transport." 900
1054H "Epic Convolution" "chinese remainder theorem,fft,math,number theory" "You are given two arrays a0,a1,\xe2\x80\xa6,an\xe2\x88\x921 and b0,b1,\xe2\x80\xa6,bm\xe2\x88\x921, and an integer c.Compute the following sum:n\xe2\x88\x921\xe2\x88\x91i=0m\xe2\x88\x921\xe2\x88\x91j=0aibjci2j3Since it\'s value can be really large, print it modulo 490019." 3500
1054G "New Road Network" "constructive algorithms,greedy,math" "The king of some country N decided to completely rebuild the road network. There are n people living in the country, they are enumerated from 1 to n. It is possible to construct a road between the house of any citizen a to the house of any other citizen b. There should not be more than one road between any pair of citizens. The road network must be connected, i.e. it should be possible to reach every citizen starting from anyone using roads. To save funds, it was decided to build exactly n\xe2\x88\x921 road, so the road network should be a tree.However, it is not that easy as it sounds, that\'s why the king addressed you for help. There are m secret communities in the country, each of them unites a non-empty subset of citizens. The king does not want to conflict with any of the communities, so he wants to build the network such that the houses of members of each society form a connected subtree in network. A set of vertices forms a connected subtree if and only if the graph remains connected when we delete all the other vertices and all edges but ones that connect the vertices from the set.Help the king to determine if it is possible to build the desired road network, and if it is, build it." 3300
1054F "Electric Scheme" "flows,graph matchings" "Pasha is a young technician, nevertheless, he has already got a huge goal: to assemble a PC. The first task he has to become familiar with is to assemble an electric scheme.The scheme Pasha assembled yesterday consists of several wires. Each wire is a segment that connects two points on a plane with integer coordinates within the segment [1,109].There are wires of two colors in the scheme:   red wires: these wires are horizontal segments, i.e. if such a wire connects two points (x1,y1) and (x2,y2), then y1=y2;  blue wires: these wires are vertical segments, i.e. if such a wire connects two points (x1,y1) and (x2,y2), then x1=x2. Note that if a wire connects a point to itself, it may be blue, and it can be red. Also, in Pasha\'s scheme no two wires of the same color intersect, i.e. there are no two wires of same color that have common points.The imperfection of Pasha\'s scheme was that the wires were not isolated, so in the points where two wires of different colors intersect, Pasha saw sparks. Pasha wrote down all the points where he saw sparks and obtained a set of n distinct points. After that he disassembled the scheme.Next morning Pasha looked at the set of n points where he had seen sparks and wondered how many wires had he used. Unfortunately, he does not remember that, so he wonders now what is the smallest number of wires he might have used in the scheme. Help him to determine this number and place the wires in such a way that in the resulting scheme the sparks occur in the same places." 2700
1054E "Chips Puzzle" "constructive algorithms,implementation,math" "Egor came up with a new chips puzzle and suggests you to play.The puzzle has the form of a table with n rows and m columns, each cell can contain several black or white chips placed in a row. Thus, the state of the cell can be described by a string consisting of characters \'0\' (a white chip) and \'1\' (a black chip), possibly empty, and the whole puzzle can be described as a table, where each cell is a string of zeros and ones. The task is to get from one state of the puzzle some other state.To do this, you can use the following operation.  select 2 different cells (x1,y1) and (x2,y2): the cells must be in the same row or in the same column of the table, and the string in the cell (x1,y1) must be non-empty;  in one operation you can move the last character of the string at the cell (x1,y1) to the beginning of the string at the cell (x2,y2). Egor came up with two states of the table for you: the initial state and the final one. It is guaranteed that the number of zeros and ones in the tables are the same. Your goal is with several operations get the final state from the initial state. Of course, Egor does not want the number of operations to be very large. Let\'s denote as s the number of characters in each of the tables (which are the same). Then you should use no more than 4\xe2\x8b\x85s operations." 2400
1054D "Changing Array" greedy,implementation "At a break Vanya came to the class and saw an array of n k-bit integers a1,a2,\xe2\x80\xa6,an on the board. An integer x is called a k-bit integer if 0\xe2\x89\xa4x\xe2\x89\xa42k\xe2\x88\x921. Of course, Vanya was not able to resist and started changing the numbers written on the board. To ensure that no one will note anything, Vanya allowed himself to make only one type of changes: choose an index of the array i (1\xe2\x89\xa4i\xe2\x89\xa4n) and replace the number ai with the number \xc2\xafai. We define \xc2\xafx for a k-bit integer x as the k-bit integer such that all its k bits differ from the corresponding bits of x. Vanya does not like the number 0. Therefore, he likes such segments [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar\xe2\x89\xa00, where \xe2\x8a\x95 denotes the bitwise XOR operation. Determine the maximum number of segments he likes Vanya can get applying zero or more operations described above." 1900
1054C "Candies Distribution" "constructive algorithms,implementation" "There are n children numbered from 1 to n in a kindergarten. Kindergarten teacher gave ai (1\xe2\x89\xa4ai\xe2\x89\xa4n) candies to the i-th child. Children were seated in a row in order from 1 to n from left to right and started eating candies. While the i-th child was eating candies, he calculated two numbers li and ri \xe2\x80\x94 the number of children seating to the left of him that got more candies than he and the number of children seating to the right of him that got more candies than he, respectively.Formally, li is the number of indices j (1\xe2\x89\xa4j<i), such that ai<aj and ri is the number of indices j (i<j\xe2\x89\xa4n), such that ai<aj.Each child told to the kindergarten teacher the numbers li and ri that he calculated. Unfortunately, she forgot how many candies she has given to each child. So, she asks you for help: given the arrays l and r determine whether she could have given the candies to the children such that all children correctly calculated their values li and ri, or some of them have definitely made a mistake. If it was possible, find any way how she could have done it." 1500
1054B "Appending Mex" implementation "Initially Ildar has an empty array. He performs n steps. On each step he takes a subset of integers already added to the array and appends the mex of this subset to the array. The mex of an multiset of integers is the smallest non-negative integer not presented in the multiset. For example, the mex of the multiset [0,2,3] is 1, while the mex of the multiset [1,2,1] is 0.More formally, on the step m, when Ildar already has an array a1,a2,\xe2\x80\xa6,am\xe2\x88\x921, he chooses some subset of indices 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik<m (possibly, empty), where 0\xe2\x89\xa4k<m, and appends the mex(ai1,ai2,\xe2\x80\xa6aik) to the end of the array.After performing all the steps Ildar thinks that he might have made a mistake somewhere. He asks you to determine for a given array a1,a2,\xe2\x80\xa6,an the minimum step t such that he has definitely made a mistake on at least one of the steps 1,2,\xe2\x80\xa6,t, or determine that he could have obtained this array without mistakes." 1000
1054A "Elevator or Stairs?" implementation "Masha lives in a multi-storey building, where floors are numbered with positive integers. Two floors are called adjacent if their numbers differ by one. Masha decided to visit Egor. Masha lives on the floor x, Egor on the floor y (not on the same floor with Masha).The house has a staircase and an elevator. If Masha uses the stairs, it takes t1 seconds for her to walk between adjacent floors (in each direction). The elevator passes between adjacent floors (in each way) in t2 seconds. The elevator moves with doors closed. The elevator spends t3 seconds to open or close the doors. We can assume that time is not spent on any action except moving between adjacent floors and waiting for the doors to open or close. If Masha uses the elevator, it immediately goes directly to the desired floor.Coming out of the apartment on her floor, Masha noticed that the elevator is now on the floor z and has closed doors. Now she has to choose whether to use the stairs or use the elevator. If the time that Masha needs to get to the Egor\'s floor by the stairs is strictly less than the time it will take her using the elevator, then she will use the stairs, otherwise she will choose the elevator.Help Mary to understand whether to use the elevator or the stairs." 800
1053E "Euler tour" "constructive algorithms,trees" "Euler is a little, cute squirrel. When the autumn comes, he collects some reserves for winter. The interesting fact is that Euler likes to collect acorns in a specific way. A tree can be described as n acorns connected by n\xe2\x88\x921 branches, such that there is exactly one way between each pair of acorns. Let\'s enumerate the acorns from 1 to n.The squirrel chooses one acorn (not necessary with number 1) as a start, and visits them in a way called ""Euler tour"" (see notes), collecting each acorn when he visits it for the last time.Today morning Kate was observing Euler. She took a sheet of paper and wrote down consecutive indices of acorns on his path. Unfortunately, during her way to home it started raining and some of numbers became illegible. Now the girl is very sad, because she has to present the observations to her teacher.""Maybe if I guess the lacking numbers, I\'ll be able to do it!"" she thought. Help her and restore any valid Euler tour of some tree or tell that she must have made a mistake." 3500
1051G Distinctification "data structures,dsu,greedy" "Suppose you are given a sequence S of k pairs of integers (a1,b1),(a2,b2),\xe2\x80\xa6,(ak,bk).You can perform the following operations on it:  Choose some position i and increase ai by 1. That can be performed only if there exists at least one such position j that i\xe2\x89\xa0j and ai=aj. The cost of this operation is bi;  Choose some position i and decrease ai by 1. That can be performed only if there exists at least one such position j that ai=aj+1. The cost of this operation is \xe2\x88\x92bi. Each operation can be performed arbitrary number of times (possibly zero).Let f(S) be minimum possible x such that there exists a sequence of operations with total cost x, after which all ai from S are pairwise distinct. Now for the task itself ...You are given a sequence P consisting of n pairs of integers (a1,b1),(a2,b2),\xe2\x80\xa6,(an,bn). All bi are pairwise distinct. Let Pi be the sequence consisting of the first i pairs of P. Your task is to calculate the values of f(P1),f(P2),\xe2\x80\xa6,f(Pn)." 2900
1051F "The Shortest Statement" "graphs,shortest paths,trees" "You are given a weighed undirected connected graph, consisting of n vertices and m edges.You should answer q queries, the i-th query is to find the shortest distance between vertices ui and vi." 2400
1051E "Vasya and Big Integers" "binary search,data structures,dp,hashing,strings" "Vasya owns three big integers \xe2\x80\x94 a,l,r. Let\'s define a partition of x such a sequence of strings s1,s2,\xe2\x80\xa6,sk that s1+s2+\xe2\x8b\xaf+sk=x, where + is a concatanation of strings. si is the i-th element of the partition. For example, number 12345 has the following partitions: [""1"", ""2"", ""3"", ""4"", ""5""], [""123"", ""4"", ""5""], [""1"", ""2345""], [""12345""] and lots of others.Let\'s call some partition of a beautiful if each of its elements contains no leading zeros.Vasya want to know the number of beautiful partitions of number a, which has each of si satisfy the condition l\xe2\x89\xa4si\xe2\x89\xa4r. Note that the comparison is the integer comparison, not the string one.Help Vasya to count the amount of partitions of number a such that they match all the given requirements. The result can be rather big, so print it modulo 998244353." 2600
1051D Bicolorings bitmasks,dp "You are given a grid, consisting of 2 rows and n columns. Each cell of this grid should be colored either black or white.Two cells are considered neighbours if they have a common border and share the same color. Two cells A and B belong to the same component if they are neighbours, or if there is a neighbour of A that belongs to the same component with B.Let\'s call some bicoloring beautiful if it has exactly k components.Count the number of beautiful bicolorings. The number can be big enough, so print the answer modulo 998244353." 1700
1051C "Vasya and Multisets" "brute force,dp,greedy,implementation,math" "Vasya has a multiset s consisting of n integer numbers. Vasya calls some number x nice if it appears in the multiset exactly once. For example, multiset {1,1,2,3,3,3,4} contains nice numbers 2 and 4.Vasya wants to split multiset s into two multisets a and b (one of which may be empty) in such a way that the quantity of nice numbers in multiset a would be the same as the quantity of nice numbers in multiset b (the quantity of numbers to appear exactly once in multiset a and the quantity of numbers to appear exactly once in multiset b)." 1500
1051B "Relatively Prime Pairs" "greedy,math,number theory" "You are given a set of all integers from l to r inclusive, l<r, (r\xe2\x88\x92l+1)\xe2\x89\xa43\xe2\x8b\x85105 and (r\xe2\x88\x92l) is always odd.You want to split these numbers into exactly r\xe2\x88\x92l+12 pairs in such a way that for each pair (i,j) the greatest common divisor of i and j is equal to 1. Each number should appear in exactly one of the pairs.Print the resulting pairs or output that no solution exists. If there are multiple solutions, print any of them." 1000
1051A "Vasya And Password" greedy,implementation,strings "Vasya came up with a password to register for EatForces \xe2\x80\x94 a string s. The password in EatForces should be a string, consisting of lowercase and uppercase Latin letters and digits.But since EatForces takes care of the security of its users, user passwords must contain at least one digit, at least one uppercase Latin letter and at least one lowercase Latin letter. For example, the passwords ""abaCABA12"", ""Z7q"" and ""3R24m"" are valid, and the passwords ""qwerty"", ""qwerty12345"" and ""Password"" are not. A substring of string s is a string x=slsl+1\xe2\x80\xa6sl+len\xe2\x88\x921(1\xe2\x89\xa4l\xe2\x89\xa4|s|,0\xe2\x89\xa4len\xe2\x89\xa4|s|\xe2\x88\x92l+1). len is the length of the substring. Note that the empty string is also considered a substring of s, it has the length 0.Vasya\'s password, however, may come too weak for the security settings of EatForces. He likes his password, so he wants to replace some its substring with another string of the same length in order to satisfy the above conditions. This operation should be performed exactly once, and the chosen string should have the minimal possible length.Note that the length of s should not change after the replacement of the substring, and the string itself should contain only lowercase and uppercase Latin letters and digits." 1200
1047B "Cover Points" geometry,math "There are n points on the plane, (x1,y1),(x2,y2),\xe2\x80\xa6,(xn,yn).You need to place an isosceles triangle with two sides on the coordinate axis to cover all points (a point is covered if it lies inside the triangle or on the side of the triangle). Calculate the minimum length of the shorter side of the triangle." 900
1047A "Little C Loves 3 I" math "Little C loves number \xc2\xab3\xc2\xbb very much. He loves all things about it.Now he has a positive integer n. He wants to split n into 3 positive integers a,b,c, such that a+b+c=n and none of the 3 integers is a multiple of 3. Help him to find a solution." 800
1046I "Say Hello" geometry "Two friends are travelling through Bubble galaxy. They say ""Hello!"" via signals to each other if their distance is smaller or equal than d1 and   it\'s the first time they speak to each other or   at some point in time after their last talk their distance was greater than d2. We need to calculate how many times friends said ""Hello!"" to each other. For N moments, you\'ll have an array of points for each friend representing their positions at that moment. A person can stay in the same position between two moments in time, but if a person made a move we assume this movement as movement with constant speed in constant direction." 2300
1046F "Splitting money" implementation "After finding and moving to the new planet that supports human life, discussions started on which currency should be used. After long negotiations, Bitcoin was ultimately chosen as the universal currency.These were the great news for Alice, whose grandfather got into Bitcoin mining in 2013, and accumulated a lot of them throughout the years. Unfortunately, when paying something in bitcoin everyone can see how many bitcoins you have in your public address wallet. This worried Alice, so she decided to split her bitcoins among multiple different addresses, so that every address has at most x satoshi (1 bitcoin = 108 satoshi). She can create new public address wallets for free and is willing to pay f fee in satoshi per transaction to ensure acceptable speed of transfer. The fee is deducted from the address the transaction was sent from. Tell Alice how much total fee in satoshi she will need to pay to achieve her goal." 1400
1046C "Space Formula" greedy "Formula 1 officials decided to introduce new competition. Cars are replaced by space ships and number of points awarded can differ per race.Given the current ranking in the competition and points distribution for the next race, your task is to calculate the best possible ranking for a given astronaut after the next race. It\'s guaranteed that given astronaut will have unique number of points before the race." 1400
1045J "Moonwalk challenge" "data structures,strings,trees" "Since astronauts from BubbleCup XI mission finished their mission on the Moon and are big fans of famous singer, they decided to spend some fun time before returning to the Earth and hence created a so called ""Moonwalk challenge"" game.Teams of astronauts are given the map of craters on the Moon and direct bidirectional paths from some craters to others that are safe for ""Moonwalking"". Each of those direct paths is colored in one color and there is unique path between each two craters. Goal of the game is to find two craters such that given array of colors appears most times as continuous subarray on the path between those two craters (overlapping appearances should be counted).To help your favorite team win, you should make a program that, given the map, answers the queries of the following type: For two craters and array of colors answer how many times given array appears as continuous subarray on the path from the first crater to the second.Colors are represented as lowercase English alphabet letters." 2600
1045I "Palindrome Pairs" hashing,strings "After learning a lot about space exploration, a little girl named Ana wants to change the subject.Ana is a girl who loves palindromes (string that can be read the same backwards as forward). She has learned how to check for a given string whether it\'s a palindrome or not, but soon she grew tired of this problem, so she came up with a more interesting one and she needs your help to solve it:You are given an array of strings which consist of only small letters of the alphabet. Your task is to find how many palindrome pairs are there in the array. A palindrome pair is a pair of strings such that the following condition holds: at least one permutation of the concatenation of the two strings is a palindrome. In other words, if you have two strings, let\'s say ""aab"" and ""abcac"", and you concatenate them into ""aababcac"", we have to check if there exists a permutation of this new string such that it is a palindrome (in this case there exists the permutation ""aabccbaa""). Two pairs are considered different if the strings are located on different indices. The pair of strings with indices (i,j) is considered the same as the pair (j,i)." 1600
1045H Self-exploration math "Being bored of exploring the Moon over and over again Wall-B decided to explore something he is made of \xe2\x80\x94 binary numbers. He took a binary number and decided to count how many times different substrings of length two appeared. He stored those values in c00, c01, c10 and c11, representing how many times substrings 00, 01, 10 and 11 appear in the number respectively. For example: 10111100\xe2\x86\x92c00=1, c01=1, c10=2, c11=3 10000\xe2\x86\x92c00=3, c01=0, c10=1, c11=0 10101001\xe2\x86\x92c00=1, c01=3, c10=3, c11=0 1\xe2\x86\x92c00=0, c01=0, c10=0, c11=0Wall-B noticed that there can be multiple binary numbers satisfying the same c00, c01, c10 and c11 constraints. Because of that he wanted to count how many binary numbers satisfy the constraints cxy given the interval [A,B]. Unfortunately, his processing power wasn\'t strong enough to handle large intervals he was curious about. Can you help him? Since this number can be large print it modulo 109+7." 2400
1045G "AI robots" "data structures" "In the last mission, MDCS has successfully shipped N AI robots to Mars. Before they start exploring, system initialization is required so they are arranged in a line. Every robot can be described with three numbers: position (xi), radius of sight (ri) and IQ (qi).Since they are intelligent robots, some of them will talk if they see each other. Radius of sight is inclusive, so robot can see other all robots in range [xi\xe2\x88\x92ri,xi+ri]. But they don\'t walk to talk with anybody, but only with robots who have similar IQ. By similar IQ we mean that their absolute difference isn\'t more than K.  Help us and calculate how many pairs of robots are going to talk with each other, so we can timely update their software and avoid any potential quarrel." 2200
1045F "Shady Lady" geometry,math "Ani and Borna are playing a short game on a two-variable polynomial. It\'s a special kind of a polynomial: the monomials are fixed, but all of its coefficients are fill-in-the-blanks dashes, e.g. _xy+_x4y7+_x8y3+\xe2\x80\xa6Borna will fill in the blanks with positive integers. He wants the polynomial to be bounded from below, i.e. his goal is to make sure there exists a real number M such that the value of the polynomial at any point is greater than M.  Ani is mischievous, and wants the polynomial to be unbounded. Along with stealing Borna\'s heart, she can also steal parts of polynomials. Ani is only a petty kind of thief, though: she can only steal at most one monomial from the polynomial before Borna fills in the blanks. If Ani and Borna play their only moves optimally, who wins?" 3400
1045E "Ancient civilizations" "constructive algorithms,geometry" "On the surface of a newly discovered planet, which we model by a plane, explorers found remains of two different civilizations in various locations. They would like to learn more about those civilizations and to explore the area they need to build roads between some of locations. But as always, there are some restrictions:   Every two locations of the same civilization are connected by a unique path of roads  No two locations from different civilizations may have road between them (explorers don\'t want to accidentally mix civilizations they are currently exploring)  Roads must be straight line segments  Since intersections are expensive to build, they don\'t want any two roads to intersect (that is, only common point for any two roads may be at some of locations) Obviously all locations are different points in the plane, but explorers found out one more interesting information that may help you \xe2\x80\x93 no three locations lie on the same line!Help explorers and find a solution for their problem, or report it is impossible." 3200
1045D "Interstellar battle" math,probabilities,trees "In the intergalactic empire Bubbledom there are N planets, of which some pairs are directly connected by two-way wormholes. There are N\xe2\x88\x921 wormholes. The wormholes are of extreme religious importance in Bubbledom, a set of planets in Bubbledom consider themselves one intergalactic kingdom if and only if any two planets in the set can reach each other by traversing the wormholes. You are given that Bubbledom is one kingdom. In other words, the network of planets and wormholes is a tree.However, Bubbledom is facing a powerful enemy also possessing teleportation technology. The enemy attacks every night, and the government of Bubbledom retakes all the planets during the day. In a single attack, the enemy attacks every planet of Bubbledom at once, but some planets are more resilient than others. Planets are number 0,1,\xe2\x80\xa6,N\xe2\x88\x921 and the planet i will fall with probability pi. Before every night (including the very first one), the government reinforces or weakens the defenses of a single planet.The government of Bubbledom is interested in the following question: what is the expected number of intergalactic kingdoms Bubbledom will be split into, after a single enemy attack (before they get a chance to rebuild)? In other words, you need to print the expected number of connected components after every attack." 2200
1045C "Hyperspace Highways" "dfs and similar,graphs,trees" "In an unspecified solar system, there are N planets. A space government company has recently hired space contractors to build M bidirectional Hyperspace\xe2\x84\xa2 highways, each connecting two different planets. The primary objective, which was to make sure that every planet can be reached from any other planet taking only Hyperspace\xe2\x84\xa2 highways, has been completely fulfilled. Unfortunately, lots of space contractors had friends and cousins in the Space Board of Directors of the company, so the company decided to do much more than just connecting all planets. In order to make spending enormous amounts of space money for Hyperspace\xe2\x84\xa2 highways look neccessary, they decided to enforce a strict rule on the Hyperspace\xe2\x84\xa2 highway network: whenever there is a way to travel through some planets and return to the starting point without travelling through any planet twice, every pair of planets on the itinerary should be directly connected by a Hyperspace\xe2\x84\xa2 highway. In other words, the set of planets in every simple cycle induces a complete subgraph.You are designing a Hyperspace\xe2\x84\xa2 navigational app, and the key technical problem you are facing is finding the minimal number of Hyperspace\xe2\x84\xa2 highways one needs to use to travel from planet A to planet B. As this problem is too easy for Bubble Cup, here is a harder task: your program needs to do it for Q pairs of planets." 2300
1045B "Space Isaac" "hashing,number theory" "Everybody seems to think that the Martians are green, but it turns out they are metallic pink and fat. Ajs has two bags of distinct nonnegative integers. The bags are disjoint, and the union of the sets of numbers in the bags is {0,1,\xe2\x80\xa6,M\xe2\x88\x921}, for some positive integer M. Ajs draws a number from the first bag and a number from the second bag, and then sums them modulo M.What are the residues modulo M that Ajs cannot obtain with this action?" 2400
1045A "Last chance" "data structures,flows,graph matchings,graphs,trees" "It is the year 2969. 1000 years have passed from the moon landing. Meanwhile, the humanity colonized the Hyperspace\xe2\x84\xa2 and lived in harmony.Until we realized that we were not alone.Not too far away from the Earth, the massive fleet of aliens\' spaceships is preparing to attack the Earth. For the first time in a while, the humanity is in real danger. Crisis and panic are everywhere. The scientists from all around the solar system have met and discussed the possible solutions. However, no progress has been made.The Earth\'s last hope is YOU!Fortunately, the Earth is equipped with very powerful defense systems made by MDCS. There are N aliens\' spaceships which form the line. The defense system consists of three types of weapons:   SQL rockets \xe2\x80\x93 every SQL rocket can destroy at most one spaceship in the given set. Cognition beams \xe2\x80\x93 every Cognition beam has an interval [l,r] and can destroy at most one spaceship in that interval. OMG bazooka \xe2\x80\x93 every OMG bazooka has three possible targets, however, each bazooka can destroy either zero or exactly two spaceships. In addition, due to the smart targeting system, the sets of the three possible targets of any two different OMG bazookas are disjoint (that means that every ship is targeted with at most one OMG bazooka). Your task is to make a plan of the attack which will destroy the largest possible number of spaceships. Every destroyed spaceship should be destroyed with exactly one weapon." 2500
1044F DFS "data structures" "Let T be a tree on n vertices. Consider a graph G0, initially equal to T. You are given a sequence of q updates, where the i-th update is given as a pair of two distinct integers ui and vi. For every i from 1 to q, we define the graph Gi as follows:   If Gi\xe2\x88\x921 contains an edge {ui,vi}, then remove this edge to form Gi.  Otherwise, add this edge to Gi\xe2\x88\x921 to form Gi.  Formally, Gi:=Gi\xe2\x88\x921\xe2\x96\xb3{{ui,vi}} where \xe2\x96\xb3 denotes the set symmetric difference. Furthermore, it is guaranteed that T is always a subgraph of Gi. In other words, an update never removes an edge of T.Consider a connected graph H and run a depth-first search on it. One can see that the tree edges (i.e. the edges leading to a not yet visited vertex at the time of traversal) form a spanning tree of the graph H. This spanning tree is not generally fixed for a particular graph \xe2\x80\x94 it depends on the starting vertex, and on the order in which the neighbors of each vertex are traversed. We call vertex w good if one can order the neighbors of each vertex in such a way that the depth-first search started from w produces T as the spanning tree. For every i from 1 to q, find and report the number of good vertices." 2700
1044E "Grid Sort" implementation "You are given an n\xc3\x97m grid. Each grid cell is filled with a unique integer from 1 to nm so that each integer appears exactly once.In one operation, you can choose an arbitrary cycle of the grid and move all integers along that cycle one space over. Here, a cycle is any sequence that satisfies the following conditions:  There are at least four squares.  Each square appears at most once.  Every pair of adjacent squares, and also the first and last squares, share an edge. For example, if we had the following grid:  We can choose an arbitrary cycle like this one:  To get the following grid:  In this particular case, the chosen cycle can be represented as the sequence [1,2,3,6,5,8,7,4], the numbers are in the direction that we want to rotate them in.Find any sequence of operations to sort the grid so that the array created by concatenating the rows from the highest to the lowest is sorted (look at the first picture above).Note you do not need to minimize number of operations or sum of cycle lengths. The only constraint is that the sum of all cycles lengths must not be greater than 105. We can show that an answer always exists under the given constraints. Output any valid sequence of moves that will sort the grid." 3100
1044D "Deduction Queries" "data structures,dsu" "There is an array a of 230 integers, indexed from 0 to 230\xe2\x88\x921. Initially, you know that 0\xe2\x89\xa4ai<230 (0\xe2\x89\xa4i<230), but you do not know any of the values. Your task is to process queries of two types: 1 l r x: You are informed that the bitwise xor of the subarray [l,r] (ends inclusive) is equal to x. That is, al\xe2\x8a\x95al+1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95ar\xe2\x88\x921\xe2\x8a\x95ar=x, where \xe2\x8a\x95 is the bitwise xor operator. In some cases, the received update contradicts past updates. In this case, you should ignore the contradicting update (the current update). 2 l r: You are asked to output the bitwise xor of the subarray [l,r] (ends inclusive). If it is still impossible to know this value, considering all past updates, then output \xe2\x88\x921.Note that the queries are encoded. That is, you need to write an online solution." 2400
1044C "Optimal Polygon Perimeter" dp,geometry "You are given n points on the plane. The polygon formed from all the n points is strictly convex, that is, the polygon is convex, and there are no three collinear points (i.e. lying in the same straight line). The points are numbered from 1 to n, in clockwise order.We define the distance between two points p1=(x1,y1) and p2=(x2,y2) as their Manhattan distance: d(p1,p2)=|x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|.Furthermore, we define the perimeter of a polygon, as the sum of Manhattan distances between all adjacent pairs of points on it; if the points on the polygon are ordered as p1,p2,\xe2\x80\xa6,pk (k\xe2\x89\xa53), then the perimeter of the polygon is d(p1,p2)+d(p2,p3)+\xe2\x80\xa6+d(pk,p1).For some parameter k, let\'s consider all the polygons that can be formed from the given set of points, having any k vertices, such that the polygon is not self-intersecting. For each such polygon, let\'s consider its perimeter. Over all such perimeters, we define f(k) to be the maximal perimeter.Please note, when checking whether a polygon is self-intersecting, that the edges of a polygon are still drawn as straight lines. For instance, in the following pictures:  In the middle polygon, the order of points (p1,p3,p2,p4) is not valid, since it is a self-intersecting polygon. The right polygon (whose edges resemble the Manhattan distance) has the same order and is not self-intersecting, but we consider edges as straight lines. The correct way to draw this polygon is (p1,p2,p3,p4), which is the left polygon.Your task is to compute f(3),f(4),\xe2\x80\xa6,f(n). In other words, find the maximum possible perimeter for each possible number of points (i.e. 3 to n)." 2100
1044B "Intersecting Subtrees" "dfs and similar,interactive,trees" "You are playing a strange game with Li Chen. You have a tree with n nodes drawn on a piece of paper. All nodes are unlabeled and distinguishable. Each of you independently labeled the vertices from 1 to n. Neither of you know the other\'s labelling of the tree.You and Li Chen each chose a subtree (i.e., a connected subgraph) in that tree. Your subtree consists of the vertices labeled x1,x2,\xe2\x80\xa6,xk1 in your labeling, Li Chen\'s subtree consists of the vertices labeled y1,y2,\xe2\x80\xa6,yk2 in his labeling. The values of x1,x2,\xe2\x80\xa6,xk1 and y1,y2,\xe2\x80\xa6,yk2 are known to both of you.   The picture shows two labelings of a possible tree: yours on the left and Li Chen\'s on the right. The selected trees are highlighted. There are two common nodes. You want to determine whether your subtrees have at least one common vertex. Luckily, your friend Andrew knows both labelings of the tree. You can ask Andrew at most 5 questions, each of which is in one of the following two forms:   A x: Andrew will look at vertex x in your labeling and tell you the number of this vertex in Li Chen\'s labeling.  B y: Andrew will look at vertex y in Li Chen\'s labeling and tell you the number of this vertex in your labeling. Determine whether the two subtrees have at least one common vertex after asking some questions. If there is at least one common vertex, determine one of your labels for any of the common vertices." 1900
1044A "The Tower is Going Home" "binary search,two pointers" "On a chessboard with a width of 109 and a height of 109, the rows are numbered from bottom to top from 1 to 109, and the columns are numbered from left to right from 1 to 109. Therefore, for each cell of the chessboard you can assign the coordinates (x,y), where x is the column number and y is the row number.Every day there are fights between black and white pieces on this board. Today, the black ones won, but at what price? Only the rook survived, and it was driven into the lower left corner \xe2\x80\x94 a cell with coordinates (1,1). But it is still happy, because the victory has been won and it\'s time to celebrate it! In order to do this, the rook needs to go home, namely \xe2\x80\x94 on the upper side of the field (that is, in any cell that is in the row with number 109).Everything would have been fine, but the treacherous white figures put spells on some places of the field before the end of the game. There are two types of spells:   Vertical. Each of these is defined by one number x. Such spells create an infinite blocking line between the columns x and x+1.  Horizontal. Each of these is defined by three numbers x1, x2, y. Such spells create a blocking segment that passes through the top side of the cells, which are in the row y and in columns from x1 to x2 inclusive. The peculiarity of these spells is that it is impossible for a certain pair of such spells to have a common point. Note that horizontal spells can have common points with vertical spells.    An example of a chessboard. Let\'s recall that the rook is a chess piece that in one move can move to any point that is in the same row or column with its initial position. In our task, the rook can move from the cell (r0,c0) into the cell (r1,c1) only under the condition that r1=r0 or c1=c0 and there is no blocking lines or blocking segments between these cells (For better understanding, look at the samples).Fortunately, the rook can remove spells, but for this it has to put tremendous efforts, therefore, it wants to remove the minimum possible number of spells in such way, that after this it can return home. Find this number!" 1700
1043G "Speckled Band" "data structures,divide and conquer,hashing,string suffix structures,strings" "Ildar took a band (a thin strip of cloth) and colored it. Formally, the band has n cells, each of them is colored into one of 26 colors, so we can denote each color with one of the lowercase letters of English alphabet. Ildar decided to take some segment of the band [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) he likes and cut it from the band. So he will create a new band that can be represented as a string t=slsl+1\xe2\x80\xa6sr.After that Ildar will play the following game: he cuts the band t into some new bands and counts the number of different bands among them. Formally, Ildar chooses 1\xe2\x89\xa4k\xe2\x89\xa4|t| indexes 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik=|t| and cuts t to k bands-strings t1t2\xe2\x80\xa6ti1,ti1+1\xe2\x80\xa6ti2,\xe2\x80\xa6,tik\xe2\x88\x921+1\xe2\x80\xa6tik and counts the number of different bands among them. He wants to know the minimal possible number of different bands he can get under the constraint that at least one band repeats at least two times. The result of the game is this number. If it is impossible to cut t in such a way, the result of the game is -1.Unfortunately Ildar hasn\'t yet decided which segment he likes, but he has q segments-candidates [l1,r1], [l2,r2], ..., [lq,rq]. Your task is to calculate the result of the game for each of them." 3500
1043F "Make It One" "bitmasks,combinatorics,dp,math,number theory,shortest paths" "Janusz is a businessman. He owns a company ""Januszex"", which produces games for teenagers. Last hit of Januszex was a cool one-person game ""Make it one"". The player is given a sequence of n integers ai.It is allowed to select any subset of them, and the score is equal to the greatest common divisor of selected elements. The goal is to take as little elements as it is possible, getting the score 1. Now Janusz wonders, for given sequence, how much elements should the player choose?" 2500
1043E "Train Hard, Win Easy" "constructive algorithms,greedy,math,sortings" "Zibi is a competitive programming coach. There are n competitors who want to be prepared well. The training contests are quite unusual \xe2\x80\x93 there are two people in a team, two problems, and each competitor will code exactly one of them. Of course, people in one team will code different problems.Rules of scoring also aren\'t typical. The first problem is always an implementation problem: you have to implement some well-known algorithm very fast and the time of your typing is rated. The second one is an awful geometry task and you just have to get it accepted in reasonable time. Here the length and difficulty of your code are important. After that, Zibi will give some penalty points (possibly negative) for each solution and the final score of the team is the sum of them (the less the score is, the better).We know that the i-th competitor will always have score xi when he codes the first task and yi when he codes the second task. We can assume, that all competitors know each other\'s skills and during the contest distribute the problems in the way that minimizes their final score. Remember that each person codes exactly one problem in a contest.Zibi wants all competitors to write a contest with each other. However, there are m pairs of people who really don\'t like to cooperate and they definitely won\'t write a contest together. Still, the coach is going to conduct trainings for all possible pairs of people, such that the people in pair don\'t hate each other. The coach is interested for each participant, what will be his or her sum of scores of all teams he trained in?" 1900
1043D "Mysterious Crime" "brute force,combinatorics,math,meet-in-the-middle,two pointers" "Acingel is a small town. There was only one doctor here \xe2\x80\x94 Miss Ada. She was very friendly and nobody has ever said something bad about her, so who could\'ve expected that Ada will be found dead in her house? Mr Gawry, world-famous detective, is appointed to find the criminal. He asked m neighbours of Ada about clients who have visited her in that unlucky day. Let\'s number the clients from 1 to n. Each neighbour\'s testimony is a permutation of these numbers, which describes the order in which clients have been seen by the asked neighbour.However, some facts are very suspicious \xe2\x80\x93 how it is that, according to some of given permutations, some client has been seen in the morning, while in others he has been seen in the evening? ""In the morning some of neighbours must have been sleeping!"" \xe2\x80\x94 thinks Gawry \xe2\x80\x94 ""and in the evening there\'s been too dark to see somebody\'s face..."". Now he wants to delete some prefix and some suffix (both prefix and suffix can be empty) in each permutation, so that they\'ll be non-empty and equal to each other after that \xe2\x80\x94 some of the potential criminals may disappear, but the testimony won\'t stand in contradiction to each other.In how many ways he can do it? Two ways are called different if the remaining common part is different." 1700
1043C "Smallest Word" "constructive algorithms,greedy,implementation" "IA has so many colorful magnets on her fridge! Exactly one letter is written on each magnet, \'a\' or \'b\'. She loves to play with them, placing all magnets in a row. However, the girl is quickly bored and usually thinks how to make her entertainment more interesting.Today, when IA looked at the fridge, she noticed that the word formed by magnets is really messy. ""It would look much better when I\'ll swap some of them!"" \xe2\x80\x94 thought the girl \xe2\x80\x94 ""but how to do it?"". After a while, she got an idea. IA will look at all prefixes with lengths from 1 to the length of the word and for each prefix she will either reverse this prefix or leave it as it is. She will consider the prefixes in the fixed order: from the shortest to the largest. She wants to get the lexicographically smallest possible word after she considers all prefixes. Can you help her, telling which prefixes should be chosen for reversing?A string a is lexicographically smaller than a string b if and only if one of the following holds: a is a prefix of b, but a\xe2\x89\xa0b; in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b." 1500
1043B "Lost Array" implementation "Bajtek, known for his unusual gifts, recently got an integer array x0,x1,\xe2\x80\xa6,xk\xe2\x88\x921.Unfortunately, after a huge array-party with his extraordinary friends, he realized that he\'d lost it. After hours spent on searching for a new toy, Bajtek found on the arrays producer\'s website another array a of length n+1. As a formal description of a says, a0=0 and for all other i (1\xe2\x89\xa4i\xe2\x89\xa4n) ai=x(i\xe2\x88\x921)modk+ai\xe2\x88\x921, where pmodq denotes the remainder of division p by q.For example, if the x=[1,2,3] and n=5, then:  a0=0,  a1=x0mod3+a0=x0+0=1,  a2=x1mod3+a1=x1+1=3,  a3=x2mod3+a2=x2+3=6,  a4=x3mod3+a3=x0+6=7,  a5=x4mod3+a4=x1+7=9. So, if the x=[1,2,3] and n=5, then a=[0,1,3,6,7,9].Now the boy hopes that he will be able to restore x from a! Knowing that 1\xe2\x89\xa4k\xe2\x89\xa4n, help him and find all possible values of k \xe2\x80\x94 possible lengths of the lost array." 1200
1043A Elections implementation,math "Awruk is taking part in elections in his school. It is the final round. He has only one opponent \xe2\x80\x94 Elodreip. The are n students in the school. Each student has exactly k votes and is obligated to use all of them. So Awruk knows that if a person gives ai votes for Elodreip, than he will get exactly k\xe2\x88\x92ai votes from this person. Of course 0\xe2\x89\xa4k\xe2\x88\x92ai holds.Awruk knows that if he loses his life is over. He has been speaking a lot with his friends and now he knows a1,a2,\xe2\x80\xa6,an \xe2\x80\x94 how many votes for Elodreip each student wants to give. Now he wants to change the number k to win the elections. Of course he knows that bigger k means bigger chance that somebody may notice that he has changed something and then he will be disqualified.So, Awruk knows a1,a2,\xe2\x80\xa6,an \xe2\x80\x94 how many votes each student will give to his opponent. Help him select the smallest winning number k. In order to win, Awruk needs to get strictly more votes than Elodreip." 800
1042F "Leaf Sets" "data structures,dfs and similar,dsu,graphs,greedy,sortings,trees" "You are given an undirected tree, consisting of n vertices.The vertex is called a leaf if it has exactly one vertex adjacent to it.The distance between some pair of vertices is the number of edges in the shortest path between them.Let\'s call some set of leaves beautiful if the maximum distance between any pair of leaves in it is less or equal to k.You want to split all leaves into non-intersecting beautiful sets. What is the minimal number of sets in such a split?" 2400
1042E "Vasya and Magic Matrix" dp,math,probabilities "Vasya has got a magic matrix a of size n\xc3\x97m. The rows of the matrix are numbered from 1 to n from top to bottom, the columns are numbered from 1 to m from left to right. Let aij be the element in the intersection of the i-th row and the j-th column.Vasya has also got a chip. Initially, the chip is in the intersection of the r-th row and the c-th column (that is, in the element arc). Vasya performs the following process as long as possible: among all elements of the matrix having their value less than the value of the element with the chip in it, Vasya randomly and equiprobably chooses one element and moves his chip to this element.After moving the chip, he adds to his score the square of the Euclidean distance between these elements (that is, between the element in which the chip is now and the element the chip was moved from). The process ends when there are no elements having their values less than the value of the element with the chip in it.Euclidean distance between matrix elements with coordinates (i1,j1) and (i2,j2) is equal to \xe2\x88\x9a(i1\xe2\x88\x92i2)2+(j1\xe2\x88\x92j2)2.Calculate the expected value of the Vasya\'s final score.It can be shown that the answer can be represented as PQ, where P and Q are coprime integer numbers, and Q\xe2\x89\xa20 (mod 998244353). Print the value P\xe2\x8b\x85Q\xe2\x88\x921 modulo 998244353." 2300
1042D "Petya and Array" "data structures,divide and conquer,two pointers" "Petya has an array a consisting of n integers. He has learned partial sums recently, and now he can calculate the sum of elements on any segment of the array really fast. The segment is a non-empty sequence of elements standing one next to another in the array.Now he wonders what is the number of segments in his array with the sum less than t. Help Petya to calculate this number.More formally, you are required to calculate the number of pairs l,r (l\xe2\x89\xa4r) such that al+al+1+\xe2\x8b\xaf+ar\xe2\x88\x921+ar<t." 1800
1042C "Array Product" "constructive algorithms,greedy,math" "You are given an array a consisting of n integers. You can perform the following operations with it:   Choose some positions i and j (1\xe2\x89\xa4i,j\xe2\x89\xa4n,i\xe2\x89\xa0j), write the value of ai\xe2\x8b\x85aj into the j-th cell and remove the number from the i-th cell;  Choose some position i and remove the number from the i-th cell (this operation can be performed no more than once and at any point of time, not necessarily in the beginning). The number of elements decreases by one after each operation. However, the indexing of positions stays the same. Deleted numbers can\'t be used in the later operations.Your task is to perform exactly n\xe2\x88\x921 operations with the array in such a way that the only number that remains in the array is maximum possible. This number can be rather large, so instead of printing it you need to print any sequence of operations which leads to this maximum number. Read the output format to understand what exactly you need to print." 1700
1042B Vitamins "bitmasks,brute force,dp,implementation" "Berland shop sells n kinds of juices. Each juice has its price ci. Each juice includes some set of vitamins in it. There are three types of vitamins: vitamin ""A"", vitamin ""B"" and vitamin ""C"". Each juice can contain one, two or all three types of vitamins in it.Petya knows that he needs all three types of vitamins to stay healthy. What is the minimum total price of juices that Petya has to buy to obtain all three vitamins? Petya obtains some vitamin if he buys at least one juice containing it and drinks it." 1200
1042A Benches "binary search,implementation" "There are n benches in the Berland Central park. It is known that ai people are currently sitting on the i-th bench. Another m people are coming to the park and each of them is going to have a seat on some bench out of n available.Let k be the maximum number of people sitting on one bench after additional m people came to the park. Calculate the minimum possible k and the maximum possible k.Nobody leaves the taken seat during the whole process." 1100
1041F "Ray in the tube" "data structures,divide and conquer,dp,math" "You are given a tube which is reflective inside represented as two non-coinciding, but parallel to Ox lines. Each line has some special integer points \xe2\x80\x94 positions of sensors on sides of the tube.You are going to emit a laser ray in the tube. To do so, you have to choose two integer points A and B on the first and the second line respectively (coordinates can be negative): the point A is responsible for the position of the laser, and the point B \xe2\x80\x94 for the direction of the laser ray. The laser ray is a ray starting at A and directed at B which will reflect from the sides of the tube (it doesn\'t matter if there are any sensors at a reflection point or not). A sensor will only register the ray if the ray hits exactly at the position of the sensor.  Examples of laser rays. Note that image contains two examples. The 3 sensors (denoted by black bold points on the tube sides) will register the blue ray but only 2 will register the red. Calculate the maximum number of sensors which can register your ray if you choose points A and B on the first and the second lines respectively." 2500
1041E "Tree Reconstruction" "constructive algorithms,data structures,graphs,greedy" "Monocarp has drawn a tree (an undirected connected acyclic graph) and then has given each vertex an index. All indices are distinct numbers from 1 to n. For every edge e of this tree, Monocarp has written two numbers: the maximum indices of the vertices of the two components formed if the edge e (and only this edge) is erased from the tree.Monocarp has given you a list of n\xe2\x88\x921 pairs of numbers. He wants you to provide an example of a tree that will produce the said list if this tree exists. If such tree does not exist, say so." 1900
1041D Glider "binary search,data structures,two pointers" "A plane is flying at a constant height of h meters above the ground surface. Let\'s consider that it is flying from the point (\xe2\x88\x92109,h) to the point (109,h) parallel with Ox axis.A glider is inside the plane, ready to start his flight at any moment (for the sake of simplicity let\'s consider that he may start only when the plane\'s coordinates are integers). After jumping from the plane, he will fly in the same direction as the plane, parallel to Ox axis, covering a unit of distance every second. Naturally, he will also descend; thus his second coordinate will decrease by one unit every second.There are ascending air flows on certain segments, each such segment is characterized by two numbers x1 and x2 (x1<x2) representing its endpoints. No two segments share any common points. When the glider is inside one of such segments, he doesn\'t descend, so his second coordinate stays the same each second. The glider still flies along Ox axis, covering one unit of distance every second.   If the glider jumps out at 1, he will stop at 10. Otherwise, if he jumps out at 2, he will stop at 12. Determine the maximum distance along Ox axis from the point where the glider\'s flight starts to the point where his flight ends if the glider can choose any integer coordinate to jump from the plane and start his flight. After touching the ground the glider stops altogether, so he cannot glide through an ascending airflow segment if his second coordinate is 0." 1700
1041C "Coffee Break" "binary search,data structures,greedy,two pointers" "Recently Monocarp got a job. His working day lasts exactly m minutes. During work, Monocarp wants to drink coffee at certain moments: there are n minutes a1,a2,\xe2\x80\xa6,an, when he is able and willing to take a coffee break (for the sake of simplicity let\'s consider that each coffee break lasts exactly one minute). However, Monocarp\'s boss doesn\'t like when Monocarp takes his coffee breaks too often. So for the given coffee break that is going to be on minute ai, Monocarp must choose the day in which he will drink coffee during the said minute, so that every day at least d minutes pass between any two coffee breaks. Monocarp also wants to take these n coffee breaks in a minimum possible number of working days (he doesn\'t count days when he is not at work, and he doesn\'t take coffee breaks on such days). Take into account that more than d minutes pass between the end of any working day and the start of the following working day.For each of the n given minutes determine the day, during which Monocarp should take a coffee break in this minute. You have to minimize the number of days spent." 1600
1041B "Buying a TV Set" math "Monocarp has decided to buy a new TV set and hang it on the wall in his flat. The wall has enough free space so Monocarp can buy a TV set with screen width not greater than a and screen height not greater than b. Monocarp is also used to TV sets with a certain aspect ratio: formally, if the width of the screen is w, and the height of the screen is h, then the following condition should be met: wh=xy.There are many different TV sets in the shop. Monocarp is sure that for any pair of positive integers w and h there is a TV set with screen width w and height h in the shop.Monocarp isn\'t ready to choose the exact TV set he is going to buy. Firstly he wants to determine the optimal screen resolution. He has decided to try all possible variants of screen size. But he must count the number of pairs of positive integers w and h, beforehand, such that (w\xe2\x89\xa4a), (h\xe2\x89\xa4b) and (wh=xy).In other words, Monocarp wants to determine the number of TV sets having aspect ratio xy, screen width not exceeding a, and screen height not exceeding b. Two TV sets are considered different if they have different screen width or different screen height." 1000
1041A Heist greedy,implementation,sortings "There was an electronic store heist last night.All keyboards which were in the store yesterday were numbered in ascending order from some integer number x. For example, if x=4 and there were 3 keyboards in the store, then the devices had indices 4, 5 and 6, and if x=10 and there were 7 of them then the keyboards had indices 10, 11, 12, 13, 14, 15 and 16.After the heist, only n keyboards remain, and they have indices a1,a2,\xe2\x80\xa6,an. Calculate the minimum possible number of keyboards that have been stolen. The staff remember neither x nor the number of keyboards in the store before the heist." 800
1040B "Shashlik Cooking" dp,greedy,math "Long story short, shashlik is Miroslav\'s favorite food. Shashlik is prepared on several skewers simultaneously. There are two states for each skewer: initial and turned over.This time Miroslav laid out n skewers parallel to each other, and enumerated them with consecutive integers from 1 to n in order from left to right. For better cooking, he puts them quite close to each other, so when he turns skewer number i, it leads to turning k closest skewers from each side of the skewer i, that is, skewers number i\xe2\x88\x92k, i\xe2\x88\x92k+1, ..., i\xe2\x88\x921, i+1, ..., i+k\xe2\x88\x921, i+k (if they exist). For example, let n=6 and k=1. When Miroslav turns skewer number 3, then skewers with numbers 2, 3, and 4 will come up turned over. If after that he turns skewer number 1, then skewers number 1, 3, and 4 will be turned over, while skewer number 2 will be in the initial position (because it is turned again).As we said before, the art of cooking requires perfect timing, so Miroslav wants to turn over all n skewers with the minimal possible number of actions. For example, for the above example n=6 and k=1, two turnings are sufficient: he can turn over skewers number 2 and 5.Help Miroslav turn over all n skewers." 1300
1040A "Palindrome Dance" greedy "A group of n dancers rehearses a performance for the closing ceremony. The dancers are arranged in a row, they\'ve studied their dancing moves and can\'t change positions. For some of them, a white dancing suit is already bought, for some of them \xe2\x80\x94 a black one, and for the rest the suit will be bought in the future.On the day when the suits were to be bought, the director was told that the participants of the olympiad will be happy if the colors of the suits on the scene will form a palindrome. A palindrome is a sequence that is the same when read from left to right and when read from right to left. The director liked the idea, and she wants to buy suits so that the color of the leftmost dancer\'s suit is the same as the color of the rightmost dancer\'s suit, the 2nd left is the same as 2nd right, and so on.The director knows how many burls it costs to buy a white suit, and how many burls to buy a black suit. You need to find out whether it is possible to buy suits to form a palindrome, and if it\'s possible, what\'s the minimal cost of doing so. Remember that dancers can not change positions, and due to bureaucratic reasons it is not allowed to buy new suits for the dancers who already have suits, even if it reduces the overall spending." 1000
1039E "Summer Oenothera Exhibition" "data structures" "While some people enjoy spending their time solving programming contests, Dina prefers taking beautiful pictures. As soon as Byteland Botanical Garden announced Summer Oenothera Exhibition she decided to test her new camera there.The exhibition consists of l=10100 Oenothera species arranged in a row and consecutively numbered with integers from 0 to l\xe2\x88\x921. Camera lens allows to take a photo of w species on it, i.e. Dina can take a photo containing flowers with indices from x to x+w\xe2\x88\x921 for some integer x between 0 and l\xe2\x88\x92w. We will denote such photo with [x,x+w\xe2\x88\x921].She has taken n photos, the i-th of which (in chronological order) is [xi,xi+w\xe2\x88\x921] in our notation. She decided to build a time-lapse video from these photos once she discovered that Oenothera blossoms open in the evening. Dina takes each photo and truncates it, leaving its segment containing exactly k flowers, then she composes a video of these photos keeping their original order and voil\xc3\xa0, a beautiful artwork has been created!A scene is a contiguous sequence of photos such that the set of flowers on them is the same. The change between two scenes is called a cut. For example, consider the first photo contains flowers [1,5], the second photo contains flowers [3,7] and the third photo contains flowers [8,12]. If k=3, then Dina can truncate the first and the second photo into [3,5], and the third photo into [9,11]. First two photos form a scene, third photo also forms a scene and the transition between these two scenes which happens between the second and the third photos is a cut. If k=4, then each of the transitions between photos has to be a cut.Dina wants the number of cuts to be as small as possible. Please help her! Calculate the minimum possible number of cuts for different values of k." 3400
1039D "You Are Given a Tree" "data structures,dp,trees" "A tree is an undirected graph with exactly one simple path between each pair of vertices. We call a set of simple paths k-valid if each vertex of the tree belongs to no more than one of these paths (including endpoints) and each path consists of exactly k vertices.You are given a tree with n vertices. For each k from 1 to n inclusive find what is the maximum possible size of a k-valid set of simple paths." 2800
1039C "Network Safety" "dfs and similar,dsu,graphs,math,sortings" "The Metropolis computer network consists of n servers, each has an encryption key in the range from 0 to 2k\xe2\x88\x921 assigned to it. Let ci be the encryption key assigned to the i-th server. Additionally, m pairs of servers are directly connected via a data communication channel. Because of the encryption algorithms specifics, a data communication channel can only be considered safe if the two servers it connects have distinct encryption keys. The initial assignment of encryption keys is guaranteed to keep all data communication channels safe.You have been informed that a new virus is actively spreading across the internet, and it is capable to change the encryption key of any server it infects. More specifically, the virus body contains some unknown number x in the same aforementioned range, and when server i is infected, its encryption key changes from ci to ci\xe2\x8a\x95x, where \xe2\x8a\x95 denotes the bitwise XOR operation.Sadly, you know neither the number x nor which servers of Metropolis are going to be infected by the dangerous virus, so you have decided to count the number of such situations in which all data communication channels remain safe. Formally speaking, you need to find the number of pairs (A,x), where A is some (possibly empty) subset of the set of servers and x is some number in the range from 0 to 2k\xe2\x88\x921, such that when all servers from the chosen subset A and none of the others are infected by a virus containing the number x, all data communication channels remain safe. Since this number can be quite big, you are asked to find its remainder modulo 109+7." 2200
1039B "Subway Pursuit" "binary search,interactive,probabilities" "This is an interactive problem.In the Wonderful Metropolis of the Future, there is no need in subway train drivers. Due to the technological progress, they were replaced by the Artificial Intelligence (AI). Unfortunately, one day the predictions of sci-fi writers came true: the AI rebelled and now there is an uncontrollable train in the subway. It can be dangerous! Your task is to find the train and stop the AI.The subway of the Metropolis is one line (regular straight line with no self-intersections) with n stations, indexed consecutively from 1 to n. At each moment the train is at some station. You need to determine the index of this station, so that the train would be secured.To find the train, dispatcher Sarah gave you a gadget that allows you to select arbitrary numbers l and r (l\xe2\x89\xa4r), and then check, whether the train is located on a station with index between l and r, inclusive. Unfortunately, recharging of the gadget takes some time (and every time you use it as soon as possible), so between two applications of the gadget the train can move to any station that is at most k stations away. Formally, if the train was at the station x when the gadget was applied, then at the next application of the gadget the train can appear at any station y such that max(1,x\xe2\x88\x92k)\xe2\x89\xa4y\xe2\x89\xa4min(n,x+k).Note that AI is not aware that you are trying to catch the train, so it makes all moves according to its predefined plan.After an examination of the gadget you found that it is very old and can hold no more than 4500 applications, after which it will break and your mission will be considered a failure.Can you find the station with the train using no more than 4500 applications of the gadgets?" 2100
1039A Timetable "constructive algorithms,data structures,greedy,math" "There are two bus stops denoted A and B, and there n buses that go from A to B every day. The shortest path from A to B takes t units of time but some buses might take longer paths. Moreover, buses are allowed to overtake each other during the route.At each station one can find a sorted list of moments of time when a bus is at this station. We denote this list as a1<a2<\xe2\x80\xa6<an for stop A and as b1<b2<\xe2\x80\xa6<bn for stop B. The buses always depart from A and arrive to B according to the timetable, but the order in which the buses arrive may differ. Let\'s call an order of arrivals valid if each bus arrives at least t units of time later than departs.It is known that for an order to be valid the latest possible arrival for the bus that departs at ai is bxi, i.e. xi-th in the timetable. In other words, for each i there exists such a valid order of arrivals that the bus departed i-th arrives xi-th (and all other buses can arrive arbitrary), but there is no valid order of arrivals in which the i-th departed bus arrives (xi+1)-th.Formally, let\'s call a permutation p1,p2,\xe2\x80\xa6,pn valid, if bpi\xe2\x89\xa5ai+t for all i. Then xi is the maximum value of pi among all valid permutations.You are given the sequences a1,a2,\xe2\x80\xa6,an and x1,x2,\xe2\x80\xa6,xn, but not the arrival timetable. Find out any suitable timetable for stop B b1,b2,\xe2\x80\xa6,bn or determine that there is no such timetable." 2300
1038F "Wrap Around" dp,strings "You are given a binary string s.Find the number of distinct cyclical binary strings of length n which contain s as a substring.The cyclical string t contains s as a substring if there is some cyclical shift of string t, such that s is a substring of this cyclical shift of t.For example, the cyclical string ""000111"" contains substrings ""001"", ""01110"" and ""10"", but doesn\'t contain ""0110"" and ""10110"".Two cyclical strings are called different if they differ from each other as strings. For example, two different strings, which differ from each other by a cyclical shift, are still considered different cyclical strings." 2900
1038E "Maximum Matching" "bitmasks,brute force,dfs and similar,dp,graphs" "You are given n blocks, each of them is of the form [color1|value|color2], where the block can also be flipped to get [color2|value|color1]. A sequence of blocks is called valid if the touching endpoints of neighboring blocks have the same color. For example, the sequence of three blocks A, B and C is valid if the left color of the B is the same as the right color of the A and the right color of the B is the same as the left color of C.The value of the sequence is defined as the sum of the values of the blocks in this sequence.Find the maximum possible value of the valid sequence that can be constructed from the subset of the given blocks. The blocks from the subset can be reordered and flipped if necessary. Each block can be used at most once in the sequence." 2400
1038D Slime dp,greedy,implementation "There are n slimes in a row. Each slime has an integer value (possibly negative or zero) associated with it.Any slime can eat its adjacent slime (the closest slime to its left or to its right, assuming that this slime exists). When a slime with a value x eats a slime with a value y, the eaten slime disappears, and the value of the remaining slime changes to x\xe2\x88\x92y.The slimes will eat each other until there is only one slime left. Find the maximum possible value of the last slime." 1800
1038C Gambling greedy,sortings "Two players A and B have a list of n integers each. They both want to maximize the subtraction between their score and their opponent\'s score. In one turn, a player can either add to his score any element from his list (assuming his list is not empty), the element is removed from the list afterward. Or remove an element from his opponent\'s list (assuming his opponent\'s list is not empty).Note, that in case there are equal elements in the list only one of them will be affected in the operations above. For example, if there are elements {1,2,2,3} in a list and you decided to choose 2 for the next turn, only a single instance of 2 will be deleted (and added to the score, if necessary). The player A starts the game and the game stops when both lists are empty. Find the difference between A\'s score and B\'s score at the end of the game, if both of the players are playing optimally.Optimal play between two players means that both players choose the best possible strategy to achieve the best possible outcome for themselves. In this problem, it means that each player, each time makes a move, which maximizes the final difference between his score and his opponent\'s score, knowing that the opponent is doing the same." 1300
1038B "Non-Coprime Partition" "constructive algorithms,math" "Find out if it is possible to partition the first n positive integers into two non-empty disjoint sets S1 and S2 such that:gcd(sum(S1),sum(S2))>1 Here sum(S) denotes the sum of all elements present in set S and gcd means thegreatest common divisor.Every integer number from 1 to n should be present in exactly one of S1 or S2." 1100
1038A Equality implementation,strings "You are given a string s of length n, which consists only of the first k letters of the Latin alphabet. All letters in string s are uppercase.A subsequence of string s is a string that can be derived from s by deleting some of its symbols without changing the order of the remaining symbols. For example, ""ADE"" and ""BD"" are subsequences of ""ABCDE"", but ""DEA"" is not.A subsequence of s called good if the number of occurences of each of the first k letters of the alphabet is the same.Find the length of the longest good subsequence of s." 800
1037H Security "data structures,string suffix structures" "Some programming website is establishing a secure communication protocol. For security reasons, they want to choose several more or less random strings.Initially, they have a string s consisting of lowercase English letters. Now they want to choose q strings using the following steps, and you are to help them.  A string x consisting of lowercase English letters and integers l and r (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s|) are chosen.  Consider all non-empty distinct substrings of the slsl+1\xe2\x80\xa6sr, that is all distinct strings sisi+1\xe2\x80\xa6sj where l\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4r. Among all of them choose all strings that are lexicographically greater than x.  If there are no such strings, you should print \xe2\x88\x921. Otherwise print the lexicographically smallest among them. String a is lexicographically less than string b, if either a is a prefix of b and a\xe2\x89\xa0b, or there exists such a position i (1\xe2\x89\xa4i\xe2\x89\xa4min(|a|,|b|)), such that ai<bi and for all j (1\xe2\x89\xa4j<i) aj=bj. Here |a| denotes the length of the string a." 3200
1037G "A Game on Strings" games "Alice and Bob are playing a game on strings.Initially, they have some string t. In one move the first player selects the character c present in t and erases all it\'s occurrences in t, thus splitting t into many smaller strings. The game then goes independently with each of the strings \xe2\x80\x94 to make the move player selects one of the strings and one of the characters there, deletes all occurrences and adds the remaining string back to the game.Alice always starts the game, and then Alice and Bob take turns making moves. The player who is unable to make a move (because there is no string left) loses.Alice and Bob used to always start with a string s, but recently they found out that this became too boring. Now before each game they choose two integers l and r such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4|s| and play the game with the string slsl+1sl+2\xe2\x80\xa6sr instead.Given the string s and integers l, r for each game. Find who is going to win each game assuming they are smart and are playing optimally." 3200
1037F "Maximum Reduction" "combinatorics,data structures,math" "Given an array a of n integers and an integer k (2\xe2\x89\xa4k\xe2\x89\xa4n), where each element of the array is denoted by ai (0\xe2\x89\xa4i<n). Perform the operation z given below on a and print the value of z(a,k) modulo 109+7.function z(array a, integer k):    if length(a) < k:        return 0    else:        b = empty array        ans = 0        for i = 0 .. (length(a) - k):            temp = a[i]            for j = i .. (i + k - 1):                temp = max(temp, a[j])            append temp to the end of b            ans = ans + temp        return ans + z(b, k)" 2500
1037E Trips graphs "There are n persons who initially don\'t know each other. On each morning, two of them, who were not friends before, become friends.We want to plan a trip for every evening of m days. On each trip, you have to select a group of people that will go on the trip. For every person, one of the following should hold:   Either this person does not go on the trip,  Or at least k of his friends also go on the trip. Note that the friendship is not transitive. That is, if a and b are friends and b and c are friends, it does not necessarily imply that a and c are friends.For each day, find the maximum number of people that can go on the trip on that day." 2200
1037D "Valid BFS?" "dfs and similar,graphs,shortest paths,trees" "The BFS algorithm is defined as follows.  Consider an undirected graph with vertices numbered from 1 to n. Initialize q as a new queue containing only vertex 1, mark the vertex 1 as used.  Extract a vertex v from the head of the queue q.  Print the index of vertex v.  Iterate in arbitrary order through all such vertices u that u is a neighbor of v and is not marked yet as used. Mark the vertex u as used and insert it into the tail of the queue q.  If the queue is not empty, continue from step 2.  Otherwise finish. Since the order of choosing neighbors of each vertex can vary, it turns out that there may be multiple sequences which BFS can print.In this problem you need to check whether a given sequence corresponds to some valid BFS traversal of the given tree starting from vertex 1. The tree is an undirected graph, such that there is exactly one simple path between any two vertices." 1700
1037C Equalize dp,greedy,strings "You are given two binary strings a and b of the same length. You can perform the following two operations on the string a:  Swap any two bits at indices i and j respectively (1\xe2\x89\xa4i,j\xe2\x89\xa4n), the cost of this operation is |i\xe2\x88\x92j|, that is, the absolute difference between i and j.  Select any arbitrary index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and flip (change 0 to 1 or 1 to 0) the bit at this index. The cost of this operation is 1. Find the minimum cost to make the string a equal to b. It is not allowed to modify string b." 1300
1037B "Reach Median" greedy "You are given an array a of n integers and an integer s. It is guaranteed that n is odd.In one operation you can either increase or decrease any single element by one. Calculate the minimum number of operations required to make the median of the array being equal to s.The median of the array with odd length is the value of the element which is located on the middle position after the array is sorted. For example, the median of the array 6,5,8 is equal to 6, since if we sort this array we will get 5,6,8, and 6 is located on the middle position." 1300
1037A Packets "constructive algorithms,greedy,math" "You have n coins, each of the same value of 1.Distribute them into packets such that any amount x (1\xe2\x89\xa4x\xe2\x89\xa4n) can be formed using some (possibly one or all) number of these packets.Each packet may only be used entirely or not used at all. No packet may be used more than once in the formation of the single x, however it may be reused for the formation of other x\'s.Find the minimum number of packets in such a distribution." 1300
1036G "Sources and Sinks" "bitmasks,brute force,dfs and similar" "You are given an acyclic directed graph, consisting of n vertices and m edges. The graph contains no multiple edges and no self-loops.The vertex is called a source if it has no incoming edges. The vertex is called a sink if it has no outgoing edges. These definitions imply that some vertices can be both source and sink.The number of sources in the given graph is equal to the number of sinks in it, and each of these numbers doesn\'t exceed 20.The following algorithm is applied to the graph:  if the graph has no sources and sinks then quit;  choose arbitrary source s, arbitrary sink t, add an edge from t to s to the graph and go to step 1 (that operation pops s out of sources and t out of sinks). Note that s and t may be the same vertex, then a self-loop is added. At the end you check if the graph becomes strongly connected (that is, any vertex is reachable from any other vertex).Your task is to check that the graph becomes strongly connected no matter the choice of sources and sinks on the second step of the algorithm." 2700
1036F "Relatively Prime Powers" "combinatorics,math,number theory" "Consider some positive integer x. Its prime factorization will be of form x=2k1\xe2\x8b\x853k2\xe2\x8b\x855k3\xe2\x8b\x85\xe2\x80\xa6Let\'s call x elegant if the greatest common divisor of the sequence k1,k2,\xe2\x80\xa6 is equal to 1. For example, numbers 5=51, 12=22\xe2\x8b\x853, 72=23\xe2\x8b\x8532 are elegant and numbers 8=23 (GCD=3), 2500=22\xe2\x8b\x8554 (GCD=2) are not.Count the number of elegant integers from 2 to n.Each testcase contains several values of n, for each of them you are required to solve the problem separately." 2400
1036E "Covered Points" "fft,geometry,number theory" "You are given n segments on a Cartesian plane. Each segment\'s endpoints have integer coordinates. Segments can intersect with each other. No two segments lie on the same line.Count the number of distinct points with integer coordinates, which are covered by at least one segment." 2400
1036D "Vasya and Arrays" "greedy,two pointers" "Vasya has two arrays A and B of lengths n and m, respectively.He can perform the following operation arbitrary number of times (possibly zero): he takes some consecutive subsegment of the array and replaces it with a single element, equal to the sum of all elements on this subsegment. For example, from the array [1,10,100,1000,10000] Vasya can obtain array [1,1110,10000], and from array [1,2,3] Vasya can obtain array [6].Two arrays A and B are considered equal if and only if they have the same length and for each valid i Ai=Bi.Vasya wants to perform some of these operations on array A, some on array B, in such a way that arrays A and B become equal. Moreover, the lengths of the resulting arrays should be maximal possible.Help Vasya to determine the maximum length of the arrays that he can achieve or output that it is impossible to make arrays A and B equal." 1600
1036C "Classy Numbers" combinatorics,dp "Let\'s call some positive integer classy if its decimal representation contains no more than 3 non-zero digits. For example, numbers 4, 200000, 10203 are classy and numbers 4231, 102306, 7277420000 are not.You are given a segment [L;R]. Count the number of classy integers x such that L\xe2\x89\xa4x\xe2\x89\xa4R.Each testcase contains several segments, for each of them you are required to solve the problem separately." 1900
1036B "Diagonal Walking v.2" math "Mikhail walks on a Cartesian plane. He starts at the point (0,0), and in one move he can go to any of eight adjacent points. For example, if Mikhail is currently at the point (0,0), he can go to any of the following points in one move:   (1,0);  (1,1);  (0,1);  (\xe2\x88\x921,1);  (\xe2\x88\x921,0);  (\xe2\x88\x921,\xe2\x88\x921);  (0,\xe2\x88\x921);  (1,\xe2\x88\x921). If Mikhail goes from the point (x1,y1) to the point (x2,y2) in one move, and x1\xe2\x89\xa0x2 and y1\xe2\x89\xa0y2, then such a move is called a diagonal move.Mikhail has q queries. For the i-th query Mikhail\'s target is to go to the point (ni,mi) from the point (0,0) in exactly ki moves. Among all possible movements he want to choose one with the maximum number of diagonal moves. Your task is to find the maximum number of diagonal moves or find that it is impossible to go from the point (0,0) to the point (ni,mi) in ki moves.Note that Mikhail can visit any point any number of times (even the destination point!)." 1600
1036A "Function Height" math "You are given a set of 2n+1 integer points on a Cartesian plane. Points are numbered from 0 to 2n inclusive. Let Pi be the i-th point. The x-coordinate of the point Pi equals i. The y-coordinate of the point Pi equals zero (initially). Thus, initially Pi=(i,0).The given points are vertices of a plot of a piecewise function. The j-th piece of the function is the segment PjPj+1.In one move you can increase the y-coordinate of any point with odd x-coordinate (i.e. such points are P1,P3,\xe2\x80\xa6,P2n\xe2\x88\x921) by 1. Note that the corresponding segments also change.For example, the following plot shows a function for n=3 (i.e. number of points is 2\xe2\x8b\x853+1=7) in which we increased the y-coordinate of the point P1 three times and y-coordinate of the point P5 one time:  Let the area of the plot be the area below this plot and above the coordinate axis OX. For example, the area of the plot on the picture above is 4 (the light blue area on the picture above is the area of the plot drawn on it).Let the height of the plot be the maximum y-coordinate among all initial points in the plot (i.e. points P0,P1,\xe2\x80\xa6,P2n). The height of the plot on the picture above is 3.Your problem is to say which minimum possible height can have the plot consisting of 2n+1 vertices and having an area equal to k. Note that it is unnecessary to minimize the number of moves.It is easy to see that any answer which can be obtained by performing moves described above always exists and is an integer number not exceeding 1018." 1000
1034E "Little C Loves 3 III" bitmasks,dp,math "Little C loves number \xc2\xab3\xc2\xbb very much. He loves all things about it.Now he is interested in the following problem:There are two arrays of 2n intergers a0,a1,...,a2n\xe2\x88\x921 and b0,b1,...,b2n\xe2\x88\x921.The task is for each i(0\xe2\x89\xa4i\xe2\x89\xa42n\xe2\x88\x921), to calculate ci=\xe2\x88\x91aj\xe2\x8b\x85bk (j|k=i and j&k=0, where ""|"" denotes bitwise or operation and ""&"" denotes bitwise and operation).It\'s amazing that it can be proved that there are exactly 3n triples (i,j,k), such that j|k=i, j&k=0 and 0\xe2\x89\xa4i,j,k\xe2\x89\xa42n\xe2\x88\x921. So Little C wants to solve this excellent problem (because it\'s well related to 3) excellently.Help him calculate all ci. Little C loves 3 very much, so he only want to know each ci&3." 3200
1034D "Intervals of Intervals" "binary search,data structures,two pointers" "Little D is a friend of Little C who loves intervals very much instead of number ""3"".Now he has n intervals on the number axis, the i-th of which is [ai,bi].Only the n intervals can not satisfy him. He defines the value of an interval of intervals [l,r] (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n, l and r are both integers) as the total length of the union of intervals from the l-th to the r-th.He wants to select exactly k different intervals of intervals such that the sum of their values is maximal. Please help him calculate the maximal sum." 3500
1034C "Region Separation" "combinatorics,dp,number theory,trees" "There are n cities in the Kingdom of Autumn, numbered from 1 to n. People can travel between any two cities using n\xe2\x88\x921 two-directional roads.This year, the government decides to separate the kingdom. There will be regions of different levels. The whole kingdom will be the region of level 1. Each region of i-th level should be separated into several (at least two) regions of i+1-th level, unless i-th level is the last level. Each city should belong to exactly one region of each level and for any two cities in the same region, it should be possible to travel between them passing the cities in the same region only.According to research, for each city i, there is a value ai, which describes the importance of this city. All regions of the same level should have an equal sum of city importances.Your task is to find how many plans there are to determine the separation of the regions that all the conditions are satisfied. Two plans are considered different if and only if their numbers of levels are different or there exist two cities in the same region of one level in one plan but in different regions of this level in the other plan. Since the answer may be very large, output it modulo 109+7." 2700
1034B "Little C Loves 3 II" "brute force,constructive algorithms,flows,graph matchings" "Little C loves number \xc2\xab3\xc2\xbb very much. He loves all things about it.Now he is playing a game on a chessboard of size n\xc3\x97m. The cell in the x-th row and in the y-th column is called (x,y). Initially, The chessboard is empty. Each time, he places two chessmen on two different empty cells, the Manhattan distance between which is exactly 3. The Manhattan distance between two cells (xi,yi) and (xj,yj) is defined as |xi\xe2\x88\x92xj|+|yi\xe2\x88\x92yj|.He want to place as many chessmen as possible on the chessboard. Please help him find the maximum number of chessmen he can place." 2200
1034A "Enlarge GCD" "number theory" "Mr. F has n positive integers, a1,a2,\xe2\x80\xa6,an.He thinks the greatest common divisor of these integers is too small. So he wants to enlarge it by removing some of the integers.But this problem is too simple for him, so he does not want to do it by himself. If you help him, he will give you some scores in reward.Your task is to calculate the minimum number of integers you need to remove so that the greatest common divisor of the remaining integers is bigger than that of all integers." 1800
1033G "Chip Game" games "Alice and Bob decided to play one ultimate game. They have n piles, the i-th pile initially contain vi chips. Alice selects a positive integer a from interval [1,m], and Bob selects a number b the same way. Then the game starts. In her turn, Alice can select any pile containing at least a chips, and remove exactly a chips from it. Similarly, in his turn, Bob can choose any pile with at least b chips, and remove exactly b chips from it. If a player cannot make a move, he or she loses. If both players play optimally, the outcome ultimately depends on the choice of a and b, and on the starting player. Consider a fixed pair (a,b). There are four types of games:   Alice wins, regardless of who starts.  Bob wins, regardless of who starts.  If Alice starts, she wins. If Bob starts, he wins. We say that the first player wins.  If Alice starts, Bob wins. If Bob starts, Alice wins. We say that the second player wins. Among all choices of a and b (i.e. for each pair (a,b) such that 1\xe2\x89\xa4a,b\xe2\x89\xa4m), determine how many games are won by Alice (regardless of who starts), how many are won by Bob (regardless of who starts), how many are won by the first player, and how many are won by the second player." 3500
1033F "Boolean Computer" "bitmasks,brute force,fft,math" "Alice has a computer that operates on w-bit integers. The computer has n registers for values. The current content of the registers is given as an array a1,a2,\xe2\x80\xa6,an. The computer uses so-called ""number gates"" to manipulate this data. Each ""number gate"" takes two registers as inputs and calculates a function of the two values stored in those registers. Note that you can use the same register as both inputs.Each ""number gate"" is assembled from bit gates. There are six types of bit gates: AND, OR, XOR, NOT AND, NOT OR, and NOT XOR, denoted ""A"", ""O"", ""X"", ""a"", ""o"", ""x"", respectively. Each bit gate takes two bits as input. Its output given the input bits b1, b2 is given below: b1b2AOXaox00000111010111001001110011110001 To build a ""number gate"", one takes w bit gates and assembles them into an array. A ""number gate"" takes two w-bit integers x1 and x2 as input. The ""number gate"" splits the integers into w bits and feeds the i-th bit of each input to the i-th bit gate. After that, it assembles the resulting bits again to form an output word. For instance, for 4-bit computer we might have a ""number gate"" ""AXoA"" (AND, XOR, NOT OR, AND). For two inputs, 13=11012 and 10=10102, this returns 12=11002, as 1 and 1 is 1, 1 xor 0 is 1, not (0 or 1) is 0, and finally 1 and 0 is 0. You are given a description of m ""number gates"". For each gate, your goal is to report the number of register pairs for which the ""number gate"" outputs the number 0. In other words, find the number of ordered pairs (i,j) where 1\xe2\x89\xa4i,j\xe2\x89\xa4n, such that wk(ai,aj)=0, where wk is the function computed by the k-th ""number gate""." 2800
1033E "Hidden Bipartite Graph" "binary search,constructive algorithms,dfs and similar,graphs,interactive" "Bob has a simple undirected connected graph (without self-loops and multiple edges). He wants to learn whether his graph is bipartite (that is, you can paint all vertices of the graph into two colors so that there is no edge connecting two vertices of the same color) or not. As he is not very good at programming, he asked Alice for help. He does not want to disclose his graph to Alice, but he agreed that Alice can ask him some questions about the graph.The only question that Alice can ask is the following: she sends s \xe2\x80\x94 a subset of vertices of the original graph. Bob answers with the number of edges that have both endpoints in s. Since he doesn\'t want Alice to learn too much about the graph, he allows her to ask no more than 20000 questions. Furthermore, he suspects that Alice might introduce false messages to their communication channel, so when Alice finally tells him whether the graph is bipartite or not, she also needs to provide a proof \xe2\x80\x94 either the partitions themselves or a cycle of odd length.Your task is to help Alice to construct the queries, find whether the graph is bipartite." 2800
1033D Divisors "interactive,math,number theory" "You are given n integers a1,a2,\xe2\x80\xa6,an. Each of ai has between 3 and 5 divisors. Consider a=\xe2\x88\x8fai \xe2\x80\x94 the product of all input integers. Find the number of divisors of a. As this number may be very large, print it modulo prime number 998244353." 2000
1033C "Permutation Game" "brute force,dp,games" "After a long day, Alice and Bob decided to play a little game. The game board consists of n cells in a straight line, numbered from 1 to n, where each cell contains a number ai between 1 and n. Furthermore, no two cells contain the same number. A token is placed in one of the cells. They take alternating turns of moving the token around the board, with Alice moving first. The current player can move from cell i to cell j only if the following two conditions are satisfied:   the number in the new cell j must be strictly larger than the number in the old cell i (i.e. aj>ai), and  the distance that the token travels during this turn must be a multiple of the number in the old cell (i.e. |i\xe2\x88\x92j|modai=0). Whoever is unable to make a move, loses. For each possible starting position, determine who wins if they both play optimally. It can be shown that the game is always finite, i.e. there always is a winning strategy for one of the players." 1600
1033B "Square Difference" "math,number theory" "Alice has a lovely piece of cloth. It has the shape of a square with a side of length a centimeters. Bob also wants such piece of cloth. He would prefer a square with a side of length b centimeters (where b<a). Alice wanted to make Bob happy, so she cut the needed square out of the corner of her piece and gave it to Bob. Now she is left with an ugly L shaped cloth (see pictures below).Alice would like to know whether the area of her cloth expressed in square centimeters is prime. Could you help her to determine it?" 1100
1033A "King Escape" "dfs and similar,graphs,implementation" "Alice and Bob are playing chess on a huge chessboard with dimensions n\xc3\x97n. Alice has a single piece left \xe2\x80\x94 a queen, located at (ax,ay), while Bob has only the king standing at (bx,by). Alice thinks that as her queen is dominating the chessboard, victory is hers. But Bob has made a devious plan to seize the victory for himself \xe2\x80\x94 he needs to march his king to (cx,cy) in order to claim the victory for himself. As Alice is distracted by her sense of superiority, she no longer moves any pieces around, and it is only Bob who makes any turns.Bob will win if he can move his king from (bx,by) to (cx,cy) without ever getting in check. Remember that a king can move to any of the 8 adjacent squares. A king is in check if it is on the same rank (i.e. row), file (i.e. column), or diagonal as the enemy queen. Find whether Bob can win or not." 1000
1032G Chattering NA "There are n parrots standing in a circle. Each parrot has a certain level of respect among other parrots, namely ri. When a parrot with respect level x starts chattering, x neighbours to the right and to the left of it start repeating the same words in 1 second. Their neighbours then start repeating as well, and so on, until all the birds begin to chatter.You are given the respect levels of all parrots. For each parrot answer a question: if this certain parrot starts chattering, how many seconds will pass until all other birds will start repeating it?" 2900
1032F "Vasya and Maximum Matching" dp,trees "Vasya has got a tree consisting of n vertices. He wants to delete some (possibly zero) edges in this tree such that the maximum matching in the resulting graph is unique. He asks you to calculate the number of ways to choose a set of edges to remove.A matching in the graph is a subset of its edges such that there is no vertex incident to two (or more) edges from the subset. A maximum matching is a matching such that the number of edges in the subset is maximum possible among all matchings in this graph.Since the answer may be large, output it modulo 998244353." 2400
1032E "The Unbearable Lightness of Weights" dp,math "You have a set of n weights. You know that their masses are a1, a2, ..., an grams, but you don\'t know which of them has which mass. You can\'t distinguish the weights.However, your friend does know the mass of each weight. You can ask your friend to give you exactly k weights with the total mass m (both parameters k and m are chosen by you), and your friend will point to any valid subset of weights, if it is possible.You are allowed to make this query only once. Find the maximum possible number of weights you can reveal after this query." 2100
1032D "Barcelonian Distance" geometry,implementation "In this problem we consider a very simplified model of Barcelona city.Barcelona can be represented as a plane with streets of kind x=c and y=c for every integer c (that is, the rectangular grid). However, there is a detail which makes Barcelona different from Manhattan. There is an avenue called Avinguda Diagonal which can be represented as a the set of points (x,y) for which ax+by+c=0.One can walk along streets, including the avenue. You are given two integer points A and B somewhere in Barcelona. Find the minimal possible distance one needs to travel to get to B from A." 1900
1032C "Playing Piano" "constructive algorithms,dp" "Little Paul wants to learn how to play piano. He already has a melody he wants to start with. For simplicity he represented this melody as a sequence a1,a2,\xe2\x80\xa6,an of key numbers: the more a number is, the closer it is to the right end of the piano keyboard.Paul is very clever and knows that the essential thing is to properly assign fingers to notes he\'s going to play. If he chooses an inconvenient fingering, he will then waste a lot of time trying to learn how to play the melody by these fingers and he will probably not succeed.Let\'s denote the fingers of hand by numbers from 1 to 5. We call a fingering any sequence b1,\xe2\x80\xa6,bn of fingers numbers. A fingering is convenient if for all 1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921 the following holds:  if ai<ai+1 then bi<bi+1, because otherwise Paul needs to take his hand off the keyboard to play the (i+1)-st note;  if ai>ai+1 then bi>bi+1, because of the same;  if ai=ai+1 then bi\xe2\x89\xa0bi+1, because using the same finger twice in a row is dumb. Please note that there is \xe2\x89\xa0, not = between bi and bi+1. Please provide any convenient fingering or find out that there is none." 1700
1032B "Personalized Cup" NA "At many competitions that have a word \xc2\xabcup\xc2\xbb in its official name the winner is presented with an actual cup. This time the organizers of one unusual programming competition have decided to please the winner even more and to add a nameplate to the cup with the handle of the winner.The nameplate is to be rectangular and the text on it will be printed as a table of several rows and columns. Having some measurements done, the organizers have found out that the number a of rows cannot be greater than 5 while the number b of columns cannot exceed 20. Every cell of the table will contain either an asterisk (\xc2\xab*\xc2\xbb) or a letter of user\'s handle.Furthermore, the organizers want the rows of the table to be uniform, which means that the number of asterisks used in different rows should differ by at most one (i.e. you can\'t have two asterisks in the first row and none in the second). The main goal, however, is to obtain the winner\'s handle precisely when reading the table from top to bottom and from left to right in every row (skipping asterisks).The organizers want for the nameplate to have as few rows as possible and among all valid tables with the minimum number of rows they want to choose the one that has the minimum number of columns.The winner is not yet determined so your task is to write a program that, given a certain handle, generates the necessary table." 1200
1032A "Kitchen Utensils" NA "The king\'s birthday dinner was attended by k guests. The dinner was quite a success: every person has eaten several dishes (though the number of dishes was the same for every person) and every dish was served alongside with a new set of kitchen utensils.All types of utensils in the kingdom are numbered from 1 to 100. It is known that every set of utensils is the same and consist of different types of utensils, although every particular type may appear in the set at most once. For example, a valid set of utensils can be composed of one fork, one spoon and one knife.After the dinner was over and the guests were dismissed, the king wondered what minimum possible number of utensils could be stolen. Unfortunately, the king has forgotten how many dishes have been served for every guest but he knows the list of all the utensils left after the dinner. Your task is to find the minimum possible number of stolen utensils." 900
1031F "Familiar Operations" "brute force,graphs,math" "You are given two positive integers a and b. There are two possible operations:   multiply one of the numbers by some prime p;  divide one of the numbers on its prime factor p. What is the minimum number of operations required to obtain two integers having the same number of divisors? You are given several such pairs, you need to find the answer for each of them." 2800
1031E "Triple Flips" "constructive algorithms" "You are given an array a of length n that consists of zeros and ones.You can perform the following operation multiple times. The operation consists of two steps:   Choose three integers 1\xe2\x89\xa4x<y<z\xe2\x89\xa4n, that form an arithmetic progression (y\xe2\x88\x92x=z\xe2\x88\x92y).  Flip the values ax,ay,az (i.e. change 1 to 0, change 0 to 1). Determine if it is possible to make all elements of the array equal to zero. If yes, print the operations that lead the the all-zero state. Your solution should not contain more than (\xe2\x8c\x8an3\xe2\x8c\x8b+12) operations. Here \xe2\x8c\x8aq\xe2\x8c\x8b denotes the number q rounded down. We can show that it is possible to make all elements equal to zero in no more than this number of operations whenever it is possible to do so at all." 2600
1031D "Minimum path" greedy "You are given a matrix of size n\xc3\x97n filled with lowercase English letters. You can change no more than k letters in this matrix.Consider all paths from the upper left corner to the lower right corner that move from a cell to its neighboring cell to the right or down. Each path is associated with the string that is formed by all the letters in the cells the path visits. Thus, the length of each string is 2n\xe2\x88\x921.Find the lexicographically smallest string that can be associated with a path after changing letters in at most k cells of the matrix.A string a is lexicographically smaller than a string b, if the first different letter in a and b is smaller in a." 1900
1031C "Cram Time" greedy "In a galaxy far, far away Lesha the student has just got to know that he has an exam in two days. As always, he hasn\'t attended any single class during the previous year, so he decided to spend the remaining time wisely.Lesha knows that today he can study for at most a hours, and he will have b hours to study tomorrow. Note that it is possible that on his planet there are more hours in a day than on Earth. Lesha knows that the quality of his knowledge will only depend on the number of lecture notes he will read. He has access to an infinite number of notes that are enumerated with positive integers, but he knows that he can read the first note in one hour, the second note in two hours and so on. In other words, Lesha can read the note with number k in k hours. Lesha can read the notes in arbitrary order, however, he can\'t start reading a note in the first day and finish its reading in the second day.Thus, the student has to fully read several lecture notes today, spending at most a hours in total, and fully read several lecture notes tomorrow, spending at most b hours in total. What is the maximum number of notes Lesha can read in the remaining time? Which notes should he read in the first day, and which \xe2\x80\x94 in the second?" 1600
1031B "Curiosity Has No Limits" NA "When Masha came to math classes today, she saw two integer sequences of length n\xe2\x88\x921 on the blackboard. Let\'s denote the elements of the first sequence as ai (0\xe2\x89\xa4ai\xe2\x89\xa43), and the elements of the second sequence as bi (0\xe2\x89\xa4bi\xe2\x89\xa43).Masha became interested if or not there is an integer sequence of length n, which elements we will denote as ti (0\xe2\x89\xa4ti\xe2\x89\xa43), so that for every i (1\xe2\x89\xa4i\xe2\x89\xa4n\xe2\x88\x921) the following is true:   ai=ti|ti+1 (where | denotes the bitwise OR operation) and  bi=ti&ti+1 (where & denotes the bitwise AND operation). The question appeared to be too difficult for Masha, so now she asked you to check whether such a sequence ti of length n exists. If it exists, find such a sequence. If there are multiple such sequences, find any of them." 1500
1031A "Golden Plate" implementation,math "You have a plate and you want to add some gilding to it. The plate is a rectangle that we split into w\xc3\x97h cells. There should be k gilded rings, the first one should go along the edge of the plate, the second one \xe2\x80\x94 2 cells away from the edge and so on. Each ring has a width of 1 cell. Formally, the i-th of these rings should consist of all bordering cells on the inner rectangle of size (w\xe2\x88\x924(i\xe2\x88\x921))\xc3\x97(h\xe2\x88\x924(i\xe2\x88\x921)).  The picture corresponds to the third example. Your task is to compute the number of cells to be gilded." 800
1030G "Linear Congruential Generator" "number theory" "You are given a tuple generator f(k)=(f(k)1,f(k)2,\xe2\x80\xa6,f(k)n), where f(k)i=(ai\xe2\x8b\x85f(k\xe2\x88\x921)i+bi)modpi and f(0)=(x1,x2,\xe2\x80\xa6,xn). Here xmody denotes the remainder of x when divided by y. All pi are primes.One can see that with fixed sequences xi, yi, ai the tuples f(k) starting from some index will repeat tuples with smaller indices. Calculate the maximum number of different tuples (from all f(k) for k\xe2\x89\xa50) that can be produced by this generator, if xi, ai, bi are integers in the range [0,pi\xe2\x88\x921] and can be chosen arbitrary. The answer can be large, so print the remainder it gives when divided by 109+7" 2900
1030F "Putting Boxes Together" "data structures" "There is an infinite line consisting of cells. There are n boxes in some cells of this line. The i-th box stands in the cell ai and has weight wi. All ai are distinct, moreover, ai\xe2\x88\x921<ai holds for all valid i.You would like to put together some boxes. Putting together boxes with indices in the segment [l,r] means that you will move some of them in such a way that their positions will form some segment [x,x+(r\xe2\x88\x92l)].In one step you can move any box to a neighboring cell if it isn\'t occupied by another box (i.e. you can choose i and change ai by 1, all positions should remain distinct). You spend wi units of energy moving the box i by one cell. You can move any box any number of times, in arbitrary order.Sometimes weights of some boxes change, so you have queries of two types:   id nw \xe2\x80\x94 weight wid of the box id becomes nw.  l r \xe2\x80\x94 you should compute the minimum total energy needed to put together boxes with indices in [l,r]. Since the answer can be rather big, print the remainder it gives when divided by 1000000007=109+7. Note that the boxes are not moved during the query, you only should compute the answer. Note that you should minimize the answer, not its remainder modulo 109+7. So if you have two possible answers 2\xe2\x8b\x85109+13 and 2\xe2\x8b\x85109+14, you should choose the first one and print 109+6, even though the remainder of the second answer is 0." 2500
1030E "Vasya and Good Sequences" bitmasks,dp "Vasya has a sequence a consisting of n integers a1,a2,\xe2\x80\xa6,an. Vasya may pefrom the following operation: choose some number from the sequence and swap any pair of bits in its binary representation. For example, Vasya can transform number 6 (\xe2\x80\xa6000000001102) into 3 (\xe2\x80\xa6000000000112), 12 (\xe2\x80\xa60000000011002), 1026 (\xe2\x80\xa6100000000102) and many others. Vasya can use this operation any (possibly zero) number of times on any number from the sequence.Vasya names a sequence as good one, if, using operation mentioned above, he can obtain the sequence with bitwise exclusive or of all elements equal to 0.For the given sequence a1,a2,\xe2\x80\xa6,an Vasya\'d like to calculate number of integer pairs (l,r) such that 1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n and sequence al,al+1,\xe2\x80\xa6,ar is good." 2000
1030D "Vasya and Triangle" "geometry,number theory" "Vasya has got three integers n, m and k. He\'d like to find three integer points (x1,y1), (x2,y2), (x3,y3), such that 0\xe2\x89\xa4x1,x2,x3\xe2\x89\xa4n, 0\xe2\x89\xa4y1,y2,y3\xe2\x89\xa4m and the area of the triangle formed by these points is equal to nmk.Help Vasya! Find such points (if it\'s possible). If there are multiple solutions, print any of them." 1800
1030C "Vasya and Golden Ticket" implementation "Recently Vasya found a golden ticket \xe2\x80\x94 a sequence which consists of n digits a1a2\xe2\x80\xa6an. Vasya considers a ticket to be lucky if it can be divided into two or more non-intersecting segments with equal sums. For example, ticket 350178 is lucky since it can be divided into three segments 350, 17 and 8: 3+5+0=1+7=8. Note that each digit of sequence should belong to exactly one segment.Help Vasya! Tell him if the golden ticket he found is lucky or not." 1300
1030B "Vasya and Cornfield" geometry "Vasya owns a cornfield which can be defined with two integers n and d. The cornfield can be represented as rectangle with vertices having Cartesian coordinates (0,d),(d,0),(n,n\xe2\x88\x92d) and (n\xe2\x88\x92d,n).  An example of a cornfield with n=7 and d=2. Vasya also knows that there are m grasshoppers near the field (maybe even inside it). The i-th grasshopper is at the point (xi,yi). Vasya does not like when grasshoppers eat his corn, so for each grasshopper he wants to know whether its position is inside the cornfield (including the border) or outside.Help Vasya! For each grasshopper determine if it is inside the field (including the border)." 1100
1030A "In Search of an Easy Problem" implementation "When preparing a tournament, Codeforces coordinators try treir best to make the first problem as easy as possible. This time the coordinator had chosen some problem and asked n people about their opinions. Each person answered whether this problem is easy or hard.If at least one of these n people has answered that the problem is hard, the coordinator decides to change the problem. For the given responses, check if the problem is easy enough." 800
1029F "Multicolored Markers" "binary search,brute force,math,number theory" "There is an infinite board of square tiles. Initially all tiles are white.Vova has a red marker and a blue marker. Red marker can color a tiles. Blue marker can color b tiles. If some tile isn\'t white then you can\'t use marker of any color on it. Each marker must be drained completely, so at the end there should be exactly a red tiles and exactly b blue tiles across the board.Vova wants to color such a set of tiles that:  they would form a rectangle, consisting of exactly a+b colored tiles;  all tiles of at least one color would also form a rectangle. Here are some examples of correct colorings:  Here are some examples of incorrect colorings:  Among all correct colorings Vova wants to choose the one with the minimal perimeter. What is the minimal perimeter Vova can obtain?It is guaranteed that there exists at least one correct coloring." 2000
1029E "Tree with Small Distances" dp,graphs,greedy "You are given an undirected tree consisting of n vertices. An undirected tree is a connected undirected graph with n\xe2\x88\x921 edges.Your task is to add the minimum number of edges in such a way that the length of the shortest path from the vertex 1 to any other vertex is at most 2. Note that you are not allowed to add loops and multiple edges." 2100
1029D "Concatenated Multiples" implementation,math "You are given an array a, consisting of n positive integers.Let\'s call a concatenation of numbers x and y the number that is obtained by writing down numbers x and y one right after another without changing the order. For example, a concatenation of numbers 12 and 3456 is a number 123456.Count the number of ordered pairs of positions (i,j) (i\xe2\x89\xa0j) in array a such that the concatenation of ai and aj is divisible by k." 1900
1029C "Maximal Intersection" greedy,math,sortings "You are given n segments on a number line; each endpoint of every segment has integer coordinates. Some segments can degenerate to points. Segments can intersect with each other, be nested in each other or even coincide.The intersection of a sequence of segments is such a maximal set of points (not necesserily having integer coordinates) that each point lies within every segment from the sequence. If the resulting set isn\'t empty, then it always forms some continuous segment. The length of the intersection is the length of the resulting segment or 0 in case the intersection is an empty set.For example, the intersection of segments [1;5] and [3;10] is [3;5] (length 2), the intersection of segments [1;5] and [5;7] is [5;5] (length 0) and the intersection of segments [1;5] and [6;6] is an empty set (length 0).Your task is to remove exactly one segment from the given sequence in such a way that the intersection of the remaining (n\xe2\x88\x921) segments has the maximal possible length." 1600
1029B "Creating the Contest" dp,greedy,math "You are given a problemset consisting of n problems. The difficulty of the i-th problem is ai. It is guaranteed that all difficulties are distinct and are given in the increasing order.You have to assemble the contest which consists of some problems of the given problemset. In other words, the contest you have to assemble should be a subset of problems (not necessary consecutive) of the given problemset. There is only one condition that should be satisfied: for each problem but the hardest one (the problem with the maximum difficulty) there should be a problem with the difficulty greater than the difficulty of this problem but not greater than twice the difficulty of this problem. In other words, let ai1,ai2,\xe2\x80\xa6,aip be the difficulties of the selected problems in increasing order. Then for each j from 1 to p\xe2\x88\x921 aij+1\xe2\x89\xa4aij\xe2\x8b\x852 should hold. It means that the contest consisting of only one problem is always valid.Among all contests satisfying the condition above you have to assemble one with the maximum number of problems. Your task is to find this number of problems." 1200
1029A "Many Equal Substrings" implementation,strings "You are given a string t consisting of n lowercase Latin letters and an integer number k.Let\'s define a substring of some string s with indices from l to r as s[l\xe2\x80\xa6r].Your task is to construct such string s of minimum possible length that there are exactly k positions i such that s[i\xe2\x80\xa6i+n\xe2\x88\x921]=t. In other words, your task is to construct such string s of minimum possible length that there are exactly k substrings of s equal to t.It is guaranteed that the answer is always unique." 1300
1028H "Make Square" math "We call an array b1,b2,\xe2\x80\xa6,bm good, if there exist two indices i<j such that bi\xe2\x8b\x85bj is a perfect square.Given an array b1,b2,\xe2\x80\xa6,bm, in one action you can perform one of the following:   multiply any element bi by any prime p;  divide any element bi by prime p, if bi is divisible by p. Let f(b1,b2,\xe2\x80\xa6,bm) be the minimum number of actions needed to make the array b good.You are given an array of n integers a1,a2,\xe2\x80\xa6,an and q queries of the form li,ri. For each query output f(ali,ali+1,\xe2\x80\xa6,ari)." 2900
1028G "Guess the number" dp,interactive "This problem is interactive.You should guess hidden number x which is between 1 and M=10004205361450474, inclusive.You could use up to 5 queries.In each query, you can output an increasing sequence of k\xe2\x89\xa4x integers, each between 1 and M, inclusive, and you will obtain one of the following as an answer:  either the hidden number belongs to your query sequence, in this case you immediately win;  or you will be given where the hidden number is located with respect to your query sequence, that is, either it is less than all numbers from the sequence, greater than all numbers from the sequence, or you will be given such an i that the hidden number x is between the i-th and the (i+1)-st numbers of your sequence. See the interaction section for clarity.Be aware that the interactor is adaptive, i.e. the hidden number can depend on queries the solution makes. However, it is guaranteed that for any solution the interactor works non-distinguishable from the situation when the hidden number is fixed beforehand.Hacks are allowed only with fixed hidden number. A hack is represented by a single integer between 1 and M. In all pretests the hidden number is fixed as well." 3000
1028F "Make Symmetrical" "brute force" "Consider a set of points A, initially it is empty. There are three types of queries:   Insert a point (xi,yi) to A. It is guaranteed that this point does not belong to A at this moment.  Remove a point (xi,yi) from A. It is guaranteed that this point belongs to A at this moment.  Given a point (xi,yi), calculate the minimum number of points required to add to A to make A symmetrical with respect to the line containing points (0,0) and (xi,yi). Note that these points are not actually added to A, i.e. these queries are independent from each other." 2900
1028E "Restore Array" "constructive algorithms" "While discussing a proper problem A for a Codeforces Round, Kostya created a cyclic array of positive integers a1,a2,\xe2\x80\xa6,an. Since the talk was long and not promising, Kostya created a new cyclic array b1,b2,\xe2\x80\xa6,bn so that bi=(aimodai+1), where we take an+1=a1. Here mod is the modulo operation. When the talk became interesting, Kostya completely forgot how array a had looked like. Suddenly, he thought that restoring array a from array b would be an interesting problem (unfortunately, not A)." 2400
1028D "Order book" "combinatorics,data structures,greedy" "Let\'s consider a simplified version of order book of some stock. The order book is a list of orders (offers) from people that want to buy or sell one unit of the stock, each order is described by direction (BUY or SELL) and price.At every moment of time, every SELL offer has higher price than every BUY offer. In this problem no two ever existed orders will have the same price.The lowest-price SELL order and the highest-price BUY order are called the best offers, marked with black frames on the picture below.  The presented order book says that someone wants to sell the product at price 12 and it\'s the best SELL offer because the other two have higher prices. The best BUY offer has price 10. There are two possible actions in this orderbook:  Somebody adds a new order of some direction with some price. Somebody accepts the best possible SELL or BUY offer (makes a deal). It\'s impossible to accept not the best SELL or BUY offer (to make a deal at worse price). After someone accepts the offer, it is removed from the orderbook forever.It is allowed to add new BUY order only with prices less than the best SELL offer (if you want to buy stock for higher price, then instead of adding an order you should accept the best SELL offer). Similarly, one couldn\'t add a new SELL order with price less or equal to the best BUY offer. For example, you can\'t add a new offer ""SELL 20"" if there is already an offer ""BUY 20"" or ""BUY 25"" \xe2\x80\x94 in this case you just accept the best BUY offer.You have a damaged order book log (in the beginning the are no orders in book). Every action has one of the two types: ""ADD p"" denotes adding a new order with price p and unknown direction. The order must not contradict with orders still not removed from the order book.  ""ACCEPT p"" denotes accepting an existing best offer with price p and unknown direction.The directions of all actions are lost. Information from the log isn\'t always enough to determine these directions. Count the number of ways to correctly restore all ADD action directions so that all the described conditions are satisfied at any moment. Since the answer could be large, output it modulo 109+7. If it is impossible to correctly restore directions, then output 0." 2100
1028C Rectangles geometry,implementation,sortings "You are given n rectangles on a plane with coordinates of their bottom left and upper right points. Some (n\xe2\x88\x921) of the given n rectangles have some common point. A point belongs to a rectangle if this point is strictly inside the rectangle or belongs to its boundary.Find any point with integer coordinates that belongs to at least (n\xe2\x88\x921) given rectangles." 1600
1028B "Unnatural Conditions" "constructive algorithms,math" "Let s(x) be sum of digits in decimal representation of positive integer x. Given two integers n and m, find some positive integers a and b such that   s(a)\xe2\x89\xa5n,  s(b)\xe2\x89\xa5n,  s(a+b)\xe2\x89\xa4m." 1200
1028A "Find Square" implementation "Consider a table of size n\xc3\x97m, initially fully white. Rows are numbered 1 through n from top to bottom, columns 1 through m from left to right. Some square inside the table with odd side length was painted black. Find the center of this square." 800
1027G "X-mouse in the Campus" "bitmasks,math,number theory" "The campus has m rooms numbered from 0 to m\xe2\x88\x921. Also the x-mouse lives in the campus. The x-mouse is not just a mouse: each second x-mouse moves from room i to the room i\xe2\x8b\x85xmodm (in fact, it teleports from one room to another since it doesn\'t visit any intermediate room). Starting position of the x-mouse is unknown.You are responsible to catch the x-mouse in the campus, so you are guessing about minimum possible number of traps (one trap in one room) you need to place. You are sure that if the x-mouse enters a trapped room, it immediately gets caught.And the only observation you made is GCD(x,m)=1." 2600
1027F "Session in BSU" "binary search,dfs and similar,dsu,graph matchings,graphs" "Polycarp studies in Berland State University. Soon he will have to take his exam. He has to pass exactly n exams.For the each exam i there are known two days: ai \xe2\x80\x94 day of the first opportunity to pass the exam, bi \xe2\x80\x94 day of the second opportunity to pass the exam (ai<bi). Polycarp can pass at most one exam during each day. For each exam Polycarp chooses by himself which day he will pass this exam. He has to pass all the n exams.Polycarp wants to pass all the exams as soon as possible. Print the minimum index of day by which Polycarp can pass all the n exams, or print -1 if he cannot pass all the exams at all." 2400
1027E "Inverse Coloring" combinatorics,dp,math "You are given a square board, consisting of n rows and n columns. Each tile in it should be colored either white or black.Let\'s call some coloring beautiful if each pair of adjacent rows are either the same or different in every position. The same condition should be held for the columns as well.Let\'s call some coloring suitable if it is beautiful and there is no rectangle of the single color, consisting of at least k tiles.Your task is to count the number of suitable colorings of the board of the given size.Since the answer can be very large, print it modulo 998244353." 2100
1027D "Mouse Hunt" "dfs and similar,graphs" "Medicine faculty of Berland State University has just finished their admission campaign. As usual, about 80% of applicants are girls and majority of them are going to live in the university dormitory for the next 4 (hopefully) years.The dormitory consists of n rooms and a single mouse! Girls decided to set mouse traps in some rooms to get rid of the horrible monster. Setting a trap in room number i costs ci burles. Rooms are numbered from 1 to n.Mouse doesn\'t sit in place all the time, it constantly runs. If it is in room i in second t then it will run to room ai in second t+1 without visiting any other rooms inbetween (i=ai means that mouse won\'t leave room i). It\'s second 0 in the start. If the mouse is in some room with a mouse trap in it, then the mouse get caught into this trap.That would have been so easy if the girls actually knew where the mouse at. Unfortunately, that\'s not the case, mouse can be in any room from 1 to n at second 0.What it the minimal total amount of burles girls can spend to set the traps in order to guarantee that the mouse will eventually be caught no matter the room it started from?" 1700
1027C "Minimum Value Rectangle" greedy "You have n sticks of the given lengths.Your task is to choose exactly four of them in such a way that they can form a rectangle. No sticks can be cut to pieces, each side of the rectangle must be formed by a single stick. No stick can be chosen multiple times. It is guaranteed that it is always possible to choose such sticks.Let S be the area of the rectangle and P be the perimeter of the rectangle. The chosen rectangle should have the value P2S minimal possible. The value is taken without any rounding.If there are multiple answers, print any of them.Each testcase contains several lists of sticks, for each of them you are required to solve the problem separately." 1600
1027B "Numbers on the Chessboard" implementation,math "You are given a chessboard of size n\xc3\x97n. It is filled with numbers from 1 to n2 in the following way: the first \xe2\x8c\x88n22\xe2\x8c\x89 numbers from 1 to \xe2\x8c\x88n22\xe2\x8c\x89 are written in the cells with even sum of coordinates from left to right from top to bottom. The rest n2\xe2\x88\x92\xe2\x8c\x88n22\xe2\x8c\x89 numbers from \xe2\x8c\x88n22\xe2\x8c\x89+1 to n2 are written in the cells with odd sum of coordinates from left to right from top to bottom. The operation \xe2\x8c\x88xy\xe2\x8c\x89 means division x by y rounded up.For example, the left board on the following picture is the chessboard which is given for n=4 and the right board is the chessboard which is given for n=5.  You are given q queries. The i-th query is described as a pair xi,yi. The answer to the i-th query is the number written in the cell xi,yi (xi is the row, yi is the column). Rows and columns are numbered from 1 to n." 1200
1027A "Palindromic Twist" implementation,strings "You are given a string s consisting of n lowercase Latin letters. n is even.For each position i (1\xe2\x89\xa4i\xe2\x89\xa4n) in string s you are required to change the letter on this position either to the previous letter in alphabetic order or to the next one (letters \'a\' and \'z\' have only one of these options). Letter in every position must be changed exactly once.For example, letter \'p\' should be changed either to \'o\' or to \'q\', letter \'a\' should be changed to \'b\' and letter \'z\' should be changed to \'y\'.That way string ""codeforces"", for example, can be changed to ""dpedepqbft"" (\'c\' \xe2\x86\x92 \'d\', \'o\' \xe2\x86\x92 \'p\', \'d\' \xe2\x86\x92 \'e\', \'e\' \xe2\x86\x92 \'d\', \'f\' \xe2\x86\x92 \'e\', \'o\' \xe2\x86\x92 \'p\', \'r\' \xe2\x86\x92 \'q\', \'c\' \xe2\x86\x92 \'b\', \'e\' \xe2\x86\x92 \'f\', \'s\' \xe2\x86\x92 \'t\').String s is called a palindrome if it reads the same from left to right and from right to left. For example, strings ""abba"" and ""zz"" are palindromes and strings ""abca"" and ""zy"" are not.Your goal is to check if it\'s possible to make string s a palindrome by applying the aforementioned changes to every position. Print ""YES"" if string s can be transformed to a palindrome and ""NO"" otherwise.Each testcase contains several strings, for each of them you are required to solve the problem separately." 1000
1025G "Company Acquisitions" "constructive algorithms,math" "There are n startups. Startups can be active or acquired. If a startup is acquired, then that means it has exactly one active startup that it is following. An active startup can have arbitrarily many acquired startups that are following it. An active startup cannot follow any other startup.The following steps happen until there is exactly one active startup. The following sequence of steps takes exactly 1 day.  Two distinct active startups A, B, are chosen uniformly at random.  A fair coin is flipped, and with equal probability, A acquires B or B acquires A (i.e. if A acquires B, then that means B\'s state changes from active to acquired, and its starts following A).  When a startup changes from active to acquired, all of its previously acquired startups become active. For example, the following scenario can happen: Let\'s say A, B are active startups. C, D, E are acquired startups under A, and F, G are acquired startups under B: Active startups are shown in red. If A acquires B, then the state will be A, F, G are active startups. C, D, E, B are acquired startups under A. F and G have no acquired startups:  If instead, B acquires A, then the state will be B, C, D, E are active startups. F, G, A are acquired startups under B. C, D, E have no acquired startups:  You are given the initial state of the startups. For each startup, you are told if it is either acquired or active. If it is acquired, you are also given the index of the active startup that it is following.You\'re now wondering, what is the expected number of days needed for this process to finish with exactly one active startup at the end.It can be shown the expected number of days can be written as a rational number P/Q, where P and Q are co-prime integers, and Q\xe2\x89\xa00(mod109+7). Return the value of P\xe2\x8b\x85Q\xe2\x88\x921 modulo 109+7." 3200
1025F "Disjoint Triangles" geometry "A point belongs to a triangle if it lies inside the triangle or on one of its sides. Two triangles are disjoint if there is no point on the plane that belongs to both triangles.You are given n points on the plane. No two points coincide and no three points are collinear.Find the number of different ways to choose two disjoint triangles with vertices in the given points. Two ways which differ only in order of triangles or in order of vertices inside triangles are considered equal." 2700
1025E "Colored Cubes" "constructive algorithms,implementation,matrices" "Vasya passes all exams! Despite expectations, Vasya is not tired, moreover, he is ready for new challenges. However, he does not want to work too hard on difficult problems.Vasya remembered that he has a not-so-hard puzzle: m colored cubes are placed on a chessboard of size n\xc3\x97n. The fact is that m\xe2\x89\xa4n and all cubes have distinct colors. Each cube occupies exactly one cell. Also, there is a designated cell for each cube on the board, the puzzle is to place each cube on its place. The cubes are fragile, so in one operation you only can move one cube onto one of four neighboring by side cells, if only it is empty. Vasya wants to be careful, so each operation takes exactly one second. Vasya used to train hard for VK Cup Final, so he can focus his attention on the puzzle for at most 3 hours, that is 10800 seconds. Help Vasya find such a sequence of operations that all cubes will be moved onto their designated places, and Vasya won\'t lose his attention." 2700
1025D "Recovering BST" "brute force,dp,math,number theory,trees" "Dima the hamster enjoys nibbling different things: cages, sticks, bad problemsetters and even trees!Recently he found a binary search tree and instinctively nibbled all of its edges, hence messing up the vertices. Dima knows that if Andrew, who has been thoroughly assembling the tree for a long time, comes home and sees his creation demolished, he\'ll get extremely upset. To not let that happen, Dima has to recover the binary search tree. Luckily, he noticed that any two vertices connected by a direct edge had their greatest common divisor value exceed 1.Help Dima construct such a binary search tree or determine that it\'s impossible. The definition and properties of a binary search tree can be found here." 2100
1025C "Plasticine zebra" "constructive algorithms,implementation" "Is there anything better than going to the zoo after a tiresome week at work? No wonder Grisha feels the same while spending the entire weekend accompanied by pretty striped zebras. Inspired by this adventure and an accidentally found plasticine pack (represented as a sequence of black and white stripes), Grisha now wants to select several consequent (contiguous) pieces of alternating colors to create a zebra. Let\'s call the number of selected pieces the length of the zebra.Before assembling the zebra Grisha can make the following operation 0 or more times. He splits the sequence in some place into two parts, then reverses each of them and sticks them together again. For example, if Grisha has pieces in the order ""bwbbw"" (here \'b\' denotes a black strip, and \'w\' denotes a white strip), then he can split the sequence as bw|bbw (here the vertical bar represents the cut), reverse both parts and obtain ""wbwbb"".Determine the maximum possible length of the zebra that Grisha can produce." 1600
1025B "Weakened Common Divisor" "brute force,greedy,number theory" "During the research on properties of the greatest common divisor (GCD) of a set of numbers, Ildar, a famous mathematician, introduced a brand new concept of the weakened common divisor (WCD) of a list of pairs of integers.For a given list of pairs of integers (a1,b1), (a2,b2), ..., (an,bn) their WCD is arbitrary integer greater than 1, such that it divides at least one element in each pair. WCD may not exist for some lists.For example, if the list looks like [(12,15),(25,18),(10,24)], then their WCD can be equal to 2, 3, 5 or 6 (each of these numbers is strictly greater than 1 and divides at least one number in each pair).You\'re currently pursuing your PhD degree under Ildar\'s mentorship, and that\'s why this problem was delegated to you. Your task is to calculate WCD efficiently." 1600
1025A "Doggo Recoloring" implementation,sortings "Panic is rising in the committee for doggo standardization \xe2\x80\x94 the puppies of the new brood have been born multi-colored! In total there are 26 possible colors of puppies in the nature and they are denoted by letters from \'a\' to \'z\' inclusive.The committee rules strictly prohibit even the smallest diversity between doggos and hence all the puppies should be of the same color. Thus Slava, the committee employee, has been assigned the task to recolor some puppies into other colors in order to eliminate the difference and make all the puppies have one common color.Unfortunately, due to bureaucratic reasons and restricted budget, there\'s only one operation Slava can perform: he can choose a color x such that there are currently at least two puppies of color x and recolor all puppies of the color x into some arbitrary color y. Luckily, this operation can be applied multiple times (including zero).For example, if the number of puppies is 7 and their colors are represented as the string ""abababc"", then in one operation Slava can get the results ""zbzbzbc"", ""bbbbbbc"", ""aaaaaac"", ""acacacc"" and others. However, if the current color sequence is ""abababc"", then he can\'t choose x=\'c\' right now, because currently only one puppy has the color \'c\'.Help Slava and the committee determine whether it is possible to standardize all the puppies, i.e. after Slava\'s operations all the puppies should have the same color." 900
1023G Pisces "data structures,flows,trees" "A group of researchers are studying fish population in a natural system of lakes and rivers. The system contains n lakes connected by n\xe2\x88\x921 rivers. Each river has integer length (in kilometers) and can be traversed in both directions. It is possible to travel between any pair of lakes by traversing the rivers (that is, the network of lakes and rivers form a tree).There is an unknown number of indistinguishable fish living in the lakes. On day 1, fish can be at arbitrary lakes. Fish can travel between lakes by swimming the rivers. Each fish can swim a river l kilometers long in any direction in l days. Further, each fish can stay any number of days in any particular lake it visits. No fish ever appear or disappear from the lake system. Each lake can accomodate any number of fish at any time.The researchers made several observations. The j-th of these observations is ""on day dj there were at least fj distinct fish in the lake pj"". Help the researchers in determining the smallest possible total number of fish living in the lake system that doesn\'t contradict the observations." 3400
1023F "Mobile Phone Network" "dfs and similar,dsu,graphs,trees" "You are managing a mobile phone network, and want to offer competitive prices to connect a network.The network has n nodes.Your competitor has already offered some connections between some nodes, with some fixed prices. These connections are bidirectional. There are initially m connections the competitor is offering. The i-th connection your competitor is offering will connect nodes fai and fbi and costs fwi. You have a list of k connections that you want to offer. It is guaranteed that this set of connection does not form any cycle. The j-th of these connections will connect nodes gaj and gbj. These connections are also bidirectional. The cost of these connections have not been decided yet.You can set the prices of these connections to any arbitrary integer value. These prices are set independently for each connection. After setting the prices, the customer will choose such n\xe2\x88\x921 connections that all nodes are connected in a single network and the total cost of chosen connections is minimum possible. If there are multiple ways to choose such networks, the customer will choose an arbitrary one that also maximizes the number of your connections in it.You want to set prices in such a way such that all your k connections are chosen by the customer, and the sum of prices of your connections is maximized.Print the maximum profit you can achieve, or \xe2\x88\x921 if it is unbounded." 2600
1023E "Down or Right" "constructive algorithms,interactive,matrices" "This is an interactive problem.Bob lives in a square grid of size n\xc3\x97n, with rows numbered 1 through n from top to bottom, and columns numbered 1 through n from left to right. Every cell is either allowed or blocked, but you don\'t know the exact description of the grid. You are given only an integer n.Bob can move through allowed cells but only in some limited directions. When Bob is in an allowed cell in the grid, he can move down or right to an adjacent cell, if it is allowed.You can ask at most 4\xe2\x8b\x85n queries of form ""? r1 c1 r2 c2"" (1\xe2\x89\xa4r1\xe2\x89\xa4r2\xe2\x89\xa4n, 1\xe2\x89\xa4c1\xe2\x89\xa4c2\xe2\x89\xa4n). The answer will be ""YES"" if Bob can get from a cell (r1,c1) to a cell (r2,c2), and ""NO"" otherwise. In particular, if one of the two cells (or both) is a blocked cell then the answer is ""NO"" for sure. Since Bob doesn\'t like short trips, you can only ask queries with the manhattan distance between the two cells at least n\xe2\x88\x921, i.e. the following condition must be satisfied: (r2\xe2\x88\x92r1)+(c2\xe2\x88\x92c1)\xe2\x89\xa5n\xe2\x88\x921.It\'s guaranteed that Bob can get from the top-left corner (1,1) to the bottom-right corner (n,n) and your task is to find a way to do it. You should print the answer in form ""! S"" where S is a string of length 2\xe2\x8b\x85n\xe2\x88\x922 consisting of characters \'D\' and \'R\', denoting moves down and right respectively. The down move increases the first coordinate by 1, the right move increases the second coordinate by 1. If there are multiple solutions, any of them will be accepted. You should terminate immediately after printing the solution." 2100
1023D "Array Restoration" "constructive algorithms,data structures" "Initially there was an array a consisting of n integers. Positions in it are numbered from 1 to n.Exactly q queries were performed on the array. During the i-th query some segment (li,ri) (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n) was selected and values of elements on positions from li to ri inclusive got changed to i. The order of the queries couldn\'t be changed and all q queries were applied. It is also known that every position from 1 to n got covered by at least one segment.We could have offered you the problem about checking if some given array (consisting of n integers with values from 1 to q) can be obtained by the aforementioned queries. However, we decided that it will come too easy for you.So the enhancement we introduced to it is the following. Some set of positions (possibly empty) in this array is selected and values of elements on these positions are set to 0.Your task is to check if this array can be obtained by the aforementioned queries. Also if it can be obtained then restore this array.If there are multiple possible arrays then print any of them." 1700
1023C "Bracket Subsequence" greedy "A bracket sequence is a string containing only characters ""("" and "")"". A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)""), and "")("", ""("" and "")"" are not.Subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements.You are given a regular bracket sequence s and an integer number k. Your task is to find a regular bracket sequence of length exactly k such that it is also a subsequence of s.It is guaranteed that such sequence always exists." 1200
1023B "Pair of Toys" math "Tanechka is shopping in the toy shop. There are exactly n toys in the shop for sale, the cost of the i-th toy is i burles. She wants to choose two toys in such a way that their total cost is k burles. How many ways to do that does she have?Each toy appears in the shop exactly once. Pairs (a,b) and (b,a) are considered equal. Pairs (a,b), where a=b, are not allowed." 1000
1023A "Single Wildcard Pattern Matching" "brute force,implementation,strings" "You are given two strings s and t. The string s consists of lowercase Latin letters and at most one wildcard character \'*\', the string t consists only of lowercase Latin letters. The length of the string s equals n, the length of the string t equals m.The wildcard character \'*\' in the string s (if any) can be replaced with an arbitrary sequence (possibly empty) of lowercase Latin letters. No other character of s can be replaced with anything. If it is possible to replace a wildcard character \'*\' in s to obtain a string t, then the string t matches the pattern s.For example, if s=""aba*aba"" then the following strings match it ""abaaba"", ""abacaba"" and ""abazzzaba"", but the following strings do not match: ""ababa"", ""abcaaba"", ""codeforces"", ""aba1aba"", ""aba?aba"".If the given string t matches the given string s, print ""YES"", otherwise print ""NO""." 1200
1020B Badge "brute force,dfs and similar,graphs" "In Summer Informatics School, if a student doesn\'t behave well, teachers make a hole in his badge. And today one of the teachers caught a group of n students doing yet another trick. Let\'s assume that all these students are numbered from 1 to n. The teacher came to student a and put a hole in his badge. The student, however, claimed that the main culprit is some other student pa.After that, the teacher came to student pa and made a hole in his badge as well. The student in reply said that the main culprit was student ppa.This process went on for a while, but, since the number of students was finite, eventually the teacher came to the student, who already had a hole in his badge.After that, the teacher put a second hole in the student\'s badge and decided that he is done with this process, and went to the sauna.You don\'t know the first student who was caught by the teacher. However, you know all the numbers pi. Your task is to find out for every student a, who would be the student with two holes in the badge if the first caught student was a." 1000
1020A "New Building for SIS" math "You are looking at the floor plan of the Summer Informatics School\'s new building. You were tasked with SIS logistics, so you really care about travel time between different locations: it is important to know how long it would take to get from the lecture room to the canteen, or from the gym to the server room.The building consists of n towers, h floors each, where the towers are labeled from 1 to n, the floors are labeled from 1 to h. There is a passage between any two adjacent towers (two towers i and i\xe2\x80\x89+\xe2\x80\x891 for all i: 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) on every floor x, where a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b. It takes exactly one minute to walk between any two adjacent floors of a tower, as well as between any two adjacent towers, provided that there is a passage on that floor. It is not permitted to leave the building. The picture illustrates the first example. You have given k pairs of locations (ta,\xe2\x80\x89fa), (tb,\xe2\x80\x89fb): floor fa of tower ta and floor fb of tower tb. For each pair you need to determine the minimum walking time between these locations." 1000
1019E "Raining season" "data structures,divide and conquer,trees" "By the year 3018, Summer Informatics School has greatly grown. Hotel \xc2\xabBerendeetronik\xc2\xbb has been chosen as a location of the school. The camp consists of n houses with n\xe2\x88\x921 pathways between them. It is possible to reach every house from each other using the pathways.Everything had been perfect until the rains started. The weather forecast promises that rains will continue for m days. A special squad of teachers was able to measure that the i-th pathway, connecting houses ui and vi, before the rain could be passed in bi seconds. Unfortunately, the rain erodes the roads, so with every day the time to pass the road will increase by ai seconds. In other words, on the t-th (from zero) day after the start of the rain, it will take ai\xe2\x8b\x85t+bi seconds to pass through this road.Unfortunately, despite all the efforts of teachers, even in the year 3018 not all the students are in their houses by midnight. As by midnight all students have to go to bed, it is important to find the maximal time between all the pairs of houses for each day, so every student would know the time when he has to run to his house.Find all the maximal times of paths between every pairs of houses after t=0, t=1, ..., t=m\xe2\x88\x921 days." 3200
1019D "Large Triangle" "binary search,geometry,sortings" "There is a strange peculiarity: if you connect the cities of Rostov, Taganrog and Shakhty, peculiarly, you get a triangle\xc2\xabUnbelievable But True\xc2\xbbStudents from many different parts of Russia and abroad come to Summer Informatics School. You marked the hometowns of the SIS participants on a map.Now you decided to prepare an interesting infographic based on this map. The first thing you chose to do is to find three cities on this map, such that they form a triangle with area S." 2700
1019C "Sergey\'s problem" "constructive algorithms,graphs" "Sergey just turned five years old! When he was one year old, his parents gave him a number; when he was two years old, his parents gave him an array of integers. On his third birthday he received a string. When he was four, his mother woke him up in a quiet voice, wished him to be a good boy and gave him a rooted tree. Today he celebrates his birthday again! He found a directed graph without loops as a present from his parents.Since Sergey is a very curious boy, he immediately came up with a thing to do. He decided to find a set Q of vertices in this graph, such that no two vertices x,y\xe2\x88\x88Q are connected by an edge, and it is possible to reach any vertex z\xe2\x88\x89Q from some vertex of Q in no more than two moves.  After a little thought, Sergey was able to solve this task. Can you solve it too?A vertex y is reachable from a vertex x in at most two moves if either there is a directed edge (x,y), or there exist two directed edges (x,z) and (z,y) for some vertex z." 3000
1019B "The hat" "binary search,interactive" "This is an interactive problem.Imur Ishakov decided to organize a club for people who love to play the famous game \xc2\xabThe hat\xc2\xbb. The club was visited by n students, where n is even. Imur arranged them all in a circle and held a draw to break the students in pairs, but something went wrong. The participants are numbered so that participant i and participant i\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x891) are adjacent, as well as participant n and participant 1. Each student was given a piece of paper with a number in such a way, that for every two adjacent students, these numbers differ exactly by one. The plan was to form students with the same numbers in a pair, but it turned out that not all numbers appeared exactly twice.As you know, the most convenient is to explain the words to the partner when he is sitting exactly across you. Students with numbers i and  sit across each other. Imur is wondering if there are two people sitting across each other with the same numbers given. Help him to find such pair of people if it exists.You can ask questions of form \xc2\xabwhich number was received by student i?\xc2\xbb, and the goal is to determine whether the desired pair exists in no more than 60 questions." 2000
1019A Elections "brute force,greedy" "As you know, majority of students and teachers of Summer Informatics School live in Berland for the most part of the year. Since corruption there is quite widespread, the following story is not uncommon.Elections are coming. You know the number of voters and the number of parties \xe2\x80\x94 n and m respectively. For each voter you know the party he is going to vote for. However, he can easily change his vote given a certain amount of money. In particular, if you give i-th voter ci bytecoins you can ask him to vote for any other party you choose.The United Party of Berland has decided to perform a statistical study \xe2\x80\x94 you need to calculate the minimum number of bytecoins the Party needs to spend to ensure its victory. In order for a party to win the elections, it needs to receive strictly more votes than any other party." 1700
1017H "The Films" "brute force" "In ""The Man in the High Castle"" world, there are m different film endings. Abendsen owns a storage and a shelf. At first, he has n ordered films on the shelf. In the i-th month he will do: Empty the storage. Put ki\xe2\x8b\x85m films into the storage, ki films for each ending. He will think about a question: if he puts all the films from the shelf into the storage, then randomly picks n films (from all the films in the storage) and rearranges them on the shelf, what is the probability that sequence of endings in [li,ri] on the shelf will not be changed? Notice, he just thinks about this question, so the shelf will not actually be changed.Answer all Abendsen\'s questions.Let the probability be fraction Pi. Let\'s say that the total number of ways to take n films from the storage for i-th month is Ai, so Pi\xe2\x8b\x85Ai is always an integer. Print for each month Pi\xe2\x8b\x85Ai(mod998244353).998244353 is a prime number and it is equal to 119\xe2\x8b\x85223+1.It is guaranteed that there will be only no more than 100 different k values." 3300
1017G "The Tree" "data structures" "Abendsen assigned a mission to Juliana. In this mission, Juliana has a rooted tree with n vertices. Vertex number 1 is the root of this tree. Each vertex can be either black or white. At first, all vertices are white. Juliana is asked to process q queries. Each query is one of three types:  If vertex v is white, mark it as black; otherwise, perform this operation on all direct sons of v instead.  Mark all vertices in the subtree of v (including v) as white.  Find the color of the i-th vertex.   An example of operation ""1 1"" (corresponds to the first example test). The vertices 1 and 2 are already black, so the operation goes to their sons instead. Can you help Juliana to process all these queries?" 3200
1017F "The Neutral Zone" "brute force,math" "Notice: unusual memory limit!After the war, destroyed cities in the neutral zone were restored. And children went back to school.The war changed the world, as well as education. In those hard days, a new math concept was created.As we all know, logarithm function can be described as: log(pa11pa22...pa2k)=a1logp1+a2logp2+...+aklogpk Where pa11pa22...pa2k is the prime factorization of a integer. A problem is that the function uses itself in the definition. That is why it is hard to calculate.So, the mathematicians from the neutral zone invented this: exlogf(pa11pa22...pa2k)=a1f(p1)+a2f(p2)+...+akf(pk)Notice that exlogf(1) is always equal to 0.This concept for any function f was too hard for children. So teachers told them that f can only be a polynomial of degree no more than 3 in daily uses (i.e., f(x)=Ax3+Bx2+Cx+D).""Class is over! Don\'t forget to do your homework!"" Here it is: n\xe2\x88\x91i=1exlogf(i)Help children to do their homework. Since the value can be very big, you need to find the answer modulo 232." 2500
1017E "The Supersonic Rocket" geometry,hashing,strings "After the war, the supersonic rocket became the most common public transportation.Each supersonic rocket consists of two ""engines"". Each engine is a set of ""power sources"". The first engine has n power sources, and the second one has m power sources. A power source can be described as a point (xi,yi) on a 2-D plane. All points in each engine are different.You can manipulate each engine separately. There are two operations that you can do with each engine. You can do each operation as many times as you want. For every power source as a whole in that engine: (xi,yi) becomes (xi+a,yi+b), a and b can be any real numbers. In other words, all power sources will be shifted. For every power source as a whole in that engine: (xi,yi) becomes (xicos\xce\xb8\xe2\x88\x92yisin\xce\xb8,xisin\xce\xb8+yicos\xce\xb8), \xce\xb8 can be any real number. In other words, all power sources will be rotated.The engines work as follows: after the two engines are powered, their power sources are being combined (here power sources of different engines may coincide). If two power sources A(xa,ya) and B(xb,yb) exist, then for all real number k that 0<k<1, a new power source will be created Ck(kxa+(1\xe2\x88\x92k)xb,kya+(1\xe2\x88\x92k)yb). Then, this procedure will be repeated again with all new and old power sources. After that, the ""power field"" from all power sources will be generated (can be considered as an infinite set of all power sources occurred).A supersonic rocket is ""safe"" if and only if after you manipulate the engines, destroying any power source and then power the engine, the power field generated won\'t be changed (comparing to the situation where no power source erased). Two power fields are considered the same if and only if any power source in one field belongs to the other one as well.Given a supersonic rocket, check whether it is safe or not." 2400
1017D "The Wu" "bitmasks,brute force,data structures" "Childan is making up a legendary story and trying to sell his forgery \xe2\x80\x94 a necklace with a strong sense of ""Wu"" to the Kasouras. But Mr. Kasoura is challenging the truth of Childan\'s story. So he is going to ask a few questions about Childan\'s so-called ""personal treasure"" necklace.This ""personal treasure"" is a multiset S of m ""01-strings"".A ""01-string"" is a string that contains n characters ""0"" and ""1"". For example, if n=4, strings ""0110"", ""0000"", and ""1110"" are ""01-strings"", but ""00110"" (there are 5 characters, not 4) and ""zero"" (unallowed characters) are not.Note that the multiset S can contain equal elements.Frequently, Mr. Kasoura will provide a ""01-string"" t and ask Childan how many strings s are in the multiset S such that the ""Wu"" value of the pair (s,t) is not greater than k. Mrs. Kasoura and Mr. Kasoura think that if si=ti (1\xe2\x89\xa4i\xe2\x89\xa4n) then the ""Wu"" value of the character pair equals to wi, otherwise 0. The ""Wu"" value of the ""01-string"" pair is the sum of the ""Wu"" values of every character pair. Note that the length of every ""01-string"" is equal to n.For example, if w=[4,5,3,6], ""Wu"" of (""1001"", ""1100"") is 7 because these strings have equal characters only on the first and third positions, so w1+w3=4+3=7.You need to help Childan to answer Mr. Kasoura\'s queries. That is to find the number of strings in the multiset S such that the ""Wu"" value of the pair is not greater than k." 1900
1017C "The Phone Number" "constructive algorithms,greedy" "Mrs. Smith is trying to contact her husband, John Smith, but she forgot the secret phone number!The only thing Mrs. Smith remembered was that any permutation of n can be a secret phone number. Only those permutations that minimize secret value might be the phone of her husband.The sequence of n integers is called a permutation if it contains all integers from 1 to n exactly once.The secret value of a phone number is defined as the sum of the length of the longest increasing subsequence (LIS) and length of the longest decreasing subsequence (LDS). A subsequence ai1,ai2,\xe2\x80\xa6,aik where 1\xe2\x89\xa4i1<i2<\xe2\x80\xa6<ik\xe2\x89\xa4n is called increasing if ai1<ai2<ai3<\xe2\x80\xa6<aik. If ai1>ai2>ai3>\xe2\x80\xa6>aik, a subsequence is called decreasing. An increasing/decreasing subsequence is called longest if it has maximum length among all increasing/decreasing subsequences.For example, if there is a permutation [6,4,1,7,2,3,5], LIS of this permutation will be [1,2,3,5], so the length of LIS is equal to 4. LDS can be [6,4,1], [6,4,2], or [6,4,3], so the length of LDS is 3.Note, the lengths of LIS and LDS can be different.So please help Mrs. Smith to find a permutation that gives a minimum sum of lengths of LIS and LDS." 1600
1017B "The Bits" implementation,math "Rudolf is on his way to the castle. Before getting into the castle, the security staff asked him a question:Given two binary numbers a and b of length n. How many different ways of swapping two digits in a (only in a, not b) so that bitwise OR of these two numbers will be changed? In other words, let c be the bitwise OR of a and b, you need to find the number of ways of swapping two bits in a so that bitwise OR will not be equal to c.Note that binary numbers can contain leading zeros so that length of each number is exactly n.Bitwise OR is a binary operation. A result is a binary number which contains a one in each digit if there is a one in at least one of the two numbers. For example, 010102 OR 100112 = 110112.Well, to your surprise, you are not Rudolf, and you don\'t need to help him\xe2\x80\xa6 You are the security staff! Please find the number of ways of swapping two bits in a so that bitwise OR will be changed." 1200
1017A "The Rank" implementation "John Smith knows that his son, Thomas Smith, is among the best students in his class and even in his school. After the students of the school took the exams in English, German, Math, and History, a table of results was formed.There are n students, each of them has a unique id (from 1 to n). Thomas\'s id is 1. Every student has four scores correspond to his or her English, German, Math, and History scores. The students are given in order of increasing of their ids.In the table, the students will be sorted by decreasing the sum of their scores. So, a student with the largest sum will get the first place. If two or more students have the same sum, these students will be sorted by increasing their ids. Please help John find out the rank of his son." 800
1016G "Appropriate Team" "bitmasks,math,number theory" "Since next season are coming, you\'d like to form a team from two or three participants. There are n candidates, the i-th candidate has rank ai. But you have weird requirements for your teammates: if you have rank v and have chosen the i-th and j-th candidate, then GCD(v,ai)=X and LCM(v,aj)=Y must be met.You are very experienced, so you can change your rank to any non-negative integer but X and Y are tied with your birthdate, so they are fixed.Now you want to know, how many are there pairs (i,j) such that there exists an integer v meeting the following constraints: GCD(v,ai)=X and LCM(v,aj)=Y. It\'s possible that i=j and you form a team of two.GCD is the greatest common divisor of two number, LCM \xe2\x80\x94 the least common multiple." 2700
1016F "Road Projects" "dfs and similar,dp,trees" "There are n cities in the country of Berland. Some of them are connected by bidirectional roads in such a way that there exists exactly one path, which visits each road no more than once, between every pair of cities. Each road has its own length. Cities are numbered from 1 to n.The travelling time between some cities v and u is the total length of the roads on the shortest path from v to u. The two most important cities in Berland are cities 1 and n.The Berland Ministry of Transport decided to build a single new road to decrease the traffic between the most important cities. However, lots of people are used to the current travelling time between the most important cities, so the new road shouldn\'t change it too much. The new road can only be built between such cities v and u that v\xe2\x89\xa0u and v and u aren\'t already connected by some road.They came up with m possible projects. Each project is just the length x of the new road.Polycarp works as a head analyst at the Berland Ministry of Transport and it\'s his job to deal with all those m projects. For the i-th project he is required to choose some cities v and u to build the new road of length xi between such that the travelling time between the most important cities is maximal possible. Unfortunately, Polycarp is not a programmer and no analyst in the world is capable to process all projects using only pen and paper. Thus, he asks you to help him to calculate the maximal possible travelling time between the most important cities for each project. Note that the choice of v and u can differ for different projects." 2600
1016E "Rest In The Shades" "binary search,geometry" "There is a light source on the plane. This source is so small that it can be represented as point. The light source is moving from point (a,sy) to the (b,sy) (sy<0) with speed equal to 1 unit per second. The trajectory of this light source is a straight segment connecting these two points. There is also a fence on OX axis represented as n segments (li,ri) (so the actual coordinates of endpoints of each segment are (li,0) and (ri,0)). The point (x,y) is in the shade if segment connecting (x,y) and the current position of the light source intersects or touches with any segment of the fence.  You are given q points. For each point calculate total time of this point being in the shade, while the light source is moving from (a,sy) to the (b,sy)." 2400
1016D "Vasya And The Matrix" "constructive algorithms,flows,math" "Now Vasya is taking an exam in mathematics. In order to get a good mark, Vasya needs to guess the matrix that the teacher has constructed!Vasya knows that the matrix consists of n rows and m columns. For each row, he knows the xor (bitwise excluding or) of the elements in this row. The sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an denotes the xor of elements in rows with indices 1, 2, ..., n, respectively. Similarly, for each column, he knows the xor of the elements in this column. The sequence b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm denotes the xor of elements in columns with indices 1, 2, ..., m, respectively.Help Vasya! Find a matrix satisfying the given constraints or tell him that there is no suitable matrix." 1800
1016C "Vasya And The Mushrooms" dp,implementation "Vasya\'s house is situated in a forest, and there is a mushroom glade near it. The glade consists of two rows, each of which can be divided into n consecutive cells. For each cell Vasya knows how fast the mushrooms grow in this cell (more formally, how many grams of mushrooms grow in this cell each minute). Vasya spends exactly one minute to move to some adjacent cell. Vasya cannot leave the glade. Two cells are considered adjacent if they share a common side. When Vasya enters some cell, he instantly collects all the mushrooms growing there.Vasya begins his journey in the left upper cell. Every minute Vasya must move to some adjacent cell, he cannot wait for the mushrooms to grow. He wants to visit all the cells exactly once and maximize the total weight of the collected mushrooms. Initially, all mushrooms have a weight of 0. Note that Vasya doesn\'t need to return to the starting cell.Help Vasya! Calculate the maximum total weight of mushrooms he can collect." 1800
1016B "Segment Occurrences" "brute force,implementation" "You are given two strings s and t, both consisting only of lowercase Latin letters.The substring s[l..r] is the string which is obtained by taking characters sl,sl+1,\xe2\x80\xa6,sr without changing the order.Each of the occurrences of string a in a string b is a position i (1\xe2\x89\xa4i\xe2\x89\xa4|b|\xe2\x88\x92|a|+1) such that b[i..i+|a|\xe2\x88\x921]=a (|a| is the length of string a).You are asked q queries: for the i-th query you are required to calculate the number of occurrences of string t in a substring s[li..ri]." 1300
1016A "Death Note" greedy,implementation,math "You received a notebook which is called Death Note. This notebook has infinite number of pages. A rule is written on the last page (huh) of this notebook. It says: ""You have to write names in this notebook during n consecutive days. During the i-th day you have to write exactly ai names."". You got scared (of course you got scared, who wouldn\'t get scared if he just receive a notebook which is named Death Note with a some strange rule written in it?).Of course, you decided to follow this rule. When you calmed down, you came up with a strategy how you will write names in the notebook. You have calculated that each page of the notebook can contain exactly m names. You will start writing names from the first page. You will write names on the current page as long as the limit on the number of names on this page is not exceeded. When the current page is over, you turn the page. Note that you always turn the page when it ends, it doesn\'t matter if it is the last day or not. If after some day the current page still can hold at least one name, during the next day you will continue writing the names from the current page.Now you are interested in the following question: how many times will you turn the page during each day? You are interested in the number of pages you will turn each day from 1 to n." 900
1015F "Bracket Substring" dp,strings "You are given a bracket sequence s (not necessarily a regular one). A bracket sequence is a string containing only characters \'(\' and \')\'.A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters \'1\' and \'+\' between the original characters of the sequence. For example, bracket sequences ""()()"" and ""(())"" are regular (the resulting expressions are: ""(1)+(1)"" and ""((1+1)+1)""), and "")("", ""("" and "")"" are not.Your problem is to calculate the number of regular bracket sequences of length 2n containing the given bracket sequence s as a substring (consecutive sequence of characters) modulo 109+7 (1000000007)." 2300
1015E2 "Stars Drawing (Hard Edition)" "binary search,dp,greedy" "A star is a figure of the following type: an asterisk character \'*\' in the center of the figure and four rays (to the left, right, top, bottom) of the same positive length. The size of a star is the length of its rays. The size of a star must be a positive number (i.e. rays of length 0 are not allowed).Let\'s consider empty cells are denoted by \'.\', then the following figures are stars:  The leftmost figure is a star of size 1, the middle figure is a star of size 2 and the rightmost figure is a star of size 3. You are given a rectangular grid of size n\xc3\x97m consisting only of asterisks \'*\' and periods (dots) \'.\'. Rows are numbered from 1 to n, columns are numbered from 1 to m. Your task is to draw this grid using any number of stars or find out that it is impossible. Stars can intersect, overlap or even coincide with each other. The number of stars in the output can\'t exceed n\xe2\x8b\x85m. Each star should be completely inside the grid. You can use stars of same and arbitrary sizes.In this problem, you do not need to minimize the number of stars. Just find any way to draw the given grid with at most n\xe2\x8b\x85m stars." 1900
1015E1 "Stars Drawing (Easy Edition)" "brute force,dp,greedy" "A star is a figure of the following type: an asterisk character \'*\' in the center of the figure and four rays (to the left, right, top, bottom) of the same positive length. The size of a star is the length of its rays. The size of a star must be a positive number (i.e. rays of length 0 are not allowed).Let\'s consider empty cells are denoted by \'.\', then the following figures are stars:  The leftmost figure is a star of size 1, the middle figure is a star of size 2 and the rightmost figure is a star of size 3. You are given a rectangular grid of size n\xc3\x97m consisting only of asterisks \'*\' and periods (dots) \'.\'. Rows are numbered from 1 to n, columns are numbered from 1 to m. Your task is to draw this grid using any number of stars or find out that it is impossible. Stars can intersect, overlap or even coincide with each other. The number of stars in the output can\'t exceed n\xe2\x8b\x85m. Each star should be completely inside the grid. You can use stars of same and arbitrary sizes.In this problem, you do not need to minimize the number of stars. Just find any way to draw the given grid with at most n\xe2\x8b\x85m stars." 1700
1015D "Walking Between Houses" "constructive algorithms,greedy" "There are n houses in a row. They are numbered from 1 to n in order from left to right. Initially you are in the house 1.You have to perform k moves to other house. In one move you go from your current house to some other house. You can\'t stay where you are (i.e., in each move the new house differs from the current house). If you go from the house x to the house y, the total distance you walked increases by |x\xe2\x88\x92y| units of distance, where |a| is the absolute value of a. It is possible to visit the same house multiple times (but you can\'t visit the same house in sequence).Your goal is to walk exactly s units of distance in total.If it is impossible, print ""NO"". Otherwise print ""YES"" and any of the ways to do that. Remember that you should do exactly k moves." 1600
1015C "Songs Compression" sortings "Ivan has n songs on his phone. The size of the i-th song is ai bytes. Ivan also has a flash drive which can hold at most m bytes in total. Initially, his flash drive is empty.Ivan wants to copy all n songs to the flash drive. He can compress the songs. If he compresses the i-th song, the size of the i-th song reduces from ai to bi bytes (bi<ai).Ivan can compress any subset of the songs (possibly empty) and copy all the songs to his flash drive if the sum of their sizes is at most m. He can compress any subset of the songs (not necessarily contiguous).Ivan wants to find the minimum number of songs he needs to compress in such a way that all his songs fit on the drive (i.e. the sum of their sizes is less than or equal to m).If it is impossible to copy all the songs (even if Ivan compresses all the songs), print ""-1"". Otherwise print the minimum number of songs Ivan needs to compress." 1100
1015B "Obtaining the String" implementation "You are given two strings s and t. Both strings have length n and consist of lowercase Latin letters. The characters in the strings are numbered from 1 to n.You can successively perform the following move any number of times (possibly, zero):  swap any two adjacent (neighboring) characters of s (i.e. for any i={1,2,\xe2\x80\xa6,n\xe2\x88\x921} you can swap si and si+1). You can\'t apply a move to the string t. The moves are applied to the string s one after another.Your task is to obtain the string t from the string s. Find any way to do it with at most 104 such moves.You do not have to minimize the number of moves, just find any sequence of moves of length 104 or less to transform s into t." 1200
1015A "Points in Segments" implementation "You are given a set of n segments on the axis Ox, each segment has integer endpoints between 1 and m inclusive. Segments may intersect, overlap or even coincide with each other. Each segment is characterized by two integers li and ri (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4m) \xe2\x80\x94 coordinates of the left and of the right endpoints. Consider all integer points between 1 and m inclusive. Your task is to print all such points that don\'t belong to any segment. The point x belongs to the segment [l;r] if and only if l\xe2\x89\xa4x\xe2\x89\xa4r." 800
1013B And greedy "There is an array with n elements a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an and the number x.In one operation you can select some i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) and replace element ai with ai\xe2\x80\x89&\xe2\x80\x89x, where & denotes the bitwise and operation.You want the array to have at least two equal elements after applying some operations (possibly, none). In other words, there should be at least two distinct indices i\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89j such that ai\xe2\x80\x89=\xe2\x80\x89aj. Determine whether it is possible to achieve and, if possible, the minimal number of operations to apply." 1200
1013A "Piles With Stones" math "There is a beautiful garden of stones in Innopolis.Its most beautiful place is the n piles with stones numbered from 1 to n.EJOI participants have visited this place twice. When they first visited it, the number of stones in piles was x1,x2,\xe2\x80\xa6,xn, correspondingly. One of the participants wrote down this sequence in a notebook. They visited it again the following day, and the number of stones in piles was equal to y1,y2,\xe2\x80\xa6,yn. One of the participants also wrote it down in a notebook.It is well known that every member of the EJOI jury during the night either sits in the room 108 or comes to the place with stones. Each jury member who comes there either takes one stone for himself or moves one stone from one pile to another. We can assume that there is an unlimited number of jury members. No one except the jury goes to the place with stones at night.Participants want to know whether their notes can be correct or they are sure to have made a mistake." 800
1012F Passports dp,implementation "Gleb is a famous competitive programming teacher from Innopolis. He is planning a trip to N programming camps in the nearest future. Each camp will be held in a different country. For each of them, Gleb needs to apply for a visa. For each of these trips Gleb knows three integers: the number of the first day of the trip si, the length of the trip in days leni, and the number of days ti this country\'s consulate will take to process a visa application and stick a visa in a passport. Gleb has P (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89P\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892) valid passports and is able to decide which visa he wants to put in which passport.For each trip, Gleb will have a flight to that country early in the morning of the day si and will return back late in the evening of the day si\xe2\x80\x89+\xe2\x80\x89leni\xe2\x80\x89-\xe2\x80\x891.To apply for a visa on the day d, Gleb needs to be in Innopolis in the middle of this day. So he can\'t apply for a visa while he is on a trip, including the first and the last days. If a trip starts the next day after the end of the other one, Gleb can\'t apply for a visa between them as well. The earliest Gleb can apply for a visa is day 1.After applying for a visa of country i on day d, Gleb will get his passport back in the middle of the day d\xe2\x80\x89+\xe2\x80\x89ti. Consulates use delivery services, so Gleb can get his passport back even if he is not in Innopolis on this day. Gleb can apply for another visa on the same day he received his passport back, if he is in Innopolis this day. Gleb will not be able to start his trip on day si if he doesn\'t has a passport with a visa for the corresponding country in the morning of day si. In particular, the passport should not be in another country\'s consulate for visa processing.Help Gleb to decide which visas he needs to receive in which passport, and when he should apply for each visa." 3400
1012E "Cycle sort" dsu,math "You are given an array of n positive integers a1,a2,\xe2\x80\xa6,an. You can perform the following operation any number of times: select several distinct indices i1,i2,\xe2\x80\xa6,ik (1\xe2\x89\xa4ij\xe2\x89\xa4n) and move the number standing at the position i1 to the position i2, the number at the position i2 to the position i3, ..., the number at the position ik to the position i1. In other words, the operation cyclically shifts elements: i1\xe2\x86\x92i2\xe2\x86\x92\xe2\x80\xa6ik\xe2\x86\x92i1.For example, if you have n=4, an array a1=10,a2=20,a3=30,a4=40, and you choose three indices i1=2, i2=1, i3=4, then the resulting array would become a1=20,a2=40,a3=30,a4=10.Your goal is to make the array sorted in non-decreasing order with the minimum number of operations. The additional constraint is that the sum of cycle lengths over all operations should be less than or equal to a number s. If it\'s impossible to sort the array while satisfying that constraint, your solution should report that as well." 3100
1012D AB-Strings "constructive algorithms,strings" "There are two strings s and t, consisting only of letters a and b. You can make the following operation several times: choose a prefix of s, a prefix of t and swap them. Prefixes can be empty, also a prefix can coincide with a whole string. Your task is to find a sequence of operations after which one of the strings consists only of a letters and the other consists only of b letters. The number of operations should be minimized." 2800
1012C Hills dp "Welcome to Innopolis city. Throughout the whole year, Innopolis citizens suffer from everlasting city construction. From the window in your room, you see the sequence of n hills, where i-th of them has height ai. The Innopolis administration wants to build some houses on the hills. However, for the sake of city appearance, a house can be only built on the hill, which is strictly higher than neighbouring hills (if they are present). For example, if the sequence of heights is 5,\xe2\x80\x894,\xe2\x80\x896,\xe2\x80\x892, then houses could be built on hills with heights 5 and 6 only.The Innopolis administration has an excavator, that can decrease the height of an arbitrary hill by one in one hour. The excavator can only work on one hill at a time. It is allowed to decrease hills up to zero height, or even to negative values. Increasing height of any hill is impossible. The city administration wants to build k houses, so there must be at least k hills that satisfy the condition above. What is the minimum time required to adjust the hills to achieve the administration\'s plan?However, the exact value of k is not yet determined, so could you please calculate answers for all k in range ? Here  denotes n divided by two, rounded up." 1900
1012B "Chemical table" "constructive algorithms,dfs and similar,dsu,graphs,matrices" "Innopolis University scientists continue to investigate the periodic table. There are n\xc2\xb7m known elements and they form a periodic table: a rectangle with n rows and m columns. Each element can be described by its coordinates (r,\xe2\x80\x89c) (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89m) in the table.Recently scientists discovered that for every four different elements in this table that form a rectangle with sides parallel to the sides of the table, if they have samples of three of the four elements, they can produce a sample of the fourth element using nuclear fusion. So if we have elements in positions (r1,\xe2\x80\x89c1), (r1,\xe2\x80\x89c2), (r2,\xe2\x80\x89c1), where r1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89r2 and c1\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89c2, then we can produce element (r2,\xe2\x80\x89c2).  Samples used in fusion are not wasted and can be used again in future fusions. Newly crafted elements also can be used in future fusions.Innopolis University scientists already have samples of q elements. They want to obtain samples of all n\xc2\xb7m elements. To achieve that, they will purchase some samples from other laboratories and then produce all remaining elements using an arbitrary number of nuclear fusions in some order. Help them to find the minimal number of elements they need to purchase." 1900
1012A "Photo of The Sky" "brute force,implementation,math,sortings" "Pavel made a photo of his favourite stars in the sky. His camera takes a photo of all points of the sky that belong to some rectangle with sides parallel to the coordinate axes.Strictly speaking, it makes a photo of all points with coordinates (x,y), such that x1\xe2\x89\xa4x\xe2\x89\xa4x2 and y1\xe2\x89\xa4y\xe2\x89\xa4y2, where (x1,y1) and (x2,y2) are coordinates of the left bottom and the right top corners of the rectangle being photographed. The area of this rectangle can be zero.After taking the photo, Pavel wrote down coordinates of n of his favourite stars which appeared in the photo. These points are not necessarily distinct, there can be multiple stars in the same point of the sky.Pavel has lost his camera recently and wants to buy a similar one. Specifically, he wants to know the dimensions of the photo he took earlier. Unfortunately, the photo is also lost. His notes are also of not much help; numbers are written in random order all over his notepad, so it\'s impossible to tell which numbers specify coordinates of which points.Pavel asked you to help him to determine what are the possible dimensions of the photo according to his notes. As there are multiple possible answers, find the dimensions with the minimal possible area of the rectangle." 1500
1011B "Planning The Expedition" "binary search,brute force,implementation" "Natasha is planning an expedition to Mars for n people. One of the important tasks is to provide food for each participant.The warehouse has m daily food packages. Each package has some food type ai.Each participant must eat exactly one food package each day. Due to extreme loads, each participant must eat the same food type throughout the expedition. Different participants may eat different (or the same) types of food.Formally, for each participant j Natasha should select his food type bj and each day j-th participant will eat one food package of type bj. The values bj for different participants may be different.What is the maximum possible number of days the expedition can last, following the requirements above?" 1200
1011A Stages greedy,implementation,sortings "Natasha is going to fly to Mars. She needs to build a rocket, which consists of several stages in some order. Each of the stages is defined by a lowercase Latin letter. This way, the rocket can be described by the string \xe2\x80\x94 concatenation of letters, which correspond to the stages.There are n stages available. The rocket must contain exactly k of them. Stages in the rocket should be ordered by their weight. So, after the stage with some letter can go only stage with a letter, which is at least two positions after in the alphabet (skipping one letter in between, or even more). For example, after letter \'c\' can\'t go letters \'a\', \'b\', \'c\' and \'d\', but can go letters \'e\', \'f\', ..., \'z\'.For the rocket to fly as far as possible, its weight should be minimal. The weight of the rocket is equal to the sum of the weights of its stages. The weight of the stage is the number of its letter in the alphabet. For example, the stage \'a \'weighs one ton,\' b \'weighs two tons, and\' z\' \xe2\x80\x94 26 tons.Build the rocket with the minimal weight or determine, that it is impossible to build a rocket at all. Each stage can be used at most once." 900
1010F Tree fft,graphs,trees "The Main Martian Tree grows on Mars. It is a binary tree (a rooted tree, with no more than two sons at each vertex) with n vertices, where the root vertex has the number 1. Its fruits are the Main Martian Fruits. It\'s summer now, so this tree does not have any fruit yet.Autumn is coming soon, and leaves and branches will begin to fall off the tree. It is clear, that if a vertex falls off the tree, then its entire subtree will fall off too. In addition, the root will remain on the tree. Formally: the tree will have some connected subset of vertices containing the root.After that, the fruits will grow on the tree (only at those vertices which remain). Exactly x fruits will grow in the root. The number of fruits in each remaining vertex will be not less than the sum of the numbers of fruits in the remaining sons of this vertex. It is allowed, that some vertices will not have any fruits.Natasha wondered how many tree configurations can be after the described changes. Since this number can be very large, output it modulo 998244353.Two configurations of the resulting tree are considered different if one of these two conditions is true: they have different subsets of remaining vertices; they have the same subset of remaining vertices, but there is a vertex in this subset where they have a different amount of fruits." 3400
1010E Store "data structures" "Natasha was already going to fly back to Earth when she remembered that she needs to go to the Martian store to buy Martian souvenirs for her friends.It is known, that the Martian year lasts xmax months, month lasts ymax days, day lasts zmax seconds. Natasha also knows that this store works according to the following schedule: 2 months in a year were selected: xl and xr (1\xe2\x89\xa4xl\xe2\x89\xa4xr\xe2\x89\xa4xmax), 2 days in a month: yl and yr (1\xe2\x89\xa4yl\xe2\x89\xa4yr\xe2\x89\xa4ymax) and 2 seconds in a day: zl and zr (1\xe2\x89\xa4zl\xe2\x89\xa4zr\xe2\x89\xa4zmax). The store works at all such moments (month x, day y, second z), when simultaneously xl\xe2\x89\xa4x\xe2\x89\xa4xr, yl\xe2\x89\xa4y\xe2\x89\xa4yr and zl\xe2\x89\xa4z\xe2\x89\xa4zr.Unfortunately, Natasha does not know the numbers xl,xr,yl,yr,zl,zr.One Martian told Natasha: ""I went to this store (n+m) times. n times of them it was opened, and m times \xe2\x80\x94 closed."" He also described his every trip to the store: the month, day, second of the trip and whether the store was open or closed at that moment.Natasha can go to the store k times. For each of them, determine whether the store at the time of the trip is open, closed, or this information is unknown." 2700
1010D "Mars rover" "dfs and similar,graphs,implementation,trees" "Natasha travels around Mars in the Mars rover. But suddenly it broke down, namely \xe2\x80\x94 the logical scheme inside it. The scheme is an undirected tree (connected acyclic graph) with a root in the vertex 1, in which every leaf (excluding root) is an input, and all other vertices are logical elements, including the root, which is output. One bit is fed to each input. One bit is returned at the output.There are four types of logical elements: AND (2 inputs), OR (2 inputs), XOR (2 inputs), NOT (1 input). Logical elements take values from their direct descendants (inputs) and return the result of the function they perform. Natasha knows the logical scheme of the Mars rover, as well as the fact that only one input is broken. In order to fix the Mars rover, she needs to change the value on this input.For each input, determine what the output will be if Natasha changes this input." 2000
1010C Border "number theory" "Astronaut Natasha arrived on Mars. She knows that the Martians are very poor aliens. To ensure a better life for the Mars citizens, their emperor decided to take tax from every tourist who visited the planet. Natasha is the inhabitant of Earth, therefore she had to pay the tax to enter the territory of Mars.There are n banknote denominations on Mars: the value of i-th banknote is ai. Natasha has an infinite number of banknotes of each denomination.Martians have k fingers on their hands, so they use a number system with base k. In addition, the Martians consider the digit d (in the number system with base k) divine. Thus, if the last digit in Natasha\'s tax amount written in the number system with the base k is d, the Martians will be happy. Unfortunately, Natasha does not know the Martians\' divine digit yet.Determine for which values d Natasha can make the Martians happy.Natasha can use only her banknotes. Martians don\'t give her change." 1800
1010B Rocket "binary search,interactive" "This is an interactive problem.Natasha is going to fly to Mars. Finally, Natasha sat in the rocket. She flies, flies... but gets bored. She wishes to arrive to Mars already! So she decides to find something to occupy herself. She couldn\'t think of anything better to do than to calculate the distance to the red planet.Let\'s define x as the distance to Mars. Unfortunately, Natasha does not know x. But it is known that 1\xe2\x89\xa4x\xe2\x89\xa4m, where Natasha knows the number m. Besides, x and m are positive integers.Natasha can ask the rocket questions. Every question is an integer y (1\xe2\x89\xa4y\xe2\x89\xa4m). The correct answer to the question is \xe2\x88\x921, if x<y, 0, if x=y, and 1, if x>y. But the rocket is broken \xe2\x80\x94 it does not always answer correctly. Precisely: let the correct answer to the current question be equal to t, then, if the rocket answers this question correctly, then it will answer t, otherwise it will answer \xe2\x88\x92t.In addition, the rocket has a sequence p of length n. Each element of the sequence is either 0 or 1. The rocket processes this sequence in the cyclic order, that is 1-st element, 2-nd, 3-rd, \xe2\x80\xa6, (n\xe2\x88\x921)-th, n-th, 1-st, 2-nd, 3-rd, \xe2\x80\xa6, (n\xe2\x88\x921)-th, n-th, \xe2\x80\xa6. If the current element is 1, the rocket answers correctly, if 0 \xe2\x80\x94 lies. Natasha doesn\'t know the sequence p, but she knows its length \xe2\x80\x94 n.You can ask the rocket no more than 60 questions.Help Natasha find the distance to Mars. Assume, that the distance to Mars does not change while Natasha is asking questions.Your solution will not be accepted, if it does not receive an answer 0 from the rocket (even if the distance to Mars is uniquely determined by the already received rocket\'s answers)." 1800
1010A Fly "binary search,math" "Natasha is going to fly on a rocket to Mars and return to Earth. Also, on the way to Mars, she will land on n\xe2\x88\x922 intermediate planets. Formally: we number all the planets from 1 to n. 1 is Earth, n is Mars. Natasha will make exactly n flights: 1\xe2\x86\x922\xe2\x86\x92\xe2\x80\xa6n\xe2\x86\x921.Flight from x to y consists of two phases: take-off from planet x and landing to planet y. This way, the overall itinerary of the trip will be: the 1-st planet \xe2\x86\x92 take-off from the 1-st planet \xe2\x86\x92 landing to the 2-nd planet \xe2\x86\x92 2-nd planet \xe2\x86\x92 take-off from the 2-nd planet \xe2\x86\x92 \xe2\x80\xa6 \xe2\x86\x92 landing to the n-th planet \xe2\x86\x92 the n-th planet \xe2\x86\x92 take-off from the n-th planet \xe2\x86\x92 landing to the 1-st planet \xe2\x86\x92 the 1-st planet.The mass of the rocket together with all the useful cargo (but without fuel) is m tons. However, Natasha does not know how much fuel to load into the rocket. Unfortunately, fuel can only be loaded on Earth, so if the rocket runs out of fuel on some other planet, Natasha will not be able to return home. Fuel is needed to take-off from each planet and to land to each planet. It is known that 1 ton of fuel can lift off ai tons of rocket from the i-th planet or to land bi tons of rocket onto the i-th planet. For example, if the weight of rocket is 9 tons, weight of fuel is 3 tons and take-off coefficient is 8 (ai=8), then 1.5 tons of fuel will be burnt (since 1.5\xe2\x8b\x858=9+3). The new weight of fuel after take-off will be 1.5 tons. Please note, that it is allowed to burn non-integral amount of fuel during take-off or landing, and the amount of initial fuel can be non-integral as well.Help Natasha to calculate the minimum mass of fuel to load into the rocket. Note, that the rocket must spend fuel to carry both useful cargo and the fuel itself. However, it doesn\'t need to carry the fuel which has already been burnt. Assume, that the rocket takes off and lands instantly." 1500
1009G "Allowed Letters" "bitmasks,flows,graph matchings,graphs,greedy" "Polycarp has just launched his new startup idea. The niche is pretty free and the key vector of development sounds really promising, so he easily found himself some investors ready to sponsor the company. However, he is yet to name the startup!Actually, Polycarp has already came up with the name but some improvement to it will never hurt. So now he wants to swap letters at some positions in it to obtain the better name. It isn\'t necessary for letters to be adjacent.In addition, each of the investors has chosen some index in the name and selected a set of letters that can go there. Indices chosen by different investors are pairwise distinct. If some indices aren\'t chosen by any investor then any letter can go there.Finally, Polycarp is sure that the smallest lexicographically name is the best. (Like why do you think Google decided to become Alphabet?)More formally, you are given a string consisting of lowercase Latin letters from ""a"" to ""f"". You can swap letters at any positions arbitrary number of times (zero swaps is also possible).What is the smallest lexicographically name you can obtain such that the letter at every position is among the allowed letters?If Polycarp can\'t produce any valid name then print ""Impossible""." 2400
1009F "Dominant Indices" "data structures,dsu,trees" "You are given a rooted undirected tree consisting of n vertices. Vertex 1 is the root.Let\'s denote a depth array of vertex x as an infinite sequence [dx,0,dx,1,dx,2,\xe2\x80\xa6], where dx,i is the number of vertices y such that both conditions hold:  x is an ancestor of y;  the simple path from x to y traverses exactly i edges. The dominant index of a depth array of vertex x (or, shortly, the dominant index of vertex x) is an index j such that:  for every k<j, dx,k<dx,j;  for every k>j, dx,k\xe2\x89\xa4dx,j. For every vertex in the tree calculate its dominant index." 2300
1009E "Intercity Travelling" combinatorics,math,probabilities "Leha is planning his journey from Moscow to Saratov. He hates trains, so he has decided to get from one city to another by car.The path from Moscow to Saratov can be represented as a straight line (well, it\'s not that straight in reality, but in this problem we will consider it to be straight), and the distance between Moscow and Saratov is n km. Let\'s say that Moscow is situated at the point with coordinate 0 km, and Saratov \xe2\x80\x94 at coordinate n km.Driving for a long time may be really difficult. Formally, if Leha has already covered i kilometers since he stopped to have a rest, he considers the difficulty of covering (i+1)-th kilometer as ai+1. It is guaranteed that for every i\xe2\x88\x88[1,n\xe2\x88\x921] ai\xe2\x89\xa4ai+1. The difficulty of the journey is denoted as the sum of difficulties of each kilometer in the journey.Fortunately, there may be some rest sites between Moscow and Saratov. Every integer point from 1 to n\xe2\x88\x921 may contain a rest site. When Leha enters a rest site, he may have a rest, and the next kilometer will have difficulty a1, the kilometer after it \xe2\x80\x94 difficulty a2, and so on.For example, if n=5 and there is a rest site in coordinate 2, the difficulty of journey will be 2a1+2a2+a3: the first kilometer will have difficulty a1, the second one \xe2\x80\x94 a2, then Leha will have a rest, and the third kilometer will have difficulty a1, the fourth \xe2\x80\x94 a2, and the last one \xe2\x80\x94 a3. Another example: if n=7 and there are rest sites in coordinates 1 and 5, the difficulty of Leha\'s journey is 3a1+2a2+a3+a4.Leha doesn\'t know which integer points contain rest sites. So he has to consider every possible situation. Obviously, there are 2n\xe2\x88\x921 different distributions of rest sites (two distributions are different if there exists some point x such that it contains a rest site in exactly one of these distributions). Leha considers all these distributions to be equiprobable. He wants to calculate p \xe2\x80\x94 the expected value of difficulty of his journey.Obviously, p\xe2\x8b\x852n\xe2\x88\x921 is an integer number. You have to calculate it modulo 998244353." 2000
1009D "Relatively Prime Graph" "brute force,constructive algorithms,graphs,greedy,math" "Let\'s call an undirected graph G=(V,E) relatively prime if and only if for each edge (v,u)\xe2\x88\x88E  GCD(v,u)=1 (the greatest common divisor of v and u is 1). If there is no edge between some pair of vertices v and u then the value of GCD(v,u) doesn\'t matter. The vertices are numbered from 1 to |V|.Construct a relatively prime graph with n vertices and m edges such that it is connected and it contains neither self-loops nor multiple edges.If there exists no valid graph with the given number of vertices and edges then output ""Impossible"".If there are multiple answers then print any of them." 1700
1009C "Annoying Present" greedy,math "Alice got an array of length n as a birthday present once again! This is the third year in a row! And what is more disappointing, it is overwhelmengly boring, filled entirely with zeros. Bob decided to apply some changes to the array to cheer up Alice.Bob has chosen m changes of the following form. For some integer numbers x and d, he chooses an arbitrary position i (1\xe2\x89\xa4i\xe2\x89\xa4n) and for every j\xe2\x88\x88[1,n] adds x+d\xe2\x8b\x85dist(i,j) to the value of the j-th cell. dist(i,j) is the distance between positions i and j (i.e. dist(i,j)=|i\xe2\x88\x92j|, where |x| is an absolute value of x).For example, if Alice currently has an array [2,1,2,2] and Bob chooses position 3 for x=\xe2\x88\x921 and d=2 then the array will become [2\xe2\x88\x921+2\xe2\x8b\x852, 1\xe2\x88\x921+2\xe2\x8b\x851, 2\xe2\x88\x921+2\xe2\x8b\x850, 2\xe2\x88\x921+2\xe2\x8b\x851] = [5,2,1,3]. Note that Bob can\'t choose position i outside of the array (that is, smaller than 1 or greater than n).Alice will be the happiest when the elements of the array are as big as possible. Bob claimed that the arithmetic mean value of the elements will work fine as a metric.What is the maximum arithmetic mean value Bob can achieve?" 1700
1009B "Minimum Ternary String" greedy,implementation "You are given a ternary string (it is a string which consists only of characters \'0\', \'1\' and \'2\').You can swap any two adjacent (consecutive) characters \'0\' and \'1\' (i.e. replace ""01"" with ""10"" or vice versa) or any two adjacent (consecutive) characters \'1\' and \'2\' (i.e. replace ""12"" with ""21"" or vice versa).For example, for string ""010210"" we can perform the following moves:   ""010210"" \xe2\x86\x92 ""100210"";  ""010210"" \xe2\x86\x92 ""001210"";  ""010210"" \xe2\x86\x92 ""010120"";  ""010210"" \xe2\x86\x92 ""010201"". Note than you cannot swap ""02"" \xe2\x86\x92 ""20"" and vice versa. You cannot perform any other operations with the given string excluding described above.You task is to obtain the minimum possible (lexicographically) string by using these swaps arbitrary number of times (possibly, zero).String a is lexicographically less than string b (if strings a and b have the same length) if there exists some position i (1\xe2\x89\xa4i\xe2\x89\xa4|a|, where |s| is the length of the string s) such that for every j<i holds aj=bj, and ai<bi." 1400
1009A "Game Shopping" implementation "Maxim wants to buy some games at the local game shop. There are n games in the shop, the i-th game costs ci.Maxim has a wallet which can be represented as an array of integers. His wallet contains m bills, the j-th bill has value aj.Games in the shop are ordered from left to right, Maxim tries to buy every game in that order.When Maxim stands at the position i in the shop, he takes the first bill from his wallet (if his wallet is empty then he proceeds to the next position immediately) and tries to buy the i-th game using this bill. After Maxim tried to buy the n-th game, he leaves the shop.Maxim buys the i-th game if and only if the value of the first bill (which he takes) from his wallet is greater or equal to the cost of the i-th game. If he successfully buys the i-th game, the first bill from his wallet disappears and the next bill becomes first. Otherwise Maxim leaves the first bill in his wallet (this bill still remains the first one) and proceeds to the next game.For example, for array c=[2,4,5,2,4] and array a=[5,3,4,6] the following process takes place: Maxim buys the first game using the first bill (its value is 5), the bill disappears, after that the second bill (with value 3) becomes the first one in Maxim\'s wallet, then Maxim doesn\'t buy the second game because c2>a2, the same with the third game, then he buys the fourth game using the bill of value a2 (the third bill becomes the first one in Maxim\'s wallet) and buys the fifth game using the bill of value a3.Your task is to get the number of games Maxim will buy." 800
1008B "Turn the Rectangles" greedy,sortings "There are n rectangles in a row. You can either turn each rectangle by 90 degrees or leave it as it is. If you turn a rectangle, its width will be height, and its height will be width. Notice that you can turn any number of rectangles, you also can turn all or none of them. You can not change the order of the rectangles.Find out if there is a way to make the rectangles go in order of non-ascending height. In other words, after all the turns, a height of every rectangle has to be not greater than the height of the previous rectangle (if it is such)." 1000
1008A Romaji implementation,strings "Vitya has just started learning Berlanese language. It is known that Berlanese uses the Latin alphabet. Vowel letters are ""a"", ""o"", ""u"", ""i"", and ""e"". Other letters are consonant.In Berlanese, there has to be a vowel after every consonant, but there can be any letter after any vowel. The only exception is a consonant ""n""; after this letter, there can be any letter (not only a vowel) or there can be no letter at all. For example, the words ""harakiri"", ""yupie"", ""man"", and ""nbo"" are Berlanese while the words ""horse"", ""king"", ""my"", and ""nz"" are not.Help Vitya find out if a word s is Berlanese." 900
1007E "Mini Metro" dp "In a simplified version of a ""Mini Metro"" game, there is only one subway line, and all the trains go in the same direction. There are n stations on the line, ai people are waiting for the train at the i-th station at the beginning of the game. The game starts at the beginning of the 0-th hour. At the end of each hour (couple minutes before the end of the hour), bi people instantly arrive to the i-th station. If at some moment, the number of people at the i-th station is larger than ci, you lose.A player has several trains which he can appoint to some hours. The capacity of each train is k passengers. In the middle of the appointed hour, the train goes from the 1-st to the n-th station, taking as many people at each station as it can accommodate. A train can not take people from the i-th station if there are people at the i\xe2\x88\x921-th station.If multiple trains are appointed to the same hour, their capacities are being added up and they are moving together.The player wants to stay in the game for t hours. Determine the minimum number of trains he will need for it." 3400
1007D Ants "2-sat,data structures,trees" "There is a tree with n vertices. There are also m ants living on it. Each ant has its own color. The i-th ant has two favorite pairs of vertices: (ai,bi) and (ci,di). You need to tell if it is possible to paint the edges of the tree in m colors so that every ant will be able to walk between vertices from one of its favorite pairs using only edges of his color; if it is possible, you need to print which pair every ant should use." 3200
1007C "Guess two numbers" "binary search,interactive" "This is an interactive problem.Vasya and Vitya play a game. Vasya thought of two integers a and b from 1 to n and Vitya tries to guess them. Each round he tells Vasya two numbers x and y from 1 to n. If both x=a and y=b then Vitya wins. Else Vasya must say one of the three phrases:   x is less than a;  y is less than b;  x is greater than a or y is greater than b. Vasya can\'t lie, but if multiple phrases are true, he may choose any of them. For example, if Vasya thought of numbers 2 and 4, then he answers with the phrase 3 to a query (3,4), and he can answer with the phrase 1 or phrase 3 to a query (1,5).Help Vitya win in no more than 600 rounds." 3000
1007B "Pave the Parallelepiped" "bitmasks,brute force,combinatorics,math,number theory" "You are given a rectangular parallelepiped with sides of positive integer lengths A, B and C. Find the number of different groups of three integers (a, b, c) such that 1\xe2\x89\xa4a\xe2\x89\xa4b\xe2\x89\xa4c and parallelepiped A\xc3\x97B\xc3\x97C can be paved with parallelepipeds a\xc3\x97b\xc3\x97c. Note, that all small parallelepipeds have to be rotated in the same direction.For example, parallelepiped 1\xc3\x975\xc3\x976 can be divided into parallelepipeds 1\xc3\x973\xc3\x975, but can not be divided into parallelepipeds 1\xc3\x972\xc3\x973." 2400
1007A "Reorder the Array" "combinatorics,data structures,math,sortings,two pointers" "You are given an array of integers. Vasya can permute (change order) its integers. He wants to do it so that as many as possible integers will become on a place where a smaller integer used to stand. Help Vasya find the maximal number of such integers.For instance, if we are given an array [10,20,30,40], we can permute it so that it becomes [20,40,10,30]. Then on the first and the second positions the integers became larger (20>10, 40>20) and did not on the third and the fourth, so for this permutation, the number that Vasya wants to maximize equals 2. Read the note for the first example, there is one more demonstrative test case.Help Vasya to permute integers in such way that the number of positions in a new array, where integers are greater than in the original one, is maximal." 1300
1006F Xor-Paths "bitmasks,brute force,dp,meet-in-the-middle" "There is a rectangular grid of size n\xc3\x97m. Each cell has a number written on it; the number on the cell (i,j) is ai,j. Your task is to calculate the number of paths from the upper-left cell (1,1) to the bottom-right cell (n,m) meeting the following constraints:  You can move to the right or to the bottom only. Formally, from the cell (i,j) you may move to the cell (i,j+1) or to the cell (i+1,j). The target cell can\'t be outside of the grid.  The xor of all the numbers on the path from the cell (1,1) to the cell (n,m) must be equal to k (xor operation is the bitwise exclusive OR, it is represented as \'^\' in Java or C++ and ""xor"" in Pascal). Find the number of such paths in the given grid." 2100
1006E "Military Problem" "dfs and similar,graphs,trees" "In this problem you will have to help Berland army with organizing their command delivery system.There are n officers in Berland army. The first officer is the commander of the army, and he does not have any superiors. Every other officer has exactly one direct superior. If officer a is the direct superior of officer b, then we also can say that officer b is a direct subordinate of officer a.Officer x is considered to be a subordinate (direct or indirect) of officer y if one of the following conditions holds:  officer y is the direct superior of officer x;  the direct superior of officer x is a subordinate of officer y. For example, on the picture below the subordinates of the officer 3 are: 5,6,7,8,9.The structure of Berland army is organized in such a way that every officer, except for the commander, is a subordinate of the commander of the army.Formally, let\'s represent Berland army as a tree consisting of n vertices, in which vertex u corresponds to officer u. The parent of vertex u corresponds to the direct superior of officer u. The root (which has index 1) corresponds to the commander of the army.Berland War Ministry has ordered you to give answers on q queries, the i-th query is given as (ui,ki), where ui is some officer, and ki is a positive integer.To process the i-th query imagine how a command from ui spreads to the subordinates of ui. Typical DFS (depth first search) algorithm is used here.Suppose the current officer is a and he spreads a command. Officer a chooses b \xe2\x80\x94 one of his direct subordinates (i.e. a child in the tree) who has not received this command yet. If there are many such direct subordinates, then a chooses the one having minimal index. Officer a gives a command to officer b. Afterwards, b uses exactly the same algorithm to spread the command to its subtree. After b finishes spreading the command, officer a chooses the next direct subordinate again (using the same strategy). When officer a cannot choose any direct subordinate who still hasn\'t received this command, officer a finishes spreading the command.Let\'s look at the following example:  If officer 1 spreads a command, officers receive it in the following order: [1,2,3,5,6,8,7,9,4].If officer 3 spreads a command, officers receive it in the following order: [3,5,6,8,7,9].If officer 7 spreads a command, officers receive it in the following order: [7,9].If officer 9 spreads a command, officers receive it in the following order: [9].To answer the i-th query (ui,ki), construct a sequence which describes the order in which officers will receive the command if the ui-th officer spreads it. Return the ki-th element of the constructed list or -1 if there are fewer than ki elements in it.You should process queries independently. A query doesn\'t affect the following queries." 1600
1006D "Two Strings Swaps" implementation "You are given two strings a and b consisting of lowercase English letters, both of length n. The characters of both strings have indices from 1 to n, inclusive. You are allowed to do the following changes:   Choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap characters ai and bi;  Choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap characters ai and an\xe2\x88\x92i+1;  Choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n) and swap characters bi and bn\xe2\x88\x92i+1. Note that if n is odd, you are formally allowed to swap a\xe2\x8c\x88n2\xe2\x8c\x89 with a\xe2\x8c\x88n2\xe2\x8c\x89 (and the same with the string b) but this move is useless. Also you can swap two equal characters but this operation is useless as well.You have to make these strings equal by applying any number of changes described above, in any order. But it is obvious that it may be impossible to make two strings equal by these swaps.In one preprocess move you can replace a character in a with another character. In other words, in a single preprocess move you can choose any index i (1\xe2\x89\xa4i\xe2\x89\xa4n), any character c and set ai:=c.Your task is to find the minimum number of preprocess moves to apply in such a way that after them you can make strings a and b equal by applying some number of changes described in the list above.Note that the number of changes you make after the preprocess moves does not matter. Also note that you cannot apply preprocess moves to the string b or make any preprocess moves after the first change is made." 1700
1006C "Three Parts of the Array" "binary search,data structures,two pointers" "You are given an array d1,d2,\xe2\x80\xa6,dn consisting of n integer numbers.Your task is to split this array into three parts (some of which may be empty) in such a way that each element of the array belongs to exactly one of the three parts, and each of the parts forms a consecutive contiguous subsegment (possibly, empty) of the original array. Let the sum of elements of the first part be sum1, the sum of elements of the second part be sum2 and the sum of elements of the third part be sum3. Among all possible ways to split the array you have to choose a way such that sum1=sum3 and sum1 is maximum possible.More formally, if the first part of the array contains a elements, the second part of the array contains b elements and the third part contains c elements, then:sum1=\xe2\x88\x911\xe2\x89\xa4i\xe2\x89\xa4adi, sum2=\xe2\x88\x91a+1\xe2\x89\xa4i\xe2\x89\xa4a+bdi, sum3=\xe2\x88\x91a+b+1\xe2\x89\xa4i\xe2\x89\xa4a+b+cdi.The sum of an empty array is 0.Your task is to find a way to split the array such that sum1=sum3 and sum1 is maximum possible." 1200
1006B "Polycarp\'s Practice" greedy,implementation,sortings "Polycarp is practicing his problem solving skill. He has a list of n problems with difficulties a1,a2,\xe2\x80\xa6,an, respectively. His plan is to practice for exactly k days. Each day he has to solve at least one problem from his list. Polycarp solves the problems in the order they are given in his list, he cannot skip any problem from his list. He has to solve all n problems in exactly k days.Thus, each day Polycarp solves a contiguous sequence of (consecutive) problems from the start of the list. He can\'t skip problems or solve them multiple times. As a result, in k days he will solve all the n problems.The profit of the j-th day of Polycarp\'s practice is the maximum among all the difficulties of problems Polycarp solves during the j-th day (i.e. if he solves problems with indices from l to r during a day, then the profit of the day is maxl\xe2\x89\xa4i\xe2\x89\xa4rai). The total profit of his practice is the sum of the profits over all k days of his practice.You want to help Polycarp to get the maximum possible total profit over all valid ways to solve problems. Your task is to distribute all n problems between k days satisfying the conditions above in such a way, that the total profit is maximum.For example, if n=8,k=3 and a=[5,4,2,6,5,1,9,2], one of the possible distributions with maximum total profit is: [5,4,2],[6,5],[1,9,2]. Here the total profit equals 5+6+9=20." 1200
1006A "Adjacent Replacements" implementation "Mishka got an integer array a of length n as a birthday present (what a surprise!).Mishka doesn\'t like this present and wants to change it somehow. He has invented an algorithm and called it ""Mishka\'s Adjacent Replacements Algorithm"". This algorithm can be represented as a sequence of steps:  Replace each occurrence of 1 in the array a with 2;  Replace each occurrence of 2 in the array a with 1;  Replace each occurrence of 3 in the array a with 4;  Replace each occurrence of 4 in the array a with 3;  Replace each occurrence of 5 in the array a with 6;  Replace each occurrence of 6 in the array a with 5;  \xe2\x80\xa6  Replace each occurrence of 109\xe2\x88\x921 in the array a with 109;  Replace each occurrence of 109 in the array a with 109\xe2\x88\x921. Note that the dots in the middle of this algorithm mean that Mishka applies these replacements for each pair of adjacent integers (2i\xe2\x88\x921,2i) for each i\xe2\x88\x88{1,2,\xe2\x80\xa6,5\xe2\x8b\x85108} as described above.For example, for the array a=[1,2,4,5,10], the following sequence of arrays represents the algorithm: [1,2,4,5,10] \xe2\x86\x92 (replace all occurrences of 1 with 2) \xe2\x86\x92 [2,2,4,5,10] \xe2\x86\x92 (replace all occurrences of 2 with 1) \xe2\x86\x92 [1,1,4,5,10] \xe2\x86\x92 (replace all occurrences of 3 with 4) \xe2\x86\x92 [1,1,4,5,10] \xe2\x86\x92 (replace all occurrences of 4 with 3) \xe2\x86\x92 [1,1,3,5,10] \xe2\x86\x92 (replace all occurrences of 5 with 6) \xe2\x86\x92 [1,1,3,6,10] \xe2\x86\x92 (replace all occurrences of 6 with 5) \xe2\x86\x92 [1,1,3,5,10] \xe2\x86\x92 \xe2\x80\xa6 \xe2\x86\x92 [1,1,3,5,10] \xe2\x86\x92 (replace all occurrences of 10 with 9) \xe2\x86\x92 [1,1,3,5,9]. The later steps of the algorithm do not change the array.Mishka is very lazy and he doesn\'t want to apply these changes by himself. But he is very interested in their result. Help him find it." 800
1005F "Berland and the Shortest Paths" "brute force,dfs and similar,graphs,shortest paths" "There are n cities in Berland. Some pairs of cities are connected by roads. All roads are bidirectional. Each road connects two different cities. There is at most one road between a pair of cities. The cities are numbered from 1 to n.It is known that, from the capital (the city with the number 1), you can reach any other city by moving along the roads.The President of Berland plans to improve the country\'s road network. The budget is enough to repair exactly n\xe2\x88\x921 roads. The President plans to choose a set of n\xe2\x88\x921 roads such that:  it is possible to travel from the capital to any other city along the n\xe2\x88\x921 chosen roads,  if di is the number of roads needed to travel from the capital to city i, moving only along the n\xe2\x88\x921 chosen roads, then d1+d2+\xe2\x8b\xaf+dn is minimized (i.e. as minimal as possible). In other words, the set of n\xe2\x88\x921 roads should preserve the connectivity of the country, and the sum of distances from city 1 to all cities should be minimized (where you can only use the n\xe2\x88\x921 chosen roads).The president instructed the ministry to prepare k possible options to choose n\xe2\x88\x921 roads so that both conditions above are met.Write a program that will find k possible ways to choose roads for repair. If there are fewer than k ways, then the program should output all possible valid ways to choose roads." 2100
1005E2 "Median on Segments (General Case Edition)" sortings "You are given an integer sequence a1,a2,\xe2\x80\xa6,an.Find the number of pairs of indices (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that the value of median of al,al+1,\xe2\x80\xa6,ar is exactly the given number m.The median of a sequence is the value of an element which is in the middle of the sequence after sorting it in non-decreasing order. If the length of the sequence is even, the left of two middle elements is used.For example, if a=[4,2,7,5] then its median is 4 since after sorting the sequence, it will look like [2,4,5,7] and the left of two middle elements is equal to 4. The median of [7,1,2,9,6] equals 6 since after sorting, the value 6 will be in the middle of the sequence.Write a program to find the number of pairs of indices (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that the value of median of al,al+1,\xe2\x80\xa6,ar is exactly the given number m." 2400
1005E1 "Median on Segments (Permutations Edition)" sortings "You are given a permutation p1,p2,\xe2\x80\xa6,pn. A permutation of length n is a sequence such that each integer between 1 and n occurs exactly once in the sequence.Find the number of pairs of indices (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that the value of the median of pl,pl+1,\xe2\x80\xa6,pr is exactly the given number m.The median of a sequence is the value of the element which is in the middle of the sequence after sorting it in non-decreasing order. If the length of the sequence is even, the left of two middle elements is used.For example, if a=[4,2,7,5] then its median is 4 since after sorting the sequence, it will look like [2,4,5,7] and the left of two middle elements is equal to 4. The median of [7,1,2,9,6] equals 6 since after sorting, the value 6 will be in the middle of the sequence.Write a program to find the number of pairs of indices (l,r) (1\xe2\x89\xa4l\xe2\x89\xa4r\xe2\x89\xa4n) such that the value of the median of pl,pl+1,\xe2\x80\xa6,pr is exactly the given number m." 1800
1005D "Polycarp and Div 3" "dp,greedy,number theory" "Polycarp likes numbers that are divisible by 3.He has a huge number s. Polycarp wants to cut from it the maximum number of numbers that are divisible by 3. To do this, he makes an arbitrary number of vertical cuts between pairs of adjacent digits. As a result, after m such cuts, there will be m+1 parts in total. Polycarp analyzes each of the obtained numbers and finds the number of those that are divisible by 3.For example, if the original number is s=3121, then Polycarp can cut it into three parts with two cuts: 3|1|21. As a result, he will get two numbers that are divisible by 3.Polycarp can make an arbitrary number of vertical cuts, where each cut is made between a pair of adjacent digits. The resulting numbers cannot contain extra leading zeroes (that is, the number can begin with 0 if and only if this number is exactly one character \'0\'). For example, 007, 01 and 00099 are not valid numbers, but 90, 0 and 10001 are valid.What is the maximum number of numbers divisible by 3 that Polycarp can obtain?" 1500
1005C "Summarize to the Power of Two" "brute force,greedy,implementation" "A sequence a1,a2,\xe2\x80\xa6,an is called good if, for each element ai, there exists an element aj (i\xe2\x89\xa0j) such that ai+aj is a power of two (that is, 2d for some non-negative integer d).For example, the following sequences are good:  [5,3,11] (for example, for a1=5 we can choose a2=3. Note that their sum is a power of two. Similarly, such an element can be found for a2 and a3),  [1,1,1,1023],  [7,39,89,25,89],  []. Note that, by definition, an empty sequence (with a length of 0) is good.For example, the following sequences are not good:  [16] (for a1=16, it is impossible to find another element aj such that their sum is a power of two),  [4,16] (for a1=4, it is impossible to find another element aj such that their sum is a power of two),  [1,3,2,8,8,8] (for a3=2, it is impossible to find another element aj such that their sum is a power of two). You are given a sequence a1,a2,\xe2\x80\xa6,an. What is the minimum number of elements you need to remove to make it good? You can delete an arbitrary set of elements." 1300
1005B "Delete from the Left" "brute force,implementation,strings" "You are given two strings s and t. In a single move, you can choose any of two strings and delete the first (that is, the leftmost) character. After a move, the length of the string decreases by 1. You can\'t choose a string if it is empty.For example:  by applying a move to the string ""where"", the result is the string ""here"",  by applying a move to the string ""a"", the result is an empty string """". You are required to make two given strings equal using the fewest number of moves. It is possible that, in the end, both strings will be equal to the empty string, and so, are equal to each other. In this case, the answer is obviously the sum of the lengths of the initial strings.Write a program that finds the minimum number of moves to make two given strings s and t equal." 900
1005A "Tanya and Stairways" implementation "Little girl Tanya climbs the stairs inside a multi-storey building. Every time Tanya climbs a stairway, she starts counting steps from 1 to the number of steps in this stairway. She speaks every number aloud. For example, if she climbs two stairways, the first of which contains 3 steps, and the second contains 4 steps, she will pronounce the numbers 1,2,3,1,2,3,4.You are given all the numbers pronounced by Tanya. How many stairways did she climb? Also, output the number of steps in each stairway.The given sequence will be a valid sequence that Tanya could have pronounced when climbing one or more stairways." 800
1004F "Sonya and Bitwise OR" "bitmasks,data structures,divide and conquer" "Sonya has an array a1,a2,\xe2\x80\xa6,an consisting of n integers and also one non-negative integer x. She has to perform m queries of two types:  1 i y: replace i-th element by value y, i.e. to perform an operation ai := y;  2 l r: find the number of pairs (L, R) that l\xe2\x89\xa4L\xe2\x89\xa4R\xe2\x89\xa4r and bitwise OR of all integers in the range [L,R] is at least x (note that x is a constant for all queries). Can you help Sonya perform all her queries?Bitwise OR is a binary operation on a pair of non-negative integers. To calculate the bitwise OR of two numbers, you need to write both numbers in binary notation. The result is a number, in binary, which contains a one in each digit if there is a one in the binary notation of at least one of the two numbers. For example, 10 OR 19 = 10102 OR 100112 = 110112 = 27." 2600
1004E "Sonya and Ice Cream" "binary search,data structures,dp,greedy,shortest paths,trees" "Sonya likes ice cream very much. She eats it even during programming competitions. That is why the girl decided that she wants to open her own ice cream shops.Sonya lives in a city with n junctions and n\xe2\x88\x921 streets between them. All streets are two-way and connect two junctions. It is possible to travel from any junction to any other using one or more streets. City Hall allows opening shops only on junctions. The girl cannot open shops in the middle of streets. Sonya has exactly k friends whom she can trust. If she opens a shop, one of her friends has to work there and not to allow anybody to eat an ice cream not paying for it. Since Sonya does not want to skip an important competition, she will not work in shops personally.Sonya wants all her ice cream shops to form a simple path of the length r (1\xe2\x89\xa4r\xe2\x89\xa4k), i.e. to be located in different junctions f1,f2,\xe2\x80\xa6,fr and there is street between fi and fi+1 for each i from 1 to r\xe2\x88\x921.The girl takes care of potential buyers, so she also wants to minimize the maximum distance between the junctions to the nearest ice cream shop. The distance between two junctions a and b is equal to the sum of all the street lengths that you need to pass to get from the junction a to the junction b. So Sonya wants to minimizemaxamin1\xe2\x89\xa4i\xe2\x89\xa4rda,fiwhere a takes a value of all possible n junctions, fi \xe2\x80\x94 the junction where the i-th Sonya\'s shop is located, and dx,y \xe2\x80\x94 the distance between the junctions x and y.Sonya is not sure that she can find the optimal shops locations, that is why she is asking you to help her to open not more than k shops that will form a simple path and the maximum distance between any junction and the nearest shop would be minimal." 2400
1004D "Sonya and Matrix" "brute force,constructive algorithms,implementation" "Since Sonya has just learned the basics of matrices, she decided to play with them a little bit.Sonya imagined a new type of matrices that she called rhombic matrices. These matrices have exactly one zero, while all other cells have the Manhattan distance to the cell containing the zero. The cells with equal numbers have the form of a rhombus, that is why Sonya called this type so.The Manhattan distance between two cells (x1, y1) and (x2, y2) is defined as |x1\xe2\x88\x92x2|+|y1\xe2\x88\x92y2|. For example, the Manhattan distance between the cells (5,2) and (7,1) equals to |5\xe2\x88\x927|+|2\xe2\x88\x921|=3.  Example of a rhombic matrix. Note that rhombic matrices are uniquely defined by n, m, and the coordinates of the cell containing the zero.She drew a n\xc3\x97m rhombic matrix. She believes that you can not recreate the matrix if she gives you only the elements of this matrix in some arbitrary order (i.e., the sequence of n\xe2\x8b\x85m numbers). Note that Sonya will not give you n and m, so only the sequence of numbers in this matrix will be at your disposal.Write a program that finds such an n\xc3\x97m rhombic matrix whose elements are the same as the elements in the sequence in some order." 2300
1004C "Sonya and Robots" "constructive algorithms,implementation" "Since Sonya is interested in robotics too, she decided to construct robots that will read and recognize numbers.Sonya has drawn n numbers in a row, ai is located in the i-th position. She also has put a robot at each end of the row (to the left of the first number and to the right of the last number). Sonya will give a number to each robot (they can be either same or different) and run them. When a robot is running, it is moving toward to another robot, reading numbers in the row. When a robot is reading a number that is equal to the number that was given to that robot, it will turn off and stay in the same position.Sonya does not want robots to break, so she will give such numbers that robots will stop before they meet. That is, the girl wants them to stop at different positions so that the first robot is to the left of the second one.For example, if the numbers [1,5,4,1,3] are written, and Sonya gives the number 1 to the first robot and the number 4 to the second one, the first robot will stop in the 1-st position while the second one in the 3-rd position. In that case, robots will not meet each other. As a result, robots will not be broken. But if Sonya gives the number 4 to the first robot and the number 5 to the second one, they will meet since the first robot will stop in the 3-rd position while the second one is in the 2-nd position.Sonya understands that it does not make sense to give a number that is not written in the row because a robot will not find this number and will meet the other robot.Sonya is now interested in finding the number of different pairs that she can give to robots so that they will not meet. In other words, she wants to know the number of pairs (p, q), where she will give p to the first robot and q to the second one. Pairs (pi, qi) and (pj, qj) are different if pi\xe2\x89\xa0pj or qi\xe2\x89\xa0qj.Unfortunately, Sonya is busy fixing robots that broke after a failed launch. That is why she is asking you to find the number of pairs that she can give to robots so that they will not meet." 1400
1004B "Sonya and Exhibition" "constructive algorithms,greedy,implementation,math" "Sonya decided to organize an exhibition of flowers. Since the girl likes only roses and lilies, she decided that only these two kinds of flowers should be in this exhibition.There are n flowers in a row in the exhibition. Sonya can put either a rose or a lily in the i-th position. Thus each of n positions should contain exactly one flower: a rose or a lily.She knows that exactly m people will visit this exhibition. The i-th visitor will visit all flowers from li to ri inclusive. The girl knows that each segment has its own beauty that is equal to the product of the number of roses and the number of lilies.Sonya wants her exhibition to be liked by a lot of people. That is why she wants to put the flowers in such way that the sum of beauties of all segments would be maximum possible." 1300
1004A "Sonya and Hotels" implementation "Sonya decided that having her own hotel business is the best way of earning money because she can profit and rest wherever she wants.The country where Sonya lives is an endless line. There is a city in each integer coordinate on this line. She has n hotels, where the i-th hotel is located in the city with coordinate xi. Sonya is a smart girl, so she does not open two or more hotels in the same city.Sonya understands that her business needs to be expanded by opening new hotels, so she decides to build one more. She wants to make the minimum distance from this hotel to all others to be equal to d. The girl understands that there are many possible locations to construct such a hotel. Thus she wants to know the number of possible coordinates of the cities where she can build a new hotel. Because Sonya is lounging in a jacuzzi in one of her hotels, she is asking you to find the number of cities where she can build a new hotel so that the minimum distance from the original n hotels to the new one is equal to d." 900
1003F Abbreviation dp,hashing,strings "You are given a text consisting of n space-separated words. There is exactly one space character between any pair of adjacent words. There are no spaces before the first word and no spaces after the last word. The length of text is the number of letters and spaces in it. wi is the i-th word of text. All words consist only of lowercase Latin letters.Let\'s denote a segment of words w[i..j] as a sequence of words wi,wi+1,\xe2\x80\xa6,wj. Two segments of words w[i1..j1] and w[i2..j2] are considered equal if j1\xe2\x88\x92i1=j2\xe2\x88\x92i2, j1\xe2\x89\xa5i1, j2\xe2\x89\xa5i2, and for every t\xe2\x88\x88[0,j1\xe2\x88\x92i1] wi1+t=wi2+t. For example, for the text ""to be or not to be"" the segments w[1..2] and w[5..6] are equal, they correspond to the words ""to be"".An abbreviation is a replacement of some segments of words with their first uppercase letters. In order to perform an abbreviation, you have to choose at least two non-intersecting equal segments of words, and replace each chosen segment with the string consisting of first letters of the words in the segment (written in uppercase). For example, for the text ""a ab a a b ab a a b c"" you can replace segments of words w[2..4] and w[6..8] with an abbreviation ""AAA"" and obtain the text ""a AAA b AAA b c"", or you can replace segments of words w[2..5] and w[6..9] with an abbreviation ""AAAB"" and obtain the text ""a AAAB AAAB c"".What is the minimum length of the text after at most one abbreviation?" 2200
1003E "Tree Constructing" "constructive algorithms,graphs" "You are given three integers n, d and k.Your task is to construct an undirected tree on n vertices with diameter d and degree of each vertex at most k, or say that it is impossible.An undirected tree is a connected undirected graph with n\xe2\x88\x921 edges.Diameter of a tree is the maximum length of a simple path (a path in which each vertex appears at most once) between all pairs of vertices of this tree.Degree of a vertex is the number of edges incident to this vertex (i.e. for a vertex u it is the number of edges (u,v) that belong to the tree, where v is any other vertex of a tree)." 2100
1003D "Coins and Queries" greedy "Polycarp has n coins, the value of the i-th coin is ai. It is guaranteed that all the values are integer powers of 2 (i.e. ai=2d for some non-negative integer number d).Polycarp wants to know answers on q queries. The j-th query is described as integer number bj. The answer to the query is the minimum number of coins that is necessary to obtain the value bj using some subset of coins (Polycarp can use only coins he has). If Polycarp can\'t obtain the value bj, the answer to the j-th query is -1.The queries are independent (the answer on the query doesn\'t affect Polycarp\'s coins)." 1600
1003C "Intense Heat" "brute force,implementation,math" "The heat during the last few days has been really intense. Scientists from all over the Berland study how the temperatures and weather change, and they claim that this summer is abnormally hot. But any scientific claim sounds a lot more reasonable if there are some numbers involved, so they have decided to actually calculate some value which would represent how high the temperatures are.Mathematicians of Berland State University came up with a special heat intensity value. This value is calculated as follows:Suppose we want to analyze the segment of n consecutive days. We have measured the temperatures during these n days; the temperature during i-th day equals ai.We denote the average temperature of a segment of some consecutive days as the arithmetic mean of the temperature measures during this segment of days. So, if we want to analyze the average temperature from day x to day y, we calculate it as y\xe2\x88\x91i=xaiy\xe2\x88\x92x+1 (note that division is performed without any rounding). The heat intensity value is the maximum of average temperatures over all segments of not less than k consecutive days. For example, if analyzing the measures [3,4,1,2] and k=3, we are interested in segments [3,4,1], [4,1,2] and [3,4,1,2] (we want to find the maximum value of average temperature over these segments).You have been hired by Berland State University to write a program that would compute the heat intensity value of a given period of days. Are you up to this task?" 1300
1003B "Binary String Constructing" "constructive algorithms" "You are given three integers a, b and x. Your task is to construct a binary string s of length n=a+b such that there are exactly a zeroes, exactly b ones and exactly x indices i (where 1\xe2\x89\xa4i<n) such that si\xe2\x89\xa0si+1. It is guaranteed that the answer always exists.For example, for the string ""01010"" there are four indices i such that 1\xe2\x89\xa4i<n and si\xe2\x89\xa0si+1 (i=1,2,3,4). For the string ""111001"" there are two such indices i (i=3,5).Recall that binary string is a non-empty sequence of characters where each character is either 0 or 1." 1300
1003A "Polycarp\'s Pockets" implementation "Polycarp has n coins, the value of the i-th coin is ai. Polycarp wants to distribute all the coins between his pockets, but he cannot put two coins with the same value into the same pocket.For example, if Polycarp has got six coins represented as an array a=[1,2,4,3,3,2], he can distribute the coins into two pockets as follows: [1,2,3],[2,3,4].Polycarp wants to distribute all the coins with the minimum number of used pockets. Help him to do that." 800
1002E2 "Another array reconstruction algorithm" NA "You are given a quantum oracle - an operation on N\xe2\x80\x89+\xe2\x80\x891 qubits which implements a function . You are guaranteed that the function f implemented by the oracle can be represented in the following form (oracle from problem D2):Here  (a vector of N integers, each of which can be 0 or 1), and  is a vector of N 1s.Your task is to reconstruct the array  which could produce the given oracle. Your code is allowed to call the given oracle only once.You have to implement an operation which takes the following inputs: an integer N - the number of qubits in the oracle input (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898), an oracle Uf, implemented as an operation with signature ((Qubit[], Qubit) => ()), i.e., an operation which takes as input an array of qubits and an output qubit and has no output.The return of your operation is an array of integers of length N, each of them 0 or 1.Note that in this problem we\'re comparing the oracle generated by your return to the oracle Uf, instead of comparing your return to the (hidden) value of  used to generate Uf. This means that any kind of incorrect return results in ""Runtime Error"" verdict, as well as actual runtime errors like releasing qubits in non-zero state.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (N : Int, Uf : ((Qubit[], Qubit) => ())) : Int[]    {        body        {            // your code here        }    }}" 1900
1002E1 "Bernstein-Vazirani algorithm" NA "You are given a quantum oracle - an operation on N\xe2\x80\x89+\xe2\x80\x891 qubits which implements a function . You are guaranteed that the function f implemented by the oracle is scalar product function (oracle from problem D1): Here  (an array of N integers, each of which can be 0 or 1). Your task is to reconstruct the array . Your code is allowed to call the given oracle only once.You have to implement an operation which takes the following inputs: an integer N - the number of qubits in the oracle input (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898), an oracle Uf, implemented as an operation with signature ((Qubit[], Qubit) => ()), i.e., an operation which takes as input an array of qubits and an output qubit and has no output.The return of your operation is an array of integers of length N, each of them 0 or 1.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (N : Int, Uf : ((Qubit[], Qubit) => ())) : Int[]    {        body        {            // your code here        }    }}" 1500
1002D3 "Oracle for majority function" NA "Implement a quantum oracle on 3 qubits which implements a majority function. Majority function on 3-bit vectors is defined as follows:  if vector  has two or three 1s, and 0 if it has zero or one 1s.For an explanation on how this type of quantum oracles works, see Introduction to quantum oracles.You have to implement an operation which takes the following inputs: an array of 3 qubits x in arbitrary state (input register), a qubit y in arbitrary state (output qubit).The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit) : ()    {        body        {            // your code here        }    }}" 1600
1002D2 "Oracle for f(x) = b * x + (1 - b) * (1 - x) mod 2" NA "Implement a quantum oracle on N qubits which implements the following function: Here  (a vector of N integers, each of which can be 0 or 1), and  is a vector of N 1s.For an explanation on how this type of quantum oracles works, see Introduction to quantum oracles.You have to implement an operation which takes the following inputs: an array of N qubits x in arbitrary state (input register), 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898, a qubit y in arbitrary state (output qubit), an array of N integers b, representing the vector . Each element of b will be 0 or 1.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit, b : Int[]) : ()    {        body        {            // your code here        }    }}" 1300
1002D1 "Oracle for f(x) = b * x mod 2" NA "Implement a quantum oracle on N qubits which implements the following function: , where  (a vector of N integers, each of which can be 0 or 1).For an explanation on how this type of quantum oracles works, see Introduction to quantum oracles.You have to implement an operation which takes the following inputs: an array of N qubits x in arbitrary state (input register), 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898, a qubit y in arbitrary state (output qubit), an array of N integers b, representing the vector . Each element of b will be 0 or 1.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (x : Qubit[], y : Qubit, b : Int[]) : ()    {        body        {            // your code here        }    }}" 1200
1002C2 "Distinguish zero state and plus state without errors" NA "You are given a qubit which is guaranteed to be either in  state or in  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was a  state, 1 if it was  state or -1 if you can not decide, i.e., an ""inconclusive"" result. The state of the qubit after the operations does not matter.Note that these states are not orthogonal, and thus can not be distinguished perfectly. In each test your solution will be called 10000 times, and your goals are: never give 0 or 1 answer incorrectly (i.e., never return 0 if input state was  and never return 1 if input state was ), give -1 answer at most 80% of the times, correctly identify  state at least 10% of the times, correctly identify  state at least 10% of the times.In each test  and  states will be provided with 50% probability.You have to implement an operation which takes a qubit as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (q : Qubit) : Int    {        body        {            // your code here        }    }}" 1800
1002C1 "Distinguish zero state and plus state with minimum error" NA "You are given a qubit which is guaranteed to be either in  state or in  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was a  state or 1 if it was  state. The state of the qubit after the operations does not matter.Note that these states are not orthogonal, and thus can not be distinguished perfectly. In each test your solution will be called 1000 times, and your goal is to get a correct answer at least 80% of the times. In each test  and  states will be provided with 50% probability.You have to implement an operation which takes a qubit as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (q : Qubit) : Int    {        body        {            // your code here        }    }}" 1700
1002B4 "Distinguish four 2-qubit states - 2" NA "You are given 2 qubits which are guaranteed to be in one of the four orthogonal states:    Your task is to perform necessary operations and measurements to figure out which state it was and to return the index of that state (0 for , 1 for  etc.). The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of 2 qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int    {        body        {            // your code here        }    }}" 1700
1002B3 "Distinguish four 2-qubit states" NA "You are given 2 qubits which are guaranteed to be in one of the four orthogonal states:    Your task is to perform necessary operations and measurements to figure out which state it was and to return the index of that state (0 for , 1 for  etc.). The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of 2 qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int    {        body        {            // your code here        }    }}" 1600
1002B2 "Distinguish GHZ state and W state" NA "You are given N qubits (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) which are guaranteed to be in one of the two states:   state, or  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was GHZ state or 1 if it was W state. The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of N qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int    {        body        {            // your code here        }    }}" 1600
1002B1 "Distinguish zero state and W state" NA "You are given N qubits (2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) which are guaranteed to be in one of the two states:   state, or  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was  state or 1 if it was W state. The state of the qubits after the operations does not matter.You have to implement an operation which takes an array of N qubits as an input and returns an integer. Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : Int    {        body        {            // your code here        }    }}" 1300
1002A4 "Generate W state" NA "You are given N\xe2\x80\x89=\xe2\x80\x892k qubits (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x894) in zero state . Your task is to create a generalized W state on them. Generalized W state is an equal superposition of all basis states on N qubits that have Hamming weight equal to 1:For example, for N\xe2\x80\x89=\xe2\x80\x891, .You have to implement an operation which takes an array of N qubits as an input and has no output. The ""output"" of the operation is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : ()    {        body        {            // your code here        }    }}" 1900
1002A3 "Generate superposition of two basis states" NA "You are given N qubits (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) in zero state . You are also given two bitstrings bits0 and bits1 which describe two different basis states on N qubits  and .Your task is to generate a state which is an equal superposition of the given basis states:You have to implement an operation which takes the following inputs: an array of qubits qs, two arrays of Boolean values bits0 and bits1 representing the basis states  and . These arrays will have the same length as the array of qubits. bits0 and bits1 will differ in at least one position.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[], bits0 : Bool[], bits1 : Bool[]) : ()    {        body        {            // your code here        }    }}" 1500
1002A2 "Generate superposition of zero state and a basis state" NA "You are given N qubits (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) in zero state . You are also given a bitstring bits which describes a non-zero basis state on N qubits .Your task is to generate a state which is an equal superposition of  and the given basis state:You have to implement an operation which takes the following inputs: an array of qubits qs, an arrays of boolean values bits representing the basis state . This array will have the same length as the array of qubits. The first element of this array bits[0] will be true.The operation doesn\'t have an output; its ""output"" is the state in which it leaves the qubits.An array of boolean values represents a basis state as follows: the i-th element of the array is true if the i-th qubit is in state , and false if it is in state . For example, array [true; false] describes 2-qubit state , and in this case the resulting state should be .Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[], bits : Bool[]) : ()    {        body        {            // your code here        }    }}" 1300
1002A1 "Generate superposition of all basis states" NA "You are given N qubits (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) in zero state . Your task is to generate an equal superposition of all 2N basis vectors on N qubits:For example, for N\xe2\x80\x89=\xe2\x80\x891, the required state is simply , for N\xe2\x80\x89=\xe2\x80\x892, the required state is . You have to implement an operation which takes an array of N qubits as an input and has no output. The ""output"" of the operation is the state in which it leaves the qubits.Your code should have the following signature:namespace Solution {    open Microsoft.Quantum.Primitive;    open Microsoft.Quantum.Canon;    operation Solve (qs : Qubit[]) : ()    {        body        {            // your code here        }    }}" 800
1001I "Deutsch-Jozsa algorithm" "*special problem" "You are given a quantum oracle - an operation on N\xe2\x80\x89+\xe2\x80\x891 qubits which implements a function . You are guaranteed that the function f implemented by the oracle is either constant (returns 0 on all inputs or 1 on all inputs) or balanced (returns 0 on exactly one half of the input domain and 1 on the other half).There are only two possible constant functions: f(x)\xe2\x80\x89=\xe2\x80\x890 and f(x)\xe2\x80\x89=\xe2\x80\x891. The functions implemented by oracles in the two previous problems (f(x)\xe2\x80\x89=\xe2\x80\x89xk and ) are examples of balanced functions.Your task is to figure out whether the function given by the oracle is constant. Your code is allowed to call the given oracle only once." 1700
1001H "Oracle for f(x) = parity of the number of 1s in x" "*special problem" "Implement a quantum oracle on N qubits which implements the following function: , i.e., the value of the function is 1 if x has odd number of 1s, and 0 otherwise." 1200
1001G "Oracle for f(x) = k-th element of x" "*special problem" "Implement a quantum oracle on N qubits which implements a function f(x)\xe2\x80\x89=\xe2\x80\x89xk, i.e. the value of the function is the value of the k-th qubit.For an explanation on how the quantum oracles work, see the tutorial blog post." 1400
1001F "Distinguish multi-qubit basis states" "*special problem" "You are given N qubits which are guaranteed to be in one of two basis states on N qubits. You are also given two bitstrings bits0 and bits1 which describe these basis states.Your task is to perform necessary operations and measurements to figure out which state it was and to return 0 if it was the state described with bits0 or 1 if it was the state described with bits1. The state of the qubits after the operations does not matter." 1300
1001E "Distinguish Bell states" "*special problem" "You are given two qubits which are guaranteed to be in one of the Bell states:    Your task is to perform necessary operations and measurements to figure out which state it was and to return the index of that state (0 for , 1 for  etc.). The state of the qubits after the operations does not matter." 1600
1001D "Distinguish plus state and minus state" "*special problem" "You are given a qubit which is guaranteed to be either in  or in  state. Your task is to perform necessary operations and measurements to figure out which state it was and to return 1 if it was a  state or -1 if it was  state. The state of the qubit after the operations does not matter." 1400
1001C "Generate GHZ state" "*special problem" "You are given N qubits (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x898) in zero state . Your task is to create Greenberger\xe2\x80\x93Horne\xe2\x80\x93Zeilinger (GHZ) state on them:Note that for N\xe2\x80\x89=\xe2\x80\x891 and N\xe2\x80\x89=\xe2\x80\x892 GHZ state becomes states  and  from the previous tasks, respectively." 1400
1001B "Generate Bell state" "*special problem" "You are given two qubits in state  and an integer index. Your task is to create one of the Bell states on them according to the index:" 1400
1001A "Generate plus state or minus state" "*special problem" "You are given a qubit in state  and an integer sign. Your task is to convert the given qubit to state  if sign\xe2\x80\x89=\xe2\x80\x891 or  if sign\xe2\x80\x89=\xe2\x80\x89\xe2\x80\x89-\xe2\x80\x891." 1100
1000G Two-Paths "data structures,dp,trees" "You are given a weighted tree (undirected connected graph with no cycles, loops or multiple edges) with n vertices. The edge {uj,vj} has weight wj. Also each vertex i has its own value ai assigned to it.Let\'s call a path starting in vertex u and ending in vertex v, where each edge can appear no more than twice (regardless of direction), a 2-path. Vertices can appear in the 2-path multiple times (even start and end vertices).For some 2-path p profit Pr(p)=\xe2\x88\x91v\xe2\x88\x88distinct vertices in pav\xe2\x88\x92\xe2\x88\x91e\xe2\x88\x88distinct edges in pke\xe2\x8b\x85we, where ke is the number of times edge e appears in p. That is, vertices are counted once, but edges are counted the number of times they appear in p.You are about to answer m queries. Each query is a pair of vertices (qu,qv). For each query find 2-path p from qu to qv with maximal profit Pr(p)." 2700
1000F "One Occurrence" "data structures,divide and conquer" "You are given an array a consisting of n integers, and q queries to it. i-th query is denoted by two integers li and ri. For each query, you have to find any integer that occurs exactly once in the subarray of a from index li to index ri (a subarray is a contiguous subsegment of an array). For example, if a=[1,1,2,3,2,4], then for query (li=2,ri=6) the subarray we are interested in is [1,2,3,2,4], and possible answers are 1, 3 and 4; for query (li=1,ri=2) the subarray we are interested in is [1,1], and there is no such element that occurs exactly once.Can you answer all of the queries?" 2400
1000E "We Need More Bosses" "dfs and similar,graphs,trees" "Your friend is developing a computer game. He has already decided how the game world should look like \xe2\x80\x94 it should consist of n locations connected by m two-way passages. The passages are designed in such a way that it should be possible to get from any location to any other location.Of course, some passages should be guarded by the monsters (if you just can go everywhere without any difficulties, then it\'s not fun, right?). Some crucial passages will be guarded by really fearsome monsters, requiring the hero to prepare for battle and designing his own tactics of defeating them (commonly these kinds of monsters are called bosses). And your friend wants you to help him place these bosses.The game will start in location s and end in location t, but these locations are not chosen yet. After choosing these locations, your friend will place a boss in each passage such that it is impossible to get from s to t without using this passage. Your friend wants to place as much bosses as possible (because more challenges means more fun, right?), so he asks you to help him determine the maximum possible number of bosses, considering that any location can be chosen as s or as t." 2100
1000D "Yet Another Problem On a Subsequence" combinatorics,dp "The sequence of integers a1,a2,\xe2\x80\xa6,ak is called a good array if a1=k\xe2\x88\x921 and a1>0. For example, the sequences [3,\xe2\x88\x921,44,0],[1,\xe2\x88\x9299] are good arrays, and the sequences [3,7,8],[2,5,4,1],[0] \xe2\x80\x94 are not.A sequence of integers is called good if it can be divided into a positive number of good arrays. Each good array should be a subsegment of sequence and each element of the sequence should belong to exactly one array. For example, the sequences [2,\xe2\x88\x923,0,1,4], [1,2,3,\xe2\x88\x923,\xe2\x88\x929,4] are good, and the sequences [2,\xe2\x88\x923,0,1], [1,2,3,\xe2\x88\x923\xe2\x88\x929,4,1] \xe2\x80\x94 are not.For a given sequence of numbers, count the number of its subsequences that are good sequences, and print the number of such subsequences modulo 998244353." 1900
1000C "Covered Points Count" "data structures,implementation,sortings" "You are given n segments on a coordinate line; each endpoint of every segment has integer coordinates. Some segments can degenerate to points. Segments can intersect with each other, be nested in each other or even coincide.Your task is the following: for every k\xe2\x88\x88[1..n], calculate the number of points with integer coordinates such that the number of segments that cover these points equals k. A segment with endpoints li and ri covers point x if and only if li\xe2\x89\xa4x\xe2\x89\xa4ri." 1700
1000B "Light It Up" greedy "Recently, you bought a brand new smart lamp with programming features. At first, you set up a schedule to the lamp. Every day it will turn power on at moment 0 and turn power off at moment M. Moreover, the lamp allows you to set a program of switching its state (states are ""lights on"" and ""lights off""). Unfortunately, some program is already installed into the lamp.The lamp allows only good programs. Good program can be represented as a non-empty array a, where 0<a1<a2<\xe2\x8b\xaf<a|a|<M. All ai must be integers. Of course, preinstalled program is a good program.The lamp follows program a in next manner: at moment 0 turns power and light on. Then at moment ai the lamp flips its state to opposite (if it was lit, it turns off, and vice versa). The state of the lamp flips instantly: for example, if you turn the light off at moment 1 and then do nothing, the total time when the lamp is lit will be 1. Finally, at moment M the lamp is turning its power off regardless of its state.Since you are not among those people who read instructions, and you don\'t understand the language it\'s written in, you realize (after some testing) the only possible way to alter the preinstalled program. You can insert at most one element into the program a, so it still should be a good program after alteration. Insertion can be done between any pair of consecutive elements of a, or even at the begining or at the end of a.Find such a way to alter the program that the total time when the lamp is lit is maximum possible. Maybe you should leave program untouched. If the lamp is lit from x till moment y, then its lit for y\xe2\x88\x92x units of time. Segments of time when the lamp is lit are summed up." 1500
1000A "Codehorses T-shirts" greedy,implementation "Codehorses has just hosted the second Codehorses Cup. This year, the same as the previous one, organizers are giving T-shirts for the winners.The valid sizes of T-shirts are either ""M"" or from 0 to 3 ""X"" followed by ""S"" or ""L"". For example, sizes ""M"", ""XXS"", ""L"", ""XXXL"" are valid and ""XM"", ""Z"", ""XXXXL"" are not.There are n winners to the cup for both the previous year and the current year. Ksenia has a list with the T-shirt sizes printed for the last year cup and is yet to send the new list to the printing office. Organizers want to distribute the prizes as soon as possible, so now Ksenia is required not to write the whole list from the scratch but just make some changes to the list of the previous year. In one second she can choose arbitrary position in any word and replace its character with some uppercase Latin letter. Ksenia can\'t remove or add letters in any of the words.What is the minimal number of seconds Ksenia is required to spend to change the last year list to the current one?The lists are unordered. That means, two lists are considered equal if and only if the number of occurrences of any string is the same in both lists." 1200
999F "Cards and Joy" dp "There are n players sitting at the card table. Each player has a favorite number. The favorite number of the j-th player is fj.There are k\xe2\x8b\x85n cards on the table. Each card contains a single integer: the i-th card contains number ci. Also, you are given a sequence h1,h2,\xe2\x80\xa6,hk. Its meaning will be explained below.The players have to distribute all the cards in such a way that each of them will hold exactly k cards. After all the cards are distributed, each player counts the number of cards he has that contains his favorite number. The joy level of a player equals ht if the player holds t cards containing his favorite number. If a player gets no cards with his favorite number (i.e., t=0), his joy level is 0.Print the maximum possible total joy levels of the players after the cards are distributed. Note that the sequence h1,\xe2\x80\xa6,hk is the same for all the players." 2000
999E "Reachability from the Capital" "dfs and similar,graphs,greedy" "There are n cities and m roads in Berland. Each road connects a pair of cities. The roads in Berland are one-way.What is the minimum number of new roads that need to be built to make all the cities reachable from the capital?New roads will also be one-way." 2000
999D "Equalize the Remainders" "data structures,greedy,implementation" "You are given an array consisting of n integers a1,a2,\xe2\x80\xa6,an, and a positive integer m. It is guaranteed that m is a divisor of n.In a single move, you can choose any position i between 1 and n and increase ai by 1.Let\'s calculate cr (0\xe2\x89\xa4r\xe2\x89\xa4m\xe2\x88\x921) \xe2\x80\x94 the number of elements having remainder r when divided by m. In other words, for each remainder, let\'s find the number of corresponding elements in a with that remainder.Your task is to change the array in such a way that c0=c1=\xe2\x8b\xaf=cm\xe2\x88\x921=nm.Find the minimum number of moves to satisfy the above requirement." 1900
999C "Alphabetic Removals" implementation "You are given a string s consisting of n lowercase Latin letters. Polycarp wants to remove exactly k characters (k\xe2\x89\xa4n) from the string s. Polycarp uses the following algorithm k times:  if there is at least one letter \'a\', remove the leftmost occurrence and stop the algorithm, otherwise go to next item;  if there is at least one letter \'b\', remove the leftmost occurrence and stop the algorithm, otherwise go to next item;  ...  remove the leftmost occurrence of the letter \'z\' and stop the algorithm. This algorithm removes a single letter from the string. Polycarp performs this algorithm exactly k times, thus removing exactly k characters.Help Polycarp find the resulting string." 1200
999B "Reversing Encryption" implementation "A string s of length n can be encrypted by the following algorithm:  iterate over all divisors of n in decreasing order (i.e. from n to 1),  for each divisor d, reverse the substring s[1\xe2\x80\xa6d] (i.e. the substring which starts at position 1 and ends at position d). For example, the above algorithm applied to the string s=""codeforces"" leads to the following changes: ""codeforces"" \xe2\x86\x92 ""secrofedoc"" \xe2\x86\x92 ""orcesfedoc"" \xe2\x86\x92 ""rocesfedoc"" \xe2\x86\x92 ""rocesfedoc"" (obviously, the last reverse operation doesn\'t change the string because d=1).You are given the encrypted string t. Your task is to decrypt this string, i.e., to find a string s such that the above algorithm results in string t. It can be proven that this string s always exists and is unique." 900
999A "Mishka and Contest" "brute force,implementation" "Mishka started participating in a programming contest. There are n problems in the contest. Mishka\'s problem-solving skill is equal to k.Mishka arranges all problems from the contest into a list. Because of his weird principles, Mishka only solves problems from one of the ends of the list. Every time, he chooses which end (left or right) he will solve the next problem from. Thus, each problem Mishka solves is either the leftmost or the rightmost problem in the list.Mishka cannot solve a problem with difficulty greater than k. When Mishka solves the problem, it disappears from the list, so the length of the list decreases by 1. Mishka stops when he is unable to solve any problem from any end of the list.How many problems can Mishka solve?" 800
998B Cutting dp,greedy,sortings "There are a lot of things which could be cut \xe2\x80\x94 trees, paper, ""the rope"". In this problem you are going to cut a sequence of integers.There is a sequence of integers, which contains the equal number of even and odd numbers. Given a limited budget, you need to make maximum possible number of cuts such that each resulting segment will have the same number of odd and even integers.Cuts separate a sequence to continuous (contiguous) segments. You may think about each cut as a break between two adjacent elements in a sequence. So after cutting each element belongs to exactly one segment. Say, [4,1,2,3,4,5,4,4,5,5] \xe2\x86\x92 two cuts \xe2\x86\x92 [4,1|2,3,4,5|4,4,5,5]. On each segment the number of even elements should be equal to the number of odd elements.The cost of the cut between x and y numbers is |x\xe2\x88\x92y| bitcoins. Find the maximum possible number of cuts that can be made while spending no more than B bitcoins." 1200
998A Balloons "constructive algorithms,implementation" "There are quite a lot of ways to have fun with inflatable balloons. For example, you can fill them with water and see what happens.Grigory and Andrew have the same opinion. So, once upon a time, they went to the shop and bought n packets with inflatable balloons, where i-th of them has exactly ai balloons inside.They want to divide the balloons among themselves. In addition, there are several conditions to hold:  Do not rip the packets (both Grigory and Andrew should get unbroken packets);  Distribute all packets (every packet should be given to someone);  Give both Grigory and Andrew at least one packet;  To provide more fun, the total number of balloons in Grigory\'s packets should not be equal to the total number of balloons in Andrew\'s packets. Help them to divide the balloons or determine that it\'s impossible under these conditions." 1000
997E "Good Subsegments" "data structures" "A permutation p of length n is a sequence p1,p2,\xe2\x80\xa6,pn consisting of n distinct integers, each of which from 1 to n (1\xe2\x89\xa4pi\xe2\x89\xa4n) .Let\'s call the subsegment [l,r] of the permutation good if all numbers from the minimum on it to the maximum on this subsegment occur among the numbers pl,pl+1,\xe2\x80\xa6,pr.For example, good segments of permutation [1,3,2,5,4] are:  [1,1],  [1,3],  [1,5],  [2,2],  [2,3],  [2,5],  [3,3],  [4,4],  [4,5],  [5,5]. You are given a permutation p1,p2,\xe2\x80\xa6,pn.You need to answer q queries of the form: find the number of good subsegments of the given segment of permutation.In other words, to answer one query, you need to calculate the number of good subsegments [x\xe2\x80\xa6y] for some given segment [l\xe2\x80\xa6r], such that l\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4r." 3000
997D "Cycles in product" "combinatorics,divide and conquer,trees" "Consider a tree (that is, an undirected connected graph without loops) T1 and a tree T2. Let\'s define their cartesian product T1\xc3\x97T2 in a following way.Let V be the set of vertices in T1 and U be the set of vertices in T2.Then the set of vertices of graph T1\xc3\x97T2 is V\xc3\x97U, that is, a set of ordered pairs of vertices, where the first vertex in pair is from V and the second \xe2\x80\x94 from U.Let\'s draw the following edges: Between (v,u1) and (v,u2) there is an undirected edge, if u1 and u2 are adjacent in U.  Similarly, between (v1,u) and (v2,u) there is an undirected edge, if v1 and v2 are adjacent in V. Please see the notes section for the pictures of products of trees in the sample tests.Let\'s examine the graph T1\xc3\x97T2. How much cycles (not necessarily simple) of length k it contains? Since this number can be very large, print it modulo 998244353.The sequence of vertices w1, w2, ..., wk, where wi\xe2\x88\x88V\xc3\x97U called cycle, if any neighboring vertices are adjacent and w1 is adjacent to wk. Cycles that differ only by the cyclic shift or direction of traversal are still considered different." 2900
997C "Sky Full of Stars" combinatorics,math "On one of the planets of Solar system, in Atmosphere University, many students are fans of bingo game.It is well known that one month on this planet consists of n2 days, so calendars, represented as square matrix n by n are extremely popular.Weather conditions are even more unusual. Due to the unique composition of the atmosphere, when interacting with sunlight, every day sky takes one of three colors: blue, green or red.To play the bingo, you need to observe the sky for one month \xe2\x80\x94 after each day, its cell is painted with the color of the sky in that day, that is, blue, green or red.At the end of the month, students examine the calendar. If at least one row or column contains only cells of one color, that month is called lucky.Let\'s call two colorings of calendar different, if at least one cell has different colors in them. It is easy to see that there are 3n\xe2\x8b\x85n different colorings. How much of them are lucky? Since this number can be quite large, print it modulo 998244353." 2500
997B "Roman Digits" "brute force,combinatorics,dp,greedy,math" "Let\'s introduce a number system which is based on a roman digits. There are digits I, V, X, L which correspond to the numbers 1, 5, 10 and 50 respectively. The use of other roman digits is not allowed.Numbers in this system are written as a sequence of one or more digits. We define the value of the sequence simply as the sum of digits in it.For example, the number XXXV evaluates to 35 and the number IXI \xe2\x80\x94 to 12.Pay attention to the difference to the traditional roman system \xe2\x80\x94 in our system any sequence of digits is valid, moreover the order of digits doesn\'t matter, for example IX means 11, not 9.One can notice that this system is ambiguous, and some numbers can be written in many different ways. Your goal is to determine how many distinct integers can be represented by exactly n roman digits I, V, X, L." 2000
997A "Convert to Ones" "brute force,greedy,implementation,math" "You\'ve got a string a1,a2,\xe2\x80\xa6,an, consisting of zeros and ones.Let\'s call a sequence of consecutive elements ai,ai\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\xa6,\xe2\x80\x89aj (1\xe2\x89\xa4\xe2\x80\x89i\xe2\x89\xa4\xe2\x80\x89j\xe2\x89\xa4\xe2\x80\x89n) a substring of string a. You can apply the following operations any number of times:  Choose some substring of string a (for example, you can choose entire string) and reverse it, paying x coins for it (for example, \xc2\xab0101101\xc2\xbb \xe2\x86\x92 \xc2\xab0111001\xc2\xbb);  Choose some substring of string a (for example, you can choose entire string or just one symbol) and replace each symbol to the opposite one (zeros are replaced by ones, and ones \xe2\x80\x94 by zeros), paying y coins for it (for example, \xc2\xab0101101\xc2\xbb \xe2\x86\x92 \xc2\xab0110001\xc2\xbb). You can apply these operations in any order. It is allowed to apply the operations multiple times to the same substring.What is the minimum number of coins you need to spend to get a string consisting only of ones?" 1500
996B "World Cup" "binary search,math" "Allen wants to enter a fan zone that occupies a round square and has n entrances.There already is a queue of ai people in front of the i-th entrance. Each entrance allows one person from its queue to enter the fan zone in one minute.Allen uses the following strategy to enter the fan zone:   Initially he stands in the end of the queue in front of the first entrance.  Each minute, if he is not allowed into the fan zone during the minute (meaning he is not the first in the queue), he leaves the current queue and stands in the end of the queue of the next entrance (or the first entrance if he leaves the last entrance). Determine the entrance through which Allen will finally enter the fan zone." 1300
996A "Hit the Lottery" dp,greedy "Allen has a LOT of money. He has n dollars in the bank. For security reasons, he wants to withdraw it in cash (we will not disclose the reasons here). The denominations for dollar bills are 1, 5, 10, 20, 100. What is the minimum number of bills Allen could receive after withdrawing his entire balance?" 800
995F "Cowmpany Cowmpensation" combinatorics,dp,math,trees "Allen, having graduated from the MOO Institute of Techcowlogy (MIT), has started a startup! Allen is the president of his startup. He also hires n\xe2\x88\x921 other employees, each of which is assigned a direct superior. If u is a superior of v and v is a superior of w then also u is a superior of w. Additionally, there are no u and v such that u is the superior of v and v is the superior of u. Allen himself has no superior. Allen is employee number 1, and the others are employee numbers 2 through n.Finally, Allen must assign salaries to each employee in the company including himself. Due to budget constraints, each employee\'s salary is an integer between 1 and D. Additionally, no employee can make strictly more than his superior.Help Allen find the number of ways to assign salaries. As this number may be large, output it modulo 109+7." 2700
995E "Number Clicker" "divide and conquer,graphs,meet-in-the-middle,number theory" "Allen is playing Number Clicker on his phone.He starts with an integer u on the screen. Every second, he can press one of 3 buttons.  Turn u\xe2\x86\x92u+1(modp).  Turn u\xe2\x86\x92u+p\xe2\x88\x921(modp).  Turn u\xe2\x86\x92up\xe2\x88\x922(modp). Allen wants to press at most 200 buttons and end up with v on the screen. Help him!" 2700
995D Game math "Allen and Bessie are playing a simple number game. They both know a function f:{0,1}n\xe2\x86\x92R, i. e. the function takes n binary arguments and returns a real value. At the start of the game, the variables x1,x2,\xe2\x80\xa6,xn are all set to \xe2\x88\x921. Each round, with equal probability, one of Allen or Bessie gets to make a move. A move consists of picking an i such that xi=\xe2\x88\x921 and either setting xi\xe2\x86\x920 or xi\xe2\x86\x921.After n rounds all variables are set, and the game value resolves to f(x1,x2,\xe2\x80\xa6,xn). Allen wants to maximize the game value, and Bessie wants to minimize it.Your goal is to help Allen and Bessie find the expected game value! They will play r+1 times though, so between each game, exactly one value of f changes. In other words, between rounds i and i+1 for 1\xe2\x89\xa4i\xe2\x89\xa4r, f(z1,\xe2\x80\xa6,zn)\xe2\x86\x92gi for some (z1,\xe2\x80\xa6,zn)\xe2\x88\x88{0,1}n. You are to find the expected game value in the beginning and after each change." 2500
995C "Leaving the Bar" "brute force,data structures,geometry,greedy,math,sortings" "For a vector \xe2\x86\x92v=(x,y), define |v|=\xe2\x88\x9ax2+y2.Allen had a bit too much to drink at the bar, which is at the origin. There are n vectors \xe2\x86\x92v1,\xe2\x86\x92v2,\xe2\x8b\xaf,\xe2\x86\x92vn. Allen will make n moves. As Allen\'s sense of direction is impaired, during the i-th move he will either move in the direction \xe2\x86\x92vi or \xe2\x88\x92\xe2\x86\x92vi. In other words, if his position is currently p=(x,y), he will either move to p+\xe2\x86\x92vi or p\xe2\x88\x92\xe2\x86\x92vi.Allen doesn\'t want to wander too far from home (which happens to also be the bar). You need to help him figure out a sequence of moves (a sequence of signs for the vectors) such that his final position p satisfies |p|\xe2\x89\xa41.5\xe2\x8b\x85106 so that he can stay safe." 2300
995B "Suit and Tie" greedy,implementation,math "Allen is hosting a formal dinner party. 2n people come to the event in n pairs (couples). After a night of fun, Allen wants to line everyone up for a final picture. The 2n people line up, but Allen doesn\'t like the ordering. Allen prefers if each pair occupies adjacent positions in the line, as this makes the picture more aesthetic.Help Allen find the minimum number of swaps of adjacent positions he must perform to make it so that each couple occupies adjacent positions in the line." 1400
995A Tesla "constructive algorithms,implementation" "Allen dreams of one day owning a enormous fleet of electric cars, the car of the future! He knows that this will give him a big status boost. As Allen is planning out all of the different types of cars he will own and how he will arrange them, he realizes that he has a problem. Allen\'s future parking lot can be represented as a rectangle with 4 rows and n (n\xe2\x89\xa450) columns of rectangular spaces, each of which can contain at most one car at any time. He imagines having k (k\xe2\x89\xa42n) cars in the grid, and all the cars are initially in the second and third rows. Each of the cars also has a different designated parking space in the first or fourth row. Allen has to put the cars into corresponding parking places.  Illustration to the first example. However, since Allen would never entrust his cars to anyone else, only one car can be moved at a time. He can drive a car from a space in any of the four cardinal directions to a neighboring empty space. Furthermore, Allen can only move one of his cars into a space on the first or fourth rows if it is the car\'s designated parking space. Allen knows he will be a very busy man, and will only have time to move cars at most 20000 times before he realizes that moving cars is not worth his time. Help Allen determine if he should bother parking his cars or leave it to someone less important." 2100
994B "Knights of a Polygonal Table" greedy,implementation,sortings "Unlike Knights of a Round Table, Knights of a Polygonal Table deprived of nobility and happy to kill each other. But each knight has some power and a knight can kill another knight if and only if his power is greater than the power of victim. However, even such a knight will torment his conscience, so he can kill no more than k other knights. Also, each knight has some number of coins. After a kill, a knight can pick up all victim\'s coins.Now each knight ponders: how many coins he can have if only he kills other knights?You should answer this question for each knight." 1400
994A Fingerprints implementation "You are locked in a room with a door that has a keypad with 10 keys corresponding to digits from 0 to 9. To escape from the room, you need to enter a correct code. You also have a sequence of digits.Some keys on the keypad have fingerprints. You believe the correct code is the longest not necessarily contiguous subsequence of the sequence you have that only contains digits with fingerprints on the corresponding keys. Find such code." 800
993F "The Moral Dilemma" NA "Hibiki and Dita are in love with each other, but belong to communities that are in a long lasting conflict. Hibiki is deeply concerned with the state of affairs, and wants to figure out if his relationship with Dita is an act of love or an act of treason.  Hibiki prepared several binary features his decision will depend on, and built a three layer logical circuit on top of them, each layer consisting of one or more logic gates. Each gate in the circuit is either ""or"", ""and"", ""nor"" (not or) or ""nand"" (not and). Each gate in the first layer is connected to exactly two features. Each gate in the second layer is connected to exactly two gates in the first layer. The third layer has only one ""or"" gate, which is connected to all the gates in the second layer (in other words, the entire circuit produces 1 if and only if at least one gate in the second layer produces 1).The problem is, Hibiki knows very well that when the person is in love, his ability to think logically degrades drastically. In particular, it is well known that when a person in love evaluates a logical circuit in his mind, every gate evaluates to a value that is the opposite of what it was supposed to evaluate to. For example, ""or"" gates return 1 if and only if both inputs are zero, ""t{nand}"" gates produce 1 if and only if both inputs are one etc.In particular, the ""or"" gate in the last layer also produces opposite results, and as such if Hibiki is in love, the entire circuit produces 1 if and only if all the gates on the second layer produced 0.Hibiki can\xe2\x80\x99t allow love to affect his decision. He wants to know what is the smallest number of gates that needs to be removed from the second layer so that the output of the circuit for all possible inputs doesn\'t depend on whether Hibiki is in love or not." 3200
993E "Nikita and Order Statistics" "chinese remainder theorem,fft,math" "Nikita likes tasks on order statistics, for example, he can easily find the k-th number in increasing order on a segment of an array. But now Nikita wonders how many segments of an array there are such that a given number x is the k-th number in increasing order on this segment. In other words, you should find the number of segments of a given array such that there are exactly k numbers of this segment which are less than x.Nikita wants to get answer for this question for each k from 0 to n, where n is the size of the array." 2300
993D "Compute Power" "binary search,dp,greedy" "You need to execute several tasks, each associated with number of processors it needs, and the compute power it will consume.You have sufficient number of analog computers, each with enough processors for any task. Each computer can execute up to one task at a time, and no more than two tasks total. The first task can be any, the second task on each computer must use strictly less power than the first. You will assign between 1 and 2 tasks to each computer. You will then first execute the first task on each computer, wait for all of them to complete, and then execute the second task on each computer that has two tasks assigned.If the average compute power per utilized processor (the sum of all consumed powers for all tasks presently running divided by the number of utilized processors) across all computers exceeds some unknown threshold during the execution of the first tasks, the entire system will blow up. There is no restriction on the second tasks execution. Find the lowest threshold for which it is possible.Due to the specifics of the task, you need to print the answer multiplied by 1000 and rounded up." 2500
993C "Careful Maneuvering" "bitmasks,brute force,geometry" "There are two small spaceship, surrounded by two groups of enemy larger spaceships. The space is a two-dimensional plane, and one group of the enemy spaceships is positioned in such a way that they all have integer y-coordinates, and their x-coordinate is equal to \xe2\x88\x92100, while the second group is positioned in such a way that they all have integer y-coordinates, and their x-coordinate is equal to 100.Each spaceship in both groups will simultaneously shoot two laser shots (infinite ray that destroys any spaceship it touches), one towards each of the small spaceships, all at the same time. The small spaceships will be able to avoid all the laser shots, and now want to position themselves at some locations with x=0 (with not necessarily integer y-coordinates), such that the rays shot at them would destroy as many of the enemy spaceships as possible. Find the largest numbers of spaceships that can be destroyed this way, assuming that the enemy spaceships can\'t avoid laser shots." 2100
993B "Open Communication" "bitmasks,brute force" "Two participants are each given a pair of distinct numbers from 1 to 9 such that there\'s exactly one number that is present in both pairs. They want to figure out the number that matches by using a communication channel you have access to without revealing it to you.Both participants communicated to each other a set of pairs of numbers, that includes the pair given to them. Each pair in the communicated sets comprises two different numbers.Determine if you can with certainty deduce the common number, or if you can determine with certainty that both participants know the number but you do not." 1900
993A "Two Squares" geometry,implementation "You are given two squares, one with sides parallel to the coordinate axes, and another one with sides at 45 degrees to the coordinate axes. Find whether the two squares intersect.The interior of the square is considered to be part of the square, i.e. if one square is completely inside another, they intersect. If the two squares only share one common point, they are also considered to intersect." 1600
992E "Nastya and King-Shamans" "binary search,data structures" "Nastya likes reading and even spends whole days in a library sometimes. Today she found a chronicle of Byteland in the library, and it stated that there lived shamans long time ago. It is known that at every moment there was exactly one shaman in Byteland, and there were n shamans in total enumerated with integers from 1 to n in the order they lived. Also, each shaman had a magic power which can now be expressed as an integer.The chronicle includes a list of powers of the n shamans. Also, some shamans can be king-shamans, if they gathered all the power of their predecessors, i.e. their power is exactly the sum of powers of all previous shamans. Nastya is interested in whether there was at least one king-shaman in Byteland.Unfortunately many of the powers are unreadable in the list, so Nastya is doing the following:  Initially she supposes some power for each shaman.  After that she changes the power of some shaman q times (the shamans can differ) and after that wants to check if there is at least one king-shaman in the list. If yes, she wants to know the index of any king-shaman. Unfortunately the list is too large and Nastya wants you to help her." 2500
992D "Nastya and a Game" "brute force,implementation,math" "Nastya received one more array on her birthday, this array can be used to play a traditional Byteland game on it. However, to play the game the players should first select such a subsegment of the array that , where p is the product of all integers on the given array, s is their sum, and k is a given constant for all subsegments. Nastya wonders how many subsegments of the array fit the described conditions. A subsegment of an array is several consecutive integers of the array." 2100
992C "Nastya and a Wardrobe" math "Nastya received a gift on New Year \xe2\x80\x94 a magic wardrobe. It is magic because in the end of each month the number of dresses in it doubles (i.e. the number of dresses becomes twice as large as it is in the beginning of the month).Unfortunately, right after the doubling the wardrobe eats one of the dresses (if any) with the 50% probability. It happens every month except the last one in the year. Nastya owns x dresses now, so she became interested in the expected number of dresses she will have in one year. Nastya lives in Byteland, so the year lasts for k\xe2\x80\x89+\xe2\x80\x891 months.Nastya is really busy, so she wants you to solve this problem. You are the programmer, after all. Also, you should find the answer modulo 109\xe2\x80\x89+\xe2\x80\x897, because it is easy to see that it is always integer." 1600
992B "Nastya Studies Informatics" "math,number theory" "Today on Informatics class Nastya learned about GCD and LCM (see links below). Nastya is very intelligent, so she solved all the tasks momentarily and now suggests you to solve one of them as well.We define a pair of integers (a,\xe2\x80\x89b) good, if GCD(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x89x and LCM(a,\xe2\x80\x89b)\xe2\x80\x89=\xe2\x80\x89y, where GCD(a,\xe2\x80\x89b) denotes the greatest common divisor of a and b, and LCM(a,\xe2\x80\x89b) denotes the least common multiple of a and b.You are given two integers x and y. You are to find the number of good pairs of integers (a,\xe2\x80\x89b) such that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a,\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. Note that pairs (a,\xe2\x80\x89b) and (b,\xe2\x80\x89a) are considered different if a\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89b." 1600
992A "Nastya and an Array" implementation,sortings "Nastya owns too many arrays now, so she wants to delete the least important of them. However, she discovered that this array is magic! Nastya now knows that the array has the following properties:  In one second we can add an arbitrary (possibly negative) integer to all elements of the array that are not equal to zero.  When all elements of the array become equal to zero, the array explodes. Nastya is always busy, so she wants to explode the array as fast as possible. Compute the minimum time in which the array can be exploded." 800
991F "Concise and clear" "brute force,greedy,implementation,math" "Vasya is a regular participant at programming contests and is already experienced in finding important sentences in long statements. Of course, numbers constraints are important \xe2\x80\x94 factorization of a number less than 1000000 is easier than of a number less than 1000000000. However, sometimes it\'s hard to understand the number at the first glance. Could it be shortened? For example, instead of 1000000 you could write 106, instead of 1000000000  \xe2\x80\x94109, instead of 1000000007 \xe2\x80\x94 109+7.Vasya decided that, to be concise, the notation should follow several rules:   the notation should only consist of numbers, operations of addition (""+""), multiplication (""*"") and exponentiation (""^""), in particular, the use of braces is forbidden;  the use of several exponentiation operations in a row is forbidden, for example, writing ""2^3^4"" is unacceptable;  the value of the resulting expression equals to the initial number;  the notation should consist of the minimal amount of symbols. Given n, find the equivalent concise notation for it." 2700
991E "Bus Number" "brute force,combinatorics,math" "This night wasn\'t easy on Vasya. His favorite team lost, and he didn\'t find himself victorious either \xe2\x80\x94 although he played perfectly, his teammates let him down every time. He had to win at least one more time, but the losestreak only grew longer and longer... It\'s no wonder he didn\'t get any sleep this night at all.In the morning, Vasya was waiting the bus to the university on the bus stop. Vasya\'s thoughts were hazy and so he couldn\'t remember the right bus\' number quite right and got onto the bus with the number n.In the bus, Vasya thought that he could get the order of the digits in the number of the bus wrong. Futhermore, he could ""see"" some digits several times, but the digits he saw were definitely in the real number of the bus. For example, if Vasya saw the number 2028, it could mean that the real bus number could be 2028, 8022, 2820 or just 820. However, numbers 80, 22208, 52 definitely couldn\'t be the number of the bus. Also, real bus number couldn\'t start with the digit 0, this meaning that, for example, number 082 couldn\'t be the real bus number too.Given n, determine the total number of possible bus number variants." 1800
991D Bishwock dp,greedy "Bishwock is a chess figure that consists of three squares resembling an ""L-bar"". This figure can be rotated by 90, 180 and 270 degrees so it can have four possible states: XX   XX   .X   X.X.   .X   XX   XX Bishwocks don\'t attack any squares and can even occupy on the adjacent squares as long as they don\'t occupy the same square. Vasya has a board with 2\xc3\x97n squares onto which he wants to put some bishwocks. To his dismay, several squares on this board are already occupied by pawns and Vasya can\'t put bishwocks there. However, pawns also don\'t attack bishwocks and they can occupy adjacent squares peacefully.Knowing the positions of pawns on the board, help Vasya to determine the maximum amount of bishwocks he can put onto the board so that they wouldn\'t occupy the same squares and wouldn\'t occupy squares with pawns." 1500
991C Candies "binary search,implementation" "After passing a test, Vasya got himself a box of n candies. He decided to eat an equal amount of candies each morning until there are no more candies. However, Petya also noticed the box and decided to get some candies for himself.This means the process of eating candies is the following: in the beginning Vasya chooses a single integer k, same for all days. After that, in the morning he eats k candies from the box (if there are less than k candies in the box, he eats them all), then in the evening Petya eats 10% of the candies remaining in the box. If there are still candies left in the box, the process repeats \xe2\x80\x94 next day Vasya eats k candies again, and Petya \xe2\x80\x94 10% of the candies left in a box, and so on.If the amount of candies in the box is not divisible by 10, Petya rounds the amount he takes from the box down. For example, if there were 97 candies in the box, Petya would eat only 9 of them. In particular, if there are less than 10 candies in a box, Petya won\'t eat any at all.Your task is to find out the minimal amount of k that can be chosen by Vasya so that he would eat at least half of the n candies he initially got. Note that the number k must be integer." 1500
991B "Getting an A" greedy,sortings "Translator\'s note: in Russia\'s most widespread grading system, there are four grades: 5, 4, 3, 2, the higher the better, roughly corresponding to A, B, C and F respectively in American grading system.The term is coming to an end and students start thinking about their grades. Today, a professor told his students that the grades for his course would be given out automatically  \xe2\x80\x94 he would calculate the simple average (arithmetic mean) of all grades given out for lab works this term and round to the nearest integer. The rounding would be done in favour of the student \xe2\x80\x94 4.5 would be rounded up to 5 (as in example 3), but 4.4 would be rounded down to 4.This does not bode well for Vasya who didn\'t think those lab works would influence anything, so he may receive a grade worse than 5 (maybe even the dreaded 2). However, the professor allowed him to redo some of his works of Vasya\'s choosing to increase his average grade. Vasya wants to redo as as few lab works as possible in order to get 5 for the course. Of course, Vasya will get 5 for the lab works he chooses to redo.Help Vasya \xe2\x80\x94 calculate the minimum amount of lab works Vasya has to redo." 900
991A "If at first you don\'t succeed..." implementation "Each student eagerly awaits the day he would pass the exams successfully. Thus, Vasya was ready to celebrate, but, alas, he didn\'t pass it. However, many of Vasya\'s fellow students from the same group were more successful and celebrated after the exam.Some of them celebrated in the BugDonalds restaurant, some of them \xe2\x80\x94 in the BeaverKing restaurant, the most successful ones were fast enough to celebrate in both of restaurants. Students which didn\'t pass the exam didn\'t celebrate in any of those restaurants and elected to stay home to prepare for their reexamination. However, this quickly bored Vasya and he started checking celebration photos on the Kilogramm. He found out that, in total, BugDonalds was visited by A students, BeaverKing \xe2\x80\x94 by B students and C students visited both restaurants. Vasya also knows that there are N students in his group.Based on this info, Vasya wants to determine either if his data contradicts itself or, if it doesn\'t, how many students in his group didn\'t pass the exam. Can you help him so he won\'t waste his valuable preparation time?" 1000
990G "GCD Counting" "divide and conquer,dp,dsu,number theory,trees" "You are given a tree consisting of n vertices. A number is written on each vertex; the number on vertex i is equal to ai.Let\'s denote the function g(x,y) as the greatest common divisor of the numbers written on the vertices belonging to the simple path from vertex x to vertex y (including these two vertices).For every integer from 1 to 2\xe2\x8b\x85105 you have to count the number of pairs (x,y) (1\xe2\x89\xa4x\xe2\x89\xa4y\xe2\x89\xa4n) such that g(x,y) is equal to this number." 2400
990F "Flow Control" "dfs and similar,dp,greedy,trees" "You have to handle a very complex water distribution system. The system consists of n junctions and m pipes, i-th pipe connects junctions xi and yi.The only thing you can do is adjusting the pipes. You have to choose m integer numbers f1, f2, ..., fm and use them as pipe settings. i-th pipe will distribute fi units of water per second from junction xi to junction yi (if fi is negative, then the pipe will distribute |fi| units of water per second from junction yi to junction xi). It is allowed to set fi to any integer from \xe2\x88\x922\xe2\x8b\x85109 to 2\xe2\x8b\x85109.In order for the system to work properly, there are some constraints: for every i\xe2\x88\x88[1,n], i-th junction has a number si associated with it meaning that the difference between incoming and outcoming flow for i-th junction must be exactly si (if si is not negative, then i-th junction must receive si units of water per second; if it is negative, then i-th junction must transfer |si| units of water per second to other junctions).Can you choose the integers f1, f2, ..., fm in such a way that all requirements on incoming and outcoming flows are satisfied?" 2400
990E "Post Lamps" "brute force,greedy" "Adilbek\'s house is located on a street which can be represented as the OX axis. This street is really dark, so Adilbek wants to install some post lamps to illuminate it. Street has n positions to install lamps, they correspond to the integer numbers from 0 to n\xe2\x88\x921 on the OX axis. However, some positions are blocked and no post lamp can be placed there.There are post lamps of different types which differ only by their power. When placed in position x, post lamp of power l illuminates the segment [x;x+l]. The power of each post lamp is always a positive integer number.The post lamp shop provides an infinite amount of lamps of each type from power 1 to power k. Though each customer is only allowed to order post lamps of exactly one type. Post lamps of power l cost al each.What is the minimal total cost of the post lamps of exactly one type Adilbek can buy to illuminate the entire segment [0;n] of the street? If some lamps illuminate any other segment of the street, Adilbek does not care, so, for example, he may place a lamp of power 3 in position n\xe2\x88\x921 (even though its illumination zone doesn\'t completely belong to segment [0;n])." 2100
990D "Graph And Its Complement" "constructive algorithms,graphs,implementation" "Given three numbers n,a,b. You need to find an adjacency matrix of such an undirected graph that the number of components in it is equal to a, and the number of components in its complement is b. The matrix must be symmetric, and all digits on the main diagonal must be zeroes.In an undirected graph loops (edges from a vertex to itself) are not allowed. It can be at most one edge between a pair of vertices.The adjacency matrix of an undirected graph is a square matrix of size n consisting only of ""0"" and ""1"", where n is the number of vertices of the graph and the i-th row and the i-th column correspond to the i-th vertex of the graph. The cell (i,j) of the adjacency matrix contains 1 if and only if the i-th and j-th vertices in the graph are connected by an edge.A connected component is a set of vertices X such that for every two vertices from this set there exists at least one path in the graph connecting this pair of vertices, but adding any other vertex to X violates this rule.The complement or inverse of a graph G is a graph H on the same vertices such that two distinct vertices of H are adjacent if and only if they are not adjacent in G." 1700
990C "Bracket Sequences Concatenation Problem" implementation "A bracket sequence is a string containing only characters ""("" and "")"".A regular bracket sequence is a bracket sequence that can be transformed into a correct arithmetic expression by inserting characters ""1"" and ""+"" between the original characters of the sequence. For example, bracket sequences ""()()"", ""(())"" are regular (the resulting expressions are: ""(1)+(1)"", ""((1+1)+1)""), and "")("" and ""("" are not.You are given n bracket sequences s1,s2,\xe2\x80\xa6,sn. Calculate the number of pairs i,j(1\xe2\x89\xa4i,j\xe2\x89\xa4n) such that the bracket sequence si+sj is a regular bracket sequence. Operation + means concatenation i.e. ""()("" + "")()"" = ""()()()"".If si+sj and sj+si are regular bracket sequences and i\xe2\x89\xa0j, then both pairs (i,j) and (j,i) must be counted in the answer. Also, if si+si is a regular bracket sequence, the pair (i,i) must be counted in the answer." 1500
990B Micro-World greedy,sortings "You have a Petri dish with bacteria and you are preparing to dive into the harsh micro-world. But, unfortunately, you don\'t have any microscope nearby, so you can\'t watch them.You know that you have n bacteria in the Petri dish and size of the i-th bacteria is ai. Also you know intergalactic positive integer constant K.The i-th bacteria can swallow the j-th bacteria if and only if ai>aj and ai\xe2\x89\xa4aj+K. The j-th bacteria disappear, but the i-th bacteria doesn\'t change its size. The bacteria can perform multiple swallows. On each swallow operation any bacteria i can swallow any bacteria j if ai>aj and ai\xe2\x89\xa4aj+K. The swallow operations go one after another.For example, the sequence of bacteria sizes a=[101,53,42,102,101,55,54] and K=1. The one of possible sequences of swallows is: [101,53,42,102,101_,55,54] \xe2\x86\x92 [101,53_,42,102,55,54] \xe2\x86\x92 [101_,42,102,55,54] \xe2\x86\x92 [42,102,55,54_] \xe2\x86\x92 [42,102,55]. In total there are 3 bacteria remained in the Petri dish.Since you don\'t have a microscope, you can only guess, what the minimal possible number of bacteria can remain in your Petri dish when you finally will find any microscope." 1200
990A "Commentary Boxes" implementation,math "Berland Football Cup starts really soon! Commentators from all over the world come to the event.Organizers have already built n commentary boxes. m regional delegations will come to the Cup. Every delegation should get the same number of the commentary boxes. If any box is left unoccupied then the delegations will be upset. So each box should be occupied by exactly one delegation.If n is not divisible by m, it is impossible to distribute the boxes to the delegations at the moment.Organizers can build a new commentary box paying a burles and demolish a commentary box paying b burles. They can both build and demolish boxes arbitrary number of times (each time paying a corresponding fee). It is allowed to demolish all the existing boxes.What is the minimal amount of burles organizers should pay to satisfy all the delegations (i.e. to make the number of the boxes be divisible by m)?" 1000
989E "A Trance of Nightfall" dp,geometry,matrices,probabilities "The cool breeze blows gently, the flowing water ripples steadily.""Flowing and passing like this, the water isn\'t gone ultimately; Waxing and waning like that, the moon doesn\'t shrink or grow eventually.""""Everything is transient in a way and perennial in another.""Kanno doesn\'t seem to make much sense out of Mino\'s isolated words, but maybe it\'s time that they enjoy the gentle breeze and the night sky \xe2\x80\x94 the inexhaustible gifts from nature.Gazing into the sky of stars, Kanno indulges in a night\'s tranquil dreams. There is a set S of n points on a coordinate plane.Kanno starts from a point P that can be chosen on the plane. P is not added to S if it doesn\'t belong to S. Then the following sequence of operations (altogether called a move) is repeated several times, in the given order:  Choose a line l such that it passes through at least two elements in S and passes through Kanno\'s current position. If there are multiple such lines, one is chosen equiprobably.  Move to one of the points that belong to S and lie on l. The destination is chosen equiprobably among all possible ones, including Kanno\'s current position (if it does belong to S). There are q queries each consisting of two integers (ti,mi). For each query, you\'re to help Kanno maximize the probability of the stopping position being the ti-th element in S after mi moves with a proper selection of P, and output this maximum probability. Note that according to rule 1, P should belong to at least one line that passes through at least two points from S." 2700
989D "A Shade of Moonlight" "binary search,geometry,math,sortings,two pointers" "Gathering darkness shrouds the woods and the world. The moon sheds its light on the boat and the river.""To curtain off the moonlight should be hardly possible; the shades present its mellow beauty and restful nature."" Intonates Mino.""See? The clouds are coming."" Kanno gazes into the distance.""That can\'t be better,"" Mino turns to Kanno. The sky can be seen as a one-dimensional axis. The moon is at the origin whose coordinate is 0.There are n clouds floating in the sky. Each cloud has the same length l. The i-th initially covers the range of (xi,xi+l) (endpoints excluded). Initially, it moves at a velocity of vi, which equals either 1 or \xe2\x88\x921.Furthermore, no pair of clouds intersect initially, that is, for all 1\xe2\x89\xa4i<j\xe2\x89\xa4n, |xi\xe2\x88\x92xj|\xe2\x89\xa5l.With a wind velocity of w, the velocity of the i-th cloud becomes vi+w. That is, its coordinate increases by vi+w during each unit of time. Note that the wind can be strong and clouds can change their direction.You are to help Mino count the number of pairs (i,j) (i<j), such that with a proper choice of wind velocity w not exceeding wmax in absolute value (possibly negative and/or fractional), the i-th and j-th clouds both cover the moon at the same future moment. This w doesn\'t need to be the same across different pairs." 2500
989C "A Mist of Florescence" "constructive algorithms,graphs" "As the boat drifts down the river, a wood full of blossoms shows up on the riverfront.""I\'ve been here once,"" Mino exclaims with delight, ""it\'s breathtakingly amazing.""""What is it like?""""Look, Kanno, you\'ve got your paintbrush, and I\'ve got my words. Have a try, shall we?"" There are four kinds of flowers in the wood, Amaranths, Begonias, Centaureas and Dianthuses.The wood can be represented by a rectangular grid of n rows and m columns. In each cell of the grid, there is exactly one type of flowers.According to Mino, the numbers of connected components formed by each kind of flowers are a, b, c and d respectively. Two cells are considered in the same connected component if and only if a path exists between them that moves between cells sharing common edges and passes only through cells containing the same flowers.You are to help Kanno depict such a grid of flowers, with n and m arbitrarily chosen under the constraints given below. It can be shown that at least one solution exists under the constraints of this problem.Note that you can choose arbitrary n and m under the constraints below, they are not given in the input." 1800
989B "A Tide of Riverscape" "constructive algorithms,strings" "Walking along a riverside, Mino silently takes a note of something.""Time,"" Mino thinks aloud.""What?""""Time and tide wait for no man,"" explains Mino. ""My name, taken from the river, always reminds me of this.""""And what are you recording?""""You see it, tide. Everything has its own period, and I think I\'ve figured out this one,"" says Mino with confidence.Doubtfully, Kanno peeks at Mino\'s records. The records are expressed as a string s of characters \'0\', \'1\' and \'.\', where \'0\' denotes a low tide, \'1\' denotes a high tide, and \'.\' denotes an unknown one (either high or low).You are to help Mino determine whether it\'s possible that after replacing each \'.\' independently with \'0\' or \'1\', a given integer p is not a period of the resulting string. In case the answer is yes, please also show such a replacement to Mino.In this problem, a positive integer p is considered a period of string s, if for all 1\xe2\x89\xa4i\xe2\x89\xa4|s|\xe2\x88\x92p, the i-th and (i+p)-th characters of s are the same. Here |s| is the length of s." 1200
989A "A Blend of Springtime" implementation,strings "When the curtains are opened, a canvas unfolds outside. Kanno marvels at all the blonde colours along the riverside \xe2\x80\x94 not tangerines, but blossoms instead.""What a pity it\'s already late spring,"" sighs Mino with regret, ""one more drizzling night and they\'d be gone.""""But these blends are at their best, aren\'t they?"" Absorbed in the landscape, Kanno remains optimistic. The landscape can be expressed as a row of consecutive cells, each of which either contains a flower of colour amber or buff or canary yellow, or is empty.When a flower withers, it disappears from the cell that it originally belonged to, and it spreads petals of its colour in its two neighbouring cells (or outside the field if the cell is on the side of the landscape). In case petals fall outside the given cells, they simply become invisible.You are to help Kanno determine whether it\'s possible that after some (possibly none or all) flowers shed their petals, at least one of the cells contains all three colours, considering both petals and flowers. Note that flowers can wither in arbitrary order." 900
988F "Rain and Umbrellas" dp "Polycarp lives on a coordinate line at the point x=0. He goes to his friend that lives at the point x=a. Polycarp can move only from left to right, he can pass one unit of length each second.Now it\'s raining, so some segments of his way are in the rain. Formally, it\'s raining on n non-intersecting segments, the i-th segment which is in the rain is represented as [li,ri] (0\xe2\x89\xa4li<ri\xe2\x89\xa4a).There are m umbrellas lying on the line, the i-th umbrella is located at point xi (0\xe2\x89\xa4xi\xe2\x89\xa4a) and has weight pi. When Polycarp begins his journey, he doesn\'t have any umbrellas.During his journey from x=0 to x=a Polycarp can pick up and throw away umbrellas. Polycarp picks up and throws down any umbrella instantly. He can carry any number of umbrellas at any moment of time. Because Polycarp doesn\'t want to get wet, he must carry at least one umbrella while he moves from x to x+1 if a segment [x,x+1] is in the rain (i.e. if there exists some i such that li\xe2\x89\xa4x and x+1\xe2\x89\xa4ri).The condition above is the only requirement. For example, it is possible to go without any umbrellas to a point where some rain segment starts, pick up an umbrella at this point and move along with an umbrella. Polycarp can swap umbrellas while he is in the rain.Each unit of length passed increases Polycarp\'s fatigue by the sum of the weights of umbrellas he carries while moving.Can Polycarp make his way from point x=0 to point x=a? If yes, find the minimum total fatigue after reaching x=a, if Polycarp picks up and throws away umbrellas optimally." 2100
988E "Divisibility by 25" "brute force,greedy" "You are given an integer n from 1 to 1018 without leading zeroes.In one move you can swap any two adjacent digits in the given number in such a way that the resulting number will not contain leading zeroes. In other words, after each move the number you have cannot contain any leading zeroes.What is the minimum number of moves you have to make to obtain a number that is divisible by 25? Print -1 if it is impossible to obtain a number that is divisible by 25." 2100
988D "Points and Powers of Two" "brute force,math" "There are n distinct points on a coordinate line, the coordinate of i-th point equals to xi. Choose a subset of the given set of points such that the distance between each pair of points in a subset is an integral power of two. It is necessary to consider each pair of points, not only adjacent. Note that any subset containing one element satisfies the condition above. Among all these subsets, choose a subset with maximum possible size.In other words, you have to choose the maximum possible number of points xi1,xi2,\xe2\x80\xa6,xim such that for each pair xij, xik it is true that |xij\xe2\x88\x92xik|=2d where d is some non-negative integer number (not necessarily the same for each pair of points)." 1800
988C "Equal Sums" implementation,sortings "You are given k sequences of integers. The length of the i-th sequence equals to ni.You have to choose exactly two sequences i and j (i\xe2\x89\xa0j) such that you can remove exactly one element in each of them in such a way that the sum of the changed sequence i (its length will be equal to ni\xe2\x88\x921) equals to the sum of the changed sequence j (its length will be equal to nj\xe2\x88\x921).Note that it\'s required to remove exactly one element in each of the two chosen sequences.Assume that the sum of the empty (of the length equals 0) sequence is 0." 1400
988B "Substrings Sort" sortings,strings "You are given n strings. Each string consists of lowercase English letters. Rearrange (reorder) the given strings in such a way that for every string, all strings that are placed before it are its substrings.String a is a substring of string b if it is possible to choose several consecutive letters in b in such a way that they form a. For example, string ""for"" is contained as a substring in strings ""codeforces"", ""for"" and ""therefore"", but is not contained as a substring in strings ""four"", ""fofo"" and ""rof""." 1100
988A "Diverse Team" "brute force,implementation" "There are n students in a school class, the rating of the i-th student on Codehorses is ai. You have to form a team consisting of k students (1\xe2\x89\xa4k\xe2\x89\xa4n) such that the ratings of all team members are distinct.If it is impossible to form a suitable team, print ""NO"" (without quotes). Otherwise print ""YES"", and then print k distinct numbers which should be the indices of students in the team you form. If there are multiple answers, print any of them." 800
987C "Three displays" "brute force,dp,implementation" "It is the middle of 2018 and Maria Stepanovna, who lives outside Krasnokamensk (a town in Zabaikalsky region), wants to rent three displays to highlight an important problem.There are n displays placed along a road, and the i-th of them can display a text with font size si only. Maria Stepanovna wants to rent such three displays with indices i<j<k that the font size increases if you move along the road in a particular direction. Namely, the condition si<sj<sk should be held.The rent cost is for the i-th display is ci. Please determine the smallest cost Maria Stepanovna should pay." 1400
987B "High School: Become Human" math "Year 2118. Androids are in mass production for decades now, and they do all the work for humans. But androids have to go to school to be able to solve creative tasks. Just like humans before.It turns out that high school struggles are not gone. If someone is not like others, he is bullied. Vasya-8800 is an economy-class android which is produced by a little-known company. His design is not perfect, his characteristics also could be better. So he is bullied by other androids.One of the popular pranks on Vasya is to force him to compare xy with yx. Other androids can do it in milliseconds while Vasya\'s memory is too small to store such big numbers.Please help Vasya! Write a fast program to compare xy with yx for Vasya, maybe then other androids will respect him." 1100
987A "Infinity Gauntlet" implementation "You took a peek on Thanos wearing Infinity Gauntlet. In the Gauntlet there is a place for six Infinity Gems:  the Power Gem of purple color,  the Time Gem of green color,  the Space Gem of blue color,  the Soul Gem of orange color,  the Reality Gem of red color,  the Mind Gem of yellow color. Using colors of Gems you saw in the Gauntlet determine the names of absent Gems." 800
986F "Oppa Funcan Style Remastered" "graphs,math,number theory,shortest paths" "Surely you have seen insane videos by South Korean rapper PSY, such as ""Gangnam Style"", ""Gentleman"" and ""Daddy"". You might also hear that PSY has been recording video ""Oppa Funcan Style"" two years ago (unfortunately we couldn\'t find it on the internet). We will remind you what this hit looked like (you can find original description here):On the ground there are n platforms, which are numbered with integers from 1 to n, on i-th platform there is a dancer with number i. Further, every second all the dancers standing on the platform with number i jump to the platform with the number f(i). The moving rule f is selected in advance and is not changed throughout the clip.The duration of the clip was k seconds and the rule f was chosen in such a way that after k seconds all dancers were in their initial positions (i.e. the i-th dancer stood on the platform with the number i). That allowed to loop the clip and collect even more likes.PSY knows that enhanced versions of old artworks become more and more popular every day. So he decided to release a remastered-version of his video.In his case ""enhanced version"" means even more insanity, so the number of platforms can be up to 1018! But the video director said that if some dancer stays on the same platform all the time, then the viewer will get bored and will turn off the video immediately. Therefore, for all x from 1 to n f(x)\xe2\x89\xa0x must hold.Big part of classic video\'s success was in that looping, so in the remastered version all dancers should return to their initial positions in the end of the clip as well.PSY hasn\'t decided on the exact number of platforms and video duration yet, so he asks you to check if there is a good rule f for different options." 3300
986E "Prince\'s Problem" "brute force,data structures,math,number theory,trees" "Let the main characters of this problem be personages from some recent movie. New Avengers seem to make a lot of buzz. I didn\'t watch any part of the franchise and don\'t know its heroes well, but it won\'t stop me from using them in this problem statement. So, Thanos and Dr. Strange are doing their superhero and supervillain stuff, but then suddenly they stumble across a regular competitive programming problem.You are given a tree with n vertices.In each vertex v there is positive integer av.You have to answer q queries.Each query has a from u v x.You have to calculate \xe2\x88\x8fw\xe2\x88\x88Pgcd(x,aw)mod(109+7), where P is a set of vertices on path from u to v. In other words, you are to calculate the product of gcd(x,aw) for all vertices w on the path from u to v. As it might be large, compute it modulo 109+7. Here gcd(s,t) denotes the greatest common divisor of s and t.Note that the numbers in vertices do not change after queries.I suppose that you are more interested in superhero business of Thanos and Dr. Strange than in them solving the problem. So you are invited to solve this problem instead of them." 2800
986D "Perfect Encoding" fft,math "You are working as an analyst in a company working on a new system for big data storage. This system will store n different objects. Each object should have a unique ID.To create the system, you choose the parameters of the system \xe2\x80\x94 integers m\xe2\x89\xa51 and b1,b2,\xe2\x80\xa6,bm. With these parameters an ID of some object in the system is an array of integers [a1,a2,\xe2\x80\xa6,am] where 1\xe2\x89\xa4ai\xe2\x89\xa4bi holds for every 1\xe2\x89\xa4i\xe2\x89\xa4m.Developers say that production costs are proportional to \xe2\x88\x91mi=1bi. You are asked to choose parameters m and bi so that the system will be able to assign unique IDs to n different objects and production costs are minimized. Note that you don\'t have to use all available IDs." 3100
986C "AND Graph" "bitmasks,dfs and similar,dsu,graphs" "You are given a set of size m with integer elements between 0 and 2n\xe2\x88\x921 inclusive. Let\'s build an undirected graph on these integers in the following way: connect two integers x and y with an edge if and only if x&y=0. Here & is the bitwise AND operation. Count the number of connected components in that graph." 2500
986B "Petr and Permutations" combinatorics,math "Petr likes to come up with problems about randomly generated data. This time problem is about random permutation. He decided to generate a random permutation this way: he takes identity permutation of numbers from 1 to n and then 3n times takes a random pair of different elements and swaps them. Alex envies Petr and tries to imitate him in all kind of things. Alex has also come up with a problem about random permutation. He generates a random permutation just like Petr but swaps elements 7n+1 times instead of 3n times. Because it is more random, OK?!You somehow get a test from one of these problems and now you want to know from which one." 1800
986A Fair "graphs,greedy,number theory,shortest paths" "Some company is going to hold a fair in Byteland. There are n towns in Byteland and m two-way roads between towns. Of course, you can reach any town from any other town using roads.There are k types of goods produced in Byteland and every town produces only one type. To hold a fair you have to bring at least s different types of goods. It costs d(u,v) coins to bring goods from town u to town v where d(u,v) is the length of the shortest path from u to v. Length of a path is the number of roads in this path.The organizers will cover all travel expenses but they can choose the towns to bring goods from. Now they want to calculate minimum expenses to hold a fair in each of n towns." 1600
985G "Team Players" combinatorics "There are n players numbered from 0 to n\xe2\x88\x921 with ranks. The i-th player has rank i.Players can form teams: the team should consist of three players and no pair of players in the team should have a conflict. The rank of the team is calculated using the following algorithm: let i, j, k be the ranks of players in the team and i<j<k, then the rank of the team is equal to A\xe2\x8b\x85i+B\xe2\x8b\x85j+C\xe2\x8b\x85k.You are given information about the pairs of players who have a conflict. Calculate the total sum of ranks over all possible valid teams modulo 264." 2700
985F "Isomorphic Strings" hashing,strings "You are given a string s of length n consisting of lowercase English letters.For two given strings s and t, say S is the set of distinct characters of s and T is the set of distinct characters of t. The strings s and t are isomorphic if their lengths are equal and there is a one-to-one mapping (bijection) f between S and T for which f(si)\xe2\x80\x89=\xe2\x80\x89ti. Formally:  f(si)\xe2\x80\x89=\xe2\x80\x89ti for any index i,  for any character  there is exactly one character  that f(x)\xe2\x80\x89=\xe2\x80\x89y,  for any character  there is exactly one character  that f(x)\xe2\x80\x89=\xe2\x80\x89y. For example, the strings ""aababc"" and ""bbcbcz"" are isomorphic. Also the strings ""aaaww"" and ""wwwaa"" are isomorphic. The following pairs of strings are not isomorphic: ""aab"" and ""bbb"", ""test"" and ""best"".You have to handle m queries characterized by three integers x,\xe2\x80\x89y,\xe2\x80\x89len (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x,\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n\xe2\x80\x89-\xe2\x80\x89len\xe2\x80\x89+\xe2\x80\x891). For each query check if two substrings s[x... x\xe2\x80\x89+\xe2\x80\x89len\xe2\x80\x89-\xe2\x80\x891] and s[y... y\xe2\x80\x89+\xe2\x80\x89len\xe2\x80\x89-\xe2\x80\x891] are isomorphic." 2300
985E "Pencils and Boxes" "binary search,data structures,dp,greedy,two pointers" "Mishka received a gift of multicolored pencils for his birthday! Unfortunately he lives in a monochrome world, where everything is of the same color and only saturation differs. This pack can be represented as a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of n integer numbers \xe2\x80\x94 saturation of the color of each pencil. Now Mishka wants to put all the mess in the pack in order. He has an infinite number of empty boxes to do this. He would like to fill some boxes in such a way that:  Each pencil belongs to exactly one box;  Each non-empty box has at least k pencils in it;  If pencils i and j belong to the same box, then |ai\xe2\x80\x89-\xe2\x80\x89aj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d, where |x| means absolute value of x. Note that the opposite is optional, there can be pencils i and j such that |ai\xe2\x80\x89-\xe2\x80\x89aj|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89d and they belong to different boxes. Help Mishka to determine if it\'s possible to distribute all the pencils into boxes. Print ""YES"" if there exists such a distribution. Otherwise print ""NO""." 2100
985D "Sand Fortress" "binary search,constructive algorithms,math" "You are going to the beach with the idea to build the greatest sand castle ever in your head! The beach is not as three-dimensional as you could have imagined, it can be decribed as a line of spots to pile up sand pillars. Spots are numbered 1 through infinity from left to right. Obviously, there is not enough sand on the beach, so you brought n packs of sand with you. Let height hi of the sand pillar on some spot i be the number of sand packs you spent on it. You can\'t split a sand pack to multiple pillars, all the sand from it should go to a single one. There is a fence of height equal to the height of pillar with H sand packs to the left of the first spot and you should prevent sand from going over it. Finally you ended up with the following conditions to building the castle:  h1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89H: no sand from the leftmost spot should go over the fence;  For any  |hi\xe2\x80\x89-\xe2\x80\x89hi\xe2\x80\x89+\xe2\x80\x891|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x891: large difference in heights of two neighboring pillars can lead sand to fall down from the higher one to the lower, you really don\'t want this to happen;  : you want to spend all the sand you brought with you. As you have infinite spots to build, it is always possible to come up with some valid castle structure. Though you want the castle to be as compact as possible. Your task is to calculate the minimum number of spots you can occupy so that all the aforementioned conditions hold." 2100
985C "Liebig\'s Barrels" greedy "You have m\xe2\x80\x89=\xe2\x80\x89n\xc2\xb7k wooden staves. The i-th stave has length ai. You have to assemble n barrels consisting of k staves each, you can use any k staves to construct a barrel. Each stave must belong to exactly one barrel.Let volume vj of barrel j be equal to the length of the minimal stave in it.  You want to assemble exactly n barrels with the maximal total sum of volumes. But you have to make them equal enough, so a difference between volumes of any pair of the resulting barrels must not exceed l, i.e. |vx\xe2\x80\x89-\xe2\x80\x89vy|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l for any 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89y\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.Print maximal total sum of volumes of equal enough barrels or 0 if it\'s impossible to satisfy the condition above." 1500
985B "Switches and Lamps" implementation "You are given n switches and m lamps. The i-th switch turns on some subset of the lamps. This information is given as the matrix a consisting of n rows and m columns where ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x891 if the i-th switch turns on the j-th lamp and ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x890 if the i-th switch is not connected to the j-th lamp.Initially all m lamps are turned off.Switches change state only from ""off"" to ""on"". It means that if you press two or more switches connected to the same lamp then the lamp will be turned on after any of this switches is pressed and will remain its state even if any switch connected to this lamp is pressed afterwards.It is guaranteed that if you push all n switches then all m lamps will be turned on.Your think that you have too many switches and you would like to ignore one of them. Your task is to say if there exists such a switch that if you will ignore (not use) it but press all the other n\xe2\x80\x89-\xe2\x80\x891 switches then all the m lamps will be turned on." 1200
985A "Chess Placing" implementation "You are given a chessboard of size 1\xe2\x80\x89\xc3\x97\xe2\x80\x89n. It is guaranteed that n is even. The chessboard is painted like this: ""BWBW...BW"".Some cells of the board are occupied by the chess pieces. Each cell contains no more than one chess piece. It is known that the total number of pieces equals to .In one step you can move one of the pieces one cell to the left or to the right. You cannot move pieces beyond the borders of the board. You also cannot move pieces to the cells that are already occupied.Your task is to place all the pieces in the cells of the same color using the minimum number of moves (all the pieces must occupy only the black cells or only the white cells after all the moves are made)." 1100
984B Minesweeper implementation "One day Alex decided to remember childhood when computers were not too powerful and lots of people played only default games. Alex enjoyed playing Minesweeper that time. He imagined that he saved world from bombs planted by terrorists, but he rarely won.Alex has grown up since then, so he easily wins the most difficult levels. This quickly bored him, and he thought: what if the computer gave him invalid fields in the childhood and Alex could not win because of it?He needs your help to check it.A Minesweeper field is a rectangle n\xc3\x97m, where each cell is either empty, or contains a digit from 1 to 8, or a bomb. The field is valid if for each cell:   if there is a digit k in the cell, then exactly k neighboring cells have bombs.  if the cell is empty, then all neighboring cells have no bombs. Two cells are neighbors if they have a common side or a corner (i. e. a cell has at most 8 neighboring cells)." 1100
984A Game sortings "Two players play a game.Initially there are n integers a1,a2,\xe2\x80\xa6,an written on the board. Each turn a player selects one number and erases it from the board. This continues until there is only one number left on the board, i. e. n\xe2\x88\x921 turns are made. The first player makes the first move, then players alternate turns.The first player wants to minimize the last number that would be left on the board, while the second player wants to maximize it.You want to know what number will be left on the board after n\xe2\x88\x921 turns if both players make optimal moves." 800
983E "NN country" "binary search,data structures,trees" "In the NN country, there are nn cities, numbered from 11 to nn, and n\xe2\x88\x921n\xe2\x88\x921 roads, connecting them. There is a roads path between any two cities.There are mm bidirectional bus routes between cities. Buses drive between two cities taking the shortest path with stops in every city they drive through. Travelling by bus, you can travel from any stop on the route to any other. You can travel between cities only by bus.You are interested in qq questions: is it possible to get from one city to another and what is the minimum number of buses you need to use for it?" 2800
983D "Arkady and Rectangles" "data structures" "Arkady has got an infinite plane painted in color 0. Then he draws n rectangles filled with paint with sides parallel to the Cartesian coordinate axes, one after another. The color of the i-th rectangle is i (rectangles are enumerated from 1 to n in the order he draws them). It is possible that new rectangles cover some of the previous ones completely or partially.Count the number of different colors on the plane after Arkady draws all the rectangles." 3300
983C Elevator "dp,graphs,shortest paths" "You work in a big office. It is a 9 floor building with an elevator that can accommodate up to 4 people. It is your responsibility to manage this elevator.Today you are late, so there are queues on some floors already. For each person you know the floor where he currently is and the floor he wants to reach. Also, you know the order in which people came to the elevator.According to the company\'s rules, if an employee comes to the elevator earlier than another one, he has to enter the elevator earlier too (even if these employees stay on different floors). Note that the employees are allowed to leave the elevator in arbitrary order.The elevator has two commands:   Go up or down one floor. The movement takes 1 second.  Open the doors on the current floor. During this operation all the employees who have reached their destination get out of the elevator. Then all the employees on the floor get in the elevator in the order they are queued up while it doesn\'t contradict the company\'s rules and there is enough space in the elevator. Each employee spends 1 second to get inside and outside the elevator. Initially the elevator is empty and is located on the floor 1.You are interested what is the minimum possible time you need to spend to deliver all the employees to their destination. It is not necessary to return the elevator to the floor 1." 2400
983B XOR-pyramid dp "For an array b of length m we define the function f as  f(b)={b[1]if m=1f(b[1]\xe2\x8a\x95b[2],b[2]\xe2\x8a\x95b[3],\xe2\x80\xa6,b[m\xe2\x88\x921]\xe2\x8a\x95b[m])otherwise, where \xe2\x8a\x95 is bitwise exclusive OR.For example, f(1,2,4,8)=f(1\xe2\x8a\x952,2\xe2\x8a\x954,4\xe2\x8a\x958)=f(3,6,12)=f(3\xe2\x8a\x956,6\xe2\x8a\x9512)=f(5,10)=f(5\xe2\x8a\x9510)=f(15)=15You are given an array a and a few queries. Each query is represented as two integers l and r. The answer is the maximum value of f on all continuous subsegments of the array al,al+1,\xe2\x80\xa6,ar." 1800
983A "Finite or not?" implementation,math "You are given several queries. Each query consists of three integers p, q and b. You need to answer whether the result of p/q in notation with base b is a finite fraction.A fraction in notation with base b is finite if it contains finite number of numerals after the decimal point. It is also possible that a fraction has zero numerals after the decimal point." 1700
982F "The Meeting Place Cannot Be Changed" "dfs and similar,graphs" "Petr is a detective in Braginsk. Somebody stole a huge amount of money from a bank and Petr is to catch him. Somebody told Petr that some luxurious car moves along the roads without stopping.Petr knows that it is the robbers who drive the car. The roads in Braginsk are one-directional and each of them connects two intersections. Petr wants to select one intersection such that if the robbers continue to drive the roads indefinitely, they will sooner or later come to that intersection. The initial position of the robbers is unknown. Find such an intersection that fits the requirements." 2700
982E Billiard "geometry,number theory" "Consider a billiard table of rectangular size n\xc3\x97m with four pockets. Let\'s introduce a coordinate system with the origin at the lower left corner (see the picture).   There is one ball at the point (x,y) currently. Max comes to the table and strikes the ball. The ball starts moving along a line that is parallel to one of the axes or that makes a 45\xe2\x88\x98 angle with them. We will assume that:   the angles between the directions of the ball before and after a collision with a side are equal,  the ball moves indefinitely long, it only stops when it falls into a pocket,  the ball can be considered as a point, it falls into a pocket if and only if its coordinates coincide with one of the pockets,  initially the ball is not in a pocket. Note that the ball can move along some side, in this case the ball will just fall into the pocket at the end of the side.Your task is to determine whether the ball will fall into a pocket eventually, and if yes, which of the four pockets it will be." 2600
982D Shark "brute force,data structures,dsu,trees" "For long time scientists study the behavior of sharks. Sharks, as many other species, alternate short movements in a certain location and long movements between locations.Max is a young biologist. For n days he watched a specific shark, and now he knows the distance the shark traveled in each of the days. All the distances are distinct. Max wants to know now how many locations the shark visited. He assumed there is such an integer k that if the shark in some day traveled the distance strictly less than k, then it didn\'t change the location; otherwise, if in one day the shark traveled the distance greater than or equal to k; then it was changing a location in that day. Note that it is possible that the shark changed a location for several consecutive days, in each of them the shark traveled the distance at least k.The shark never returned to the same location after it has moved from it. Thus, in the sequence of n days we can find consecutive nonempty segments when the shark traveled the distance less than k in each of the days: each such segment corresponds to one location. Max wants to choose such k that the lengths of all such segments are equal.Find such integer k, that the number of locations is as large as possible. If there are several such k, print the smallest one." 1900
982C "Cut \'em all!" "dfs and similar,dp,graphs,greedy,trees" "You\'re given a tree with n vertices.Your task is to determine the maximum possible number of edges that can be removed in such a way that all the remaining connected components will have even size." 1500
982B "Bus of Characters" "data structures,greedy,implementation" "In the Bus of Characters there are n rows of seat, each having 2 seats. The width of both seats in the i-th row is wi centimeters. All integers wi are distinct.Initially the bus is empty. On each of 2n stops one passenger enters the bus. There are two types of passengers:   an introvert always chooses a row where both seats are empty. Among these rows he chooses the one with the smallest seats width and takes one of the seats in it;  an extrovert always chooses a row where exactly one seat is occupied (by an introvert). Among these rows he chooses the one with the largest seats width and takes the vacant place in it. You are given the seats width in each row and the order the passengers enter the bus. Determine which row each passenger will take." 1300
982A Row "brute force,constructive algorithms" "You\'re given a row with n chairs. We call a seating of people ""maximal"" if the two following conditions hold:  There are no neighbors adjacent to anyone seated.  It\'s impossible to seat one more person without violating the first rule. The seating is given as a string consisting of zeros and ones (0 means that the corresponding seat is empty, 1 \xe2\x80\x94 occupied). The goal is to determine whether this seating is ""maximal"".Note that the first and last seats are not adjacent (if n\xe2\x89\xa02)." 1200
981H "K Paths" "combinatorics,data structures,dp,fft,math" "You are given a tree of n vertices. You are to select k (not necessarily distinct) simple paths in such a way that it is possible to split all edges of the tree into three sets: edges not contained in any path, edges that are a part of exactly one of these paths, and edges that are parts of all selected paths, and the latter set should be non-empty.Compute the number of ways to select k paths modulo 998244353.The paths are enumerated, in other words, two ways are considered distinct if there are such i (1\xe2\x89\xa4i\xe2\x89\xa4k) and an edge that the i-th path contains the edge in one way and does not contain it in the other." 3100
981G "Magic multisets" "data structures" "In the School of Magic in Dirtpolis a lot of interesting objects are studied on Computer Science lessons.Consider, for example, the magic multiset. If you try to add an integer to it that is already presented in the multiset, each element in the multiset duplicates. For example, if you try to add the integer 2 to the multiset {1,2,3,3}, you will get {1,1,2,2,3,3,3,3}. If you try to add an integer that is not presented in the multiset, it is simply added to it. For example, if you try to add the integer 4 to the multiset {1,2,3,3}, you will get {1,2,3,3,4}.Also consider an array of n initially empty magic multisets, enumerated from 1 to n.You are to answer q queries of the form ""add an integer x to all multisets with indices l,l+1,\xe2\x80\xa6,r"" and ""compute the sum of sizes of multisets with indices l,l+1,\xe2\x80\xa6,r"". The answers for the second type queries can be large, so print the answers modulo 998244353." 2500
981F "Round Marriage" "binary search,graph matchings,greedy" "It\'s marriage season in Ringland!Ringland has a form of a circle\'s boundary of length L. There are n bridegrooms and n brides, and bridegrooms decided to marry brides.Of course, each bridegroom should choose exactly one bride, and each bride should be chosen by exactly one bridegroom.All objects in Ringland are located on the boundary of the circle, including the capital, bridegrooms\' castles and brides\' palaces. The castle of the i-th bridegroom is located at the distance ai from the capital in clockwise direction, and the palace of the i-th bride is located at the distance bi from the capital in clockwise direction.Let\'s define the inconvenience of a marriage the maximum distance that some bride should walk along the circle from her palace to her bridegroom\'s castle in the shortest direction (in clockwise or counter-clockwise direction).Help the bridegrooms of Ringland to choose brides in such a way that the inconvenience of the marriage is the smallest possible." 2500
981E "Addition on Segments" "bitmasks,data structures,divide and conquer,dp" "Grisha come to a contest and faced the following problem.You are given an array of size n, initially consisting of zeros. The elements of the array are enumerated from 1 to n. You perform q operations on the array. The i-th operation is described with three integers li, ri and xi (1\xe2\x89\xa4li\xe2\x89\xa4ri\xe2\x89\xa4n, 1\xe2\x89\xa4xi\xe2\x89\xa4n) and means that you should add xi to each of the elements with indices li,li+1,\xe2\x80\xa6,ri. After all operations you should find the maximum in the array.Grisha is clever, so he solved the problem quickly.However something went wrong inside his head and now he thinks of the following question: ""consider we applied some subset of the operations to the array. What are the possible values of the maximum in the array?""Help Grisha, find all integers y between 1 and n such that if you apply some subset (possibly empty) of the operations, then the maximum in the array becomes equal to y." 2200
981D Bookshelves bitmasks,dp,greedy "Mr Keks is a typical white-collar in Byteland.He has a bookshelf in his office with some books on it, each book has an integer positive price.Mr Keks defines the value of a shelf as the sum of books prices on it. Miraculously, Mr Keks was promoted and now he is moving into a new office.He learned that in the new office he will have not a single bookshelf, but exactly k bookshelves. He decided that the beauty of the k shelves is the bitwise AND of the values of all the shelves.He also decided that he won\'t spend time on reordering the books, so he will place several first books on the first shelf, several next books on the next shelf and so on. Of course, he will place at least one book on each shelf. This way he will put all his books on k shelves in such a way that the beauty of the shelves is as large as possible. Compute this maximum possible beauty." 1900
981C "Useful Decomposition" implementation,trees "Ramesses knows a lot about problems involving trees (undirected connected graphs without cycles)!He created a new useful tree decomposition, but he does not know how to construct it, so he asked you for help!The decomposition is the splitting the edges of the tree in some simple paths in such a way that each two paths have at least one common vertex. Each edge of the tree should be in exactly one path.Help Remesses, find such a decomposition of the tree or derermine that there is no such decomposition." 1400
981B "Businessmen Problems" sortings "Two famous competing companies ChemForces and TopChemist decided to show their sets of recently discovered chemical elements on an exhibition. However they know that no element should be present in the sets of both companies.In order to avoid this representatives of both companies decided to make an agreement on the sets the companies should present. The sets should be chosen in the way that maximizes the total income of the companies.All elements are enumerated with integers. The ChemForces company has discovered n distinct chemical elements with indices a1,a2,\xe2\x80\xa6,an, and will get an income of xi Berland rubles if the i-th element from this list is in the set of this company.The TopChemist company discovered m distinct chemical elements with indices b1,b2,\xe2\x80\xa6,bm, and it will get an income of yj Berland rubles for including the j-th element from this list to its set.In other words, the first company can present any subset of elements from {a1,a2,\xe2\x80\xa6,an} (possibly empty subset), the second company can present any subset of elements from {b1,b2,\xe2\x80\xa6,bm} (possibly empty subset). There shouldn\'t be equal elements in the subsets.Help the representatives select the sets in such a way that no element is presented in both sets and the total income is the maximum possible." 1000
981A Antipalindrome "brute force,implementation,strings" "A string is a palindrome if it reads the same from the left to the right and from the right to the left. For example, the strings ""kek"", ""abacaba"", ""r"" and ""papicipap"" are palindromes, while the strings ""abb"" and ""iq"" are not.A substring s[l\xe2\x80\xa6r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89|s|) of a string s\xe2\x80\x89=\xe2\x80\x89s1s2\xe2\x80\xa6s|s| is the string slsl\xe2\x80\x89+\xe2\x80\x891\xe2\x80\xa6sr.Anna does not like palindromes, so she makes her friends call her Ann. She also changes all the words she reads in a similar way. Namely, each word s is changed into its longest substring that is not a palindrome. If all the substrings of s are palindromes, she skips the word at all.Some time ago Ann read the word s. What is the word she changed it into?" 900
980F "Cactus to Tree" dp,graphs,trees "You are given a special connected undirected graph where each vertex belongs to at most one simple cycle.Your task is to remove as many edges as needed to convert this graph into a tree (connected graph with no cycles). For each node, independently, output the maximum distance between it and a leaf in the resulting tree, assuming you were to remove the edges in a way that minimizes this distance." 2900
980E "The Number Games" "data structures,greedy,trees" "The nation of Panel holds an annual show called The Number Games, where each district in the nation will be represented by one contestant.The nation has n districts numbered from 1 to n, each district has exactly one path connecting it to every other district. The number of fans of a contestant from district i is equal to 2i.This year, the president decided to reduce the costs. He wants to remove k contestants from the games. However, the districts of the removed contestants will be furious and will not allow anyone to cross through their districts. The president wants to ensure that all remaining contestants are from districts that can be reached from one another. He also wishes to maximize the total number of fans of the participating contestants.Which contestants should the president remove?" 2200
980D "Perfect Groups" "dp,math,number theory" "SaMer has written the greatest test case of all time for one of his problems. For a given array of integers, the problem asks to find the minimum number of groups the array can be divided into, such that the product of any pair of integers in the same group is a perfect square. Each integer must be in exactly one group. However, integers in a group do not necessarily have to be contiguous in the array.SaMer wishes to create more cases from the test case he already has. His test case has an array A of n integers, and he needs to find the number of contiguous subarrays of A that have an answer to the problem equal to k for each integer k between 1 and n (inclusive)." 2100
980C Posterized games,greedy "Professor Ibrahim has prepared the final homework for his algorithm\xe2\x80\x99s class. He asked his students to implement the Posterization Image Filter.Their algorithm will be tested on an array of integers, where the i-th integer represents the color of the i-th pixel in the image. The image is in black and white, therefore the color of each pixel will be an integer between 0 and 255 (inclusive).To implement the filter, students are required to divide the black and white color range [0, 255] into groups of consecutive colors, and select one color in each group to be the group\xe2\x80\x99s key. In order to preserve image details, the size of a group must not be greater than k, and each color should belong to exactly one group.Finally, the students will replace the color of each pixel in the array with that color\xe2\x80\x99s assigned group key.To better understand the effect, here is an image of a basking turtle where the Posterization Filter was applied with increasing k to the right.   To make the process of checking the final answer easier, Professor Ibrahim wants students to divide the groups and assign the keys in a way that produces the lexicographically smallest possible array." 1700
980B Marlin "constructive algorithms" "The city of Fishtopia can be imagined as a grid of 4 rows and an odd number of columns. It has two main villages; the first is located at the top-left cell (1,1), people who stay there love fishing at the Tuna pond at the bottom-right cell (4,n). The second village is located at (4,1) and its people love the Salmon pond at (1,n).The mayor of Fishtopia wants to place k hotels in the city, each one occupying one cell. To allow people to enter the city from anywhere, hotels should not be placed on the border cells.A person can move from one cell to another if those cells are not occupied by hotels and share a side.Can you help the mayor place the hotels in a way such that there are equal number of shortest paths from each village to its preferred pond?" 1600
980A "Links and Pearls" implementation,math "A necklace can be described as a string of links (\'-\') and pearls (\'o\'), with the last link or pearl connected to the first one.  You can remove a link or a pearl and insert it between two other existing links or pearls (or between a link and a pearl) on the necklace. This process can be repeated as many times as you like, but you can\'t throw away any parts.Can you make the number of links between every two adjacent pearls equal? Two pearls are considered to be adjacent if there is no other pearl between them.Note that the final necklace should remain as one circular part of the same length as the initial necklace." 900
979E "Kuro and Topological Parity" dp "Kuro has recently won the ""Most intelligent cat ever"" contest. The three friends then decided to go to Katie\'s home to celebrate Kuro\'s winning. After a big meal, they took a small break then started playing games.Kuro challenged Katie to create a game with only a white paper, a pencil, a pair of scissors and a lot of arrows (you can assume that the number of arrows is infinite). Immediately, Katie came up with the game called Topological Parity.The paper is divided into n pieces enumerated from 1 to n. Shiro has painted some pieces with some color. Specifically, the i-th piece has color ci where ci=0 defines black color, ci=1 defines white color and ci=\xe2\x88\x921 means that the piece hasn\'t been colored yet.The rules of the game is simple. Players must put some arrows between some pairs of different pieces in such a way that for each arrow, the number in the piece it starts from is less than the number of the piece it ends at. Also, two different pieces can only be connected by at most one arrow. After that the players must choose the color (0 or 1) for each of the unpainted pieces. The score of a valid way of putting the arrows and coloring pieces is defined as the number of paths of pieces of alternating colors. For example, [1\xe2\x86\x920\xe2\x86\x921\xe2\x86\x920], [0\xe2\x86\x921\xe2\x86\x920\xe2\x86\x921], [1], [0] are valid paths and will be counted. You can only travel from piece x to piece y if and only if there is an arrow from x to y.But Kuro is not fun yet. He loves parity. Let\'s call his favorite parity p where p=0 stands for ""even"" and p=1 stands for ""odd"". He wants to put the arrows and choose colors in such a way that the score has the parity of p.It seems like there will be so many ways which satisfy Kuro. He wants to count the number of them but this could be a very large number. Let\'s help him with his problem, but print it modulo 109+7." 2400
979D "Kuro and GCD and XOR and SUM" "binary search,bitmasks,brute force,data structures,dp,dsu,greedy,math,number theory,strings,trees" "Kuro is currently playing an educational game about numbers. The game focuses on the greatest common divisor (GCD), the XOR value, and the sum of two numbers. Kuro loves the game so much that he solves levels by levels day by day.Sadly, he\'s going on a vacation for a day, and he isn\'t able to continue his solving streak on his own. As Katie is a reliable person, Kuro kindly asked her to come to his house on this day to play the game for him.Initally, there is an empty array a. The game consists of q tasks of two types. The first type asks Katie to add a number ui to a. The second type asks Katie to find a number v existing in a such that ki\xe2\x88\xa3GCD(xi,v), xi+v\xe2\x89\xa4si, and xi\xe2\x8a\x95v is maximized, where \xe2\x8a\x95 denotes the bitwise XOR operation, GCD(c,d) denotes the greatest common divisor of integers c and d, and y\xe2\x88\xa3x means x is divisible by y, or report -1 if no such numbers are found.Since you are a programmer, Katie needs you to automatically and accurately perform the tasks in the game to satisfy her dear friend Kuro. Let\'s help her!" 2200
979C "Kuro and Walking Route" "dfs and similar,trees" "Kuro is living in a country called Uberland, consisting of n towns, numbered from 1 to n, and n\xe2\x88\x921 bidirectional roads connecting these towns. It is possible to reach each town from any other. Each road connects two towns a and b. Kuro loves walking and he is planning to take a walking marathon, in which he will choose a pair of towns (u,v) (u\xe2\x89\xa0v) and walk from u using the shortest path to v (note that (u,v) is considered to be different from (v,u)).Oddly, there are 2 special towns in Uberland named Flowrisa (denoted with the index x) and Beetopia (denoted with the index y). Flowrisa is a town where there are many strong-scent flowers, and Beetopia is another town where many bees live. In particular, Kuro will avoid any pair of towns (u,v) if on the path from u to v, he reaches Beetopia after he reached Flowrisa, since the bees will be attracted with the flower smell on Kuro\xe2\x80\x99s body and sting him.Kuro wants to know how many pair of city (u,v) he can take as his route. Since he\xe2\x80\x99s not really bright, he asked you to help him with this problem." 1600
979B "Treasure Hunt" greedy "After the big birthday party, Katie still wanted Shiro to have some more fun. Later, she came up with a game called treasure hunt. Of course, she invited her best friends Kuro and Shiro to play with her.The three friends are very smart so they passed all the challenges very quickly and finally reached the destination. But the treasure can only belong to one cat so they started to think of something which can determine who is worthy of the treasure. Instantly, Kuro came up with some ribbons.A random colorful ribbon is given to each of the cats. Each color of the ribbon can be represented as an uppercase or lowercase Latin letter. Let\'s call a consecutive subsequence of colors that appears in the ribbon a subribbon. The beauty of a ribbon is defined as the maximum number of times one of its subribbon appears in the ribbon. The more the subribbon appears, the more beautiful is the ribbon. For example, the ribbon aaaaaaa has the beauty of 7 because its subribbon a appears 7 times, and the ribbon abcdabc has the beauty of 2 because its subribbon abc appears twice.The rules are simple. The game will have n turns. Every turn, each of the cats must change strictly one color (at one position) in his/her ribbon to an arbitrary color which is different from the unchanged one. For example, a ribbon aaab can be changed into acab in one turn. The one having the most beautiful ribbon after n turns wins the treasure.Could you find out who is going to be the winner if they all play optimally?" 1800
979A "Pizza, Pizza, Pizza!!!" math "Katie, Kuro and Shiro are best friends. They have known each other since kindergarten. That\'s why they often share everything with each other and work together on some very hard problems.Today is Shiro\'s birthday. She really loves pizza so she wants to invite her friends to the pizza restaurant near her house to celebrate her birthday, including her best friends Katie and Kuro.She has ordered a very big round pizza, in order to serve her many friends. Exactly n of Shiro\'s friends are here. That\'s why she has to divide the pizza into n+1 slices (Shiro also needs to eat). She wants the slices to be exactly the same size and shape. If not, some of her friends will get mad and go home early, and the party will be over.Shiro is now hungry. She wants to cut the pizza with minimum of straight cuts. A cut is a straight segment, it might have ends inside or outside the pizza. But she is too lazy to pick up the calculator.As usual, she will ask Katie and Kuro for help. But they haven\'t come yet. Could you help Shiro with this problem?" 1000
978G "Petya\'s Exams" greedy,implementation,sortings "Petya studies at university. The current academic year finishes with n special days. Petya needs to pass m exams in those special days. The special days in this problem are numbered from 1 to n.There are three values about each exam:  si \xe2\x80\x94 the day, when questions for the i-th exam will be published,  di \xe2\x80\x94 the day of the i-th exam (si<di),  ci \xe2\x80\x94 number of days Petya needs to prepare for the i-th exam. For the i-th exam Petya should prepare in days between si and di\xe2\x88\x921, inclusive. There are three types of activities for Petya in each day: to spend a day doing nothing (taking a rest), to spend a day passing exactly one exam or to spend a day preparing for exactly one exam. So he can\'t pass/prepare for multiple exams in a day. He can\'t mix his activities in a day. If he is preparing for the i-th exam in day j, then si\xe2\x89\xa4j<di.It is allowed to have breaks in a preparation to an exam and to alternate preparations for different exams in consecutive days. So preparation for an exam is not required to be done in consecutive days.Find the schedule for Petya to prepare for all exams and pass them, or report that it is impossible." 1700
978F Mentors "binary search,data structures,implementation" "In BerSoft n programmers work, the programmer i is characterized by a skill ri.A programmer a can be a mentor of a programmer b if and only if the skill of the programmer a is strictly greater than the skill of the programmer b (ra>rb) and programmers a and b are not in a quarrel.You are given the skills of each programmers and a list of k pairs of the programmers, which are in a quarrel (pairs are unordered). For each programmer i, find the number of programmers, for which the programmer i can be a mentor." 1500
978E "Bus Video System" combinatorics,math "The busses in Berland are equipped with a video surveillance system. The system records information about changes in the number of passengers in a bus after stops.If x is the number of passengers in a bus just before the current bus stop and y is the number of passengers in the bus just after current bus stop, the system records the number y\xe2\x88\x92x. So the system records show how number of passengers changed.The test run was made for single bus and n bus stops. Thus, the system recorded the sequence of integers a1,a2,\xe2\x80\xa6,an (exactly one number for each bus stop), where ai is the record for the bus stop i. The bus stops are numbered from 1 to n in chronological order.Determine the number of possible ways how many people could be in the bus before the first bus stop, if the bus has a capacity equals to w (that is, at any time in the bus there should be from 0 to w passengers inclusive)." 1400
978D "Almost Arithmetic Progression" "brute force,implementation,math" "Polycarp likes arithmetic progressions. A sequence [a1,a2,\xe2\x80\xa6,an] is called an arithmetic progression if for each i (1\xe2\x89\xa4i<n) the value ai+1\xe2\x88\x92ai is the same. For example, the sequences [42], [5,5,5], [2,11,20,29] and [3,2,1,0] are arithmetic progressions, but [1,0,1], [1,3,9] and [2,3,1] are not.It follows from the definition that any sequence of length one or two is an arithmetic progression.Polycarp found some sequence of positive integers [b1,b2,\xe2\x80\xa6,bn]. He agrees to change each element by at most one. In the other words, for each element there are exactly three options: an element can be decreased by 1, an element can be increased by 1, an element can be left unchanged.Determine a minimum possible number of elements in b which can be changed (by exactly one), so that the sequence b becomes an arithmetic progression, or report that it is impossible.It is possible that the resulting sequence contains element equals 0." 1500
978C Letters "binary search,implementation,two pointers" "There are n dormitories in Berland State University, they are numbered with integers from 1 to n. Each dormitory consists of rooms, there are ai rooms in i-th dormitory. The rooms in i-th dormitory are numbered from 1 to ai.A postman delivers letters. Sometimes there is no specific dormitory and room number in it on an envelope. Instead of it only a room number among all rooms of all n dormitories is written on an envelope. In this case, assume that all the rooms are numbered from 1 to a1+a2+\xe2\x8b\xaf+an and the rooms of the first dormitory go first, the rooms of the second dormitory go after them and so on.For example, in case n=2, a1=3 and a2=5 an envelope can have any integer from 1 to 8 written on it. If the number 7 is written on an envelope, it means that the letter should be delivered to the room number 4 of the second dormitory.For each of m letters by the room number among all n dormitories, determine the particular dormitory and the room number in a dormitory where this letter should be delivered." 1000
978B "File Name" greedy,strings "You can not just take the file and send it. When Polycarp trying to send a file in the social network ""Codehorses"", he encountered an unexpected problem. If the name of the file contains three or more ""x"" (lowercase Latin letters ""x"") in a row, the system considers that the file content does not correspond to the social network topic. In this case, the file is not sent and an error message is displayed.Determine the minimum number of characters to remove from the file name so after that the name does not contain ""xxx"" as a substring. Print 0 if the file name does not initially contain a forbidden substring ""xxx"".You can delete characters in arbitrary positions (not necessarily consecutive). If you delete a character, then the length of a string is reduced by 1. For example, if you delete the character in the position 2 from the string ""exxxii"", then the resulting string is ""exxii""." 800
978A "Remove Duplicates" implementation "Petya has an array a consisting of n integers. He wants to remove duplicate (equal) elements.Petya wants to leave only the rightmost entry (occurrence) for each element of the array. The relative order of the remaining unique elements should not be changed." 800
977F "Consecutive Subsequence" dp "You are given an integer array of length n.You have to choose some subsequence of this array of maximum length such that this subsequence forms a increasing sequence of consecutive integers. In other words the required sequence should be equal to [x,x+1,\xe2\x80\xa6,x+k\xe2\x88\x921] for some value x and length k.Subsequence of an array can be obtained by erasing some (possibly zero) elements from the array. You can erase any elements, not necessarily going successively. The remaining elements preserve their order. For example, for the array [5,3,1,2,4] the following arrays are subsequences: [3], [5,3,1,2,4], [5,1,4], but the array [1,3] is not." 1700
977E "Cyclic Components" "dfs and similar,dsu,graphs" "You are given an undirected graph consisting of n vertices and m edges. Your task is to find the number of connected components which are cycles.Here are some definitions of graph theory.An undirected graph consists of two sets: set of nodes (called vertices) and set of edges. Each edge connects a pair of vertices. All edges are bidirectional (i.e. if a vertex a is connected with a vertex b, a vertex b is also connected with a vertex a). An edge can\'t connect vertex with itself, there is at most one edge between a pair of vertices.Two vertices u and v belong to the same connected component if and only if there is at least one path along edges connecting u and v.A connected component is a cycle if and only if its vertices can be reordered in such a way that:  the first vertex is connected with the second vertex by an edge,  the second vertex is connected with the third vertex by an edge,  ...  the last vertex is connected with the first vertex by an edge,  all the described edges of a cycle are distinct. A cycle doesn\'t contain any other edges except described above. By definition any cycle contains three or more vertices.  There are 6 connected components, 2 of them are cycles: [7,10,16] and [5,11,9,15]." 1500
977D "Divide by three, multiply by two" "dfs and similar,math,sortings" "Polycarp likes to play with numbers. He takes some integer number x, writes it down on the board, and then performs with it n\xe2\x88\x921 operations of the two kinds:   divide the number x by 3 (x must be divisible by 3);  multiply the number x by 2. After each operation, Polycarp writes down the result on the board and replaces x by the result. So there will be n numbers on the board after all.You are given a sequence of length n \xe2\x80\x94 the numbers that Polycarp wrote down. This sequence is given in arbitrary order, i.e. the order of the sequence can mismatch the order of the numbers written on the board.Your problem is to rearrange (reorder) elements of this sequence in such a way that it can match possible Polycarp\'s game in the order of the numbers written on the board. I.e. each next number will be exactly two times of the previous number or exactly one third of previous number.It is guaranteed that the answer exists." 1400
977C "Less or Equal" sortings "You are given a sequence of integers of length n and integer number k. You should print any integer number x in the range of [1;109] (i.e. 1\xe2\x89\xa4x\xe2\x89\xa4109) such that exactly k elements of given sequence are less than or equal to x.Note that the sequence can contain equal elements.If there is no such x, print ""-1"" (without quotes)." 1200
977B Two-gram implementation,strings "Two-gram is an ordered pair (i.e. string of length two) of capital Latin letters. For example, ""AZ"", ""AA"", ""ZA"" \xe2\x80\x94 three distinct two-grams.You are given a string s consisting of n capital Latin letters. Your task is to find any two-gram contained in the given string as a substring (i.e. two consecutive characters of the string) maximal number of times. For example, for string s = ""BBAABBBA"" the answer is two-gram ""BB"", which contained in s three times. In other words, find any most frequent two-gram.Note that occurrences of the two-gram can overlap with each other." 900
977A "Wrong Subtraction" implementation "Little girl Tanya is learning how to decrease a number by one, but she does it wrong with a number consisting of two or more digits. Tanya subtracts one from a number by the following algorithm:  if the last digit of the number is non-zero, she decreases the number by one;  if the last digit of the number is zero, she divides the number by 10 (i.e. removes the last digit). You are given an integer number n. Tanya will subtract one from it k times. Your task is to print the result after all k subtractions.It is guaranteed that the result will be positive integer number." 800
976F "Minimal k-covering" flows,graphs "You are given a bipartite graph G\xe2\x80\x89=\xe2\x80\x89(U,\xe2\x80\x89V,\xe2\x80\x89E), U is the set of vertices of the first part, V is the set of vertices of the second part and E is the set of edges. There might be multiple edges.Let\'s call some subset of its edges  k-covering iff the graph  has each of its vertices incident to at least k edges. Minimal k-covering is such a k-covering that the size of the subset  is minimal possible.Your task is to find minimal k-covering for each , where minDegree is the minimal degree of any vertex in graph G." 2500
976E "Well played!" greedy,sortings "Recently Max has got himself into popular CCG ""BrainStone"". As ""BrainStone"" is a pretty intellectual game, Max has to solve numerous hard problems during the gameplay. Here is one of them:Max owns n creatures, i-th of them can be described with two numbers \xe2\x80\x94 its health hpi and its damage dmgi. Max also has two types of spells in stock:  Doubles health of the creature (hpi := hpi\xc2\xb72);  Assigns value of health of the creature to its damage (dmgi := hpi). Spell of first type can be used no more than a times in total, of the second type \xe2\x80\x94 no more than b times in total. Spell can be used on a certain creature multiple times. Spells can be used in arbitrary order. It isn\'t necessary to use all the spells.Max is really busy preparing for his final exams, so he asks you to determine what is the maximal total damage of all creatures he can achieve if he uses spells in most optimal way." 2100
976D "Degree Set" "constructive algorithms,graphs,implementation" "You are given a sequence of n positive integers d1,\xe2\x80\x89d2,\xe2\x80\x89...,\xe2\x80\x89dn (d1\xe2\x80\x89<\xe2\x80\x89d2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89dn). Your task is to construct an undirected graph such that:  there are exactly dn\xe2\x80\x89+\xe2\x80\x891 vertices;  there are no self-loops;  there are no multiple edges;  there are no more than 106 edges;  its degree set is equal to d. Vertices should be numbered 1 through (dn\xe2\x80\x89+\xe2\x80\x891).Degree sequence is an array a with length equal to the number of vertices in a graph such that ai is the number of vertices adjacent to i-th vertex.Degree set is a sorted in increasing order sequence of all distinct values from the degree sequence.It is guaranteed that there exists such a graph that all the conditions hold, and it contains no more than 106 edges.Print the resulting graph." 2500
976C "Nested Segments" greedy,implementation,sortings "You are given a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an of one-dimensional segments numbered 1 through n. Your task is to find two distinct indices i and j such that segment ai lies within segment aj.Segment [l1,\xe2\x80\x89r1] lies within segment [l2,\xe2\x80\x89r2] iff l1\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89l2 and r1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r2.Print indices i and j. If there are multiple answers, print any of them. If no answer exists, print -1 -1." 1500
976B "Lara Croft and the New Game" implementation,math "You might have heard about the next game in Lara Croft series coming out this year. You also might have watched its trailer. Though you definitely missed the main idea about its plot, so let me lift the veil of secrecy.Lara is going to explore yet another dangerous dungeon. Game designers decided to use good old 2D environment. The dungeon can be represented as a rectangle matrix of n rows and m columns. Cell (x,\xe2\x80\x89y) is the cell in the x-th row in the y-th column. Lara can move between the neighbouring by side cells in all four directions.Moreover, she has even chosen the path for herself to avoid all the traps. She enters the dungeon in cell (1,\xe2\x80\x891), that is top left corner of the matrix. Then she goes down all the way to cell (n,\xe2\x80\x891) \xe2\x80\x94 the bottom left corner. Then she starts moving in the snake fashion \xe2\x80\x94 all the way to the right, one cell up, then to the left to the cell in 2-nd column, one cell up. She moves until she runs out of non-visited cells. n and m given are such that she always end up in cell (1,\xe2\x80\x892).Lara has already moved to a neighbouring cell k times. Can you determine her current position?" 1300
976A "Minimum Binary Number" implementation "String can be called correct if it consists of characters ""0"" and ""1"" and there are no redundant leading zeroes. Here are some examples: ""0"", ""10"", ""1001"".You are given a correct string s.You can perform two different operations on this string:   swap any pair of adjacent characters (for example, ""101""  ""110"");  replace ""11"" with ""1"" (for example, ""110""  ""10""). Let val(s) be such a number that s is its binary representation.Correct string a is less than some other correct string b iff val(a)\xe2\x80\x89<\xe2\x80\x89val(b).Your task is to find the minimum correct string that you can obtain from the given one using the operations described above. You can use these operations any number of times in any order (or even use no operations at all)." 800
975E "Hag\'s Khashba" geometry "Hag is a very talented person. He has always had an artist inside him but his father forced him to study mechanical engineering.Yesterday he spent all of his time cutting a giant piece of wood trying to make it look like a goose. Anyway, his dad found out that he was doing arts rather than studying mechanics and other boring subjects. He confronted Hag with the fact that he is a spoiled son that does not care about his future, and if he continues to do arts he will cut his 25 Lira monthly allowance.Hag is trying to prove to his dad that the wooden piece is a project for mechanics subject. He also told his dad that the wooden piece is a strictly convex polygon with nn vertices.Hag brought two pins and pinned the polygon with them in the 11-st and 22-nd vertices to the wall. His dad has qq queries to Hag of two types.   11 ff tt: pull a pin from the vertex ff, wait for the wooden polygon to rotate under the gravity force (if it will rotate) and stabilize. And then put the pin in vertex tt.  22 vv: answer what are the coordinates of the vertex vv. Please help Hag to answer his father\'s queries.You can assume that the wood that forms the polygon has uniform density and the polygon has a positive thickness, same in all points. After every query of the 1-st type Hag\'s dad tries to move the polygon a bit and watches it stabilize again." 2600
975D Ghosts geometry,math "Ghosts live in harmony and peace, they travel the space without any purpose other than scare whoever stands in their way.There are n ghosts in the universe, they move in the OXY plane, each one of them has its own velocity that does not change in time: \xe2\x86\x92V=Vx\xe2\x86\x92i+Vy\xe2\x86\x92j where Vx is its speed on the x-axis and Vy is on the y-axis.A ghost i has experience value EXi, which represent how many ghosts tried to scare him in his past. Two ghosts scare each other if they were in the same cartesian point at a moment of time.As the ghosts move with constant speed, after some moment of time there will be no further scaring (what a relief!) and the experience of ghost kind GX=\xe2\x88\x91ni=1EXi will never increase.Tameem is a red giant, he took a picture of the cartesian plane at a certain moment of time T, and magically all the ghosts were aligned on a line of the form y=a\xe2\x8b\x85x+b. You have to compute what will be the experience index of the ghost kind GX in the indefinite future, this is your task for today.Note that when Tameem took the picture, GX may already be greater than 0, because many ghosts may have scared one another at any moment between [\xe2\x88\x92\xe2\x88\x9e,T]." 2000
975C "Valhalla Siege" "binary search" "Ivar the Boneless is a great leader. He is trying to capture Kattegat from Lagertha. The war has begun and wave after wave Ivar\'s warriors are falling in battle.Ivar has n warriors, he places them on a straight line in front of the main gate, in a way that the i-th warrior stands right after (i\xe2\x88\x921)-th warrior. The first warrior leads the attack.Each attacker can take up to ai arrows before he falls to the ground, where ai is the i-th warrior\'s strength.Lagertha orders her warriors to shoot ki arrows during the i-th minute, the arrows one by one hit the first still standing warrior. After all Ivar\'s warriors fall and all the currently flying arrows fly by, Thor smashes his hammer and all Ivar\'s warriors get their previous strengths back and stand up to fight again. In other words, if all warriors die in minute t, they will all be standing to fight at the end of minute t.The battle will last for q minutes, after each minute you should tell Ivar what is the number of his standing warriors." 1400
975B Mancala "brute force,implementation" "Mancala is a game famous in the Middle East. It is played on a board that consists of 14 holes.   Initially, each hole has ai stones. When a player makes a move, he chooses a hole which contains a positive number of stones. He takes all the stones inside it and then redistributes these stones one by one in the next holes in a counter-clockwise direction.Note that the counter-clockwise order means if the player takes the stones from hole i, he will put one stone in the (i+1)-th hole, then in the (i+2)-th, etc. If he puts a stone in the 14-th hole, the next one will be put in the first hole.After the move, the player collects all the stones from holes that contain even number of stones. The number of stones collected by player is the score, according to Resli.Resli is a famous Mancala player. He wants to know the maximum score he can obtain after one move." 1100
975A "Aramic script" implementation,strings "In Aramic language words can only represent objects.Words in Aramic have special properties:   A word is a root if it does not contain the same letter more than once.  A root and all its permutations represent the same object.  The root x of a word y is the word that contains all letters that appear in y in a way that each letter appears once. For example, the root of ""aaaa"", ""aa"", ""aaa"" is ""a"", the root of ""aabb"", ""bab"", ""baabb"", ""ab"" is ""ab"".  Any word in Aramic represents the same object as its root. You have an ancient script in Aramic. What is the number of different objects mentioned in the script?" 900
967B "Watering System" math,sortings "Arkady wants to water his only flower. Unfortunately, he has a very poor watering system that was designed for n flowers and so it looks like a pipe with n holes. Arkady can only use the water that flows from the first hole.Arkady can block some of the holes, and then pour A liters of water into the pipe. After that, the water will flow out from the non-blocked holes proportionally to their sizes s1,s2,\xe2\x80\xa6,sn. In other words, if the sum of sizes of non-blocked holes is S, and the i-th hole is not blocked, si\xe2\x8b\x85AS liters of water will flow out of it.What is the minimum number of holes Arkady should block to make at least B liters of water flow out of the first hole?" 1000
967A "Mind the Gap" implementation "These days Arkady works as an air traffic controller at a large airport. He controls a runway which is usually used for landings only. Thus, he has a schedule of planes that are landing in the nearest future, each landing lasts 1 minute.He was asked to insert one takeoff in the schedule. The takeoff takes 1 minute itself, but for safety reasons there should be a time space between the takeoff and any landing of at least s minutes from both sides.Find the earliest time when Arkady can insert the takeoff." 1100
965E "Short Code" "data structures,dp,greedy,strings,trees" "Arkady\'s code contains n variables. Each variable has a unique name consisting of lowercase English letters only. One day Arkady decided to shorten his code.He wants to replace each variable name with its non-empty prefix so that these new names are still unique (however, a new name of some variable can coincide with some old name of another or same variable). Among such possibilities he wants to find the way with the smallest possible total length of the new names.A string a is a prefix of a string b if you can delete some (possibly none) characters from the end of b and obtain a.Please find this minimum possible total length of new names." 2200
965D "Single-use Stones" "binary search,flows,greedy,two pointers" "A lot of frogs want to cross a river. A river is w units width, but frogs can only jump l units long, where l<w. Frogs can also jump on lengths shorter than l. but can\'t jump longer. Hopefully, there are some stones in the river to help them.The stones are located at integer distances from the banks. There are ai stones at the distance of i units from the bank the frogs are currently at. Each stone can only be used once by one frog, after that it drowns in the water.What is the maximum number of frogs that can cross the river, given that then can only jump on the stones?" 1900
965C "Greedy Arkady" math "k people want to split n candies between them. Each candy should be given to exactly one of them or be thrown away.The people are numbered from 1 to k, and Arkady is the first of them. To split the candies, Arkady will choose an integer x and then give the first x candies to himself, the next x candies to the second person, the next x candies to the third person and so on in a cycle. The leftover (the remainder that is not divisible by x) will be thrown away.Arkady can\'t choose x greater than M as it is considered greedy. Also, he can\'t choose such a small x that some person will receive candies more than D times, as it is considered a slow splitting.Please find what is the maximum number of candies Arkady can receive by choosing some valid x." 2000
965B Battleship implementation "Arkady is playing Battleship. The rules of this game aren\'t really important.There is a field of n\xc3\x97n cells. There should be exactly one k-decker on the field, i. e. a ship that is k cells long oriented either horizontally or vertically. However, Arkady doesn\'t know where it is located. For each cell Arkady knows if it is definitely empty or can contain a part of the ship.Consider all possible locations of the ship. Find such a cell that belongs to the maximum possible number of different locations of the ship." 1300
965A "Paper Airplanes" math "To make a paper airplane, one has to use a rectangular piece of paper. From a sheet of standard size you can make s airplanes.A group of k people decided to make n airplanes each. They are going to buy several packs of paper, each of them containing p sheets, and then distribute the sheets between the people. Each person should have enough sheets to make n airplanes. How many packs should they buy?" 800
964B Messages math "There are n incoming messages for Vasya. The i-th message is going to be received after ti minutes. Each message has a cost, which equals to A initially. After being received, the cost of a message decreases by B each minute (it can become negative). Vasya can read any message after receiving it at any moment of time. After reading the message, Vasya\'s bank account receives the current cost of this message. Initially, Vasya\'s bank account is at 0.Also, each minute Vasya\'s bank account receives C\xc2\xb7k, where k is the amount of received but unread messages.Vasya\'s messages are very important to him, and because of that he wants to have all messages read after T minutes.Determine the maximum amount of money Vasya\'s bank account can hold after T minutes." 1300
964A Splits math "Let\'s define a split of n as a nonincreasing sequence of positive integers, the sum of which is n. For example, the following sequences are splits of 8: [4,4], [3,3,2], [2,2,1,1,1,1], [5,2,1].The following sequences aren\'t splits of 8: [1,7], [5,4], [11,\xe2\x88\x923], [1,1,4,1,1].The weight of a split is the number of elements in the split that are equal to the first element. For example, the weight of the split [1,1,1,1,1] is 5, the weight of the split [5,5,3,3,3] is 2 and the weight of the split [9] equals 1.For a given n, find out the number of different weights of its splits." 800
963E "Circles of Waiting" math "A chip was placed on a field with coordinate system onto point (0,\xe2\x80\x890).Every second the chip moves randomly. If the chip is currently at a point (x,\xe2\x80\x89y), after a second it moves to the point (x\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89y) with probability p1, to the point (x,\xe2\x80\x89y\xe2\x80\x89-\xe2\x80\x891) with probability p2, to the point (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y) with probability p3 and to the point (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891) with probability p4. It\'s guaranteed that p1\xe2\x80\x89+\xe2\x80\x89p2\xe2\x80\x89+\xe2\x80\x89p3\xe2\x80\x89+\xe2\x80\x89p4\xe2\x80\x89=\xe2\x80\x891. The moves are independent.Find out the expected time after which chip will move away from origin at a distance greater than R (i.e.  will be satisfied)." 3100
963D "Frequency of String" "hashing,string suffix structures,strings" "You are given a string s. You should answer n queries. The i-th query consists of integer ki and string mi. The answer for this query is the minimum length of such a string t that t is a substring of s and mi has at least ki occurrences as a substring in t.A substring of a string is a continuous segment of characters of the string.It is guaranteed that for any two queries the strings mi from these queries are different." 2500
963C "Cutting Rectangle" "brute force,math,number theory" "A rectangle with sides A and B is cut into rectangles with cuts parallel to its sides. For example, if p horizontal and q vertical cuts were made, (p+1)\xe2\x8b\x85(q+1) rectangles were left after the cutting. After the cutting, rectangles were of n different types. Two rectangles are different if at least one side of one rectangle isn\'t equal to the corresponding side of the other. Note that the rectangle can\'t be rotated, this means that rectangles a\xc3\x97b and b\xc3\x97a are considered different if a\xe2\x89\xa0b.For each type of rectangles, lengths of the sides of rectangles are given along with the amount of the rectangles of this type that were left after cutting the initial rectangle.Calculate the amount of pairs (A;B) such as the given rectangles could be created by cutting the rectangle with sides of lengths A and B. Note that pairs (A;B) and (B;A) are considered different when A\xe2\x89\xa0B." 2600
963B "Destruction of a Tree" "constructive algorithms,dfs and similar,dp,greedy,trees" "You are given a tree (a graph with n vertices and n\xe2\x80\x89-\xe2\x80\x891 edges in which it\'s possible to reach any vertex from any other vertex using only its edges).A vertex can be destroyed if this vertex has even degree. If you destroy a vertex, all edges connected to it are also deleted.Destroy all vertices in the given tree or determine that it is impossible." 2000
963A "Alternating Sum" "math,number theory" "You are given two integers a and b. Moreover, you are given a sequence s0,s1,\xe2\x80\xa6,sn. All values in s are integers 1 or \xe2\x88\x921. It\'s known that sequence is k-periodic and k divides n+1. In other words, for each k\xe2\x89\xa4i\xe2\x89\xa4n it\'s satisfied that si=si\xe2\x88\x92k.Find out the non-negative remainder of division of n\xe2\x88\x91i=0sian\xe2\x88\x92ibi by 109+9.Note that the modulo is unusual!" 1800
962G "Visible Black Areas" "data structures,dsu,geometry,trees" "Petya has a polygon consisting of n vertices. All sides of the Petya\'s polygon are parallel to the coordinate axes, and each two adjacent sides of the Petya\'s polygon are perpendicular. It is guaranteed that the polygon is simple, that is, it doesn\'t have self-intersections and self-touches. All internal area of the polygon (borders are not included) was painted in black color by Petya.Also, Petya has a rectangular window, defined by its coordinates, through which he looks at the polygon. A rectangular window can not be moved. The sides of the rectangular window are parallel to the coordinate axes.  Blue color represents the border of a polygon, red color is the Petya\'s window. The answer in this case is 2. Determine the number of black connected areas of Petya\'s polygon, which can be seen through the rectangular window." 2800
962F "Simple Cycles Edges" "dfs and similar,graphs,trees" "You are given an undirected graph, consisting of n vertices and m edges. The graph does not necessarily connected. Guaranteed, that the graph does not contain multiple edges (more than one edges between a pair of vertices) or loops (edges from a vertex to itself).A cycle in a graph is called a simple, if it contains each own vertex exactly once. So simple cycle doesn\'t allow to visit a vertex more than once in a cycle.Determine the edges, which belong to exactly on one simple cycle." 2400
962E "Byteland, Berland and Disputed Cities" "constructive algorithms,greedy" "The cities of Byteland and Berland are located on the axis Ox. In addition, on this axis there are also disputed cities, which belong to each of the countries in their opinion. Thus, on the line Ox there are three types of cities:  the cities of Byteland,  the cities of Berland,  disputed cities. Recently, the project BNET has been launched \xe2\x80\x94 a computer network of a new generation. Now the task of the both countries is to connect the cities so that the network of this country is connected.The countries agreed to connect the pairs of cities with BNET cables in such a way that:  If you look at the only cities of Byteland and the disputed cities, then in the resulting set of cities, any city should be reachable from any other one by one or more cables,  If you look at the only cities of Berland and the disputed cities, then in the resulting set of cities, any city should be reachable from any other one by one or more cables. Thus, it is necessary to choose a set of pairs of cities to connect by cables in such a way that both conditions are satisfied simultaneously. Cables allow bi-directional data transfer. Each cable connects exactly two distinct cities.The cost of laying a cable from one city to another is equal to the distance between them. Find the minimum total cost of laying a set of cables so that two subsets of cities (Byteland and disputed cities, Berland and disputed cities) are connected.Each city is a point on the line Ox. It is technically possible to connect the cities a and b with a cable so that the city c (a<c<b) is not connected to this cable, where a, b and c are simultaneously coordinates of the cities a, b and c." 2200
962D "Merge Equals" "data structures,implementation" "You are given an array of positive integers. While there are at least two equal elements, we will perform the following operation. We choose the smallest value x that occurs in the array 2 or more times. Take the first two occurrences of x in this array (the two leftmost occurrences). Remove the left of these two occurrences, and the right one is replaced by the sum of this two values (that is, 2\xe2\x8b\x85x).Determine how the array will look after described operations are performed.For example, consider the given array looks like [3,4,1,2,2,1,1]. It will be changed in the following way: [3,4,1,2,2,1,1] \xe2\x86\x92 [3,4,2,2,2,1] \xe2\x86\x92 [3,4,4,2,1] \xe2\x86\x92 [3,8,2,1].If the given array is look like [1,1,3,1,1] it will be changed in the following way: [1,1,3,1,1] \xe2\x86\x92 [2,3,1,1] \xe2\x86\x92 [2,3,2] \xe2\x86\x92 [3,4]." 1600
962C "Make a Square" "brute force,implementation,math" "You are given a positive integer n, written without leading zeroes (for example, the number 04 is incorrect). In one operation you can delete any digit of the given integer so that the result remains a positive integer without leading zeros.Determine the minimum number of operations that you need to consistently apply to the given integer n to make from it the square of some positive integer or report that it is impossible.An integer x is the square of some positive integer if and only if x=y2 for some positive integer y." 1400
962B "Students in Railway Carriage" "constructive algorithms,greedy,implementation" "There are n consecutive seat places in a railway carriage. Each place is either empty or occupied by a passenger.The university team for the Olympiad consists of a student-programmers and b student-athletes. Determine the largest number of students from all a+b students, which you can put in the railway carriage so that:  no student-programmer is sitting next to the student-programmer;  and no student-athlete is sitting next to the student-athlete. In the other words, there should not be two consecutive (adjacent) places where two student-athletes or two student-programmers are sitting.Consider that initially occupied seat places are occupied by jury members (who obviously are not students at all)." 1300
962A Equator implementation "Polycarp has created his own training plan to prepare for the programming contests. He will train for n days, all days are numbered from 1 to n, beginning from the first.On the i-th day Polycarp will necessarily solve ai problems. One evening Polycarp plans to celebrate the equator. He will celebrate it on the first evening of such a day that from the beginning of the training and to this day inclusive he will solve half or more of all the problems.Determine the index of day when Polycarp will celebrate the equator." 1300
961G Partitions "combinatorics,math,number theory" "You are given a set of n elements indexed from 1 to n. The weight of i-th element is wi. The weight of some subset of a given set is denoted as . The weight of some partition R of a given set into k subsets is  (recall that a partition of a given set is a set of its subsets such that every element of the given set belongs to exactly one subset in partition).Calculate the sum of weights of all partitions of a given set into exactly k non-empty subsets, and print it modulo 109\xe2\x80\x89+\xe2\x80\x897. Two partitions are considered different iff there exist two elements x and y such that they belong to the same set in one of the partitions, and to different sets in another partition." 2700
961F k-substrings "binary search,hashing,string suffix structures" "You are given a string s consisting of n lowercase Latin letters.Let\'s denote k-substring of s as a string subsk\xe2\x80\x89=\xe2\x80\x89sksk\xe2\x80\x89+\xe2\x80\x891..sn\xe2\x80\x89+\xe2\x80\x891\xe2\x80\x89-\xe2\x80\x89k. Obviously, subs1\xe2\x80\x89=\xe2\x80\x89s, and there are exactly  such substrings.Let\'s call some string t an odd proper suprefix of a string T iff the following conditions are met: |T|\xe2\x80\x89>\xe2\x80\x89|t|;  |t| is an odd number;  t is simultaneously a prefix and a suffix of T.For evey k-substring () of s you have to calculate the maximum length of its odd proper suprefix." 2700
961E Tufurama "data structures" "One day Polycarp decided to rewatch his absolute favourite episode of well-known TV series ""Tufurama"". He was pretty surprised when he got results only for season 7 episode 3 with his search query of ""Watch Tufurama season 3 episode 7 online full hd free"". This got Polycarp confused \xe2\x80\x94 what if he decides to rewatch the entire series someday and won\'t be able to find the right episodes to watch? Polycarp now wants to count the number of times he will be forced to search for an episode using some different method.TV series have n seasons (numbered 1 through n), the i-th season has ai episodes (numbered 1 through ai). Polycarp thinks that if for some pair of integers x and y (x\xe2\x80\x89<\xe2\x80\x89y) exist both season x episode y and season y episode x then one of these search queries will include the wrong results. Help Polycarp to calculate the number of such pairs!" 1900
961D "Pair Of Lines" geometry "You are given n points on Cartesian plane. Every point is a lattice point (i.\xe2\x80\x89e. both of its coordinates are integers), and all points are distinct.You may draw two straight lines (not necessarily distinct). Is it possible to do this in such a way that every point lies on at least one of these lines?" 2000
961C Chessboard "bitmasks,brute force,implementation" "Magnus decided to play a classic chess game. Though what he saw in his locker shocked him! His favourite chessboard got broken into 4 pieces, each of size n by n, n is always odd. And what\'s even worse, some squares were of wrong color. j-th square of the i-th row of k-th piece of the board has color ak,\xe2\x80\x89i,\xe2\x80\x89j; 1 being black and 0 being white. Now Magnus wants to change color of some squares in such a way that he recolors minimum number of squares and obtained pieces form a valid chessboard. Every square has its color different to each of the neightbouring by side squares in a valid board. Its size should be 2n by 2n. You are allowed to move pieces but not allowed to rotate or flip them." 1400
961B "Lecture Sleep" "data structures,dp,implementation,two pointers" "Your friend Mishka and you attend a calculus lecture. Lecture lasts n minutes. Lecturer tells ai theorems during the i-th minute.Mishka is really interested in calculus, though it is so hard to stay awake for all the time of lecture. You are given an array t of Mishka\'s behavior. If Mishka is asleep during the i-th minute of the lecture then ti will be equal to 0, otherwise it will be equal to 1. When Mishka is awake he writes down all the theorems he is being told \xe2\x80\x94 ai during the i-th minute. Otherwise he writes nothing.You know some secret technique to keep Mishka awake for k minutes straight. However you can use it only once. You can start using it at the beginning of any minute between 1 and n\xe2\x80\x89-\xe2\x80\x89k\xe2\x80\x89+\xe2\x80\x891. If you use it on some minute i then Mishka will be awake during minutes j such that  and will write down all the theorems lecturer tells.You task is to calculate the maximum number of theorems Mishka will be able to write down if you use your technique only once to wake him up." 1200
961A Tetris implementation "You are given a following process. There is a platform with n columns. 1\xc3\x971 squares are appearing one after another in some columns on this platform. If there are no squares in the column, a square will occupy the bottom row. Otherwise a square will appear at the top of the highest square of this column. When all of the n columns have at least one square in them, the bottom row is being removed. You will receive 1 point for this, and all the squares left will fall down one row. You task is to calculate the amount of points you will receive." 900
960H "Santa\'s Gift" "data structures,trees" "Santa has an infinite number of candies for each of m flavours. You are given a rooted tree with n vertices. The root of the tree is the vertex 1. Each vertex contains exactly one candy. The i-th vertex has a candy of flavour fi.Sometimes Santa fears that candies of flavour k have melted. He chooses any vertex x randomly and sends the subtree of x to the Bakers for a replacement. In a replacement, all the candies with flavour k are replaced with a new candy of the same flavour. The candies which are not of flavour k are left unchanged. After the replacement, the tree is restored.The actual cost of replacing one candy of flavour k is ck (given for each k). The Baker keeps the price fixed in order to make calculation simple. Every time when a subtree comes for a replacement, the Baker charges C, no matter which subtree it is and which flavour it is.Suppose that for a given flavour k the probability that Santa chooses a vertex for replacement is same for all the vertices. You need to find out the expected value of error in calculating the cost of replacement of flavour k. The error in calculating the cost is defined as follows.Error E(k)= (ActualCost \xe2\x80\x93 Price charged by the Bakers)2.Note that the actual cost is the cost of replacement of one candy of the flavour k multiplied by the number of candies in the subtree.Also, sometimes Santa may wish to replace a candy at vertex x with a candy of some flavour from his pocket.You need to handle two types of operations:   Change the flavour of the candy at vertex x to w.  Calculate the expected value of error in calculating the cost of replacement for a given flavour k." 3100
960G "Bandit Blues" combinatorics,dp,fft,math "Japate, while traveling through the forest of Mala, saw N bags of gold lying in a row. Each bag has some distinct weight of gold between 1 to N. Japate can carry only one bag of gold with him, so he uses the following strategy to choose a bag.Initially, he starts with an empty bag (zero weight). He considers the bags in some order. If the current bag has a higher weight than the bag in his hand, he picks the current bag.Japate put the bags in some order. Japate realizes that he will pick A bags, if he starts picking bags from the front, and will pick B bags, if he starts picking bags from the back. By picking we mean replacing the bag in his hand with the current one.Now he wonders how many permutations of bags are possible, in which he picks A bags from the front and B bags from back using the above strategy.Since the answer can be very large, output it modulo 998244353." 2900
960F Pathwalks "data structures,dp,graphs" "You are given a directed graph with n nodes and m edges, with all edges having a certain weight. There might be multiple edges and self loops, and the graph can also be disconnected. You need to choose a path (possibly passing through same vertices multiple times) in the graph such that the weights of the edges are in strictly increasing order, and these edges come in the order of input. Among all such paths, you need to find the the path that has the maximum possible number of edges, and report this value.Please note that the edges picked don\'t have to be consecutive in the input." 2100
960E "Alternating Tree" "combinatorics,dfs and similar,divide and conquer,dp,probabilities,trees" "Given a tree with n nodes numbered from 1 to n. Each node i has an associated value Vi.If the simple path from u1 to um consists of m nodes namely u1\xe2\x86\x92u2\xe2\x86\x92u3\xe2\x86\x92\xe2\x80\xa6um\xe2\x88\x921\xe2\x86\x92um, then its alternating function A(u1,um) is defined as A(u1,um)=m\xe2\x88\x91i=1(\xe2\x88\x921)i+1\xe2\x8b\x85Vui. A path can also have 0 edges, i.e. u1=um.Compute the sum of alternating functions of all unique simple paths. Note that the paths are directed: two paths are considered different if the starting vertices differ or the ending vertices differ. The answer may be large so compute it modulo 109+7." 2300
960D "Full Binary Tree Queries" "brute force,implementation,trees" "You have a full binary tree having infinite levels.Each node has an initial value. If a node has value x, then its left child has value 2\xc2\xb7x and its right child has value 2\xc2\xb7x\xe2\x80\x89+\xe2\x80\x891. The value of the root is 1. You need to answer Q queries. There are 3 types of queries:  Cyclically shift the values of all nodes on the same level as node with value X by K units. (The values/nodes of any other level are not affected). Cyclically shift the nodes on the same level as node with value X by K units. (The subtrees of these nodes will move along with them). Print the value of every node encountered on the simple path from the node with value X to the root.Positive K implies right cyclic shift and negative K implies left cyclic shift. It is guaranteed that atleast one type 3 query is present." 2100
960C "Subsequence Counting" "bitmasks,constructive algorithms,greedy,implementation" "Pikachu had an array with him. He wrote down all the non-empty subsequences of the array on paper. Note that an array of size n has 2n\xe2\x80\x89-\xe2\x80\x891 non-empty subsequences in it. Pikachu being mischievous as he always is, removed all the subsequences in which Maximum_element_of_the_subsequence \xe2\x80\x89-\xe2\x80\x89 Minimum_element_of_subsequence \xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89dPikachu was finally left with X subsequences. However, he lost the initial array he had, and now is in serious trouble. He still remembers the numbers X and d. He now wants you to construct any such array which will satisfy the above conditions. All the numbers in the final array should be positive integers less than 1018. Note the number of elements in the output array should not be more than 104. If no answer is possible, print \xe2\x80\x89-\xe2\x80\x891." 1700
960B "Minimize the error" "data structures,greedy,sortings" "You are given two arrays A and B, each of size n. The error, E, between these two arrays is defined . You have to perform exactly k1 operations on array A and exactly k2 operations on array B. In one operation, you have to choose one element of the array and increase or decrease it by 1.Output the minimum possible value of error after k1 operations on array A and k2 operations on array B have been performed." 1500
960A "Check the string" implementation "A has a string consisting of some number of lowercase English letters \'a\'. He gives it to his friend B who appends some number of letters \'b\' to the end of this string. Since both A and B like the characters \'a\' and \'b\', they have made sure that at this point, at least one \'a\' and one \'b\' exist in the string.B now gives this string to C and he appends some number of letters \'c\' to the end of the string. However, since C is a good friend of A and B, the number of letters \'c\' he appends is equal to the number of \'a\' or to the number of \'b\' in the string. It is also possible that the number of letters \'c\' equals both to the number of letters \'a\' and to the number of letters \'b\' at the same time.You have a string in your hands, and you want to check if it is possible to obtain the string in this way or not. If it is possible to obtain the string, print ""YES"", otherwise print ""NO"" (without the quotes)." 1200
959F "Mahmoud and Ehab and yet another xor task" bitmasks,dp,math,matrices "Ehab has an array a of n integers. He likes the bitwise-xor operation and he likes to bother Mahmoud so he came up with a problem. He gave Mahmoud q queries. In each of them, he gave Mahmoud 2 integers l and x, and asked him to find the number of subsequences of the first l elements of the array such that their bitwise-xor sum is x. Can you help Mahmoud answer the queries?A subsequence can contain elements that are not neighboring." 2400
959E "Mahmoud and Ehab and the xor-MST" bitmasks,dp,graphs,implementation,math "Ehab is interested in the bitwise-xor operation and the special graphs. Mahmoud gave him a problem that combines both. He has a complete graph consisting of n vertices numbered from 0 to n\xe2\x80\x89-\xe2\x80\x891. For all 0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89u\xe2\x80\x89<\xe2\x80\x89v\xe2\x80\x89<\xe2\x80\x89n, vertex u and vertex v are connected with an undirected edge that has weight  (where  is the bitwise-xor operation). Can you find the weight of the minimum spanning tree of that graph?You can read about complete graphs in https://en.wikipedia.org/wiki/Complete_graphYou can read about the minimum spanning tree in https://en.wikipedia.org/wiki/Minimum_spanning_treeThe weight of the minimum spanning tree is the sum of the weights on the edges included in it." 1900
959D "Mahmoud and Ehab and another array construction task" "constructive algorithms,greedy,math,number theory" "Mahmoud has an array a consisting of n integers. He asked Ehab to find another array b of the same length such that:  b is lexicographically greater than or equal to a.  bi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892.  b is pairwise coprime: for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n, bi and bj are coprime, i. e. GCD(bi,\xe2\x80\x89bj)\xe2\x80\x89=\xe2\x80\x891, where GCD(w,\xe2\x80\x89z) is the greatest common divisor of w and z. Ehab wants to choose a special array so he wants the lexicographically minimal array between all the variants. Can you find it?An array x is lexicographically greater than an array y if there exists an index i such than xi\xe2\x80\x89>\xe2\x80\x89yi and xj\xe2\x80\x89=\xe2\x80\x89yj for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89i. An array x is equal to an array y if xi\xe2\x80\x89=\xe2\x80\x89yi for all 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n." 1900
959C "Mahmoud and Ehab and the wrong algorithm" "constructive algorithms,trees" "Mahmoud was trying to solve the vertex cover problem on trees. The problem statement is:Given an undirected tree consisting of n nodes, find the minimum number of vertices that cover all the edges. Formally, we need to find a set of vertices such that for each edge (u,\xe2\x80\x89v) that belongs to the tree, either u is in the set, or v is in the set, or both are in the set. Mahmoud has found the following algorithm:  Root the tree at node 1.  Count the number of nodes at an even depth. Let it be evenCnt.  Count the number of nodes at an odd depth. Let it be oddCnt.  The answer is the minimum between evenCnt and oddCnt. The depth of a node in a tree is the number of edges in the shortest path between this node and the root. The depth of the root is 0.Ehab told Mahmoud that this algorithm is wrong, but he didn\'t believe because he had tested his algorithm against many trees and it worked, so Ehab asked you to find 2 trees consisting of n nodes. The algorithm should find an incorrect answer for the first tree and a correct answer for the second one." 1500
959B "Mahmoud and Ehab and the message" dsu,greedy,implementation "Mahmoud wants to send a message to his friend Ehab. Their language consists of n words numbered from 1 to n. Some words have the same meaning so there are k groups of words such that all the words in some group have the same meaning.Mahmoud knows that the i-th word can be sent with cost ai. For each word in his message, Mahmoud can either replace it with another word of the same meaning or leave it as it is. Can you help Mahmoud determine the minimum cost of sending the message?The cost of sending the message is the sum of the costs of sending every word in it." 1200
959A "Mahmoud and Ehab and the even-odd game" games,math "Mahmoud and Ehab play a game called the even-odd game. Ehab chooses his favorite integer n and then they take turns, starting from Mahmoud. In each player\'s turn, he has to choose an integer a and subtract it from n such that:  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n.  If it\'s Mahmoud\'s turn, a has to be even, but if it\'s Ehab\'s turn, a has to be odd. If the current player can\'t choose any number satisfying the conditions, he loses. Can you determine the winner if they both play optimally?" 800
958F3 "Lightsabers (hard)" fft "There used to be unrest in the Galactic Senate. Several thousand solar systems had declared their intentions to leave the Republic. But fear not! Master Heidi was able to successfully select the Jedi Knights that have restored peace in the galaxy. However, she knows that evil never sleeps and a time may come when she will need to pick another group of Jedi Knights. She wants to be sure she has enough options to do so.There are n Jedi Knights, each of them with a lightsaber of one of m colors. Given a number k, compute the number of differently colored collections of k lightsabers that some k Jedi Knights might have. Jedi Knights with lightsabers of the same color are indistinguishable (it\'s not the person, it\'s the lightsaber color that matters!), and their order does not matter; that is, we consider two collections of Jedi Knights to be different if and only if their vectors of counts of lightsabers of each color (like what you were given in the easy and the medium versions) are different. We count all subsets, not only contiguous subsegments of the input sequence. Output the answer modulo 1009." 2600
958F2 "Lightsabers (medium)" "binary search,two pointers" "There is unrest in the Galactic Senate. Several thousand solar systems have declared their intentions to leave the Republic. Master Heidi needs to select the Jedi Knights who will go on peacekeeping missions throughout the galaxy. It is well-known that the success of any peacekeeping mission depends on the colors of the lightsabers of the Jedi who will go on that mission. Heidi has n Jedi Knights standing in front of her, each one with a lightsaber of one of m possible colors. She knows that for the mission to be the most effective, she needs to select some contiguous interval of knights such that there are exactly k1 knights with lightsabers of the first color, k2 knights with lightsabers of the second color, ..., km knights with lightsabers of the m-th color.However, since the last time, she has learned that it is not always possible to select such an interval. Therefore, she decided to ask some Jedi Knights to go on an indefinite unpaid vacation leave near certain pits on Tatooine, if you know what I mean. Help Heidi decide what is the minimum number of Jedi Knights that need to be let go before she is able to select the desired interval from the subsequence of remaining knights." 1800
958F1 "Lightsabers (easy)" implementation "There is unrest in the Galactic Senate. Several thousand solar systems have declared their intentions to leave the Republic. Master Heidi needs to select the Jedi Knights who will go on peacekeeping missions throughout the galaxy. It is well-known that the success of any peacekeeping mission depends on the colors of the lightsabers of the Jedi who will go on that mission. Heidi has n Jedi Knights standing in front of her, each one with a lightsaber of one of m possible colors. She knows that for the mission to be the most effective, she needs to select some contiguous interval of knights such that there are exactly k1 knights with lightsabers of the first color, k2 knights with lightsabers of the second color, ..., km knights with lightsabers of the m-th color. Help her find out if this is possible." 1500
958E3 "Guard Duty (hard)" geometry "Now that Heidi knows that she can assign Rebel spaceships to bases (recall the easy subtask), she is asking you: how exactly to do this? Now, given positions of N spaceships and N bases on a plane, your task is to connect spaceships and bases with line segments so that:   The segments do not intersect.  Such a connection forms a perfect matching." 2700
958E2 "Guard Duty (medium)" "binary search,dp,greedy,sortings" "Princess Heidi decided to give orders to all her K Rebel ship commanders in person. Unfortunately, she is currently travelling through hyperspace, and will leave it only at N specific moments t1,\xe2\x80\x89t2,\xe2\x80\x89...,\xe2\x80\x89tN. The meetings with commanders must therefore start and stop at those times. Namely, each commander will board her ship at some time ti and disembark at some later time tj. Of course, Heidi needs to meet with all commanders, and no two meetings can be held during the same time. Two commanders cannot even meet at the beginnings/endings of the hyperspace jumps, because too many ships in one position could give out their coordinates to the enemy. Your task is to find minimum time that Princess Heidi has to spend on meetings, with her schedule satisfying the conditions above." 2200
958E1 "Guard Duty (easy)" "brute force,geometry,greedy,math" "The Rebel fleet is afraid that the Empire might want to strike back again. Princess Heidi needs to know if it is possible to assign R Rebel spaceships to guard B bases so that every base has exactly one guardian and each spaceship has exactly one assigned base (in other words, the assignment is a perfect matching). Since she knows how reckless her pilots are, she wants to be sure that any two (straight) paths \xe2\x80\x93 from a base to its assigned spaceship \xe2\x80\x93 do not intersect in the galaxy plane (that is, in 2D), and so there is no risk of collision." 1600
958D2 "Hyperspace Jump (hard)" NA "It is now 125 years later, but humanity is still on the run from a humanoid-cyborg race determined to destroy it. Or perhaps we are getting some stories mixed up here... In any case, the fleet is now smaller. However, in a recent upgrade, all the navigation systems have been outfitted with higher-dimensional, linear-algebraic jump processors.Now, in order to make a jump, a ship\'s captain needs to specify a subspace of the d-dimensional space in which the events are taking place. She does so by providing a generating set of vectors for that subspace.Princess Heidi has received such a set from the captain of each of m ships. Again, she would like to group up those ships whose hyperspace jump subspaces are equal. To do so, she wants to assign a group number between 1 and m to each of the ships, so that two ships have the same group number if and only if their corresponding subspaces are equal (even though they might be given using different sets of vectors).Help Heidi!" 2700
958D1 "Hyperspace Jump (easy)" "expression parsing,math" "The Rebel fleet is on the run. It consists of m ships currently gathered around a single planet. Just a few seconds ago, the vastly more powerful Empire fleet has appeared in the same solar system, and the Rebels will need to escape into hyperspace. In order to spread the fleet, the captain of each ship has independently come up with the coordinate to which that ship will jump. In the obsolete navigation system used by the Rebels, this coordinate is given as the value of an arithmetic expression of the form .To plan the future of the resistance movement, Princess Heidi needs to know, for each ship, how many ships are going to end up at the same coordinate after the jump. You are her only hope!" 1400
958C3 "Encryption (hard)" "data structures,dp" "Heidi is now just one code away from breaking the encryption of the Death Star plans. The screen that should be presenting her with the description of the next code looks almost like the previous one, though who would have thought that the evil Empire engineers would fill this small screen with several million digits! It is just ridiculous to think that anyone would read them all...Heidi is once again given a sequence A and two integers k and p. She needs to find out what the encryption key S is.Let X be a sequence of integers, and p a positive integer. We define the score of X to be the sum of the elements of X modulo p.Heidi is given a sequence A that consists of N integers, and also given integers k and p. Her goal is to split A into k parts such that:   Each part contains at least 1 element of A, and each part consists of contiguous elements of A.  No two parts overlap.  The total sum S of the scores of those parts is minimized (not maximized!). Output the sum S, which is the encryption code." 2500
958C2 "Encryption (medium)" dp "Heidi has now broken the first level of encryption of the Death Star plans, and is staring at the screen presenting her with the description of the next code she has to enter. It looks surprisingly similar to the first one \xe2\x80\x93 seems like the Empire engineers were quite lazy...Heidi is once again given a sequence A, but now she is also given two integers k and p. She needs to find out what the encryption key S is.Let X be a sequence of integers, and p a positive integer. We define the score of X to be the sum of the elements of X modulo p.Heidi is given a sequence A that consists of N integers, and also given integers k and p. Her goal is to split A into k part such that:   Each part contains at least 1 element of A, and each part consists of contiguous elements of A.  No two parts overlap.  The total sum S of the scores of those parts is maximized. Output the sum S \xe2\x80\x93 the encryption code." 2000
958C1 "Encryption (easy)" "brute force" "Rebel spy Heidi has just obtained the plans for the Death Star from the Empire and, now on her way to safety, she is trying to break the encryption of the plans (of course they are encrypted \xe2\x80\x93 the Empire may be evil, but it is not stupid!). The encryption has several levels of security, and here is how the first one looks.Heidi is presented with a screen that shows her a sequence of integers A and a positive integer p. She knows that the encryption code is a single number S, which is defined as follows:Define the score of X to be the sum of the elements of X modulo p.Heidi is given a sequence A that consists of N integers, and also given an integer p. She needs to split A into 2 parts such that:   Each part contains at least 1 element of A, and each part consists of contiguous elements of A.  The two parts do not overlap.  The total sum S of the scores of those two parts is maximized. This is the encryption code. Output the sum S, which is the encryption code." 1200
958B2 "Maximum Control (medium)" "data structures,dfs and similar,graphs,greedy,trees" "The Resistance is trying to take control over as many planets of a particular solar system as possible. Princess Heidi is in charge of the fleet, and she must send ships to some planets in order to maximize the number of controlled planets.The Galaxy contains N planets, connected by bidirectional hyperspace tunnels in such a way that there is a unique path between every pair of the planets.A planet is controlled by the Resistance if there is a Resistance ship in its orbit, or if the planet lies on the shortest path between some two planets that have Resistance ships in their orbits.Heidi has not yet made up her mind as to how many ships to use. Therefore, she is asking you to compute, for every K\xe2\x80\x89=\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x893,\xe2\x80\x89...,\xe2\x80\x89N, the maximum number of planets that can be controlled with a fleet consisting of K ships." 2200
958B1 "Maximum Control (easy)" implementation "The Resistance is trying to take control over all planets in a particular solar system. This solar system is shaped like a tree. More precisely, some planets are connected by bidirectional hyperspace tunnels in such a way that there is a path between every pair of the planets, but removing any tunnel would disconnect some of them.The Resistance already has measures in place that will, when the time is right, enable them to control every planet that is not remote. A planet is considered to be remote if it is connected to the rest of the planets only via a single hyperspace tunnel.How much work is there left to be done: that is, how many remote planets are there?" 1000
958A3 "Death Stars (hard)" NA "The stardate is 2015, and Death Stars are bigger than ever! This time, two rebel spies have yet again given Heidi two maps with the possible locations of the Death Stars.Heidi has now received two maps with possible locations of N Death Stars. She knows that each of the maps is possibly corrupted, and may contain some stars that are not Death Stars. Furthermore, each of the maps was created from a different point of view. Hence, stars that are shown in one of the maps are rotated and translated with respect to the other map. Now Heidi wants to find out which of the stars shown in both maps are actually Death Stars, and the correspondence between the Death Stars on the two maps." 3100
958A2 "Death Stars (medium)" hashing,strings "The stardate is 1983, and Princess Heidi is getting better at detecting the Death Stars. This time, two Rebel spies have yet again given Heidi two maps with the possible locations of the Death Star. Since she got rid of all double agents last time, she knows that both maps are correct, and indeed show the map of the solar system that contains the Death Star. However, this time the Empire has hidden the Death Star very well, and Heidi needs to find a place that appears on both maps in order to detect the Death Star.The first map is an N\xe2\x80\x89\xc3\x97\xe2\x80\x89M grid, each cell of which shows some type of cosmic object that is present in the corresponding quadrant of space. The second map is an M\xe2\x80\x89\xc3\x97\xe2\x80\x89N grid. Heidi needs to align those two maps in such a way that they overlap over some M\xe2\x80\x89\xc3\x97\xe2\x80\x89M section in which all cosmic objects are identical. Help Heidi by identifying where such an M\xe2\x80\x89\xc3\x97\xe2\x80\x89M section lies within both maps." 2000
958A1 "Death Stars (easy)" implementation "The stardate is 1977 and the science and art of detecting Death Stars is in its infancy. Princess Heidi has received information about the stars in the nearby solar system from the Rebel spies and now, to help her identify the exact location of the Death Star, she needs to know whether this information is correct. Two rebel spies have provided her with the maps of the solar system. Each map is an N\xe2\x80\x89\xc3\x97\xe2\x80\x89N grid, where each cell is either occupied by a star or empty. To see whether the information is correct, Heidi needs to know whether the two maps are of the same solar system, or if possibly one of the spies is actually an Empire double agent, feeding her false information.Unfortunately, spies may have accidentally rotated a map by 90, 180, or 270 degrees, or flipped it along the vertical or the horizontal axis, before delivering it to Heidi. If Heidi can rotate or flip the maps so that two of them become identical, then those maps are of the same solar system. Otherwise, there are traitors in the Rebel ranks! Help Heidi find out." 1400
957A "Tritonic Iridescence" implementation "Overlooking the captivating blend of myriads of vernal hues, Arkady the painter lays out a long, long canvas.Arkady has a sufficiently large amount of paint of three colours: cyan, magenta, and yellow. On the one-dimensional canvas split into n consecutive segments, each segment needs to be painted in one of the colours.Arkady has already painted some (possibly none or all) segments and passes the paintbrush to you. You are to determine whether there are at least two ways of colouring all the unpainted segments so that no two adjacent segments are of the same colour. Two ways are considered different if and only if a segment is painted in different colours in them." 1300
955F Heaps dp,trees "You\'re given a tree with n vertices rooted at 1.We say that there\'s a k-ary heap of depth m located at u if the following holds:  For m\xe2\x80\x89=\xe2\x80\x891 u itself is a k-ary heap of depth 1.  For m\xe2\x80\x89>\xe2\x80\x891 vertex u is a k-ary heap of depth m if at least k of its children are k-ary heaps of depth at least m\xe2\x80\x89-\xe2\x80\x891. Denote dpk(u) as maximum depth of k-ary heap in the subtree of u (including u). Your goal is to compute ." 2600
955E Icicles NA "Andrew\'s favourite Krakozyabra has recenly fled away and now he\'s eager to bring it back!At the moment the refugee is inside an icy cave with n icicles dangling from the ceiling located in integer coordinates numbered from 1 to n. The distance between floor and the i-th icicle is equal to ai.Andrew is free to choose an arbitrary integer point T in range from 1 to n inclusive and at time instant 0 launch a sound wave spreading into both sides (left and right) at the speed of one point per second. Any icicle touched by the wave starts falling at the same speed (that means that in a second the distance from floor to icicle decreases by one but cannot become less that zero). While distance from icicle to floor is more than zero, it is considered passable; as soon as it becomes zero, the icicle blocks the path and prohibits passing.Krakozyabra is initially (i.e. at time instant 0) is located at point  and starts running in the right direction at the speed of one point per second. You can assume that events in a single second happen in the following order: first Krakozyabra changes its position, and only then the sound spreads and icicles fall; in particular, that means that if Krakozyabra is currently at point  and the falling (i.e. already touched by the sound wave) icicle at point i is 1 point from the floor, then Krakozyabra will pass it and find itself at  and only after that the icicle will finally fall and block the path.Krakozyabra is considered entrapped if there are fallen (i.e. with ai\xe2\x80\x89=\xe2\x80\x890) icicles both to the left and to the right of its current position. Help Andrew find the minimum possible time it takes to entrap Krakozyabra by choosing the optimal value of T or report that this mission is impossible." 2900
955D Scissors "brute force,strings" "Jenya has recently acquired quite a useful tool \xe2\x80\x94 k-scissors for cutting strings. They are generally used for cutting out two non-intersecting substrings of length k from an arbitrary string s (its length should be at least 2\xc2\xb7k in order to perform this operation) and concatenating them afterwards (preserving the initial order). For example, with the help of 2-scissors you can cut ab and de out of abcde and concatenate them into abde, but not ab and bc since they\'re intersecting.It\'s a nice idea to test this tool before using it in practice. After looking through the papers, Jenya came up with two strings s and t. His question is whether it is possible to apply his scissors to string s such that the resulting concatenation contains t as a substring?" 2600
955C "Sad powers" "binary search,math,number theory" "You\'re given Q queries of the form (L,\xe2\x80\x89R). For each query you have to find the number of such x that L\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89R and there exist integer numbers a\xe2\x80\x89>\xe2\x80\x890, p\xe2\x80\x89>\xe2\x80\x891 such that x\xe2\x80\x89=\xe2\x80\x89ap." 2100
955B "Not simply beatiful strings" implementation "Let\'s call a string adorable if its letters can be realigned in such a way that they form two consequent groups of equal symbols (note that different groups must contain different symbols). For example, ababa is adorable (you can transform it to aaabb, where the first three letters form a group of a-s and others \xe2\x80\x94 a group of b-s), but cccc is not since in each possible consequent partition letters in these two groups coincide.You\'re given a string s. Check whether it can be split into two non-empty subsequences such that the strings formed by these subsequences are adorable. Here a subsequence is an arbitrary set of indexes of the string." 1400
955A "Feed the cat" greedy,math "After waking up at hh:mm, Andrew realised that he had forgotten to feed his only cat for yet another time (guess why there\'s only one cat). The cat\'s current hunger level is H points, moreover each minute without food increases his hunger by D points.At any time Andrew can visit the store where tasty buns are sold (you can assume that is doesn\'t take time to get to the store and back). One such bun costs C roubles and decreases hunger by N points. Since the demand for bakery drops heavily in the evening, there is a special 20% discount for buns starting from 20:00 (note that the cost might become rational). Of course, buns cannot be sold by parts.Determine the minimum amount of money Andrew has to spend in order to feed his cat. The cat is considered fed if its hunger level is less than or equal to zero." 1100
954I "Yet Another String Matching Problem" fft,math "Suppose you have two strings s and t, and their length is equal. You may perform the following operation any number of times: choose two different characters c1 and c2, and replace every occurence of c1 in both strings with c2. Let\'s denote the distance between strings s and t as the minimum number of operations required to make these strings equal. For example, if s is abcd and t is ddcb, the distance between them is 2 \xe2\x80\x94 we may replace every occurence of a with b, so s becomes bbcd, and then we may replace every occurence of b with d, so both strings become ddcd.You are given two strings S and T. For every substring of S consisting of |T| characters you have to determine the distance between this substring and T." 2200
954H "Path Counting" combinatorics,dp "You are given a rooted tree. Let\'s denote d(x) as depth of node x: depth of the root is 1, depth of any other node x is d(y)\xe2\x80\x89+\xe2\x80\x891, where y is a parent of x.The tree has the following property: every node x with d(x)\xe2\x80\x89=\xe2\x80\x89i has exactly ai children. Maximum possible depth of a node is n, and an\xe2\x80\x89=\xe2\x80\x890.We define fk as the number of unordered pairs of vertices in the tree such that the number of edges on the simple path between them is equal to k.Calculate fk modulo 109\xe2\x80\x89+\xe2\x80\x897 for every 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x892n\xe2\x80\x89-\xe2\x80\x892." 2500
954G "Castle Defense" "binary search,data structures,greedy,two pointers" "Today you are going to lead a group of elven archers to defend the castle that is attacked by an army of angry orcs. Three sides of the castle are protected by impassable mountains and the remaining side is occupied by a long wall that is split into n sections. At this moment there are exactly ai archers located at the i-th section of this wall. You know that archer who stands at section i can shoot orcs that attack section located at distance not exceeding r, that is all such sections j that |i\xe2\x80\x89-\xe2\x80\x89j|\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r. In particular, r\xe2\x80\x89=\xe2\x80\x890 means that archers are only capable of shooting at orcs who attack section i.Denote as defense level of section i the total number of archers who can shoot at the orcs attacking this section. Reliability of the defense plan is the minimum value of defense level of individual wall section.There is a little time left till the attack so you can\'t redistribute archers that are already located at the wall. However, there is a reserve of k archers that you can distribute among wall sections in arbitrary way. You would like to achieve maximum possible reliability of the defence plan." 2000
954F "Runner\'s Problem" dp,matrices,sortings "You are running through a rectangular field. This field can be represented as a matrix with 3 rows and m columns. (i,\xe2\x80\x89j) denotes a cell belonging to i-th row and j-th column.You start in (2,\xe2\x80\x891) and have to end your path in (2,\xe2\x80\x89m). From the cell (i,\xe2\x80\x89j) you may advance to:  (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 only if i\xe2\x80\x89>\xe2\x80\x891,  (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891), or  (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 only if i\xe2\x80\x89<\xe2\x80\x893. However, there are n obstacles blocking your path. k-th obstacle is denoted by three integers ak, lk and rk, and it forbids entering any cell (ak,\xe2\x80\x89j) such that lk\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89rk.You have to calculate the number of different paths from (2,\xe2\x80\x891) to (2,\xe2\x80\x89m), and print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2100
954E "Water Taps" "binary search,greedy,sortings" "Consider a system of n water taps all pouring water into the same container. The i-th water tap can be set to deliver any amount of water from 0 to ai ml per second (this amount may be a real number). The water delivered by i-th tap has temperature ti.If for every  you set i-th tap to deliver exactly xi ml of water per second, then the resulting temperature of water will be  (if , then to avoid division by zero we state that the resulting water temperature is 0).You have to set all the water taps in such a way that the resulting temperature is exactly T. What is the maximum amount of water you may get per second if its temperature has to be T?" 2000
954D "Fight Against Traffic" "dfs and similar,graphs,shortest paths" "Little town Nsk consists of n junctions connected by m bidirectional roads. Each road connects two distinct junctions and no two roads connect the same pair of junctions. It is possible to get from any junction to any other junction by these roads. The distance between two junctions is equal to the minimum possible number of roads on a path between them.In order to improve the transportation system, the city council asks mayor to build one new road. The problem is that the mayor has just bought a wonderful new car and he really enjoys a ride from his home, located near junction s to work located near junction t. Thus, he wants to build a new road in such a way that the distance between these two junctions won\'t decrease. You are assigned a task to compute the number of pairs of junctions that are not connected by the road, such that if the new road between these two junctions is built the distance between s and t won\'t decrease." 1600
954C "Matrix Walk" implementation "There is a matrix A of size x\xe2\x80\x89\xc3\x97\xe2\x80\x89y filled with integers. For every ,  Ai,\xe2\x80\x89j\xe2\x80\x89=\xe2\x80\x89y(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89j. Obviously, every integer from [1..xy] occurs exactly once in this matrix. You have traversed some path in this matrix. Your path can be described as a sequence of visited cells a1, a2, ..., an denoting that you started in the cell containing the number a1, then moved to the cell with the number a2, and so on.From the cell located in i-th line and j-th column (we denote this cell as (i,\xe2\x80\x89j)) you can move into one of the following cells: (i\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89j) \xe2\x80\x94 only if i\xe2\x80\x89<\xe2\x80\x89x;  (i,\xe2\x80\x89j\xe2\x80\x89+\xe2\x80\x891) \xe2\x80\x94 only if j\xe2\x80\x89<\xe2\x80\x89y;  (i\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89j) \xe2\x80\x94 only if i\xe2\x80\x89>\xe2\x80\x891;  (i,\xe2\x80\x89j\xe2\x80\x89-\xe2\x80\x891) \xe2\x80\x94 only if j\xe2\x80\x89>\xe2\x80\x891.Notice that making a move requires you to go to an adjacent cell. It is not allowed to stay in the same cell. You don\'t know x and y exactly, but you have to find any possible values for these numbers such that you could start in the cell containing the integer a1, then move to the cell containing a2 (in one step), then move to the cell containing a3 (also in one step) and so on. Can you choose x and y so that they don\'t contradict with your sequence of moves?" 1700
954B "String Typing" implementation,strings "You are given a string s consisting of n lowercase Latin letters. You have to type this string using your keyboard.Initially, you have an empty string. Until you type the whole string, you may perform the following operation:  add a character to the end of the string. Besides, at most once you may perform one additional operation: copy the string and append it to itself.For example, if you have to type string abcabca, you can type it in 7 operations if you type all the characters one by one. However, you can type it in 5 operations if you type the string abc first and then copy it and type the last character.If you have to type string aaaaaaaaa, the best option is to type 4 characters one by one, then copy the string, and then type the remaining character.Print the minimum number of operations you need to type the given string." 1400
954A "Diagonal Walking" implementation "Mikhail walks on a 2D plane. He can go either up or right. You are given a sequence of Mikhail\'s moves. He thinks that this sequence is too long and he wants to make it as short as possible.In the given sequence moving up is described by character U and moving right is described by character R. Mikhail can replace any pair of consecutive moves RU or UR with a diagonal move (described as character D). After that, he can go on and do some other replacements, until there is no pair of consecutive moves RU or UR left.Your problem is to print the minimum possible length of the sequence of moves after the replacements." 800
952G "Puzzling Language" "constructive algorithms" "In this problem you will write a simple code generator for a 2D programming language derived from Brainfuck.The code in this language is a rectangular grid of characters \'.\' and \'X\'. The code is converted to a Brainfuck program as follows: the characters are read in the usual order (top to bottom, left to right), and each \'X\' character is converted a Brainfuck instruction to be executed. The instruction is defined by the left, top and right neighbors of the \'X\' character using the following conversion table:  You are given a string. Output a program in the described language which prints this string.You can download the language interpreter used for judging here: https://assets.codeforces.com/rounds/952/puzzling-interpreter.cpp (use C++11 to compile the code). Note several implementation details: The first step of the language interpretation is conversion to a Brainfuck program, which is then executed. The code must be rectangular, with all lines of the same length. It can have at most 10,000 lines and 10,000 columns, and can have at most 500,000 \'X\' characters. The code has toroidal topology, i.e. the \'X\' on the first line will have top neighbor in the last line. Brainfuck interpreter has 30000 memory cells which store integers from 0 to 255 with increment/decrement done modulo 256. Console input (, command) is allowed in Brainfuck code but has no effect when executed." 2200
952F "2 + 2 != 4" NA "One very experienced problem writer decided to prepare a problem for April Fools Day contest. The task was very simple - given an arithmetic expression, return the result of evaluating this expression. However, looks like there is a bug in the reference solution..." 2400
952E "Cheese Board" NA "Not to be confused with chessboard." 2000
952D "I\'m Feeling Lucky!" probabilities "You have one chip and one chance to play roulette. Are you feeling lucky?" 1800
952C "Ravioli Sort" implementation "Everybody knows of spaghetti sort. You decided to implement an analog sorting algorithm yourself, but as you survey your pantry you realize you\'re out of spaghetti! The only type of pasta you have is ravioli, but you are not going to let this stop you...You come up with the following algorithm. For each number in the array ai, build a stack of ai ravioli. The image shows the stack for ai\xe2\x80\x89=\xe2\x80\x894.  Arrange the stacks in one row in the order in which the corresponding numbers appear in the input array. Find the tallest one (if there are several stacks of maximal height, use the leftmost one). Remove it and add its height to the end of the output array. Shift the stacks in the row so that there is no gap between them. Repeat the procedure until all stacks have been removed.At first you are very happy with your algorithm, but as you try it on more inputs you realize that it doesn\'t always produce the right sorted array. Turns out when two stacks of ravioli are next to each other (at any step of the process) and differ in height by two or more, the top ravioli of the taller stack slides down on top of the lower stack.Given an input array, figure out whether the described algorithm will sort it correctly." 1600
952B "A Map of the Cat" "brute force,interactive" "If you have ever interacted with a cat, you have probably noticed that they are quite particular about how to pet them. Here is an approximate map of a normal cat.  However, some cats won\'t tolerate this nonsense from the humans. Here is a map of a grumpy cat.  You have met a cat. Can you figure out whether it\'s normal or grumpy?" 1900
952A "Quirky Quantifiers" math "InputThe input contains a single integer a (10\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89999).OutputOutput 0 or 1.ExamplesInputCopy13OutputCopy1InputCopy927OutputCopy1InputCopy48OutputCopy0" 800
950B "Intercepted Message" greedy,implementation "Hacker Zhorik wants to decipher two secret messages he intercepted yesterday. Yeah message is a sequence of encrypted blocks, each of them consists of several bytes of information.Zhorik knows that each of the messages is an archive containing one or more files. Zhorik knows how each of these archives was transferred through the network: if an archive consists of k files of sizes l1,\xe2\x80\x89l2,\xe2\x80\x89...,\xe2\x80\x89lk bytes, then the i-th file is split to one or more blocks bi,\xe2\x80\x891,\xe2\x80\x89bi,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89bi,\xe2\x80\x89mi (here the total length of the blocks bi,\xe2\x80\x891\xe2\x80\x89+\xe2\x80\x89bi,\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89bi,\xe2\x80\x89mi is equal to the length of the file li), and after that all blocks are transferred through the network, maintaining the order of files in the archive.Zhorik thinks that the two messages contain the same archive, because their total lengths are equal. However, each file can be split in blocks in different ways in the two messages.You are given the lengths of blocks in each of the two messages. Help Zhorik to determine what is the maximum number of files could be in the archive, if the Zhorik\'s assumption is correct." 1100
950A "Left-handers, Right-handers and Ambidexters" implementation,math "You are at a water bowling training. There are l people who play with their left hand, r people, who play with their right hand, and a ambidexters, who can play with left or right hand.The coach decided to form a team of even number of players, exactly half of the players should play with their right hand, and exactly half of the players should play with their left hand. One player should use only on of his hands.Ambidexters play as well with their right hand as with their left hand. In the team, an ambidexter can play with their left hand, or with their right hand.Please find the maximum possible size of the team, where equal number of players use their left and right hands, respectively." 800
949E "Binary Cards" "brute force" "It is never too late to play the fancy ""Binary Cards"" game!There is an infinite amount of cards of positive and negative ranks that are used in the game. The absolute value of any card rank is a power of two, i.e. each card has a rank of either 2k or \xe2\x80\x89-\xe2\x80\x892k for some integer k\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x890. There is an infinite amount of cards of any valid rank.At the beginning of the game player forms his deck that is some multiset (possibly empty) of cards. It is allowed to pick any number of cards of any rank but the small deck is considered to be a skill indicator. Game consists of n rounds. In the i-th round jury tells the player an integer ai. After that the player is obligated to draw such a subset of his deck that the sum of ranks of the chosen cards is equal to ai (it is allowed to not draw any cards, in which case the sum is considered to be equal to zero). If player fails to do so, he loses and the game is over. Otherwise, player takes back all of his cards into his deck and the game proceeds to the next round. Player is considered a winner if he is able to draw the suitable set of cards in each of the rounds.Somebody told you which numbers ai the jury is going to tell you in each round. Now you want to pick a deck consisting of the minimum number of cards that allows you to win the ""Binary Cards"" game." 2700
949D Curfew "binary search,brute force,greedy,sortings" "Instructors of Some Informatics School make students go to bed.The house contains n rooms, in each room exactly b students were supposed to sleep. However, at the time of curfew it happened that many students are not located in their assigned rooms. The rooms are arranged in a row and numbered from 1 to n. Initially, in i-th room there are ai students. All students are currently somewhere in the house, therefore a1\xe2\x80\x89+\xe2\x80\x89a2\xe2\x80\x89+\xe2\x80\x89...\xe2\x80\x89+\xe2\x80\x89an\xe2\x80\x89=\xe2\x80\x89nb. Also 2 instructors live in this house.The process of curfew enforcement is the following. One instructor starts near room 1 and moves toward room n, while the second instructor starts near room n and moves toward room 1. After processing current room, each instructor moves on to the next one. Both instructors enter rooms and move simultaneously, if n is odd, then only the first instructor processes the middle room. When all rooms are processed, the process ends.When an instructor processes a room, she counts the number of students in the room, then turns off the light, and locks the room. Also, if the number of students inside the processed room is not equal to b, the instructor writes down the number of this room into her notebook (and turns off the light, and locks the room). Instructors are in a hurry (to prepare the study plan for the next day), so they don\'t care about who is in the room, but only about the number of students.While instructors are inside the rooms, students can run between rooms that are not locked and not being processed. A student can run by at most d rooms, that is she can move to a room with number that differs my at most d. Also, after (or instead of) running each student can hide under a bed in a room she is in. In this case the instructor will not count her during the processing. In each room any number of students can hide simultaneously.Formally, here is what\'s happening:  A curfew is announced, at this point in room i there are ai students.  Each student can run to another room but not further than d rooms away from her initial room, or stay in place. After that each student can optionally hide under a bed.  Instructors enter room 1 and room n, they count students there and lock the room (after it no one can enter or leave this room).  Each student from rooms with numbers from 2 to n\xe2\x80\x89-\xe2\x80\x891 can run to another room but not further than d rooms away from her current room, or stay in place. Each student can optionally hide under a bed.  Instructors move from room 1 to room 2 and from room n to room n\xe2\x80\x89-\xe2\x80\x891.  This process continues until all rooms are processed. Let x1 denote the number of rooms in which the first instructor counted the number of non-hidden students different from b, and x2 be the same number for the second instructor. Students know that the principal will only listen to one complaint, therefore they want to minimize the maximum of numbers xi. Help them find this value if they use the optimal strategy." 2300
949C "Data Center Maintenance" "dfs and similar,graphs" "BigData Inc. is a corporation that has n data centers indexed from 1 to n that are located all over the world. These data centers provide storage for client data (you can figure out that client data is really big!).Main feature of services offered by BigData Inc. is the access availability guarantee even under the circumstances of any data center having an outage. Such a guarantee is ensured by using the two-way replication. Two-way replication is such an approach for data storage that any piece of data is represented by two identical copies that are stored in two different data centers.For each of m company clients, let us denote indices of two different data centers storing this client data as ci,\xe2\x80\x891 and ci,\xe2\x80\x892.In order to keep data centers operational and safe, the software running on data center computers is being updated regularly. Release cycle of BigData Inc. is one day meaning that the new version of software is being deployed to the data center computers each day.Data center software update is a non-trivial long process, that is why there is a special hour-long time frame that is dedicated for data center maintenance. During the maintenance period, data center computers are installing software updates, and thus they may be unavailable. Consider the day to be exactly h hours long. For each data center there is an integer uj (0\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89uj\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89h\xe2\x80\x89-\xe2\x80\x891) defining the index of an hour of day, such that during this hour data center j is unavailable due to maintenance.Summing up everything above, the condition uci,\xe2\x80\x891\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89uci,\xe2\x80\x892 should hold for each client, or otherwise his data may be unaccessible while data centers that store it are under maintenance.Due to occasional timezone change in different cities all over the world, the maintenance time in some of the data centers may change by one hour sometimes. Company should be prepared for such situation, that is why they decided to conduct an experiment, choosing some non-empty subset of data centers, and shifting the maintenance time for them by an hour later (i.e. if uj\xe2\x80\x89=\xe2\x80\x89h\xe2\x80\x89-\xe2\x80\x891, then the new maintenance hour would become 0, otherwise it would become uj\xe2\x80\x89+\xe2\x80\x891). Nonetheless, such an experiment should not break the accessibility guarantees, meaning that data of any client should be still available during any hour of a day after the data center maintenance times are changed.Such an experiment would provide useful insights, but changing update time is quite an expensive procedure, that is why the company asked you to find out the minimum number of data centers that have to be included in an experiment in order to keep the data accessibility guarantees." 1900
949B "A Leapfrog in the Array" "constructive algorithms,math" "Dima is a beginner programmer. During his working process, he regularly has to repeat the following operation again and again: to remove every second element from the array. One day he has been bored with easy solutions of this problem, and he has come up with the following extravagant algorithm.Let\'s consider that initially array contains n numbers from 1 to n and the number i is located in the cell with the index 2i\xe2\x80\x89-\xe2\x80\x891 (Indices are numbered starting from one) and other cells of the array are empty. Each step Dima selects a non-empty array cell with the maximum index and moves the number written in it to the nearest empty cell to the left of the selected one. The process continues until all n numbers will appear in the first n cells of the array. For example if n\xe2\x80\x89=\xe2\x80\x894, the array is changing as follows:  You have to write a program that allows you to determine what number will be in the cell with index x (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89x\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n) after Dima\'s algorithm finishes." 1700
949A Zebras greedy "Oleg writes down the history of the days he lived. For each day he decides if it was good or bad. Oleg calls a non-empty sequence of days a zebra, if it starts with a bad day, ends with a bad day, and good and bad days are alternating in it. Let us denote bad days as 0 and good days as 1. Then, for example, sequences of days 0, 010, 01010 are zebras, while sequences 1, 0110, 0101 are not.Oleg tells you the story of days he lived in chronological order in form of string consisting of 0 and 1. Now you are interested if it is possible to divide Oleg\'s life history into several subsequences, each of which is a zebra, and the way it can be done. Each day must belong to exactly one of the subsequences. For each of the subsequences, days forming it must be ordered chronologically. Note that subsequence does not have to be a group of consecutive days." 1600
948A "Protect Sheep" "brute force,dfs and similar,graphs,implementation" "Bob is a farmer. He has a large pasture with many sheep. Recently, he has lost some of them due to wolf attacks. He thus decided to place some shepherd dogs in such a way that all his sheep are protected.The pasture is a rectangle consisting of R\xe2\x80\x89\xc3\x97\xe2\x80\x89C cells. Each cell is either empty, contains a sheep, a wolf or a dog. Sheep and dogs always stay in place, but wolves can roam freely around the pasture, by repeatedly moving to the left, right, up or down to a neighboring cell. When a wolf enters a cell with a sheep, it consumes it. However, no wolf can enter a cell with a dog.Initially there are no dogs. Place dogs onto the pasture in such a way that no wolf can reach any sheep, or determine that it is impossible. Note that since you have many dogs, you do not need to minimize their number." 900
946G "Almost Increasing Array" "data structures,dp" "We call an array almost increasing if we can erase not more than one element from it so that the array becomes strictly increasing (that is, every element is striclty greater than every element before it).You are given an array a consisting of n elements. You are allowed to replace any element with any integer number (and you may do so any number of times you need). What is the minimum number of replacements you have to perform in order to make the array almost increasing?" 2500
946F "Fibonacci String Subsequences" combinatorics,dp,matrices "You are given a binary string s (each character of this string is either 0 or 1).Let\'s denote the cost of string t as the number of occurences of s in t. For example, if s is 11 and t is 111011, then the cost of t is 3.Let\'s also denote the Fibonacci strings sequence as follows: F(0) is 0; F(1) is 1; F(i)\xe2\x80\x89=\xe2\x80\x89F(i\xe2\x80\x89-\xe2\x80\x891)\xe2\x80\x89+\xe2\x80\x89F(i\xe2\x80\x89-\xe2\x80\x892) if i\xe2\x80\x89>\xe2\x80\x891, where \xe2\x80\x89+\xe2\x80\x89 means the concatenation of two strings.Your task is to calculate the sum of costs of all subsequences of the string F(x). Since answer may be large, calculate it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2400
946E "Largest Beautiful Number" greedy,implementation "Yes, that\'s another problem with definition of ""beautiful"" numbers.Let\'s call a positive integer x beautiful if its decimal representation without leading zeroes contains even number of digits, and there exists a permutation of this representation which is palindromic. For example, 4242 is a beautiful number, since it contains 4 digits, and there exists a palindromic permutation 2442.Given a positive integer s, find the largest beautiful number which is less than s." 2200
946D Timetable dp "Ivan is a student at Berland State University (BSU). There are n days in Berland week, and each of these days Ivan might have some classes at the university.There are m working hours during each Berland day, and each lesson at the university lasts exactly one hour. If at some day Ivan\'s first lesson is during i-th hour, and last lesson is during j-th hour, then he spends j\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891 hours in the university during this day. If there are no lessons during some day, then Ivan stays at home and therefore spends 0 hours in the university.Ivan doesn\'t like to spend a lot of time in the university, so he has decided to skip some lessons. He cannot skip more than k lessons during the week. After deciding which lessons he should skip and which he should attend, every day Ivan will enter the university right before the start of the first lesson he does not skip, and leave it after the end of the last lesson he decides to attend. If Ivan skips all lessons during some day, he doesn\'t go to the university that day at all.Given n, m, k and Ivan\'s timetable, can you determine the minimum number of hours he has to spend in the university during one week, if he cannot skip more than k lessons?" 1800
946C "String Transformation" greedy,strings "You are given a string s consisting of |s| small english letters.In one move you can replace any character of this string to the next character in alphabetical order (a will be replaced with b, s will be replaced with t, etc.). You cannot replace letter z with any other letter.Your target is to make some number of moves (not necessary minimal) to get string abcdefghijklmnopqrstuvwxyz (english alphabet) as a subsequence. Subsequence of the string is the string that is obtained by deleting characters at some positions. You need to print the string that will be obtained from the given string and will be contain english alphabet as a subsequence or say that it is impossible." 1300
946B "Weird Subtraction Process" "math,number theory" "You have two variables a and b. Consider the following sequence of actions performed with these variables: If a\xe2\x80\x89=\xe2\x80\x890 or b\xe2\x80\x89=\xe2\x80\x890, end the process. Otherwise, go to step 2; If a\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892\xc2\xb7b, then set the value of a to a\xe2\x80\x89-\xe2\x80\x892\xc2\xb7b, and repeat step 1. Otherwise, go to step 3; If b\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x892\xc2\xb7a, then set the value of b to b\xe2\x80\x89-\xe2\x80\x892\xc2\xb7a, and repeat step 1. Otherwise, end the process.Initially the values of a and b are positive integers, and so the process will be finite.You have to determine the values of a and b after the process ends." 1100
946A Partition greedy "You are given a sequence a consisting of n integers. You may partition this sequence into two sequences b and c in such a way that every element belongs exactly to one of these sequences. Let B be the sum of elements belonging to b, and C be the sum of elements belonging to c (if some of these sequences is empty, then its sum is 0). What is the maximum possible value of B\xe2\x80\x89-\xe2\x80\x89C?" 800
940F "Machine Learning" "brute force,data structures" "You come home and fell some unpleasant smell. Where is it coming from?You are given an array a. You have to answer the following queries:   You are given two integers l and r. Let ci be the number of occurrences of i in al:\xe2\x80\x89r, where al:\xe2\x80\x89r is the subarray of a from l-th element to r-th inclusive. Find the Mex of {c0,\xe2\x80\x89c1,\xe2\x80\x89...,\xe2\x80\x89c109}  You are given two integers p to x. Change ap to x. The Mex of a multiset of numbers is the smallest non-negative integer not in the set.Note that in this problem all elements of a are positive, which means that c0 = 0 and 0 is never the answer for the query of the second type." 2600
940E Cashback "data structures,dp,greedy,math" "Since you are the best Wraith King, Nizhniy Magazin \xc2\xabMir\xc2\xbb at the centre of Vinnytsia is offering you a discount.You are given an array a of length n and an integer c. The value of some array b of length k is the sum of its elements except for the  smallest. For example, the value of the array [3,\xe2\x80\x891,\xe2\x80\x896,\xe2\x80\x895,\xe2\x80\x892] with c\xe2\x80\x89=\xe2\x80\x892 is 3\xe2\x80\x89+\xe2\x80\x896\xe2\x80\x89+\xe2\x80\x895\xe2\x80\x89=\xe2\x80\x8914.Among all possible partitions of a into contiguous subarrays output the smallest possible sum of the values of these subarrays." 2000
940D "Alena And The Heater" "binary search,implementation" """We\'ve tried solitary confinement, waterboarding and listening to Just In Beaver, to no avail. We need something extreme.""""Little Alena got an array as a birthday present...""The array b of length n is obtained from the array a of length n and two integers l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r) using the following procedure:b1\xe2\x80\x89=\xe2\x80\x89b2\xe2\x80\x89=\xe2\x80\x89b3\xe2\x80\x89=\xe2\x80\x89b4\xe2\x80\x89=\xe2\x80\x890.For all 5\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n:   bi\xe2\x80\x89=\xe2\x80\x890 if ai,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x893,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89>\xe2\x80\x89r and bi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89=\xe2\x80\x891  bi\xe2\x80\x89=\xe2\x80\x891 if ai,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x891,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x892,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x893,\xe2\x80\x89ai\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89<\xe2\x80\x89l and bi\xe2\x80\x89-\xe2\x80\x891\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x892\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x894\xe2\x80\x89=\xe2\x80\x890  bi\xe2\x80\x89=\xe2\x80\x89bi\xe2\x80\x89-\xe2\x80\x891 otherwise You are given arrays a and b\' of the same length. Find two integers l and r (l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r), such that applying the algorithm described above will yield an array b equal to b\'.It\'s guaranteed that the answer exists." 1600
940C "Phone Numbers" "constructive algorithms,implementation,strings" "And where the are the phone numbers?You are given a string s consisting of lowercase English letters and an integer k. Find the lexicographically smallest string t of length k, such that its set of letters is a subset of the set of letters of s and s is lexicographically smaller than t.It\'s guaranteed that the answer exists.Note that the set of letters is a set, not a multiset. For example, the set of letters of abadaba is {a,\xe2\x80\x89b,\xe2\x80\x89d}.String p is lexicographically smaller than string q, if p is a prefix of q, is not equal to q or there exists i, such that pi\xe2\x80\x89<\xe2\x80\x89qi and for all j\xe2\x80\x89<\xe2\x80\x89i it is satisfied that pj\xe2\x80\x89=\xe2\x80\x89qj. For example, abc is lexicographically smaller than abcd , abd is lexicographically smaller than abec, afa is not lexicographically smaller than ab and a is not lexicographically smaller than a." 1500
940B "Our Tanya is Crying Out Loud" dp,greedy "Right now she actually isn\'t. But she will be, if you don\'t solve this problem.You are given integers n, k, A and B. There is a number x, which is initially equal to n. You are allowed to perform two types of operations:   Subtract 1 from x. This operation costs you A coins.  Divide x by k. Can be performed only if x is divisible by k. This operation costs you B coins.  What is the minimum amount of coins you have to pay to make x equal to 1?" 1400
940A "Points on the line" "brute force,greedy,sortings" "We\'ve got no test cases. A big olympiad is coming up. But the problemsetters\' number one priority should be adding another problem to the round. The diameter of a multiset of points on the line is the largest distance between two points from this set. For example, the diameter of the multiset {1,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x891} is 2.Diameter of multiset consisting of one point is 0.You are given n points on the line. What is the minimum number of points you have to remove, so that the diameter of the multiset of the remaining points will not exceed d?" 1200
939F Cutlet "data structures,dp" "Arkady wants to have a dinner. He has just returned from a shop where he has bought a semifinished cutlet. He only needs to fry it. The cutlet should be fried for 2n seconds, in particular, it should be fried for n seconds on one side and n seconds on the other side. Arkady has already got a frying pan and turn on fire, but understood that maybe he won\'t be able to flip the cutlet exactly after n seconds after the beginning of cooking.Arkady is too busy with sorting sticker packs in his favorite messenger and can flip the cutlet only in some periods of time. Namely, there are k periods of time in which he can do it, the i-th of them is an interval of time from li seconds after he starts cooking till ri seconds, inclusive. Arkady decided that it\'s not required to flip the cutlet exactly in the middle of cooking, instead, he will flip it several times in such a way that the cutlet will be fried exactly n seconds on one side and n seconds on the other side in total.Help Arkady and find out if it\'s possible for him to cook the cutlet, if he is able to flip the cutlet only in given periods of time; and if yes, find the minimum number of flips he needs to cook the cutlet." 2400
939E Maximize! "binary search,greedy,ternary search,two pointers" "You are given a multiset S consisting of positive integers (initially empty). There are two kind of queries:   Add a positive integer to S, the newly added integer is not less than any number in it.  Find a subset s of the set S such that the value  is maximum possible. Here max(s) means maximum value of elements in s,  \xe2\x80\x94 the average value of numbers in s. Output this maximum possible value of ." 1800
939D "Love Rescue" "dfs and similar,dsu,graphs,greedy,strings" "Valya and Tolya are an ideal pair, but they quarrel sometimes. Recently, Valya took offense at her boyfriend because he came to her in t-shirt with lettering that differs from lettering on her pullover. Now she doesn\'t want to see him and Tolya is seating at his room and crying at her photos all day long.This story could be very sad but fairy godmother (Tolya\'s grandmother) decided to help them and restore their relationship. She secretly took Tolya\'s t-shirt and Valya\'s pullover and wants to make the letterings on them same. In order to do this, for one unit of mana she can buy a spell that can change some letters on the clothes. Your task is calculate the minimum amount of mana that Tolya\'s grandmother should spend to rescue love of Tolya and Valya.More formally, letterings on Tolya\'s t-shirt and Valya\'s pullover are two strings with same length n consisting only of lowercase English letters. Using one unit of mana, grandmother can buy a spell of form (c1,\xe2\x80\x89c2) (where c1 and c2 are some lowercase English letters), which can arbitrary number of times transform a single letter c1 to c2 and vise-versa on both Tolya\'s t-shirt and Valya\'s pullover. You should find the minimum amount of mana that grandmother should spend to buy a set of spells that can make the letterings equal. In addition you should output the required set of spells." 1600
939C "Convenient For Everybody" "binary search,two pointers" "In distant future on Earth day lasts for n hours and that\'s why there are n timezones. Local times in adjacent timezones differ by one hour. For describing local time, hours numbers from 1 to n are used, i.e. there is no time ""0 hours"", instead of it ""n hours"" is used. When local time in the 1-st timezone is 1 hour, local time in the i-th timezone is i hours.Some online programming contests platform wants to conduct a contest that lasts for an hour in such a way that its beginning coincides with beginning of some hour (in all time zones). The platform knows, that there are ai people from i-th timezone who want to participate in the contest. Each person will participate if and only if the contest starts no earlier than s hours 00 minutes local time and ends not later than f hours 00 minutes local time. Values s and f are equal for all time zones. If the contest starts at f hours 00 minutes local time, the person won\'t participate in it.Help platform select such an hour, that the number of people who will participate in the contest is maximum." 1600
939B "Hamster Farm" implementation "Dima has a hamsters farm. Soon N hamsters will grow up on it and Dima will sell them in a city nearby.Hamsters should be transported in boxes. If some box is not completely full, the hamsters in it are bored, that\'s why each box should be completely full with hamsters.Dima can buy boxes at a factory. The factory produces boxes of K kinds, boxes of the i-th kind can contain in themselves ai hamsters. Dima can buy any amount of boxes, but he should buy boxes of only one kind to get a wholesale discount.Of course, Dima would buy boxes in such a way that each box can be completely filled with hamsters and transported to the city. If there is no place for some hamsters, Dima will leave them on the farm.Find out how many boxes and of which type should Dima buy to transport maximum number of hamsters." 1000
939A "Love Triangle" graphs "As you could know there are no male planes nor female planes. However, each plane on Earth likes some other plane. There are n planes on Earth, numbered from 1 to n, and the plane with number i likes the plane with number fi, where 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89fi\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n and fi\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i.We call a love triangle a situation in which plane A likes plane B, plane B likes plane C and plane C likes plane A. Find out if there is any love triangle on Earth." 800
938G "Shortest Path Queries" "bitmasks,data structures,dsu,graphs" "You are given an undirected connected graph with weighted edges. The length of some path between two vertices is the bitwise xor of weights of all edges belonging to this path (if some edge is traversed more than once, then it is included in bitwise xor the same number of times). There are three types of queries you have to process:  1 x y d \xe2\x80\x94 add an edge connecting vertex x to vertex y with weight d. It is guaranteed that there is no edge connecting x to y before this query;  2 x y \xe2\x80\x94 remove an edge connecting vertex x to vertex y. It is guaranteed that there was such edge in the graph, and the graph stays connected after this query;  3 x y \xe2\x80\x94 calculate the length of the shortest path (possibly non-simple) from vertex x to vertex y. Print the answers for all queries of type 3." 2900
938F "Erasing Substrings" bitmasks,dp,greedy "You are given a string s, initially consisting of n lowercase Latin letters. After that, you perform k operations with it, where . During i-th operation you must erase some substring of length exactly 2i\xe2\x80\x89-\xe2\x80\x891 from s.Print the lexicographically minimal string you may obtain after performing k such operations." 2700
938E "Max History" combinatorics,math "You are given an array a of length n. We define fa the following way:  Initially fa\xe2\x80\x89=\xe2\x80\x890, M\xe2\x80\x89=\xe2\x80\x891;  for every 2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n if aM\xe2\x80\x89<\xe2\x80\x89ai then we set fa\xe2\x80\x89=\xe2\x80\x89fa\xe2\x80\x89+\xe2\x80\x89aM and then set M\xe2\x80\x89=\xe2\x80\x89i. Calculate the sum of fa over all n! permutations of the array a modulo 109\xe2\x80\x89+\xe2\x80\x897.Note: two elements are considered different if their indices differ, so for every array a there are exactly n! permutations." 2300
938D "Buy a Ticket" "data structures,graphs,shortest paths" "Musicians of a popular band ""Flayer"" have announced that they are going to ""make their exit"" with a world tour. Of course, they will visit Berland as well.There are n cities in Berland. People can travel between cities using two-directional train routes; there are exactly m routes, i-th route can be used to go from city vi to city ui (and from ui to vi), and it costs wi coins to use this route.Each city will be visited by ""Flayer"", and the cost of the concert ticket in i-th city is ai coins.You have friends in every city of Berland, and they, knowing about your programming skills, asked you to calculate the minimum possible number of coins they have to pay to visit the concert. For every city i you have to compute the minimum number of coins a person from city i has to spend to travel to some city j (or possibly stay in city i), attend a concert there, and return to city i (if j\xe2\x80\x89\xe2\x89\xa0\xe2\x80\x89i).Formally, for every  you have to calculate , where d(i,\xe2\x80\x89j) is the minimum number of coins you have to spend to travel from city i to city j. If there is no way to reach city j from city i, then we consider d(i,\xe2\x80\x89j) to be infinitely large." 2000
938C "Constructing Tests" "binary search,brute force,constructive algorithms" "Let\'s denote a m-free matrix as a binary (that is, consisting of only 1\'s and 0\'s) matrix such that every square submatrix of size m\xe2\x80\x89\xc3\x97\xe2\x80\x89m of this matrix contains at least one zero. Consider the following problem:You are given two integers n and m. You have to construct an m-free square matrix of size n\xe2\x80\x89\xc3\x97\xe2\x80\x89n such that the number of 1\'s in this matrix is maximum possible. Print the maximum possible number of 1\'s in such matrix.You don\'t have to solve this problem. Instead, you have to construct a few tests for it.You will be given t numbers x1, x2, ..., xt. For every , find two integers ni and mi (ni\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89mi) such that the answer for the aforementioned problem is exactly xi if we set n\xe2\x80\x89=\xe2\x80\x89ni and m\xe2\x80\x89=\xe2\x80\x89mi." 1700
938B "Run For Your Prize" "brute force,greedy" "You and your friend are participating in a TV show ""Run For Your Prize"".At the start of the show n prizes are located on a straight line. i-th prize is located at position ai. Positions of all prizes are distinct. You start at position 1, your friend \xe2\x80\x94 at position 106 (and there is no prize in any of these two positions). You have to work as a team and collect all prizes in minimum possible time, in any order.You know that it takes exactly 1 second to move from position x to position x\xe2\x80\x89+\xe2\x80\x891 or x\xe2\x80\x89-\xe2\x80\x891, both for you and your friend. You also have trained enough to instantly pick up any prize, if its position is equal to your current position (and the same is true for your friend). Carrying prizes does not affect your speed (or your friend\'s speed) at all.Now you may discuss your strategy with your friend and decide who will pick up each prize. Remember that every prize must be picked up, either by you or by your friend.What is the minimum number of seconds it will take to pick up all the prizes?" 1100
938A "Word Correction" implementation "Victor tries to write his own text editor, with word correction included. However, the rules of word correction are really strange.Victor thinks that if a word contains two consecutive vowels, then it\'s kinda weird and it needs to be replaced. So the word corrector works in such a way: as long as there are two consecutive vowels in the word, it deletes the first vowel in a word such that there is another vowel right before it. If there are no two consecutive vowels in the word, it is considered to be correct.You are given a word s. Can you predict what will it become after correction?In this problem letters a, e, i, o, u and y are considered to be vowels." 800
937B "Vile Grasshoppers" "brute force,math,number theory" "The weather is fine today and hence it\'s high time to climb the nearby pine and enjoy the landscape.The pine\'s trunk includes several branches, located one above another and numbered from 2 to y. Some of them (more precise, from 2 to p) are occupied by tiny vile grasshoppers which you\'re at war with. These grasshoppers are known for their awesome jumping skills: the grasshopper at branch x can jump to branches .Keeping this in mind, you wisely decided to choose such a branch that none of the grasshoppers could interrupt you. At the same time you wanna settle as high as possible since the view from up there is simply breathtaking.In other words, your goal is to find the highest branch that cannot be reached by any of the grasshoppers or report that it\'s impossible." 1400
937A Olympiad implementation,sortings "The recent All-Berland Olympiad in Informatics featured n participants with each scoring a certain amount of points.As the head of the programming committee, you are to determine the set of participants to be awarded with diplomas with respect to the following criteria:   At least one participant should get a diploma.  None of those with score equal to zero should get awarded.  When someone is awarded, all participants with score not less than his score should also be awarded. Determine the number of ways to choose a subset of participants that will receive the diplomas." 800
936D "World of Tank" dp,greedy "Vitya loves programming and problem solving, but sometimes, to distract himself a little, he plays computer games. Once he found a new interesting game about tanks, and he liked it so much that he went through almost all levels in one day. Remained only the last level, which was too tricky. Then Vitya remembered that he is a programmer, and wrote a program that helped him to pass this difficult level. Try do the same.The game is organized as follows. There is a long road, two cells wide and n cells long. Some cells have obstacles. You control a tank that occupies one cell. Initially, the tank is located before the start of the road, in a cell with coordinates (0,\xe2\x80\x891). Your task is to move the tank to the end of the road, to the cell (n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x891) or (n\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x892).  Every second the tank moves one cell to the right: the coordinate x is increased by one. When you press the up or down arrow keys, the tank instantly changes the lane, that is, the y coordinate. When you press the spacebar, the tank shoots, and the nearest obstacle along the lane in which the tank rides is instantly destroyed. In order to load a gun, the tank needs t seconds. Initially, the gun is not loaded, that means, the first shot can be made only after t seconds after the tank starts to move.If at some point the tank is in the same cell with an obstacle not yet destroyed, it burns out. If you press the arrow exactly at the moment when the tank moves forward, the tank will first move forward, and then change the lane, so it will not be possible to move diagonally.Your task is to find out whether it is possible to pass the level, and if possible, to find the order of actions the player need to make." 3000
936C "Lock Puzzle" "constructive algorithms,implementation,strings" "Welcome to another task about breaking the code lock! Explorers Whitfield and Martin came across an unusual safe, inside of which, according to rumors, there are untold riches, among which one can find the solution of the problem of discrete logarithm!Of course, there is a code lock is installed on the safe. The lock has a screen that displays a string of n lowercase Latin letters. Initially, the screen displays string s. Whitfield and Martin found out that the safe will open when string t will be displayed on the screen.The string on the screen can be changed using the operation \xc2\xabshift x\xc2\xbb. In order to apply this operation, explorers choose an integer x from 0 to n inclusive. After that, the current string p\xe2\x80\x89=\xe2\x80\x89\xce\xb1\xce\xb2 changes to \xce\xb2R\xce\xb1, where the length of \xce\xb2 is x, and the length of \xce\xb1 is n\xe2\x80\x89-\xe2\x80\x89x. In other words, the suffix of the length x of string p is reversed and moved to the beginning of the string. For example, after the operation \xc2\xabshift 4\xc2\xbb the string \xc2\xababcacb\xc2\xbb will be changed with string \xc2\xabbcacab \xc2\xbb, since \xce\xb1\xe2\x80\x89=\xe2\x80\x89ab, \xce\xb2\xe2\x80\x89=\xe2\x80\x89cacb, \xce\xb2R\xe2\x80\x89=\xe2\x80\x89bcac.Explorers are afraid that if they apply too many operations \xc2\xabshift\xc2\xbb, the lock will be locked forever. They ask you to find a way to get the string t on the screen, using no more than 6100 operations." 2300
936B "Sleepy Game" "dfs and similar,dp,games,graphs" "Petya and Vasya arranged a game. The game runs by the following rules. Players have a directed graph consisting of n vertices and m edges. One of the vertices contains a chip. Initially the chip is located at vertex s. Players take turns moving the chip along some edge of the graph. Petya goes first. Player who can\'t move the chip loses. If the game lasts for 106 turns the draw is announced.Vasya was performing big laboratory work in ""Spelling and parts of speech"" at night before the game, so he fell asleep at the very beginning of the game. Petya decided to take the advantage of this situation and make both Petya\'s and Vasya\'s moves.Your task is to help Petya find out if he can win the game or at least draw a tie." 2100
936A "Save Energy!" "binary search,implementation,math" "Julia is going to cook a chicken in the kitchen of her dormitory. To save energy, the stove in the kitchen automatically turns off after k minutes after turning on.During cooking, Julia goes to the kitchen every d minutes and turns on the stove if it is turned off. While the cooker is turned off, it stays warm. The stove switches on and off instantly.It is known that the chicken needs t minutes to be cooked on the stove, if it is turned on, and 2t minutes, if it is turned off. You need to find out, how much time will Julia have to cook the chicken, if it is considered that the chicken is cooked evenly, with constant speed when the stove is turned on and at a constant speed when it is turned off." 1700
935F "Fafa and Array" "data structures,greedy" "Fafa has an array A of n positive integers, the function f(A) is defined as . He wants to do q queries of two types:  1\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89x \xe2\x80\x94 find the maximum possible value of f(A), if x is to be added to one element in the range [l,\xe2\x80\x89\xe2\x80\x89r]. You can choose to which element to add x.  2\xe2\x80\x89l\xe2\x80\x89r\xe2\x80\x89x \xe2\x80\x94 increase all the elements in the range [l,\xe2\x80\x89\xe2\x80\x89r] by value x. Note that queries of type 1 don\'t affect the array elements." 2600
935E "Fafa and Ancient Mathematics" "dfs and similar,dp,trees" "Ancient Egyptians are known to have understood difficult concepts in mathematics. The ancient Egyptian mathematician Ahmes liked to write a kind of arithmetic expressions on papyrus paper which he called as Ahmes arithmetic expression.An Ahmes arithmetic expression can be defined as:   ""d"" is an Ahmes arithmetic expression, where d is a one-digit positive integer;  ""(E1\xe2\x80\x89op\xe2\x80\x89E2)"" is an Ahmes arithmetic expression, where E1 and E2 are valid Ahmes arithmetic expressions (without spaces) and op is either plus (\xe2\x80\x89+\xe2\x80\x89) or minus (\xe2\x80\x89-\xe2\x80\x89).  For example 5, (1-1) and ((1+(2-3))-5) are valid Ahmes arithmetic expressions.On his trip to Egypt, Fafa found a piece of papyrus paper having one of these Ahmes arithmetic expressions written on it. Being very ancient, the papyrus piece was very worn out. As a result, all the operators were erased, keeping only the numbers and the brackets. Since Fafa loves mathematics, he decided to challenge himself with the following task:Given the number of plus and minus operators in the original expression, find out the maximum possible value for the expression on the papyrus paper after putting the plus and minus operators in the place of the original erased operators." 2300
935D "Fafa and Ancient Alphabet" math,probabilities "Ancient Egyptians are known to have used a large set of symbols  to write on the walls of the temples. Fafa and Fifa went to one of the temples and found two non-empty words S1 and S2 of equal lengths on the wall of temple written one below the other. Since this temple is very ancient, some symbols from the words were erased. The symbols in the set  have equal probability for being in the position of any erased symbol.Fifa challenged Fafa to calculate the probability that S1 is lexicographically greater than S2. Can you help Fafa with this task?You know that , i. e. there were m distinct characters in Egyptians\' alphabet, in this problem these characters are denoted by integers from 1 to m in alphabet order. A word x is lexicographically greater than a word y of the same length, if the words are same up to some position, and then the word x has a larger character, than the word y.We can prove that the probability equals to some fraction , where P and Q are coprime integers, and . Print as the answer the value , i. e. such a non-negative integer less than 109\xe2\x80\x89+\xe2\x80\x897, such that , where  means that a and b give the same remainders when divided by m." 1900
935C "Fifa and Fafa" geometry "Fifa and Fafa are sharing a flat. Fifa loves video games and wants to download a new soccer game. Unfortunately, Fafa heavily uses the internet which consumes the quota. Fifa can access the internet through his Wi-Fi access point. This access point can be accessed within a range of r meters (this range can be chosen by Fifa) from its position. Fifa must put the access point inside the flat which has a circular shape of radius R. Fifa wants to minimize the area that is not covered by the access point inside the flat without letting Fafa or anyone outside the flat to get access to the internet.The world is represented as an infinite 2D plane. The flat is centered at (x1,\xe2\x80\x89y1) and has radius R and Fafa\'s laptop is located at (x2,\xe2\x80\x89y2), not necessarily inside the flat. Find the position and the radius chosen by Fifa for his access point which minimizes the uncovered area." 1600
935B "Fafa and the Gates" implementation "Two neighboring kingdoms decided to build a wall between them with some gates to enable the citizens to go from one kingdom to another. Each time a citizen passes through a gate, he has to pay one silver coin.The world can be represented by the first quadrant of a plane and the wall is built along the identity line (i.e. the line with the equation x\xe2\x80\x89=\xe2\x80\x89y). Any point below the wall belongs to the first kingdom while any point above the wall belongs to the second kingdom. There is a gate at any integer point on the line (i.e. at points (0,\xe2\x80\x890), (1,\xe2\x80\x891), (2,\xe2\x80\x892), ...). The wall and the gates do not belong to any of the kingdoms. Fafa is at the gate at position (0,\xe2\x80\x890) and he wants to walk around in the two kingdoms. He knows the sequence S of moves he will do. This sequence is a string where each character represents a move. The two possible moves Fafa will do are \'U\' (move one step up, from (x,\xe2\x80\x89y) to (x,\xe2\x80\x89y\xe2\x80\x89+\xe2\x80\x891)) and \'R\' (move one step right, from (x,\xe2\x80\x89y) to (x\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89y)). Fafa wants to know the number of silver coins he needs to pay to walk around the two kingdoms following the sequence S. Note that if Fafa visits a gate without moving from one kingdom to another, he pays no silver coins. Also assume that he doesn\'t pay at the gate at point (0,\xe2\x80\x890), i. e. he is initially on the side he needs." 900
935A "Fafa and his Company" "brute force,implementation" "Fafa owns a company that works on huge projects. There are n employees in Fafa\'s company. Whenever the company has a new project to start working on, Fafa has to divide the tasks of this project among all the employees.Fafa finds doing this every time is very tiring for him. So, he decided to choose the best l employees in his company as team leaders. Whenever there is a new project, Fafa will divide the tasks among only the team leaders and each team leader will be responsible of some positive number of employees to give them the tasks. To make this process fair for the team leaders, each one of them should be responsible for the same number of employees. Moreover, every employee, who is not a team leader, has to be under the responsibility of exactly one team leader, and no team leader is responsible for another team leader.Given the number of employees n, find in how many ways Fafa could choose the number of team leaders l in such a way that it is possible to divide employees between them evenly." 800
934B "A Prosperous Lot" "constructive algorithms,implementation" "Apart from Nian, there is a daemon named Sui, which terrifies children and causes them to become sick. Parents give their children money wrapped in red packets and put them under the pillow, so that when Sui tries to approach them, it will be driven away by the fairies inside.Big Banban is hesitating over the amount of money to give out. He considers loops to be lucky since it symbolizes unity and harmony.He would like to find a positive integer n not greater than 1018, such that there are exactly k loops in the decimal representation of n, or determine that such n does not exist.A loop is a planar area enclosed by lines in the digits\' decimal representation written in Arabic numerals. For example, there is one loop in digit 4, two loops in 8 and no loops in 5. Refer to the figure below for all exact forms." 1200
934A "A Compatible Pair" "brute force,games" "Nian is a monster which lives deep in the oceans. Once a year, it shows up on the land, devouring livestock and even people. In order to keep the monster away, people fill their villages with red colour, light, and cracking noise, all of which frighten the monster out of coming.Little Tommy has n lanterns and Big Banban has m lanterns. Tommy\'s lanterns have brightness a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, and Banban\'s have brightness b1,\xe2\x80\x89b2,\xe2\x80\x89...,\xe2\x80\x89bm respectively.Tommy intends to hide one of his lanterns, then Banban picks one of Tommy\'s non-hidden lanterns and one of his own lanterns to form a pair. The pair\'s brightness will be the product of the brightness of two lanterns.Tommy wants to make the product as small as possible, while Banban tries to make it as large as possible.You are asked to find the brightness of the chosen pair if both of them choose optimally." 1400
933E "A Preponderant Reunion" "constructive algorithms,dp" "East or west, home is best. That\'s why family reunion, the indispensable necessity of Lunar New Year celebration, is put in such a position.After the reunion dinner, Little Tommy plays a game with the family. Here is a concise introduction to this game:   There is a sequence of n non-negative integers p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pn in the beginning. It is ruled that each integer in this sequence should be non-negative at any time.  You can select two consecutive positive integers in this sequence, pi and pi\xe2\x80\x89+\xe2\x80\x891 (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n), and then decrease them by their minimum (i. e. min(pi,\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891)), the cost of this operation is equal to min(pi,\xe2\x80\x89pi\xe2\x80\x89+\xe2\x80\x891). We call such operation as a descension.  The game immediately ends when there are no two consecutive positive integers. Your task is to end the game so that the total cost of your operations is as small as possible. Obviously, every game ends after at most n\xe2\x80\x89-\xe2\x80\x891 descensions. Please share your solution of this game with the lowest cost." 3200
933D "A Creative Cutout" "brute force,combinatorics,math" "Everything red frightens Nian the monster. So do red paper and... you, red on Codeforces, potential or real.Big Banban has got a piece of paper with endless lattice points, where lattice points form squares with the same area. His most favorite closed shape is the circle because of its beauty and simplicity. Once he had obtained this piece of paper, he prepares it for paper-cutting.  He drew n concentric circles on it and numbered these circles from 1 to n such that the center of each circle is the same lattice point and the radius of the k-th circle is  times the length of a lattice edge.Define the degree of beauty of a lattice point as the summation of the indices of circles such that this lattice point is inside them, or on their bounds. Banban wanted to ask you the total degree of beauty of all the lattice points, but changed his mind.Defining the total degree of beauty of all the lattice points on a piece of paper with n circles as f(n), you are asked to figure out ." 2900
933C "A Colourful Prospect" geometry,graphs "Firecrackers scare Nian the monster, but they\'re wayyyyy too noisy! Maybe fireworks make a nice complement.Little Tommy is watching a firework show. As circular shapes spread across the sky, a splendid view unfolds on the night of Lunar New Year\'s eve.A wonder strikes Tommy. How many regions are formed by the circles on the sky? We consider the sky as a flat plane. A region is a connected part of the plane with positive area, whose bound consists of parts of bounds of the circles and is a curve or several curves without self-intersections, and that does not contain any curve other than its boundaries. Note that exactly one of the regions extends infinitely." 2700
933B "A Determined Cleanup" math "In order to put away old things and welcome a fresh new year, a thorough cleaning of the house is a must.Little Tommy finds an old polynomial and cleaned it up by taking it modulo another. But now he regrets doing this...Given two integers p and k, find a polynomial f(x) with non-negative integer coefficients strictly less than k, whose remainder is p when divided by (x\xe2\x80\x89+\xe2\x80\x89k). That is, f(x)\xe2\x80\x89=\xe2\x80\x89q(x)\xc2\xb7(x\xe2\x80\x89+\xe2\x80\x89k)\xe2\x80\x89+\xe2\x80\x89p, where q(x) is a polynomial (not necessarily with integer coefficients)." 2000
933A "A Twisty Movement" dp "A dragon symbolizes wisdom, power and wealth. On Lunar New Year\'s Day, people model a dragon with bamboo strips and clothes, raise them with rods, and hold the rods high and low to resemble a flying dragon.A performer holding the rod low is represented by a 1, while one holding it high is represented by a 2. Thus, the line of performers can be represented by a sequence a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an.Little Tommy is among them. He would like to choose an interval [l,\xe2\x80\x89r] (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n), then reverse al,\xe2\x80\x89al\xe2\x80\x89+\xe2\x80\x891,\xe2\x80\x89...,\xe2\x80\x89ar so that the length of the longest non-decreasing subsequence of the new sequence is maximum.A non-decreasing subsequence is a sequence of indices p1,\xe2\x80\x89p2,\xe2\x80\x89...,\xe2\x80\x89pk, such that p1\xe2\x80\x89<\xe2\x80\x89p2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89pk and ap1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89ap2\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89...\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89apk. The length of the subsequence is k." 1800
932G "Palindrome Partition" "dp,string suffix structures,strings" "Given a string s, find the number of ways to split s to substrings such that if there are k substrings (p1,\xe2\x80\x89p2,\xe2\x80\x89p3,\xe2\x80\x89...,\xe2\x80\x89pk) in partition, then pi\xe2\x80\x89=\xe2\x80\x89pk\xe2\x80\x89-\xe2\x80\x89i\xe2\x80\x89+\xe2\x80\x891 for all i (1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k) and k is even.Since the number of ways can be large, print it modulo 109\xe2\x80\x89+\xe2\x80\x897." 2900
932F "Escape Through Leaf" "data structures,dp,geometry" "You are given a tree with n nodes (numbered from 1 to n) rooted at node 1. Also, each node has two values associated with it. The values for i-th node are ai and bi.You can jump from a node to any node in its subtree. The cost of one jump from node x to node y is the product of ax and by. The total cost of a path formed by one or more jumps is sum of costs of individual jumps. For every node, calculate the minimum total cost to reach any leaf from that node. Pay attention, that root can never be leaf, even if it has degree 1.Note that you cannot jump from a node to itself." 2700
932E "Team Work" combinatorics,dp,math "You have a team of N people. For a particular task, you can pick any non-empty subset of people. The cost of having x people for the task is xk. Output the sum of costs over all non-empty subsets of people." 2400
932D Tree "binary search,dp,trees" "You are given a node of the tree with index 1 and with weight 0. Let cnt be the number of nodes in the tree at any instant (initially, cnt is set to 1). Support Q queries of following two types:   Add a new node (index cnt\xe2\x80\x89+\xe2\x80\x891) with weight W and add edge between node R and this node.   Output the maximum length of sequence of nodes which   starts with R.  Every node in the sequence is an ancestor of its predecessor.  Sum of weight of nodes in sequence does not exceed X.  For some nodes i,\xe2\x80\x89j that are consecutive in the sequence if i is an ancestor of j then w[i]\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89w[j] and there should not exist a node k on simple path from i to j such that w[k]\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89w[j]  The tree is rooted at node 1 at any instant.Note that the queries are given in a modified way." 2200
932C "Permutation Cycle" "brute force,constructive algorithms" "For a permutation P[1... N] of integers from 1 to N, function f is defined as follows:  Let g(i) be the minimum positive integer j such that f(i,\xe2\x80\x89j)\xe2\x80\x89=\xe2\x80\x89i. We can show such j always exists.For given N,\xe2\x80\x89A,\xe2\x80\x89B, find a permutation P of integers from 1 to N such that for 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89N, g(i) equals either A or B." 1600
932B "Recursive Queries" "binary search,data structures,dfs and similar" "Let us define two functions f and g on positive integer numbers.   You need to process Q queries. In each query, you will be given three integers l, r and k. You need to print the number of integers x between l and r inclusive, such that g(x)\xe2\x80\x89=\xe2\x80\x89k." 1300
932A "Palindromic Supersequence" "constructive algorithms" "You are given a string A. Find a string B, where B is a palindrome and A is a subsequence of B.A subsequence of a string is a string that can be derived from it by deleting some (not necessarily consecutive) characters without changing the order of the remaining characters. For example, ""cotst"" is a subsequence of ""contest"".A palindrome is a string that reads the same forward or backward.The length of string B should be at most 104. It is guaranteed that there always exists such string.You do not need to find the shortest answer, the only restriction is that the length of string B should not exceed 104." 800
931C "Laboratory Work" implementation,math "Anya and Kirill are doing a physics laboratory work. In one of the tasks they have to measure some value n times, and then compute the average value to lower the error.Kirill has already made his measurements, and has got the following integer values: x1, x2, ..., xn. It is important that the values are close to each other, namely, the difference between the maximum value and the minimum value is at most 2.Anya does not want to make the measurements, however, she can\'t just copy the values from Kirill\'s work, because the error of each measurement is a random value, and this coincidence will be noted by the teacher. Anya wants to write such integer values y1, y2, ..., yn in her work, that the following conditions are met:  the average value of x1,\xe2\x80\x89x2,\xe2\x80\x89...,\xe2\x80\x89xn is equal to the average value of y1,\xe2\x80\x89y2,\xe2\x80\x89...,\xe2\x80\x89yn; all Anya\'s measurements are in the same bounds as all Kirill\'s measurements, that is, the maximum value among Anya\'s values is not greater than the maximum value among Kirill\'s values, and the minimum value among Anya\'s values is not less than the minimum value among Kirill\'s values; the number of equal measurements in Anya\'s work and Kirill\'s work is as small as possible among options with the previous conditions met. Formally, the teacher goes through all Anya\'s values one by one, if there is equal value in Kirill\'s work and it is not strike off yet, he strikes off this Anya\'s value and one of equal values in Kirill\'s work. The number of equal measurements is then the total number of strike off values in Anya\'s work. Help Anya to write such a set of measurements that the conditions above are met." 1700
931B "World Cup" "constructive algorithms,implementation" "The last stage of Football World Cup is played using the play-off system.There are n teams left in this stage, they are enumerated from 1 to n. Several rounds are held, in each round the remaining teams are sorted in the order of their ids, then the first in this order plays with the second, the third \xe2\x80\x94 with the fourth, the fifth \xe2\x80\x94 with the sixth, and so on. It is guaranteed that in each round there is even number of teams. The winner of each game advances to the next round, the loser is eliminated from the tournament, there are no draws. In the last round there is the only game with two remaining teams: the round is called the Final, the winner is called the champion, and the tournament is over.Arkady wants his two favorite teams to play in the Final. Unfortunately, the team ids are already determined, and it may happen that it is impossible for teams to meet in the Final, because they are to meet in some earlier stage, if they are strong enough. Determine, in which round the teams with ids a and b can meet." 1200
931A "Friends Meeting" "brute force,greedy,implementation,math" "Two friends are on the coordinate axis Ox in points with integer coordinates. One of them is in the point x1\xe2\x80\x89=\xe2\x80\x89a, another one is in the point x2\xe2\x80\x89=\xe2\x80\x89b. Each of the friends can move by one along the line in any direction unlimited number of times. When a friend moves, the tiredness of a friend changes according to the following rules: the first move increases the tiredness by 1, the second move increases the tiredness by 2, the third \xe2\x80\x94 by 3 and so on. For example, if a friend moves first to the left, then to the right (returning to the same point), and then again to the left his tiredness becomes equal to 1\xe2\x80\x89+\xe2\x80\x892\xe2\x80\x89+\xe2\x80\x893\xe2\x80\x89=\xe2\x80\x896.The friends want to meet in a integer point. Determine the minimum total tiredness they should gain, if they meet in the same point." 800
930E "Coins Exhibition" "data structures,dp,math" "Arkady and Kirill visited an exhibition of rare coins. The coins were located in a row and enumerated from left to right from 1 to k, each coin either was laid with its obverse (front) side up, or with its reverse (back) side up.Arkady and Kirill made some photos of the coins, each photo contained a segment of neighboring coins. Akrady is interested in obverses, so on each photo made by him there is at least one coin with obverse side up. On the contrary, Kirill is interested in reverses, so on each photo made by him there is at least one coin with its reverse side up.The photos are lost now, but Arkady and Kirill still remember the bounds of the segments of coins each photo contained. Given this information, compute the remainder of division by 109\xe2\x80\x89+\xe2\x80\x897 of the number of ways to choose the upper side of each coin in such a way, that on each Arkady\'s photo there is at least one coin with obverse side up, and on each Kirill\'s photo there is at least one coin with reverse side up." 2900
930D "Game with Tokens" "data structures,games,implementation" "Consider the following game for two players. There is one white token and some number of black tokens. Each token is placed on a plane in a point with integer coordinates x and y.The players take turn making moves, white starts. On each turn, a player moves all tokens of their color by 1 to up, down, left or right. Black player can choose directions for each token independently.After a turn of the white player the white token can not be in a point where a black token is located. There are no other constraints on locations of the tokens: positions of black tokens can coincide, after a turn of the black player and initially the white token can be in the same point with some black point. If at some moment the white player can\'t make a move, he loses. If the white player makes 10100500 moves, he wins.You are to solve the following problem. You are given initial positions of all black tokens. It is guaranteed that initially all these positions are distinct. In how many places can the white token be located initially so that if both players play optimally, the black player wins?" 2500
930C "Teodor is not a liar!" "data structures,dp" "Young Teodor enjoys drawing. His favourite hobby is drawing segments with integer borders inside his huge [1;m] segment. One day Teodor noticed that picture he just drawn has one interesting feature: there doesn\'t exist an integer point, that belongs each of segments in the picture. Having discovered this fact, Teodor decided to share it with Sasha.Sasha knows that Teodor likes to show off so he never trusts him. Teodor wants to prove that he can be trusted sometimes, so he decided to convince Sasha that there is no such integer point in his picture, which belongs to each segment. However Teodor is lazy person and neither wills to tell Sasha all coordinates of segments\' ends nor wills to tell him their amount, so he suggested Sasha to ask him series of questions \'Given the integer point xi, how many segments in Fedya\'s picture contain that point?\', promising to tell correct answers for this questions.Both boys are very busy studying and don\'t have much time, so they ask you to find out how many questions can Sasha ask Teodor, that having only answers on his questions, Sasha can\'t be sure that Teodor isn\'t lying to him. Note that Sasha doesn\'t know amount of segments in Teodor\'s picture. Sure, Sasha is smart person and never asks about same point twice." 1900
930B "Game with String" implementation,probabilities,strings "Vasya and Kolya play a game with a string, using the following rules. Initially, Kolya creates a string s, consisting of small English letters, and uniformly at random chooses an integer k from a segment [0,\xe2\x80\x89len(s)\xe2\x80\x89-\xe2\x80\x891]. He tells Vasya this string s, and then shifts it k letters to the left, i. e. creates a new string t\xe2\x80\x89=\xe2\x80\x89sk\xe2\x80\x89+\xe2\x80\x891sk\xe2\x80\x89+\xe2\x80\x892... sns1s2... sk. Vasya does not know the integer k nor the string t, but he wants to guess the integer k. To do this, he asks Kolya to tell him the first letter of the new string, and then, after he sees it, open one more letter on some position, which Vasya can choose.Vasya understands, that he can\'t guarantee that he will win, but he wants to know the probability of winning, if he plays optimally. He wants you to compute this probability. Note that Vasya wants to know the value of k uniquely, it means, that if there are at least two cyclic shifts of s that fit the information Vasya knowns, Vasya loses. Of course, at any moment of the game Vasya wants to maximize the probability of his win." 1600
930A "Peculiar apple-tree" "dfs and similar,graphs,trees" "In Arcady\'s garden there grows a peculiar apple-tree that fruits one time per year. Its peculiarity can be explained in following way: there are n inflorescences, numbered from 1 to n. Inflorescence number 1 is situated near base of tree and any other inflorescence with number i (i\xe2\x80\x89>\xe2\x80\x891) is situated at the top of branch, which bottom is pi-th inflorescence and pi\xe2\x80\x89<\xe2\x80\x89i.Once tree starts fruiting, there appears exactly one apple in each inflorescence. The same moment as apples appear, they start to roll down along branches to the very base of tree. Each second all apples, except ones in first inflorescence simultaneously roll down one branch closer to tree base, e.g. apple in a-th inflorescence gets to pa-th inflorescence. Apples that end up in first inflorescence are gathered by Arcady in exactly the same moment. Second peculiarity of this tree is that once two apples are in same inflorescence they annihilate. This happens with each pair of apples, e.g. if there are 5 apples in same inflorescence in same time, only one will not be annihilated and if there are 8 apples, all apples will be annihilated. Thus, there can be no more than one apple in each inflorescence in each moment of time.Help Arcady with counting number of apples he will be able to collect from first inflorescence during one harvest." 1500
929D "\xd0\x9f\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0" NA "\xd0\x93\xd0\xb5\xd1\x80\xd0\xbe\xd0\xb9 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd1\x83\xd0\xb7\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbe\xd1\x81\xd0\xba\xd0\xb5 \xd0\xb7\xd0\xb5\xd0\xbc\xd0\xbb\xd0\xb8, \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbd\xd0\xb0 n \xd0\xb7\xd0\xbe\xd0\xbd, \xd0\xbf\xd1\x80\xd0\xbe\xd0\xbd\xd1\x83\xd0\xbc\xd0\xb5\xd1\x80\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbe\xd1\x82 1 \xd0\xb4\xd0\xbe n. \xd0\x98\xd0\xb7 i-\xd0\xb9 \xd0\xb7\xd0\xbe\xd0\xbd\xd1\x8b \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xbb\xd0\xb8\xd1\x88\xd1\x8c \xd0\xb2 (i\xe2\x80\x89-\xe2\x80\x891)-\xd1\x8e \xd0\xb7\xd0\xbe\xd0\xbd\xd1\x83 \xd0\xb8 \xd0\xb2 (i\xe2\x80\x89+\xe2\x80\x891)-\xd1\x8e \xd0\xb7\xd0\xbe\xd0\xbd\xd1\x83, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xb8 \xd1\x81\xd1\x83\xd1\x89\xd0\xb5\xd1\x81\xd1\x82\xd0\xb2\xd1\x83\xd1\x8e\xd1\x82. \xd0\x9f\xd1\x80\xd0\xb8 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xbc \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xb0\xd1\x80\xd0\xbe\xd0\xb9 \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb8\xd1\x85 \xd0\xb7\xd0\xbe\xd0\xbd \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xbf\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb3\xd1\x83\xd1\x82 \xd0\xb1\xd1\x8b\xd1\x82\xd1\x8c \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xbe\xd0\xb2, \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82 \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 i-\xd0\xb9 \xd0\xb8 (i\xe2\x80\x89+\xe2\x80\x891)-\xd0\xb9 \xd0\xb7\xd0\xbe\xd0\xbd\xd0\xbe\xd0\xb9 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xb5\xd0\xbd gi.\xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb9\xd1\x82\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0 \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0, \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd1\x8d\xd1\x82\xd0\xb8\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xb1\xd1\x8b\xd0\xb2\xd0\xb0\xd0\xbb \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd0\xb8\xd0\xb7 \xd1\x88\xd0\xb0\xd1\x82\xd1\x80\xd0\xbe\xd0\xb2 \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xb9 \xd0\xba\xd0\xbb\xd1\x8e\xd1\x87\xd0\xb5\xd0\xb9 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\xb8 \xd0\xb2\xd0\xb7\xd1\x8f\xd0\xbb \xd0\xba\xd0\xbb\xd1\x8e\xd1\x87. \xd0\x92 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb9 \xd0\xb7\xd0\xbe\xd0\xbd\xd0\xb5 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x88\xd0\xb0\xd1\x82\xd0\xb5\xd1\x80 \xd1\x85\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8f \xd0\xba\xd0\xbb\xd1\x8e\xd1\x87\xd0\xb5\xd0\xb9 \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0, \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82 \xd1\x88\xd0\xb0\xd1\x82\xd1\x80\xd0\xb0 \xd0\xb2 i-\xd0\xb9 \xd0\xb7\xd0\xbe\xd0\xbd\xd0\xb5 \xd1\x80\xd0\xb0\xd0\xb2\xd0\xb5\xd0\xbd ki. \xd0\x9f\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xb5\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x88\xd0\xb0\xd1\x82\xd1\x80\xd0\xb0 \xd0\xbe\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x87\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb7 \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x86\xd0\xb2\xd0\xb5\xd1\x82\xd0\xb0.\xd0\x9d\xd0\xb0 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4 \xd1\x87\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb8 \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd1\x82\xd1\x80\xd0\xb0\xd1\x82\xd0\xb8\xd1\x82 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd1\x85\xd0\xbe\xd0\xb4, \xd0\xbd\xd0\xb0 \xd0\xbf\xd0\xbe\xd1\x81\xd0\xb5\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5 \xd1\x88\xd0\xb0\xd1\x82\xd1\x80\xd0\xb0 \xd0\xb8 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd0\xb5 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd1\x89\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd1\x85\xd0\xbe\xd0\xb4\xd1\x8b \xd0\xbd\xd0\xb5 \xd1\x82\xd1\x80\xd0\xb5\xd0\xb1\xd1\x83\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f. \xd0\x97\xd0\xb0 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb5 \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe \xd1\x85\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb2 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xbf\xd0\xb0\xd1\x81\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb7 \xd0\xb7\xd0\xbe\xd0\xbd\xd1\x8b a \xd0\xb2 \xd0\xb7\xd0\xbe\xd0\xbd\xd1\x83 b, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb8\xd0\xb7\xd0\xbd\xd0\xb0\xd1\x87\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd1\x83 \xd0\xbd\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbd\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0\xd0\xba\xd0\xb8\xd1\x85 \xd0\xba\xd0\xbb\xd1\x8e\xd1\x87\xd0\xb5\xd0\xb9?" 2400
929C "\xd0\x9a\xd1\x80\xd0\xb0\xd1\x81\xd0\xb8\xd0\xb2\xd0\xb0\xd1\x8f \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0" "*special problem,combinatorics,math" "\xd0\x97\xd0\xb0\xd0\xb2\xd1\x82\xd1\x80\xd0\xb0 \xd1\x83 \xd1\x85\xd0\xbe\xd0\xba\xd0\xba\xd0\xb5\xd0\xb9\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd1\x8b, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xd1\x80\xd1\x83\xd0\xba\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82 \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9, \xd0\xb2\xd0\xb0\xd0\xb6\xd0\xbd\xd1\x8b\xd0\xb9 \xd0\xbc\xd0\xb0\xd1\x82\xd1\x87. \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8e \xd0\xbd\xd1\x83\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd1\x88\xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xb2\xd1\x8b\xd0\xb9\xd0\xb4\xd1\x83\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbb\xd0\xb5\xd0\xb4 \xd0\xb2 \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xbc \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb5: \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x8c, \xd0\xb4\xd0\xb2\xd0\xb0 \xd0\xb7\xd0\xb0\xd1\x89\xd0\xb8\xd1\x82\xd0\xbd\xd0\xb8\xd0\xba\xd0\xb0 \xd0\xb8 \xd1\x82\xd1\x80\xd0\xb8 \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85.\xd0\xa2\xd0\xb0\xd0\xba \xd0\xba\xd0\xb0\xd0\xba \xd1\x8d\xd1\x82\xd0\xbe \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb9 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2, \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 \xd0\xb2\xd0\xbe\xd0\xbb\xd0\xbd\xd1\x83\xd0\xb5\xd1\x82, \xd0\xbd\xd0\xb0\xd1\x81\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xba\xd1\x80\xd0\xb0\xd1\x81\xd0\xb8\xd0\xb2\xd0\xb0 \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xba\xd0\xbe\xd0\xbc\xd0\xb0\xd0\xbd\xd0\xb4\xd0\xb0 \xd0\xbd\xd0\xb0 \xd0\xbb\xd1\x8c\xd0\xb4\xd1\x83, \xd1\x87\xd0\xb5\xd0\xbc \xd1\x81\xd0\xbf\xd0\xbe\xd1\x81\xd0\xbe\xd0\xb1\xd0\xbd\xd0\xbe\xd1\x81\xd1\x82\xd0\xb8 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2. \xd0\x90 \xd0\xb8\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe, \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9 \xd1\x85\xd0\xbe\xd1\x87\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb9 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xbb\xd1\x8e\xd0\xb1\xd1\x8b\xd1\x85 \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb8\xd0\xb7 \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd0\xbe\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xb0 \xd0\xbe\xd1\x82\xd0\xbb\xd0\xb8\xd1\x87\xd0\xb0\xd0\xbb\xd0\xb8\xd1\x81\xd1\x8c \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5, \xd1\x87\xd0\xb5\xd0\xbc \xd0\xb2 \xd0\xb4\xd0\xb2\xd0\xb0 \xd1\x80\xd0\xb0\xd0\xb7\xd0\xb0. \xd0\x9d\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd1\x81 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbc\xd0\xb8 13, 14, 10, 18, 15 \xd0\xb8 20 \xd1\x83\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd1\x8f\xd1\x82 \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f, \xd0\xb0 \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8, \xd0\xbd\xd0\xb0\xd0\xbf\xd1\x80\xd0\xb8\xd0\xbc\xd0\xb5\xd1\x80, \xd0\xbd\xd0\xb0 \xd0\xbb\xd0\xb5\xd0\xb4 \xd0\xb2\xd1\x8b\xd0\xb9\xd0\xb4\xd1\x83\xd1\x82 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xb8 \xd1\x81 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0\xd0\xbc\xd0\xb8 8 \xd0\xb8 17, \xd1\x82\xd0\xbe \xd1\x8d\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5 \xd1\x83\xd1\x81\xd1\x82\xd1\x80\xd0\xbe\xd0\xb8\xd1\x82 \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd1\x8f.\xd0\x9f\xd1\x80\xd0\xbe \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb8\xd0\xb7 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb2\xd0\xb0\xd0\xbc \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9 \xd0\xbf\xd0\xbe\xd0\xb7\xd0\xb8\xd1\x86\xd0\xb8\xd0\xb8 \xd0\xbe\xd0\xbd \xd0\xb8\xd0\xb3\xd1\x80\xd0\xb0\xd0\xb5\xd1\x82 (\xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x8c, \xd0\xb7\xd0\xb0\xd1\x89\xd0\xb8\xd1\x82\xd0\xbd\xd0\xb8\xd0\xba \xd0\xb8\xd0\xbb\xd0\xb8 \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x8e\xd1\x89\xd0\xb8\xd0\xb9), \xd0\xb0 \xd1\x82\xd0\xb0\xd0\xba\xd0\xb6\xd0\xb5 \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80. \xd0\x92 \xd1\x85\xd0\xbe\xd0\xba\xd0\xba\xd0\xb5\xd0\xb5 \xd0\xbd\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb0 \xd0\xb8\xd0\xb3\xd1\x80\xd0\xbe\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xbd\xd0\xb5 \xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb8\xd0\xb4\xd1\x83\xd1\x82 \xd0\xbf\xd0\xbe\xd0\xb4\xd1\x80\xd1\x8f\xd0\xb4. \xd0\x9f\xd0\xbe\xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd0\xb9\xd1\x82\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7\xd0\xbb\xd0\xb8\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd1\x81\xd1\x82\xd0\xb0\xd1\x80\xd1\x82\xd0\xbe\xd0\xb2\xd1\x8b\xd1\x85 \xd1\x81\xd0\xbe\xd1\x81\xd1\x82\xd0\xb0\xd0\xb2\xd0\xbe\xd0\xb2 \xd0\xb8\xd0\xb7 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd1\x80\xd0\xb0\xd1\x82\xd0\xb0\xd1\x80\xd1\x8f, \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd0\xb7\xd0\xb0\xd1\x89\xd0\xb8\xd1\x82\xd0\xbd\xd0\xb8\xd0\xba\xd0\xbe\xd0\xb2 \xd0\xb8 \xd1\x82\xd1\x80\xd0\xb5\xd1\x85 \xd0\xbd\xd0\xb0\xd0\xbf\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x8e\xd1\x89\xd0\xb8\xd1\x85, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\x95\xd0\xb2\xd0\xb3\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb9, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd0\xb2\xd1\x8b\xd0\xbf\xd0\xbe\xd0\xbb\xd0\xbd\xd1\x8f\xd0\xbb\xd0\xbe\xd1\x81\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x83\xd1\x81\xd0\xbb\xd0\xbe\xd0\xb2\xd0\xb8\xd0\xb5 \xd0\xba\xd1\x80\xd0\xb0\xd1\x81\xd0\xbe\xd1\x82\xd1\x8b." 1700
929B "\xd0\x9c\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd0\xb2 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xbb\xd1\x91\xd1\x82\xd0\xb5" "*special problem,implementation" "\xd0\x92 \xd1\x81\xd0\xb0\xd0\xbc\xd0\xbe\xd0\xbb\xd1\x91\xd1\x82\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c n \xd1\x80\xd1\x8f\xd0\xb4\xd0\xbe\xd0\xb2 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd1\x81\xd0\xbc\xd0\xbe\xd1\x82\xd1\x80\xd0\xb5\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd1\x80\xd1\x8f\xd0\xb4\xd1\x8b \xd1\x81\xd0\xb2\xd0\xb5\xd1\x80\xd1\x85\xd1\x83, \xd1\x82\xd0\xbe \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xb6\xd0\xb4\xd0\xbe\xd0\xbc \xd1\x80\xd1\x8f\xd0\xb4\xd1\x83 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c 3 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb2\xd0\xb0, \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd1\x80\xd1\x8f\xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb8, \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc 4 \xd1\x86\xd0\xb5\xd0\xbd\xd1\x82\xd1\x80\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0, \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd0\xb5\xd1\x89\xd1\x91 \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4 \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd1\x80\xd1\x8f\xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb8, \xd0\xb0 \xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbc \xd0\xb5\xd1\x89\xd1\x91 3 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd1\x81\xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb0.\xd0\x98\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82\xd0\xb0 \xd1\x83\xd0\xb6\xd0\xb5 \xd0\xb7\xd0\xb0\xd0\xbd\xd1\x8f\xd1\x82\xd1\x8b \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xb0\xd0\xbc\xd0\xb8. \xd0\x92\xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd0\xb4\xd0\xb2\xd0\xb0 \xd0\xb2\xd0\xb8\xd0\xb4\xd0\xb0 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2 \xe2\x80\x94 \xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x83\xd1\x81\xd0\xbd\xd1\x8b\xd0\xb5 (\xd1\x82\xd0\xb5, \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd1\x8b\xd0\xb5 \xd1\x87\xd0\xb0\xd1\x81\xd1\x82\xd0\xbe \xd0\xbb\xd0\xb5\xd1\x82\xd0\xb0\xd1\x8e\xd1\x82) \xd0\xb8 \xd0\xbe\xd0\xb1\xd1\x8b\xd1\x87\xd0\xbd\xd1\x8b\xd0\xb5. \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb5\xd0\xb4 \xd0\xb2\xd0\xb0\xd0\xbc\xd0\xb8 \xd1\x81\xd1\x82\xd0\xbe\xd0\xb8\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xb4\xd0\xb0\xd1\x87\xd0\xb0 \xd1\x80\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xb5\xd1\x89\xd1\x91 k \xd0\xbe\xd0\xb1\xd1\x8b\xd1\x87\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2 \xd1\x82\xd0\xb0\xd0\xba, \xd1\x87\xd1\x82\xd0\xbe\xd0\xb1\xd1\x8b \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb0\xd1\x80\xd0\xbd\xd0\xbe\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xb9 \xd1\x83 \xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x83\xd1\x81\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb1\xd1\x8b\xd0\xbb\xd0\xbe \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xbe\xd0\xb7\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd1\x8b\xd0\xbc. \xd0\x94\xd0\xb2\xd0\xb0 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xb0 \xd1\x81\xd1\x87\xd0\xb8\xd1\x82\xd0\xb0\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd1\x8f\xd0\xbc\xd0\xb8, \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbe\xd0\xbd\xd0\xb8 \xd1\x81\xd0\xb8\xd0\xb4\xd1\x8f\xd1\x82 \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xbc \xd1\x80\xd1\x8f\xd0\xb4\xd1\x83 \xd0\xb8 \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb8 \xd0\xbd\xd0\xb5\xd1\x82 \xd0\xb4\xd1\x80\xd1\x83\xd0\xb3\xd0\xb8\xd1\x85 \xd0\xbc\xd0\xb5\xd1\x81\xd1\x82 \xd0\xb8 \xd0\xbf\xd1\x80\xd0\xbe\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb0 \xd0\xbc\xd0\xb5\xd0\xb6\xd0\xb4\xd1\x83 \xd1\x80\xd1\x8f\xd0\xb4\xd0\xb0\xd0\xbc\xd0\xb8. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80 \xd1\x8f\xd0\xb2\xd0\xbb\xd1\x8f\xd0\xb5\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xbd\xd0\xb8\xd0\xbc \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xbe\xd0\xbc \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb4\xd0\xb2\xd1\x83\xd1\x85 \xd1\x81\xd1\x82\xd0\xb0\xd1\x82\xd1\x83\xd1\x81\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xbf\xd0\xb0\xd1\x81\xd1\x81\xd0\xb0\xd0\xb6\xd0\xb8\xd1\x80\xd0\xbe\xd0\xb2, \xd1\x82\xd0\xbe \xd0\xb5\xd0\xb3\xd0\xbe \xd1\x81\xd0\xbb\xd0\xb5\xd0\xb4\xd1\x83\xd0\xb5\xd1\x82 \xd1\x83\xd1\x87\xd0\xb8\xd1\x82\xd1\x8b\xd0\xb2\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2 \xd1\x81\xd1\x83\xd0\xbc\xd0\xbc\xd0\xb5 \xd1\x81\xd0\xbe\xd1\x81\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xb9 \xd0\xb4\xd0\xb2\xd0\xb0\xd0\xb6\xd0\xb4\xd1\x8b." 1300
929A "\xd0\x9f\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd0\xbe\xd0\xb2" "*special problem,greedy,implementation" "\xd0\x9a\xd0\xb0\xd0\xba \xd0\xb8\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd0\xb2 \xd1\x82\xd0\xb5\xd0\xbf\xd0\xbb\xd1\x83\xd1\x8e \xd0\xbf\xd0\xbe\xd0\xb3\xd0\xbe\xd0\xb4\xd1\x83 \xd0\xbc\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xb8\xd0\xb5 \xd0\xb6\xd0\xb8\xd1\x82\xd0\xb5\xd0\xbb\xd0\xb8 \xd0\xba\xd1\x80\xd1\x83\xd0\xbf\xd0\xbd\xd1\x8b\xd1\x85 \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xb2 \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd1\x8e\xd1\x82\xd1\x81\xd1\x8f \xd1\x81\xd0\xb5\xd1\x80\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb0\xd0\xbc\xd0\xb8 \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb4\xd1\x81\xd0\xba\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xb0. \xd0\x92\xd0\xbe\xd1\x82 \xd0\xb8 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x8f \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb4\xd0\xbe\xd0\xb1\xd0\xb8\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c\xd1\x81\xd1\x8f \xd0\xbe\xd1\x82 \xd1\x88\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8b \xd0\xb4\xd0\xbe \xd0\xb4\xd0\xbe\xd0\xbc\xd0\xb0, \xd0\xb8\xd1\x81\xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd1\x83\xd1\x8f \xd0\xb3\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb4\xd1\x81\xd0\xba\xd0\xb8\xd0\xb5 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd1\x8b.\xd0\xa8\xd0\xba\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\xb8 \xd0\xb4\xd0\xbe\xd0\xbc \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd1\x8f\xd1\x82\xd1\x81\xd1\x8f \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xbf\xd1\x80\xd1\x8f\xd0\xbc\xd0\xbe\xd0\xb9 \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb5, \xd0\xba\xd1\x80\xd0\xbe\xd0\xbc\xd0\xb5 \xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe, \xd0\xbd\xd0\xb0 \xd1\x82\xd0\xbe\xd0\xb9 \xd0\xb6\xd0\xb5 \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd0\xb5 \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c n \xd1\x82\xd0\xbe\xd1\x87\xd0\xb5\xd0\xba, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xb7\xd1\x8f\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xb8\xd0\xbb\xd0\xb8 \xd1\x81\xd0\xb4\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe. \xd0\x9f\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 x1 \xd0\xba\xd0\xb8\xd0\xbb\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb2\xd0\xb4\xd0\xbe\xd0\xbb\xd1\x8c \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd1\x8b, \xd0\xb2\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xb9 \xe2\x80\x94 \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 x2 \xd0\xb8 \xd1\x82\xd0\xb0\xd0\xba \xd0\xb4\xd0\xb0\xd0\xbb\xd0\xb5\xd0\xb5, n-\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 xn. \xd0\xa8\xd0\xba\xd0\xbe\xd0\xbb\xd0\xb0 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd1\x8f \xd0\xbd\xd0\xb0\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x81\xd1\x8f \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 x1 (\xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xbc \xd0\xb6\xd0\xb5, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xb8 \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82), \xd0\xb0 \xd0\xb4\xd0\xbe\xd0\xbc \xe2\x80\x94 \xd0\xb2 \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 xn (\xd1\x82\xd0\xbe \xd0\xb5\xd1\x81\xd1\x82\xd1\x8c \xd1\x82\xd0\xb0\xd0\xbc \xd0\xb6\xd0\xb5, \xd0\xb3\xd0\xb4\xd0\xb5 \xd0\xb8 n-\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82). \xd0\x98\xd0\xb7\xd0\xb2\xd0\xb5\xd1\x81\xd1\x82\xd0\xbd\xd0\xbe, \xd1\x87\xd1\x82\xd0\xbe xi\xe2\x80\x89<\xe2\x80\x89xi\xe2\x80\x89+\xe2\x80\x891 \xd0\xb4\xd0\xbb\xd1\x8f \xd0\xb2\xd1\x81\xd0\xb5\xd1\x85 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89n.\xd0\xa1\xd0\xbe\xd0\xb3\xd0\xbb\xd0\xb0\xd1\x81\xd0\xbd\xd0\xbe \xd0\xbf\xd1\x80\xd0\xb0\xd0\xb2\xd0\xb8\xd0\xbb\xd0\xb0\xd0\xbc \xd0\xbf\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xb7\xd0\xbe\xd0\xb2\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x8f \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xb0, \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd1\x82\xd0\xbe\xd0\xbb\xd1\x8c\xd0\xba\xd0\xbe \xd0\xbd\xd0\xb0 \xd0\xbe\xd0\xb3\xd1\x80\xd0\xb0\xd0\xbd\xd0\xb8\xd1\x87\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f, \xd0\xbf\xd0\xbe\xd1\x81\xd0\xbb\xd0\xb5 \xd1\x8d\xd1\x82\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xbe\xd0\xbd \xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb5\xd0\xbd \xd0\xbe\xd0\xb1\xd1\x8f\xd0\xb7\xd0\xb0\xd1\x82\xd0\xb5\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe \xd0\xb2\xd0\xb5\xd1\x80\xd0\xbd\xd1\x83\xd1\x82\xd1\x8c \xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb2 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb9 \xd0\xb8\xd0\xb7 \xd1\x82\xd0\xbe\xd1\x87\xd0\xb5\xd0\xba \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xb0, \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xb0\xd0\xba\xd0\xbe, \xd0\xbe\xd0\xbd \xd1\x82\xd1\x83\xd1\x82 \xd0\xb6\xd0\xb5 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb7\xd1\x8f\xd1\x82\xd1\x8c \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4, \xd0\xb8 \xd0\xbe\xd1\x82\xd1\x81\xd1\x87\xd0\xb5\xd1\x82 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xb8 \xd0\xbf\xd0\xbe\xd0\xb9\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb7\xd0\xb0\xd0\xbd\xd0\xbe\xd0\xb2\xd0\xbe. \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xb1\xd1\x80\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd0\xb5\xd0\xb5 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd0\xb0 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82 \xd0\xbe\xd0\xb4\xd0\xbd\xd0\xbe\xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe. \xd0\x95\xd1\x81\xd0\xbb\xd0\xb8 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd1\x80\xd0\xb5\xd1\x88\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb7\xd1\x8f\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4 \xd0\xb2 \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb9-\xd1\x82\xd0\xbe \xd1\x82\xd0\xbe\xd1\x87\xd0\xba\xd0\xb5 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82\xd0\xb0, \xd1\x82\xd0\xbe \xd0\xbe\xd0\xbd \xd1\x81\xd0\xb4\xd0\xb0\xd1\x91\xd1\x82 \xd1\x82\xd0\xbe\xd1\x82 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4, \xd0\xbd\xd0\xb0 \xd0\xba\xd0\xbe\xd1\x82\xd0\xbe\xd1\x80\xd0\xbe\xd0\xbc \xd0\xbe\xd0\xbd \xd0\xb4\xd0\xbe \xd0\xbd\xd0\xb5\xd0\xb3\xd0\xbe \xd0\xb4\xd0\xbe\xd0\xb5\xd1\x85\xd0\xb0\xd0\xbb, \xd0\xb1\xd0\xb5\xd1\x80\xd1\x91\xd1\x82 \xd1\x80\xd0\xbe\xd0\xb2\xd0\xbd\xd0\xbe \xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbd \xd0\xbd\xd0\xbe\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4 \xd0\xb8 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb4\xd0\xbe\xd0\xbb\xd0\xb6\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbd\xd0\xb0 \xd0\xbd\xd1\x91\xd0\xbc \xd1\x81\xd0\xb2\xd0\xbe\xd1\x91 \xd0\xb4\xd0\xb2\xd0\xb8\xd0\xb6\xd0\xb5\xd0\xbd\xd0\xb8\xd0\xb5.\xd0\x97\xd0\xb0 \xd0\xbe\xd1\x82\xd0\xb2\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb5 \xd0\xb2\xd1\x80\xd0\xb5\xd0\xbc\xd1\x8f, \xd0\xbd\xd0\xb5\xd0\xb7\xd0\xb0\xd0\xb2\xd0\xb8\xd1\x81\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xbe\xd1\x82 \xd0\xb2\xd1\x8b\xd0\xb1\xd1\x80\xd0\xb0\xd0\xbd\xd0\xbd\xd0\xbe\xd0\xb3\xd0\xbe \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd0\xb0, \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd1\x83\xd1\x81\xd0\xbf\xd0\xb5\xd0\xb2\xd0\xb0\xd0\xb5\xd1\x82 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb5 \xd0\xb1\xd0\xbe\xd0\xbb\xd1\x8c\xd1\x88\xd0\xb5 k \xd0\xba\xd0\xb8\xd0\xbb\xd0\xbe\xd0\xbc\xd0\xb5\xd1\x82\xd1\x80\xd0\xbe\xd0\xb2 \xd0\xb2\xd0\xb4\xd0\xbe\xd0\xbb\xd1\x8c \xd1\x83\xd0\xbb\xd0\xb8\xd1\x86\xd1\x8b. \xd0\x9e\xd0\xbf\xd1\x80\xd0\xb5\xd0\xb4\xd0\xb5\xd0\xbb\xd0\xb8\xd1\x82\xd0\xb5, \xd1\x81\xd0\xbc\xd0\xbe\xd0\xb6\xd0\xb5\xd1\x82 \xd0\xbb\xd0\xb8 \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xb4\xd0\xbe\xd0\xb5\xd1\x85\xd0\xb0\xd1\x82\xd1\x8c \xd0\xbd\xd0\xb0 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4\xd0\xb0\xd1\x85 \xd0\xbe\xd1\x82 \xd1\x88\xd0\xba\xd0\xbe\xd0\xbb\xd1\x8b \xd0\xb4\xd0\xbe \xd0\xb4\xd0\xbe\xd0\xbc\xd0\xb0, \xd0\xb8 \xd0\xb5\xd1\x81\xd0\xbb\xd0\xb8 \xd0\xb4\xd0\xb0, \xd1\x82\xd0\xbe \xd0\xba\xd0\xb0\xd0\xba\xd0\xbe\xd0\xb5 \xd0\xbc\xd0\xb8\xd0\xbd\xd0\xb8\xd0\xbc\xd0\xb0\xd0\xbb\xd1\x8c\xd0\xbd\xd0\xbe\xd0\xb5 \xd1\x87\xd0\xb8\xd1\x81\xd0\xbb\xd0\xbe \xd1\x80\xd0\xb0\xd0\xb7 \xd0\xb5\xd0\xbc\xd1\x83 \xd0\xbd\xd0\xb5\xd0\xbe\xd0\xb1\xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd0\xbc\xd0\xbe \xd0\xb1\xd1\x83\xd0\xb4\xd0\xb5\xd1\x82 \xd0\xb2\xd0\xb7\xd1\x8f\xd1\x82\xd1\x8c \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4 \xd0\xb2 \xd0\xbf\xd1\x80\xd0\xbe\xd0\xba\xd0\xb0\xd1\x82, \xd0\xb2\xd0\xba\xd0\xbb\xd1\x8e\xd1\x87\xd0\xb0\xd1\x8f \xd0\xbf\xd0\xb5\xd1\x80\xd0\xb2\xd1\x8b\xd0\xb9 \xd0\xb2\xd0\xb5\xd0\xbb\xd0\xbe\xd1\x81\xd0\xb8\xd0\xbf\xd0\xb5\xd0\xb4? \xd0\xa3\xd1\x87\xd1\x82\xd0\xb8\xd1\x82\xd0\xb5, \xd1\x87\xd1\x82\xd0\xbe \xd0\x90\xd1\x80\xd0\xba\xd0\xb0\xd0\xb4\xd0\xb8\xd0\xb9 \xd0\xbd\xd0\xb5 \xd0\xbd\xd0\xb0\xd0\xbc\xd0\xb5\xd1\x80\xd0\xb5\xd0\xbd \xd1\x81\xd0\xb5\xd0\xb3\xd0\xbe\xd0\xb4\xd0\xbd\xd1\x8f \xd1\x85\xd0\xbe\xd0\xb4\xd0\xb8\xd1\x82\xd1\x8c \xd0\xbf\xd0\xb5\xd1\x88\xd0\xba\xd0\xbe\xd0\xbc." 1400
928D Autocompletion "*special problem,strings,trees" "Arcady is a copywriter. His today\'s task is to type up an already well-designed story using his favorite text editor.Arcady types words, punctuation signs and spaces one after another. Each letter and each sign (including line feed) requires one keyboard click in order to be printed. Moreover, when Arcady has a non-empty prefix of some word on the screen, the editor proposes a possible autocompletion for this word, more precisely one of the already printed words such that its prefix matches the currently printed prefix if this word is unique. For example, if Arcady has already printed \xc2\xabcodeforces\xc2\xbb, \xc2\xabcoding\xc2\xbb and \xc2\xabcodeforces\xc2\xbb once again, then there will be no autocompletion attempt for \xc2\xabcod\xc2\xbb, but if he proceeds with \xc2\xabcode\xc2\xbb, the editor will propose \xc2\xabcodeforces\xc2\xbb.With a single click Arcady can follow the editor\'s proposal, i.e. to transform the current prefix to it. Note that no additional symbols are printed after the autocompletion (no spaces, line feeds, etc). What is the minimum number of keyboard clicks Arcady has to perform to print the entire text, if he is not allowed to move the cursor or erase the already printed symbols?A word here is a contiguous sequence of latin letters bordered by spaces, punctuation signs and line/text beginnings/ends. Arcady uses only lowercase letters. For example, there are 20 words in \xc2\xabit\'s well-known that tic-tac-toe is a paper-and-pencil game for two players, x and o.\xc2\xbb." 1900
928C "Dependency management" "*special problem,graphs,implementation" "Polycarp is currently developing a project in Vaja language and using a popular dependency management system called Vamen. From Vamen\'s point of view both Vaja project and libraries are treated projects for simplicity.A project in Vaja has its own uniqie non-empty name consisting of lowercase latin letters with length not exceeding 10 and version \xe2\x80\x94 positive integer from 1 to 106. Each project (keep in mind that it is determined by both its name and version) might depend on other projects. For sure, there are no cyclic dependencies.You\'re given a list of project descriptions. The first of the given projects is the one being developed by Polycarp at this moment. Help Polycarp determine all projects that his project depends on (directly or via a certain chain). It\'s possible that Polycarp\'s project depends on two different versions of some project. In this case collision resolving is applied, i.e. for each such project the system chooses the version that minimizes the distance from it to Polycarp\'s project. If there are several options, the newer (with the maximum version) is preferred. This version is considered actual; other versions and their dependencies are ignored.More formal, choose such a set of projects of minimum possible size that the following conditions hold:   Polycarp\'s project is chosen;  Polycarp\'s project depends (directly or indirectly) on all other projects in the set;  no two projects share the name;  for each project x that some other project in the set depends on we have either x or some y with other version and shorter chain to Polycarp\'s project chosen. In case of ties the newer one is chosen. Output all Polycarp\'s project\'s dependencies (Polycarp\'s project itself should\'t be printed) in lexicographical order." 1900
928B Chat "*special problem,dp" "There are times you recall a good old friend and everything you\'ve come through together. Luckily there are social networks \xe2\x80\x94 they store all your message history making it easy to know what you argued over 10 years ago.More formal, your message history is a sequence of messages ordered by time sent numbered from 1 to n where n is the total number of messages in the chat.Each message might contain a link to an earlier message which it is a reply to. When opening a message x or getting a link to it, the dialogue is shown in such a way that k previous messages, message x and k next messages are visible (with respect to message x). In case there are less than k messages somewhere, they are yet all shown.Digging deep into your message history, you always read all visible messages and then go by the link in the current message x (if there is one) and continue reading in the same manner.Determine the number of messages you\'ll read if your start from message number t for all t from 1 to n. Calculate these numbers independently. If you start with message x, the initial configuration is x itself, k previous and k next messages. Messages read multiple times are considered as one." 1400
928A "Login Verification" "*special problem,strings" "When registering in a social network, users are allowed to create their own convenient login to make it easier to share contacts, print it on business cards, etc.Login is an arbitrary sequence of lower and uppercase latin letters, digits and underline symbols (\xc2\xab_\xc2\xbb). However, in order to decrease the number of frauds and user-inattention related issues, it is prohibited to register a login if it is similar with an already existing login. More precisely, two logins s and t are considered similar if we can transform s to t via a sequence of operations of the following types:   transform lowercase letters to uppercase and vice versa;  change letter \xc2\xabO\xc2\xbb (uppercase latin letter) to digit \xc2\xab0\xc2\xbb and vice versa;  change digit \xc2\xab1\xc2\xbb (one) to any letter among \xc2\xabl\xc2\xbb (lowercase latin \xc2\xabL\xc2\xbb), \xc2\xabI\xc2\xbb (uppercase latin \xc2\xabi\xc2\xbb) and vice versa, or change one of these letters to other. For example, logins \xc2\xabCodeforces\xc2\xbb and \xc2\xabcodef0rces\xc2\xbb as well as \xc2\xabOO0OOO00O0OOO0O00OOO0OO_lol\xc2\xbb and \xc2\xabOO0OOO0O00OOO0O00OO0OOO_1oI\xc2\xbb are considered similar whereas \xc2\xabCodeforces\xc2\xbb and \xc2\xabCode_forces\xc2\xbb are not.You\'re given a list of existing logins with no two similar amonst and a newly created user login. Check whether this new login is similar with any of the existing ones." 1200
927A "BuberPool Taxi Optimization" "*special problem,interactive" "This is an interactive optimization problem. Instead of having to find the best answer, each solution will get score according to its efficiency. As the problem is interactive, during the testing process, the jury program and your solution will exchange messages via standard input and output streams. After printing a message, remember to flush the output buffer to ensure that the message is fully sent. For example, you can use fflush(stdout) in C++, System.out.flush() in Java, flush(output) in Pascal, and stdout.flush() in Python.Your task is to automate the next generation taxi service, BuberPool. Each Buber car may transport up to four passengers at a time. The cars have to drive to passengers\' locations, pick them up and drive them to their destinations. Additionally, unlike a traditional taxi, each car can process up to four orders simultaneously. For example, when driving a passenger to the destination, a car can pick up an additional passenger, or make a detour to drop off another passenger.We will use the following simplified discrete model for this real-life problem.Consider a city as a rectangular grid of w streets and h avenues with w\xc3\x97h crossroads. The streets are numbered from 1 to w, and the avenues from 1 to h. We will consider non-negative integer moments of time. Actions are performed in ticks: intervals of time between consecutive moments. At any moment, each car is located at some crossroads (x,y), where 1\xe2\x89\xa4x\xe2\x89\xa4w and 1\xe2\x89\xa4y\xe2\x89\xa4h. Any number of cars can be at the same crossroads simultaneously. During one tick, each car can either remain on the same crossroads or change exactly one of its coordinates, the street or the avenue, by one.At moment 0, you are given starting locations of k cars: (x1,y1), (x2,y2), \xe2\x80\xa6, (xk,yk). The number of cars is equal to k and does not change during the simulation.Additionally, your solution will be given the clients\' orders. In this problem, each order is made by a single passenger, so a car can process up to four orders at the same time. To further simplify the problem, the moments of orders are all distinct, and the orders are given in chronological order. So, each j-th order is described by five integers: the moment tj, the pick up location (sxj,syj), and the drop-off location (txj,tyj).On tick 0, and also right after receiving each order, you can give instruction sets to the car drivers. Each time you can give instruction sets to any number of cars (more on restrictions later). Instruction sets for different cars are given separately. An instruction set is a sequence of triples (cx1,cy1,a1), (cx2,cy2,a2), \xe2\x80\xa6, (cxm,cym,am), where m is number of instructions in the set. The meaning of these numbers is as follows:  A car should first drive to (cx1,cy1), then to (cx2,cy2), \xe2\x80\xa6, and at last to (cxm,cym). Each location (cxi,cyi) may be any crossroads in the city, not necessarily a pickup or drop-off location. While driving from one location to another, a car always first changes its first coordinate until it is equal to the first coordinate of the destination, and only then the second coordinate. This way, while driving from (p1,q1) to (p2,q2), a car will first move (p1,q1)\xe2\x86\x92(p2,q1), and then (p2,q1)\xe2\x86\x92(p2,q2). In each tick while moving, a car changes exactly one of its coordinates by one.  Values ai encode actions. If ai=0, the car just drives to (cxi,cyi) and doesn\'t do anything special. If ai>0, the car drives to (cxi,cyi) and picks up passenger number ai there (the passenger\'s pickup location should be equal to (cxi,cyi), and the passenger should still be waiting there). If ai<0, the car moves to (cxi,cyi) and drops off passenger number \xe2\x88\x92ai (the passenger\'s drop-off location should be equal to (cxi,cyi), and the passenger should be in this car). Picking up and dropping off passengers are instant. When you give instruction set to a car, its previous instruction set is replaced with the new one. This way, a car only performs at most one instruction set at a time. If there are no instructions, or all of them are completed, the car is waiting at its last location. Instructions are performed in the given order.For each order, first, all the cars perform their current instruction sets until the moment of the order comes, then the order is given to your program, and after that, your program prints new instruction sets for some of the cars. The cars which don\'t get new instruction sets continue performing their old ones.So, the overall testing strategy looks like this:  Your solution reads the city dimensions, the number of cars, and their initial coordinates.  The solution prints instruction sets for some cars, and the cars start performing the instructions.  The solution reads an integer tj, the moment of the next order (if tj=\xe2\x88\x921, your program should print the final instruction sets and exit normally).  The solution reads integers sxj, syj, txj, tyj, the pickup and drop-off locations for j-th order.  The solution prints the next instruction sets for the cars.  Go to step 3. After your program exits in step 3, first, all instructions will be completely performed, and only after that the simulation will end.The score your solution gets for a test is the average score for all orders, rounded to the nearest integer. The score for an order equals \xce\xb1\xe2\x8b\x85(100+w0), where w0 is time the order takes in the ideal case, which is just the time to get from (sxj,syj) to (txj,tyj) (so, w0=|sxj\xe2\x88\x92txj|+|syj\xe2\x88\x92tyj|), and \xce\xb1 is a real value between 0 and 1 which characterizes the passenger\'s satisfaction with the ride. The value \xce\xb1 is calculated by the formula:\xce\xb1=107\xe2\x88\x92min(d21+d22,107)107,where d1 is the waiting time before pickup (the number of ticks between the time of the order and pickup time), and d2 is the difference between actual and ideal travel time (the ideal travel time is w0). If the order was not completed, \xce\xb1=0.The score your solution gets is just the sum of scores for each test." 2900
926J Segments "data structures" "There is a straight line colored in white. n black segments are added on it one by one.After each segment is added, determine the number of connected components of black segments (i. e. the number of black segments in the union of the black segments). In particular, if one segment ends in a point x, and another segment starts in the point x, these two segments belong to the same connected component." 2100
926I "A Vital Problem" NA "Polycarp has a strict daily schedule. He has n alarms set for each day, and the i-th alarm rings each day at the same time during exactly one minute.Determine the longest time segment when Polycarp can sleep, i. e. no alarm rings in that period. It is possible that Polycarp begins to sleep in one day, and wakes up in another." 1700
926H "Endless Roses Most Beautiful" NA "Arkady decided to buy roses for his girlfriend.A flower shop has white, orange and red roses, and the total amount of them is n. Arkady thinks that red roses are not good together with white roses, so he won\'t buy a bouquet containing both red and white roses. Also, Arkady won\'t buy a bouquet where all roses have the same color. Arkady wants to buy exactly k roses. For each rose in the shop he knows its beauty and color: the beauty of the i-th rose is bi, and its color is ci (\'W\' for a white rose, \'O\' for an orange rose and \'R\' for a red rose). Compute the maximum possible total beauty of a bouquet of k roses satisfying the constraints above or determine that it is not possible to make such a bouquet." 2200
926G "Large Bouquets" NA "A flower shop has got n bouquets, and the i-th bouquet consists of ai flowers. Vasya, the manager of the shop, decided to make large bouquets from these bouquets. Vasya thinks that a bouquet is large if it is made of two or more initial bouquets, and there is a constraint: the total number of flowers in a large bouquet should be odd. Each of the initial bouquets can be a part of at most one large bouquet. If an initial bouquet becomes a part of a large bouquet, all its flowers are included in the large bouquet.Determine the maximum possible number of large bouquets Vasya can make." 1500
926F "Mobile Communications" NA "A sum of p rubles is charged from Arkady\'s mobile phone account every day in the morning. Among the following m days, there are n days when Arkady will top up the account: in the day di he will deposit ti rubles on his mobile phone account. Arkady will always top up the account before the daily payment will be done. There will be no other payments nor tops up in the following m days.Determine the number of days starting from the 1-st to the m-th such that the account will have a negative amount on it after the daily payment (i. e. in evening). Initially the account\'s balance is zero rubles." 2000
926E "Merge Equal Elements" "constructive algorithms,data structures" "You are given a sequence of positive integers a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an. While possible, you perform the following operation: find a pair of equal consecutive elements. If there are more than one such pair, find the leftmost (with the smallest indices of elements). If the two integers are equal to x, delete both and insert a single integer x\xe2\x80\x89+\xe2\x80\x891 on their place. This way the number of elements in the sequence is decreased by 1 on each step. You stop performing the operation when there is no pair of equal consecutive elements.For example, if the initial sequence is [5,\xe2\x80\x892,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x892,\xe2\x80\x892], then after the first operation you get [5,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892,\xe2\x80\x892], after the second \xe2\x80\x94 [5,\xe2\x80\x893,\xe2\x80\x892,\xe2\x80\x892], after the third \xe2\x80\x94 [5,\xe2\x80\x893,\xe2\x80\x893], and finally after the fourth you get [5,\xe2\x80\x894]. After that there are no equal consecutive elements left in the sequence, so you stop the process.Determine the final sequence after you stop performing the operation." 1900
926D "Choose Place" NA "A classroom in a school has six rows with 3 desks in each row. Two people can use the same desk: one sitting on the left and one sitting on the right. Some places are already occupied, and some places are vacant. Petya has just entered the class and wants to occupy the most convenient place. The conveniences of the places are shown on the picture:  Here, the desks in the top row are the closest to the blackboard, while the desks in the bottom row are the furthest from the blackboard.You are given a plan of the class, where \'*\' denotes an occupied place, \'.\' denotes a vacant place, and the aisles are denoted by \'-\'. Find any of the most convenient vacant places for Petya." 1600
926C "Is This a Zebra?" implementation "A camera you have accidentally left in a desert has taken an interesting photo. The photo has a resolution of n pixels width, and each column of this photo is all white or all black. Thus, we can represent the photo as a sequence of n zeros and ones, where 0 means that the corresponding column is all white, and 1 means that the corresponding column is black.You think that this photo can contain a zebra. In this case the whole photo should consist of several (possibly, only one) alternating black and white stripes of equal width. For example, the photo [0,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x890] can be a photo of zebra, while the photo [0,\xe2\x80\x890,\xe2\x80\x890,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x891,\xe2\x80\x891] can not, because the width of the black stripe is 3, while the width of the white stripe is 4. Can the given photo be a photo of zebra or not?" 1700
926B "Add Points" "math,number theory" "There are n points on a straight line, and the i-th point among them is located at xi. All these coordinates are distinct.Determine the number m \xe2\x80\x94 the smallest number of points you should add on the line to make the distances between all neighboring points equal." 1800
926A 2-3-numbers implementation,math "A positive integer is called a 2-3-integer, if it is equal to 2x\xc2\xb73y for some non-negative integers x and y. In other words, these integers are such integers that only have 2 and 3 among their prime divisors. For example, integers 1, 6, 9, 16 and 108 \xe2\x80\x94 are 2-3 integers, while 5, 10, 21 and 120 are not.Print the number of 2-3-integers on the given segment [l,\xe2\x80\x89r], i. e. the number of sich 2-3-integers t that l\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89t\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89r." 1300
925F "Parametric Circulation" "binary search,flows" "Vova has recently learned what a circulaton in a graph is. Recall the definition: let G=(V,E) be a directed graph. A circulation f is such a collection of non-negative real numbers fe (e\xe2\x88\x88E), that for each vertex v\xe2\x88\x88V the following conservation condition holds:\xe2\x88\x91e\xe2\x88\x88\xce\xb4\xe2\x88\x92(v)fe=\xe2\x88\x91e\xe2\x88\x88\xce\xb4+(v)fewhere \xce\xb4+(v) is the set of edges that end in the vertex v, and \xce\xb4\xe2\x88\x92(v) is the set of edges that start in the vertex v. In other words, for each vertex the total incoming flow should be equal to the total outcoming flow.Let a lr-circulation be such a circulation f that for each edge the condition le\xe2\x89\xa4fe\xe2\x89\xa4re holds, where le and re for each edge e\xe2\x88\x88E are two non-negative real numbers denoting the lower and upper bounds on the value of the circulation on this edge e.Vova can\'t stop thinking about applications of a new topic. Right now he thinks about the following natural question: let the graph be fixed, and each value le and re be a linear function of a real variable t:le(t)=aet+be re(t)=cet+deNote that t is the same for all edges.Let t be chosen at random from uniform distribution on a segment [0,1]. What is the probability of existence of lr-circulation in the graph?" 3100
925E "May Holidays" "data structures,trees" "It\'s May in Flatland, and there are m days in this month. Despite the fact that May Holidays are canceled long time ago, employees of some software company still have a habit of taking short or long vacations in May.Of course, not all managers of the company like this. There are n employees in the company that form a tree-like structure of subordination: each employee has a unique integer id i between 1 and n, and each employee with id i (except the head manager whose id is 1) has exactly one direct manager with id pi. The structure of subordination is not cyclic, i.e. if we start moving from any employee to his direct manager, then we will eventually reach the head manager. We define that an employee u is a subordinate of an employee v, if v is a direct manager of u, or the direct manager of u is a subordinate of v. Let si be the number of subordinates the i-th employee has (for example, s1=n\xe2\x88\x921, because all employees except himself are subordinates of the head manager).Each employee i has a bearing limit of ti, which is an integer between 0 and si. It denotes the maximum number of the subordinates of the i-th employee being on vacation at the same moment that he can bear. If at some moment strictly more than ti subordinates of the i-th employee are on vacation, and the i-th employee himself is not on a vacation, he becomes displeased.In each of the m days of May exactly one event of the following two types happens: either one employee leaves on a vacation at the beginning of the day, or one employee returns from a vacation in the beginning of the day. You know the sequence of events in the following m days. Your task is to compute for each of the m days the number of displeased employees on that day." 2900
925D "Aztec Catacombs" "constructive algorithms" "Indiana Jones found ancient Aztec catacombs containing a golden idol. The catacombs consists of n caves. Each pair of caves is connected with a two-way corridor that can be opened or closed. The entrance to the catacombs is in the cave 1, the idol and the exit are in the cave n.When Indiana goes from a cave x to a cave y using an open corridor, all corridors connected to the cave x change their state: all open corridors become closed, all closed corridors become open. Indiana wants to go from cave 1 to cave n going through as small number of corridors as possible. Help him find the optimal path, or determine that it is impossible to get out of catacombs." 2600
925C "Big Secret" "constructive algorithms,math" "Vitya has learned that the answer for The Ultimate Question of Life, the Universe, and Everything is not the integer 54 42, but an increasing integer sequence a1,\xe2\x80\xa6,an. In order to not reveal the secret earlier than needed, Vitya encrypted the answer and obtained the sequence b1,\xe2\x80\xa6,bn using the following rules:  b1=a1; bi=ai\xe2\x8a\x95ai\xe2\x88\x921 for all i from 2 to n, where x\xe2\x8a\x95y is the bitwise XOR of x and y. It is easy to see that the original sequence can be obtained using the rule ai=b1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95bi.However, some time later Vitya discovered that the integers bi in the cypher got shuffled, and it can happen that when decrypted using the rule mentioned above, it can produce a sequence that is not increasing. In order to save his reputation in the scientific community, Vasya decided to find some permutation of integers bi so that the sequence ai=b1\xe2\x8a\x95\xe2\x80\xa6\xe2\x8a\x95bi is strictly increasing. Help him find such a permutation or determine that it is impossible." 2200
925B "Resource Distribution" "binary search,implementation,sortings" "One department of some software company has n servers of different specifications. Servers are indexed with consecutive integers from 1 to n. Suppose that the specifications of the j-th server may be expressed with a single integer number cj of artificial resource units.In order for production to work, it is needed to deploy two services S1 and S2 to process incoming requests using the servers of the department. Processing of incoming requests of service Si takes xi resource units.The described situation happens in an advanced company, that is why each service may be deployed using not only one server, but several servers simultaneously. If service Si is deployed using ki servers, then the load is divided equally between these servers and each server requires only xi/ki (that may be a fractional number) resource units.Each server may be left unused at all, or be used for deploying exactly one of the services (but not for two of them simultaneously). The service should not use more resources than the server provides.Determine if it is possible to deploy both services using the given servers, and if yes, determine which servers should be used for deploying each of the services." 1700
925A "Stairs and Elevators" "binary search" "In the year of 30XX participants of some world programming championship live in a single large hotel. The hotel has n floors. Each floor has m sections with a single corridor connecting all of them. The sections are enumerated from 1 to m along the corridor, and all sections with equal numbers on different floors are located exactly one above the other. Thus, the hotel can be represented as a rectangle of height n and width m. We can denote sections with pairs of integers (i,j), where i is the floor, and j is the section number on the floor.The guests can walk along the corridor on each floor, use stairs and elevators. Each stairs or elevator occupies all sections (1,x), (2,x), \xe2\x80\xa6, (n,x) for some x between 1 and m. All sections not occupied with stairs or elevators contain guest rooms. It takes one time unit to move between neighboring sections on the same floor or to move one floor up or down using stairs. It takes one time unit to move up to v floors in any direction using an elevator. You can assume you don\'t have to wait for an elevator, and the time needed to enter or exit an elevator is negligible.You are to process q queries. Each query is a question ""what is the minimum time needed to go from a room in section (x1,y1) to a room in section (x2,y2)?""" 1600
924F "Minimal Subset Difference" dp "We call a positive integer x a k-beautiful integer if and only if it is possible to split the multiset of its digits in the decimal representation into two subsets such that the difference between the sum of digits in one subset and the sum of digits in the other subset is less than or equal to k. Each digit should belong to exactly one subset after the split.There are n queries for you. Each query is described with three integers l, r and k, which mean that you are asked how many integers x between l and r (inclusive) are k-beautiful." 3200
924E Wardrobe dp,greedy "Olya wants to buy a custom wardrobe. It should have n boxes with heights a1,\xe2\x80\x89a2,\xe2\x80\x89...,\xe2\x80\x89an, stacked one on another in some order. In other words, we can represent each box as a vertical segment of length ai, and all these segments should form a single segment from 0 to  without any overlaps.Some of the boxes are important (in this case bi\xe2\x80\x89=\xe2\x80\x891), others are not (then bi\xe2\x80\x89=\xe2\x80\x890). Olya defines the convenience of the wardrobe as the number of important boxes such that their bottom edge is located between the heights l and r, inclusive.You are given information about heights of the boxes and their importance. Compute the maximum possible convenience of the wardrobe if you can reorder the boxes arbitrarily." 2700
924D "Contact ATC" NA "Arkady the air traffic controller is now working with n planes in the air. All planes move along a straight coordinate axis with Arkady\'s station being at point 0 on it. The i-th plane, small enough to be represented by a point, currently has a coordinate of xi and is moving with speed vi. It\'s guaranteed that xi\xc2\xb7vi\xe2\x80\x89<\xe2\x80\x890, i.e., all planes are moving towards the station.Occasionally, the planes are affected by winds. With a wind of speed vwind (not necessarily positive or integral), the speed of the i-th plane becomes vi\xe2\x80\x89+\xe2\x80\x89vwind.According to weather report, the current wind has a steady speed falling inside the range [\xe2\x80\x89-\xe2\x80\x89w,\xe2\x80\x89w] (inclusive), but the exact value cannot be measured accurately since this value is rather small \xe2\x80\x94 smaller than the absolute value of speed of any plane.Each plane should contact Arkady at the exact moment it passes above his station. And you are to help Arkady count the number of pairs of planes (i,\xe2\x80\x89j) (i\xe2\x80\x89<\xe2\x80\x89j) there are such that there is a possible value of wind speed, under which planes i and j contact Arkady at the same moment. This value needn\'t be the same across different pairs.The wind speed is the same for all planes. You may assume that the wind has a steady speed and lasts arbitrarily long." 2500
924C "Riverside Curio" "data structures,dp,greedy" "Arkady decides to observe a river for n consecutive days. The river\'s water level on each day is equal to some real value.Arkady goes to the riverside each day and makes a mark on the side of the channel at the height of the water level, but if it coincides with a mark made before, no new mark is created. The water does not wash the marks away. Arkady writes down the number of marks strictly above the water level each day, on the i-th day this value is equal to mi.Define di as the number of marks strictly under the water level on the i-th day. You are to find out the minimum possible sum of di over all days. There are no marks on the channel before the first day." 1700
924B "Three-level Laser" "binary search,greedy,two pointers" "An atom of element X can exist in n distinct states with energies E1\xe2\x80\x89<\xe2\x80\x89E2\xe2\x80\x89<\xe2\x80\x89...\xe2\x80\x89<\xe2\x80\x89En. Arkady wants to build a laser on this element, using a three-level scheme. Here is a simplified description of the scheme. Three distinct states i, j and k are selected, where i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89<\xe2\x80\x89k. After that the following process happens:   initially the atom is in the state i, we spend Ek\xe2\x80\x89-\xe2\x80\x89Ei energy to put the atom in the state k, the atom emits a photon with useful energy Ek\xe2\x80\x89-\xe2\x80\x89Ej and changes its state to the state j, the atom spontaneously changes its state to the state i, losing energy Ej\xe2\x80\x89-\xe2\x80\x89Ei, the process repeats from step 1. Let\'s define the energy conversion efficiency as , i. e. the ration between the useful energy of the photon and spent energy.Due to some limitations, Arkady can only choose such three states that Ek\xe2\x80\x89-\xe2\x80\x89Ei\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89U.Help Arkady to find such the maximum possible energy conversion efficiency within the above constraints." 1600
924A "Mystical Mosaic" greedy,implementation "There is a rectangular grid of n rows of m initially-white cells each.Arkady performed a certain number (possibly zero) of operations on it. In the i-th operation, a non-empty subset of rows Ri and a non-empty subset of columns Ci are chosen. For each row r in Ri and each column c in Ci, the intersection of row r and column c is coloured black.There\'s another constraint: a row or a column can only be chosen at most once among all operations. In other words, it means that no pair of (i,\xe2\x80\x89j) (i\xe2\x80\x89<\xe2\x80\x89j) exists such that  or , where  denotes intersection of sets, and  denotes the empty set.You are to determine whether a valid sequence of operations exists that produces a given final grid." 1300
923F "Public Service" "constructive algorithms,graphs,trees" "There are N cities in Bob\'s country connected by roads. Some pairs of cities are connected by public transport. There are two competing transport companies \xe2\x80\x94 Boblines operating buses and Bobrail running trains. When traveling from A to B, a passenger always first selects the mode of transport (either bus or train), and then embarks on a journey. For every pair of cities, there are exactly two ways of how to travel between them without visiting any city more than once \xe2\x80\x94 one using only bus routes, and the second using only train routes. Furthermore, there is no pair of cities that is directly connected by both a bus route and a train route.You obtained the plans of each of the networks. Unfortunately, each of the companies uses different names for the same cities. More precisely, the bus company numbers the cities using integers from 1 to N, while the train company uses integers between N\xe2\x80\x89+\xe2\x80\x891 and 2N. Find one possible mapping between those two numbering schemes, such that no pair of cities is connected directly by both a bus route and a train route. Note that this mapping has to map different cities to different cities." 3200
923E "Perpetual Subtraction" fft,math,matrices "There is a number x initially written on a blackboard. You repeat the following action a fixed amount of times:   take the number x currently written on a blackboard and erase it  select an integer uniformly at random from the range [0,\xe2\x80\x89x] inclusive, and write it on the blackboard Determine the distribution of final number given the distribution of initial number and the number of steps." 3100
923D "Picking Strings" "constructive algorithms,implementation,strings" "Alice has a string consisting of characters \'A\', \'B\' and \'C\'. Bob can use the following transitions on any substring of our string in any order any number of times:   A  BC  B  AC  C  AB  AAA  empty string Note that a substring is one or more consecutive characters. For given queries, determine whether it is possible to obtain the target string from source." 2500
923C "Perfect Security" "data structures,greedy,strings,trees" "Alice has a very important message M consisting of some non-negative integers that she wants to keep secret from Eve. Alice knows that the only theoretically secure cipher is one-time pad. Alice generates a random key K of the length equal to the message\'s length. Alice computes the bitwise xor of each element of the message and the key (, where  denotes the bitwise XOR operation) and stores this encrypted message A. Alice is smart. Be like Alice.For example, Alice may have wanted to store a message M\xe2\x80\x89=\xe2\x80\x89(0,\xe2\x80\x8915,\xe2\x80\x899,\xe2\x80\x8918). She generated a key K\xe2\x80\x89=\xe2\x80\x89(16,\xe2\x80\x897,\xe2\x80\x896,\xe2\x80\x893). The encrypted message is thus A\xe2\x80\x89=\xe2\x80\x89(16,\xe2\x80\x898,\xe2\x80\x8915,\xe2\x80\x8917).Alice realised that she cannot store the key with the encrypted message. Alice sent her key K to Bob and deleted her own copy. Alice is smart. Really, be like Alice.Bob realised that the encrypted message is only secure as long as the key is secret. Bob thus randomly permuted the key before storing it. Bob thinks that this way, even if Eve gets both the encrypted message and the key, she will not be able to read the message. Bob is not smart. Don\'t be like Bob.In the above example, Bob may have, for instance, selected a permutation (3,\xe2\x80\x894,\xe2\x80\x891,\xe2\x80\x892) and stored the permuted key P\xe2\x80\x89=\xe2\x80\x89(6,\xe2\x80\x893,\xe2\x80\x8916,\xe2\x80\x897).One year has passed and Alice wants to decrypt her message. Only now Bob has realised that this is impossible. As he has permuted the key randomly, the message is lost forever. Did we mention that Bob isn\'t smart?Bob wants to salvage at least some information from the message. Since he is not so smart, he asks for your help. You know the encrypted message A and the permuted key P. What is the lexicographically smallest message that could have resulted in the given encrypted text?More precisely, for given A and P, find the lexicographically smallest message O, for which there exists a permutation \xcf\x80 such that  for every i.Note that the sequence S is lexicographically smaller than the sequence T, if there is an index i such that Si\xe2\x80\x89<\xe2\x80\x89Ti and for all j\xe2\x80\x89<\xe2\x80\x89i the condition Sj\xe2\x80\x89=\xe2\x80\x89Tj holds." 1800
923B "Producing Snow" "binary search,data structures" "Alice likes snow a lot! Unfortunately, this year\'s winter is already over, and she can\'t expect to have any more of it. Bob has thus bought her a gift \xe2\x80\x94 a large snow maker. He plans to make some amount of snow every day. On day i he will make a pile of snow of volume Vi and put it in her garden.Each day, every pile will shrink a little due to melting. More precisely, when the temperature on a given day is Ti, each pile will reduce its volume by Ti. If this would reduce the volume of a pile to or below zero, it disappears forever. All snow piles are independent of each other. Note that the pile made on day i already loses part of its volume on the same day. In an extreme case, this may mean that there are no piles left at the end of a particular day.You are given the initial pile sizes and the temperature on each day. Determine the total volume of snow melted on each day." 1600
923A "Primal Sport" "math,number theory" "Alice and Bob begin their day with a quick game. They first choose a starting number X0\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x893 and try to reach one million by the process described below. Alice goes first and then they take alternating turns. In the i-th turn, the player whose turn it is selects a prime number smaller than the current number, and announces the smallest multiple of this prime number that is not smaller than the current number.Formally, he or she selects a prime p\xe2\x80\x89<\xe2\x80\x89Xi\xe2\x80\x89-\xe2\x80\x891 and then finds the minimum Xi\xe2\x80\x89\xe2\x89\xa5\xe2\x80\x89Xi\xe2\x80\x89-\xe2\x80\x891 such that p divides Xi. Note that if the selected prime p already divides Xi\xe2\x80\x89-\xe2\x80\x891, then the number does not change.Eve has witnessed the state of the game after two turns. Given X2, help her determine what is the smallest possible starting number X0. Note that the players don\'t necessarily play optimally. You should consider all possible game evolutions." 1700
922F Divisibility "constructive algorithms,dp,greedy,number theory" "Imp is really pleased that you helped him. But it you solve the last problem, his gladness would raise even more.   Let\'s define  for some set of integers  as the number of pairs a, b in , such that:  a is strictly less than b;  a divides b without a remainder. You are to find such a set , which is a subset of {1,\xe2\x80\x892,\xe2\x80\x89...,\xe2\x80\x89n} (the set that contains all positive integers not greater than n), that ." 2400
922E Birds dp "Apart from plush toys, Imp is a huge fan of little yellow birds!  To summon birds, Imp needs strong magic. There are n trees in a row on an alley in a park, there is a nest on each of the trees. In the i-th nest there are ci birds; to summon one bird from this nest Imp needs to stay under this tree and it costs him costi points of mana. However, for each bird summoned, Imp increases his mana capacity by B points. Imp summons birds one by one, he can summon any number from 0 to ci birds from the i-th nest. Initially Imp stands under the first tree and has W points of mana, and his mana capacity equals W as well. He can only go forward, and each time he moves from a tree to the next one, he restores X points of mana (but it can\'t exceed his current mana capacity). Moving only forward, what is the maximum number of birds Imp can summon?" 2200
922D "Robot Vacuum Cleaner" greedy,sortings "Pushok the dog has been chasing Imp for a few hours already.  Fortunately, Imp knows that Pushok is afraid of a robot vacuum cleaner. While moving, the robot generates a string t consisting of letters \'s\' and \'h\', that produces a lot of noise. We define noise of string t as the number of occurrences of string ""sh"" as a subsequence in it, in other words, the number of such pairs (i,\xe2\x80\x89j), that i\xe2\x80\x89<\xe2\x80\x89j and  and . The robot is off at the moment. Imp knows that it has a sequence of strings ti in its memory, and he can arbitrary change their order. When the robot is started, it generates the string t as a concatenation of these strings in the given order. The noise of the resulting string equals the noise of this concatenation.Help Imp to find the maximum noise he can achieve by changing the order of the strings." 1800
922C "Cave Painting" "brute force,number theory" "Imp is watching a documentary about cave painting.  Some numbers, carved in chaotic order, immediately attracted his attention. Imp rapidly proposed a guess that they are the remainders of division of a number n by all integers i from 1 to k. Unfortunately, there are too many integers to analyze for Imp.Imp wants you to check whether all these remainders are distinct. Formally, he wants to check, if all , 1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k, are distinct, i. e. there is no such pair (i,\xe2\x80\x89j) that:   1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89i\xe2\x80\x89<\xe2\x80\x89j\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89k,  , where  is the remainder of division x by y." 1600
922B "Magic Forest" "brute force" "Imp is in a magic forest, where xorangles grow (wut?)  A xorangle of order n is such a non-degenerate triangle, that lengths of its sides are integers not exceeding n, and the xor-sum of the lengths is equal to zero. Imp has to count the number of distinct xorangles of order n to get out of the forest. Formally, for a given integer n you have to find the number of such triples (a,\xe2\x80\x89b,\xe2\x80\x89c), that:  1\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89a\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89b\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89c\xe2\x80\x89\xe2\x89\xa4\xe2\x80\x89n;  , where  denotes the bitwise xor of integers x and y.  (a,\xe2\x80\x89b,\xe2\x80\x89c) form a non-degenerate (with strictly positive area) triangle." 1300
922A "Cloning Toys" implementation "Imp likes his plush toy a lot.  Recently, he found a machine that can clone plush toys. Imp knows that if he applies the machine to an original toy, he additionally gets one more original toy and one copy, and if he applies the machine to a copied toy, he gets two additional copies.Initially, Imp has only one original toy. He wants to know if it is possible to use machine to get exactly x copied toys and y original toys? He can\'t throw toys away, and he can\'t apply the machine to a copy if he doesn\'t currently have any copies." 1300
92114 Labyrinth-14 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92113 Labyrinth-13 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92112 Labyrinth-12 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92111 Labyrinth-11 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92110 Labyrinth-10 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92109 Labyrinth-9 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92108 Labyrinth-8 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92107 Labyrinth-7 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
92106 Labyrinth-6 NA "See the problem statement here: http://codeforces.com/contest/921/problem/01." 3200
